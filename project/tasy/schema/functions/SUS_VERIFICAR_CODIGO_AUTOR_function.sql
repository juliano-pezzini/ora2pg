-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION sus_verificar_codigo_autor ( ie_codigo_autorizacao_p bigint, tp_verificacao_p text) RETURNS varchar AS $body$
DECLARE


/*Tipo de verificação:
PER - Permanência
IME - Id Menor
IMA - Id Maior
QTD - Qtd
CID - CID
CBO - CBO
TEL - Telefone
CNS - CNS
*/
ds_retorno_w	varchar(255) := 'N';


BEGIN

if (tp_verificacao_p = 'PER') then
	begin
	if (coalesce(ie_codigo_autorizacao_p,0) in (1,4,7,9,11,15,17,19,23,25,27,31,33,35,39,41,43,47,49,51,71,73,75,79,81,83,103,105,107,111,113,115,135,137,139,143,145,147,167,169,171,175,177,179,199,201,203,207,209,211,231,233,235,239,241,243)) then
		ds_retorno_w := 'S';
	end if;
	end;
elsif (tp_verificacao_p = 'IME') then
	begin
	if (coalesce(ie_codigo_autorizacao_p,0) in (2,8,9,15,16,17,24,25,32,33,40,41,48,49,72,73,80,81,104,105,112,113,136,137,144,145,168,169,176,177,200,201,208,209,232,233,240,241)) then
		ds_retorno_w := 'S';
	end if;
	end;
elsif (tp_verificacao_p = 'IMA') then
	begin
	if (coalesce(ie_codigo_autorizacao_p,0) in (3,10,11,18,19,26,27,34,35,42,43,50,51,74,75,82,83,106,107,114,115,138,139,146,147,170,171,178,179,202,203,210,211,234,235,242,243)) then
		ds_retorno_w := 'S';
	end if;
	end;
elsif (tp_verificacao_p = 'QTD') then
	begin
	if (coalesce(ie_codigo_autorizacao_p,0) in (5,14,15,16,17,18,19,30,31,32,33,34,35,46,47,48,49,50,51,78,79,80,81,82,83,110,111,112,113,114,115,142,143,144,145,146,147,174,175,176,177,178,179,206,207,208,209,210,211,238,239,240,241,242,243)) then
		ds_retorno_w := 'S';
	end if;
	end;
elsif (tp_verificacao_p = 'CID') then
	begin
	if (coalesce(ie_codigo_autorizacao_p,0) in (22,23,24,25,26,27,30,31,32,33,34,35)) then
		ds_retorno_w := 'S';
	end if;
	end;
elsif (tp_verificacao_p = 'CBO') then
	begin
	if (coalesce(ie_codigo_autorizacao_p,0) in (38,39,40,41,42,43,46,47,48,49,50,51,102,103,104,105,106,107,110,111,112,113,114,115,166,167,168,169,170,171,174,175,176,177,178,179,230,231,232,233,234,235,238,239,240,241,242,243)) then
		ds_retorno_w := 'S';
	end if;
	end;
elsif (tp_verificacao_p = 'TEL') then
	begin
	if (coalesce(ie_codigo_autorizacao_p,0) in (70,71,72,73,74,75,78,79,80,81,82,83,102,103,104,105,106,107,110,111,112,113,114,115,198,199,200,201,202,203,206,207,208,209,210,211,230,231,232,233,234,235,238,239,240,241,242,243)) then
		ds_retorno_w := 'S';
	end if;
	end;
elsif (tp_verificacao_p = 'CNS') then
	begin
	if (coalesce(ie_codigo_autorizacao_p,0) in (134,135,136,137,138,139,142,143,144,145,146,147,166,167,168,169,170,171,174,175,176,177,178,179,198,199,200,201,202,203,206,207,208,209,210,211,230,231,232,233,234,235,238,239,240,241,242,243)) then
		ds_retorno_w := 'S';
	end if;
	end;
end if;

return	coalesce(ds_retorno_w,'N');

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION sus_verificar_codigo_autor ( ie_codigo_autorizacao_p bigint, tp_verificacao_p text) FROM PUBLIC;

