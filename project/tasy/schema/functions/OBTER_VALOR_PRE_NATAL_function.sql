-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_valor_pre_natal (pr_campo text,NR_ATENDIMENTO bigint) RETURNS varchar AS $body$
DECLARE


    wCursor REFCURSOR;
    wSQL varchar(1000):= ' SELECT 
                                TO_CHAR('|| pr_campo ||')
                            FROM med_pac_pre_natal
                            LEFT JOIN med_pac_pre_natal_EVOL ON
                                med_pac_pre_natal.NR_SEQUENCIA = med_pac_pre_natal_EVOL.nr_seq_pre_natal
                            WHERE 
                                med_pac_pre_natal.NR_ATENDIMENTO = '||TO_CHAR(NR_ATENDIMENTO)||' AND
                                '|| pr_campo ||' IS NOT NULL
                            ORDER BY med_pac_pre_natal.NR_SEQUENCIA DESC
                            FETCH FIRST ROW ONLY';
    v_retorno varchar(255) := ' ';


BEGIN
    OPEN wCursor FOR EXECUTE wSQL;
    LOOP
        FETCH wCursor INTO v_retorno;
        EXIT WHEN NOT FOUND; /* apply on wCursor */
    END LOOP;
return v_retorno;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_valor_pre_natal (pr_campo text,NR_ATENDIMENTO bigint) FROM PUBLIC;

