-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION pfcs_get_card_rowspan ( ie_module_classif_p text, nr_seq_dynamic_module_p bigint default null) RETURNS bigint AS $body$
DECLARE


qt_rowspan_w    PFCS_PCK_SUBTYPES.NUMBER_5_T;
cd_dynamic_w    PFCS_PCK_SUBTYPES.VARCHAR_7_T := 'DYNAMIC';


BEGIN
    if (ie_module_classif_p <> cd_dynamic_w) then
        select  count(1)
        into STRICT    qt_rowspan_w
        from    pfcs_indicator
        where   ie_classification = ie_module_classif_p and
                coalesce(ie_left_card_main, PFCS_PCK_CONSTANTS.IE_NO) = PFCS_PCK_CONSTANTS.IE_YES;
    else
        select  count(1)
        into STRICT    qt_rowspan_w
        from    pfcs_card a,
                pfcs_card_indicator b
        where   a.nr_seq_dynamic_module = nr_seq_dynamic_module_p
        and     a.nr_sequencia = b.nr_seq_card
        and     cd_card_type = PFCS_PCK_CONSTANTS.CD_LEFT_CARD;
    end if;

    if (qt_rowspan_w < 2) then
        qt_rowspan_w := qt_rowspan_w + 3;
    elsif (qt_rowspan_w < 7) then
        qt_rowspan_w := qt_rowspan_w + 2;
    else
        qt_rowspan_w := qt_rowspan_w + 1;
    end if;

    return qt_rowspan_w;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pfcs_get_card_rowspan ( ie_module_classif_p text, nr_seq_dynamic_module_p bigint default null) FROM PUBLIC;

