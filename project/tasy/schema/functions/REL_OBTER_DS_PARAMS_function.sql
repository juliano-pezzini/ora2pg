-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION rel_obter_ds_params ( DT_INICIAL_P timestamp, DT_FINAL_P timestamp, IE_TIPO_CONVENIO_P bigint, CD_ESTABELECIMENTO_P bigint, CD_CARATER_ATEND_P text, IE_INTERNADO_P text, IE_CDI_P text, IE_PRONTO_SOCORRO_P text, IE_AMBULATORIAL_P text) RETURNS varchar AS $body$
DECLARE

				DS_RETORNO_W	varchar(255);

BEGIN
SELECT	SUBSTR(' '||wheb_mensagem_pck.get_texto(796884)||' '||DT_INICIAL_P||' '||wheb_mensagem_pck.get_texto(796885)||' '||DT_FINAL_P||CHR(13)||
	CASE WHEN IE_TIPO_CONVENIO_P=0 THEN  ''  ELSE ' '||wheb_mensagem_pck.get_texto(796886)||': '|| SUBSTR(OBTER_VALOR_DOMINIO(11,IE_TIPO_CONVENIO_P),1,255)||CHR(13) END ||
	CASE WHEN CD_ESTABELECIMENTO_P=0 THEN  ''  ELSE ' '||wheb_mensagem_pck.get_texto(796889)||' '|| SUBSTR(OBTER_NOME_ESTABELECIMENTO(CD_ESTABELECIMENTO_P),1,255)||CHR(13) END ||
   	CASE WHEN CD_CARATER_ATEND_P='0' THEN  ''  ELSE ' '||wheb_mensagem_pck.get_texto(796892)||': '|| (SELECT CD_CARATER_INTERNACAO || ' - ' || DS_CARATER_INTERNACAO FROM SUS_CARATER_INTERNACAO WHERE CD_CARATER_INTERNACAO = CD_CARATER_ATEND_P)||CHR(13) END ||
	CASE WHEN IE_INTERNADO_P='N' THEN  CASE WHEN IE_CDI_P='N' THEN  CASE WHEN IE_PRONTO_SOCORRO_P='N' THEN  CASE WHEN IE_AMBULATORIAL_P='N' THEN  ''  ELSE ' '||wheb_mensagem_pck.get_texto(796896)||': ' END   ELSE ' '||wheb_mensagem_pck.get_texto(796896)||': ' END   ELSE ' '||wheb_mensagem_pck.get_texto(796896)||': ' END   ELSE ' '||wheb_mensagem_pck.get_texto(796896)||': ' END ||
	CASE WHEN IE_INTERNADO_P='S' THEN  wheb_mensagem_pck.get_texto(796903)||', '  ELSE '' END ||
	CASE WHEN IE_CDI_P='S' THEN  wheb_mensagem_pck.get_texto(796906)||', '  ELSE '' END ||
	CASE WHEN IE_PRONTO_SOCORRO_P='S' THEN  wheb_mensagem_pck.get_texto(796907)||', '  ELSE '' END ||
	CASE WHEN IE_AMBULATORIAL_P='S' THEN  wheb_mensagem_pck.get_texto(796908)  ELSE '' END ,1,255)
INTO STRICT	DS_RETORNO_W
;
RETURN	DS_RETORNO_W;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION rel_obter_ds_params ( DT_INICIAL_P timestamp, DT_FINAL_P timestamp, IE_TIPO_CONVENIO_P bigint, CD_ESTABELECIMENTO_P bigint, CD_CARATER_ATEND_P text, IE_INTERNADO_P text, IE_CDI_P text, IE_PRONTO_SOCORRO_P text, IE_AMBULATORIAL_P text) FROM PUBLIC;

