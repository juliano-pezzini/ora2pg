-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION ctb_obter_regra_metrica ( ie_retorno_p text, ie_regra_p text) RETURNS varchar AS $body$
DECLARE


ds_atributo_w				varchar(2000);
ds_atributo_habilitar_w		varchar(2000);
ds_atributo_desabilitar_w		varchar(2000);


BEGIN

/* Function para controlar a habilitação dos campos na tabela CTB_REGRA_METRICA
Dominio 1718 */
ds_atributo_w					:= '';

ds_atributo_habilitar_w			:= 'NR_SEQ_REGRA;NR_SEQ_METRICA;NR_SEQ_MES_REF;CD_CENTRO_CUSTO;DT_MES_INIC;DT_MES_FIM;' ||
					   'IE_REGRA;PR_APLICAR;IE_SOBREPOR;QT_FIXA;QT_LEITO;TX_OCUPACAO';

if (ie_regra_p = 'PO') then
	ds_atributo_desabilitar_w		:= 'QT_FIXA;QT_LEITO;TX_OCUPACAO';
elsif (ie_regra_p = 'PQ') then
	ds_atributo_desabilitar_w		:= 'QT_FIXA;NR_SEQ_MES_REF;QT_LEITO;TX_OCUPACAO';
elsif (ie_regra_p = 'QF') then
	ds_atributo_desabilitar_w		:= 'NR_SEQ_MES_REF;PR_APLICAR;QT_LEITO;TX_OCUPACAO';
elsif (ie_regra_p = 'OC') then
	ds_atributo_desabilitar_w		:= 'NR_SEQ_MES_REF;PR_APLICAR;QT_FIXA;';
end if;

if (ie_retorno_p = 'S') then
	ds_atributo_w				:= ds_atributo_habilitar_w;
elsif (ie_retorno_p = 'N') then
	ds_atributo_w				:= ds_atributo_desabilitar_w;
end if;

return	ds_atributo_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION ctb_obter_regra_metrica ( ie_retorno_p text, ie_regra_p text) FROM PUBLIC;

