-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION gerar_nome_arquivo_xml (nr_lote_ext_p bigint) RETURNS varchar AS $body$
DECLARE

  nomeArquivo_w varchar(45);
  cnes_w varchar(20);


BEGIN


select p.cd_cnes lab_cnes
	into STRICT 	cnes_w
 from estabelecimento e
 join pessoa_juridica p on p.cd_cgc=e.cd_cgc
 where e.cd_estabelecimento=obter_estabelecimento_ativo();

nomearquivo_w :=  cnes_w ||
        to_char(clock_timestamp(),'yyyy') ||
        to_char(clock_timestamp(),'MM') ||
        to_char(clock_timestamp(),'dd') ||
        to_char(clock_timestamp(),'hh24') ||
        to_char(clock_timestamp(),'mi') ||
        to_char(clock_timestamp(),'ss');

return	nomeArquivo_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION gerar_nome_arquivo_xml (nr_lote_ext_p bigint) FROM PUBLIC;

