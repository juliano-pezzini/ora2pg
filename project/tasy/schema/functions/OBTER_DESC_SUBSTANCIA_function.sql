-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_desc_substancia ( cd_substacia_atc_p text) RETURNS varchar AS $body$
DECLARE


ds_retorno_w			varchar(2000);
ds_substancia_w			varchar(255);
cd_grupo_quimico_w		varchar(10);
ds_grupo_quimico_w		varchar(255);
cd_subclasse_terapeutica_w	varchar(10);
ds_subclasse_terapeutica_w	varchar(255);
cd_classe_terapeutica_w		varchar(10);
ds_classe_terapeutica_w		varchar(255);
cd_grupo_anatomico_w		varchar(10);
ds_grupo_anatomico_w		varchar(255);


BEGIN

select	ds_substancia,
	cd_grupo_quimico
into STRICT	ds_substancia_w,
	cd_grupo_quimico_w
from	med_substancia_quimica
where	cd_substancia	= cd_substacia_atc_p;

select	ds_grupo_quimico,
	cd_subclasse_terapeutica
into STRICT	ds_grupo_quimico_w,
	cd_subclasse_terapeutica_w
from	med_grupo_quim_farm
where	cd_grupo_quimico	= cd_grupo_quimico_w;

select	ds_subclasse_terapeutica,
	cd_classe_terapeutica
into STRICT	ds_subclasse_terapeutica_w,
	cd_classe_terapeutica_w
from	med_subclasse_terapeutica
where	cd_subclasse_terapeutica	= cd_subclasse_terapeutica_w;

select	ds_classe_terapeutica,
	cd_grupo_anatomico
into STRICT	ds_classe_terapeutica_w,
	cd_grupo_anatomico_w
from	med_classe_terapeutica
where	cd_classe_terapeutica	= cd_classe_terapeutica_w;

select	ds_grupo_anatomico
into STRICT	ds_grupo_anatomico_w
from	med_grupo_anatomico
where	cd_grupo_anatomico	= cd_grupo_anatomico_w;


ds_retorno_w	:= ds_substancia_w;
ds_retorno_w	:= ds_retorno_w ||', '|| ds_grupo_quimico_w;
ds_retorno_w	:= ds_retorno_w ||', '|| ds_subclasse_terapeutica_w;
ds_retorno_w	:= ds_retorno_w ||', '|| ds_classe_terapeutica_w;
ds_retorno_w	:= ds_retorno_w ||', '|| ds_grupo_anatomico_w;

return ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_desc_substancia ( cd_substacia_atc_p text) FROM PUBLIC;

