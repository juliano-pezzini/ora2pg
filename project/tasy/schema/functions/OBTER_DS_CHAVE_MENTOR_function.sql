-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_ds_chave_mentor (nr_sequencia_p bigint, ds_chave_p text) RETURNS varchar AS $body$
DECLARE


ds_link_w          varchar(200);
nr_seq_protocolo_w bigint;
ie_tipo_w          varchar(200);
nr_seq_proc_saps_w bigint;
nr_seq_proc_w      bigint;

ds_chave_w varchar(200);


BEGIN
select ds_link,
       nr_seq_protocolo,
       ie_tipo,
       nr_seq_proc,
       nr_seq_proc_saps
into STRICT   ds_link_w,
       nr_seq_protocolo_w,
       ie_tipo_w,
       nr_seq_proc_w,
       nr_seq_proc_saps_w
from   gqa_pend_pac_acao
where  nr_sequencia = nr_sequencia_p;

if (coalesce(ds_link_w::text, '') = '') and (coalesce(nr_seq_protocolo_w::text, '') = '') then

   if ((nr_seq_proc_w IS NOT NULL AND nr_seq_proc_w::text <> '') or ie_tipo_w = 'INTERV') then
      ds_chave_w := wheb_mensagem_pck.get_texto(357731,null);
   elsif ((nr_seq_proc_saps_w IS NOT NULL AND nr_seq_proc_saps_w::text <> '') or ie_tipo_w = 'SAPS') then
      ds_chave_w := wheb_mensagem_pck.get_texto(357723,null);
   end if;
end if;

if (coalesce(ds_chave_w::text, '') = '') then
   ds_chave_w :=  ds_chave_p;
end if;

return ds_chave_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_ds_chave_mentor (nr_sequencia_p bigint, ds_chave_p text) FROM PUBLIC;

