-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_info_os_gerencia_sup ( dt_parametro_p timestamp, nr_seq_gerencia_sup_p bigint, ie_tipo_inf_p text, ie_tipo_valor_p text ) RETURNS bigint AS $body$
DECLARE

/*
IE_TIPO_INF_P:
	QT- Qtde de OSs recebidas
	QTDU- Qtde de OSs de dúvida
	QTI- Qtde de OSs encerradas com grau de satisfação irregular
	QTSPP- Qtde de OSs por produto
	QTPESSOAS - Qtde de pessoas no grupo
	QTMETAMES - Meta mensal de OSs encerradas
	QTMETADIA - Meta diária de OSs encerradas
	QTMETAHORA - Meta de OSs encerradas do grupo para cada hora
	QTMETADIAHORA - Meta de OSs encerradas do dia de acordo com as horas passadas (HORAS_PASSADAS_DIA * META_POR_HORA)
	QTMETAMESHORA - Meta de OSs encerradas do mês de acordo com as horas passadas (HORAS_PASSADAS_MES * META_POR_HORA)
	QTBACKLOG - Quantidade de OSs no grupo (essa é a quantidade atual de OSs no grupo)
	QTANTIGA - Quantidade de OSs antigas no grupo
	PRANTIGA - Percentual de OSs antigas no grupo em relação ao backlog
	QTOSDIAANT - Quantidade de OSs do grupo no dia anterior
	EN- Qtde de OSs encerradas
	ENS- Qtde de OSs encerradas com grau de satisfação
	PRDU- Porcentagem de OSs de dúvida
	PRI- Porcentagem de OSs com insatisfação
	PRPP- Porcentagem de OSs por produto
	TMAC- Tempo médio gasto pelos usuários em OSs de alta complexidade
	TMBC- Tempo médio gasto pelos usuários em OSs de baixa complexidade
IE_TIPO_VALOR_P:
	D - Diário
	M - Mensal
	A - Anual
*/
qt_total_os_w			double precision;
qt_total_os_produto_w		double precision;
qt_os_encerrada_w		double precision;
qt_os_encerrada_classif_w	double precision;
qt_min_os_w			double precision;
qt_os_insatisf_w		double precision;
qt_duvida_w			double precision;
qt_duvida_des_w			double precision;
dt_ref_mes_w			timestamp;
dt_fim_mes_w			timestamp;
qt_meta_mes_w			double precision;
qt_meta_dia_w			double precision;
qt_meta_hora_w			double precision;
qt_horas_passadas_w		double precision;
qt_meta_dia_hora_w		double precision;
qt_meta_mes_hora_w		double precision;
qt_backlog_w			double precision;
qt_os_dia_anterior_w		double precision;
qt_antiga_w			double precision;
qt_pessoas_w			double precision;
qt_sla_w			double precision;
qt_os_aberta_w			double precision;


BEGIN
dt_ref_mes_w			:= PKG_DATE_UTILS.start_of(dt_parametro_p,'month',0);
dt_fim_mes_w			:= PKG_DATE_UTILS.END_OF(dt_ref_mes_w, 'MONTH', 0);
if (ie_tipo_valor_p	= 'A') then
	dt_ref_mes_w			:= PKG_DATE_UTILS.ADD_MONTH(PKG_DATE_UTILS.start_of(dt_parametro_p,'month',0), -11, 0);
	dt_fim_mes_w			:= PKG_DATE_UTILS.start_of(dt_parametro_p,'month',0);
end if;
if (ie_tipo_inf_p in ('QT','PRI','QTSPP','PRPP'))   then
	--Qtde de OSs recebidas
	select	count(distinct nr_sequencia)
	into STRICT	qt_total_os_w
	from	os_recebida_gerencia_sup_v
	where	dt_ordem_servico between dt_ref_mes_w and dt_fim_mes_w
	and	((nr_seq_gerencia_sup = nr_seq_gerencia_sup_p) or (nr_seq_gerencia_sup_p = 0));
end if;
if (ie_tipo_inf_p in ('QTSPP', 'PRPP')) then
	--Qtde de OSs por produto
	if	((UPPER(ie_tipo_valor_p) = 'TASY') or (UPPER(ie_tipo_valor_p) = 'TASY_SUP')) then
		select	count(distinct nr_sequencia)
		into STRICT	qt_total_os_produto_w
		from	os_recebida_gerencia_sup_v
		where	dt_ordem_servico between dt_ref_mes_w and dt_fim_mes_w
		and	nr_seq_gerencia_sup in (5, 58);
	elsif (UPPER(ie_tipo_valor_p) = 'MULTIMED') then
		select	count(distinct nr_sequencia)
		into STRICT	qt_total_os_produto_w
		from	os_recebida_gerencia_sup_v
		where	dt_ordem_servico between dt_ref_mes_w and dt_fim_mes_w
		and	nr_seq_gerencia_sup = 22;
	end if;
end if;
if (ie_tipo_inf_p in ('EN')) then
	if (ie_tipo_valor_p = 'D') then
		select	count(*)
		into STRICT	qt_os_encerrada_w
		from	os_encerrada_gerencia_sup_v
		where	((nr_seq_gerencia_sup = nr_seq_gerencia_sup_p) or (nr_seq_gerencia_sup_p = 0))
		and	trunc(dt_fim_real) = trunc(dt_parametro_p);
	else
		--Qtde de OSs encerradas
		select	count(*)
		into STRICT	qt_os_encerrada_w
		from	os_encerrada_gerencia_sup_v
		where	((nr_seq_gerencia_sup = nr_seq_gerencia_sup_p) or (nr_seq_gerencia_sup_p = 0))
		and	dt_fim_real between dt_ref_mes_w and dt_fim_mes_w;
	end if;
end if;

/* Quantity of service orders opened by day/month */

if (ie_tipo_inf_p in ('NEW_OS')) then
	if (ie_tipo_valor_p = 'D') then
	
		/* quantity of service orders opened (day) */

		select	count(1)
		into STRICT	qt_os_aberta_w
		from	man_ordem_servico a
		where	a.dt_ordem_servico = trunc(dt_parametro_p)
		and	a.nr_sequencia in (
				SELECT	max(x.nr_sequencia)
				from	man_ordem_servico x
				where	x.ie_status_ordem = '3'
				and	trunc(dt_ordem_servico) = trunc(dt_parametro_p)
				and	trunc(x.dt_fim_real) = trunc(dt_parametro_p)
				and	trunc(x.dt_ordem_servico) = trunc(dt_parametro_p)
				group by	coalesce(x.nr_seq_wheb, x.nr_sequencia),
						x.nr_seq_localizacao
				
union all

				SELECT	max(x.nr_sequencia)
				from	man_ordem_servico x
				where	x.ie_status_ordem <> '3'
				and	trunc(dt_ordem_servico) = trunc(dt_parametro_p)
				and	trunc(x.dt_ordem_servico) = trunc(dt_parametro_p)
				group by	coalesce(x.nr_seq_wheb, x.nr_sequencia),
						x.nr_seq_localizacao
			)
		and exists (
				select	1
				from	man_estagio_processo y,
					man_ordem_serv_estagio x
				where	y.nr_sequencia = x.nr_seq_estagio
				and	x.nr_seq_estagio <> 511
				and	x.nr_seq_ordem = a.nr_sequencia
				and	y.ie_suporte = 'S'
			)
		and (	coalesce(nr_seq_gerencia_sup_p, 0) = 0
			or	nr_seq_gerencia_sup_p = substr(obter_gerencia_grupo_sup(a.nr_seq_grupo_sup, 'C'), 1, 10));
		
	elsif (ie_tipo_valor_p = 'M') then
	
		 /* quantity of service orders opened (month) */

		select	count(1)
		into STRICT	qt_os_aberta_w
		from	man_ordem_servico a
		where	a.dt_ordem_servico between dt_ref_mes_w and dt_fim_mes_w
		and	a.nr_sequencia in (
				SELECT	max(x.nr_sequencia)
				from	man_ordem_servico x
				where	x.ie_status_ordem = '3'
				and	dt_ordem_servico between dt_ref_mes_w and dt_fim_mes_w
				and	x.dt_fim_real >= dt_ref_mes_w
				and	x.dt_ordem_servico <= dt_fim_mes_w
				group by	coalesce(x.nr_seq_wheb, x.nr_sequencia),
						x.nr_seq_localizacao
				
union all

				SELECT	max(x.nr_sequencia)
				from	man_ordem_servico x
				where	x.ie_status_ordem <> '3'
				and	dt_ordem_servico between dt_ref_mes_w and dt_fim_mes_w
				and	x.dt_ordem_servico <= dt_fim_mes_w
				group by	coalesce(x.nr_seq_wheb, x.nr_sequencia),
						x.nr_seq_localizacao
			)
		and exists (
				select	1
				from	man_estagio_processo y,
					man_ordem_serv_estagio x
				where	y.nr_sequencia = x.nr_seq_estagio
				and	x.nr_seq_estagio <> 511
				and	x.nr_seq_ordem = a.nr_sequencia
				and	y.ie_suporte = 'S'
			)
		and (	coalesce(nr_seq_gerencia_sup_p, 0) = 0
			or	nr_seq_gerencia_sup_p = substr(obter_gerencia_grupo_sup(a.nr_seq_grupo_sup, 'C'), 1, 10));
	end if;
end if;

if (ie_tipo_inf_p in ('PRI','ENS')) then
	--Qtde de OSs encerradas com grau de satisfação
	select	count(*)
	into STRICT	qt_os_encerrada_classif_w
	from	os_encer_satisf_gerencia_sup_v a
	where	((a.nr_seq_gerencia_grupo = nr_seq_gerencia_sup_p) or (nr_seq_gerencia_sup_p = 0))
	and		(((a.ie_grau_satisfacao in ('P', 'R'))
	and ( exists (	SELECT	1
						from	os_insatisfacao_gerencia_sup_v d
						where	d.nr_sequencia = a.nr_sequencia)))
	or a.ie_grau_satisfacao not in ('P','R'))
	and	a.dt_fim_real between dt_ref_mes_w and dt_fim_mes_w;
end if;
if (ie_tipo_inf_p in ('QTI','PRI')) then
	--Qtde de OSs encerradas com grau de satisfação irregular
	select	count(*)
	into STRICT	qt_os_insatisf_w
	from	os_insatisfacao_gerencia_sup_v
	where	((nr_seq_gerencia_sup = nr_seq_gerencia_sup_p) or (nr_seq_gerencia_sup_p = 0))
	and	dt_fim_real between dt_ref_mes_w and dt_fim_mes_w;
end if;
if (ie_tipo_inf_p in ('TMAC')) then
	--Tempo médio gasto pelos usuários em OSs de alta complexidade
	select	dividir(sum(b.qt_minuto), count(distinct a.nr_sequencia)) qt_min_os_alta_complex
	into STRICT	qt_min_os_w
	from	man_ordem_servico a,
		man_ordem_serv_ativ b,
		usuario c,
		grupo_suporte d
	where	a.nr_sequencia = b.nr_seq_ordem_serv
	and	b.nm_usuario_exec = c.nm_usuario
	and	d.nr_sequencia = a.nr_seq_grupo_sup
	and	a.ie_status_ordem = 3
	and	a.nr_seq_complex in (4,5,6)
	and	a.dt_fim_real between dt_ref_mes_w and dt_fim_mes_w
	and	c.cd_setor_atendimento in (4,17)
	and	((d.nr_seq_gerencia_sup = nr_seq_gerencia_sup_p) or (nr_seq_gerencia_sup_p = 0))
	and	exists (	SELECT	1
				from	os_recebida_gerencia_sup_v e
				where	a.nr_sequencia = e.nr_sequencia
			);
elsif (ie_tipo_inf_p in ('TMBC')) then
	--Tempo médio gasto pelos usuários em OSs de baixa complexidade
	select	dividir(sum(b.qt_minuto), count(distinct a.nr_sequencia)) qt_min_os_alta_complex
	into STRICT	qt_min_os_w
	from	man_ordem_servico a,
		man_ordem_serv_ativ b,
		usuario c,
		grupo_suporte d
	where	a.nr_sequencia = b.nr_seq_ordem_serv
	and	b.nm_usuario_exec = c.nm_usuario
	and	d.nr_sequencia = a.nr_seq_grupo_sup
	and	a.ie_status_ordem = 3
	and	a.nr_seq_complex not in (4,5,6)
	and	a.dt_fim_real between dt_ref_mes_w and dt_fim_mes_w
	and	c.cd_setor_atendimento in (4,17)
	and	((d.nr_seq_gerencia_sup = nr_seq_gerencia_sup_p) or (nr_seq_gerencia_sup_p = 0))
	and	exists (	SELECT	1
				from	os_recebida_gerencia_sup_v e
				where	a.nr_sequencia = e.nr_sequencia
			);
end if;
if (ie_tipo_inf_p in ('QTDU','PRDU')) then
	if (ie_tipo_inf_p = 'PRDU') then
		select	sum(qt_total_des)	qt_total_des
		into STRICT	qt_duvida_des_w
		from	( SELECT (
						SELECT	count(*)
						from	man_ordem_servico x,
							grupo_desenvolvimento y,
							gerencia_wheb z,
							grupo_suporte k
						where	a.nr_seq_grupo_sup = x.nr_seq_grupo_sup
						and	(x.ie_classificacao IS NOT NULL AND x.ie_classificacao::text <> '')
						and	x.ie_classificacao = 'D'
						and	x.ie_classificacao_cliente in ('D', 'E')
						and	x.nr_seq_grupo_des 	= y.nr_sequencia
						and	y.nr_seq_gerencia	= z.nr_sequencia
						and	k.nr_sequencia		= x.nr_seq_grupo_sup
						and	z.ie_area_gerencia	<> 'PDES'
						and	x.nr_grupo_trabalho	<> 132
						and	x.nr_seq_grupo_sup not in (31,16,63,60,27,70)
						and	 'S' =	(
									select	CASE WHEN count(*)=0 THEN 'N'  ELSE 'S' END 
									from	man_ordem_serv_estagio y,
										man_estagio_processo q
									where	y.nr_seq_estagio	= q.nr_sequencia
									and	y.nr_seq_ordem		= x.nr_sequencia
									and	coalesce(q.ie_desenv,'N')	= 'S'
									and	y.nr_seq_estagio	<> 1051
								)
						and	x.nr_seq_grupo_sup in (
											select	gs.nr_sequencia
											from	grupo_suporte  gs
											where	gs.nr_seq_gerencia_sup in (5, 58)
											and	gs.ie_situacao = 'A'
										)
						and	obter_data_estagio_os(x.nr_sequencia, 'S') < obter_data_estagio_os(x.nr_sequencia, 'D')
						and	trunc(x.dt_fim_real) between dt_ref_mes_w and dt_fim_mes_w
					) qt_total_des
					from	gerencia_wheb d,
				grupo_desenvolvimento c,
				grupo_suporte  b,
				man_ordem_servico a
				where	a.nr_seq_grupo_sup = b.nr_sequencia
				and	(a.ie_classificacao IS NOT NULL AND a.ie_classificacao::text <> '')
				and	a.ie_classificacao = 'D'
				and	a.nr_seq_grupo_des 	= c.nr_sequencia
				and	c.nr_seq_gerencia	= d.nr_sequencia
				and	d.ie_area_gerencia	<> 'PDES'
				and	a.nr_seq_grupo_sup not in (31,16,63,60,27,70)
				and	coalesce(a.ie_classificacao_cliente,'0') in ('D', 'E')
				and	b.nr_seq_gerencia_sup = nr_seq_gerencia_sup_p
				and	a.nr_seq_grupo_sup in (
									select	l.nr_sequencia
									from	grupo_suporte l
									where	l.nr_seq_gerencia_sup in (5,58)
									and 	l.ie_situacao = 'A'
								)
				and	a.dt_fim_real between dt_ref_mes_w and fim_dia(dt_fim_mes_w)
				and	a.nr_grupo_trabalho <> 132
				group by a.nr_seq_grupo_sup
			) y
		where	1 = 1;
	end if;
	select	count(1)
	into STRICT	qt_duvida_w
	from	gerencia_wheb d,
		grupo_desenvolvimento c,
		grupo_suporte b,
		man_ordem_servico a
	where	a.nr_seq_grupo_sup = b.nr_sequencia
	and	(a.ie_classificacao IS NOT NULL AND a.ie_classificacao::text <> '')
	and	a.ie_classificacao = 'D'
	and	a.nr_seq_grupo_des 	= c.nr_sequencia
	and	c.nr_seq_gerencia	= d.nr_sequencia
	and	d.ie_area_gerencia	<> 'PDES'
	and	a.nr_seq_grupo_sup not in (31,16,63,60,27,70)
	and	coalesce(a.ie_classificacao_cliente,'0') in ('D', 'E')
	and	b.nr_seq_gerencia_sup = nr_seq_gerencia_sup_p
	and	a.nr_seq_grupo_sup in (
						SELECT	l.nr_sequencia
						from	grupo_suporte l
						where	l.nr_seq_gerencia_sup in (5,58)
						and 	l.ie_situacao = 'A'
					)
	and	a.dt_fim_real between dt_ref_mes_w and fim_dia(dt_fim_mes_w)
	and	a.nr_grupo_trabalho <> 132;
end if;
if (ie_tipo_inf_p = 'QTPESSOAS') then
	select	count(distinct b.nm_usuario_grupo)
	into STRICT	qt_pessoas_w
	from	usuario_grupo_sup b,
		grupo_suporte g,
		gerencia_wheb ger
	where	g.nr_sequencia = b.nr_seq_grupo
	and	g.nr_seq_gerencia_sup = ger.nr_sequencia
	and	g.ie_situacao = 'A'
	and	b.ie_funcao_usuario <> 'E' -- Estagiário
	and	ger.nr_sequencia = nr_seq_gerencia_sup_p;
end if;
if (ie_tipo_inf_p in ('QTMETAMES', 'QTMETADIA', 'QTMETAHORA', 'QTMETADIAHORA', 'QTMETAMESHORA')) then
	-- Soma das metas de cada membro do grupo
	select	coalesce(sum(niv.qt_media_nivel), 0)
	into STRICT	qt_meta_mes_w
	from	grupo_suporte g,
		usuario_grupo_sup u,
		usuario_nivel_sup u_niv,
		nivel_grupo_sup niv
	where	g.nr_sequencia = u.nr_seq_grupo
	and	u.nm_usuario_grupo = u_niv.nm_usuario_sup
	and	u_niv.nr_seq_nivel = niv.nr_sequencia
	and	g.nr_seq_gerencia_sup = nr_seq_gerencia_sup_p
	and	u_niv.dt_referencia = (	SELECT	max(dt_referencia)
					from	usuario_nivel_sup x
					where	x.nm_usuario_sup = u.nm_usuario_grupo
					and	dt_parametro_p >= x.dt_referencia
				);
end if;
if (ie_tipo_inf_p in ('QTMETADIA', 'QTMETAHORA', 'QTMETADIAHORA', 'QTMETAMESHORA')) then
	-- Meta mensal dividida pelo número de dias úteis do mês em questão
	select	dividir(qt_meta_mes_w, obter_qt_dia_util_periodo(dt_ref_mes_w, dt_fim_mes_w, wheb_usuario_pck.get_cd_estabelecimento))
	into STRICT	qt_meta_dia_w
	;
end if;
if (ie_tipo_inf_p in ('QTMETAHORA', 'QTMETADIAHORA', 'QTMETAMESHORA')) then
	-- Meta diária até a hora atual
	select	round((qt_meta_dia_w / 8.75)::numeric, 2)
	into STRICT	qt_meta_hora_w
	;
end if;
if (ie_tipo_inf_p = 'QTMETAMESHORA') then
	select	obter_qt_dia_util_periodo(dt_ref_mes_w, trunc(dt_parametro_p), wheb_usuario_pck.get_cd_estabelecimento) * 8.75
	into STRICT	qt_horas_passadas_w
	;
	-- Meta mensal até a hora atual
	select	round((qt_meta_hora_w * qt_horas_passadas_w)::numeric, 2)
	into STRICT	qt_meta_mes_hora_w
	;
end if;
if (ie_tipo_inf_p = 'QTMETADIAHORA') then
	select	(dt_parametro_p - (trunc(dt_parametro_p) + 08/24)) * 24
	into STRICT	qt_horas_passadas_w
	;
	if (qt_horas_passadas_w > 10) then
		qt_horas_passadas_w := 10;
	-- Cálculos de hora de almoço
	elsif (qt_horas_passadas_w between 4 and 5.25) then
		qt_horas_passadas_w := 4;
	end if;
	if (qt_horas_passadas_w > 5.25) then
		qt_horas_passadas_w := qt_horas_passadas_w - 1.25;
	end if;
	-- Meta diária até a hora atual
	select	round((qt_meta_hora_w * qt_horas_passadas_w)::numeric, 2)
	into STRICT	qt_meta_dia_hora_w
	;
end if;
if (ie_tipo_inf_p = 'QTOSDIAANT') then
	select	sum(coalesce(qt_informacao, 0))
	into STRICT	qt_os_dia_anterior_w
	from	w_indicador_suporte
	where	dt_referencia = trunc(dt_parametro_p - 1)
	and	ie_informacao = 'QTDOS'
	and	nr_seq_gerencia = nr_seq_gerencia_sup_p;
end if;
if (ie_tipo_inf_p in ('QTBACKLOG', 'PRANTIGA')) then
	select	count(1)
	into STRICT	qt_backlog_w
	from	man_ordem_servico a,
		man_estagio_processo b,
		grupo_suporte c
	where	a.nr_seq_estagio = b.nr_sequencia
	and	a.nr_seq_grupo_sup = c.nr_sequencia
	and	b.ie_suporte = 'S'
	and b.ie_acao = 1
	and	a.ie_status_ordem <> '3'
	and	c.nr_seq_gerencia_sup = nr_seq_gerencia_sup_p;
end if;
if (ie_tipo_inf_p in ('QTANTIGA', 'PRANTIGA')) then
	select	count(1)
	into STRICT	qt_antiga_w
	from	man_ordem_servico a,
		man_estagio_processo b,
		grupo_suporte c
	where	a.nr_seq_estagio = b.nr_sequencia
	and	a.nr_seq_grupo_sup = c.nr_sequencia
	and b.ie_acao = 1
	and	b.ie_suporte = 'S'
	and	a.ie_status_ordem <> '3'
	and	a.dt_ordem_servico < dt_parametro_p - 30
	and	c.nr_seq_gerencia_sup = nr_seq_gerencia_sup_p;
end if;
if (ie_tipo_inf_p = 'QTSLA') then
	select	count(1)
	into STRICT	qt_sla_w
	from	man_estagio_processo c,
    		man_ordem_servico a,
		man_ordem_serv_sla s,
		grupo_suporte g
	where	a.nr_sequencia	= s.nr_seq_ordem
	and	c.nr_sequencia	= a.nr_seq_estagio
	and	a.nr_seq_grupo_sup = g.nr_sequencia
	and	g.nr_seq_gerencia_sup = nr_seq_gerencia_sup_p
	and	c.ie_acao = 1
	and	coalesce(c.ie_suporte, 'N') = 'S'
	and	s.nr_seq_status <> 412
	and	a.ie_status_ordem <> '3';
end if;
if (ie_tipo_inf_p in ('QT','QTSPP')) then
	return qt_total_os_w;
elsif (ie_tipo_inf_p in ('PRPP')) then
	return dividir(qt_total_os_produto_w, qt_total_os_w) * 100;
elsif (ie_tipo_inf_p in ('EN')) then
	return qt_os_encerrada_w;
elsif (ie_tipo_inf_p in ('NEW_OS')) then
	return qt_os_aberta_w;
elsif (ie_tipo_inf_p in ('ENS')) then
	return qt_os_encerrada_classif_w;
elsif (ie_tipo_inf_p in ('QTI')) then
	return qt_os_insatisf_w;
elsif (ie_tipo_inf_p in ('PRI')) then
	return dividir(qt_os_insatisf_w, qt_os_encerrada_classif_w) * 100;
elsif (ie_tipo_inf_p in ('TMAC', 'TMBC')) then
	return qt_min_os_w;
elsif (ie_tipo_inf_p in ('QTDU')) then
	return qt_duvida_w;
elsif (ie_tipo_inf_p in ('PRDU')) then
	return dividir(qt_duvida_des_w, qt_duvida_w) * 100;
elsif (ie_tipo_inf_p = 'QTPESSOAS') then
	return qt_pessoas_w;
elsif (ie_tipo_inf_p = 'QTMETAMES') then
	return qt_meta_mes_w;
elsif (ie_tipo_inf_p = 'QTMETADIA') then
	return qt_meta_dia_w;
elsif (ie_tipo_inf_p = 'QTMETAHORA') then
	return qt_meta_hora_w;
elsif (ie_tipo_inf_p = 'QTMETADIAHORA') then
	return qt_meta_dia_hora_w;
elsif (ie_tipo_inf_p = 'QTMETAMESHORA') then
	return qt_meta_mes_hora_w;
elsif (ie_tipo_inf_p = 'QTBACKLOG') then
	return qt_backlog_w;
elsif (ie_tipo_inf_p = 'QTOSDIAANT') then
	return qt_os_dia_anterior_w;
elsif (ie_tipo_inf_p = 'QTANTIGA') then
	return qt_antiga_w;
elsif (ie_tipo_inf_p = 'PRANTIGA') then
	return dividir(qt_antiga_w, qt_backlog_w) * 100;
elsif (ie_tipo_inf_p = 'QTSLA') then
	return qt_sla_w;
end if;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_info_os_gerencia_sup ( dt_parametro_p timestamp, nr_seq_gerencia_sup_p bigint, ie_tipo_inf_p text, ie_tipo_valor_p text ) FROM PUBLIC;

