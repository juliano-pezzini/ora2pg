-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_titulo_conta ( NR_INTERNO_CONTA_P bigint) RETURNS varchar AS $body$
DECLARE


nr_titulo_w		bigint;
ds_titulo_w		varchar(2000) := '';


c01 CURSOR FOR
	SELECT	/*+ index (a titrece_conpaci_fk_i) */		nr_titulo
	FROM	titulo_receber a
	WHERE (nr_interno_conta_p <> 0)
	AND (nr_interno_conta = nr_interno_conta_p);


BEGIN

OPEN C01;
LOOP
	FETCH C01 INTO nr_titulo_w;
	EXIT WHEN NOT FOUND; /* apply on C01 */
	IF (LENGTH(coalesce(ds_titulo_w, '0')) < 1980) THEN
		ds_titulo_w := ds_titulo_w || nr_titulo_w ||', ';
	END IF;
END LOOP;

CLOSE C01;

IF (LENGTH(ds_titulo_w) > 2) THEN
	ds_titulo_w := SUBSTR(ds_titulo_w,1,LENGTH(ds_titulo_w) - 2);
END IF;

RETURN ds_titulo_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_titulo_conta ( NR_INTERNO_CONTA_P bigint) FROM PUBLIC;

