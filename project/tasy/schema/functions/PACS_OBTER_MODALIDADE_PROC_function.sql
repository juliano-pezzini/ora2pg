-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION pacs_obter_modalidade_proc ( cd_tipo_procedimento_p bigint, cd_sotware_terceiro_p bigint) RETURNS varchar AS $body$
DECLARE

/*
	Esta funtion gera a conversão entre a modalidade de procedimento no Tasy (dom 95)
	e o formato da modadalidade no Software terceiro (PACS) para fim de integração.
	A empresa deve ter seu código no Tasy
	(Cadastros > Sistema > Integração > Empresas para integração > pasta Sistemas para integração)
	Caso o código da empresa não seja encontrado, o retorno será o código no dominio;
*/
ie_retorno_w	varchar(3);

BEGIN
ie_retorno_w := cd_tipo_procedimento_p;
if (cd_sotware_terceiro_p = 28) then -- LabMed
	case cd_tipo_procedimento_p
		/* Anátomo */
			when 74 then return '74';
		/* Angiografia */
		when 7  then return 'XA';
		/* Aritmologia */
		when 70 then return '70';
		/* Avaliação Clínica/Especialista */
    when 73 then return '73';
		/* Biopsia */
			when 75 then return '75';
		/* Cardiologia */
		when 33 then return '33';
		/* Cardiotocografia */
	when 16 then return '16';
		/* Cirurgico */
		when 99 then return '99';
		/* Clínico */
			when 95 then return '95';
		/* Colonoscopia */
		when 26 then return '26';
		/* Consulta */
		when 71 then return '71';
		/* Densitometria Óssea */
	when 15 then return '15';
		/* Diária */
			when 37 then return '37';
		/* Ecocardiografia */
	when 12 then return '12';
		/* Eletrocardiografia */
	when 13 then return '13';
		/* Eletroencefalograma */
	when 94 then return '94';
		/* Eletroneuromiografia */
	when 30 then return '30';
		/* Endoscopia */
		when 92 then return '92';
		/* Ergometria */
		when 14 then return '14';
		/* Fibrobronscopia */
	when 27 then return '27';
		/* Fisioterapia */
		when 85 then return '85';
		/* Gasoterapia */
		when 39 then return '39';
		/* Hemodiálise */
		when 31 then return '31';
		/* Hemodinâmica */
		when 6  then return '6';
		/* Hemoterapia */
		when 80 then return '80';
		/* Laboratorio */
		when 20 then return '20';
		/* Litrotripsia */
		when 32 then return '32';
		/* Mamografia */
		when 5  then return '5';
		/* Medicina Nuclear */
	when 96 then return 'NM';
		/* Nasofibrobroncoscopia */
	when 18 then return '18';
		/* Oftalmologia */
		when 10 then return '10';
		/* Ortopedia */
		when 81 then return '81';
		/* Parto */
			when 77 then return '77';
		/* Plantão UTI */
		when 76 then return '76';
		/* Pneumologia */
		when 9  then return '9';
		/* Psiquiatria */
		when 72 then return '72';
		/* Quimioterapia */
		when 93 then return '93';
		/* Radiografia */
		when 1  then return 'CR';
		/* Radiologia */
		when 34 then return '34';
		/* Radioterapia */
		when 91 then return '91';
		/* Raios-x Contrastado */
	when 97 then return '97';
		/* Ressonância Magnética */
	when 4  then return 'MR';
		/* Taxa */
			when 38 then return '38';
		/* Tomografia */
		when 3  then return 'CT';
		/* Traqueoscopia */
		when 17 then return '17';
		/* Ultrasson Ocular */
	when 25 then return '25';
		/* Ultrassonografia */
	when 2  then return 'US';
		/* Vascular */
		when 11 then return '11';
		/* Video Endoscopia */
	when 8  then return '8';
		else	return null;
	end case;
end if;

return ie_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pacs_obter_modalidade_proc ( cd_tipo_procedimento_p bigint, cd_sotware_terceiro_p bigint) FROM PUBLIC;

