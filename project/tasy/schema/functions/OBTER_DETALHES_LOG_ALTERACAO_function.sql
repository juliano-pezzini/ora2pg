-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_detalhes_log_alteracao (ds_tabela_p text, nr_sequencia_p bigint) RETURNS varchar AS $body$
DECLARE

 
ds_retorno_w	varchar(255);
			

BEGIN 
ds_retorno_w := '';
if (coalesce(nr_sequencia_p,0) > 0) then 
	if ( ds_tabela_p = 'HC_PAD_MATERIAL') then 
		 
		select	SUBSTR(wheb_mensagem_pck.get_texto(795781)||' '||d.cd_pessoa_fisica||' - '||OBTER_NOME_PF(d.CD_PESSOA_FISICA),0,255) 
		into STRICT	ds_retorno_w 
		from	hc_pad_material a, 
			hc_pad_controle b, 
			paciente_home_care c, 
			pessoa_fisica d 
		where	a.nr_seq_controle	= b.nr_sequencia 
		and	b.nr_seq_paciente	= c.nr_sequencia 
		and	c.cd_pessoa_fisica	= d.cd_pessoa_fisica 
		and	a.nr_sequencia		= nr_sequencia_p;
		 
	end if;
	if (ds_tabela_p = 'HC_PAD_EQUIPAMENTO') then 
		 
		select	SUBSTR(wheb_mensagem_pck.get_texto(795781)||' '||d.cd_pessoa_fisica||' - '||OBTER_NOME_PF(d.CD_PESSOA_FISICA),0,255) 
		into STRICT	ds_retorno_w 
		from	hc_pad_equipamento a, 
			hc_pad_controle b, 
			paciente_home_care c, 
			pessoa_fisica d 
		where	a.nr_seq_controle	= b.nr_sequencia 
		and	b.nr_seq_paciente	= c.nr_sequencia 
		and	c.cd_pessoa_fisica	= d.cd_pessoa_fisica 
		and	a.nr_sequencia		= nr_sequencia_p;
		 
	end if;
	if (ds_tabela_p = 'HC_PAD_CONTROLE_PROF') then 
				 
		select	SUBSTR(wheb_mensagem_pck.get_texto(795781)||' '||d.cd_pessoa_fisica||' - '||OBTER_NOME_PF(d.CD_PESSOA_FISICA),0,255) 
		into STRICT	ds_retorno_w 
		from	hc_pad_prof_proced a, 
			hc_pad_controle b, 
			paciente_home_care c, 
			pessoa_fisica d, 
			hc_pad_controle_prof e 
		where	a.nr_seq_profissional	= e.nr_seq_profissional 
		and	e.nr_seq_controle	= b.nr_sequencia 
		and	b.nr_seq_paciente	= c.nr_sequencia 
		and	c.cd_pessoa_fisica	= d.cd_pessoa_fisica 
		and	a.nr_sequencia		= nr_sequencia_p;
		 
	end if;
end if;
 
return	ds_retorno_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_detalhes_log_alteracao (ds_tabela_p text, nr_sequencia_p bigint) FROM PUBLIC;

