-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION after_localizar_mat_rep_js ( nr_atendimento_p bigint, cd_material_p bigint, ie_via_aplicacao_p text, cd_setor_atendimento_p bigint, cd_pessoa_fisica_p text, qt_idade_p bigint, qt_peso_p bigint, ie_se_necessario_p text, ie_opcao_p text, cd_intervalo_p text default null, ie_exec_sql_p text DEFAULT NULL) RETURNS varchar AS $body$
DECLARE

						 
cd_intervalo_w	prescr_material.cd_intervalo%type;


BEGIN 
 
if (ie_exec_sql_p = 'S') then 
 
	select 	max(cd_intervalo_padrao) 
	into STRICT 	cd_intervalo_w 
	from 	material 
	where 	cd_material = cd_material_p;
	 
end if;
 
if (coalesce(cd_intervalo_w::text, '') = '') then 
	cd_intervalo_w	:= Obter_Padrao_Param_Prescr(	nr_atendimento_p, cd_material_p, ie_via_aplicacao_p, cd_setor_atendimento_p, cd_pessoa_fisica_p, Obter_Idade_PF(cd_pessoa_fisica_p, clock_timestamp(),'A'), 
							qt_peso_p, ie_se_necessario_p, ie_opcao_p, cd_intervalo_p);
end if;
		 
return 	cd_intervalo_w;
		 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION after_localizar_mat_rep_js ( nr_atendimento_p bigint, cd_material_p bigint, ie_via_aplicacao_p text, cd_setor_atendimento_p bigint, cd_pessoa_fisica_p text, qt_idade_p bigint, qt_peso_p bigint, ie_se_necessario_p text, ie_opcao_p text, cd_intervalo_p text default null, ie_exec_sql_p text DEFAULT NULL) FROM PUBLIC;

