-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_regulacao_gestao_vagas (cd_solicitacao_p text, cd_tipo_vaga_p text) RETURNS bigint AS $body$
DECLARE

									
	nr_seq_regra_w 		regra_regulacao.nr_sequencia%type;


BEGIN
	select MAX(rr.nr_sequencia)
	into STRICT 	nr_seq_regra_w
	from 	regra_regulacao rr,
			regra_regulacao_itens rri
	where coalesce(rr.ie_solicitacao, cd_solicitacao_p) = cd_solicitacao_p
			and coalesce(rr.ie_tipo_vaga, cd_tipo_vaga_p) = cd_tipo_vaga_p
			and rr.nr_sequencia = rri.nr_seq_regra_reg
			and rri.ie_situacao = 'A'
			and		coalesce(rr.ie_tipo_parecer,'R') = 'R'
			and rr.ie_tipo = 'SV';
	
	return nr_seq_regra_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_regulacao_gestao_vagas (cd_solicitacao_p text, cd_tipo_vaga_p text) FROM PUBLIC;

