-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION sus_obter_tipo_laudo ( nr_interno_conta_p bigint, cd_procedimento_p bigint) RETURNS bigint AS $body$
DECLARE


ie_tipo_laudo_sus_w	smallint;


BEGIN
ie_tipo_laudo_sus_w	:= 99;

/*             vacina anti-rh  */

if (cd_procedimento_p = 99020017) 		then
	ie_tipo_laudo_sus_w	:= 4;
end if;

/*             uso de fatores de coagulação  */

if	((substr(cd_procedimento_p,1,2) = '92') 		or (substr(cd_procedimento_p,1,5) = '99063'))	then
	ie_tipo_laudo_sus_w	:= 6;
end if;

/*             permanencia a maior  */

if (substr(cd_procedimento_p,1,5) = '99003') 	then
	ie_tipo_laudo_sus_w	:= 11;
end if;

/*             nutrição parenteral  */

if       	((substr(cd_procedimento_p,1,5) = '99300')	or (substr(cd_procedimento_p,1,5) = '99500')	or (substr(cd_procedimento_p,1,5) = '98500')  	or (substr(cd_procedimento_p,1,5) = '98300'))	then
	ie_tipo_laudo_sus_w	:= 8;
end if;


/*             tomografia  */

if       	((substr(cd_procedimento_p,1,5) = '97013')		or (substr(cd_procedimento_p,1,5) = '97014')		or (substr(cd_procedimento_p,1,5) = '97015'))		then
	ie_tipo_laudo_sus_w	:= 10;
end if;


/*             Outros  para cirurgias multiplas, politraumatizados, tratamento prolongado e psiquiatria */

if	((substr(cd_procedimento_p,1,5) = '76400')		or (substr(cd_procedimento_p,1,5) between 97001 and 97012)	or (substr(cd_procedimento_p,1,5) between 97203 and 97223)	or (cd_procedimento_p between 69000000 and 91999999)	or (cd_procedimento_p between 31000000 and 44999999))	then
	ie_tipo_laudo_sus_w	:= 9;
end if;

/* Ricardo 09/02/2004 - Incluída a condição para tratar todos os procedimento menos o 97220000*/

/* Ricardo 21/10/2004 - Menos os procedimentos 97221007 e 97222003 OS 12296 */

/* Adelson 06/01/2006 - Menos os procedimentos 97209007 e 97210005 OS 28091 */

if	cd_procedimento_p in (97220000,97209007,97210005,97221007,97222003) then
	ie_tipo_laudo_sus_w	:= 99;
end if;

return ie_tipo_laudo_sus_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION sus_obter_tipo_laudo ( nr_interno_conta_p bigint, cd_procedimento_p bigint) FROM PUBLIC;

