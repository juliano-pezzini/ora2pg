-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION ptu_obter_servico_conversao ( cd_servico_p bigint, nr_seq_pedido_p bigint, nr_seq_ped_aut_serv_p bigint, ie_tipo_transacao_p text) RETURNS bigint AS $body$
DECLARE


cd_servico_w			bigint;


BEGIN

if (ie_tipo_transacao_p	= 'RA') then
	begin
		select	cd_servico
		into STRICT	cd_servico_w
		from	ptu_pedido_aut_servico
		where	nr_seq_pedido		= nr_seq_pedido_p
		and	cd_servico_consersao	= cd_servico_p
		and	nr_sequencia		= nr_seq_ped_aut_serv_p;
	exception
	when others then
		cd_servico_w	:= null;
	end;
elsif (ie_tipo_transacao_p	= 'RAC') then
	begin
		select	cd_servico
		into STRICT	cd_servico_w
		from	ptu_pedido_compl_aut_serv
		where	nr_seq_pedido		= nr_seq_pedido_p
		and	cd_servico_conversao	= cd_servico_p
		and	nr_sequencia		= nr_seq_ped_aut_serv_p;
	exception
	when others then
		cd_servico_w	:= null;
	end;
elsif (ie_tipo_transacao_p	= 'OS') then
	begin
		select	cd_servico
		into STRICT	cd_servico_w
		from	ptu_req_ord_serv_servico
		where	nr_seq_req_ord		= nr_seq_pedido_p
		and	cd_servico_consersao	= cd_servico_p;
	exception
	when others then
		cd_servico_w	:= null;
	end;
end if;

return	cd_servico_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION ptu_obter_servico_conversao ( cd_servico_p bigint, nr_seq_pedido_p bigint, nr_seq_ped_aut_serv_p bigint, ie_tipo_transacao_p text) FROM PUBLIC;

