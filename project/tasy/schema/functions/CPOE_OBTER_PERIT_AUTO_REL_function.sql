-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION cpoe_obter_perit_auto_rel ( qt_hora_min_sessao_p text, nr_seq_maq_cicladora_p bigint, nr_serie_p bigint, qt_minimo_volume_p bigint, ie_volume_alarme_p text, ie_perm_inteligente_p text, ie_apagar_visor_p text, ie_modo_dialise_p text, qt_tempo_min_drenagem_p text, qt_limite_uf_negativo_p bigint, qt_limite_uf_positivo_p bigint, ie_ausente_p text, opcao_linha_p bigint) RETURNS varchar AS $body$
DECLARE


ds_linha_um_w		varchar(4000);
ds_linha_dois_w		varchar(4000);
ds_linha_tres_w		varchar(4000);
ds_retorno_w		varchar(4000);

	function hora_min_sessao return text is
	;
BEGIN
		return ' ' || obter_desc_expressao(289010, null) || ': ' || qt_hora_min_sessao_p || '						';
	end;

	function maq_cicladora return varchar2 is
	begin
		return ' ' || obter_desc_expressao(292876, null) || ': ' || obter_desc_maq_cicladora(nr_seq_maq_cicladora_p) || '						';
	end;

	function serie return varchar2 is
	begin
		return ' ' || obter_desc_expressao(293891, null) || ': ' || nr_serie_p || '						';
	end;

	function minimo_volume return varchar2 is
	begin
		return ' ' || obter_desc_expressao(668366, null) || ': ' || qt_minimo_volume_p || '						';
	end;

	function volume_alarme return varchar2 is
	begin
		return ' ' || obter_desc_expressao(302243, null) || ': ' || obter_valor_dominio(4805,ie_volume_alarme_p) || '						';
	end;

	function perm_inteligente return varchar2 is
	begin
		return ' ' || obter_desc_expressao(295528, null) || ': ' || obter_valor_dominio(6,ie_perm_inteligente_p) || '						';
	end;

	function apagar_visor return varchar2 is
	begin
		return ' ' || obter_desc_expressao(283580, null) || ': ' || obter_valor_dominio(6,ie_apagar_visor_p) || '						';
	end;

	function modo_dialise return varchar2 is
	begin
		return ' ' || obter_desc_expressao(293391, null) || ': '|| obter_valor_dominio(4806,ie_modo_dialise_p) || '						';
	end;

	function dados_modo_dialise return varchar2 is
	begin
		return obter_desc_expressao(668367, null) || ': '|| qt_tempo_min_drenagem_p || '     		 ' || obter_desc_expressao(292588, null) || ': '|| qt_limite_uf_negativo_p
			|| '   		   ' || obter_desc_expressao(292589, null) || ': '|| qt_limite_uf_positivo_p || '     		 ' || obter_desc_expressao(284052, null) || ': '|| obter_valor_dominio(6,ie_ausente_p);
	end;

begin
--Inserido espaços pois futuramente relatório wate que usa isto se tornará um cate onde será melhorado isso.
	if (hora_min_sessao IS NOT NULL AND hora_min_sessao::text <> '') then
		ds_linha_um_w := hora_min_sessao();
	end if;

	if (nr_seq_maq_cicladora_p IS NOT NULL AND nr_seq_maq_cicladora_p::text <> '') then
		ds_linha_um_w := ds_linha_um_w || maq_cicladora();
	end if;

	if (nr_serie_p IS NOT NULL AND nr_serie_p::text <> '') then
		ds_linha_um_w := ds_linha_um_w || serie();
	end if;

	if (qt_minimo_volume_p IS NOT NULL AND qt_minimo_volume_p::text <> '') then
		ds_linha_um_w := ds_linha_um_w || minimo_volume();
	end if;

	if (ie_volume_alarme_p IS NOT NULL AND ie_volume_alarme_p::text <> '') then
		ds_linha_dois_w := ds_linha_dois_w || volume_alarme();
	end if;

	if (ie_perm_inteligente_p IS NOT NULL AND ie_perm_inteligente_p::text <> '') then
		ds_linha_dois_w := ds_linha_dois_w || perm_inteligente();
	end if;

	if (ie_apagar_visor_p IS NOT NULL AND ie_apagar_visor_p::text <> '') then
		ds_linha_dois_w := ds_linha_dois_w || apagar_visor();
	end if;

	ds_linha_tres_w := modo_dialise();

	if (ie_modo_dialise_p = 'B') then
		ds_linha_tres_w := ds_linha_tres_w || ' ' || dados_modo_dialise();
	end if;

	if (opcao_linha_p = 1) then
		ds_retorno_w := ds_linha_um_w;
	elsif (opcao_linha_p = 2) then
		ds_retorno_w := ds_linha_dois_w;
	else
		ds_retorno_w := ds_linha_tres_w;
	end if;

	return	ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION cpoe_obter_perit_auto_rel ( qt_hora_min_sessao_p text, nr_seq_maq_cicladora_p bigint, nr_serie_p bigint, qt_minimo_volume_p bigint, ie_volume_alarme_p text, ie_perm_inteligente_p text, ie_apagar_visor_p text, ie_modo_dialise_p text, qt_tempo_min_drenagem_p text, qt_limite_uf_negativo_p bigint, qt_limite_uf_positivo_p bigint, ie_ausente_p text, opcao_linha_p bigint) FROM PUBLIC;

