-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION sus_obter_valores_proc ( dt_procedimento_p timestamp, cd_procedimento_p bigint, ie_origem_proced_p bigint, cd_estabelecimento_p bigint, ie_valor_p text) RETURNS bigint AS $body$
DECLARE

vl_retorno_w		double precision := 0;
vl_aux_num_w		double precision;
dt_aux_date_w		timestamp;
ds_aux_varch_w		varchar(255);
vl_procedimento_w	double precision := 0;
vl_medico_w		double precision := 0;
vl_custo_operacional_w	double precision := 0;
vl_filme_w		double precision := 0;
vl_diaria_w		double precision := 0;
vl_matmed_w		double precision := 0;
vl_taxas_W		double precision := 0;
vl_sadt_w		double precision := 0;
vl_contraste_w		double precision := 0;
vl_gesso_w		double precision := 0;
vl_quimioterapia_w	double precision := 0;
vl_dialise_w		double precision := 0;
vl_thp_w		double precision := 0;
vl_filme_rx_w		double precision := 0;
vl_filme_ressonancia_w	double precision := 0;
vl_anestesista_w	double precision := 0;
vl_sadt_rx_w		double precision := 0;
vl_sadt_pc_w		double precision := 0;
vl_outros_w		double precision := 0;
vl_ato_medico_w		double precision := 0;
vl_ato_anestesista_w	double precision := 0;
ie_valor_w		varchar(10);


/* ie_opcao_p    CO - Custo Operacional
		 MA - Material/Medicamento
		 ME - MÃ©dico
*/
BEGIN

SELECT * FROM DEFINE_PRECO_PROC_SUS(dt_procedimento_p, cd_procedimento_p, ie_origem_proced_p, cd_estabelecimento_p, vl_aux_num_w, vl_aux_num_w, vl_matmed_w, vl_diaria_w, vl_taxas_W, vl_medico_w, vl_sadt_w, vl_contraste_w, vl_gesso_w, vl_quimioterapia_w, vl_dialise_w, vl_thp_w, vl_filme_rx_w, vl_filme_ressonancia_w, vl_anestesista_w, vl_sadt_rx_w, vl_sadt_pc_w, vl_outros_w, vl_ato_medico_w, vl_ato_anestesista_w, vl_procedimento_w, vl_aux_num_w, dt_aux_date_w, ds_aux_varch_w, vl_aux_num_w) INTO STRICT vl_aux_num_w, vl_aux_num_w, vl_matmed_w, vl_diaria_w, vl_taxas_W, vl_medico_w, vl_sadt_w, vl_contraste_w, vl_gesso_w, vl_quimioterapia_w, vl_dialise_w, vl_thp_w, vl_filme_rx_w, vl_filme_ressonancia_w, vl_anestesista_w, vl_sadt_rx_w, vl_sadt_pc_w, vl_outros_w, vl_ato_medico_w, vl_ato_anestesista_w, vl_procedimento_w, vl_aux_num_w, dt_aux_date_w, ds_aux_varch_w, vl_aux_num_w;


ie_valor_w	:= upper(ie_valor_p);


if (ie_valor_w	= 'CO' ) then
	vl_retorno_w	:= vl_diaria_w + vl_taxas_w + vl_sadt_w + vl_thp_w + vl_dialise_w + vl_gesso_w +
			   vl_sadt_rx_w + vl_sadt_pc_w + vl_matmed_w + 	vl_contraste_w +   vl_filme_rx_w +
			   vl_quimioterapia_w + vl_filme_ressonancia_w + vl_outros_w;
elsif (ie_valor_w	= 'ME' ) then
	vl_retorno_w	:= vl_medico_w;
elsif (ie_valor_w	= 'MA') then
	vl_retorno_w	:= vl_matmed_w;
end if;


return vl_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION sus_obter_valores_proc ( dt_procedimento_p timestamp, cd_procedimento_p bigint, ie_origem_proced_p bigint, cd_estabelecimento_p bigint, ie_valor_p text) FROM PUBLIC;

