-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION calcula_baros_tr_md (ie_auto_estima_p text, ie_disposicao_fisica_p text, ie_capacidade_relacionar_p text, ie_disp_trabalho_p text, ie_interesse_sexo_p text, ie_complicacao_p text, ie_reoperacao_p text, ie_perda_peso_p bigint, ie_condicao_clinica_p bigint ) RETURNS bigint AS $body$
DECLARE


   qt_ponto_w	real := 0;

BEGIN
    --INICIO MD1
    if (ie_auto_estima_p = '1') then
        qt_ponto_w := -1;
    elsif (ie_auto_estima_p = '2') then
        qt_ponto_w := qt_ponto_w - 0.5;
    elsif (ie_auto_estima_p = '4') then
        qt_ponto_w := qt_ponto_w + 0.5;
    elsif (ie_auto_estima_p = '5') then
        qt_ponto_w := qt_ponto_w + 1;
    end if;
    --FIM MD1
    --INICIO MD2
    if (ie_disposicao_fisica_p = '1') then
        qt_ponto_w := qt_ponto_w -0.5;
    elsif (ie_disposicao_fisica_p = '2') then
        qt_ponto_w := qt_ponto_w - 0.25;
    elsif (ie_disposicao_fisica_p = '4') then
        qt_ponto_w := qt_ponto_w + 0.25;
    elsif (ie_disposicao_fisica_p = '5') then
        qt_ponto_w := qt_ponto_w + 0.5;
    end if;	
    --FIM MD2
    --INICIO MD3
    if (ie_capacidade_relacionar_p = '1') then
        qt_ponto_w := qt_ponto_w - 0.5;
    elsif (ie_capacidade_relacionar_p = '2') then
        qt_ponto_w := qt_ponto_w - 0.25;
    elsif (ie_capacidade_relacionar_p = '4') then
        qt_ponto_w := qt_ponto_w + 0.25;
    elsif (ie_capacidade_relacionar_p = '5') then
        qt_ponto_w := qt_ponto_w + 0.5;
    end if;	
    --FIM MD3
    --INICIO MD4
    if (ie_disp_trabalho_p = '1') then
        qt_ponto_w := qt_ponto_w - 0.5;
    elsif (ie_disp_trabalho_p = '2') then
        qt_ponto_w := qt_ponto_w - 0.25;
    elsif (ie_disp_trabalho_p = '4') then
        qt_ponto_w := qt_ponto_w + 0.25;
    elsif (ie_disp_trabalho_p = '5') then
        qt_ponto_w := qt_ponto_w + 0.5;
    end if;	
    --FIM MD4
    --INICIO MD5
    if (ie_interesse_sexo_p = '1') then
        qt_ponto_w := qt_ponto_w - 0.5;
    elsif (ie_interesse_sexo_p = '2') then
        qt_ponto_w := qt_ponto_w - 0.25;
    elsif (ie_interesse_sexo_p = '4') then
        qt_ponto_w := qt_ponto_w + 0.25;
    elsif (ie_interesse_sexo_p = '5') then
        qt_ponto_w := qt_ponto_w + 0.5;
    end if;	
    --FIM MD5
    --INICIO MD6
    if (ie_complicacao_p = 'ME') then
        qt_ponto_w := qt_ponto_w - 0.2;
    elsif (ie_complicacao_p = 'MA') then
        qt_ponto_w := qt_ponto_w - 1;
    end if;
    --FIM MD6
    --INICIO MD7
    if (ie_reoperacao_p = 'S') then
        qt_ponto_w := qt_ponto_w - 1;
    end if;
    --FIM MD7
    --INICIO MD8
    qt_ponto_w := coalesce(qt_ponto_w,0)  + coalesce(ie_perda_peso_p,0);
    qt_ponto_w := coalesce(qt_ponto_w,0)  + coalesce(ie_condicao_clinica_p,0);
    --FIM MD8
    RETURN coalesce(qt_ponto_w,0);
   
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION calcula_baros_tr_md (ie_auto_estima_p text, ie_disposicao_fisica_p text, ie_capacidade_relacionar_p text, ie_disp_trabalho_p text, ie_interesse_sexo_p text, ie_complicacao_p text, ie_reoperacao_p text, ie_perda_peso_p bigint, ie_condicao_clinica_p bigint ) FROM PUBLIC;

