-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_extenso_mx (valor_p bigint) RETURNS varchar AS $body$
DECLARE


type Unidades is table of varchar(200) index by integer;
type UnidadesVeinte is table of varchar(200) index by integer;
type Dezenas is table of varchar(200) index by integer;
type DezenaVeinte is table of varchar(200) index by integer;
type Centenas is table of varchar(200) index by integer;


UnidadesVeinte_w	UnidadesVeinte;
DezenaVeinte_w		DezenaVeinte;

Unidades_w			Unidades;
Dezenas_w			Dezenas;
Centenas_w			Centenas;
valor_w				integer := 0;
centavos_w			integer := 0;

valor_unidade_w		integer := 0;
valor_dezena_w		integer := 0;
valor_centena_w		integer := 0;

ds_valor_w			varchar(2000) := '';

ie_moeda_w			varchar(10) := ' Pesos';
ie_centavo_w		varchar(10) := ' M.N.';


BEGIN

/*Fonte: http://soespanhol.com.br/conteudo/numerais.php
Teste por extenso: https://www.bomespanhol.com.br/vocabulario/numeros-por-extenso*/
Unidades_w(1)		:= 'Un';
UnidadesVeinte_w(1)	:= 'uno';

Unidades_w(2)		:= 'Dos';
UnidadesVeinte_w(2)	:= 'dos';

Unidades_w(3)		:= 'Tres';
UnidadesVeinte_w(3)	:= 'tres';

Unidades_w(4)		:= 'Cuatro';
UnidadesVeinte_w(4)	:= 'cuatro';


Unidades_w(5)		:= 'Cinco';
UnidadesVeinte_w(5)	:= 'cinco';

Unidades_w(6)		:= 'Seis';
UnidadesVeinte_w(6)	:= 'seis';

Unidades_w(7)		:= 'Siete';
UnidadesVeinte_w(7)	:= 'siete';

Unidades_w(8)		:= 'Ocho';
UnidadesVeinte_w(8)	:= 'ocho';

Unidades_w(9)		:= 'Nueve';
UnidadesVeinte_w(9)	:= 'nueve';

Unidades_w(10)	:= 'Diez';
Unidades_w(11)	:= 'Once';
Unidades_w(12)	:= 'Doce';
Unidades_w(13)	:= 'Trece';
Unidades_w(14)	:= 'Catorce';
Unidades_w(15)	:= 'Quince';
Unidades_w(16)	:= 'Dieciseis';
Unidades_w(17)	:= 'Diecisiete';
Unidades_w(18)	:= 'Dieciocho';
Unidades_w(19)	:= 'Diecinueve';

Dezenas_w(1)		:= 'Diez';
Dezenas_w(2)		:= 'Veinte';
DezenaVeinte_w(2)	:= 'Veinti';

Dezenas_w(3)	:= 'Treinta';
Dezenas_w(4)	:= 'Cuarenta';
Dezenas_w(5)	:= 'Cincuenta';
Dezenas_w(6)	:= 'Sesenta';
Dezenas_w(7)	:= 'Setenta';
Dezenas_w(8)	:= 'Ochenta';
Dezenas_w(9)	:= 'Noventa';

Centenas_w(1)	:= 'Cien';
Centenas_w(2)	:= 'Doscientos';
Centenas_w(3)	:= 'Trescientos';
Centenas_w(4)	:= 'Cuatrocientos';
Centenas_w(5)	:= 'Quinientos';
Centenas_w(6)	:= 'Seiscientos';
Centenas_w(7)	:= 'Setecientos';
Centenas_w(8)	:= 'Ochocientos';
Centenas_w(9)	:= 'Novecientos';

valor_w 	:= Trunc(valor_p);
centavos_w	:= trunc((valor_p - trunc(valor_p)) * 100);

if (valor_w = 1) then
	ie_moeda_w := ' Peso';
end if;


if (centavos_w = 1) then
	ie_centavo_w := ' M.N.';
end if;


if (valor_w >= 1000000000) then
	if (Trunc(valor_w/1000000000) = 1) then
		--ds_valor_w	:= ds_valor_w || ' ' || Unidades_w(Trunc(valor_w/1000000000)) || ' Billón,';
		ds_valor_w	:= ds_valor_w || ' ' || Unidades_w(Trunc(valor_w/1000000000)) || ' Mil';
	else

		--ds_valor_w	:= ds_valor_w || ' ' || Unidades_w(Trunc(valor_w/1000000000)) || ' Billones,';
		ds_valor_w	:= ds_valor_w || ' ' || Unidades_w(Trunc(valor_w/1000000000)) || ' Mil';
	end if;

	valor_w := mod(valor_w,1000000000);
end if;


if (valor_w >= 100000000) then
	if ((mod(valor_w,1000000000) < 1000000) and (Trunc(valor_w/100000000) = 1)) or (mod(valor_w,100000000) > 1)then

		if (Trunc(valor_w/100000000) = 1) then
			ds_valor_w	:= ds_valor_w || ' ' || 'Ciento';
			valor_centena_w := valor_w;
		else

			ds_valor_w	:= ds_valor_w || ' ' || Centenas_w(Trunc(valor_w/100000000));
		end if;


	else

		ds_valor_w	:= ds_valor_w || ' ' || 'Ciento';
		valor_centena_w := valor_w;
	end if;

	valor_w := mod(valor_w,100000000);
	if (valor_w = 0) or (valor_w < 1000000) then
		ds_valor_w := ds_valor_w || ' Millones';
	end if;
end if;



if (valor_w >= 20000000) then
	if (valor_w > 20000000) and (valor_w < 30000000) then
		ds_valor_w := ds_valor_w || ' ' || DezenaVeinte_w(Trunc(valor_w/10000000));
	else
		ds_valor_w := ds_valor_w || ' ' || Dezenas_w(Trunc(valor_w/10000000));
	end if;
	valor_dezena_w := valor_w;
    valor_w := mod(valor_w,10000000);
	if (valor_w = 0) or (valor_w < 1000000) then
		ds_valor_w := ds_valor_w || ' Millones';
	end if;
else
	valor_dezena_w := valor_w;
end if;



if (valor_w >= 1000000) then
	if (ds_valor_w IS NOT NULL AND ds_valor_w::text <> '') and (valor_dezena_w >= 30000000) then
		ds_valor_w := ds_valor_w || ' y';
	end if;
	if (Trunc(valor_w / 1000000) = 1) then
		ds_valor_w := ds_valor_w || ' ' || Unidades_w(Trunc(valor_w / 1000000)) || ' Millón';
	else
		if (valor_dezena_w > 20000000) and (valor_dezena_w < 30000000) then
			ds_valor_w := ds_valor_w || UnidadesVeinte_w(Trunc(valor_w / 1000000)) || ' Millones';
		else

			ds_valor_w := ds_valor_w || ' ' || Unidades_w(Trunc(valor_w / 1000000)) || ' Millones';
		end if;
	end if;
	valor_dezena_w := 0;
	valor_centena_w := 0;

	valor_w := Mod(valor_w,1000000);
	if (valor_w = 0) then
		ds_valor_w := ds_valor_w || ' de';
	end if;
end if;

if (valor_w >= 100000) then
	if ((mod(valor_w,100000) < 1000) and (Trunc(valor_w / 100000) = 1)) or (Trunc(valor_w / 100000) > 1) then
		if (Trunc(valor_w / 100000) = 1) then
			ds_valor_w := ds_valor_w || ' ' || 'Cien';
		else
			ds_valor_w := ds_valor_w || ' ' || Centenas_w(Trunc(valor_w / 100000));
		end if;
	else
		ds_valor_w := ds_valor_w || ' ' || 'Ciento';
		valor_centena_w := valor_w;
	end if;

	valor_w := mod(valor_w, 100000);
	if (valor_w = 0) or (valor_w < 1000) then
			ds_valor_w := ds_valor_w || ' Mil';
			valor_centena_w := 0;
	end if;
end if;

if (valor_w >= 20000) then
	if (valor_w > 20999) and (valor_w < 30000) then
		ds_valor_w := ds_valor_w || ' ' || DezenaVeinte_w(Trunc(valor_w / 10000));
	else
		ds_valor_w := ds_valor_w || ' ' || Dezenas_w(Trunc(valor_w / 10000));
	end if;
    valor_dezena_w := valor_w;
	valor_w := mod(valor_w, 10000);
	if (valor_w = 0) or (valor_w < 1000) then
		ds_valor_w := ds_valor_w || ' Mil';
	end if;
else
    valor_dezena_w := valor_w;
end if;


if (valor_w >= 1000) then
	if (ds_valor_w IS NOT NULL AND ds_valor_w::text <> '') and (valor_dezena_w >= 30000) then
		ds_valor_w :=  ds_valor_w || ' y';
	end if;
		
	if (valor_dezena_w > 20000) and (valor_dezena_w < 30000) then
		ds_valor_w := ds_valor_w || UnidadesVeinte_w(Trunc(valor_w / 1000));
	else
		ds_valor_w := ds_valor_w || ' '||Unidades_w(Trunc(valor_w / 1000));

	end if;
	valor_dezena_w := 0;
	valor_centena_w := 0;
	
	valor_w := mod(valor_w, 1000);
  
  if (trim(both ds_valor_w) = trim(both Unidades_w(1))) then
    ds_valor_w := ' Mil';
  else  
    ds_valor_w := ds_valor_w || ' Mil';
  end if;
end if;


if (valor_w >= 100) then
	if ((valor_w / 100) = 1) or (Trunc(valor_w / 100) > 1) then
		ds_valor_w := ds_valor_w || ' ' || Centenas_w(Trunc(valor_w / 100));
	else
		ds_valor_w := ds_valor_w || ' ' || 'Ciento';
	end if;

	valor_w := mod(valor_w, 100);
end if;

if (valor_w >= 20) then
	valor_dezena_w := valor_w;
	if (valor_dezena_w > 20) and (valor_dezena_w < 30) then
		ds_valor_w := ds_valor_w || ' ' || DezenaVeinte_w(Trunc(valor_w / 10));
	else
		ds_valor_w := ds_valor_w || ' ' || Dezenas_w(Trunc(valor_w / 10));
	end if;
	valor_w := mod(valor_w, 10);
else
	valor_dezena_w := valor_w;
end if;

if (valor_w >= 1) then
	if (ds_valor_w IS NOT NULL AND ds_valor_w::text <> '') and (valor_dezena_w >= 30) then
		ds_valor_w := ds_valor_w || ' y';
	end if;
	if (valor_dezena_w > 20) and (valor_dezena_w < 30) then
		ds_valor_w := ds_valor_w || UnidadesVeinte_w(valor_w);
	else
		ds_valor_w := ds_valor_w || ' ' || Unidades_w(valor_w);
	end if;
end if;

ds_valor_w := ds_valor_w || ie_moeda_w;

if (Centavos_w >= 0) then
	ds_valor_w := ds_valor_w || ' ' || lpad(centavos_w,2,'0') || '/100' || ie_centavo_w;
end if;

return ds_valor_w;

RAISE NOTICE '%', ds_valor_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_extenso_mx (valor_p bigint) FROM PUBLIC;

