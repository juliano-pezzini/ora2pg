-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_dados_prob_alta ( nr_atendimento_p bigint, ie_tipo_p bigint, ie_cd_ds_p text default 'D') RETURNS varchar AS $body$
DECLARE

ds_retorno_w	varchar(255);

BEGIN
if (coalesce(nr_atendimento_p,0) > 0) and (coalesce(ie_tipo_p,0) > 0) then 
	if (coalesce(ie_cd_ds_p,'D') = 'D') then 
	 
		if (coalesce(ie_tipo_p,0) = 1) then 
			select	max(substr(obter_valor_dominio(5708,ie_tipo_status_alta),1,255)) 
			into STRICT	ds_retorno_w 
			from	atendimento_paciente 
			where	nr_atendimento = nr_atendimento_p;
		elsif (coalesce(ie_tipo_p,0) = 2) then 
			select	max(substr(obter_valor_dominio(5683,ie_tipo_alta),1,255)) 
			into STRICT	ds_retorno_w 
			from	atendimento_paciente 
			where	nr_atendimento = nr_atendimento_p;
		elsif (coalesce(ie_tipo_p,0) = 3) then 
			select	max(substr(obter_valor_dominio(1410,ie_tipo_vaga),1,255)) 
			into STRICT	ds_retorno_w 
			from	atendimento_paciente 
			where	nr_atendimento = nr_atendimento_p;
		elsif (coalesce(ie_tipo_p,0) = 4) then 
			select	max(substr(obter_nome_setor(cd_setor_desejado),1,255)) 
			into STRICT	ds_retorno_w 
			from	atendimento_paciente 
			where	nr_atendimento = nr_atendimento_p;
		elsif (coalesce(ie_tipo_p,0) = 5) then 
			select	max(substr(obter_descricao_padrao('TIPO_ACOMODACAO','DS_TIPO_ACOMODACAO', CD_TIPO_ACOMOD_DESEJ),1,255)) 
			into STRICT	ds_retorno_w 
			from	atendimento_paciente 
			where	nr_atendimento = nr_atendimento_p;
		elsif (coalesce(ie_tipo_p,0) = 6) then 
			select	max(substr(ds_obs_prev_alta,1,255)) 
			into STRICT	ds_retorno_w 
			from	atendimento_paciente 
			where	nr_atendimento = nr_atendimento_p;		
		end if;
	else 
	 
		if (coalesce(ie_tipo_p,0) = 1) then 
			select	max(ie_tipo_status_alta) 
			into STRICT	ds_retorno_w 
			from	atendimento_paciente 
			where	nr_atendimento = nr_atendimento_p;
		elsif (coalesce(ie_tipo_p,0) = 2) then 
			select	max(ie_tipo_alta) 
			into STRICT	ds_retorno_w 
			from	atendimento_paciente 
			where	nr_atendimento = nr_atendimento_p;
		elsif (coalesce(ie_tipo_p,0) = 3) then 
			select	max(ie_tipo_vaga) 
			into STRICT	ds_retorno_w 
			from	atendimento_paciente 
			where	nr_atendimento = nr_atendimento_p;
		elsif (coalesce(ie_tipo_p,0) = 4) then 
			select	max(cd_setor_desejado) 
			into STRICT	ds_retorno_w 
			from	atendimento_paciente 
			where	nr_atendimento = nr_atendimento_p;
		elsif (coalesce(ie_tipo_p,0) = 5) then 
			select	max(cd_tipo_acomod_desej) 
			into STRICT	ds_retorno_w 
			from	atendimento_paciente 
			where	nr_atendimento = nr_atendimento_p;
		elsif (coalesce(ie_tipo_p,0) = 6) then 
			select	max(substr(ds_obs_prev_alta,1,255)) 
			into STRICT	ds_retorno_w 
			from	atendimento_paciente 
			where	nr_atendimento = nr_atendimento_p;		
		end if;	
	end if;
end if;
		 
return	ds_retorno_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_dados_prob_alta ( nr_atendimento_p bigint, ie_tipo_p bigint, ie_cd_ds_p text default 'D') FROM PUBLIC;

