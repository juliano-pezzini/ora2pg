-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_paciente_recuperacao ( cd_pessoa_fisica_p bigint, nr_atendimento_p bigint) RETURNS varchar AS $body$
DECLARE


ds_retorno_w	           varchar(60);	
dt_inicio_recuperacao_w   timestamp;
dt_fim_recuperacao_w       timestamp;


BEGIN  
    SELECT dt_inicio_recuperacao
    INTO STRICT   dt_inicio_recuperacao_w
    FROM   recuperacao_paciente
    WHERE  cd_pessoa_fisica = cd_pessoa_fisica_p and nr_atendimento = nr_atendimento_p;

    SELECT dt_fim_recuperacao
    INTO STRICT   dt_fim_recuperacao_w
    FROM   recuperacao_paciente
    WHERE  cd_pessoa_fisica = cd_pessoa_fisica_p and nr_atendimento = nr_atendimento_p;

/* Paciente em recuperação */

    if ((dt_inicio_recuperacao_w IS NOT NULL AND dt_inicio_recuperacao_w::text <> '') and coalesce(dt_fim_recuperacao_w::text, '') = '') then
      SELECT obter_expressao_dic_objeto(1066824)
      INTO STRICT   ds_retorno_w
;
    end if;

/* Paciente Recuperado */

    if (dt_inicio_recuperacao_w IS NOT NULL AND dt_inicio_recuperacao_w::text <> '' AND dt_fim_recuperacao_w IS NOT NULL AND dt_fim_recuperacao_w::text <> '') then
     SELECT obter_expressao_dic_objeto(1066825) 
      INTO STRICT  ds_retorno_w
;
    end if;

return	ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_paciente_recuperacao ( cd_pessoa_fisica_p bigint, nr_atendimento_p bigint) FROM PUBLIC;

