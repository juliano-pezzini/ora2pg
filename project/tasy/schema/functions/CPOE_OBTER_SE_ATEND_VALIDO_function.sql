-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION cpoe_obter_se_atend_valido (nr_seq_item_p bigint, ie_tipo_item_p text, nr_atendimento_p bigint) RETURNS varchar AS $body$
DECLARE
	
	ie_atendimento_valido_w	varchar(1);	

BEGIN	
	IF (ie_tipo_item_p	= 'P')	THEN
		SELECT	CASE WHEN Count(1)=0 THEN  'N'  ELSE 'S' END 	
		INTO STRICT	ie_atendimento_valido_w	
		FROM	cpoe_procedimento	
		WHERE	nr_sequencia	= nr_seq_item_p	
		AND		nr_atendimento	= nr_atendimento_p;	
	ELSIF (ie_tipo_item_p	= 'N')	THEN
		SELECT	CASE WHEN Count(1)=0 THEN  'N'  ELSE 'S' END 	
		INTO STRICT	ie_atendimento_valido_w	
		FROM	cpoe_dieta	
		WHERE	nr_sequencia	= nr_seq_item_p	
		AND		nr_atendimento	= nr_atendimento_p;	
	ELSIF (ie_tipo_item_p	IN ('MA', 'M')	)	THEN
		SELECT	CASE WHEN Count(1)=0 THEN  'N'  ELSE 'S' END 	
		INTO STRICT	ie_atendimento_valido_w	
		FROM	cpoe_material	
		WHERE	nr_sequencia	= nr_seq_item_p	
		AND		nr_atendimento	= nr_atendimento_p;	
	ELSIF (ie_tipo_item_p	= 'G')	THEN
		SELECT	CASE WHEN Count(1)=0 THEN  'N'  ELSE 'S' END
		INTO STRICT	ie_atendimento_valido_w	
		FROM	cpoe_gasoterapia	
		WHERE	nr_sequencia	= nr_seq_item_p	
		AND		nr_atendimento	= nr_atendimento_p;	
	ELSIF (ie_tipo_item_p	= 'R')	THEN
		SELECT	CASE WHEN Count(1)=0 THEN  'N'  ELSE 'S' END 	
		INTO STRICT	ie_atendimento_valido_w	
		FROM	cpoe_recomendacao
		WHERE	nr_sequencia	= nr_seq_item_p	
		AND		nr_atendimento	= nr_atendimento_p;	
	ELSIF (ie_tipo_item_p	IN ('H'))	THEN
		SELECT	CASE WHEN Count(1)=0 THEN  'N'  ELSE 'S' END 	
		INTO STRICT	ie_atendimento_valido_w	
		FROM	cpoe_hemoterapia
		WHERE	nr_sequencia	= nr_seq_item_p	
		AND		nr_atendimento	= nr_atendimento_p;	
	ELSIF (ie_tipo_item_p	IN ('DI', 'DP'))	THEN
		SELECT	CASE WHEN Count(1)=0 THEN  'N'  ELSE 'S' END 	
		INTO STRICT	ie_atendimento_valido_w	
		FROM	cpoe_dialise
		WHERE	nr_sequencia	= nr_seq_item_p	
		AND		nr_atendimento	= nr_atendimento_p;	
	ELSIF (ie_tipo_item_p	= 'AP')	THEN
		SELECT	CASE WHEN Count(1)=0 THEN  'N'  ELSE 'S' END
		INTO STRICT	ie_atendimento_valido_w	
		FROM	cpoe_anatomia_patologica	
		WHERE	nr_sequencia	= nr_seq_item_p	
		AND		nr_atendimento	= nr_atendimento_p;	
	END	IF;	

	RETURN	ie_atendimento_valido_w;	
END;	
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION cpoe_obter_se_atend_valido (nr_seq_item_p bigint, ie_tipo_item_p text, nr_atendimento_p bigint) FROM PUBLIC;

