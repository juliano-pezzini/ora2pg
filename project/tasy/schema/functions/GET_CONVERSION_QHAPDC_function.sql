-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION get_conversion_qhapdc ( nm_tabela_qhapdc_p text, nm_tabela_tasy_p text, cd_dominio_tasy_p bigint, ds_valor_p text, ie_conversao_p text default 'E') RETURNS varchar AS $body$
DECLARE




/*ie_conversao_p



I - com base no valor do Tasy, retorna o valor do qhapdc



E - com base no valor do qhapdc, retorna o valor do Tasy*/
ds_retorno_w	varchar(255);




BEGIN







if (ie_conversao_p = 'I') then







	if (cd_dominio_tasy_p IS NOT NULL AND cd_dominio_tasy_p::text <> '') then



		begin



		select	DS_VALUE_QHAPDC



		into STRICT	ds_retorno_w



		from	QHAPDC_CONVERSION_DATA



		where	nm_table_qhapdc 	= nm_tabela_qhapdc_p



		and	cd_tasy_domain	= cd_dominio_tasy_p



		and	ds_tasy_value 	= ds_valor_p  LIMIT 1;



		exception



		when others then



			ds_retorno_w := null;



		end;



	else



		begin



		select	DS_VALUE_QHAPDC



		into STRICT	ds_retorno_w



		from	QHAPDC_CONVERSION_DATA



		where	nm_table_qhapdc 	= nm_tabela_qhapdc_p



		and	NM_TASY_TABLE 	= nm_tabela_tasy_p



		and	ds_tasy_value 	= ds_valor_p  LIMIT 1;



		exception



		when others then



			ds_retorno_w := null;



		end;



	end if;







elsif (ie_conversao_p = 'E') then	



	



	if (cd_dominio_tasy_p IS NOT NULL AND cd_dominio_tasy_p::text <> '') then



		begin



		select	DS_TASY_VALUE



		into STRICT	ds_retorno_w



		from	QHAPDC_CONVERSION_DATA



		where	nm_table_qhapdc 	= nm_tabela_qhapdc_p



		and	cd_tasy_domain	= cd_dominio_tasy_p



		and	ds_tasy_value 	= ds_valor_p  LIMIT 1;



		exception



		when others then



			ds_retorno_w := null;



		end;



	else	



		begin



		select	DS_TASY_VALUE



		into STRICT	ds_retorno_w



		from	QHAPDC_CONVERSION_DATA



		where	nm_table_qhapdc 	= nm_tabela_qhapdc_p



		and	NM_TASY_TABLE 	= nm_tabela_tasy_p



		and	ds_tasy_value 	= ds_valor_p  LIMIT 1;



		exception



		when others then



			ds_retorno_w := null;



		end;



	end if;



	



end if;







return	ds_retorno_w;







end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION get_conversion_qhapdc ( nm_tabela_qhapdc_p text, nm_tabela_tasy_p text, cd_dominio_tasy_p bigint, ds_valor_p text, ie_conversao_p text default 'E') FROM PUBLIC;

