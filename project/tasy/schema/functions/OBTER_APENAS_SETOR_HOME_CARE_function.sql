-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_apenas_setor_home_care ( cd_setor_atendimento_p bigint, nr_atendimento_p bigint, ie_tipo_p bigint) RETURNS varchar AS $body$
DECLARE

ds_retorno_w			varchar(1) := 'S';
cd_classif_setor_atend_w	bigint;
cd_classif_setor_w		varchar(5);
ie_transf_entre_setor_hc_w	varchar(1);

BEGIN
ie_transf_entre_setor_hc_w := obter_param_usuario(3111, 265, obter_perfil_ativo, obter_usuario_ativo, obter_estabelecimento_ativo, ie_transf_entre_setor_hc_w);
if (coalesce(cd_setor_atendimento_p,0) > 0)	and (coalesce(nr_atendimento_p,0) > 0) 		and (coalesce(ie_tipo_p,0) > 0) 			and (ie_transf_entre_setor_hc_w = 'S')	then 
 
	select	max(obter_classif_setor(obter_setor_atendimento(nr_atendimento_p))) 
	into STRICT	cd_classif_setor_atend_w 
	;
	 
	if (coalesce(cd_classif_setor_atend_w,0) = 8) then 
	 
		select	max(cd_classif_setor) 
		into STRICT	cd_classif_setor_w 
		from	setor_atendimento 
		where	cd_setor_atendimento = cd_setor_atendimento_p;
		ds_retorno_w := 'N';	
		if (cd_classif_setor_w = 8) then 
			 
			ds_retorno_w := 'S';
			 
		end if;
	end if;
end if;
 
return	ds_retorno_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_apenas_setor_home_care ( cd_setor_atendimento_p bigint, nr_atendimento_p bigint, ie_tipo_p bigint) FROM PUBLIC;

