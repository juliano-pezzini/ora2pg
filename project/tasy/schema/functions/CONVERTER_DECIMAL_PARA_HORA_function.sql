-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION converter_decimal_para_hora (ds_hora_fase_p text) RETURNS varchar AS $body$
DECLARE


qt_hora_fase_w	varchar(200);
ds_hora_w		varchar(200);
ds_min_w		varchar(200) := '00';
qt_min_w        double precision;
ds_retorno_w    varchar(200);


BEGIN

    if (position('.' in ds_hora_fase_p) > 0) then
        qt_hora_fase_w := replace(ds_hora_fase_p,'.',',');
    else
        qt_hora_fase_w := ds_hora_fase_p;
    end if;
    
    if position(',' in qt_hora_fase_w) > 0 then
        ds_min_w := '0,' || substr(qt_hora_fase_w, position(',' in qt_hora_fase_w)+1, 2);
        qt_min_w := to_number(ds_min_w, '9999D9999', 'NLS_NUMERIC_CHARACTERS='',.''');
        ds_min_w := to_char(round(qt_min_w * 60));
        if length(ds_min_w) < 2 then
            ds_min_w := '0' || ds_min_w;
        end if;
    end if;
    
    if position(',' in qt_hora_fase_w) > 0 then
        ds_hora_w := substr(qt_hora_fase_w, 1, position(',' in qt_hora_fase_w)-1);
    else
        ds_hora_w := qt_hora_fase_w;
    end if;

    if length(ds_hora_w) < 2 then
        ds_hora_w := '0' || ds_hora_w;
    end if;

    if coalesce(ds_hora_w::text, '') = '' then
        ds_hora_w := '00';
    end if;

    ds_retorno_w := ds_hora_w || ':' || ds_min_w;
    return ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION converter_decimal_para_hora (ds_hora_fase_p text) FROM PUBLIC;

