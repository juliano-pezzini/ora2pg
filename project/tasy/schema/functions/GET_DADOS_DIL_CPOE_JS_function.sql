-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION get_dados_dil_cpoe_js ( nr_prescricao_p bigint, nr_seq_solucao_p bigint ) RETURNS varchar AS $body$
DECLARE

								
ie_tipo_dosagem_w				prescr_solucao.ie_tipo_dosagem%type;
qt_dosagem_w					prescr_solucao.qt_dosagem%type;
ds_orientacao_w					prescr_solucao.ds_orientacao%type;
qt_solucao_total_w				prescr_solucao.qt_solucao_total%type;
nr_etapas_w						prescr_solucao.nr_etapas%type;
qt_tempo_aplicacao_w			prescr_solucao.qt_tempo_aplicacao%type;
	
nr_atendimento_w				prescr_medica.nr_atendimento%type;
cd_pessoa_fisica_w				prescr_medica.cd_pessoa_fisica%type;
	
cd_material_w					prescr_material.cd_material%type;
qt_dose_w						prescr_material.qt_dose%type;
cd_unidade_medida_dose_w		prescr_material.cd_unidade_medida_dose%type;
cd_intervalo_w					prescr_material.cd_intervalo%type;
ie_via_aplicacao_w				prescr_material.ie_via_aplicacao%type;
qt_solucao_w					prescr_material.qt_solucao%type;
ds_horarios_w					prescr_material.ds_horarios%type;
ie_se_necessario_w				prescr_material.ie_se_necessario%type;
ie_fator_correcao_w				prescr_material.ie_fator_correcao%type;
ie_bomba_infusao_w				prescr_material.ie_bomba_infusao%type;
nr_sequencia_w					prescr_material.nr_sequencia%type;
cd_mat_dil_w					prescr_material.cd_material%type;
qt_dose_dil_w					prescr_material.qt_dose%type;
cd_unidade_medida_dose_dil_w	prescr_material.cd_unidade_medida_dose%type;
cd_intervalo_dil_w				prescr_material.cd_intervalo%type;
ie_via_aplicacao_dil_w			prescr_material.ie_via_aplicacao%type;
qt_solucao_dil_w				prescr_material.qt_solucao%type;
nr_seq_mat_cpoe_w				prescr_material.nr_seq_mat_cpoe%type;
cd_mat_red_w					prescr_material.cd_material%type;
qt_dose_red_w					prescr_material.qt_dose%type;
cd_unidade_medida_dose_red_w	prescr_material.cd_unidade_medida_dose%type;
cd_intervalo_red_w				prescr_material.cd_intervalo%type;
ie_via_aplicacao_red_w			prescr_material.ie_via_aplicacao%type;
qt_solucao_red_w				prescr_material.qt_solucao%type;
cd_mat_rec_w					prescr_material.cd_material%type;
qt_dose_rec_w					prescr_material.qt_dose%type;
cd_unidade_medida_dose_rec_w	prescr_material.cd_unidade_medida_dose%type;
cd_intervalo_rec_w				prescr_material.cd_intervalo%type;
ie_via_aplicacao_rec_w			prescr_material.ie_via_aplicacao%type;
qt_solucao_rec_w				prescr_material.qt_solucao%type;

qt_vel_infusao_w				bigint;
ie_tipo_dosagem_out_w			varchar(255);
qt_minutos_aplicacao_w			bigint;
hr_min_aplicacao_w				bigint;

ie_consulta_sol_w				varchar(1):='N';
i_cont_w						integer:= 0;
ds_diluicao_out_w				varchar(4000) := '';
cd_intervalo_out_w				varchar(50);
nr_etapas_out_w					bigint;
qt_dosagem_out_w				bigint;
qt_solucao_total_out_w			bigint;
qt_hora_fase_out_w				varchar(255);
qt_hora_fase2_out_w				varchar(255);
qt_dosagem_diferenciada_w		varchar(255);
qt_volume_w						cpoe_material.qt_volume%type;

qt_hora_fase_w					cpoe_material.qt_hora_fase%type;
qt_hora_f_w						cpoe_material.qt_hora_fase_diferenciada%type;
qt_hora_fase_dif_w				cpoe_material.qt_hora_fase_diferenciada%type;	
qt_hora_f_dif_w					cpoe_material.qt_hora_fase_diferenciada%type;
ds_dose_diferenciada_w			cpoe_material.ds_dose_diferenciada%type;
ie_tipo_solucao_w				cpoe_material.ie_tipo_solucao%type;
ie_ref_calculo_w				cpoe_material.ie_ref_calculo%type;
qt_volume_red_w					cpoe_material.qt_solucao_red%type;

cd_mat_comp1_w					cpoe_material.cd_mat_comp1%type;
qt_dose_comp1_w					cpoe_material.qt_dose_comp1%type;
cd_unidade_medida_dose_com1_w 	cpoe_material.cd_unid_med_dose_comp1%type;	
ds_dose_diferenciada_comp1_w	cpoe_material.ds_dose_diferenciada_comp1%type;	

cd_mat_comp2_w					cpoe_material.cd_mat_comp2%type;
qt_dose_comp2_w					cpoe_material.qt_dose_comp2%type;
cd_unidade_medida_dose_com2_w 	cpoe_material.cd_unid_med_dose_comp2%type;	
ds_dose_diferenciada_comp2_w	cpoe_material.ds_dose_diferenciada_comp2%type;	

cd_mat_comp3_w					cpoe_material.cd_mat_comp3%type;
qt_dose_comp3_w					cpoe_material.qt_dose_comp3%type;
cd_unidade_medida_dose_com3_w 	cpoe_material.cd_unid_med_dose_comp3%type;	
ds_dose_diferenciada_comp3_w	cpoe_material.ds_dose_diferenciada_comp3%type;	

cd_mat_comp4_w					cpoe_material.cd_mat_comp4%type;
qt_dose_comp4_w					cpoe_material.qt_dose_comp4%type;
cd_unidade_medida_dose_com4_w 	cpoe_material.cd_unid_med_dose_comp4%type;	
ds_dose_diferenciada_comp4_w	cpoe_material.ds_dose_diferenciada_comp4%type;	

cd_mat_comp5_w					cpoe_material.cd_mat_comp5%type;
qt_dose_comp5_w					cpoe_material.qt_dose_comp5%type;
cd_unidade_medida_dose_com5_w 	cpoe_material.cd_unid_med_dose_comp5%type;	
ds_dose_diferenciada_comp5_w	cpoe_material.ds_dose_diferenciada_comp5%type;	

cd_mat_comp6_w					cpoe_material.cd_mat_comp6%type;
qt_dose_comp6_w					cpoe_material.qt_dose_comp6%type;
cd_unidade_medida_dose_com6_w 	cpoe_material.cd_unid_med_dose_comp6%type;	
ds_dose_diferenciada_comp6_w	cpoe_material.ds_dose_diferenciada_comp6%type;	

cd_mat_comp7_w					cpoe_material.cd_mat_comp7%type;
qt_dose_comp7_w					cpoe_material.qt_dose_comp7%type;
cd_unidade_medida_dose_com7_w 	cpoe_material.cd_unid_med_dose_comp7%type;
ds_dose_diferenciada_comp7_w	cpoe_material.ds_dose_diferenciada_comp7%type;

nr_seq_mat_diluicao_w			cpoe_material.nr_seq_mat_diluicao%type;
ds_dose_diferenciada_dil_w		cpoe_material.ds_dose_diferenciada_dil%type;	
ds_dose_diferenciada_red_w		cpoe_material.ds_dose_diferenciada_red%type;	
ds_dose_diferenciada_rec_w		cpoe_material.ds_dose_diferenciada_rec%type;	
qt_volume_ww					cpoe_material.qt_volume%type;

C01 CURSOR FOR
	SELECT	a.nr_atendimento,
			a.cd_pessoa_fisica,
			b.cd_material,	
			b.qt_dose,
			b.cd_unidade_medida_dose,
			b.cd_intervalo,
			b.ie_via_aplicacao,
			b.qt_solucao,
			0 hr_min_aplicacao,
			b.ie_se_necessario,
			b.ie_fator_correcao,
			b.ie_bomba_infusao,
			b.nr_seq_mat_cpoe,
			b.nr_sequencia,
			b.ds_horarios
	from	prescr_material b,
			prescr_medica a
	where	a.nr_prescricao = b.nr_prescricao
	and		a.nr_prescricao = nr_prescricao_p
	and		b.nr_sequencia_solucao = nr_seq_solucao_p 
	order by nr_sequencia LIMIT 1;
	

BEGIN

select	max(a.ie_tipo_dosagem),
		max(a.qt_dosagem),
		max(CASE WHEN a.ie_tipo_sol=1 THEN 'I' WHEN a.ie_tipo_sol=4 THEN 'V' WHEN a.ie_tipo_sol=5 THEN 'P'  ELSE 'C' END ),
		max(a.qt_solucao_total),
		max(a.qt_tempo_aplicacao),
		max(nr_etapas)
into STRICT	ie_tipo_dosagem_w,
		qt_dosagem_w,
		ie_tipo_solucao_w,
		qt_solucao_total_w,
		qt_tempo_aplicacao_w,
		nr_etapas_w
from	prescr_solucao a
where	nr_prescricao = nr_prescricao_p
and		a.nr_seq_solucao = nr_seq_solucao_p;

open C01;
loop
fetch C01 into	
		nr_atendimento_w,		
		cd_pessoa_fisica_w,			
		cd_material_w,				
		qt_dose_w,					
		cd_unidade_medida_dose_w,	
		cd_intervalo_w,				
		ie_via_aplicacao_w,			
		qt_solucao_w,				
		hr_min_aplicacao_w,			
		ie_se_necessario_w,			
		ie_fator_correcao_w,			
		ie_bomba_infusao_w,	
		nr_seq_mat_cpoe_w,
		nr_sequencia_w,
		ds_horarios_w;
EXIT WHEN NOT FOUND; /* apply on C01 */
	begin
		
		if (coalesce(nr_seq_mat_cpoe_w,0) > 0) then			
		
			/*Diluente*/

			select 	max(a.cd_mat_dil),
					max(b.qt_dose),
					max(b.cd_unidade_medida_dose),
					max(b.cd_intervalo),
					max(b.ie_via_aplicacao),
					max(b.qt_solucao),
					max(a.ds_dose_diferenciada_dil),
					max(a.nr_seq_mat_diluicao)
			into STRICT	cd_mat_dil_w,					
					qt_dose_dil_w,
					cd_unidade_medida_dose_dil_w,
					cd_intervalo_dil_w,
					ie_via_aplicacao_dil_w,
					qt_solucao_dil_w,
					ds_dose_diferenciada_dil_w,
					nr_seq_mat_diluicao_w
			from 	cpoe_material a,
					prescr_material b
			where a.nr_sequencia = b.nr_seq_mat_cpoe
			and b.cd_material = a.cd_mat_dil
			and b.nr_prescricao = nr_prescricao_p
			and	b.nr_sequencia_solucao = nr_seq_solucao_p
			and (a.cd_mat_dil IS NOT NULL AND a.cd_mat_dil::text <> '');			
			
			/*Rediluente*/

			select	max(a.cd_mat_red),	
					max(b.qt_dose),
					max(b.cd_unidade_medida_dose),
					max(b.cd_intervalo),
					max(b.ie_via_aplicacao),
					max(b.qt_solucao),
					max(qt_solucao_red),
					max(a.ds_dose_diferenciada_red)
			into STRICT	cd_mat_red_w,					
					qt_dose_red_w,					
					cd_unidade_medida_dose_red_w,	
					cd_intervalo_red_w,				
					ie_via_aplicacao_red_w,			
					qt_solucao_red_w,
					qt_volume_red_w,
					ds_dose_diferenciada_red_w
			from 	cpoe_material a,
					prescr_material b
			where a.nr_sequencia = b.nr_seq_mat_cpoe
			and b.cd_material = a.cd_mat_red
			and b.nr_prescricao = nr_prescricao_p
			and	b.nr_sequencia_solucao = nr_seq_solucao_p
			and (a.cd_mat_red IS NOT NULL AND a.cd_mat_red::text <> '');

			/*Reconstituinte*/

			select	max(a.cd_mat_recons),	
					max(b.qt_dose),
					max(b.cd_unidade_medida_dose),
					max(b.cd_intervalo),
					max(b.ie_via_aplicacao),
					max(b.qt_solucao),
					max(a.ds_dose_diferenciada_rec)
			into STRICT	cd_mat_rec_w,					
					qt_dose_rec_w,				
					cd_unidade_medida_dose_rec_w,
					cd_intervalo_rec_w,	
					ie_via_aplicacao_rec_w,
					qt_solucao_rec_w,
					ds_dose_diferenciada_rec_w
			from 	cpoe_material a,
					prescr_material b
			where a.nr_sequencia = b.nr_seq_mat_cpoe
			and b.cd_material = a.cd_mat_recons
			and b.nr_prescricao = nr_prescricao_p
			and	b.nr_sequencia_solucao = nr_seq_solucao_p
			and (a.cd_mat_recons IS NOT NULL AND a.cd_mat_recons::text <> '');
		
			/*Material 1*/

			select	max(a.cd_mat_comp1),	
					max(b.qt_dose),
					max(b.cd_unidade_medida_dose),
					max(a.ds_dose_diferenciada_comp1)
			into STRICT	cd_mat_comp1_w,					
					qt_dose_comp1_w,				
					cd_unidade_medida_dose_com1_w,
					ds_dose_diferenciada_comp1_w
			from 	cpoe_material a,
					prescr_material b
			where a.nr_sequencia = b.nr_seq_mat_cpoe
			and b.cd_material = a.cd_mat_comp1
			and b.nr_prescricao = nr_prescricao_p
			and	b.nr_sequencia_solucao = nr_seq_solucao_p
			and (a.cd_mat_comp1 IS NOT NULL AND a.cd_mat_comp1::text <> '');
			
			/*Material 2*/

			select	max(a.cd_mat_comp2),	
					max(b.qt_dose),
					max(b.cd_unidade_medida_dose),
					max(a.ds_dose_diferenciada_comp2)
			into STRICT	cd_mat_comp2_w,					
					qt_dose_comp2_w,				
					cd_unidade_medida_dose_com2_w,
					ds_dose_diferenciada_comp2_w
			from 	cpoe_material a,
					prescr_material b
			where a.nr_sequencia = b.nr_seq_mat_cpoe
			and b.cd_material = a.cd_mat_comp2
			and b.nr_prescricao = nr_prescricao_p
			and	b.nr_sequencia_solucao = nr_seq_solucao_p
			and (a.cd_mat_comp2 IS NOT NULL AND a.cd_mat_comp2::text <> '');
			
			/*Material 3*/

			select	max(a.cd_mat_comp3),	
					max(b.qt_dose),
					max(b.cd_unidade_medida_dose),
					max(a.ds_dose_diferenciada_comp3)
			into STRICT	cd_mat_comp3_w,					
					qt_dose_comp3_w,				
					cd_unidade_medida_dose_com3_w,
					ds_dose_diferenciada_comp3_w
			from 	cpoe_material a,
					prescr_material b
			where a.nr_sequencia = b.nr_seq_mat_cpoe
			and b.cd_material = a.cd_mat_comp3
			and b.nr_prescricao = nr_prescricao_p
			and	b.nr_sequencia_solucao = nr_seq_solucao_p
			and (a.cd_mat_comp3 IS NOT NULL AND a.cd_mat_comp3::text <> '');
			
			/*Material 4*/

			select	max(a.cd_mat_comp4),	
					max(b.qt_dose),
					max(b.cd_unidade_medida_dose),
					max(a.ds_dose_diferenciada_comp4)
			into STRICT	cd_mat_comp4_w,					
					qt_dose_comp4_w,				
					cd_unidade_medida_dose_com4_w,
					ds_dose_diferenciada_comp4_w
			from 	cpoe_material a,
					prescr_material b
			where a.nr_sequencia = b.nr_seq_mat_cpoe
			and b.cd_material = a.cd_mat_comp4
			and b.nr_prescricao = nr_prescricao_p
			and	b.nr_sequencia_solucao = nr_seq_solucao_p
			and (a.cd_mat_comp4 IS NOT NULL AND a.cd_mat_comp4::text <> '');
			
			/*Material 5*/

			select	max(a.cd_mat_comp5),	
					max(b.qt_dose),
					max(b.cd_unidade_medida_dose),
					max(a.ds_dose_diferenciada_comp5)
			into STRICT	cd_mat_comp5_w,
					qt_dose_comp5_w,				
					cd_unidade_medida_dose_com5_w,
					ds_dose_diferenciada_comp5_w
			from 	cpoe_material a,
					prescr_material b
			where a.nr_sequencia = b.nr_seq_mat_cpoe
			and b.cd_material = a.cd_mat_comp5
			and b.nr_prescricao = nr_prescricao_p
			and	b.nr_sequencia_solucao = nr_seq_solucao_p
			and (a.cd_mat_comp5 IS NOT NULL AND a.cd_mat_comp5::text <> '');
			
			/*Material 6*/

			select	/*+ LEADING(b)*/					max(a.cd_mat_comp6),	
					max(b.qt_dose),
					max(b.cd_unidade_medida_dose),
					max(a.ds_dose_diferenciada_comp6)
			into STRICT	cd_mat_comp6_w,
					qt_dose_comp6_w,				
					cd_unidade_medida_dose_com6_w,
					ds_dose_diferenciada_comp6_w
			from 	cpoe_material a,
					prescr_material b
			where a.nr_sequencia = b.nr_seq_mat_cpoe
			and b.cd_material = a.cd_mat_comp6
			and b.nr_prescricao = nr_prescricao_p
			and	b.nr_sequencia_solucao = nr_seq_solucao_p
			and (a.cd_mat_comp6 IS NOT NULL AND a.cd_mat_comp6::text <> '');
			
			/*Material 7*/

			select	/*+ LEADING(b)*/					max(a.cd_mat_comp7),
					max(b.qt_dose),
					max(b.cd_unidade_medida_dose),
					max(a.ds_dose_diferenciada_comp7)
			into STRICT	cd_mat_comp7_w,
					qt_dose_comp7_w,
					cd_unidade_medida_dose_com7_w,
					ds_dose_diferenciada_comp7_w
			from 	cpoe_material a,
					prescr_material b
			where a.nr_sequencia = b.nr_seq_mat_cpoe
			and b.cd_material = a.cd_mat_comp7
			and b.nr_prescricao = nr_prescricao_p
			and	b.nr_sequencia_solucao = nr_seq_solucao_p
			and (a.cd_mat_comp7 IS NOT NULL AND a.cd_mat_comp7::text <> '');

			qt_volume_ww := null;
		
			if (coalesce(nr_seq_mat_cpoe_w,0) > 0) then					
					select	max(ie_ref_calculo),
							max(ds_dose_diferenciada),
							max(qt_hora_fase_diferenciada),
							max(qt_hora_fase),
							max(qt_volume)
					into STRICT	ie_ref_calculo_w,
							ds_dose_diferenciada_w,
							qt_hora_fase_dif_w,
							qt_hora_fase_w,
							qt_volume_ww
					from	cpoe_material
					where	nr_sequencia = nr_seq_mat_cpoe_w;					
			end if;

			if (ds_dose_diferenciada_w IS NOT NULL AND ds_dose_diferenciada_w::text <> '') then
					
				if (ie_ref_calculo_w = 'I')  then
					qt_hora_f_w 	:= qt_hora_fase_w;
					qt_hora_f_dif_w := qt_hora_fase_dif_w;
				else
					qt_hora_f_w 	:= qt_hora_fase_dif_w;
					qt_hora_fase_dif_w := null;
				end if;	
					
			else
				qt_hora_f_w 	:= qt_hora_fase_w;
				qt_hora_f_dif_w := null;
			end if;
			

			if (ie_tipo_solucao_w = 'I') or (ie_tipo_solucao_w = 'C') then								
				if ((ie_ref_calculo_w = 'I') and (cd_intervalo_w IS NOT NULL AND cd_intervalo_w::text <> '') and (qt_hora_f_w IS NOT NULL AND qt_hora_f_w::text <> '') or (ie_ref_calculo_w = 'NE') and (coalesce(nr_etapas_w,0) > 0) and (qt_hora_f_w IS NOT NULL AND qt_hora_f_w::text <> '') or (ie_ref_calculo_w = 'VI') and (coalesce(qt_dosagem_w,0) > 0) and (ie_tipo_dosagem_w IS NOT NULL AND ie_tipo_dosagem_w::text <> '')or (ie_ref_calculo_w = 'VT') and (coalesce(qt_solucao_total_w,0) > 0)) then
					ie_consulta_sol_w := 'S';	
				end if;
			else
				ie_consulta_sol_w := 'S';
			end if;	
			
			if (coalesce(qt_volume_ww,0) = 0) then
				qt_volume_w := CPOE_Obter_volume_total(cd_material_w, qt_dose_w, cd_unidade_medida_dose_w,
					cd_mat_dil_w, qt_dose_dil_w, cd_unidade_medida_dose_dil_w,
					qt_volume_red_w, 
					cd_mat_red_w, qt_dose_red_w, cd_unidade_medida_dose_red_w, 
					cd_mat_comp1_w, qt_dose_comp1_w, cd_unidade_medida_dose_com1_w,
					cd_mat_comp2_w, qt_dose_comp2_w, cd_unidade_medida_dose_com2_w, 
					cd_mat_comp3_w, qt_dose_comp3_w, cd_unidade_medida_dose_com3_w,
					cd_mat_comp4_w, qt_dose_comp4_w, cd_unidade_medida_dose_com4_w, 
					cd_mat_comp5_w, qt_dose_comp5_w, cd_unidade_medida_dose_com5_w,
					cd_mat_comp6_w, qt_dose_comp6_w, cd_unidade_medida_dose_com6_w,
					cd_mat_comp7_w, qt_dose_comp7_w, cd_unidade_medida_dose_com7_w,
					nr_seq_mat_diluicao_w);
			else
				qt_volume_w := qt_volume_ww;
			end if;
			
			if (qt_tempo_aplicacao_w > 24) then
				qt_tempo_aplicacao_w	:= 24;
			end if;
			
			if (coalesce(ie_consulta_sol_w,'N') = 'S') and (coalesce(qt_volume_w,0) > 0) and (qt_tempo_aplicacao_w IS NOT NULL AND qt_tempo_aplicacao_w::text <> '') then
				
				if (coalesce(nr_etapas_w,0) = 0) and (ie_ref_calculo_w = 'I') and (cd_intervalo_w IS NOT NULL AND cd_intervalo_w::text <> '') then
					nr_etapas_w	:= Obter_ocorrencia_intervalo(cd_intervalo_w, 24, '0');
				elsif (coalesce(nr_etapas_w,0) = 0) then
					nr_etapas_w	:= 1;	
				end if;
				
				SELECT * FROM CPOE_Calcular_valores_sol(ie_tipo_solucao_w, qt_volume_w, qt_tempo_aplicacao_w, ie_ref_calculo_w, cd_intervalo_w, nr_etapas_w, qt_dosagem_w, qt_solucao_total_w, qt_hora_f_w, upper(ie_tipo_dosagem_w), cd_intervalo_out_w, nr_etapas_out_w, qt_dosagem_out_w, qt_solucao_total_out_w, qt_hora_fase_out_w, qt_hora_fase2_out_w, ds_diluicao_out_w, qt_dosagem_diferenciada_w, qt_hora_f_dif_w, ds_horarios_w, cd_material_w, ds_dose_diferenciada_w, cd_unidade_medida_dose_w, cd_mat_comp1_w, ds_dose_diferenciada_comp1_w, cd_unidade_medida_dose_com1_w, cd_mat_comp2_w, ds_dose_diferenciada_comp2_w, cd_unidade_medida_dose_com2_w, cd_mat_comp3_w, ds_dose_diferenciada_comp3_w, cd_unidade_medida_dose_com3_w, cd_mat_dil_w, ds_dose_diferenciada_dil_w, cd_unidade_medida_dose_dil_w, cd_mat_rec_w, ds_dose_diferenciada_rec_w, cd_unidade_medida_dose_rec_w, cd_mat_red_w, ds_dose_diferenciada_red_w, cd_unidade_medida_dose_red_w, cd_mat_comp4_w, qt_dose_comp4_w, cd_unidade_medida_dose_com4_w, cd_mat_comp5_w, qt_dose_comp5_w, cd_unidade_medida_dose_com5_w, cd_mat_comp6_w, qt_dose_comp6_w, cd_unidade_medida_dose_com6_w) INTO STRICT cd_intervalo_out_w, nr_etapas_out_w, qt_dosagem_out_w, qt_solucao_total_out_w, qt_hora_fase_out_w, qt_hora_fase2_out_w, ds_diluicao_out_w, qt_dosagem_diferenciada_w;
			end if;		
		end if;
	end;
end loop;
close C01;

return	ds_diluicao_out_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION get_dados_dil_cpoe_js ( nr_prescricao_p bigint, nr_seq_solucao_p bigint ) FROM PUBLIC;

