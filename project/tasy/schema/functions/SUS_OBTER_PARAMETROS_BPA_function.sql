-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION sus_obter_parametros_bpa ( ds_campo_p text, cd_estabelecimento_p estabelecimento.cd_estabelecimento%type) RETURNS varchar AS $body$
DECLARE


ds_retorno_w			varchar(255);

C01 CURSOR FOR
	SELECT	cd_cnes_hospital,
		cd_interface_envio,
		cd_orgao_responsavel,
		ie_cnes_prestador,
		ie_orgao_destino,
		ie_tipo_atend_cnes_setor,
		ie_tipo_reg_estab,
		ie_versao_bpa,
		nm_orgao_destino,
		qt_digitos_bpa,
		ie_cons_conv_conta_entrada
	from	sus_parametros_bpa
	where	cd_estabelecimento	= cd_estabelecimento_p;

c01_w c01%rowtype;


BEGIN

open C01;
loop
fetch C01 into
	c01_w;
EXIT WHEN NOT FOUND; /* apply on C01 */
end loop;
close C01;

if (upper(ds_campo_p)	= 'CD_CNES_HOSPITAL') then
	ds_retorno_w	:= coalesce(c01_w.cd_cnes_hospital,0);
elsif (upper(ds_campo_p)	= 'CD_INTERFACE_ENVIO') then
	ds_retorno_w	:= coalesce(c01_w.cd_interface_envio,0);
elsif (upper(ds_campo_p)	= 'CD_ORGAO_RESPONSAVEL') then
	ds_retorno_w	:= coalesce(c01_w.cd_orgao_responsavel,'');
elsif (upper(ds_campo_p)	= 'IE_CNES_PRESTADOR') then
	ds_retorno_w	:= coalesce(c01_w.ie_cnes_prestador,'N');
elsif (upper(ds_campo_p)	= 'IE_ORGAO_DESTINO') then
	ds_retorno_w	:= coalesce(c01_w.ie_orgao_destino,'');
elsif (upper(ds_campo_p)	= 'IE_TIPO_ATEND_CNES_SETOR') then
	ds_retorno_w	:= coalesce(c01_w.ie_tipo_atend_cnes_setor,0);
elsif (upper(ds_campo_p)	= 'IE_TIPO_REG_ESTAB') then
	ds_retorno_w	:= coalesce(c01_w.ie_tipo_reg_estab,'N');
elsif (upper(ds_campo_p)	= 'IE_VERSAO_BPA') then
	ds_retorno_w	:= coalesce(c01_w.ie_versao_bpa,'');
elsif (upper(ds_campo_p)	= 'NM_ORGAO_DESTINO') then
	ds_retorno_w	:= coalesce(c01_w.nm_orgao_destino,'');
elsif (upper(ds_campo_p)	= 'QT_DIGITOS_BPA') then
	ds_retorno_w	:= coalesce(c01_w.qt_digitos_bpa,0);
elsif (upper(ds_campo_p)	= 'IE_CONS_CONV_CONTA_ENTRADA') then
	ds_retorno_w	:= coalesce(c01_w.ie_cons_conv_conta_entrada,0);
end if;

return	ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION sus_obter_parametros_bpa ( ds_campo_p text, cd_estabelecimento_p estabelecimento.cd_estabelecimento%type) FROM PUBLIC;

