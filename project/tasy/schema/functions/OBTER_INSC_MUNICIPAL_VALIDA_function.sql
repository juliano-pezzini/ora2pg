-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';



CREATE TYPE tvetor AS (tvetor smallint[9]);


CREATE OR REPLACE FUNCTION obter_insc_municipal_valida ( nr_inscricao_estadual_p text, sg_estado_p text) RETURNS varchar AS $body$
DECLARE


ds_retorno_w			varchar(255);
nr_inscricao_estadual_w		pessoa_juridica.nr_inscricao_estadual%type;


function valida_insc_munic_rn(	nr_inscricao_estadual_p		text)
				return text is
				
ds_retorno_w			varchar(255);
vl_primeiro_digito_w		bigint;
vl_valor_conta_w		bigint:= 0;
vl_peso_w			bigint:= 9;
vl_soma_w			bigint:= 0;
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

BEGIN

if (length(nr_inscricao_estadual_p) <> 9) then
	begin
	ds_retorno_w:= 'N';
	end;
else
	FOR i in 1..9 loop
		vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		if (i <> 9) then
			begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
			end;
		end if;
	end loop;

	vl_soma_w:= (vl_valor_conta_w * 10);

	if (mod(vl_soma_w, 11) >= 10) then
		vl_primeiro_digito_w:= 0;
	else
		vl_primeiro_digito_w:= mod(vl_soma_w, 11);
	end if;
		ds_retorno_w:= 'N';
	if (vl_primeiro_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;
end if;	

return	ds_retorno_w;
end;

function valida_insc_munic_to(	nr_inscricao_estadual_p		varchar2)
				return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;

type tvetor is varray(11) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0,0,0);

begin
/* Verifica se o tamanho  da Inscrição está correto*/

if (length(nr_inscricao_estadual_p) = 11) then
	begin
	
	for i in 1..11 loop
		begin
		vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		if (i not in (3,4,11)) then
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w	:= vl_peso_w - 1;
		end if;
		end;
	end loop;

	vl_soma_w:= mod(vl_valor_conta_w, 11);

	if (vl_soma_w >= 2) then
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	else
		vl_primeiro_digito_w:= 0;
	end if;

	ds_retorno_w	:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(11)) then
		ds_retorno_w := 'S';
	end if;
	
	end;
else

ds_retorno_w	:= 'N';

end if;

return	ds_retorno_w;
end;


function valida_insc_munic_se(	nr_inscricao_estadual_p		varchar2)
				return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 9) then
	ds_retorno_w:= 'N';
else
	for i in 1..9 loop
		begin
		vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		if (i <> 9) then
			begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w	:= vl_peso_w - 1;
			end;
		end if;
		end;
	end loop;

	vl_soma_w:=  mod(vl_valor_conta_w, 11);

	if	((11 - vl_soma_w)  >= 10) then
		vl_primeiro_digito_w:= 0;
	else
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	end if;

	ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;	
end if;

return	ds_retorno_w;

end;

function valida_insc_munic_rr(	nr_inscricao_estadual_p		varchar2)
				return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 1;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 9) then
	begin
	ds_retorno_w:= 'N';
	end;
else
	for i in 1..9 loop
		begin
		vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		if (i <> 9) then
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w	:= vl_peso_w + 1;
		end if;
		end;
	end loop;

	vl_primeiro_digito_w:= mod(vl_valor_conta_w, 9);

	ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;	
end if;


return	ds_retorno_w;

end;

function valida_insc_munic_ro(	nr_inscricao_estadual_p		varchar2)
				return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 6;
vl_soma_w			number(10):= 0;
nr_inscricao_estadual_ant_w	varchar2(6);
vl_posicao_w                    number(10):= 1;



type tvetor is varray(14) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) not in (9, 14)) then
	ds_retorno_w := 'N';
else
	if (length(nr_inscricao_estadual_p) = 9) then
		begin
		nr_inscricao_estadual_ant_w:=  substr(nr_inscricao_estadual_p, 4, 6);
		for i in 1..8 loop
			vetor_digito(i) := 0;
		end loop;

		for i in 9..14 loop
			begin
			vetor_digito(i) := substr(nr_inscricao_estadual_ant_w, vl_posicao_w, 1);
			vl_posicao_w:= vl_posicao_w + 1;
			end;
		end loop;
		end;
	else
		for i in 1..14 loop
		vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end loop;
	end if;


	for i in 1..13 loop
		vl_valor_conta_w := vl_valor_conta_w +  (vetor_digito(i) * vl_peso_w);
		if (vl_peso_w = 2) then
			vl_peso_w:= 9;
		else	
			vl_peso_w:= vl_peso_w - 1;
		end if;
	end loop;

	vl_soma_w:=  (11 -  mod(vl_valor_conta_w, 11));

	if (vl_soma_w >= 10) then
		vl_primeiro_digito_w:= (vl_soma_w - 10);
	else
		vl_primeiro_digito_w:= vl_soma_w;
	end if;
	
	ds_retorno_w := 'N';

	if (vl_primeiro_digito_w = vetor_digito(14)) then
		ds_retorno_w := 'S';
	end if;	
end if;

return	ds_retorno_w;

end;


function valida_insc_munic_pi(	nr_inscricao_estadual_p		varchar2)
				return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin
if (length(nr_inscricao_estadual_p) <> 9) then
	begin
		ds_retorno_w:= 'N';
	end;
else
	for i in 1..9 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;

	for i in 1..8 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
		end;
	end loop;

	vl_soma_w:= mod(vl_valor_conta_w, 11);

	if	( (11 - vl_soma_w) > 10) then
		vl_primeiro_digito_w:= 0;
	else
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	end if;

	ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;
end if;


return	ds_retorno_w;

end;


function valida_insc_munic_pa(	nr_inscricao_estadual_p		varchar2)
				return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 9)  then
	begin
	ds_retorno_w:= 'N';
	end;
else
	for i in 1..9 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;
	for i in 1..8 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
		end;
	end loop;

	vl_soma_w:= mod(vl_valor_conta_w, 11);

	if (vl_soma_w > 1) then
		vl_primeiro_digito_w:= (11 - vl_soma_w);
        else
		vl_primeiro_digito_w:= 0;  	
	end if;

	ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;	
end if;


return	ds_retorno_w;

end;

function valida_insc_munic_ms(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 9) then
  	ds_retorno_w:= 'N';
else
		for i in 1..9 loop
			begin
				vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
			end;
		end loop;

		for i in 1..8 loop
			begin
				vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
				vl_peso_w:= vl_peso_w - 1;
			end;
		end loop;

	vl_soma_w:= mod(vl_valor_conta_w, 11);

	if (vl_soma_w = 0) then
		vl_primeiro_digito_w:= 0;
	else
		if	((11 - vl_soma_w) > 9) then
			vl_primeiro_digito_w:= 0;
		else
			vl_primeiro_digito_w:= (11 - vl_soma_w);
		end if;
	end if;

	ds_retorno_w:= 'N';

		if (vl_primeiro_digito_w = vetor_digito(9)) then
			ds_retorno_w := 'S';
		end if;	
end if;



return	ds_retorno_w;

end;

function valida_insc_munic_mt(	nr_inscricao_estadual_p		varchar2)
				return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 3;
vl_soma_w			number(10):= 0;

type tvetor is varray(11) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 11) then
	ds_retorno_w:= 'N';
else
	for i in 1..11 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;

	for i in 1..10 loop
		vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
		if (vl_peso_w = 2) then
			vl_peso_w:= 9;
		else
			vl_peso_w:= vl_peso_w - 1;
		end if;	
	end loop;

	vl_soma_w:= mod(vl_valor_conta_w, 11);

	if (vl_soma_w > 1) then
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	else
		vl_primeiro_digito_w:= 0;
	end if;


	ds_retorno_w:= 'N';
	if (vl_primeiro_digito_w = vetor_digito(11)) then
		ds_retorno_w := 'S';
	end if;
end if;


return	ds_retorno_w;

end;


function valida_insc_munic_ma(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 9) then
	ds_retorno_w:= 'N';
else
	for i in 1..9 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;
	for i in 1..8 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
		end;
	end loop;

	vl_soma_w:= mod(vl_valor_conta_w, 11);

	if (vl_soma_w > 1) then
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	else
		vl_primeiro_digito_w:= 0;
	end if;


	ds_retorno_w:= 'N';
	if (vl_primeiro_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;

end if;

return	ds_retorno_w;

end;


function valida_insc_munic_go(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);
begin

if (length(nr_inscricao_estadual_p) <> 9) then
ds_retorno_w:= 'N';
else
	for i in 1..9 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;
	for i in 1..8 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
		end;
	end loop;

	vl_soma_w:=  mod(vl_valor_conta_w, 11);

	if (vl_soma_w = 0) then
		vl_primeiro_digito_w:= 0;
	elsif (vl_soma_w > 1) then	
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	
		elsif (substr(nr_inscricao_estadual_p, 1, 8) in (10103105 , 10119997))
		and (vl_soma_w = 1) then
			vl_primeiro_digito_w:= 1;

	end if;

	ds_retorno_w:= 'N';
	if (vl_primeiro_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;
end if;

return	ds_retorno_w;

end;


function valida_insc_munic_ce(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 9) then
	ds_retorno_w:= 'N';
else
	for i in 1..9 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;

	for i in 1..8 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
		end;
	end loop;

	vl_soma_w:=  mod(vl_valor_conta_w, 11);
	if (vl_soma_w > 10) then
		vl_primeiro_digito_w:= 0;
	else
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	end if;

	ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;
end if;


return	ds_retorno_w;

end;

function valida_insc_munic_ap(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;
p			        number(10);
d			        number(10);

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 9) then
	ds_retorno_w:= 'N';
else
	for i in 1..9 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
			if (i <> 9) then
				begin
					vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
					vl_peso_w:= vl_peso_w - 1;
				end;
			end if;
		end;
	end loop;

	if (substr(nr_inscricao_estadual_p, 1, 8) >= 03000001) and (substr(nr_inscricao_estadual_p, 1, 8) <= 03017000 ) then
		p:= 5;
		d:= 0;

	elsif (substr(nr_inscricao_estadual_p, 1, 8) >= 03017001) and (substr(nr_inscricao_estadual_p, 1, 8) <= 03019022) then
		p:= 9;
		d:= 1;
	else
		p:= 0;
		d:= 0;
	end if;

	vl_valor_conta_w:= (vl_valor_conta_w + p);

	vl_soma_w := mod(vl_valor_conta_w, 11);

	if (vl_soma_w = 11) then
		vl_primeiro_digito_w:= d;
	else
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	end if;

	ds_retorno_w:= 'N';
	if (vl_primeiro_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;
        	
end if;


return	ds_retorno_w;

end;


function valida_insc_munic_al(	nr_inscricao_estadual_p		varchar2)
				return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);
begin

if (length(nr_inscricao_estadual_p) <> 9) then
	ds_retorno_w:= 'N';
else
	for i in 1..9 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;

	for i in 1..8 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
		end;
	end loop;

	vl_valor_conta_w:= (vl_valor_conta_w * 10);
	vl_soma_w := mod(vl_valor_conta_w, 11);
	if (vl_soma_w = 10) then
		vl_primeiro_digito_w:= 0;
	else
	vl_primeiro_digito_w:= vl_soma_w;
	end if;

	ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(9))then
		ds_retorno_w := 'S';
	end if;	
end if;

return	ds_retorno_w;
end;


function valida_insc_munic_ac(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_segundo_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 0;
vl_soma_w			number(10):= 0;

type tvetor is varray(13) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 13) then
	ds_retorno_w:= 'N';
else
	for i in 1..13 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;

	vl_peso_w:= 4;

	for i in 1..11 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			if (vl_peso_w = 2) then
				vl_peso_w:= 9;	
			else
				vl_peso_w:= vl_peso_w - 1;
			end if;
		end;
	end loop;

	vl_soma_w:= mod(vl_valor_conta_w, 11);

	if	((11 - vl_soma_w) >= 10) then
		vl_primeiro_digito_w:= 0;
	 else
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	end if;

vl_peso_w:= 5;
vl_valor_conta_w:= 0;
	for i in 1..12 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			if (vl_peso_w = 2) then
				vl_peso_w:= 9;	
			else
				vl_peso_w:= vl_peso_w - 1;
			end if;
		end;
	end loop;

	vl_soma_w:= mod(vl_valor_conta_w, 11);
	if	((11 - vl_soma_w) >= 10) then
		vl_segundo_digito_w:= 0;
	 else
		vl_segundo_digito_w:= (11 - vl_soma_w);
	end if;

	vl_soma_w:= mod(vl_valor_conta_w, 11);
	
	if	((11 - vl_soma_w) >= 10) then
		vl_segundo_digito_w:= 0;
	 else
		vl_segundo_digito_w:= (11 - vl_soma_w);
	end if;

	ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(12)) and (vl_segundo_digito_w = vetor_digito(13)) then
		ds_retorno_w := 'S';
	end if;	
end if;



return	ds_retorno_w;

end;

function valida_insc_munic_pr(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_segundo_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 0;
vl_soma_w			number(10):= 0;

type tvetor is varray(10) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 10) then
	ds_retorno_w:= 'N';
else

	for i in 1..10 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;
vl_peso_w:= 3;

	for i in 1..8 loop
		begin
				vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			if (i = 2) then
				vl_peso_w:=  7;
			else	
				vl_peso_w:= vl_peso_w - 1;
			end if;
		end;
	end loop;

vl_soma_w:= mod(vl_valor_conta_w, 11);

	if	((11 - vl_soma_w) >= 10) then
		vl_primeiro_digito_w:= 0;
	 else
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	end if;

vl_peso_w:= 4;
vl_valor_conta_w:= 0;

	for i in 1..9 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			if (vl_peso_w = 2) then
				vl_peso_w:=  7;
			else	
				vl_peso_w:= vl_peso_w - 1;
			end if;
		end;
	end loop;

vl_soma_w:= mod(vl_valor_conta_w, 11);

	if	((11 - vl_soma_w) >= 10) then
		vl_segundo_digito_w:= 0;
	 else
		vl_segundo_digito_w:= (11 - vl_soma_w);
	end if;

ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(9)) and (vl_segundo_digito_w = vetor_digito(10)) then
		ds_retorno_w := 'S';
	end if;
end if;
return	ds_retorno_w;
end;


function valida_insc_munic_am(	nr_inscricao_estadual_p		varchar2)
				return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin
if (length(nr_inscricao_estadual_p) <> 9) then
	ds_retorno_w:= 'N';
else
	for i in 1..9 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;
	for i in 1..8 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
		end;
	end loop;

	vl_soma_w:= mod(vl_valor_conta_w, 11);
	if	((11 - vl_soma_w) > 1) then	
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	 else
		vl_primeiro_digito_w:= 0;
	end if;

ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;
end if;

return	ds_retorno_w;

end;

function valida_insc_munic_pb(	nr_inscricao_estadual_p		varchar2)
				return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 9) then
ds_retorno_w:= 'N';
else
	for i in 1..9 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;

	for i in 1..8 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
		end;
	end loop;
vl_soma_w:= mod(vl_valor_conta_w, 11);

	if	((11 - vl_soma_w) > 10) then
		vl_primeiro_digito_w:= 0;
	 else
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	end if;

ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;
end if;

return	ds_retorno_w;

end;


function valida_insc_munic_ba(	nr_inscricao_estadual_p		varchar2)
				return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_segundo_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 0;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 9) then
	ds_retorno_w:= 'N';
else
	for i in 1..9 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;

vl_peso_w:= 8;

	for i in 1..7 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
		end;
	end loop;


	if       ((vetor_digito(2) > 0 and vetor_digito(2) < 6) or (vetor_digito(2) = 8)) then
		vl_soma_w:= mod(vl_valor_conta_w, 10);
		if (vl_soma_w > 0) then
			vl_segundo_digito_w:= (10 - vl_soma_w);
	   	else
			vl_segundo_digito_w:= 0;
		end if;
        else
		vl_soma_w:= mod(vl_valor_conta_w, 11);
		vl_segundo_digito_w:= (11 - vl_soma_w);
	end if;

vl_peso_w:= 9;
vl_soma_w:= 0;
vl_valor_conta_w:= 0;

	for i in 1..7 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
			if (i = 7) then
				vl_valor_conta_w:=  vl_valor_conta_w + (vl_segundo_digito_w * vl_peso_w);
			end if;
		end;
	end loop;	

	if       ((vetor_digito(2) > 0 and vetor_digito(2) < 6) or (vetor_digito(2) = 8)) then
		vl_soma_w:= mod(vl_valor_conta_w, 10);
		vl_primeiro_digito_w:= (10 - vl_soma_w);
	 else
		vl_soma_w:= mod(vl_valor_conta_w, 11);
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	end if;

ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(8)) and (vl_segundo_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;
end if;

ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(8)) and (vl_segundo_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;


return	ds_retorno_w;

end;

function valida_insc_munic_pe(	nr_inscricao_estadual_p		varchar2)
				return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_segundo_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 0;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);

vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 9) then
	ds_retorno_w:= 'N';
else
	for i in 1..9 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;

vl_peso_w:= 8;

	for i in 1..7 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
		end;
	end loop;

vl_soma_w:= mod(vl_valor_conta_w, 11);
	if (vl_soma_w > 1) then
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	 else
		vl_primeiro_digito_w:= 0;
	end if;

vl_peso_w:= 9;
vl_valor_conta_w:= 0;

	for i in 1..8 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
		end;
	end loop;

vl_soma_w:= mod(vl_valor_conta_w, 11);

	if (vl_soma_w > 1) then
		vl_segundo_digito_w:= (11 - vl_soma_w);
	 else
		vl_segundo_digito_w:= 0;
	end if;


ds_retorno_w:= 'N';
	if (vl_primeiro_digito_w = vetor_digito(8)) and (vl_segundo_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;
end if;

return	ds_retorno_w;

end;


function valida_insc_munic_sc(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 9) then
	ds_retorno_w:= 'N';
else
	for i in 1..9 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;

	for i in 1..8 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
		end;
	end loop;

	vl_soma_w:= mod(vl_valor_conta_w, 11);

	if ((vl_soma_w = 0) or (vl_soma_w = 1)) then
		vl_primeiro_digito_w:= 0;
	 else
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	end if;

ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(9)) then
		ds_retorno_w := 'S';
	end if;	
end if;

return	ds_retorno_w;

end;


function valida_insc_munic_rs(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 2;
vl_soma_w			number(10):= 0;

type tvetor is varray(10) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0,0);

begin
if (length(nr_inscricao_estadual_p) <> 10) then
	ds_retorno_w:= 'N';
else
	for i in 1..10 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;

	for i in 1..9 loop
		begin
			vl_valor_conta_w:=  vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			if (vl_peso_w in (2)) then
				vl_peso_w:=   9;
			else	
				vl_peso_w:= vl_peso_w - 1;
			end if;
		end;
	end loop;

vl_soma_w:= mod(vl_valor_conta_w, 11);

	if	((11 - vl_soma_w) >= 10) then
		vl_primeiro_digito_w:= 0;
	 else
		vl_primeiro_digito_w:= (11 - vl_soma_w);
	end if;

ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(10)) then 
		ds_retorno_w := 'S';
	end if;	
end if;


return	ds_retorno_w;

end;


function valida_insc_munic_es(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 9;
vl_soma_w			number(10):= 0;

type tvetor is varray(9) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0);

begin

if (length(nr_inscricao_estadual_p) <> 9) then
		ds_retorno_w:= 'N';
        else
		for i in 1..9 loop
			begin
				vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
			end;
		end loop;

	for i in 1..8 loop
		begin
			vl_valor_conta_w:=	vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			vl_peso_w:= vl_peso_w - 1;
		end;
	end loop;

vl_soma_w:= mod(vl_valor_conta_w, 11);

	if (vl_soma_w <= 1) then
		vl_primeiro_digito_w:= 0;
	else
		vl_primeiro_digito_w:=  11 - vl_soma_w;
	end if;

ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(9)) then 
		ds_retorno_w := 'S';
	end if;

end if;
     
return	ds_retorno_w;

end;


function valida_insc_munic_rj(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 0;
vl_soma_w			number(10):= 0;

type tvetor is varray(8) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0);

begin
if (length(nr_inscricao_estadual_p) <> 8) then
	ds_retorno_w:= 'N';
else
	for i in 1..8 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;	

vl_peso_w := 2;

	for i in 1..7 loop
		begin
			vl_valor_conta_w:=	vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			if (vl_peso_w in (2)) then
				vl_peso_w:=   7;
			else	
				vl_peso_w:= vl_peso_w - 1;
			end if;
		end;
	end loop;

vl_soma_w:= mod(vl_valor_conta_w, 11);


	if (vl_soma_w <= 1) then
		vl_primeiro_digito_w:= 0;
	else
		vl_primeiro_digito_w:=  11 - vl_soma_w;
	end if;

ds_retorno_w:= 'N';

	if (vl_primeiro_digito_w = vetor_digito(8)) then 
		ds_retorno_w := 'S';
	end if;
end if;

     
return	ds_retorno_w;

end;


function valida_insc_munic_df(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_segundo_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 0;
vl_soma_w			number(10):= 0;

type tvetor is varray(13) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0,0,0,0,0);

begin
if (length(nr_inscricao_estadual_p) <> 13) then
	ds_retorno_w:= 'N';
else
	for i in 1..13 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;	

vl_peso_w := 4;
	for i in 1..11 loop
		begin
			vl_valor_conta_w:=	vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			if (vl_peso_w in (2)) then
				vl_peso_w:=   9;
			else	
				vl_peso_w:= vl_peso_w - 1;
			end if;
	
		end;
	end loop;

vl_soma_w:= mod(vl_valor_conta_w, 11);

	if ((vl_soma_w - 11) >= 10) then
		vl_primeiro_digito_w :=  0;
	else
		vl_primeiro_digito_w :=  11 - vl_soma_w;
	end if;

vl_valor_conta_w	:= 0;	
vl_peso_w		:= 5;
vl_soma_w               := 0;

	for i in 1..12 loop
		begin
			vl_valor_conta_w:=	vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			if (vl_peso_w in (2)) then
				vl_peso_w:=  9;
			else	
			vl_peso_w:= vl_peso_w - 1;
			end if;
		end;
	end loop;

vl_soma_w:= mod(vl_valor_conta_w, 11);

	if ((11 - vl_soma_w ) >= 10) then
		vl_segundo_digito_w :=  0;
        else
		vl_segundo_digito_w :=  11 - vl_soma_w;
	end if;

ds_retorno_w:= 'N';

	if	((vl_primeiro_digito_w = vetor_digito(12)) and (vl_segundo_digito_w = vetor_digito(13))) then 
		ds_retorno_w := 'S';
	end if;
end if;

return	ds_retorno_w;

end;



function valida_insc_munic_sp(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is
ds_retorno_w			varchar2(255);
vl_primeiro_digito_w		number(10);
vl_segundo_digito_w		number(10);
vl_valor_conta_w		number(10):= 0;
vl_peso_w			number(10):= 1;

type tvetor is varray(12) of number(4);
vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0,0,0,0);

begin
if (length(nr_inscricao_estadual_p) <> 12) then
	ds_retorno_w:= 'N';
else
	for i in 1..12 loop
		begin
			vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
		end;
	end loop;


	for i in 1..8 loop
		begin
			vl_valor_conta_w:=	vl_valor_conta_w + (vetor_digito(i) * vl_peso_w);
			if (vl_peso_w in (1, 8)) then
				vl_peso_w:= vl_peso_w + 2;
			else	
				vl_peso_w:= vl_peso_w + 1;
			end if;
		end;
	end loop;
	
	if (mod(vl_valor_conta_w, 11) >= 10) then
		vl_primeiro_digito_w :=  0;
	else
		vl_primeiro_digito_w :=  mod(vl_valor_conta_w, 11);
	end if;
	
vl_valor_conta_w	:= 0;	
vl_peso_w		:= 3;

	for i in 1..11 loop
		begin
			vl_valor_conta_w := vl_valor_conta_w +  (vetor_digito(i) * vl_peso_w);
			if (vl_peso_w = 2) then
				vl_peso_w:= 10;
			else	
				vl_peso_w:= vl_peso_w - 1;
			end if;
		end;
	end loop;

	if (mod(vl_valor_conta_w, 11) >= 10) then
		vl_segundo_digito_w :=  0;
	else
		vl_segundo_digito_w :=  mod(vl_valor_conta_w, 11);
	end if;

ds_retorno_w:= 'N';

	if	((vl_primeiro_digito_w = vetor_digito(9)) and (vl_segundo_digito_w = vetor_digito(12))) then 
		ds_retorno_w := 'S';
	end if;
end if;


    
return	ds_retorno_w;

end;
   

		

function valida_insc_munic_mg(	nr_inscricao_estadual_p		varchar2)
 		    	return varchar2 is

ds_retorno_w			varchar2(255);
vl_total_w			number(15);
vl_valor_conta_w		number(10);
vl_multiplicador_w		number(10);
vl_primeiro_digito_w		number(10);
vl_segundo_digito_w		number(10);

type tvetor is varray(11) of number(4);

vetor_digito tvetor := tvetor(0,0,0,0,0,0,0,0,0,0,0);

begin



for i in 1..11 loop
	begin
	
	vetor_digito(i) := substr(nr_inscricao_estadual_p, i, 1);
	
	end;
end loop;

vl_total_w:= 0;
vl_multiplicador_w:= 1;

for i in 1..vetor_digito.count loop
	begin
	
	vl_valor_conta_w:= vetor_digito(i) * vl_multiplicador_w;
	
	if (length(vl_valor_conta_w) > 1) then
		vl_total_w:= vl_total_w + substr(vl_valor_conta_w, 1, 1) + substr(vl_valor_conta_w, 2, 1);
	else
		vl_total_w:= vl_total_w + vl_valor_conta_w;
	end if;
	
	if (i <> 3) then
		if (vl_multiplicador_w = 1) then
			vl_multiplicador_w:= 2;
		else	
			vl_multiplicador_w:= 1;
		end if;
	end if;
	end;
end loop;

vl_primeiro_digito_w:= (trunc(vl_total_w, -1) + 10) - vl_total_w;

if (vl_primeiro_digito_w >= 10 ) then
	vl_primeiro_digito_w:= 0;
end if;

vl_total_w:= 0;
vl_multiplicador_w:= 2;

vl_total_w:= vl_primeiro_digito_w * vl_multiplicador_w;

vl_multiplicador_w:= 3;

for i IN REVERSE vetor_digito.count..1 loop
	begin
	vl_valor_conta_w:= vetor_digito(i) * vl_multiplicador_w;
	vl_total_w	:= vl_total_w + vl_valor_conta_w;
	
	if (vl_multiplicador_w = 11) then
		vl_multiplicador_w:= 2;
	else
		vl_multiplicador_w:=	vl_multiplicador_w + 1;
	end if;
		
	end;
end loop;

if (mod(vl_total_w, 11) = 1) or (mod(vl_total_w, 11) = 0) then
	vl_segundo_digito_w:= 0;
else	
	vl_segundo_digito_w:= 11 - mod(vl_total_w, 11);
end if;

ds_retorno_w:= 'N';
if	((substr(nr_inscricao_estadual_p, length(nr_inscricao_estadual_p) - 1, 1) = vl_primeiro_digito_w) and
	((substr(nr_inscricao_estadual_p, length(nr_inscricao_estadual_p), 1)) = vl_segundo_digito_w)) then
	ds_retorno_w:= 'S';
end if;

return	ds_retorno_w;

end;

begin


nr_inscricao_estadual_w:= nr_inscricao_estadual_p;

if (coalesce(upper(nr_inscricao_estadual_w), upper('ISENTO')) = 'ISENTO') then
	ds_retorno_w:=	'S';
else

	if (coalesce(nr_inscricao_estadual_w::text, '') = '') then
		ds_retorno_w:=	'N';
	else	
		begin
		
		nr_inscricao_estadual_w:= pls_elimina_caracteres(elimina_caractere_esp_asc(replace(replace(replace(replace(nr_inscricao_estadual_p, '/', ''), '.', ''), '-', ''), '@', ''), 'S', 'S'));
		
		case upper(sg_estado_p)
		when 'AC' then
		ds_retorno_w := valida_insc_munic_ac(nr_inscricao_estadual_w);
		when 'AL' then
		ds_retorno_w := valida_insc_munic_al(nr_inscricao_estadual_w);
		when 'AP' then
		ds_retorno_w := valida_insc_munic_ap(nr_inscricao_estadual_w);
		when 'AM' then
		ds_retorno_w := valida_insc_munic_am(nr_inscricao_estadual_w);
		when 'BA' then
		ds_retorno_w := valida_insc_munic_ba(nr_inscricao_estadual_w);
		when 'CE' then
		ds_retorno_w := valida_insc_munic_ce(nr_inscricao_estadual_w);
		when 'DF' then
		ds_retorno_w := valida_insc_munic_df(nr_inscricao_estadual_w);
		when 'ES' then
		ds_retorno_w := valida_insc_munic_es(nr_inscricao_estadual_w);
		when 'GO' then
		ds_retorno_w := valida_insc_munic_go(nr_inscricao_estadual_w);
		when 'MA' then
		ds_retorno_w := valida_insc_munic_ma(nr_inscricao_estadual_w);
		when 'MT' then
		ds_retorno_w := valida_insc_munic_mt(nr_inscricao_estadual_w);
		when 'MS' then
		ds_retorno_w := valida_insc_munic_ms(nr_inscricao_estadual_w);
		when 'MG' then
		ds_retorno_w := valida_insc_munic_mg(nr_inscricao_estadual_w);
		when 'PA' then
		ds_retorno_w := valida_insc_munic_pa(nr_inscricao_estadual_w);
		when 'PB' then
		ds_retorno_w := valida_insc_munic_pb(nr_inscricao_estadual_w);
		when 'PR' then
		ds_retorno_w := valida_insc_munic_pr(nr_inscricao_estadual_w);
		when 'PE' then
		ds_retorno_w := valida_insc_munic_pe(nr_inscricao_estadual_w);
		when 'PI' then
		ds_retorno_w := valida_insc_munic_pi(nr_inscricao_estadual_w);
		when 'RJ' then
		ds_retorno_w := valida_insc_munic_rj(nr_inscricao_estadual_w);
		when 'RN' then
		ds_retorno_w := valida_insc_munic_rn(nr_inscricao_estadual_w);
		when 'RS' then
		ds_retorno_w := valida_insc_munic_rs(nr_inscricao_estadual_w);
		when 'RO' then
		ds_retorno_w := valida_insc_munic_ro(nr_inscricao_estadual_w);
		when 'RR' then
		ds_retorno_w := valida_insc_munic_rr(nr_inscricao_estadual_w);
		when 'SC' then
		ds_retorno_w := valida_insc_munic_sc(nr_inscricao_estadual_w);
		when 'SP' then
		ds_retorno_w := valida_insc_munic_sp(nr_inscricao_estadual_w);
		when 'SE' then
		ds_retorno_w := valida_insc_munic_se(nr_inscricao_estadual_w);
		when 'TO' then
		ds_retorno_w := valida_insc_munic_to(nr_inscricao_estadual_w);
		else
		ds_retorno_w := 'S';
		end case;
		
		end;
	end if;
end if;

return	ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_insc_municipal_valida ( nr_inscricao_estadual_p text, sg_estado_p text) FROM PUBLIC;

