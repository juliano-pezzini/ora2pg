-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION pls_obter_valor_reg_auxiliar ( nr_seq_reg_auxiliar_p bigint, ie_tipo_reg_auxiliar_ans_p text, cd_conta_contabil_p text) RETURNS bigint AS $body$
DECLARE


vl_reg_auxiliar_w		double precision;


BEGIN

if ie_tipo_reg_auxiliar_ans_p in ('8000','8001','8011','8012','8020','8022') then

	select	sum(a.vl_pagar)
	into STRICT	vl_reg_auxiliar_w
	from	w_ctb_livro_aux_event_liq a
	where	a.nr_seq_reg_auxiliar 	= nr_seq_reg_auxiliar_p
	and	((a.cd_conta_contabil   = cd_conta_contabil_p)
	or (coalesce(cd_conta_contabil_p,'0') = '0')
	and (coalesce(a.cd_conta_contabil,'0') = '0'));

elsif ie_tipo_reg_auxiliar_ans_p in ('8002','8003') then

	select	sum(a.vl_glosa)
	into STRICT	vl_reg_auxiliar_w
	from	w_ctb_livro_aux_event_liq a
	where	a.nr_seq_reg_auxiliar 	= nr_seq_reg_auxiliar_p
	and	((a.cd_conta_contabil   = cd_conta_contabil_p)
	or (coalesce(cd_conta_contabil_p,'0') = '0')
	and (coalesce(a.cd_conta_contabil,'0') = '0'));

elsif ie_tipo_reg_auxiliar_ans_p in ('8005') then

	select	sum(a.vl_coparticipacao)
	into STRICT	vl_reg_auxiliar_w
	from	w_ctb_livro_aux_event_liq a
	where	a.nr_seq_reg_auxiliar 	= nr_seq_reg_auxiliar_p
	and	((a.cd_conta_contabil   = cd_conta_contabil_p)
	or (coalesce(cd_conta_contabil_p,'0') = '0')
	and (coalesce(a.cd_conta_contabil,'0') = '0'));

elsif ie_tipo_reg_auxiliar_ans_p in ('8004','8013') then

	select	sum(a.vl_evento)
	into STRICT	vl_reg_auxiliar_w
	from	w_ctb_livro_aux_event_liq a
	where	a.nr_seq_reg_auxiliar 	= nr_seq_reg_auxiliar_p
	and	((a.cd_conta_contabil   = cd_conta_contabil_p)
	or (coalesce(cd_conta_contabil_p,'0') = '0')
	and (coalesce(a.cd_conta_contabil,'0') = '0'));

elsif ie_tipo_reg_auxiliar_ans_p in ('8007','8008','8009','8010','8014','8016','8018','8024') then

	select	sum(a.vl_parcela)
	into STRICT	vl_reg_auxiliar_w
	from	w_ctb_aux_contra_emit a
	where	1 = 1
	and	a.nr_seq_reg_auxiliar 	= nr_seq_reg_auxiliar_p
	and	coalesce(a.cd_conta_contabil,'0')  = coalesce(cd_conta_contabil_p,'0');

end if;

return	vl_reg_auxiliar_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pls_obter_valor_reg_auxiliar ( nr_seq_reg_auxiliar_p bigint, ie_tipo_reg_auxiliar_ans_p text, cd_conta_contabil_p text) FROM PUBLIC;

