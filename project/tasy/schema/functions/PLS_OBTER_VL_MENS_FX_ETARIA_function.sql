-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION pls_obter_vl_mens_fx_etaria ( nr_seq_proposta_p bigint, qt_idade_inicial_p bigint, qt_idade_final_p bigint) RETURNS bigint AS $body$
DECLARE

				 
vl_mensalidade_w	double precision;


BEGIN 
 
select	coalesce(sum(vl_mensalidade),-1) vl_mensalidade 
into STRICT 	vl_mensalidade_w			 
from ( SELECT	(substr(pls_obter_total_proposta_benef(b.nr_sequencia),1,255))::numeric  vl_mensalidade 
	from	pessoa_fisica			c, 
		pls_proposta_beneficiario	b, 
		pls_proposta_adesao		a 
	where	a.nr_sequencia			= b.nr_seq_proposta		 
	and	b.cd_beneficiario 		= c.cd_pessoa_fisica 
	and (substr(obter_idade(dt_nascimento, clock_timestamp(), 'A'),1,100)) between qt_idade_inicial_p and qt_idade_final_p	 
	and	a.nr_sequencia			= (nr_seq_proposta_p)::numeric ) alias10;
		 
return	vl_mensalidade_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pls_obter_vl_mens_fx_etaria ( nr_seq_proposta_p bigint, qt_idade_inicial_p bigint, qt_idade_final_p bigint) FROM PUBLIC;

