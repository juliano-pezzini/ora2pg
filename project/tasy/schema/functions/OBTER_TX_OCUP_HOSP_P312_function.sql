-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_tx_ocup_hosp_p312 (dt_referencia_p timestamp, cd_estabelecimento_p bigint) RETURNS bigint AS $body$
DECLARE

		 
vl_retorno_w	double precision;


BEGIN 
 
select 	sum(nr_acum) 
into STRICT	vl_retorno_w 
from	(SELECT dividir(sum(qt_paciente_dia),(sum(qt_leito_dia)+sum(qt_bloq))-sum(qt_ex_ocup))*100 nr_acum 
	 from 	eis_ocupacao_hospitalar_p312_v a 
	 where 1 = 1 
	 and cd_estabelecimento = cd_estabelecimento_p 
	 and cd_empresa = a.cd_empresa 
	 and (ds_estabelecimento IS NOT NULL AND ds_estabelecimento::text <> '') 
	 and dt_referencia between dt_referencia_p and dt_referencia_p) alias8;
 
 
return	vl_retorno_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_tx_ocup_hosp_p312 (dt_referencia_p timestamp, cd_estabelecimento_p bigint) FROM PUBLIC;

