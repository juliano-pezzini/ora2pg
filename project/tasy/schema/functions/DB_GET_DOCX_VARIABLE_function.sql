-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION db_get_docx_variable ( nr_seq_macro_p db_content_macro.nr_sequencia%type, ie_get_version_p text default 'N') RETURNS varchar AS $body$
DECLARE


/*
	++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
	Objective: Show the formatted macro for the user
	------------------------------------------------------------------------
	Direct call: 
	[   ] Dictionary objects
	[ X ] Tasy (Delphi/Java/HTML5)
	[   ] Portal
	[   ] Reports
	[   ] Others:
	 -----------------------------------------------------------------------
	Attention points: N/A
	------------------------------------------------------------------------
	References:	
		Tables: db_content_macro
		SQL objects: 
	++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
*/
nr_seq_macro_w	db_content_macro.nr_sequencia%type;
ds_macro_w	db_content_macro.ds_macro%type;
nr_version_w	db_content_macro.nr_version%type;

ds_retorno_w	varchar(4000);


BEGIN

	select	cm.nr_sequencia,
		cm.ds_macro,
		cm.nr_version
	into STRICT	nr_seq_macro_w,
		ds_macro_w,
		nr_version_w
	from	db_content_macro cm
	where	cm.nr_sequencia = nr_seq_macro_p;

	if (nr_seq_macro_w IS NOT NULL AND nr_seq_macro_w::text <> '') then
		begin
		
			if (ie_get_version_p = 'S') then
				begin
					select	'${@' || ds_macro_w || '@' || nr_version_w || '}'
					into STRICT	ds_retorno_w
					;
				end;
			else
				begin
					select	'${@' || ds_macro_w || '}'
					into STRICT	ds_retorno_w
					;
				end;
			end if;
		end;
	end if;

	return ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION db_get_docx_variable ( nr_seq_macro_p db_content_macro.nr_sequencia%type, ie_get_version_p text default 'N') FROM PUBLIC;

