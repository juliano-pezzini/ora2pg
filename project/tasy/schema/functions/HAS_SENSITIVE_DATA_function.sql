-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION has_sensitive_data ( ie_type_p text, nm_table_p text) RETURNS varchar AS $body$
DECLARE


/*
 * ie_type_p: defines the type of information
 *     TABLE: returns if a system table has sensitive data
 *
 * returns:
 * - Y for Yes
 * - N for No
 */
ie_return_w	varchar(1) := 'N'; --No;
BEGIN

if (ie_type_p = 'TABLE') then

	select  	CASE WHEN count(*)=0 THEN  'N'  ELSE 'Y' END
	into STRICT 	ie_return_w
        	from    	tabela_atributo x
        	where	x.nm_tabela = nm_table_p
        	and     	coalesce(x.ie_situacao, 'I') = 'A'
        	and    	coalesce(x.ie_informacao_sensivel, 'N') = 'S';

end if;

return ie_return_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION has_sensitive_data ( ie_type_p text, nm_table_p text) FROM PUBLIC;

