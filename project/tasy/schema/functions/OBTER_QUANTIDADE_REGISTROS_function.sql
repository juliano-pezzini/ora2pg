-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_quantidade_registros ( ie_opcao_p text, nr_sequencia_p bigint) RETURNS bigint AS $body$
DECLARE


qt_retorno_w			bigint;
qt_c2_w				bigint;
qt_c3_w				bigint;
qt_c4_w				bigint;
qt_c9_w				bigint;
qt_c1_w				bigint;


BEGIN

begin

select	count(*)
into STRICT	qt_c1_w
from	pls_outorgante	a,
	pessoa_juridica	b,
	pls_reajuste	c,
	pls_contrato	d
where	a.cd_cgc_outorgante	= b.cd_cgc
and	c.nr_seq_contrato	= d.nr_sequencia
and	d.cd_cgc_estipulante	= b.cd_cgc
and	c.nr_sequencia		= nr_sequencia_p;

select	count(*)
into STRICT	qt_c2_w
from	pls_plano	c,
	pls_contrato	d,
	pls_segurado	e,
	pls_reajuste	f
where	c.nr_sequencia		= e.nr_seq_plano
and	e.nr_seq_contrato	= d.nr_sequencia
and	f.nr_seq_contrato	= d.nr_sequencia
and	f.nr_Sequencia		= nr_sequencia_p;

select	count(*)
into STRICT	qt_c3_w
from	pls_plano	c,
	pls_contrato	d,
	pls_segurado	e,
	pls_reajuste	a
where	c.nr_sequencia		= e.nr_seq_plano
and	e.nr_seq_contrato	= d.nr_sequencia
and	a.nr_seq_contrato	= d.nr_sequencia
and	a.nr_sequencia		= nr_sequencia_p;

select count(*)
into STRICT	qt_c4_w
from	pls_reajuste_preco	a,
	pls_plano_preco		b,
	pls_reajuste		c,
	pls_reajuste_tabela	d,
	pls_plano		e
where	a.nr_seq_preco		= b.nr_sequencia
and	a.nr_seq_reajuste	= c.nr_sequencia
and	a.nr_seq_tabela		= d.nr_sequencia
and	d.nr_seq_reajuste	= c.nr_sequencia
and	d.nr_seq_plano		= e.nr_sequencia
and	c.nr_sequencia		= nr_sequencia_p;

select	count(*)
into STRICT	qt_c9_w
from	pls_outorgante	a,
	pessoa_juridica	b,
	pls_reajuste	c,
	pls_plano_preco d,
	pls_plano	e,
	pls_contrato	f,
	pls_segurado	g,
	pls_reajuste_preco h
where	a.cd_cgc_outorgante	= b.cd_cgc
and	f.nr_sequencia		= c.nr_seq_contrato
and	a.nr_sequencia		= e.nr_seq_outorgante
and	f.cd_cgc_estipulante	= b.cd_cgc
and	g.nr_seq_contrato	= f.nr_sequencia
and	g.nr_seq_plano		= e.nr_sequencia
and	h.nr_seq_preco		= d.nr_sequencia
and	h.nr_seq_reajuste	= c.nr_sequencia
and	g.cd_subestipulante_pj	= b.cd_cgc
and	c.nr_sequencia		= nr_sequencia_p;


if (ie_opcao_p	= 'C2') then
	qt_retorno_w	:= qt_c2_w;
elsif (ie_opcao_p	= 'C3') then
	qt_retorno_w	:= qt_c3_w;
elsif (ie_opcao_p	= 'C4') then
	qt_retorno_w	:= qt_c4_w;
elsif (ie_opcao_p	= 'Total') then
	qt_retorno_w	:= qt_c2_w + qt_c3_w + qt_c4_w + qt_c1_w + 2;--qt_c9_w;
end if;

end;

return	qt_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_quantidade_registros ( ie_opcao_p text, nr_sequencia_p bigint) FROM PUBLIC;

