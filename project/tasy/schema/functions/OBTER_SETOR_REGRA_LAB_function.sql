-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_setor_regra_lab (nr_prescricao_p bigint, nr_seq_exame_p bigint, cd_setor_atendimento_p bigint, cd_material_exame_p text, dt_coleta_p timestamp, ie_urgencia_p text) RETURNS varchar AS $body$
DECLARE

				 
 
cd_setor_atend_w			varchar(255);
cd_setor_coleta_w			varchar(255);
cd_setor_entrega_w			varchar(255);
qt_dia_entrega_w			smallint;
ie_emite_mapa_w				varchar(1);
ds_hora_fixa_w				varchar(2);
ie_data_resultado_w			varchar(1);
qt_min_entrega_w			bigint;
ie_atualizar_recoleta_w		varchar(1);
ie_dia_semana_final_w 		bigint;
qt_min_atraso_w				bigint;
ie_forma_atual_dt_result_w	exame_lab_regra_setor.ie_atul_data_result%type;


BEGIN 
 
if (nr_prescricao_p IS NOT NULL AND nr_prescricao_p::text <> '') and (nr_seq_exame_p IS NOT NULL AND nr_seq_exame_p::text <> '') then	 
	 
	SELECT * FROM obter_setor_exame_lab(nr_prescricao_p, nr_seq_exame_p, cd_setor_atendimento_p, cd_material_exame_p, dt_coleta_p, 'N', cd_setor_atend_w, cd_setor_coleta_w, cd_setor_entrega_w, qt_dia_entrega_w, ie_emite_mapa_w, ds_hora_fixa_w, ie_data_resultado_w, qt_min_entrega_w, ie_atualizar_recoleta_w, ie_urgencia_p, ie_dia_semana_final_w, ie_forma_atual_dt_result_w, qt_min_atraso_w) INTO STRICT cd_setor_atend_w, cd_setor_coleta_w, cd_setor_entrega_w, qt_dia_entrega_w, ie_emite_mapa_w, ds_hora_fixa_w, ie_data_resultado_w, qt_min_entrega_w, ie_atualizar_recoleta_w, ie_dia_semana_final_w, ie_forma_atual_dt_result_w, qt_min_atraso_w;
end if;
 
		 
return	obter_somente_numero(cd_setor_atend_w);
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_setor_regra_lab (nr_prescricao_p bigint, nr_seq_exame_p bigint, cd_setor_atendimento_p bigint, cd_material_exame_p text, dt_coleta_p timestamp, ie_urgencia_p text) FROM PUBLIC;

