-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION pls_obter_abrangencia_resumida ( nr_seq_segurado_p bigint) RETURNS varchar AS $body$
DECLARE


ds_retorno_w			varchar(10);
ie_abrangencia_intercambio_w	varchar(1);


BEGIN

select	max(ie_abrangencia_intercambio)
into STRICT	ie_abrangencia_intercambio_w
from	pls_segurado
where	nr_sequencia	= nr_seq_segurado_p;

if (coalesce(ie_abrangencia_intercambio_w::text, '') = '') then
	select	CASE WHEN a.ie_abrangencia='N' THEN 'Nac.' WHEN a.ie_abrangencia='GE' THEN 'Reg.A' WHEN a.ie_abrangencia='GM' THEN 'Reg. B' WHEN a.ie_abrangencia='E' THEN 'Est.' WHEN a.ie_abrangencia='M' THEN 'Mun' END
	into STRICT	ds_retorno_w
	from	pls_segurado	b,
		pls_plano	a
	where	b.nr_seq_plano	= a.nr_sequencia
	and	b.nr_sequencia	= nr_seq_segurado_p;
else
	select	CASE WHEN ie_abrangencia_intercambio_w='1' THEN 'Nac.' WHEN ie_abrangencia_intercambio_w='2' THEN 'Reg.A' WHEN ie_abrangencia_intercambio_w='4' THEN 'Reg.A' WHEN ie_abrangencia_intercambio_w='3' THEN 'Est.' WHEN ie_abrangencia_intercambio_w='5' THEN 'Mun' END
	into STRICT	ds_retorno_w
	;
end if;

return	ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pls_obter_abrangencia_resumida ( nr_seq_segurado_p bigint) FROM PUBLIC;

