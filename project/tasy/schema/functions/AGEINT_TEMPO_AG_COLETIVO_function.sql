-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION ageint_tempo_ag_coletivo (NR_SEQ_AGENDA_INT_P bigint, QT_TEMPO_AGENDA_P bigint) RETURNS bigint AS $body$
DECLARE

  QT_AGE_COLETIVO_W  bigint;
  NR_MIN_DURACAO_TOTAL_W bigint;

BEGIN
  IF (OBTER_VALOR_PARAM_USUARIO(869, 410, OBTER_PERFIL_ATIVO, OBTER_USUARIO_ATIVO, OBTER_ESTABELECIMENTO_ATIVO) = 'S') THEN

    SELECT   COUNT(A.NR_SEQUENCIA)
    INTO STRICT  QT_AGE_COLETIVO_W
    FROM  AGENDAMENTO_COLETIVO A
    WHERE  A.NR_SEQ_AG_INTEGRADA = NR_SEQ_AGENDA_INT_P;

    NR_MIN_DURACAO_TOTAL_W := QT_TEMPO_AGENDA_P;

    IF (QT_AGE_COLETIVO_W > 0) THEN
      SELECT (QT_TEMPO_AGENDA_P * QT_AGE_COLETIVO_W)
      INTO STRICT	NR_MIN_DURACAO_TOTAL_W
;
    END IF;

    RETURN NR_MIN_DURACAO_TOTAL_W;

  END IF;
  
  RETURN QT_TEMPO_AGENDA_P;


END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION ageint_tempo_ag_coletivo (NR_SEQ_AGENDA_INT_P bigint, QT_TEMPO_AGENDA_P bigint) FROM PUBLIC;

