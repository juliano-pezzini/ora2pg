-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION get_related_flowcharts ( nr_sequencia_p bigint) RETURNS varchar AS $body$
DECLARE


flowcharts_w		varchar(3000);
ds_w		varchar(3000) := '';

c01 CURSOR FOR
SELECT  substr(obter_desc_fluxo_relacionado(b.NR_SEQ_FLUXO_RELACIONADO),1,255) flowcharts
from    MANCHESTER_FLUXOGRAMA a,
        MANCHESTER_FLUXO_RELAC b
where   a.NR_SEQUENCIA = b.NR_SEQ_MANCHESTER
and     a.NR_SEQUENCIA = nr_sequencia_p
order by b.NR_SEQUENCIA;


BEGIN

open c01;
loop
fetch c01 into	flowcharts_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
    begin
      select CASE WHEN coalesce(ds_w::text, '') = '' THEN  flowcharts_w  ELSE ds_w || ', ' || flowcharts_w END
      into STRICT ds_w
;
    end;
end loop;
close c01;

if (ds_w IS NOT NULL AND ds_w::text <> '') then
  ds_w := '</br> </br> <strong>' || obter_desc_expressao(620845) || ': </strong>' || ds_w;
end if;

return ds_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION get_related_flowcharts ( nr_sequencia_p bigint) FROM PUBLIC;

