-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_consistir_tit_classif (nr_titulo_p bigint, cd_perfil_p bigint, nm_usuario_p text, cd_estabelecimento_p bigint) RETURNS varchar AS $body$
DECLARE

qt_registros_w 		integer 	:= -1;
retorno_w			varchar(1)	:= 'S';
param_usuario_w		varchar(1);

BEGIN
if (nr_titulo_p IS NOT NULL AND nr_titulo_p::text <> '') and (cd_perfil_p IS NOT NULL AND cd_perfil_p::text <> '') and (nm_usuario_p IS NOT NULL AND nm_usuario_p::text <> '') and (cd_estabelecimento_p IS NOT NULL AND cd_estabelecimento_p::text <> '') then
	begin
	param_usuario_w := obter_parametro_usuario(801, cd_perfil_p, nm_usuario_p, cd_estabelecimento_p);
	if (param_usuario_w = 'S') then
		begin
		select  	count(*)
		into STRICT	qt_registros_w
		from    	titulo_pagar_classif a
		where   	a.nr_titulo = nr_titulo_p
		and ((a.cd_centro_custo IS NOT NULL AND a.cd_centro_custo::text <> '')
		or 	(a.cd_conta_contabil IS NOT NULL AND a.cd_conta_contabil::text <> ''));
		end;
	elsif (param_usuario_w = 'F') then
		begin
		select  	count(*)
		into STRICT	qt_registros_w
		from    	titulo_pagar_classif a
                	where   	a.nr_titulo = nr_titulo_p
                	and (a.nr_seq_conta_financ IS NOT NULL AND a.nr_seq_conta_financ::text <> '');
		end;
	end if;
	if (qt_registros_w = 0) then
		begin
		retorno_w	:= 'N';
		end;
	end if;
	end;
end if;
return	retorno_w;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_consistir_tit_classif (nr_titulo_p bigint, cd_perfil_p bigint, nm_usuario_p text, cd_estabelecimento_p bigint) FROM PUBLIC;

