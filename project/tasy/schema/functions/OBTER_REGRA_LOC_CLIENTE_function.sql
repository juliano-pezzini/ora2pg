-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_regra_loc_cliente ( nr_seq_localizador_p bigint, cd_estabelecimento_p bigint, cd_perfil_p bigint, cd_funcao_p bigint, nm_usuario_p text) RETURNS varchar AS $body$
DECLARE


ds_retorno_w		varchar(255) := null;
vl_configuracao_w	varchar(50) := null;
ie_configuracao_w	varchar(15) := null;

c01 CURSOR FOR
	SELECT	b.ie_configuracao,
			b.vl_configuracao
	from	tipo_localizador_cliente a,
			tipo_loc_cliente_item b
	where	a.nr_seq_localizador = nr_seq_localizador_p
	and		a.nr_sequencia = b.nr_seq_loc_cliente
	and	coalesce(cd_estabelecimento,	cd_estabelecimento_p)	= cd_estabelecimento_p
	and	coalesce(cd_perfil, 		cd_perfil_p)		= cd_perfil_p
	and	coalesce(cd_funcao, 		cd_funcao_p)		= cd_funcao_p
	and	coalesce(nm_usuario_reg, 	nm_usuario_p) 		= nm_usuario_p
	order by
		coalesce(nm_usuario_reg,'AAA'),
		coalesce(cd_funcao,0),
		coalesce(cd_perfil,0),
		coalesce(cd_estabelecimento,0);

BEGIN

open c01;
loop
fetch c01 into
	ie_configuracao_w,
	vl_configuracao_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
	ds_retorno_w	:= ds_retorno_w || ie_configuracao_w || '=' || vl_configuracao_w || ';';
end	loop;
close c01;

return	ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_regra_loc_cliente ( nr_seq_localizador_p bigint, cd_estabelecimento_p bigint, cd_perfil_p bigint, cd_funcao_p bigint, nm_usuario_p text) FROM PUBLIC;

