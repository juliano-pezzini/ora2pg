-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION get_icon_path (nr_seq_conceito bigint, nr_seq_imagem bigint) RETURNS varchar AS $body$
DECLARE


w_ds_retorno varchar(1000) := null;
w_barra varchar(1);


BEGIN
	if (nr_seq_conceito IS NOT NULL AND nr_seq_conceito::text <> '') then
		begin
			select i.ds_dir_img_server
			  into STRICT w_ds_retorno
			  from tasy_padrao_conceito_html c
			 inner join tasy_padrao_imagem_html i on i.nr_sequencia = c.nr_seq_img_html
			 where c.nr_sequencia = nr_seq_conceito;
		exception when no_data_found then
			w_ds_retorno := null;
		 end;

	elsif (nr_seq_imagem IS NOT NULL AND nr_seq_imagem::text <> '') then
		begin
			select i.ds_dir_img_server
			  into STRICT w_ds_retorno
			  from tasy_padrao_imagem_html i
			 where i.nr_sequencia = nr_seq_imagem;
		 exception when no_data_found then
			w_ds_retorno := null;
		end;
	end if;
	
	if (w_ds_retorno IS NOT NULL AND w_ds_retorno::text <> '') then
		
		w_barra := substr(w_ds_retorno,0,1);
		
		if (w_barra = '/') then
			w_ds_retorno:= 'assets' || w_ds_retorno;
		else
			w_ds_retorno:= 'assets/' || w_ds_retorno;
		end if;
	end if;
return w_ds_retorno;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION get_icon_path (nr_seq_conceito bigint, nr_seq_imagem bigint) FROM PUBLIC;

