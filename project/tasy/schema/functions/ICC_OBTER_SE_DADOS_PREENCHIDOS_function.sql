-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION icc_obter_se_dados_preenchidos (cd_pessoa_fisica_p bigint) RETURNS varchar AS $body$
DECLARE

/* Retorna 'S' caso CPF, ENDERECO, TELEFONE E IDENTIDADE do responsavel tenha sido preenchido 
	e 'N' caso algum nÃ£o tenha. 
*/
	 
	 
	 
	nr_cpf_w bigint;
	ds_endereco_w varchar(500);
	nr_telefone_w varchar(200);
	nr_identidade_w varchar(200);
	
	ds_retorno_w varchar(500);


BEGIN 
 
	select substr(obter_compl_pf(cd_pessoa_fisica_p,3,'C'),1,120),		--CPF 
			substr(obter_compl_pf(cd_pessoa_fisica_p,3,'EC'),1,120), 	--ENDERECO 
			substr(obter_compl_pf(cd_pessoa_fisica_p,3,'T'),1,120), 	--TELEFONE 
			substr(obter_compl_pf(cd_pessoa_fisica_p,3,'I'),1,120) 	--IDENTIDADE 
	into STRICT	nr_cpf_w, 
			ds_endereco_w, 
			nr_telefone_w, 
			nr_identidade_w 
	;
 
	begin 
	if 			((length(nr_cpf_w)>0) AND (length(ds_endereco_w)>0) AND (length(nr_telefone_w)>0) 
				AND (length(nr_identidade_w)>0)) then 
			 
		ds_retorno_w := 'S';
		else 
		ds_retorno_w := 'N';
	 
	end if;
	end;
	 
return	ds_retorno_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION icc_obter_se_dados_preenchidos (cd_pessoa_fisica_p bigint) FROM PUBLIC;

