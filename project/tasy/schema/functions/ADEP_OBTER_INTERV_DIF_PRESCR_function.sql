-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION adep_obter_interv_dif_prescr ( nr_sequencia_p bigint) RETURNS varchar AS $body$
DECLARE


	ds_retorno_w	varchar(200);
	nr_sequencia_w	prescr_material.nr_sequencia%type;
	ie_domingo_w	varchar(1):='N';
	ie_segunda_w	varchar(1):='N';
	ie_terca_w		varchar(1):='N';
	ie_quarta_w		varchar(1):='N';
	ie_quinta_w		varchar(1):='N';
	ie_sexta_w		varchar(1):='N';
	ie_sabado_w		varchar(1):='N';


BEGIN

	select	coalesce(max(nr_sequencia_w),0),
			coalesce(max(ie_domingo),'N'),
			coalesce(max(ie_segunda),'N'),
			coalesce(max(ie_terca),'N'),
			coalesce(max(ie_quarta),'N'),
			coalesce(max(ie_quinta),'N'),
			coalesce(max(ie_sexta),'N'),
			coalesce(max(ie_sabado),'N')
	into STRICT	nr_sequencia_w,
			ie_domingo_w,
			ie_segunda_w,
			ie_terca_w,
			ie_quarta_w,
			ie_quinta_w,
			ie_sexta_w,
			ie_sabado_w
	from	cpoe_material x
	where	nr_sequencia = nr_sequencia_p;

	if (ie_domingo_w = 'S') then
		-- Domingo
		ds_retorno_w := ds_retorno_w || obter_desc_expressao(288200) || ' ,';
	end if;
	if (ie_segunda_w = 'S') then
		-- Segunda-feira
		ds_retorno_w := ds_retorno_w || obter_desc_expressao(298106) || ' ,';
	end if;
	if (ie_terca_w = 'S') then
		-- Terca-feira
		ds_retorno_w := ds_retorno_w || obter_desc_expressao(299302) || ' ,';
	end if;
	if (ie_quarta_w = 'S') then
		-- Quarta-feira
		ds_retorno_w := ds_retorno_w || obter_desc_expressao(297139) || ' ,';
	end if;
	if (ie_quinta_w = 'S') then
		-- Quinta-feira
		ds_retorno_w := ds_retorno_w || obter_desc_expressao(297214) || ' ,';
	end if;
	if (ie_sexta_w = 'S') then
		-- Sexta-feira
		ds_retorno_w := ds_retorno_w || obter_desc_expressao(298488) || ' ,';
	end if;
	if (ie_sabado_w = 'S') then
		-- Sabado
		ds_retorno_w := ds_retorno_w || obter_desc_expressao(297960) || ' ,';
	end if;

	if (length(ds_retorno_w) > 1) then
		ds_retorno_w := substr(ds_retorno_w,1,length(ds_retorno_w)-2);
		-- Dias: #@ITEM#@
		ds_retorno_w := substr(wheb_mensagem_pck.get_texto(112869, 'ITEM=' || ds_retorno_w ),1,200);
	end if;

	return ds_retorno_w;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION adep_obter_interv_dif_prescr ( nr_sequencia_p bigint) FROM PUBLIC;

