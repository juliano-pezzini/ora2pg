-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION verificar_vdd_falso_eup_md ( ie_exclusao_p text, dt_entrega_w timestamp, dt_entrada_w timestamp, qt_dia_entrega_entrada_w bigint, qt_min_entrega_p bigint, ds_hora_fixa_p text, ie_data_resultado_p text, ie_atualizar_dt_prescr_p text, ie_gerar_dt_resultado_w text, ie_pendente_amostra_p text, dt_coleta_p timestamp, qt_dia_entrega_coleta_w bigint, tp_retorno_p bigint ) RETURNS varchar AS $body$
BEGIN
    IF ( tp_retorno_p = 1 ) THEN
    IF
        ( (
            (  ie_exclusao_p = 'N' )
            AND ( dt_entrega_w < ( dt_entrada_w + coalesce(qt_dia_entrega_entrada_w, 0) + coalesce(( qt_min_entrega_p / 1440 ),0) + ( coalesce(ds_hora_fixa_p,
            0) / 24 ) ) )
        ) OR ( ie_exclusao_p = 'S' ) )
        AND ( ie_data_resultado_p = 'P' )
        AND ( coalesce(ie_atualizar_dt_prescr_p, 'S') = 'S' )
        AND ( ( ie_gerar_dt_resultado_w = 'S' ) OR ( ie_gerar_dt_resultado_w = 'N'  AND  ie_pendente_amostra_p = 'N' ) )
    THEN
      RETURN 'S';
    ELSE
      RETURN 'N';
    END IF;
    END IF;

    IF ( tp_retorno_p = 2 ) THEN
    IF
        ( (
            ( ie_exclusao_p = 'N' )
            AND ( dt_entrega_w < ( dt_coleta_p + coalesce(qt_dia_entrega_coleta_w, 0) + coalesce(( qt_min_entrega_p / 1440 ),0) + ( coalesce(ds_hora_fixa_p,
            0) / 24 ) ) )
        ) OR ( ie_exclusao_p = 'S' ) )
        AND ( ie_data_resultado_p = 'C' )
        AND (dt_coleta_p IS NOT NULL AND dt_coleta_p::text <> '')
        AND ( ( ie_gerar_dt_resultado_w = 'S' ) OR ( ie_gerar_dt_resultado_w = 'N'  AND  ie_pendente_amostra_p = 'N' ) )
    THEN
      RETURN 'S';
    ELSE
      RETURN 'N';
    END IF;
    END IF;

    IF ( tp_retorno_p = 3 ) THEN
    IF ( (
        ( dt_entrega_w < ( dt_entrada_w + coalesce(qt_dia_entrega_entrada_w, 0) +  coalesce(( qt_min_entrega_p / 1440 ),0) + ( coalesce(ds_hora_fixa_p, 0) /
        24 ) ) )
        AND ( ie_data_resultado_p = 'N' )
        AND ( coalesce(ie_atualizar_dt_prescr_p, 'S') = 'S' )
        AND ( ie_exclusao_p = 'N' )
    ) OR ( ie_exclusao_p = 'S' ) ) OR ( (
        ( dt_entrega_w < ( dt_coleta_p + coalesce(qt_dia_entrega_coleta_w, 0) +  coalesce(( qt_min_entrega_p / 1440 ),0) + ( coalesce(ds_hora_fixa_p, 0) /
        24 ) ) )
        AND ( ie_data_resultado_p = 'N' )
        AND (dt_coleta_p IS NOT NULL AND dt_coleta_p::text <> '')
        AND ( ie_exclusao_p = 'N' )
    ) OR ( ie_exclusao_p = 'S' ) ) THEN
      RETURN 'S';
    ELSE
      RETURN 'N';
    END IF;
    END IF;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION verificar_vdd_falso_eup_md ( ie_exclusao_p text, dt_entrega_w timestamp, dt_entrada_w timestamp, qt_dia_entrega_entrada_w bigint, qt_min_entrega_p bigint, ds_hora_fixa_p text, ie_data_resultado_p text, ie_atualizar_dt_prescr_p text, ie_gerar_dt_resultado_w text, ie_pendente_amostra_p text, dt_coleta_p timestamp, qt_dia_entrega_coleta_w bigint, tp_retorno_p bigint ) FROM PUBLIC;

