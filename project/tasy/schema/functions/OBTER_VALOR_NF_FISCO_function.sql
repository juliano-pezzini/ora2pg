-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_valor_nf_fisco ( nr_seq_nota_p bigint, ie_tipo_dado_p text) RETURNS bigint AS $body$
DECLARE


vl_retorno_w  	double precision	 	:= '';

nr_nota_fiscal_w 	numeric(20)  	:= 0;
cd_serie_nf_w  	varchar(5) 		:= '';
nr_seq_nf_w  		smallint 		:= 0;
cd_cgc_emitente_w 	varchar(14) 		:= '';
ds_razao_social_w 	varchar(200) 	:= '';
vl_nota_fiscal_w 	varchar(200) 	:= '';
vl_mercadoria_w  	varchar(200) 	:= '';
vl_descontos_w  	varchar(200) 	:= '';

		/*
		'Vl_Nota' - Vl total nota fiscal
 		'vl_mercadoria' - Vl mercadoria
 		'vl_desconto' - vl descontos
		*/
BEGIN

vl_retorno_w	:= 0;

select vl_total_nota,
 	vl_mercadoria,
 	vl_descontos
into STRICT 	vl_nota_fiscal_w,
 	vl_mercadoria_w,
 	vl_descontos_w
from 	nota_fiscal
where 	nr_sequencia = nr_seq_nota_p
and	ie_situacao = 1;

if (ie_tipo_dado_p = 'Vl_Nota') then
 	vl_retorno_w := vl_nota_fiscal_w;
end if;

if (ie_tipo_dado_p = 'vl_mercadoria') then
 	vl_retorno_w := vl_mercadoria_w;
end if;

if (ie_tipo_dado_p = 'vl_desconto') then
	vl_retorno_w := vl_descontos_w;
end if;

return	vl_retorno_w;

End;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_valor_nf_fisco ( nr_seq_nota_p bigint, ie_tipo_dado_p text) FROM PUBLIC;

