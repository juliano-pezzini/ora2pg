-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION parse_person_name (NR_SEQUENCIA_P PESSOA_FISICA.NR_SEQ_PERSON_NAME%type, option_p text DEFAULT 'FULLN') RETURNS varchar AS $body$
DECLARE

    
  ds_retorno_w varchar(60 ):= '';

  first_name   varchar(60 );

  middle_Name  varchar(60 );

  last_name    varchar(60 );


BEGIN
  if (NR_SEQUENCIA_P IS NOT NULL AND NR_SEQUENCIA_P::text <> '')then

BEGIN

  SELECT DS_GIVEN_NAME,DS_COMPONENT_NAME_1,DS_FAMILY_NAME

  INTO STRICT first_name, middle_Name, last_name

  FROM person_name

  WHERE NR_SEQUENCIA = NR_SEQUENCIA_P  LIMIT 1;

  IF (option_p = 'FN')THEN

    ds_retorno_w    := first_name;

  elsif ( option_p      = 'MN' ) then

   ds_retorno_w    := middle_Name;

   elsif ( option_p      = 'LN' ) then

   ds_retorno_w    := last_name;

  END IF;

  end;

  end if;

  RETURN ds_retorno_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION parse_person_name (NR_SEQUENCIA_P PESSOA_FISICA.NR_SEQ_PERSON_NAME%type, option_p text DEFAULT 'FULLN') FROM PUBLIC;

