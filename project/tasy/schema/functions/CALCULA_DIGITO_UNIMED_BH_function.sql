-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION calcula_digito_unimed_bh ( ie_Rotina_p text, cd_codigo_p text) RETURNS bigint AS $body$
DECLARE

cd_codigo_w    varchar(25);
Peso_String_w   varchar(100);
cd_digito_w    smallint;
i     integer;
Soma     integer;
peso     integer;
Tamanho     integer;
valor          integer;
var1aih    integer;
var2aih    integer;
var3aih    integer;
var4aih    integer;

BEGIN
   cd_digito_w   := 0;
   Soma         := 0;
   if (ie_rotina_p = 'Medico_Unimed') then
      begin
         Peso           := 6;
         Tamanho        := Length(cd_codigo_p);
         if (Tamanho > 0) then
            begin
               FOR i in 1..Tamanho LOOP
                  begin
                    Valor := (Substr(cd_codigo_p, i, 1))::numeric;
                    Soma  := Soma + (Valor * Peso);
                    peso := Peso - 1;
                    if (peso < 2) then
                       peso  := 6;
                    end if;
                  end;
               END LOOP;
               cd_digito_w := (Soma mod 11);
               if (cd_digito_w > 9) then
                  cd_digito_w := 0;
               end if;
            end;
         end if;
	  end;
   end if;
RETURN cd_digito_w;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION calcula_digito_unimed_bh ( ie_Rotina_p text, cd_codigo_p text) FROM PUBLIC;

