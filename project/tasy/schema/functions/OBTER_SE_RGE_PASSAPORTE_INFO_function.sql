-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_se_rge_passaporte_info ( cd_pessoa_fisica_p text) RETURNS varchar AS $body$
DECLARE


cd_nacionalidade_w			pessoa_fisica.cd_nacionalidade%type;
nr_cpf_w				pessoa_fisica.nr_cpf%type;
nr_reg_geral_estrang_w			pessoa_fisica.nr_reg_geral_estrang%type;
nr_passaporte_w				pessoa_fisica.nr_passaporte%type;
ie_brasileiro_w				nacionalidade.ie_brasileiro%type;
ie_retorno_w				varchar(1)	:= 'S';


BEGIN

select	coalesce(max(cd_nacionalidade),0),
	coalesce(max(nr_cpf),'0'),
	coalesce(max(nr_reg_geral_estrang),'0'),
	coalesce(max(nr_passaporte),'0')
into STRICT	cd_nacionalidade_w,
	nr_cpf_w,
	nr_reg_geral_estrang_w,
	nr_passaporte_w
from	pessoa_fisica
where	cd_pessoa_fisica = cd_pessoa_fisica_p;

select	coalesce(max(ie_brasileiro),'S')
into STRICT	ie_brasileiro_w
from	nacionalidade
where	cd_nacionalidade = cd_nacionalidade_w;

if (ie_brasileiro_w = 'N') and (nr_cpf_w = '0') and (nr_reg_geral_estrang_w = '0') and (nr_passaporte_w = '0') then
	ie_retorno_w	:= 'N';
end if;

return	ie_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_se_rge_passaporte_info ( cd_pessoa_fisica_p text) FROM PUBLIC;

