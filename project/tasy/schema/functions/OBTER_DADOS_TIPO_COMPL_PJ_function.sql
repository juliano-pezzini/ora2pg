-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_dados_tipo_compl_pj (cd_cgc_p text, nr_sequencia_compl_pj_p bigint, ie_tipo_complemento_p bigint, ie_opcao_p text) RETURNS varchar AS $body$
DECLARE


ds_endereco_w varchar(255);
nr_endereco_w varchar(255);
ie_virgula_w varchar(255);
ds_complemento_w varchar(255);
ds_bairro_w varchar(255);
cd_cep_w varchar(255);
ds_municipio_w varchar(255);
sg_estado_w varchar(255);


BEGIN

  SELECT
    ds_endereco,
    nr_endereco,
    ds_complemento,
    ds_bairro,
    cd_cep,
    ds_municipio,
    sg_estado
  INTO STRICT
    ds_endereco_w,
    nr_endereco_w,
    ds_complemento_w,
    ds_bairro_w,
    cd_cep_w,
    ds_municipio_w,
    sg_estado_w
  FROM
    pessoa_juridica_compl a
  WHERE
    a.cd_cgc = cd_cgc_p
    AND a.IE_TIPO_COMPLEMENTO = ie_tipo_complemento_p
    AND a.nr_sequencia = nr_sequencia_compl_pj_p;

  IF (ie_opcao_p = 'E') THEN
    IF (ds_complemento_w IS NOT NULL AND ds_complemento_w::text <> '') THEN
      ie_virgula_w  := ', ';
    END IF;
    RETURN(ds_endereco_w || ', ' || nr_endereco_w || ie_virgula_w || ds_complemento_w);
  END IF;

  IF (ie_opcao_p = 'B') THEN
    RETURN ds_bairro_w;
  END IF;

  IF (ie_opcao_p = 'CEP') THEN
    RETURN cd_cep_w;
  END IF;

  IF (ie_opcao_p = 'CI') THEN
    RETURN ds_municipio_w;
  END IF;

  IF (ie_opcao_p = 'UF') THEN
    RETURN sg_estado_w;
  END IF;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_dados_tipo_compl_pj (cd_cgc_p text, nr_sequencia_compl_pj_p bigint, ie_tipo_complemento_p bigint, ie_opcao_p text) FROM PUBLIC;

