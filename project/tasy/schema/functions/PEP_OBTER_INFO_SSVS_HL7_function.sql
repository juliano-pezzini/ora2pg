-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';



CREATE TYPE deSsVvParaHL7 AS ( de_nm_codigo             varchar(255),
                               para_nm_atributo_hl7     varchar(255),
                               para_tabela_destino      varchar(255) := 'ATENDIMENTO_SINAL_VITAL',
                               ds_observacao            varchar(255) := 'Nenhuma observação',
                               ie_SDC                   char(1)   := 'N');


CREATE OR REPLACE FUNCTION pep_obter_info_ssvs_hl7 ( ds_vl_dominio_p text, ds_info_retorno_p text) RETURNS varchar AS $body$
DECLARE

cd_indice_w     integer;
ie_contido_w    char(1) := 'N';
ds_retorno_w	varchar(255);
/*
 A   : Atributo(s) onde será(ão) aplicado(s) a(s) informação(ões) do HL7 referente ao domínio(O dominio tem tamanho menor que o atributo)
 T   : Tabela(s) de Destino do HL7 recebido
 H   : Tags da mensagem HL7 referente ao atributo a ser integrado
 F   : Busca o atributo referente aquele HL7
 O   : Observação
*/
type setDeSsVvParaHL7 is table of deSsVvParaHL7 index by integer;
deSsVvParaHL7_w  setDeSsVvParaHL7;


BEGIN
cd_indice_w := 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo             := 'QT_SEGMENTO_ST';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7     := '0002-0101,0002-0102,0002-0103,0002-0104,0002-0105,0002-0106,0002-0107,0002-0108,0002-013d,0002-013e,0002-013f,0002-0140,0002-0301,0002-0302,0002-0303,0002-0304,0002-0305,0002-0306,0002-0307,0002-0308,0002-033d,0002-033e,0002-033f,0002-0340';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo             := 'QT_FREQ_CARD_MONIT';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7     := '0002-4182,0002-4822';
deSsVvParaHL7_w[cd_indice_w].ds_observacao            := wheb_mensagem_pck.get_texto(389313); --O atributo QT_FREQ_CARDIACA também será ignorado
cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo             := 'QT_FREQ_CARDIACA';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7     := '0002-f0e5';
deSsVvParaHL7_w[cd_indice_w].ie_SDC                   := 'S';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo             := 'TX_RV_SISTEMICA';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7     := '0002-4900';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino      := 'ATEND_MONIT_HEMOD';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo             := 'TX_INDICE_CARD';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7     := '0002-490c';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino      := 'ATEND_MONIT_HEMOD';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo             := 'QT_PA_SISTOLICA ';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7     := '0002-4a05,0002-4a11,0002-4a15';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino      := 'ATEND_MONIT_HEMOD';
deSsVvParaHL7_w[cd_indice_w].ie_SDC                   := 'S';
deSsVvParaHL7_w[cd_indice_w].ds_observacao            := wheb_mensagem_pck.get_texto(389314); --O atributo IE_APARELHO_PA também será ignorado, pois o mesmo se refere ao aparelho utilizado
cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo             := 'QT_PA_DIASTOLICA';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7     := '0002-4a06,0002-4a12,0002-4a16';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino      := 'ATEND_MONIT_HEMOD';
deSsVvParaHL7_w[cd_indice_w].ie_SDC                   := 'S';
deSsVvParaHL7_w[cd_indice_w].ds_observacao            := wheb_mensagem_pck.get_texto(389314); --O atributo IE_APARELHO_PA também será ignorado, pois o mesmo se refere ao aparelho utilizado
cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo             := 'QT_PAM';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7     := '0002-4a07,0002-4a13,0002-4a17';
deSsVvParaHL7_w[cd_indice_w].ie_SDC                   := 'S';
deSsVvParaHL7_w[cd_indice_w].ds_observacao            := wheb_mensagem_pck.get_texto(389314); --O atributo IE_APARELHO_PA também será ignorado, pois o mesmo se refere ao aparelho utilizado
cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo             := 'QT_PA_SIST_AP';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7     := '0002-4a1d';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino      := 'ATEND_MONIT_HEMOD';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_PA_DIAST_AP';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-4a1e';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATEND_MONIT_HEMOD';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_PA_MEDIA_AP';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-4a1f';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATEND_MONIT_HEMOD';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_PAE';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-4a33';
deSsVvParaHL7_w[cd_indice_w].ie_SDC                  := 'S';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_PVC';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-4a47';
deSsVvParaHL7_w[cd_indice_w].ie_SDC                  := 'S';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_DEBITO_CARD';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-4b04';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATEND_MONIT_HEMOD';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_RV_SISTEMICA';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-4b28';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATEND_MONIT_HEMOD';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_SATUR_VEN_MISTA_OXIGENIO';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-4b3c';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATEND_MONIT_HEMOD';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_TE';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-f8a1';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_TEMP';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-4b64,0002-4b6c,0002-4b74,0002-4b78,0002-4b7c,0002-f0c7,0002-e004,0002-f110,0002-e014';
deSsVvParaHL7_w[cd_indice_w].ds_observacao           := wheb_mensagem_pck.get_texto(389315); --O atributo IE_SITIO também será ignorado
deSsVvParaHL7_w[cd_indice_w].ie_SDC                  := 'S';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_VOLUME_SIST';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-4b84';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATEND_MONIT_HEMOD';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_SATURACAO_O2';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-4bb8';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP e ATENDIMENTO_SINAL_VITAL';
deSsVvParaHL7_w[cd_indice_w].ie_SDC                  := 'S';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_FREQ_RESP';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-5000,0002-500a';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP e ATENDIMENTO_SINAL_VITAL';
deSsVvParaHL7_w[cd_indice_w].ie_SDC                  := 'S';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_FREQ_VENT';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-5012';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_CO2';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-50b0';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_FLUXO_INSP';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-50dd';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_PPLATO';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-50e8';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_AUTO_PEEP';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-5100';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_PIP';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-5109';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_PVA';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-510b';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_VCI';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-513c';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_PEEP';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-51a8';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_OXIDO_NITROSO_EXP';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-522c,0002-5378';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_OXIDO_NITROSO_INSP';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-5280,0002-5284';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_HALOG_EXP';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-538c';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_HALOG_INS';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-5390';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_PPC';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-5804';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_FIO2';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-7498';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_MAEC';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-f04e';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_PRESSAO_INTRA_CRANIO';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-f0b7';
deSsVvParaHL7_w[cd_indice_w].ie_SDC                  := 'S';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_DELTA_PP';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-f0e3';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATEND_MONIT_HEMOD';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_SAT_VENOSA_O2';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-f100';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_TOF_BLOQ_NEURO_MUSC';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-f897';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_RSR';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-f899';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_TI';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-f8a3';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_VMIN';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-5148';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_CDYN';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-508c';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_CST';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-5090';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_CAM';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-f05d';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'QT_CONT_ART_VEN_OXIG';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0002-4b40';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATEND_MONIT_HEMOD';

cd_indice_w := cd_indice_w + 1;
deSsVvParaHL7_w[cd_indice_w].de_nm_codigo            := 'CD_MOD_VENT';
deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7    := '0402-f8f5';
deSsVvParaHL7_w[cd_indice_w].para_tabela_destino     := 'ATENDIMENTO_MONIT_RESP';
deSsVvParaHL7_w[cd_indice_w].ds_observacao           := wheb_mensagem_pck.get_texto(389316); --A informação é buscada de acordo com o atributo CD_MOBILIDADE da tabela MOBILIDADE_VENTILATORIA
for cd_indice_w in 1..deSsVvParaHL7_w.count loop
begin

    if (ie_contido_w <> 'S') then

        if (ds_info_retorno_p <> 'F') then
            select  coalesce(max('S'), 'N')
            into STRICT    ie_contido_w

            where   deSsVvParaHL7_w[cd_indice_w].de_nm_codigo like '%'|| ds_vl_dominio_p || '%';
        else
            select  coalesce(max('S'), 'N')
            into STRICT    ie_contido_w

            where   deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7 like '%'|| ds_vl_dominio_p || '%';
        end if;

        if ie_contido_w = 'S' then

            if (ds_info_retorno_p = 'H') then
                ds_retorno_w := deSsVvParaHL7_w[cd_indice_w].para_nm_atributo_hl7;
            elsif (ds_info_retorno_p = 'A' or ds_info_retorno_p = 'F') then
                ds_retorno_w := deSsVvParaHL7_w[cd_indice_w].de_nm_codigo;
            elsif (ds_info_retorno_p = 'O') then
                ds_retorno_w := deSsVvParaHL7_w[cd_indice_w].ds_observacao;
            elsif (ds_info_retorno_p = 'T') then
                ds_retorno_w := deSsVvParaHL7_w[cd_indice_w].para_tabela_destino;
            end if;

        end if;

    end if;
end;
end loop;

return ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pep_obter_info_ssvs_hl7 ( ds_vl_dominio_p text, ds_info_retorno_p text) FROM PUBLIC;

