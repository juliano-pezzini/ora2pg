-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION pls_obter_dados_retorno_sib ( nr_seq_retorno_sib_p bigint, ie_opcao_p text) RETURNS varchar AS $body$
DECLARE

/* ie_opcao_p
	'N' = Nome segurado
	'C' = Carteira
	'R' = Data de rescisão
	'DN' = Data de nascimento
	'M' = Nome da mãe
	'RG' = Identidade (RG)
	'CPF' = CPF
	'S' = Sexo
	'L' = Logradouro
	'NR' = Número
	'CL' = Complemento
	'B' = Bairro
	'CI' = Cidade
	'UF' = Estado
	'CEP' = CEP
*/
ds_retorno_w            varchar(255);
nm_beneficiario_w       varchar(255);
cd_usuario_plano_w      varchar(30);
dt_rescisao_contrato_w  timestamp;
dt_nascimento_w         timestamp;
nm_mae_w                varchar(255);
nr_identidade_w         varchar(30);
nr_cpf_w                varchar(11);
ds_sexo_w		varchar(20);
ds_logradouro_w		varchar(255);
nr_endereco_w		varchar(5);
ds_complemento_w	varchar(255);
ds_bairro_w		varchar(30);
ds_cidade_w		varchar(30);
sg_uf_w			varchar(2);
cd_cep_w		varchar(8);


BEGIN

select	nm_beneficiario,
	cd_usuario_plano,
	dt_rescisao_contrato,
	dt_nascimento,
	nm_mae,
	nr_identidade,
	nr_cpf,
	CASE WHEN ie_sexo='1' THEN 'Masculino' WHEN ie_sexo='3' THEN 'Feminino'  ELSE ' ' END ,
	ds_logradouro,
	nr_endereco,
	ds_complemento,
	ds_bairro,
	ds_cidade,
	sg_uf,
	cd_cep
into STRICT	nm_beneficiario_w,
	cd_usuario_plano_w,
	dt_rescisao_contrato_w,
	dt_nascimento_w,
	nm_mae_w,
	nr_identidade_w,
	nr_cpf_w,
	ds_sexo_w,
	ds_logradouro_w,
	nr_endereco_w,
	ds_complemento_w,
	ds_bairro_w,
	ds_cidade_w,
	sg_uf_w,
	cd_cep_w
from	pls_retorno_sib
where	nr_sequencia	= nr_seq_retorno_sib_p;

if (ie_opcao_p  = 'N') then
	ds_retorno_w    := nm_beneficiario_w;
elsif (ie_opcao_p       = 'C') then
	ds_retorno_w    := cd_usuario_plano_w;
elsif (ie_opcao_p       = 'R') then
	ds_retorno_w    := to_char(dt_rescisao_contrato_w,'dd/mm/yyyy');
elsif (ie_opcao_p       = 'DN') then
	ds_retorno_w    := to_char(dt_nascimento_w,'dd/mm/yyyy');
elsif (ie_opcao_p       = 'M') then
	ds_retorno_w    := nm_mae_w;
elsif (ie_opcao_p       = 'RG') then
	ds_retorno_w    := nr_identidade_w;
elsif (ie_opcao_p       = 'CPF') then
	ds_retorno_w    := nr_cpf_w;
elsif (ie_opcao_p       = 'S') then
	ds_retorno_w    := ds_sexo_w;
elsif (ie_opcao_p       = 'NR') then
	ds_retorno_w    := nr_endereco_w;
elsif (ie_opcao_p       = 'CL') then
	ds_retorno_w    := ds_complemento_w;
elsif (ie_opcao_p       = 'B') then
	ds_retorno_w    := ds_bairro_w;
elsif (ie_opcao_p       = 'CI') then
	ds_retorno_w    := ds_cidade_w;
elsif (ie_opcao_p       = 'UF') then
	ds_retorno_w    := sg_uf_w;
elsif (ie_opcao_p       = 'CEP') then
	ds_retorno_w    := cd_cep_w;
end if;

return	ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pls_obter_dados_retorno_sib ( nr_seq_retorno_sib_p bigint, ie_opcao_p text) FROM PUBLIC;

