-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_score_escala_grace_md ( qt_idade_p bigint, ie_killip_p text, qt_pa_sistolica_p bigint, qt_freq_cardiaca_p bigint, qt_creatinina_p bigint, ie_marcador_cardiaco_ele_p text, ie_parada_cardiaca_adm_p text, ie_desvio_seg_st_p text ) RETURNS bigint AS $body$
DECLARE

  qt_pontuacao_w smallint;

BEGIN
  qt_pontuacao_w := 0;
  if (qt_idade_p <30) then
    qt_pontuacao_w :=qt_pontuacao_w +  0;
  elsif (qt_idade_p >= 30) and (qt_idade_p < 40) then
    qt_pontuacao_w :=qt_pontuacao_w +  8;
  elsif (qt_idade_p >=40) and (qt_idade_p < 50) then
    qt_pontuacao_w :=qt_pontuacao_w +  25;
  elsif (qt_idade_p >= 50) and (qt_idade_p < 60) then
    qt_pontuacao_w :=qt_pontuacao_w +  41;
  elsif (qt_idade_p >= 60) and (qt_idade_p < 70) then
    qt_pontuacao_w :=qt_pontuacao_w +  58;
  elsif (qt_idade_p >= 70) and (qt_idade_p < 80) then
    qt_pontuacao_w :=qt_pontuacao_w +  75;
  elsif (qt_idade_p >= 80) and (qt_idade_p < 90) then
    qt_pontuacao_w :=qt_pontuacao_w +  91;
  elsif (qt_idade_p >= 90) then
    qt_pontuacao_w :=qt_pontuacao_w +  100;
  end if;

  if (ie_killip_p = 'I') then
    qt_pontuacao_w := qt_pontuacao_w + 0;
  elsif (ie_killip_p = 'II') then
    qt_pontuacao_w := qt_pontuacao_w + 20;
  elsif (ie_killip_p = 'III') then
    qt_pontuacao_w := qt_pontuacao_w + 39;
  elsif (ie_killip_p = 'IV') then
    qt_pontuacao_w := qt_pontuacao_w + 59;
  end if;

  if (qt_pa_sistolica_p <= 80) then
    qt_pontuacao_w := qt_pontuacao_w + 58;
  elsif (qt_pa_sistolica_p >= 80) and (qt_pa_sistolica_p <= 99)then
    qt_pontuacao_w := qt_pontuacao_w + 53;
  elsif (qt_pa_sistolica_p >= 100) and (qt_pa_sistolica_p <= 119)then
    qt_pontuacao_w := qt_pontuacao_w + 43;
  elsif (qt_pa_sistolica_p >= 120) and (qt_pa_sistolica_p <= 139)then
    qt_pontuacao_w := qt_pontuacao_w + 34;
  elsif (qt_pa_sistolica_p >= 140) and (qt_pa_sistolica_p <= 159)then
    qt_pontuacao_w := qt_pontuacao_w + 24;
  elsif (qt_pa_sistolica_p >= 160) and (qt_pa_sistolica_p <= 199)then
    qt_pontuacao_w := qt_pontuacao_w + 10;
  end if;

  if (qt_freq_cardiaca_p <= 50) then
    qt_pontuacao_w := qt_pontuacao_w + 0;
  elsif (qt_freq_cardiaca_p >= 50) and (qt_freq_cardiaca_p <= 69) then
    qt_pontuacao_w := qt_pontuacao_w + 3;
  elsif (qt_freq_cardiaca_p >= 70) and (qt_freq_cardiaca_p <= 89) then
    qt_pontuacao_w := qt_pontuacao_w + 9;
  elsif (qt_freq_cardiaca_p >= 90) and (qt_freq_cardiaca_p <= 109) then
    qt_pontuacao_w := qt_pontuacao_w + 15;
  elsif (qt_freq_cardiaca_p >= 110) and (qt_freq_cardiaca_p <= 149) then
    qt_pontuacao_w := qt_pontuacao_w + 24;
  elsif (qt_freq_cardiaca_p >= 150) and (qt_freq_cardiaca_p <= 199) then
    qt_pontuacao_w := qt_pontuacao_w + 38;
  elsif (qt_freq_cardiaca_p >= 200)  then
    qt_pontuacao_w := qt_pontuacao_w + 46;
  end if;

  if (qt_creatinina_p >= 0) and (qt_creatinina_p <= 0.39) then
    qt_pontuacao_w := qt_pontuacao_w + 1;
  elsif (qt_creatinina_p >= 0.40) and (qt_creatinina_p <= 0.79) then
    qt_pontuacao_w := qt_pontuacao_w + 4;
  elsif (qt_creatinina_p >= 0.80) and (qt_creatinina_p <= 1.19) then
    qt_pontuacao_w := qt_pontuacao_w + 7;
  elsif (qt_creatinina_p >= 1.20) and (qt_creatinina_p <= 1.59) then
    qt_pontuacao_w := qt_pontuacao_w + 10;
  elsif (qt_creatinina_p >= 1.60) and (qt_creatinina_p <= 1.99) then
    qt_pontuacao_w := qt_pontuacao_w + 13;
  elsif (qt_creatinina_p >= 2.00) and (qt_creatinina_p <= 3.99) then
    qt_pontuacao_w := qt_pontuacao_w + 21;
  elsif (qt_creatinina_p >= 4) then
    qt_pontuacao_w := qt_pontuacao_w + 28;
  end if;

  if (ie_marcador_cardiaco_ele_p = 'S') then
    qt_pontuacao_w := qt_pontuacao_w + 14;
  end if;

  if (ie_parada_cardiaca_adm_p = 'S') then
    qt_pontuacao_w := qt_pontuacao_w + 39;
  end if;

  if (ie_desvio_seg_st_p = 'S') then
    qt_pontuacao_w := qt_pontuacao_w + 28;
  end if;

  return qt_pontuacao_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_score_escala_grace_md ( qt_idade_p bigint, ie_killip_p text, qt_pa_sistolica_p bigint, qt_freq_cardiaca_p bigint, qt_creatinina_p bigint, ie_marcador_cardiaco_ele_p text, ie_parada_cardiaca_adm_p text, ie_desvio_seg_st_p text ) FROM PUBLIC;

