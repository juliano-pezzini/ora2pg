-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION get_type_chart_surgery_2 ( nr_seq_anest_ocor_p bigint, qt_dose_p bigint, qt_dose_ataque_p bigint, qt_halog_ins_p bigint, qt_velocidade_inf_p bigint, ie_aplic_bolus_p text, ie_tipo_dosagem_p text, cd_unid_medida_adm_p text, ie_modo_registro_p text, ie_modo_adm_p text, ie_opcao_p text) RETURNS varchar AS $body$
DECLARE

							
ds_retorno_w			varchar(2000);


BEGIN

if (coalesce(nr_seq_anest_ocor_p,0) > 0) then
	if (ie_modo_adm_p = 'IN') then
		if (coalesce(qt_dose_p,0) > 0) then
			ds_retorno_w	:= substr(obter_desc_unid_med(cd_unid_medida_adm_p),1,255);
		end if;	
	elsif (ie_modo_adm_p = 'CO') then
		if (coalesce(qt_dose_ataque_p,0) > 0) then
			ds_retorno_w	:= substr(obter_desc_expressao(288245,null),1,255); -- Dose isolada (ml)
		elsif (ie_modo_registro_p = 'R') then
			ds_retorno_w	:= substr(obter_desc_expressao(488741,null),1,255); --Mililitro
		elsif (ie_modo_registro_p = 'T') then	
			ds_retorno_w	:= substr(obter_desc_expressao(488741,null),1,255);
		elsif (ie_modo_registro_p = 'V') then
			ds_retorno_w	:= substr(obter_valor_dominio(1580,ie_tipo_dosagem_p),1,255);
    elsif (ie_modo_registro_p = 'M') then
			ds_retorno_w	:= '%';
		end if;
	end if;	
else
	if (ie_modo_adm_p = 'CO') then
		ds_retorno_w	:= substr(obter_valor_dominio(1580,ie_tipo_dosagem_p),1,255);
	else
		ds_retorno_w	:= substr(obter_desc_unid_med(cd_unid_medida_adm_p),1,255);
	end if;	
end if;

if (ie_opcao_p = 'style') then
	if (ie_modo_adm_p = 'IN' OR ie_modo_adm_p = 'AC') then
		ds_retorno_w := 'line';
	elsif (coalesce(qt_dose_ataque_p,0) > 0) then
		ds_retorno_w := 'points';
	elsif (ie_modo_adm_p = 'CO') then
		ds_retorno_w := 'line';
	end if;
end if;

if (ie_opcao_p = 'qt_size') then
	ds_retorno_w := '0';
	if (ie_modo_adm_p = 'IN' OR ie_modo_adm_p = 'AC') then
		ds_retorno_w := '3';
	elsif (coalesce(qt_dose_ataque_p,0) > 0) then
		ds_retorno_w := '10';
	elsif (ie_modo_adm_p = 'CO')	then
		ds_retorno_w := '3';
	end if;
end if;

	

return ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION get_type_chart_surgery_2 ( nr_seq_anest_ocor_p bigint, qt_dose_p bigint, qt_dose_ataque_p bigint, qt_halog_ins_p bigint, qt_velocidade_inf_p bigint, ie_aplic_bolus_p text, ie_tipo_dosagem_p text, cd_unid_medida_adm_p text, ie_modo_registro_p text, ie_modo_adm_p text, ie_opcao_p text) FROM PUBLIC;

