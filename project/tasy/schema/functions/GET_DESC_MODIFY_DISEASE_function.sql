-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION get_desc_modify_disease ( cd_doenca_cid_p text, ie_side_modifier_p text, nr_seq_jap_pref_1_p bigint, nr_seq_jap_pref_2_p bigint, nr_seq_jap_pref_3_p bigint, nr_seq_jap_sufi_1_p bigint, nr_seq_jap_sufi_2_p bigint, nr_seq_jap_sufi_3_p bigint) RETURNS varchar AS $body$
DECLARE

  description_modify_disease_w varchar(255);
  description_side_modifier_w  varchar(255);
  description_pref_1_w         varchar(255);
  description_pref_2_w         varchar(255);
  description_pref_3_w         varchar(255);
  description_disease_w        varchar(255);
  description_sufi_1_w         varchar(255);
  description_sufi_2_w         varchar(255);
  description_sufi_3_w         varchar(255);

BEGIN
    IF (ie_side_modifier_p IS NOT NULL AND ie_side_modifier_p::text <> '') THEN
      description_side_modifier_w := Obter_valor_dominio_idioma(10074,
                                     ie_side_modifier_p,
                                     wheb_usuario_pck.get_nr_seq_idioma);

      description_modify_disease_w := coalesce(description_modify_disease_w, '')
                                      || coalesce(description_side_modifier_w, '');
    END IF;

    IF (nr_seq_jap_pref_1_p IS NOT NULL AND nr_seq_jap_pref_1_p::text <> '') THEN
      SELECT trim(both ds_modifier_notation)
      INTO STRICT   description_pref_1_w
      FROM   icd_code_modifier_jpn
      WHERE  nr_modifier_mgmt_num = nr_seq_jap_pref_1_p;

      description_modify_disease_w := coalesce(description_modify_disease_w, '')
                                      || coalesce(description_pref_1_w, '');
    END IF;

    IF (nr_seq_jap_pref_2_p IS NOT NULL AND nr_seq_jap_pref_2_p::text <> '') THEN
      SELECT trim(both ds_modifier_notation)
      INTO STRICT   description_pref_2_w
      FROM   icd_code_modifier_jpn
      WHERE  nr_modifier_mgmt_num = nr_seq_jap_pref_2_p;

      description_modify_disease_w := coalesce(description_modify_disease_w, '')
                                      || coalesce(description_pref_2_w, '');
    END IF;

    IF (nr_seq_jap_pref_3_p IS NOT NULL AND nr_seq_jap_pref_3_p::text <> '') THEN
      SELECT trim(both ds_modifier_notation)
      INTO STRICT   description_pref_3_w
      FROM   icd_code_modifier_jpn
      WHERE  nr_modifier_mgmt_num = nr_seq_jap_pref_3_p;

      description_modify_disease_w := coalesce(description_modify_disease_w, '')
                                      || coalesce(description_pref_3_w, '');
    END IF;

    IF (cd_doenca_cid_p IS NOT NULL AND cd_doenca_cid_p::text <> '') THEN
      SELECT trim(both ds_doenca_cid)
      INTO STRICT   description_disease_w
      FROM   cid_doenca
      WHERE  cd_doenca_cid = cd_doenca_cid_p;

      description_modify_disease_w := coalesce(description_modify_disease_w, '')
                                      || coalesce(description_disease_w, '');
    END IF;

    IF (nr_seq_jap_sufi_1_p IS NOT NULL AND nr_seq_jap_sufi_1_p::text <> '') THEN
      SELECT trim(both ds_modifier_notation)
      INTO STRICT   description_sufi_1_w
      FROM   icd_code_modifier_jpn
      WHERE  nr_modifier_mgmt_num = nr_seq_jap_sufi_1_p;

      description_modify_disease_w := coalesce(description_modify_disease_w, '')
                                      || coalesce(description_sufi_1_w, '');
    END IF;

    IF (nr_seq_jap_sufi_2_p IS NOT NULL AND nr_seq_jap_sufi_2_p::text <> '') THEN
      SELECT trim(both ds_modifier_notation)
      INTO STRICT   description_sufi_2_w
      FROM   icd_code_modifier_jpn
      WHERE  nr_modifier_mgmt_num = nr_seq_jap_sufi_2_p;

      description_modify_disease_w := coalesce(description_modify_disease_w, '')
                                      || coalesce(description_sufi_2_w, '');
    END IF;

    IF (nr_seq_jap_sufi_3_p IS NOT NULL AND nr_seq_jap_sufi_3_p::text <> '') THEN
      SELECT trim(both ds_modifier_notation)
      INTO STRICT   description_sufi_3_w
      FROM   icd_code_modifier_jpn
      WHERE  nr_modifier_mgmt_num = nr_seq_jap_sufi_3_p;

      description_modify_disease_w := coalesce(description_modify_disease_w, '')
                                      || coalesce(description_sufi_3_w, '');
    END IF;

    RETURN coalesce(description_modify_disease_w, '');
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION get_desc_modify_disease ( cd_doenca_cid_p text, ie_side_modifier_p text, nr_seq_jap_pref_1_p bigint, nr_seq_jap_pref_2_p bigint, nr_seq_jap_pref_3_p bigint, nr_seq_jap_sufi_1_p bigint, nr_seq_jap_sufi_2_p bigint, nr_seq_jap_sufi_3_p bigint) FROM PUBLIC;

