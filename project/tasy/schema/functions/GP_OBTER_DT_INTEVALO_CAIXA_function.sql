-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION gp_obter_dt_intevalo_caixa (NR_SEQ_CAIXA_P bigint, IE_OPCAO_P text) RETURNS varchar AS $body$
DECLARE

				 
ds_retorno_w	varchar(100);
dt_min_data_w	timestamp;
dt_max_data_w	timestamp;


BEGIN 
 
if (NR_SEQ_CAIXA_P IS NOT NULL AND NR_SEQ_CAIXA_P::text <> '') then 
 
	select 	min(obter_data_entrada(nr_atendimento)) min_data, 
			max(obter_data_entrada(nr_atendimento)) max_data 
	into STRICT  dt_min_data_w, 
			dt_max_data_w	 
	from  SAME_PRONTUARIO a 
	where  1 = 1 
	and  a.NR_SEQ_CAIXA = NR_SEQ_CAIXA_P;
 
	if (IE_OPCAO_P = 'MN') then 
		ds_retorno_w := to_char(dt_min_data_w,'dd/mm/yyyy hh24:mi:ss');
	else 
		ds_retorno_w := to_char(dt_max_data_w,'dd/mm/yyyy hh24:mi:ss');
	end if;	
	 
end if;
 
return	ds_retorno_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION gp_obter_dt_intevalo_caixa (NR_SEQ_CAIXA_P bigint, IE_OPCAO_P text) FROM PUBLIC;

