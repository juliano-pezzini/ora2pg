-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION man_obter_local_os_wrel452 ( nr_seq_localizacao_p bigint) RETURNS varchar AS $body$
DECLARE


IeAndarBlocoLocal_w	varchar(2);
retorno_w		varchar(250);


BEGIN
IeAndarBlocoLocal_w := obter_param_usuario(299, 374, obter_perfil_ativo, wheb_usuario_pck.get_nm_usuario, wheb_usuario_pck.get_cd_estabelecimento, IeAndarBlocoLocal_w);

if (IeAndarBlocoLocal_w = 'S')	then
	select	substr(   CASE WHEN   substr(ds_localizacao,1,50)=' ' THEN  ''   ELSE substr(ds_localizacao||' / ',1,50) END  ||
		CASE WHEN   substr(coalesce(obter_desc_bloco(nr_seq_bloco),'X'),1,50)='X' THEN ''  ELSE substr(obter_desc_bloco(nr_seq_bloco)||' / ',1,50) END  ||
		CASE WHEN   substr(coalesce(obter_desc_andar(nr_seq_andar),'X'),1,50)='X' THEN ''  ELSE substr(obter_desc_andar(nr_seq_andar)||' / ',1,50) END  ||
		substr(obter_nome_setor(cd_setor),1,50),1,250) ds
	into STRICT	retorno_w
	from	man_localizacao
	where	nr_sequencia = nr_seq_localizacao_p;
else
	select	substr(	CASE WHEN coalesce(cd_localizacao::text, '') = '' THEN null  ELSE cd_localizacao||' - ' END  || ds_localizacao || ' / ' || substr(obter_nome_setor(cd_setor),1,50),1,250) ds_localizacao
	into STRICT	retorno_w
	from	man_localizacao
	where	nr_sequencia = nr_seq_localizacao_p;
end if;

return	retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION man_obter_local_os_wrel452 ( nr_seq_localizacao_p bigint) FROM PUBLIC;

