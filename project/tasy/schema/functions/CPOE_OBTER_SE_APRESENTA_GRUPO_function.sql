-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION cpoe_obter_se_apresenta_grupo ( cd_perfil_p bigint, ie_opcao_p text) RETURNS varchar AS $body$
DECLARE


ie_retorno_w						cpoe_presentation_rule.ie_oral_diet%type;

c01 CURSOR FOR
SELECT	coalesce(ie_oral_diet,'S') ie_oral_diet_w,
		coalesce(ie_enteral_diet,'S') ie_enteral_diet_w,
		coalesce(ie_supplement,'S') ie_supplement_w,
		coalesce(ie_fasting,'S') ie_fasting_w,
		coalesce(ie_milk,'S') ie_milk_w,
		coalesce(ie_medicine,'S') ie_medicine_w,
		coalesce(ie_exam,'S') ie_exam_w,
		coalesce(ie_gas,'S') ie_gas_w,
		coalesce(ie_recomendation,'S') ie_recomendation_w,
		coalesce(ie_hemotherapy,'S') ie_hemotherapy_w,
		coalesce(ie_dialysis,'S') ie_dialysis_w,
		coalesce(ie_intervention,'S') ie_intervention_w,
		coalesce(ie_material,'S') ie_material_w,
		coalesce(ie_parenteral,'S') ie_parenteral_w,
		coalesce(ie_infant_parenteral,'S') ie_infant_parenteral_w,
		coalesce(ie_anatomia_pat,'S') ie_anatomia_pat_w
from 	cpoe_presentation_rule
where 	coalesce(cd_perfil, coalesce(cd_perfil_p,0)) = coalesce(cd_perfil_p,0)
and	coalesce(cd_estabelecimento, coalesce(wheb_usuario_pck.get_cd_estabelecimento,0)) = coalesce(wheb_usuario_pck.get_cd_estabelecimento,0)
order by cd_perfil desc, cd_estabelecimento desc;

BEGIN

for c01_w in C01
loop
	if (ie_opcao_p = 'O') then
		ie_retorno_w := c01_w.ie_oral_diet_w;
	elsif (ie_opcao_p = 'E') then
		ie_retorno_w := c01_w.ie_enteral_diet_w;
	elsif (ie_opcao_p = 'S') then
		ie_retorno_w := c01_w.ie_supplement_w;
	elsif (ie_opcao_p = 'J') then
		ie_retorno_w := c01_w.ie_fasting_w;
	elsif (ie_opcao_p = 'L') then
		ie_retorno_w := c01_w.ie_milk_w;
	elsif (ie_opcao_p = 'M') then
		ie_retorno_w := c01_w.ie_medicine_w;
	elsif (ie_opcao_p = 'P') then
		ie_retorno_w := c01_w.ie_exam_w;
	elsif (ie_opcao_p = 'G') then
		ie_retorno_w := c01_w.ie_gas_w;
	elsif (ie_opcao_p = 'R') then
		ie_retorno_w := c01_w.ie_recomendation_w;
	elsif (ie_opcao_p = 'H') then
		ie_retorno_w := c01_w.ie_hemotherapy_w;
	elsif (ie_opcao_p = 'D') then
		ie_retorno_w := c01_w.ie_dialysis_w;
	elsif (ie_opcao_p = 'I') then
		ie_retorno_w := c01_w.ie_intervention_w;
	elsif (ie_opcao_p = 'MA') then
		ie_retorno_w := c01_w.ie_material_w;
	elsif (ie_opcao_p = 'NP') then
		ie_retorno_w := c01_w.ie_parenteral_w;
	elsif (ie_opcao_p = 'NI') then
		ie_retorno_w := c01_w.ie_infant_parenteral_w;
	elsif (ie_opcao_p = 'AP') then
		ie_retorno_w := c01_w.ie_anatomia_pat_w;
	else
		ie_retorno_w := 'S';
	end if;
end loop;

return ie_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION cpoe_obter_se_apresenta_grupo ( cd_perfil_p bigint, ie_opcao_p text) FROM PUBLIC;

