-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION latam_get_user_param ( nr_sequencia_p LATAM_CONFIGURACAO.NR_SEQUENCIA%type ) RETURNS varchar AS $body$
DECLARE


nr_sequencia_w      LATAM_CONFIGURACAO.NR_SEQUENCIA%type;
vl_padrao_w         LATAM_CONFIGURACAO.VL_PADRAO%type;
vl_parametro_w      LATAM_CONFIG_PARAM.VL_PARAMETRO%type;


BEGIN

SELECT MAX(a.NR_SEQUENCIA),
       MAX(UPPER(coalesce(a.VL_PADRAO, 'S')))
INTO STRICT   nr_sequencia_w,
       vl_padrao_w
FROM   LATAM_CONFIGURACAO a
WHERE  a.nr_sequencia = nr_sequencia_p;

IF ( coalesce(nr_sequencia_w::text, '') = '' ) THEN
    RETURN 'S';
END IF;

SELECT MAX(a.VL_PARAMETRO)
INTO STRICT   vl_parametro_w
FROM   latam_config_param a
WHERE  a.nr_seq_configuracao = nr_sequencia_w
AND    a.cd_perfil           = obter_perfil_ativo
AND    (a.vl_parametro IS NOT NULL AND a.vl_parametro::text <> '')
AND    UPPER(a.vl_parametro) IN ('S', 'N');

RETURN COALESCE(vl_parametro_w, vl_padrao_w, 'S');

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION latam_get_user_param ( nr_sequencia_p LATAM_CONFIGURACAO.NR_SEQUENCIA%type ) FROM PUBLIC;

