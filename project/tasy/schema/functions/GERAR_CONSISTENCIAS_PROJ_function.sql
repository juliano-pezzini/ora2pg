-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION gerar_consistencias_proj ( cd_dominio_p bigint, nr_consistencia_p bigint, nr_sequencia_p bigint) RETURNS varchar AS $body$
DECLARE

 
qt_registro_w		bigint;	
ds_retorno_w		varchar(2);		
 

BEGIN 
 
 
ds_retorno_w	:=	'N';
--Iniciação 
if (cd_dominio_p = 4954) then 
	if (nr_consistencia_p = 1) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	iniciacao_repasse_v 
		where	nr_sequencia = nr_sequencia_p;
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;	
	end if;
	if (nr_consistencia_p = 2) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	iniciacao_acordo_v   
		where	nr_sequencia = nr_sequencia_p;	
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;	
	end if;	
end if;
 
--Planejamento 
if (cd_dominio_p = 4957) then 
	if (nr_consistencia_p = 1) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	planejamento_risco_v 
		where	nr_sequencia = nr_sequencia_p;	
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;	
	end if;
	if (nr_consistencia_p = 2) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	planejamento_cronograma_v 
		where	nr_sequencia = nr_sequencia_p;	
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;	
	end if;
	if (nr_consistencia_p = 3) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	planejamento_implement_v 
		where	nr_sequencia = nr_sequencia_p;	
		 
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;	
	end if;
	if (nr_consistencia_p = 4) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	planejamento_consult_v 
		where	nr_sequencia = nr_sequencia_p;	
		 
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;	
	end if;
end if;
 
 
--Execução 
if (cd_dominio_p = 4958) then 
	if (nr_consistencia_p = 1) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	execucao_mpo_v 
		where	nr_sequencia = nr_sequencia_p;	
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;	
	end if;
	 
	if (nr_consistencia_p = 2) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	execucao_treinamento_v 
		where	nr_sequencia = nr_sequencia_p;	
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;	
	end if;
	 
	if (nr_consistencia_p = 3) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	execucao_manual_v 
		where	nr_sequencia = nr_sequencia_p;	
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;	
	end if;
	 
	if (nr_consistencia_p = 4) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	execucao_oficial_v 
		where	nr_sequencia = nr_sequencia_p;	
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;	
	end if;
	if (nr_consistencia_p = 5) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	execucao_final_v 
		where	nr_sequencia = nr_sequencia_p;	
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;	
	end if;
	if (nr_consistencia_p = 6) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	execucao_equipes_v 
		where	nr_sequencia = nr_sequencia_p;	
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;	
	end if;
end if;
 
--Controle 
if (cd_dominio_p = 4959)	 then 
 
	if (nr_consistencia_p = 1) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	controle_acomp_risco_v 
		where	nr_sequencia = nr_sequencia_p;	
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;		
 
	end if;	
	if (nr_consistencia_p = 2) then 
		select	count(*) 
		into STRICT	qt_registro_w 
		from	controle_status_report_v 
		where	nr_sequencia = nr_sequencia_p;	
		if (qt_registro_w > 0) then 
			ds_retorno_w	:=	'S';
		end if;		
 
	end if;	
end if;
 
return	ds_retorno_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION gerar_consistencias_proj ( cd_dominio_p bigint, nr_consistencia_p bigint, nr_sequencia_p bigint) FROM PUBLIC;

