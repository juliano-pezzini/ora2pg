-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION plt_obter_desc_prod_npt_adulta ( NR_PRESCRICAO_P bigint, NR_SEQUENCIA_P bigint) RETURNS varchar AS $body$
DECLARE


DS_MATERIAL_W		varchar(60);
DS_RETORNO_W		varchar(1000);


C01 CURSOR FOR
SELECT	SUBSTR(OBTER_DESC_MATERIAL(A.CD_MATERIAL),1,60) DS_MATERIAL
FROM	NUT_PAC_ELEM_MAT  A,
		NUT_PAC B
WHERE	A.NR_SEQ_NUT_PAC	= B.NR_SEQUENCIA
AND		B.NR_PRESCRICAO		= NR_PRESCRICAO_P
AND		B.NR_SEQUENCIA		= NR_SEQUENCIA_P;


BEGIN
IF (coalesce(NR_PRESCRICAO_P,0) <> 0) THEN
	OPEN C01;
	LOOP
	FETCH C01 INTO	DS_MATERIAL_W;
	EXIT WHEN NOT FOUND; /* apply on C01 */
			BEGIN
			DS_RETORNO_W	:= DS_RETORNO_W || DS_MATERIAL_W || chr(10);
			END;
	END LOOP;
END IF;

RETURN DS_RETORNO_W;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION plt_obter_desc_prod_npt_adulta ( NR_PRESCRICAO_P bigint, NR_SEQUENCIA_P bigint) FROM PUBLIC;

