-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION pls_obter_se_espec_tipo_guia ( nr_seq_tipo_guia_p pls_tipo_guia_medico.nr_sequencia%type, nr_seq_prestador_p pls_prestador.nr_sequencia%type, cd_especialidade_p pls_tipo_guia_med_espec.cd_especialidade%type, ie_origem_p text) RETURNS varchar AS $body$
DECLARE

 
ie_insere_w	varchar(1) := 'S';


BEGIN 
 
if (ie_origem_p = 'W') then 
	select	CASE WHEN count(1)=0 THEN  'S'  ELSE 'N' END  
	into STRICT	ie_insere_w 
	from	pls_tipo_guia_med_espec	a 
	where	a.nr_seq_tipo_guia	= nr_seq_tipo_guia_p 
	and	a.ie_entra_portal	= 'N' 
	and (a.nr_seq_prestador	= nr_seq_prestador_p or coalesce(a.nr_seq_prestador::text, '') = '') 
	and (a.cd_especialidade	= cd_especialidade_p or coalesce(a.cd_especialidade::text, '') = '');
	 
elsif (ie_origem_p = 'T') then 
	select	CASE WHEN count(1)=0 THEN  'S'  ELSE 'N' END  
	into STRICT	ie_insere_w 
	from	pls_tipo_guia_med_espec	a 
	where	a.nr_seq_tipo_guia	= nr_seq_tipo_guia_p 
	and	a.ie_entra_guia_medico	= 'N' 
	and (a.nr_seq_prestador	= nr_seq_prestador_p or coalesce(a.nr_seq_prestador::text, '') = '') 
	and (a.cd_especialidade	= cd_especialidade_p or coalesce(a.cd_especialidade::text, '') = '');
end if;
 
return	ie_insere_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pls_obter_se_espec_tipo_guia ( nr_seq_tipo_guia_p pls_tipo_guia_medico.nr_sequencia%type, nr_seq_prestador_p pls_prestador.nr_sequencia%type, cd_especialidade_p pls_tipo_guia_med_espec.cd_especialidade%type, ie_origem_p text) FROM PUBLIC;

