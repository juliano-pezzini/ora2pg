-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_complitude_entlassplan ( nr_atendimento_p bigint ) RETURNS bigint AS $body$
DECLARE

 
nr_return_w	bigint := 0;
nr_seq_checklist_w	atendimento_checklist.nr_sequencia%Type;


BEGIN 
	if (nr_atendimento_p IS NOT NULL AND nr_atendimento_p::text <> '') then 
		select 	min(nr_sequencia) 
		into STRICT	nr_seq_checklist_w 
		from ( 
			SELECT 	nr_sequencia 
			from 	atendimento_checklist 
			where 	nr_atendimento = nr_atendimento_p 
			and	obter_se_checklist_lib(nr_seq_checklist, '1') = 'S' 
			order by dt_registro desc 
		) a LIMIT 1;
		 
		nr_return_w := obter_complitude_clepa(nr_seq_checklist_w, 0);
	end if;
	 
	return nr_return_w;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_complitude_entlassplan ( nr_atendimento_p bigint ) FROM PUBLIC;

