-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_se_integracao_ativa ( cd_evento_p bigint, nr_seq_sistema_destino_p bigint) RETURNS varchar AS $body$
DECLARE



ds_result_w	varchar(1) :=	'N';
ie_check_w	boolean := true;
ie_param_5_w	varchar(255);


BEGIN

if (cd_evento_p IS NOT NULL AND cd_evento_p::text <> '') and (nr_seq_sistema_destino_p IS NOT NULL AND nr_seq_sistema_destino_p::text <> '') then

	if (nr_seq_sistema_destino_p = 93) then
		ie_param_5_w := Obter_Param_Usuario(9041, 5, obter_perfil_ativo, wheb_usuario_pck.get_nm_usuario, obter_estabelecimento_ativo, ie_param_5_w);
		if (coalesce(ie_param_5_w, 'XPTO') = 'XPTO') then
			ie_check_w := false;
		end if;
	end if;

	if (ie_check_w) then
		select 	coalesce(max('S'), 'N')
		into STRICT 	ds_result_w
		from 	cliente_integracao c,
			informacao_integracao i
		where 	c.nr_seq_inf_integracao 	= i.nr_sequencia
		and 	i.nr_seq_sistema_destino 	= nr_seq_sistema_destino_p
		and 	i.nr_seq_evento 	= cd_evento_p
		and  	c.ie_situacao 	in ('A','P');
	end if;
end if;	

return ds_result_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_se_integracao_ativa ( cd_evento_p bigint, nr_seq_sistema_destino_p bigint) FROM PUBLIC;

