-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION is_information_changed ( table_name_p text, nr_seq_pie_pract_new_p bigint, nr_seq_pie_pract_old_p bigint) RETURNS bigint AS $body$
DECLARE

              ie_info_changed_w bigint;

BEGIN

		case table_name_p 
		when 'pie_pract_address' then
			select count(*) 
			into STRICT  ie_info_changed_w
			from (
				
				( SELECT dt_address_edit, ds_australian_locality, cd_australian_postal,cd_australian_state,ds_australia_country, ds_inter_province,cd_inter_postal,ds_inter_country 
				from pie_pract_address
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p
				EXCEPT
				SELECT dt_address_edit, ds_australian_locality, cd_australian_postal,cd_australian_state,ds_australia_country, ds_inter_province,cd_inter_postal,ds_inter_country 
				from pie_pract_address
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p )
				
union
( select dt_address_edit, ds_australian_locality, cd_australian_postal,cd_australian_state,ds_australia_country, ds_inter_province,cd_inter_postal,ds_inter_country 
				from pie_pract_address
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p
				EXCEPT
				select dt_address_edit, ds_australian_locality, cd_australian_postal,cd_australian_state,ds_australia_country, ds_inter_province,cd_inter_postal,ds_inter_country 
				from pie_pract_address
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p )
			) alias3;
		when 'pie_pract_caution' then
			select count(*)
			into STRICT  ie_info_changed_w
			from (
				
				( SELECT dt_caution_edit,
					tp_caution,
					ds_caution_detail
				from pie_pract_caution 
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p
				EXCEPT
				SELECT 	dt_caution_edit,
					tp_caution,
					ds_caution_detail
				from pie_pract_caution 
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p )
				
union
( select dt_caution_edit,
					tp_caution,
					ds_caution_detail
				from pie_pract_caution 
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p
				EXCEPT
				select 	dt_caution_edit,
					tp_caution,
					ds_caution_detail
				from pie_pract_caution 
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p )
				
			) alias3;
		when 'pie_pract_condition' then
			select count(*)
			into STRICT  ie_info_changed_w
			from (
				( SELECT dt_condition_edit,
				tp_condition,
				ds_condition_detail
				from pie_pract_condition 
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p
				EXCEPT
				SELECT dt_condition_edit,
				tp_condition,
				ds_condition_detail
				from pie_pract_condition 
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p )
				
union
( select dt_condition_edit,
				tp_condition,
				ds_condition_detail
				from pie_pract_condition 
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p
				EXCEPT
				select dt_condition_edit,
				tp_condition,
				ds_condition_detail
				from pie_pract_condition 
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p )
			) alias3;
		when 'pie_pract_other_language' then
			select count(*)
			into STRICT  ie_info_changed_w
			from (
				( SELECT ds_language
				from pie_pract_other_language
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p
				EXCEPT
				SELECT 	ds_language
				from pie_pract_other_language 
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p )
				
union
( select ds_language
				from pie_pract_other_language
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p
				EXCEPT
				select 	ds_language
				from pie_pract_other_language 
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p )
			) alias3;
		when 'pie_pract_qualification' then
			select count(*)
			into STRICT  ie_info_changed_w
			from (
				( SELECT dt_qualific_edit,
				ds_qualific_title,
				ds_awarding_instit,
				ds_country_obtained,
				nr_year_qualific
				from pie_pract_qualification 
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p
				EXCEPT
				SELECT 	dt_qualific_edit,
					ds_qualific_title,
					ds_awarding_instit,
					ds_country_obtained,
					nr_year_qualific
				from pie_pract_qualification
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p )
				
union
( select dt_qualific_edit,
				ds_qualific_title,
				ds_awarding_instit,
				ds_country_obtained,
				nr_year_qualific
				from pie_pract_qualification 
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p
				EXCEPT
				select 	dt_qualific_edit,
					ds_qualific_title,
					ds_awarding_instit,
					ds_country_obtained,
					nr_year_qualific
				from pie_pract_qualification
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p )
			) alias3;
		WHEN 'pie_pract_registration' THEN

			select count(*)
			into STRICT  ie_info_changed_w
			from (
				( SELECT nr_record,
				tp_division,
				tp_registration,
				tp_registration_sub,
				tp_regist_status,
				tp_regist_sub_status,
				dt_regist_expiry,
				tp_specialty,
				tp_specialty_field,
				dt_initial_registration
				from pie_pract_registration
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p 
				EXCEPT
				SELECT 	nr_record,
					tp_division,
					tp_registration,
					tp_registration_sub,
					tp_regist_status,
					tp_regist_sub_status,
					dt_regist_expiry,
					tp_specialty,
					tp_specialty_field,
					dt_initial_registration
				from pie_pract_registration
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p )
				
union
( select nr_record,
				tp_division,
				tp_registration,
				tp_registration_sub,
				tp_regist_status,
				tp_regist_sub_status,
				dt_regist_expiry,
				tp_specialty,
				tp_specialty_field,
				dt_initial_registration
				from pie_pract_registration
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p 
				EXCEPT
				select 	nr_record,
					tp_division,
					tp_registration,
					tp_registration_sub,
					tp_regist_status,
					tp_regist_sub_status,
					dt_regist_expiry,
					tp_specialty,
					tp_specialty_field,
					dt_initial_registration
				from pie_pract_registration
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p )
			) alias3;
		when 'pie_pract_reprimand' then
			select count(*)
			into STRICT  ie_info_changed_w
			from (
				( SELECT dt_reprimand_edit,
				tp_reprimand,
				ds_reprimand_detail
				from pie_pract_reprimand
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p 
				EXCEPT
				SELECT 	dt_reprimand_edit,
					tp_reprimand,
					ds_reprimand_detail
				from pie_pract_reprimand
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p )
				
union
( select dt_reprimand_edit,
				tp_reprimand,
				ds_reprimand_detail
				from pie_pract_reprimand
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p 
				EXCEPT
				select 	dt_reprimand_edit,
					tp_reprimand,
					ds_reprimand_detail
				from pie_pract_reprimand
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p )
			) alias3;
		when 'pie_pract_undertaking' then
			select count(*)
			into STRICT  ie_info_changed_w
			from (
				( SELECT dt_undertaking_edit,
				tp_undertaking,
				ds_undertaking_detail
				from pie_pract_undertaking 
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p
				EXCEPT
				SELECT 	dt_undertaking_edit,
					tp_undertaking,
					ds_undertaking_detail
				from pie_pract_undertaking
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p )
				
union
( select dt_undertaking_edit,
				tp_undertaking,
				ds_undertaking_detail
				from pie_pract_undertaking 
				where nr_seq_pie_pract = nr_seq_pie_pract_old_p
				EXCEPT
				select 	dt_undertaking_edit,
					tp_undertaking,
					ds_undertaking_detail
				from pie_pract_undertaking
				where nr_seq_pie_pract = nr_seq_pie_pract_new_p )
			) alias3;
		 when 'pie_pract_reg_endorsement' then
		
			select count(*) 
			into STRICT  ie_info_changed_w
			from (
				( SELECT dt_endorsement_edit,
				ds_endorsement_detail,
				tp_endorsement,
				tp_endorsement_sub
				from pie_pract_reg_endorsement
				where nr_seq_pie_pract_reg in (
					SELECT nr_sequencia from pie_pract_registration 
					where nr_seq_pie_pract=nr_seq_pie_pract_new_p )
				EXCEPT
				select 	dt_endorsement_edit,
					ds_endorsement_detail,
					tp_endorsement,
					tp_endorsement_sub
				from pie_pract_reg_endorsement 
				where nr_seq_pie_pract_reg in (
					select nr_sequencia from pie_pract_registration 
					where nr_seq_pie_pract= nr_seq_pie_pract_old_p))
				
union
( select dt_endorsement_edit,
				ds_endorsement_detail,
				tp_endorsement,
				tp_endorsement_sub
				from pie_pract_reg_endorsement
				where nr_seq_pie_pract_reg in (
					select nr_sequencia from pie_pract_registration 
					where nr_seq_pie_pract= nr_seq_pie_pract_old_p)
				EXCEPT
				select 	dt_endorsement_edit,
					ds_endorsement_detail,
					tp_endorsement,
					tp_endorsement_sub
				from pie_pract_reg_endorsement
				where nr_seq_pie_pract_reg in (
					select nr_sequencia from pie_pract_registration 
					where nr_seq_pie_pract=nr_seq_pie_pract_new_p ))
			) alias7;
		when 'pie_pract_reg_notation' then
			select count(*) 
			into STRICT  ie_info_changed_w
			from (
				( SELECT distinct dt_notation_edit,
				tp_notation,
				ds_notation_detail
				from pie_pract_reg_notation
				where nr_seq_pie_pract_reg in (
					SELECT nr_sequencia from pie_pract_registration 
					where nr_seq_pie_pract=nr_seq_pie_pract_new_p )
				EXCEPT 
				select distinct dt_notation_edit,tp_notation,ds_notation_detail
				from pie_pract_reg_notation
				where nr_seq_pie_pract_reg in (
					select nr_sequencia from pie_pract_registration 
					where nr_seq_pie_pract= nr_seq_pie_pract_old_p))
				
union
( select distinct dt_notation_edit,tp_notation,ds_notation_detail
				from pie_pract_reg_notation
				where nr_seq_pie_pract_reg in (
					select nr_sequencia from pie_pract_registration 
					where nr_seq_pie_pract= nr_seq_pie_pract_old_p)
				EXCEPT 
				select distinct dt_notation_edit,tp_notation,ds_notation_detail
				from pie_pract_reg_notation
				where nr_seq_pie_pract_reg in (
					select nr_sequencia from pie_pract_registration 
					where nr_seq_pie_pract=nr_seq_pie_pract_new_p))
			) alias7;
		else
		return 0;
		end case;

		return ie_info_changed_w;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION is_information_changed ( table_name_p text, nr_seq_pie_pract_new_p bigint, nr_seq_pie_pract_old_p bigint) FROM PUBLIC;

