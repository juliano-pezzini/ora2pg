-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION verifica_tipo_par_antrop_md (ie_tipo_p text, anos_p bigint, meses_p bigint, peso_p bigint, altura_p bigint, qt_imc_p bigint, ie_tipo_condicao_p text) RETURNS varchar AS $body$
DECLARE

  sql_w varchar(3000);

BEGIN

  if (coalesce(ie_tipo_condicao_p::text, '') = '') then
    if (ie_tipo_p = 'PA') and
       ((anos_p < 5) or (anos_p = 5 and meses_p = 0)) and (peso_p > 0) and (altura_p > 0) then

      if (anos_p > 2) then
        sql_w := sql_w || ' and ie_tipo = ''' || ie_tipo_p || '''';
        sql_w := sql_w || ' and qt_anos > 2 ';
        sql_w := sql_w || ' and qt_altura_cm <= ' || altura_p;
      else
        sql_w := sql_w || ' and ie_tipo = ''' || ie_tipo_p || '''';
        sql_w := sql_w || ' and qt_anos <= 2 ';
        sql_w := sql_w || ' and qt_altura_cm <= ' || altura_p;
      end if;

    elsif (ie_tipo_p = 'AI') and (anos_p <= 19) and (altura_p > 0) then
      sql_w := sql_w || ' and ie_tipo = ''' || ie_tipo_p || '''';
      sql_w := sql_w || ' and qt_anos = ' || anos_p;
      sql_w := sql_w || ' and qt_meses = ' || meses_p;

    elsif ((ie_tipo_p = 'IMC') or (ie_tipo_p = 'IMCI')) and (anos_p <= 17) and (qt_imc_p > 0) then
      sql_w := sql_w || ' and ie_tipo = ''IMC''';
      sql_w := sql_w || ' and qt_anos = ' || anos_p;
      sql_w := sql_w || ' and qt_meses = ' || meses_p;

    elsif (ie_tipo_p = 'PI') and (anos_p <= 10) and (peso_p > 0) then
      sql_w := sql_w || ' and ie_tipo = ' || ie_tipo_p || '''';
      sql_w := sql_w || ' and qt_anos = ' || anos_p;
      sql_w := sql_w || ' and qt_meses = ' || meses_p;

    end if;
  else
    if (ie_tipo_p = 'AIP') then
      sql_w := sql_w || ' and ie_tipo = ''' || ie_tipo_p || '''';
      sql_w := sql_w || ' and qt_anos = ' || anos_p;
      sql_w := sql_w || ' and qt_meses = ' || meses_p;
    else
      sql_w := null;
    end if;

  end if;
  return sql_w;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION verifica_tipo_par_antrop_md (ie_tipo_p text, anos_p bigint, meses_p bigint, peso_p bigint, altura_p bigint, qt_imc_p bigint, ie_tipo_condicao_p text) FROM PUBLIC;

