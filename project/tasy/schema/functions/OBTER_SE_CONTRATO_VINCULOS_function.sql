-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_se_contrato_vinculos ( nr_seq_contrato_p bigint ) RETURNS varchar AS $body$
DECLARE




ds_retorno_w		varchar(1);
qt_nota_fiscal		bigint;
qt_ordem_compra		bigint;
qt_tit_receber		bigint;
qt_tit_pagar		bigint;


BEGIN

		Select 	count(nr_sequencia)
		into STRICT	qt_nota_fiscal
		from	nota_fiscal
		where	nr_contrato = nr_seq_contrato_p;

		Select 	count(nr_ordem_compra)
		into STRICT	qt_ordem_compra
		from	ordem_compra_item
		where	nr_contrato = nr_seq_contrato_p;

		Select 	count(nr_titulo)
		into STRICT	qt_tit_receber
		from	titulo_receber
		where	nr_seq_contrato = nr_seq_contrato_p;

		Select 	count(nr_titulo)
		into STRICT	qt_tit_pagar
		from	titulo_pagar
		where	nr_seq_contrato = nr_seq_contrato_p;

		if (qt_nota_fiscal > 0) or (qt_ordem_compra > 0) or (qt_tit_receber > 0) or (qt_tit_pagar > 0) then

				ds_retorno_w := 'S';

		end if;


return ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_se_contrato_vinculos ( nr_seq_contrato_p bigint ) FROM PUBLIC;

