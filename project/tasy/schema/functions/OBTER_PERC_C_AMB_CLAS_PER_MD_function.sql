-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_perc_c_amb_clas_per_md (ie_regra_p text, ie_versao_p bigint, ie_sexo_p text, qt_idade_p bigint ) RETURNS bigint AS $body$
DECLARE


   qt_perc_circ_amb_w	bigint;

BEGIN
  if (ie_regra_p = 'F2') and (ie_versao_p = 2008) then
    begin
      if (ie_sexo_p = 'M') then 
        if (qt_idade_p = 2) then
          qt_perc_circ_amb_w := 14.5;
        elsif (qt_idade_p = 3) then
          qt_perc_circ_amb_w	:= 16.1;
        elsif (qt_idade_p = 4) then
          qt_perc_circ_amb_w	:= 16.9;
        elsif (qt_idade_p = 5) then
          qt_perc_circ_amb_w	:= 18.1;
        elsif (qt_idade_p = 6) then
          qt_perc_circ_amb_w	:= 19.8;
        elsif (qt_idade_p = 7) then
          qt_perc_circ_amb_w	:= 21.5;
        elsif (qt_idade_p = 8) then
          qt_perc_circ_amb_w	:= 23.2;
        elsif (qt_idade_p = 9) then
          qt_perc_circ_amb_w	:= 25.1;
        elsif (qt_idade_p = 10) then
          qt_perc_circ_amb_w := 27.2;
        elsif (qt_idade_p = 11) then
          qt_perc_circ_amb_w	:= 30.2;
        elsif (qt_idade_p = 12) then
          qt_perc_circ_amb_w	:= 34.1;
        elsif (qt_idade_p = 13) then
          qt_perc_circ_amb_w	:= 38.7;
        elsif (qt_idade_p = 14) then
          qt_perc_circ_amb_w	:= 43.7;
        elsif (qt_idade_p = 15) then
          qt_perc_circ_amb_w	:= 48.3;
        elsif (qt_idade_p = 16) then
          qt_perc_circ_amb_w	:= 52.5;
        elsif (qt_idade_p = 17) then
          qt_perc_circ_amb_w	:= 56;
        elsif (qt_idade_p = 18) then
          qt_perc_circ_amb_w	:= 58.6;
        elsif (qt_idade_p = 19) then
          qt_perc_circ_amb_w	:= 59.4;	
        elsif (qt_idade_p between 20 and 29) then
          qt_perc_circ_amb_w	:= 63.8;	
        elsif (qt_idade_p between 30 and 39) then
          qt_perc_circ_amb_w	:= 68.1;	
        elsif (qt_idade_p between 40 and 49) then
          qt_perc_circ_amb_w	:= 69.1;	
        elsif (qt_idade_p between 50 and 59) then
          qt_perc_circ_amb_w	:= 67.8;	
        elsif (qt_idade_p between 60 and 69) then
          qt_perc_circ_amb_w	:= 64.4;	
        elsif (qt_idade_p between 70 and 79) then
          qt_perc_circ_amb_w	:= 59.2;
        elsif (qt_idade_p between 80 and 90) then
          qt_perc_circ_amb_w	:= 52.4;
        end if;
      elsif (ie_sexo_p = 'F') then
        if (qt_idade_p between 2 and 2.9) then
          qt_perc_circ_amb_w := 14;
        elsif (qt_idade_p = 3) then
          qt_perc_circ_amb_w	:= 15.5;
        elsif (qt_idade_p = 4) then
          qt_perc_circ_amb_w	:= 16.8;
        elsif (qt_idade_p = 5) then
          qt_perc_circ_amb_w	:= 17.8;
        elsif (qt_idade_p = 6) then
          qt_perc_circ_amb_w	:= 18.8;
        elsif (qt_idade_p = 7) then
          qt_perc_circ_amb_w	:= 19.6;
        elsif (qt_idade_p = 8) then
          qt_perc_circ_amb_w	:= 20.7;
        elsif (qt_idade_p = 9) then
          qt_perc_circ_amb_w	:= 22.5;
        elsif (qt_idade_p = 10) then
          qt_perc_circ_amb_w	:= 25.5;
        elsif (qt_idade_p = 11) then
          qt_perc_circ_amb_w	:= 29.1;
        elsif (qt_idade_p = 12) then
          qt_perc_circ_amb_w	:= 32.5;
        elsif (qt_idade_p = 13) then
          qt_perc_circ_amb_w	:= 35;
        elsif (qt_idade_p = 14) then
          qt_perc_circ_amb_w	:= 36.1;
        elsif (qt_idade_p = 15) then
          qt_perc_circ_amb_w	:= 36.2;
        elsif (qt_idade_p = 16) then
          qt_perc_circ_amb_w	:= 36.1;
        elsif (qt_idade_p = 17) then
          qt_perc_circ_amb_w	:= 36.1;
        elsif (qt_idade_p = 18) then
          qt_perc_circ_amb_w	:= 36.3;
        elsif (qt_idade_p = 19) then
          qt_perc_circ_amb_w	:= 36.9;	
        elsif (qt_idade_p between 20 and 29) then
          qt_perc_circ_amb_w	:= 38.4;	
        elsif (qt_idade_p between 30 and 39) then
          qt_perc_circ_amb_w	:= 41.3;	
        elsif (qt_idade_p between 40 and 49) then
          qt_perc_circ_amb_w	:= 44.1;	
        elsif (qt_idade_p between 50 and 59) then
          qt_perc_circ_amb_w	:= 44.1;	
        elsif (qt_idade_p between 60 and 69) then
          qt_perc_circ_amb_w	:= 43.1;	
        elsif (qt_idade_p between 70 and 79) then
          qt_perc_circ_amb_w	:= 42.1;
        elsif (qt_idade_p between 80 and 90) then
          qt_perc_circ_amb_w	:= 40.1;					
        end if;
      end if;	
      end;
    elsif (ie_regra_p = 'F3') and (ie_versao_p = 1990) then -- Frisancho(1990)
      begin
      if (ie_sexo_p = 'M') then
        if (qt_idade_p = 1) then
          qt_perc_circ_amb_w := 13;
        elsif (qt_idade_p = 2) then
          qt_perc_circ_amb_w	:= 13.9;
        elsif (qt_idade_p = 3) then
          qt_perc_circ_amb_w	:= 15;
        elsif (qt_idade_p = 4) then
          qt_perc_circ_amb_w	:= 16.2;
        elsif (qt_idade_p = 5) then
          qt_perc_circ_amb_w	:= 17.6;
        elsif (qt_idade_p = 6) then
          qt_perc_circ_amb_w	:= 18.7;
        elsif (qt_idade_p = 7) then
          qt_perc_circ_amb_w	:= 20.6;
        elsif (qt_idade_p = 8) then
          qt_perc_circ_amb_w	:= 21.6;
        elsif (qt_idade_p = 9) then
          qt_perc_circ_amb_w	:= 23.5;
        elsif (qt_idade_p = 10) then
          qt_perc_circ_amb_w	:= 25.7;
        elsif (qt_idade_p = 11) then
          qt_perc_circ_amb_w	:= 27.7;
        elsif (qt_idade_p = 12) then
          qt_perc_circ_amb_w	:= 30.4;
        elsif (qt_idade_p = 13) then
          qt_perc_circ_amb_w	:= 35.7;
        elsif (qt_idade_p = 14) then
          qt_perc_circ_amb_w	:= 41.9;
        elsif (qt_idade_p = 15) then
          qt_perc_circ_amb_w	:= 46.3;
        elsif (qt_idade_p = 16) then
          qt_perc_circ_amb_w	:= 51.9;
        elsif (qt_idade_p = 17) then
          qt_perc_circ_amb_w	:= 53.4;
        elsif (qt_idade_p between 18 and 24) then
          qt_perc_circ_amb_w	:= 49.4;	
        elsif (qt_idade_p between 25 and 29) then
          qt_perc_circ_amb_w	:= 53;	
        elsif (qt_idade_p between 30 and 34) then
          qt_perc_circ_amb_w	:= 54.4;	
        elsif (qt_idade_p between 35 and 39) then
          qt_perc_circ_amb_w	:= 55.3;	
        elsif (qt_idade_p between 40 and 44) then
          qt_perc_circ_amb_w	:= 56;	
        elsif (qt_idade_p between 45 and 49) then
          qt_perc_circ_amb_w	:= 55.2;	
        elsif (qt_idade_p between 50 and 54) then
          qt_perc_circ_amb_w	:= 54;
        elsif (qt_idade_p between 55 and 59) then
          qt_perc_circ_amb_w	:= 54.3;
        elsif (qt_idade_p between 60 and 64) then
          qt_perc_circ_amb_w	:= 52.1;
        elsif (qt_idade_p between 65 and 69) then
          qt_perc_circ_amb_w	:= 49.1;	
        elsif (qt_idade_p between 70 and 74) then
          qt_perc_circ_amb_w	:= 47;		
        end if;
      elsif (ie_sexo_p = 'F') then
        if (qt_idade_p = 1) then
          qt_perc_circ_amb_w := 12.3;
        elsif (qt_idade_p = 2) then
          qt_perc_circ_amb_w	:= 13.2;
        elsif (qt_idade_p = 3) then
          qt_perc_circ_amb_w	:= 14.3;
        elsif (qt_idade_p = 4) then
          qt_perc_circ_amb_w	:= 15.3;
        elsif (qt_idade_p = 5) then
          qt_perc_circ_amb_w	:= 16.4;
        elsif (qt_idade_p = 6) then
          qt_perc_circ_amb_w	:= 17.4;
        elsif (qt_idade_p = 7) then
          qt_perc_circ_amb_w	:= 18.9;
        elsif (qt_idade_p = 8) then
          qt_perc_circ_amb_w	:= 20.8;
        elsif (qt_idade_p = 9) then
          qt_perc_circ_amb_w	:= 21.9;
        elsif (qt_idade_p = 10) then
          qt_perc_circ_amb_w	:= 23.8;
        elsif (qt_idade_p = 11) then
          qt_perc_circ_amb_w	:= 26.4;
        elsif (qt_idade_p = 12) then
          qt_perc_circ_amb_w	:= 29;
        elsif (qt_idade_p = 13) then
          qt_perc_circ_amb_w	:= 30.8;
        elsif (qt_idade_p = 14) then
          qt_perc_circ_amb_w	:= 32.8;
        elsif (qt_idade_p = 15) then
          qt_perc_circ_amb_w	:= 33;
        elsif (qt_idade_p = 16) then
          qt_perc_circ_amb_w	:= 33.6;
        elsif (qt_idade_p = 17) then
          qt_perc_circ_amb_w	:= 34.3;
        elsif (qt_idade_p between 18 and 24) then
          qt_perc_circ_amb_w	:= 28.3;	
        elsif (qt_idade_p between 25 and 29) then
          qt_perc_circ_amb_w	:= 29.4;	
        elsif (qt_idade_p between 30 and 34) then
          qt_perc_circ_amb_w	:= 30.9;	
        elsif (qt_idade_p between 35 and 39) then
          qt_perc_circ_amb_w	:= 31.8;	
        elsif (qt_idade_p between 40 and 44) then
          qt_perc_circ_amb_w	:= 32.3;	
        elsif (qt_idade_p between 45 and 49) then
          qt_perc_circ_amb_w	:= 32.5;	
        elsif (qt_idade_p between 50 and 54) then
          qt_perc_circ_amb_w	:= 33.4;
        elsif (qt_idade_p between 55 and 59) then
          qt_perc_circ_amb_w	:= 34.7;
        elsif (qt_idade_p between 60 and 64) then
          qt_perc_circ_amb_w	:= 34.5;
        elsif (qt_idade_p between 65 and 69) then
          qt_perc_circ_amb_w	:= 34.6;	
        elsif (qt_idade_p between 70 and 74) then
          qt_perc_circ_amb_w	:= 34.3;		
        end if;
      end if;
      end;
    elsif (ie_regra_p = 'F') and (ie_versao_p = 1981) then -- Frisancho(1981)
      begin
      if (ie_sexo_p = 'M') then
        if (qt_idade_p = 1) then
          qt_perc_circ_amb_w := 1278;
        elsif (qt_idade_p = 2) then
          qt_perc_circ_amb_w	:= 1345;
        elsif (qt_idade_p = 3) then
          qt_perc_circ_amb_w	:= 1484;
        elsif (qt_idade_p = 4) then
          qt_perc_circ_amb_w	:= 1579;
        elsif (qt_idade_p = 5) then
          qt_perc_circ_amb_w	:= 1720;
        elsif (qt_idade_p = 6) then
          qt_perc_circ_amb_w	:= 1815;
        elsif (qt_idade_p = 7) then
          qt_perc_circ_amb_w	:= 2027;
        elsif (qt_idade_p = 8) then
          qt_perc_circ_amb_w	:= 2089;
        elsif (qt_idade_p = 9) then
          qt_perc_circ_amb_w	:= 2288;
        elsif (qt_idade_p = 10) then
          qt_perc_circ_amb_w	:= 2575;
        elsif (qt_idade_p = 11) then
          qt_perc_circ_amb_w	:= 2670;
        elsif (qt_idade_p = 12) then
          qt_perc_circ_amb_w	:= 3022;
        elsif (qt_idade_p = 13) then
          qt_perc_circ_amb_w	:= 3553;
        elsif (qt_idade_p = 14) then
          qt_perc_circ_amb_w	:= 3963;
        elsif (qt_idade_p = 15) then
          qt_perc_circ_amb_w	:= 4481;
        elsif (qt_idade_p = 16) then
          qt_perc_circ_amb_w	:= 4951;
        elsif (qt_idade_p = 17) then
          qt_perc_circ_amb_w	:= 5286;
        elsif (qt_idade_p = 18) then
          qt_perc_circ_amb_w	:= 5552;	
        elsif (qt_idade_p between 19 and 24) then
          qt_perc_circ_amb_w	:= 5913;	
        elsif (qt_idade_p between 25 and 34) then
          qt_perc_circ_amb_w	:= 6214;	
        elsif (qt_idade_p between 35 and 44) then
          qt_perc_circ_amb_w	:= 6490;	
        elsif (qt_idade_p between 45 and 54) then
          qt_perc_circ_amb_w	:= 6297;	
        elsif (qt_idade_p between 55 and 64) then
          qt_perc_circ_amb_w	:= 6144;	
        elsif (qt_idade_p between 65 and 74) then
          qt_perc_circ_amb_w	:= 5716;	
        end if;
      elsif (ie_sexo_p = 'F') then
        if (qt_idade_p = 1) then
          qt_perc_circ_amb_w := 1221;
        elsif (qt_idade_p = 2) then
          qt_perc_circ_amb_w	:= 1269;
        elsif (qt_idade_p = 3) then
          qt_perc_circ_amb_w	:= 1396;
        elsif (qt_idade_p = 4) then
          qt_perc_circ_amb_w	:= 1475;
        elsif (qt_idade_p = 5) then
          qt_perc_circ_amb_w	:= 1598;
        elsif (qt_idade_p = 6) then
          qt_perc_circ_amb_w	:= 1683;
        elsif (qt_idade_p = 7) then
          qt_perc_circ_amb_w	:= 1815;
        elsif (qt_idade_p = 8) then
          qt_perc_circ_amb_w	:= 2034;
        elsif (qt_idade_p = 9) then
          qt_perc_circ_amb_w	:= 2227;
        elsif (qt_idade_p = 10) then
          qt_perc_circ_amb_w	:= 2296;
        elsif (qt_idade_p = 11) then
          qt_perc_circ_amb_w	:= 2612;
        elsif (qt_idade_p = 12) then
          qt_perc_circ_amb_w	:= 2904;
        elsif (qt_idade_p = 13) then
          qt_perc_circ_amb_w	:= 3130;
        elsif (qt_idade_p = 14) then
          qt_perc_circ_amb_w	:= 3220;
        elsif (qt_idade_p = 15) then
          qt_perc_circ_amb_w	:= 3248;
        elsif (qt_idade_p = 16) then
          qt_perc_circ_amb_w	:= 3248;
        elsif (qt_idade_p = 17) then
          qt_perc_circ_amb_w	:= 3336;
        elsif (qt_idade_p = 18) then
          qt_perc_circ_amb_w	:= 3243;	
        elsif (qt_idade_p between 19 and 24) then
          qt_perc_circ_amb_w	:= 3406;	
        elsif (qt_idade_p between 25 and 34) then
          qt_perc_circ_amb_w	:= 3573;	
        elsif (qt_idade_p between 35 and 44) then
          qt_perc_circ_amb_w	:= 3783;	
        elsif (qt_idade_p between 45 and 54) then
          qt_perc_circ_amb_w	:= 3858;	
        elsif (qt_idade_p between 55 and 64) then
          qt_perc_circ_amb_w	:= 4045;	
        elsif (qt_idade_p between 65 and 74) then
          qt_perc_circ_amb_w	:= 4019;			
        end if;
      end if;
      end;
    end if;
    --FIM MD 1
    RETURN qt_perc_circ_amb_w;
   
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_perc_c_amb_clas_per_md (ie_regra_p text, ie_versao_p bigint, ie_sexo_p text, qt_idade_p bigint ) FROM PUBLIC;

