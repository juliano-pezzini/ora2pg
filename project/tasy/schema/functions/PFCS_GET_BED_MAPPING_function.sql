-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION pfcs_get_bed_mapping ( cd_operational_status_p text, ie_option_p text default 'F') RETURNS varchar AS $body$
DECLARE


-- https://www.hl7.org/fhir/v2/0116/index.html
-- Table: valor_dominio / cd_dominio = 82
-- ie_option_p - F = FHIR to Tasy / T = Tasy to FHIR
operational_status_w varchar(2) := null;


BEGIN
    IF (ie_option_p = 'F') THEN
        operational_status_w :=
        CASE
            WHEN upper(cd_operational_status_p) = 'U' THEN 'L' --> Free
            WHEN upper(cd_operational_status_p) = 'O' THEN 'P' --> Occupied (Pacient in bed)
            WHEN upper(cd_operational_status_p) = 'I' THEN 'O' --> Isolated
            WHEN upper(cd_operational_status_p) = 'C' THEN 'I' --> Closed
            WHEN upper(cd_operational_status_p) = 'K' THEN 'U' --> Contaminated
            WHEN upper(cd_operational_status_p) = 'H' THEN 'H' --> H: Housekeeping/Sanitation
            ELSE 'L'
        END;
    ELSIF (ie_option_p = 'T') THEN
        operational_status_w :=
        CASE
            WHEN upper(cd_operational_status_p) = 'L' THEN 'U'
            WHEN upper(cd_operational_status_p) = 'P' THEN 'O'
            WHEN upper(cd_operational_status_p) = 'O' THEN 'I'
            WHEN upper(cd_operational_status_p) = 'I' THEN 'C'
            WHEN upper(cd_operational_status_p) = 'U' THEN 'K'
            WHEN upper(cd_operational_status_p) = 'H' THEN 'H'
            ELSE 'L'
        END;
    END IF;
    RETURN operational_status_w;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pfcs_get_bed_mapping ( cd_operational_status_p text, ie_option_p text default 'F') FROM PUBLIC;

