-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION ageint_obter_dados_age (nr_sequencia_p bigint, nm_parametro_p text, ds_agenda_p text) RETURNS varchar AS $body$
DECLARE


 vl_param_retorno_w varchar(4000);
 ds_comando_w		varchar(400);
 ds_param_w		    varchar(400);


BEGIN
 
    IF (ds_agenda_p = 'C') THEN 
	    
		ds_comando_w :=	'select	' || nm_parametro_p || ' ' ||
	 					'from		agenda_consulta ' ||
						'where		nr_sequencia = :nr_sequencia_p';
		ds_param_w := 'nr_sequencia= ' || nr_sequencia_p;

	ELSIF (ds_agenda_p = 'E') THEN

	 	ds_comando_w :=	'select	' || nm_parametro_p || ' ' ||
	 					'from		agenda_paciente ' ||
						'where		nr_sequencia = :nr_sequencia_p';
		ds_param_w := 'nr_sequencia= ' || nr_sequencia_p;
	
 END IF;

	select	obter_select_concatenado_bv(ds_comando_w, ds_param_w, ',')
	into STRICT	vl_param_retorno_w
	;

RETURN vl_param_retorno_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION ageint_obter_dados_age (nr_sequencia_p bigint, nm_parametro_p text, ds_agenda_p text) FROM PUBLIC;

