-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION calculate_weight_form_hamwi ( qt_altura_p AVAL_NUTRICAO.QT_ALTURA%type, ie_sexo_p PESSOA_FISICA.IE_SEXO%type ) RETURNS bigint AS $body$
DECLARE


nr_inc_weight_s     constant real := 2.5;
nr_hight_s          constant smallint   := 152;
nr_delta_weight_w   smallint            := 3;
nr_ini_weight_w     smallint            := 48;
nr_return_weight_w  integer            := 0;


BEGIN

IF (ie_sexo_p IS NOT NULL AND ie_sexo_p::text <> '') AND (qt_altura_p IS NOT NULL AND qt_altura_p::text <> '') THEN
    IF ie_sexo_p = 'F' THEN
        nr_ini_weight_w := 45;
        IF qt_altura_p <= nr_hight_s THEN
            nr_delta_weight_w := 2;
        END IF;
    END IF;

    IF qt_altura_p > nr_hight_s THEN
        nr_return_weight_w := nr_ini_weight_w + (CEIL((qt_altura_p - nr_hight_s)/nr_inc_weight_s) * nr_delta_weight_w);
    ELSE
        nr_return_weight_w := nr_ini_weight_w - (CEIL((nr_hight_s - qt_altura_p)/nr_inc_weight_s) * nr_delta_weight_w);
    END IF;
END IF;

RETURN nr_return_weight_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION calculate_weight_form_hamwi ( qt_altura_p AVAL_NUTRICAO.QT_ALTURA%type, ie_sexo_p PESSOA_FISICA.IE_SEXO%type ) FROM PUBLIC;

