-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION get_procedure_call ( nm_procedure_p text, qt_arguments_p bigint, ds_id_variant_p text, ie_fallback_p text default 'S') RETURNS varchar AS $body$
DECLARE


/*
This function is intended to be used in conjunction with EXECUTE IMMEDIATE, like in the example below.
EXECUTE IMMEDIATE get_procedure_call('NM_OBJECT', NUMBER_OF ARGUMENTS, ID) using PARAM1, PARAM2;
*/
ds_template_w			varchar(4000) := 'begin %s(%s); end;';
ds_dummy_template_w		varchar(4000) := 'declare dummy varchar2(32000); begin dummy := null; %s end;';
ds_arguments_w			varchar(4000);
nm_localized_object_w	varchar(255);
BEGIN

select	max(nm_variant)
into STRICT	nm_localized_object_w
from	plsql_object_variant
where	upper(nm_object) = upper(nm_procedure_p)
and		ds_id = ds_id_variant_p;

if (nm_localized_object_w IS NOT NULL AND nm_localized_object_w::text <> '') or (ie_fallback_p = 'S') then
	nm_localized_object_w := coalesce(nm_localized_object_w, nm_procedure_p);
	for i in 1.. qt_arguments_p loop
		ds_arguments_w := ds_arguments_w || ':' || i || ',';
	end loop;
	ds_arguments_w := trim(both ',' from ds_arguments_w);
	ds_template_w := utl_lms.format_message(ds_template_w, nm_localized_object_w, ds_arguments_w);
else
	for i in 1.. qt_arguments_p loop
		ds_arguments_w := ds_arguments_w || ' dummy := :' || i || ';';
	end loop;
	ds_template_w := utl_lms.format_message(ds_dummy_template_w, ds_arguments_w);
end if;

return ds_template_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION get_procedure_call ( nm_procedure_p text, qt_arguments_p bigint, ds_id_variant_p text, ie_fallback_p text default 'S') FROM PUBLIC;

