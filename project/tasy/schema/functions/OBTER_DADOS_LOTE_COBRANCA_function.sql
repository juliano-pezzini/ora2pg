-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_dados_lote_cobranca ( nr_sequencia_p bigint, ie_opcao_p text) RETURNS bigint AS $body$
DECLARE


nr_retorno_w		double precision := 0;


BEGIN

if (coalesce(ie_opcao_p,'X') = 'VL') then
	begin
	select	sum(vl_doc)
	into STRICT	nr_retorno_w
	from (SELECT	vl_cheque vl_doc
			from	cheque_cr_orgao_cobr
			where (nr_seq_lote = nr_sequencia_p or nr_seq_lote_exc = nr_sequencia_p)
			
union

			SELECT	vl_titulo vl_doc
			from	titulo_receber_orgao_cobr
			where (nr_seq_lote = nr_sequencia_p or nr_seq_lote_exc = nr_sequencia_p)) alias5;
	end;
elsif (coalesce(ie_opcao_p,'X') = 'QT') then
	begin
	select	sum(qt)
	into STRICT	nr_retorno_w
	from (SELECT	count(*) qt
			from	cheque_cr_orgao_cobr
			where (nr_seq_lote = nr_sequencia_p or nr_seq_lote_exc = nr_sequencia_p)
			
union

			SELECT	count(*) qt
			from	titulo_receber_orgao_cobr
			where (nr_seq_lote = nr_sequencia_p or nr_seq_lote_exc = nr_sequencia_p)
			
union

			select	count(*) qt
			from	outros_orgao_cobr
			where (nr_seq_lote = nr_sequencia_p or nr_seq_lote_exc = nr_sequencia_p)) alias9;
	end;
end if;

return	nr_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_dados_lote_cobranca ( nr_sequencia_p bigint, ie_opcao_p text) FROM PUBLIC;

