-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_metodo_junit (nr_seq_acao_p bigint, ie_acao_p text) RETURNS varchar AS $body$
DECLARE


ds_retorno_w  		  varchar(500);

ie_campo_trata_mensagem_w varchar(1);


nr_seq_objeto_w				caso_teste_execucao.nr_seq_objeto%type;
nm_tabela_w					caso_teste_execucao.nm_tabela%type;
nr_seq_visao_w				caso_teste_execucao.nr_seq_visao%type;
nm_atributo_w				caso_teste_execucao.nm_atributo%type;
ie_acao_handler_w			caso_teste_execucao.ie_acao_handler%type;
ds_valor_w					caso_teste_execucao.ds_valor%type;
ds_valor_ingles_w			caso_teste_execucao.ds_valor_ingles%type;
ds_valor_espanhol_w			caso_teste_execucao.ds_valor_espanhol%type;
nr_sequencia_w				caso_teste_execucao.nr_sequencia%type;
ie_campo_paciente_w			caso_teste_execucao.ie_campo_paciente%type;
nr_seq_objeto_atributo_w	caso_teste_execucao.nr_seq_objeto_atributo%type;
nr_seq_obj_filtro_w			caso_teste_execucao.nr_seq_obj_filtro%type;
ie_ultimo_gerado_w			caso_teste_execucao.ie_ultimo_gerado%type;
ds_ultimo_gerado_w			varchar(5);

nr_seq_pacote_teste_w	caso_teste_acao.nr_seq_pacote_teste%type;
cd_funcao_chamada_w		caso_teste_acao.cd_funcao_chamada%type;

nm_campo_base_w			varchar(100);

ie_consiste_mensagem_w	  varchar(6);

cd_funcao_w		caso_teste.cd_funcao%type;


c01 CURSOR FOR
	SELECT	nr_seq_objeto,
			nm_tabela,
			nr_seq_visao,
			nm_atributo,
			ie_acao_handler,
			REPLACE(REPLACE(ds_valor,'\','\\'),'"','\"') ds_valor,
			REPLACE(REPLACE(ds_valor_ingles,'\','\\'),'"','\"') ds_valor_ingles,
			REPLACE(REPLACE(ds_valor_espanhol,'\','\\'),'"','\"') ds_valor_espanhol,
			nr_sequencia,
			ie_campo_paciente,
			nr_seq_objeto_atributo,
			nr_seq_obj_filtro,
			ie_ultimo_gerado,
			null nr_seq_pacote_teste,
			null cd_funcao_chamada
	from	caso_teste_execucao
	where	nr_seq_acao = nr_seq_acao_p
	
union

	SELECT	null nr_seq_objeto,
			null nm_tabela,
			null nr_seq_visao,
			null nm_atributo,
			null ie_acao_handler,
			null ds_valor,
			null ds_valor_ingles,
			null ds_valor_espanhol,
			null nr_sequencia,
			null ie_campo_paciente,
			null nr_seq_objeto_atributo,
			null nr_seq_obj_filtro,
			null ie_ultimo_gerado,
			nr_seq_pacote_teste,
			cd_funcao_chamada
	from	caso_teste_acao
	where	nr_sequencia = nr_seq_acao_p
	and not exists (select	1
					from	caso_teste_execucao
					where 	nr_seq_acao = nr_seq_acao_p)
	order by nr_sequencia;


BEGIN

open c01;
loop
fetch c01 into
	nr_seq_objeto_w,
	nm_tabela_w,
	nr_seq_visao_w,
	nm_atributo_w,
	ie_acao_handler_w,
	ds_valor_w,
	ds_valor_ingles_w,
	ds_valor_espanhol_w,
	nr_sequencia_w,
	ie_campo_paciente_w,
	nr_seq_objeto_atributo_w,
	nr_seq_obj_filtro_w,
	ie_ultimo_gerado_w,
	nr_seq_pacote_teste_w,
	cd_funcao_chamada_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
	begin
	if 	((ie_acao_p = '1') or (ie_acao_p = '28')) then
		ds_retorno_w := '        digitarCampo("'||nr_seq_visao_w||'", "'||nm_atributo_w||'", "'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'");';
	elsif (ie_acao_p = '2') then

		case(ie_acao_handler_w)
		when '1' then
			ds_retorno_w := '        botaoClique(BotaoHandle.NOVO);';
		when '2' then
			ds_retorno_w := '        botaoClique(BotaoHandle.DETALHE);';
		when '3' then
			ds_retorno_w := '        botaoClique(BotaoHandle.GRID);';
		when '4' then
			ds_retorno_w := '        botaoClique(BotaoHandle.EXCLUIR);';
		when '5' then
			ds_retorno_w := '        botaoClique(BotaoHandle.DESFAZER);';
		when '6' then
			ds_retorno_w := '        botaoClique(BotaoHandle.SALVAR);';
		when '7' then
			ds_retorno_w := '        botaoClique(BotaoHandle.VISUALIZAR);';
		when '8' then
			ds_retorno_w := '        botaoClique(BotaoHandle.IMPRIMIR);';
		when '9' then
			ds_retorno_w := '        botaoClique(BotaoHandle.FECHAR);';
		when '10' then			--Sim
			ds_retorno_w := '        botaoClique("'|| lower(wheb_mensagem_pck.get_texto(419751)) ||'");';
		when '11' then			--Não
			ds_retorno_w := '        botaoClique("'|| lower(wheb_mensagem_pck.get_texto(419753)) ||'");';
		when '12' then			--Ok
			ds_retorno_w := '        botaoClique("'|| wheb_mensagem_pck.get_texto(419755) ||'");';
		when '13' then			--Cancelar
			ds_retorno_w := '        botaoClique("'|| wheb_mensagem_pck.get_texto(445342) ||'");';
		when '14' then
			ds_retorno_w := '        botaoClique(BotaoHandle.CONSULTAR);';
		when '15' then
			ds_retorno_w := '        botaoClique(BotaoHandle.CALCULAR);';
		when '16' then
			ds_retorno_w := '        botaoClique(BotaoHandle.LOCALIZAR);';
		when '17' then
			ds_retorno_w := '        botaoClique(BotaoHandle.LIBERAR);';
		END CASE;


		--Opções não tratada na Ação "Clicar no Botão"
		-- 10 Sim
		-- 11 Não
		-- 12 Ok
	elsif (ie_acao_p = '3') then
		ds_retorno_w := '        mouseLadoDireito("'||nr_seq_visao_w||'", "'||nr_seq_objeto_w||'");';

	elsif (ie_acao_p = '4') then
		ds_retorno_w := '        verificaValorCampo("'||nr_seq_visao_w||'", "'||nm_atributo_w||'", "'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'");';

		-- 5 utilizar pacote
	elsif (ie_acao_p = '6') then
		if (coalesce(ds_valor_w::text, '') = '') then
		        ds_retorno_w := '        clickTab('||obter_cod_pasta_concat_localiz(nr_seq_objeto_w)||');';
		else
		        ds_retorno_w := '        clickTabString("'||ds_valor_w||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'");';
		end if;
	elsif (ie_acao_p = '7') then
		select CASE WHEN ie_ultimo_gerado_w='S' THEN  'true'  ELSE 'false' END
		into STRICT ds_ultimo_gerado_w
		;

		if (ie_campo_paciente_w = '1') then
			ds_retorno_w := '        ativarPaciente("NR_PRESCRICAO", "'||ds_valor_w||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'", '|| ds_ultimo_gerado_w ||'); ';
		elsif (ie_campo_paciente_w = '2') then
			ds_retorno_w := '        ativarPaciente("NR_ATENDIMENTO", "'||ds_valor_w||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'", '|| ds_ultimo_gerado_w ||'); ';
		elsif (ie_campo_paciente_w = '3') then
			ds_retorno_w := '        ativarPaciente("NR_CIRURGIA", "'||ds_valor_w||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'", '|| ds_ultimo_gerado_w ||'); ';
		elsif (ie_campo_paciente_w = '4') then
			ds_retorno_w := '        localizarPacientePeloNome("'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'"); ';
		end if;
	elsif (ie_acao_p = '8') then
		ds_retorno_w := '        clicaNodoArvore("'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'");';
	elsif (ie_acao_p = '29') then
		ds_retorno_w := '        duploCliqueNodoArvore("'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'");';
	elsif (ie_acao_p = '9') then
		ds_retorno_w := '        selecionarRegistroDBPanel("'||nr_seq_visao_w||'", "'||nm_atributo_w||'", "'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'");';
	elsif (ie_acao_p = '10') then
		ds_retorno_w := '        delay('||ds_valor_w||');';
	elsif (ie_acao_p = '11') then
		if (ds_valor_w IS NOT NULL AND ds_valor_w::text <> '') then
			ie_consiste_mensagem_w := 'false';
		else
			ie_consiste_mensagem_w := 'false';
		end if;

		if (ie_acao_handler_w = '10') then		--wheb_mensagem_pck.get_texto(419751);
			ds_retorno_w := '        mensagemDialog("'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'", "'|| wheb_mensagem_pck.get_texto(419751) ||'" , '||ie_consiste_mensagem_w||');';
		elsif (ie_acao_handler_w = '11') then	--wheb_mensagem_pck.get_texto(419753);
			ds_retorno_w := '        mensagemDialog("'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'", "'|| wheb_mensagem_pck.get_texto(419753) ||'" , '||ie_consiste_mensagem_w||');';
		elsif (ie_acao_handler_w = '12') then	--wheb_mensagem_pck.get_texto(419755);
			ds_retorno_w := '        mensagemDialog("'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'", "'|| wheb_mensagem_pck.get_texto(419755) ||'" , '||ie_consiste_mensagem_w||');';
		elsif (ie_acao_handler_w = '13') then	--wheb_mensagem_pck.get_texto(445342);
			ds_retorno_w := '        mensagemDialog("'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'", "'|| wheb_mensagem_pck.get_texto(445342) ||'" , '||ie_consiste_mensagem_w||');';
		end if;
	elsif (ie_acao_p = '12') then
		ds_retorno_w := '        mensagemErro();';
	elsif (ie_acao_p = '13') then
		ds_retorno_w := '        verificaWDLGAberto("'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'");';
	elsif (ie_acao_p = '14') then
		ds_retorno_w := '        verificaFuncaoAtiva("'||obter_desc_funcao(cd_funcao_chamada_w)||'", "'||obter_desc_form(cd_funcao_chamada_w)||'");';
	elsif (ie_acao_p = '15') then
		ds_retorno_w := '        selecionarDBPanel("'||nr_seq_visao_w||'");';
	elsif (ie_acao_p = '16') then
		select coalesce(MAX(nm_atributo),'')
		into STRICT nm_campo_base_w
		from dic_objeto_filtro
		where nr_sequencia = nr_seq_obj_filtro_w;

		if (nm_campo_base_w IS NOT NULL AND nm_campo_base_w::text <> '') then
			ds_retorno_w := '        utilizarFiltro("'||nr_seq_objeto_w||'", "'||nm_campo_base_w||'", "'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'");';
		end if;
	elsif (ie_acao_p = '17') then
		ds_retorno_w := '        atualizarFiltro();';
	elsif (ie_acao_p = '18') then
		ds_retorno_w := '        login();';
	elsif (ie_acao_p = '19') then
		ds_retorno_w := '        fecharFuncao("'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'");';
	elsif (ie_acao_p = '20') then
		ds_retorno_w := '        duploCliqueRegistroDBPanel("'||nr_seq_visao_w||'", "'||nm_atributo_w||'", "'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'");';
	elsif (ie_acao_p = '21') then
		ds_retorno_w := '        selecionarWCPanel("'||nr_seq_objeto_w||'");';
	elsif (ie_acao_p = '22') then
		select coalesce(MAX(nm_campo_base),'')
		into STRICT nm_campo_base_w
		from dic_objeto
		where nr_sequencia = nr_seq_objeto_atributo_w;

		if (nm_campo_base_w IS NOT NULL AND nm_campo_base_w::text <> '') then
			ds_retorno_w := '        duploCliqueRegistroWCPanel("'||nr_seq_objeto_w||'", "'||nm_campo_base_w||'", "'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'");';
		end if;
	elsif (ie_acao_p = '23') then
		select coalesce(MAX(nm_campo_base),'')
		into STRICT nm_campo_base_w
		from dic_objeto
		where nr_sequencia = nr_seq_objeto_atributo_w;

		if (nm_campo_base_w IS NOT NULL AND nm_campo_base_w::text <> '') then
			ds_retorno_w := '        selecionarRegistroWCPanel("'||nr_seq_objeto_w||'", "'||nm_campo_base_w||'", "'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'");';
		end if;
	elsif (ie_acao_p = '24') then
		ds_retorno_w := '        selecionarCheckBoxWSelecao("'||obter_valor_macro_junit(ds_valor_w)||'", "'||obter_valor_macro_junit(ds_valor_ingles_w)||'", "'||obter_valor_macro_junit(ds_valor_espanhol_w)||'");';
	elsif (ie_acao_p = '25') then
		ds_retorno_w := '        simularAcaoTeclado("'|| lower(ds_valor_w) ||'");';
	elsif (ie_acao_p = '26') then
		ds_retorno_w := '        duploCliqueComponente("'||nr_seq_visao_w||'", "'||nm_atributo_w||'");';
	elsif (ie_acao_p = '27') then
		select coalesce(MAX(nm_atributo),'')
		into STRICT nm_campo_base_w
		from dic_objeto_filtro
		where nr_sequencia = nr_seq_obj_filtro_w;

		if (nm_campo_base_w IS NOT NULL AND nm_campo_base_w::text <> '') then
			ds_retorno_w := '        duploCliqueComponenteFiltro("'||nr_seq_objeto_w||'", "'||nm_campo_base_w||'");';
		end if;
	end if;

	end;
end loop;
close c01;

return	ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_metodo_junit (nr_seq_acao_p bigint, ie_acao_p text) FROM PUBLIC;

