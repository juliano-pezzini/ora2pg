-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION get_description_object ( ie_type_object_p text, nr_seq_dic_object_p bigint, nr_seq_vision_p bigint, cd_expression_default_p bigint, ds_text_default_p text default null) RETURNS varchar AS $body$
DECLARE


ds_object_description_w	varchar(255);
ds_object_type_w	varchar(255) := '';


BEGIN

if (ie_type_object_p IS NOT NULL AND ie_type_object_p::text <> '') then
	begin
	if (ie_type_object_p = 'WDBP') then
		begin
		select 	substr(max(obter_desc_expressao(cd_exp_titulo)),1,255)
		into STRICT	ds_object_description_w
		from	tabela_visao
		where	nr_sequencia = nr_seq_vision_p;
		end;
	elsif (ie_type_object_p = 'WCP') then
		begin
		select	substr(max(obter_desc_expressao(cd_exp_texto)),1,255)
		into STRICT	ds_object_description_w
		from	dic_objeto
		where	nr_sequencia = nr_seq_dic_object_p;
		end;
	elsif (ie_type_object_p = 'WDF') then
		begin
		select	substr(max(obter_desc_expressao(cd_exp_texto)),1,255)
		into STRICT	ds_object_description_w
		from	dic_objeto
		where	nr_sequencia = nr_seq_dic_object_p;
		end;
	elsif (ie_type_object_p = 'WF') then
		begin
		select	substr(max(obter_desc_expressao(cd_exp_texto)),1,255)
		into STRICT	ds_object_description_w
		from	dic_objeto
		where	nr_sequencia = nr_seq_dic_object_p;
		end;
	end if;
	end;
end if;

if (coalesce(ds_object_description_w::text, '') = '') and (cd_expression_default_p IS NOT NULL AND cd_expression_default_p::text <> '') then
	begin
	ds_object_description_w := obter_desc_expressao(cd_expression_default_p);
	end;
end if;

if (coalesce(ds_object_description_w::text, '') = '') and (ds_text_default_p IS NOT NULL AND ds_text_default_p::text <> '') then
	begin
	ds_object_description_w := substr(ds_text_default_p,1,255);
	end;
end if;

if (ie_type_object_p = 'WDF') then
	ds_object_type_w := obter_desc_expressao(787609) || ': ';
elsif (ie_type_object_p = 'WCP') then
	ds_object_type_w := obter_desc_expressao(292631) || ': ';
elsif (ie_type_object_p = 'WDBP') then
	ds_object_type_w := obter_desc_expressao(314879) || ': ';
elsif (ie_type_object_p = 'WF') then
	ds_object_type_w := obter_desc_expressao(290098) || ': ';
elsif (ie_type_object_p = 'WPOPUP') then
	ds_object_type_w := obter_desc_expressao(488938) || ': ' || obter_desc_expressao(316320);
	ds_object_description_w := '';
elsif (ie_type_object_p in ('T', 'TVN', 'IT', 'VMI', 'MN', 'DDM', 'TDDM')) then
	ds_object_type_w := obter_desc_expressao(646431) || ': ';
elsif (ie_type_object_p = 'WDLG') then
	ds_object_type_w := obter_desc_expressao(787627) || ': ';
end if;

return ds_object_type_w || ds_object_description_w;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION get_description_object ( ie_type_object_p text, nr_seq_dic_object_p bigint, nr_seq_vision_p bigint, cd_expression_default_p bigint, ds_text_default_p text default null) FROM PUBLIC;

