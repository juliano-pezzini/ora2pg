-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_select_comp_paciente (vl_dominio_p text, nr_atendimento_p bigint, cd_pessoa_fisica_p text) RETURNS varchar AS $body$
DECLARE


vl_dominio_w varchar(255);
vl_retorno_w varchar(2000);
ds_union_w varchar(100) := 'union all' || CHR(13)||CHR(10);
ds_enter_w varchar(10)  := CHR(13) || CHR(10);


BEGIN
vl_retorno_w := '';

IF (vl_dominio_p = 'FIO2') THEN
	vl_retorno_w := 'substr(obter_monit_respiratoria(:nr_atendimento,''FIO2''),1,10)';
ELSIF (vl_dominio_p = 'PEEP') THEN
	vl_retorno_w := 'substr(obter_monit_respiratoria(:nr_atendimento,''PEEP''),1,10)';
--elsif (vl_dominio_p = 'VPP') then
--	vl_retorno_w := 'substr(obter_variacao_peso_pac(:cd_pessoa_fisica),1,255)';
ELSIF (vl_dominio_p = 'TI/TE') THEN
	vl_retorno_w := 'substr(obter_monit_respiratoria(:nr_atendimento,''TI/TE''),1,10)';
ELSIF (vl_dominio_p = 'TITE') THEN
	vl_retorno_w := 'substr(obter_monit_respiratoria(:nr_atendimento,''TITE''),1,10)';
ELSIF (vl_dominio_p = 'CUFFMMHG') THEN
	vl_retorno_w := 'substr(obter_monit_respiratoria(:nr_atendimento,''CUFFMMHG''),1,10)';
ELSIF (vl_dominio_p = 'VPP') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(322055); --'Variação de peso do paciente';
	vl_retorno_w := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || 'substr(obter_variacao_peso_pac(:cd_pessoa_fisica),1,255) ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39)
				   || 'ie_tipo,' || ds_enter_w || 'obter_dt_ultimo_sinal_vital_pf(:cd_pessoa_fisica) ' || ds_enter_w || 'from dual where obter_variacao_peso_pac(:cd_pessoa_fisica) is not null ';
ELSIF (vl_dominio_p = 'DEF') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309853); --'Deficiências do paciente';
	vl_retorno_w := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || 'substr(obter_deficiencia_paciente(:cd_pessoa_fisica),1,255) ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39)
				   || 'ie_tipo,' || ds_enter_w || 'sysdate ' || ds_enter_w || 'from dual';
ELSIF (vl_dominio_p = 'DP') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309854); --'Delta Peso';
	vl_Retorno_W := Ds_Union_W || 'select 100 nr_seq_apresent,' || Ds_Enter_W || '0,' || Ds_Enter_W || CHR(39)|| Vl_Dominio_W || CHR(39) || ',' || Ds_Enter_W
				   || 'to_char(A.QT_DELTA_PESO),'|| Ds_Enter_W || CHR(39) || Vl_Dominio_W || CHR(39) || 'ie_tipo,' || Ds_Enter_W || 'sysdate '
				   || ds_enter_w || 'from atendimento_sinal_vital a where a.cd_paciente = :cd_pessoa_fisica and a.nr_sequencia = (select max(x.nr_sequencia) from atendimento_sinal_vital x where x.cd_paciente = :cd_pessoa_fisica) ';
ELSIF (vl_dominio_p = 'NOMESOCIAL') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309855); --'Nome Social';
	vl_Retorno_W := Ds_Union_W || 'select 100 nr_seq_apresent,' || Ds_Enter_W || '0,' || Ds_Enter_W || CHR(39)|| Vl_Dominio_W || CHR(39) || ',' || Ds_Enter_W
				   || 'NM_SOCIAL' || ' ds_informacao,' || Ds_Enter_W || CHR(39) || Vl_Dominio_W || CHR(39) || 'ie_tipo,' || Ds_Enter_W || 'sysdate '
				   || ds_enter_w || 'from pessoa_fisica where cd_pessoa_fisica = :cd_pessoa_fisica and nm_social is not null';
ELSIF (vl_dominio_p = 'CLINICA') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309857); --'Clínica';
	vl_retorno_w := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || 'substr(obter_valor_dominio(17,ie_tipo_atendimento),1,30)' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39)
				   || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   || ds_enter_w || 'from atendimento_paciente where nr_atendimento = :nr_atendimento';
ELSIF (vl_dominio_p = 'PLANO') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309858); --'Plano';
	vl_retorno_w := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || 'substr(Obter_Desc_Plano_Conv(cd_convenio, cd_plano_convenio),1,30)' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39)
				   || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   || ds_enter_w || 'from atend_categoria_convenio where nr_atendimento = :nr_atendimento and nr_seq_interno = Obter_Atecaco_atendimento(:nr_atendimento)';
ELSIF (vl_dominio_p = 'DGCU') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309859); --'Data última HGT';
	vl_retorno_w :=	ds_union_w ||'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   ||'to_char(max(dt_sinal_vital),''dd/mm/yyyy hh24:mi:ss'')'|| ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39)
				   || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   ||ds_enter_w||'from atendimento_sinal_vital where nr_Atendimento = :nr_Atendimento and
				   glicemia_capilar is not null';
ELSIF (vl_dominio_p = 'DGCP') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309860); --'Data 1° HGT';
	vl_retorno_w :=	ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   ||'to_char(min(dt_sinal_vital),''dd/mm/yyyy hh24:mi:ss'')' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39)
				   || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   ||ds_enter_w||'from atendimento_sinal_vital where nr_Atendimento = :nr_Atendimento and qt_glicemia_capilar is not null';
ELSIF (vl_dominio_p = 'GCP') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309861); --'1° Glicemia capilar';
	vl_retorno_w :=	ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   ||'to_char(substr(qt_glicemia_capilar || '' ''|| obter_valor_dominio(4398,IE_GLIC_EXTRAPOL),1,255))'|| ' ds_informacao,' || ds_enter_w
				   || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   ||ds_enter_w||' from atendimento_sinal_vital e where e.nr_sequencia = (select min(q.nr_sequencia)from atendimento_sinal_vital q '
				   ||' where q.nr_Atendimento = :nr_Atendimento and q.qt_glicemia_capilar is not null) ';
ELSIF (vl_dominio_p = 'CAMED') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309864); --'Classif atuação médico';
	vl_retorno_w :=	ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   ||'e.ds_classificacao'|| ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   ||ds_enter_w||' from medico_classif_atend e where e.nr_sequencia = (select max(q.nr_seq_classif_medico) from atendimento_paciente q '
				   ||' where q.nr_Atendimento = :nr_Atendimento and q.nr_seq_classif_medico is not null) ';
ELSIF (vl_dominio_p = 'NVLURG') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309866); --'Nível de urgência';
	vl_retorno_w :=	ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   ||'substr(nvl(max(substr(obter_desc_triagem(nr_seq_triagem),1,60)), obter_desc_expressao(327119)),1,100)' || ' ds_informacao,' || ds_enter_w
				   || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   ||ds_enter_w||'from atendimento_paciente where nr_Atendimento = :nr_Atendimento';
ELSIF (vl_dominio_p = 'CNS') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309867); --'Cartão Nacional de Saúde';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || 'NR_CARTAO_NAC_SUS' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   || ds_enter_w || 'from pessoa_fisica where cd_pessoa_fisica = :cd_pessoa_fisica';
ELSIF (vl_dominio_p = 'PSP') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309868); --'PA sist em pé (HD)';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(hd_obter_dados_dialise(HD_Obter_Hemodialise_Atual(:cd_pessoa_fisica,''U''),''PSP''),1,255) ' || ' ds_informacao,'
				   || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   || ds_enter_w || ' from dual ';
ELSIF (vl_dominio_p = 'PDP') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309869); --'PA diast em pé (HD)';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(hd_obter_dados_dialise(HD_Obter_Hemodialise_Atual(:cd_pessoa_fisica,''U''),''PDP''),1,255) ' || ' ds_informacao,'
				   || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   || ds_enter_w || ' from dual ';
ELSIF (vl_dominio_p = 'PSD') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309870); --'PA sist sentado (HD)';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(hd_obter_dados_dialise(HD_Obter_Hemodialise_Atual(:cd_pessoa_fisica,''U''),''PSD''),1,255) ' || ' ds_informacao,'
				   || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   || ds_enter_w || ' from dual ';
ELSIF (vl_dominio_p = 'PDD') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309871); --'PA diast sentado (HD)';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(hd_obter_dados_dialise(HD_Obter_Hemodialise_Atual(:cd_pessoa_fisica,''U''),''PDD''),1,255) ' || ' ds_informacao,'
				   || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   || ds_enter_w || ' from dual ';
ELSIF (vl_dominio_p = 'CORPELE') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309872); --'Raça/Cor';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(obter_desc_cor_pele(nr_seq_cor_pele),1,255) ' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39)
				   || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   || ds_enter_w || ' from pessoa_fisica where cd_pessoa_fisica = :cd_pessoa_fisica';
ELSIF (vl_dominio_p = 'EC') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309873); --'Estado civil';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(obter_valor_dominio(5,obter_dados_pf(cd_pessoa_fisica,''EC'')),1,10) ' || ' ds_informacao,'
				   || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   || ds_enter_w || ' from pessoa_fisica where cd_pessoa_fisica = :cd_pessoa_fisica';
ELSIF (vl_dominio_p = 'OBT') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309874); --'Observação triagem';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(ds_observacao,1,255) ' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   || ds_enter_w || ' from triagem_pronto_atend where nr_sequencia = (select max(nr_sequencia) from triagem_pronto_atend where nr_atendimento = :nr_atendimento)';
ELSIF (vl_dominio_p = 'GP') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309875); --'Grupos do paciente';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(obter_desc_grupo_atend_pac(nr_seq_grupo),1,255) ' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'MAX(dt_entrada) dt_entrada '
				   || ds_enter_w || ' from pac_grupo_atend where cd_pessoa_fisica = :cd_pessoa_fisica GROUP BY nr_seq_grupo';
ELSIF (vl_dominio_p = 'UGP') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309876); --'Último grupo do paciente';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(obter_desc_grupo_atend_pac(a.nr_seq_grupo),1,255) ' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'dt_entrada '
				   || ds_enter_w || ' from pac_grupo_atend a  where a.cd_pessoa_fisica = :cd_pessoa_fisica and a.nr_sequencia = (select max(b.nr_sequencia) from pac_grupo_atend b where b.cd_pessoa_fisica = :cd_pessoa_fisica) ';
ELSIF (vl_dominio_p = 'UDT') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309877); --'Último diag de tumor';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(Obter_Dados_Loco_Regional(:cd_pessoa_fisica,5),1,255) ' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   || ds_enter_w || ' from dual ';
ELSIF (vl_dominio_p = 'OBSAE') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309878); --'Observação última SAE';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(ds_observacao,1,255) ' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   || ds_enter_w || ' from pe_prescricao where nr_sequencia = (select max(nr_sequencia) from pe_prescricao where nr_atendimento = :nr_atendimento)';
ELSIF (vl_dominio_p = 'APACHEII') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309880); --'Apache II';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' to_char(qt_apache_II) ' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'dt_liberacao '
				   || ds_enter_w || ' from apache where nr_sequencia = (select max(nr_sequencia) from apache where nr_atendimento = :nr_atendimento ) ';
ELSIF (vl_dominio_p = 'APACHEIIRIS') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309881); --'Apache II - Risco de óbito';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' to_char(qt_risco_calculado) ' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'dt_liberacao '
				   || ds_enter_w || ' from apache where nr_sequencia = (select max(nr_sequencia) from apache where nr_atendimento = :nr_atendimento ) ';
ELSIF (vl_dominio_p = 'SOFA') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309882); --'SOFA';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' to_char(qt_pontuacao) ' || ' ds_informacao,' ||  ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'dt_liberacao  '
				   || ds_enter_w || ' from escala_sofa where nr_sequencia = (select max(nr_sequencia) from escala_sofa where nr_atendimento = :nr_atendimento ) ';
ELSIF (vl_dominio_p = 'CPIS') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309883); --'CPIS';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(obter_resultado_cpis(qt_pontuacao),1,100) ' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'dt_liberacao '
				   || ds_enter_w || ' from cpis_atendimento where nr_sequencia = (select max(nr_sequencia) from cpis_atendimento where nr_atendimento = :nr_atendimento ) ';
ELSIF (vl_dominio_p = 'PAO2FIO2') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(309884); --'PAO2/FIO2';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' to_char(qt_rel_pao2_fio2) ' || ' ds_informacao,' ||  ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'dt_liberacao '
				   || ds_enter_w || ' from atendimento_monit_resp where nr_sequencia = (select max(nr_sequencia) from atendimento_monit_resp where nr_atendimento = :nr_atendimento ) ';
ELSIF (vl_dominio_p = 'SENHA') THEN
	vl_dominio_w := SUBSTR(obter_desc_expressao(631968, NULL),1,255);
	vl_retorno_w := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' cd_senha ' || ' ds_informacao,' || ds_enter_w || CHR(39) ||
				   vl_dominio_w || CHR(39)   || 'ie_tipo,' || ds_enter_w || ' dt_atualizacao '
				   || ds_enter_w || 'from atend_categoria_convenio where nr_seq_interno = Obter_Atecaco_atendimento(:nr_atendimento)';
ELSIF (vl_dominio_p = 'PESOPAC') THEN
	vl_dominio_w := SUBSTR(obter_desc_expressao(322220, NULL),1,255);
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' to_char(qt_peso) ' || ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39)
				   || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   || ds_enter_w || ' from pessoa_fisica where cd_pessoa_fisica = :cd_pessoa_fisica';
ELSIF (vl_dominio_p = 'SNAPPEII') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(336211); --'SNAPPEII'
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' 		|| ds_enter_w
				   || 'substr(substr(Wheb_mensagem_pck.get_texto(336321),1,255)||'': ''|| replace(to_char(QT_SNAPPE_II,''990D00''),'' '','''') '
				   || '|| '' / '' ||substr(Wheb_mensagem_pck.get_texto(336322),1,255) ||'': ''||  replace(to_char(PR_MORTALIDADE,''990D00''),'' '',''''),1,255) ds_informacao,'
				   ||  ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'dt_liberacao  '
				   ||  ds_enter_w || ' from ESCALA_SNAPII_SNAPPEII where nr_sequencia = (select max(nr_sequencia) from ESCALA_SNAPII_SNAPPEII where nr_atendimento = :nr_atendimento ) ';
ELSIF (vl_dominio_p = 'NBS') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(336212); --'NBS'
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(OBTER_RESULT_NBS(qt_pontuacao),1,60) ' || ' ds_informacao,'||  ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'dt_liberacao  '
				   || ds_enter_w || ' from ESCALA_NBS where nr_sequencia = (select max(nr_sequencia) from ESCALA_NBS where nr_atendimento = :nr_atendimento ) ';
ELSIF (vl_dominio_p = 'CAMICU') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(340799); --'CAM-ICU Modificada'
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' substr(obter_result_CAM_ICU(ie_alt_estado_mental,ie_comport_anormal,ie_focar_atencao,ie_distraido,null,null,''S'',ie_pedra_flutuam,ie_peixe_mar,ie_quilograma,ie_martelo_madeira,ie_agitado,ie_letagico,ie_estuporoso,ie_camatoso),1,255) ' || 'ds_informacao,'||
					ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'dt_liberacao  '
				   || ds_enter_w || ' FROM ESCALA_CAM_ICU WHERE NR_SEQUENCIA = (SELECT MAX(NR_SEQUENCIA) FROM ESCALA_CAM_ICU WHERE nr_atendimento = :nr_atendimento ) ';
ELSIF (vl_dominio_p = 'CLASPF')	THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(308868); --'Classificação'
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
					|| ' SUBSTR(obter_classif_pessoa(nr_seq_classif),1,255) ' || 'ds_informacao,'||
					ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'DT_INICIO_VIGENCIA  '
					|| ds_enter_w || ' FROM PESSOA_CLASSIF WHERE cd_pessoa_fisica = :cd_pessoa_fisica AND obter_se_classif_exibe_quimio(NR_SEQ_CLASSIF) = ''S'' AND (SYSDATE BETWEEN DT_INICIO_VIGENCIA AND DT_final_vigencia OR (dt_inicio_vigencia < SYSDATE AND DT_final_vigencia IS NULL)) ';
ELSIF (vl_dominio_p = 'MORSE') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(445223); --'MORSE';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' SubStr(Obter_desc_escala_morse(qt_pontuacao), 1, 20) ' || ' ds_informacao,' ||  ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'dt_liberacao  '
				   || ds_enter_w || ' from escala_morse where nr_sequencia = (select max(nr_sequencia) from escala_morse where nr_atendimento = :nr_atendimento and dt_liberacao is not null and dt_inativacao is null) ';
ELSIF (vl_dominio_p = 'MEWS') THEN
	vl_dominio_w := SUBSTR(obter_desc_expressao(313971, NULL),1,255); --'MEWS';
	vl_Retorno_W := ds_union_w || 'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   || ' to_char(qt_pontuacao) ' || ' ds_informacao,' ||  ds_enter_w || CHR(39) || vl_dominio_w || CHR(39) || 'ie_tipo,' || ds_enter_w || 'dt_liberacao  '
				   || ds_enter_w || ' from escala_mews where nr_sequencia = (select max(nr_sequencia) from escala_mews where nr_atendimento = :nr_atendimento and dt_liberacao is not null and dt_inativacao is null) ';
ELSIF (vl_dominio_p = 'DTPAL') THEN
	vl_dominio_w := Wheb_mensagem_pck.get_texto(314152); --'Previsão de alta';
	vl_retorno_w :=	ds_union_w ||'select 100 nr_seq_apresent,' || ds_enter_w || '0,' || ds_enter_w || CHR(39)|| vl_dominio_w || CHR(39) || ',' || ds_enter_w
				   ||'to_char(max(dt_previsto_alta),''dd/mm/yyyy hh24:mi:ss'')'|| ' ds_informacao,' || ds_enter_w || CHR(39) || vl_dominio_w || CHR(39)
				   || 'ie_tipo,' || ds_enter_w || 'sysdate '
				   ||ds_enter_w||'from atendimento_paciente where nr_Atendimento = :nr_Atendimento';
END IF;

IF (vl_retorno_w IS NOT NULL AND vl_retorno_w::text <> '')     AND (vl_dominio_p <> 'NOMESOCIAL') AND (vl_dominio_p <> 'PESOPAC')	  AND (vl_dominio_p <> 'CLINICA')    AND (vl_dominio_p <> 'PLANO') 	  AND (vl_dominio_p <> 'DGCU')       AND (vl_dominio_p <> 'DGCP')       AND (vl_dominio_p <> 'GCP')        AND (vl_dominio_p <> 'CAMED')      AND (vl_dominio_p <> 'NVLURG')     AND (vl_dominio_p <> 'CNS')        AND (vl_dominio_p <> 'PSP') 	  AND (vl_dominio_p <> 'PDP') 	  AND (vl_dominio_p <> 'PSD')	  AND (vl_dominio_p <> 'PDD') 	  AND (vl_dominio_p <> 'CORPELE')    AND (vl_dominio_p <> 'EC') 	  AND (vl_dominio_p <> 'OBT') 	  AND (vl_dominio_p <> 'DP') 	  AND (vl_dominio_p <> 'DEF') 	  AND (vl_dominio_p <> 'OBSAE') 	  AND (vl_dominio_p <> 'APACHEII')   AND (vl_dominio_p <> 'CPIS') 	  AND (vl_dominio_p <> 'APACHEIIRIS')AND (vl_dominio_p <> 'SOFA') 	  AND (vl_dominio_p <> 'PAO2FIO2')   AND (vl_dominio_p <> 'GP') 	  AND (vl_dominio_p <> 'UGP') 	  AND (vl_dominio_p <> 'SENHA') 	  AND (vl_dominio_p <> 'VPP') 	  AND (vl_dominio_p <> 'UDT')	  AND (vl_dominio_p <> 'NBS') 	  AND (vl_dominio_p <> 'CAMICU') 	  AND (vl_dominio_p <> 'CLASPF') 	  AND (vl_dominio_p <> 'SNAPPEII')	  AND (vl_dominio_p <> 'MEWS')	  AND (vl_dominio_p <> 'DTPAL')	  AND (vl_dominio_p <> 'MORSE') 	  THEN
 BEGIN
vl_retorno_w := ds_union_w || 'select ' || '100 nr_seq_apresent,' || ds_enter_w
			   ||'0,' || ds_enter_w
			   || CHR(39) || vl_dominio_p || CHR(39) || ',' || ds_enter_w
			   || vl_retorno_w || ' ds_informacao,' || ds_enter_w
			   || CHR(39) || vl_dominio_p || CHR(39) || 'ie_tipo,' || ds_enter_w
			   || 'sysdate ' || ds_enter_w
			   || 'from dual';
 END;
END IF;

RETURN vl_retorno_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_select_comp_paciente (vl_dominio_p text, nr_atendimento_p bigint, cd_pessoa_fisica_p text) FROM PUBLIC;

