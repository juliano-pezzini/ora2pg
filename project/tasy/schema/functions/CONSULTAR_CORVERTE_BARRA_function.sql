-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION consultar_corverte_barra ( cd_operacao_p bigint, nr_sequencia_p bigint, cd_procedimento_p bigint, ie_origem_proced_p bigint) RETURNS varchar AS $body$
DECLARE

	cd_procedimento_w	bigint;
	ds_procedimento_w	varchar(200) := '';
	ie_origem_proced_w	bigint;
	cd_exame_w		bigint;
	nm_exame_w		varchar(200);
	qt_exec_barra_w		bigint;

BEGIN

if (cd_operacao_p = 1) then
	begin
	if (nr_sequencia_p IS NOT NULL AND nr_sequencia_p::text <> '') then
		begin
		select 	cd_procedimento,
			ie_origem_proced,
			cd_exame,
			nm_exame
		into STRICT	cd_procedimento_w,
			ie_origem_proced_w,
			cd_exame_w,
			nm_exame_w
		from 	exame_laboratorio
		where 	nr_seq_exame = nr_sequencia_p;
		end;
	end if;
	end;
elsif (cd_operacao_p = 2) then
	begin
	if (nr_sequencia_p IS NOT NULL AND nr_sequencia_p::text <> '') then
		begin
		select 	a.cd_procedimento,
			a.ie_origem_proced,
			a.ds_proc_exame
		into STRICT	cd_procedimento_w,
			ie_origem_proced_w,
			ds_procedimento_w
		from   	procedimento b,
			proc_interno a
		where  	a.cd_procedimento = b.cd_procedimento
		and    	a.ie_origem_proced = b.ie_origem_proced
		and    	a.nr_sequencia = nr_sequencia_p;
		end;
	end if;
	end;
elsif (cd_operacao_p = 3) then
	begin
	if (cd_procedimento_p IS NOT NULL AND cd_procedimento_p::text <> '') and (ie_origem_proced_p IS NOT NULL AND ie_origem_proced_p::text <> '') then
		begin
		select 	ds_procedimento
		into STRICT	ds_procedimento_w
		from   	procedimento
		where  	cd_procedimento  = cd_procedimento_p
		and  	ie_origem_proced = ie_origem_proced_p;

		cd_procedimento_w := cd_procedimento_p;
		ie_origem_proced_w := ie_origem_proced_p;
		end;
	end if;
	end;
end if;
if (cd_procedimento_w IS NOT NULL AND cd_procedimento_w::text <> '') and (ie_origem_proced_w IS NOT NULL AND ie_origem_proced_w::text <> '') then
	begin
	select 	qt_exec_barra
	into STRICT 	qt_exec_barra_w
	from   	procedimento
	where  	cd_procedimento  = cd_procedimento_w
	and  	ie_origem_proced = ie_origem_proced_w;
	end;
end if;

return	ds_procedimento_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION consultar_corverte_barra ( cd_operacao_p bigint, nr_sequencia_p bigint, cd_procedimento_p bigint, ie_origem_proced_p bigint) FROM PUBLIC;

