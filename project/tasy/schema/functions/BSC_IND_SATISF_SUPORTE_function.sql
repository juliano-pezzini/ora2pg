-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION bsc_ind_satisf_suporte ( dt_inicial_p timestamp, dt_final_p timestamp) RETURNS bigint AS $body$
DECLARE


qt_retorno_w		double precision;
dt_inicial_w		timestamp;
dt_final_w			timestamp;
qt_total_os_w		bigint;


BEGIN

dt_inicial_w	:= dt_inicial_p;
dt_final_w		:= dt_final_p;

select	count(*)
into STRICT	qt_total_os_w
from	os_encer_satisf_gerencia_sup_v
where coalesce(ie_situacao, 'A') = 'A'
and nr_seq_gerencia_sup in (5,58)
and dt_fim_real between dt_inicial_w and PKG_DATE_UTILS.END_OF(dt_final_w, 'DAY');

select	count(*)
into STRICT	qt_retorno_w
from	os_insatisfacao_gerencia_sup_v
where coalesce(ie_situacao, 'A') = 'A'
and nr_seq_gerencia_sup in (5,58)
and dt_fim_real between dt_inicial_w and PKG_DATE_UTILS.END_OF(dt_final_w, 'DAY');

qt_retorno_w	:= 100 - dividir(qt_retorno_w * 100, qt_total_os_w);

return	qt_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION bsc_ind_satisf_suporte ( dt_inicial_p timestamp, dt_final_p timestamp) FROM PUBLIC;

