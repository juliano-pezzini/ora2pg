-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION conta_dia_agenda (nr_seq_curso_p text) RETURNS varchar AS $body$
DECLARE


total_dia_semana_w varchar(50) := '';
dia_agenda_w bigint;
contador_w	bigint := 0;

c01 CURSOR FOR
	SELECT ie_dia_Semana
	FROM   tre_agenda_turno a,
	       tre_agenda b,
	       tre_evento c
	WHERE  a.nr_seq_agenda_tre = b.nr_sequencia
	AND    c.nr_seq_agenda = b.nr_Sequencia
	AND    c.nr_sequencia = nr_seq_curso_p;


BEGIN

OPEN c01;
LOOP
FETCH c01 INTO
	dia_agenda_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
	BEGIN

	IF (dia_agenda_w IS NOT NULL AND dia_agenda_w::text <> '') THEN

		contador_w := contador_w + 1;

		if (contador_w = 1) then
			total_dia_semana_w := total_dia_Semana_w || dia_agenda_w;

		else
			total_dia_semana_w := total_dia_semana_w || ', ' || dia_agenda_w;
		end if;
	end if;

	END;
END LOOP;
CLOSE c01;

RETURN total_dia_semana_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION conta_dia_agenda (nr_seq_curso_p text) FROM PUBLIC;

