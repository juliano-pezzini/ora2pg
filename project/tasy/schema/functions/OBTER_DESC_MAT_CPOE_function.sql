-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_desc_mat_cpoe ( cd_material_p bigint) RETURNS varchar AS $body$
DECLARE


ds_material_w	    material.ds_material%type;
ie_tipo_fonte_w	    material.ie_tipo_fonte_prescr%type;
ds_retorno_w        varchar(2000);


BEGIN
    begin
    select	max(obter_desc_material(c.cd_material)),
            max(coalesce(ie_tipo_fonte_prescr,' '))
    into STRICT	ds_material_w,
            ie_tipo_fonte_w
    from 	material c
    where	cd_material = cd_material_p;

    if (ie_tipo_fonte_w <> ' ') then
        /* ITALICO */

        if (ie_tipo_fonte_w = 'I') then
            ds_retorno_w := '<i>' || ds_material_w || '</i>';
        /*  ITALICO E SUBLINHADO */

        elsif (ie_tipo_fonte_w = 'IS') then
            ds_retorno_w := '<i><u>' || ds_material_w || '</u></i>';
        /*  MAIUSCULO */

        elsif (ie_tipo_fonte_w = 'M') then
            ds_retorno_w := upper(ds_material_w);
        /*  MAISCULO E ITALICO */

        elsif (ie_tipo_fonte_w = 'MI') then
            ds_retorno_w := '<i>' || upper(ds_material_w) || '</i>';
        /*  MAISCULO E NEGRITO */

        elsif (ie_tipo_fonte_w = 'MN') then
            ds_retorno_w := '<b>' || upper(ds_material_w) || '</b>';
        /*  MAISCULO E SUBLINHADO */

        elsif (ie_tipo_fonte_w = 'MS') then
            ds_retorno_w := '<u>' || upper(ds_material_w) || '</u>';
        /* MAIÚSCULO, ITÁLICO E SUBLINHADO */

        elsif (ie_tipo_fonte_w = 'MT') then
            ds_retorno_w := '<i><u>' || upper(ds_material_w) || '</u></i>';
        /*  NEGRITO */

        elsif (ie_tipo_fonte_w = 'N') then
            ds_retorno_w := '<b>' || ds_material_w || '</b>';
        /*  NEGRITO E ITALICO */

        elsif (ie_tipo_fonte_w = 'NI') then
            ds_retorno_w := '<b><i>' || ds_material_w || '</i></b>';
        /*  NEGRITO E SUBLINHADO */

        elsif (ie_tipo_fonte_w = 'NS') then
            ds_retorno_w := '<b><u>' || ds_material_w || '</u></b>';
        /*  SUBLINHADO  */

        elsif (ie_tipo_fonte_w = 'S') then
            ds_retorno_w := '<u>' || ds_material_w || '</u>';
        end if;
    else
        ds_retorno_w :=  ds_material_w;
    end if;

    exception when no_data_found then
        ds_retorno_w := null;
    end;

return ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_desc_mat_cpoe ( cd_material_p bigint) FROM PUBLIC;

