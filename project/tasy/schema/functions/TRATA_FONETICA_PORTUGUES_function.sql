-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION trata_fonetica_portugues (ds_fonetica_p text) RETURNS varchar AS $body$
DECLARE

ds_fonetica_w 		varchar(255);
ds_vogais_w		varchar(5) :='AEIOU';
pos_w			smallint;

BEGIN
ds_fonetica_w	:= ds_fonetica_p;


/*INCIO TRATAMENTE COMPATIBILIDADE COM CHARSET BRASILEIRO*/

ds_fonetica_w		:= replace(ds_fonetica_w,'CH','X');
ds_fonetica_w		:= replace(ds_fonetica_w,'Y','I');

if ( substr(ds_fonetica_w,1,1) = 'K' ) then
	ds_fonetica_w := 'C' || substr(ds_fonetica_w,2,length(ds_fonetica_w));
elsif ( substr(ds_fonetica_w,1,1) = 'S' ) then
	ds_fonetica_w := 'C' || substr(ds_fonetica_w,2,length(ds_fonetica_w));
elsif ( substr(ds_fonetica_w,1,1) = 'W' ) then
	ds_fonetica_w := 'V' || substr(ds_fonetica_w,2,length(ds_fonetica_w));
end if;

pos_w	:= position('U' in ds_fonetica_w);

if ( pos_w > 0 ) and ( position(substr(ds_fonetica_w,pos_w-1,1) in ds_vogais_w) > 0 ) then
	ds_fonetica_w := substr(ds_fonetica_w,1,pos_w-1) || 'L' || substr(ds_fonetica_w,pos_w+1,length(ds_fonetica_w));
end if;

return ds_fonetica_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 IMMUTABLE;
-- REVOKE ALL ON FUNCTION trata_fonetica_portugues (ds_fonetica_p text) FROM PUBLIC;

