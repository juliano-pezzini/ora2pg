-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION pls_consistir_letra_unica_nome ( nm_pessoa_fisica_p text) RETURNS varchar AS $body$
DECLARE


ds_retorno_w		varchar(255);
ds_lista_nome_w		varchar(255);
i_w			bigint;
qt_caracteres_w		bigint;



BEGIN
i_w		:= 1;
ds_lista_nome_w	:= upper(trim(both nm_pessoa_fisica_p));
qt_caracteres_w := length(ds_lista_nome_w);
ds_retorno_w  := '';

for i_w in 1 .. qt_caracteres_w loop
    if (i_w = 1) then
        ds_retorno_w := concat(ds_retorno_w, substr(ds_lista_nome_w, i_w, 1));
    else
	if (i_w <= qt_caracteres_w ) then
	    if ( (substr(ds_lista_nome_w, i_w -1, 1) = ' ') and (substr(ds_lista_nome_w, i_w +1, 1) = ' ') and (substr(ds_lista_nome_w, i_w, 1) <> 'E')) then
		ds_retorno_w := concat(ds_retorno_w, substr(ds_lista_nome_w, i_w, 1));
		ds_retorno_w := concat(ds_retorno_w, '%');
	    else
		ds_retorno_w := concat(ds_retorno_w, substr(ds_lista_nome_w, i_w, 1));
	    end if;
	end if;
    end if;
end loop;

return ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pls_consistir_letra_unica_nome ( nm_pessoa_fisica_p text) FROM PUBLIC;

