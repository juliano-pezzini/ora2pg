-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_dados_solic_prontuario ( nr_sequencia_p bigint, nm_usuario_p text, ie_opcao_p text) RETURNS varchar AS $body$
DECLARE


ds_retorno_s_w		varchar(4000);
ds_retorno_N_w		varchar(4000);
ds_retorno_w		varchar(4000);
ds_expressao_w		varchar(255);

ie_escala_w		  	  	prontuario_emissao.ie_escala%type;
cd_pessoa_fisica_w      			pessoa_fisica.cd_pessoa_fisica%type;
nm_pessoa_fisica_w			tasy_log_alt_campo.ds_valor_old%type;
nm_pessoa_fisica_new_w			tasy_log_alt_campo.ds_valor_new%type;
nm_escala_w				varchar(255);
ie_sexo_new_w				tasy_log_alt_campo.ds_valor_new%type;
ie_sexo_w				tasy_log_alt_campo.ds_valor_old%type;
nr_sequencia_w				prontuario_emissao_dados.nr_sequencia%type;
ds_pontuacao_w				prontuario_emissao_dados.ds_pontuacao%type;
qt_pontuacao_w				vice_escala.nm_atributo_inf%type;
ds_sql_w					varchar(4000);
ie_lib_desfecho_w				parametro_medico.ie_liberar_desfecho%type;
ie_lib_escala_w				varchar(1);

ie_anamnese_w				prontuario_emissao.ie_anamnese%type;
ie_evolucao_w				prontuario_emissao.ie_evolucao%type;
ie_diagnostico_w				prontuario_emissao.ie_diagnostico%type;
ie_atestado_w				prontuario_emissao.ie_atestado%type;
ie_sinais_vitais_w				prontuario_emissao.ie_sinais_vitais%type;
ie_prescricao_w				prontuario_emissao.ie_prescricao%type;
ie_exame_lab_w				prontuario_emissao.ie_exame_lab%type;
ie_laudo_w				prontuario_emissao.ie_laudo%type;
ie_historico_saude_w			prontuario_emissao.ie_historico_saude%type;
ie_oftalmologia_w				prontuario_emissao.ie_oftalmologia%type;
ie_orientacao_alta_w			prontuario_emissao.ie_orientacao_alta%type;
ie_orientacoes_gerais_w			prontuario_emissao.ie_orientacoes_gerais%type;
ie_parecer_medico_w			prontuario_emissao.ie_parecer_medico%type;
ie_receita_w				prontuario_emissao.ie_receita%type;
ie_sae_w					prontuario_emissao.ie_sae%type;
ie_solic_exame_ext_w			prontuario_emissao.ie_solic_exame_ext%type;
ie_declaracao_receb_w			prontuario_emissao.ie_declaracao_receb%type;
ie_consentimento_w			prontuario_emissao.ie_consentimento%type;
dt_inicio_w				prontuario_emissao.dt_inicial%type;
dt_final_w				prontuario_emissao.dt_final%type;
cd_estabelecimento_w			atendimento_paciente.cd_estabelecimento%type;
ie_consulta_Amb_w				prontuario_emissao.ie_consulta_amb%type;
ie_obs_nasc_w				prontuario_emissao.ie_obstetricia_nasc%type;
ie_avaliacao_w				prontuario_emissao.ie_avaliacao%type;
ie_checkup_w				prontuario_emissao.ie_checkup%type;
ie_diagnostico_tumor_w			prontuario_emissao.ie_diag_tumor%type;
ie_tratam_onc_w				prontuario_emissao.ie_trat_onco%type;
ie_alertas_w				prontuario_emissao.ie_alertas%type;
ie_ciap_w 					prontuario_emissao.ie_ciap%type;
ie_encaminhamento_w 		prontuario_emissao.ie_encaminhamento%type;
ie_plano_cuidado_w 			prontuario_emissao.ie_plano_cuidado%type;
ie_ged_w 			          prontuario_emissao.ie_plano_cuidado%type;

IE_GANHO_PERDA_W			prontuario_emissao.IE_GANHO_PERDA%type;
IE_OBSTETRICIA_NASC_W		prontuario_emissao.IE_OBSTETRICIA_NASC%type;
IE_DIAG_TUMOR_W				prontuario_emissao.IE_DIAG_TUMOR%type;
IE_TRAT_ONCO_W				prontuario_emissao.IE_TRAT_ONCO%type;
IE_CURVA_TENSIONAL_W		prontuario_emissao.IE_CURVA_TENSIONAL%type;
IE_PUPILOMETRIA_W			prontuario_emissao.IE_PUPILOMETRIA%type;

/* Itens do PEPO */

ie_agentes_anestesicos_w   		 	prontuario_emissao.ie_agentes_anestesicos%type;
ie_medicamentos_w 			prontuario_emissao.ie_medicamentos%type;
ie_tecnica_descricao_w 			prontuario_emissao.ie_tecnica_descricao%type;
ie_terapia_hidroeletrolitica_w 			prontuario_emissao.ie_terapia_hidroeletrolitica%type;
ie_hemoderivados_w 			prontuario_emissao.ie_hemoderivados%type;
ie_posicao_w 				prontuario_emissao.ie_posicao%type;
ie_materiais_w				prontuario_emissao.ie_materiais%type;
ie_pele_w 				prontuario_emissao.ie_pele%type;
ie_incisao_w 				prontuario_emissao.ie_incisao%type;
ie_curativo_w 				prontuario_emissao.ie_curativo%type;
ie_apae_w 				prontuario_emissao.ie_apae%type;
ie_resumo_descricao_w 			prontuario_emissao.ie_resumo_descricao%type;
ie_faturamento_medico_w 			prontuario_emissao.ie_faturamento_medico%type;
ie_utilizados_cirurgia_w			prontuario_emissao.ie_utilizados_cirurgia%type;
ie_liberacao_sra_w				prontuario_emissao.ie_liberacao_sra%type;
ie_template_w				prontuario_emissao.ie_template%type;
ie_time_motion_w     prontuario_emissao.ie_time_motion%type;

--Itens Oftalmo
IE_AVALIACAO_LACRIMAL_w						prontuario_emissao.IE_AVALIACAO_LACRIMAL%type;
IE_GONIOSCOPIA_w							prontuario_emissao.IE_GONIOSCOPIA%type;
IE_BIOMICROSCOPIA_w						    prontuario_emissao.IE_BIOMICROSCOPIA%type;
IE_BIOMETRIA_w								prontuario_emissao.IE_BIOMETRIA%type;
IE_FUNDOSCOPIA_w							prontuario_emissao.IE_FUNDOSCOPIA%type;
IE_TOMOGRAFIA_OLHO_w						prontuario_emissao.IE_TOMOGRAFIA_OLHO%type;
IE_FOTOCOAGULACAO_w							prontuario_emissao.IE_FOTOCOAGULACAO%type;
IE_CAPSULOTOMIA_w							prontuario_emissao.IE_CAPSULOTOMIA%type;
IE_TOMOGRAFIA_COERENCIA_w					prontuario_emissao.IE_TOMOGRAFIA_COERENCIA%type;
IE_REFRACAO_w								prontuario_emissao.IE_REFRACAO%type;
IE_AUTO_REFRACAO_w							prontuario_emissao.IE_AUTO_REFRACAO%type;
IE_MICROSCOPIA_ESPECULAR_w					prontuario_emissao.IE_MICROSCOPIA_ESPECULAR%type;
IE_MOTILIDADE_OCULAR_w						prontuario_emissao.IE_MOTILIDADE_OCULAR_COMPLETA%type;
IE_ANGIOFLUORESCEINOGRAFIA_w				prontuario_emissao.IE_ANGIOFLUORESCEINOGRAFIA%type;
IE_ACUIDADE_VISUAL_w						prontuario_emissao.IE_ACUIDADE_VISUAL%type;
IE_ANAMNESE_INICIAL_w						prontuario_emissao.IE_ANAMNESE_INICIAL%type;
IE_EXAME_OCULAR_EXTERNO_w					prontuario_emissao.IE_EXAME_OCULAR_EXTERNO%type;
IE_TONOMETRIA_PNEUMATICA_w					prontuario_emissao.IE_TONOMETRIA_PNEUMATICA%type;
IE_TONOMETRIA_APLANACAO_w					prontuario_emissao.IE_TONOMETRIA_APLANACAO%type;
IE_CONDUTA_w								prontuario_emissao.IE_CONDUTA%type;
IE_PAQUIMETRIA_w							prontuario_emissao.IE_PAQUIMETRIA%type;
IE_CAMPIMETRIA_w							prontuario_emissao.IE_CAMPIMETRIA%type;
IE_CERATOMETRIA_w							prontuario_emissao.IE_CERATOMETRIA%type;
IE_POTENCIAL_ACUIDADE_w						prontuario_emissao.IE_POTENCIAL_ACUIDADE%type;
IE_IRIDECTOMIA_w							prontuario_emissao.IE_IRIDECTOMIA%type;
IE_DALTONISMO_w								prontuario_emissao.IE_DALTONISMO%type;
IE_MAPEAMENTO_RETINA_w						prontuario_emissao.IE_DALTONISMO%type;
IE_RETINOGRAFIA_w							prontuario_emissao.IE_RETINOGRAFIA%type;
IE_RECEITA_OCULOS_w							prontuario_emissao.IE_RECEITA_OCULOS%type;
IE_SOBRECARGA_HIDRICA_w						prontuario_emissao.IE_SOBRECARGA_HIDRICA%type;
IE_DISTANCIA_PUPILAR_w						prontuario_emissao.IE_DISTANCIA_PUPILAR%type;
IE_DEATH_CERTF_w							prontuario_emissao.IE_DEATH_CERTF%type;


BEGIN

if (nr_sequencia_p IS NOT NULL AND nr_sequencia_p::text <> '') then

	select	coalesce(a.dt_inicial,trunc(b.dt_nascimento,'dd')),
		coalesce(a.dt_final,clock_timestamp()),
		a.ie_anamnese,
		a.ie_evolucao,
		a.ie_diagnostico,
		a.ie_atestado,
		a.ie_sinais_vitais,
		a.ie_prescricao,
		a.ie_exame_lab,
		a.ie_laudo,
		a.ie_historico_saude,
		a.ie_oftalmologia,
		a.ie_orientacao_alta,
		a.ie_orientacoes_gerais,
		a.ie_parecer_medico,
		a.ie_receita,
		a.ie_sae,
		a.ie_solic_exame_ext,
		a.ie_declaracao_receb,
		a.ie_consentimento,
		a.ie_consulta_amb,
		a.ie_ganho_perda,
		a.ie_obstetricia_nasc,
		a.ie_avaliacao,
		a.ie_checkup,
		a.ie_diag_tumor,
		a.ie_trat_onco,
		a.ie_agentes_anestesicos, /*InicioitensdoPEPO*/
		a.ie_medicamentos,
		a.ie_tecnica_descricao,
		a.ie_terapia_hidroeletrolitica,
		a.ie_hemoderivados,
		a.ie_posicao,
		a.ie_materiais,
		a.ie_pele,
		a.ie_incisao,
		a.ie_curativo,
		a.ie_apae,
		a.ie_resumo_descricao,
		a.ie_faturamento_medico,
		a.ie_utilizados_cirurgia,
		a.ie_liberacao_sra,/*FimitensdoPEPO*/
		a.ie_template,
		a.ie_alertas,
		a.ie_escala,	/* */
		a.IE_OBSTETRICIA_NASC,
		a.IE_DIAG_TUMOR,
		a.IE_TRAT_ONCO,
		a.IE_CURVA_TENSIONAL,
		a.IE_PUPILOMETRIA,
		a.ie_agentes_anestesicos,
		a.ie_medicamentos,
		a.ie_tecnica_descricao,
		a.ie_terapia_hidroeletrolitica,
		a.ie_hemoderivados,
		a.ie_posicao,
		a.ie_materiais,
		a.ie_pele,
		a.ie_incisao,
		a.ie_curativo,
		a.ie_apae,
		a.ie_resumo_descricao,
		a.ie_faturamento_medico,
		a.ie_utilizados_cirurgia,
		a.ie_liberacao_sra,
		a.ie_template,
		a.IE_AVALIACAO_LACRIMAL,
		a.IE_GONIOSCOPIA,
		a.IE_BIOMICROSCOPIA,
		a.IE_BIOMETRIA,
		a.IE_FUNDOSCOPIA,
		a.IE_TOMOGRAFIA_OLHO,
		a.IE_FOTOCOAGULACAO,
		a.IE_CAPSULOTOMIA,
		a.IE_TOMOGRAFIA_COERENCIA,
		a.IE_REFRACAO,
		a.IE_AUTO_REFRACAO,
		a.IE_MICROSCOPIA_ESPECULAR,
		a.IE_MOTILIDADE_OCULAR,
		a.IE_ANGIOFLUORESCEINOGRAFIA,
		a.IE_ACUIDADE_VISUAL,
		a.IE_ANAMNESE_INICIAL,
		a.IE_EXAME_OCULAR_EXTERNO,
		a.IE_TONOMETRIA_PNEUMATICA,
		a.IE_TONOMETRIA_APLANACAO,
		a.IE_CONDUTA,
		a.IE_PAQUIMETRIA,
		a.IE_CAMPIMETRIA,
		a.IE_CERATOMETRIA,
		a.IE_POTENCIAL_ACUIDADE,
		a.IE_IRIDECTOMIA,
		a.IE_DALTONISMO,
		a.IE_MAPEAMENTO_RETINA,
		a.IE_RETINOGRAFIA,
		a.IE_RECEITA_OCULOS,
		a.IE_SOBRECARGA_HIDRICA,
		a.IE_DISTANCIA_PUPILAR,
		a.IE_DEATH_CERTF,
		a.ie_ciap,
		a.ie_encaminhamento,
    a.ie_ged,
		a.ie_plano_cuidado,
		a.ie_time_motion
	into STRICT	dt_inicio_w,
		dt_final_w,
		ie_anamnese_w,
		ie_evolucao_w,
		ie_diagnostico_w,
		ie_atestado_w,
		ie_sinais_vitais_w,
		ie_prescricao_w,
		ie_exame_lab_w,
		ie_laudo_w,
		ie_historico_saude_w,
		ie_oftalmologia_w,
		ie_orientacao_alta_w,
		ie_orientacoes_gerais_w,
		ie_parecer_medico_w,
		ie_receita_w,
		ie_sae_w,
		ie_solic_exame_ext_w,
		ie_declaracao_receb_w,
		ie_consentimento_w,
		ie_consulta_amb_w,
		ie_ganho_perda_w,
		ie_obs_nasc_w,
		ie_avaliacao_w,
		ie_checkup_w,
		ie_diagnostico_tumor_w,
		ie_tratam_onc_w,
		ie_agentes_anestesicos_w, /*Inicio itens do PEPO*/
		ie_medicamentos_w,
		ie_tecnica_descricao_w,
		ie_terapia_hidroeletrolitica_w,
		ie_hemoderivados_w,
		ie_posicao_w,
		ie_materiais_w,
		ie_pele_w,
		ie_incisao_w,
		ie_curativo_w,
		ie_apae_w,
		ie_resumo_descricao_w,
		ie_faturamento_medico_w,
		ie_utilizados_cirurgia_w,
		ie_liberacao_sra_w, /*FimitensdoPEPO*/
		ie_template_w,
		ie_alertas_w,
		ie_escala_w,	/*-*/
		ie_obstetricia_nasc_w,
		ie_diag_tumor_w,
		ie_trat_onco_w,
		ie_curva_tensional_w,
		ie_pupilometria_w,
		ie_agentes_anestesicos_w,
		ie_medicamentos_w,
		ie_tecnica_descricao_w,
		ie_terapia_hidroeletrolitica_w,
		ie_hemoderivados_w,
		ie_posicao_w,
		ie_materiais_w,
		ie_pele_w,
		ie_incisao_w,
		ie_curativo_w,
		ie_apae_w,
		ie_resumo_descricao_w,
		ie_faturamento_medico_w,
		ie_utilizados_cirurgia_w,
		ie_liberacao_sra_w,
		ie_template_w,
		ie_avaliacao_lacrimal_w,
		ie_gonioscopia_w,
		ie_biomicroscopia_w,
		ie_biometria_w,
		ie_fundoscopia_w,
		ie_tomografia_olho_w,
		ie_fotocoagulacao_w,
		ie_capsulotomia_w,
		ie_tomografia_coerencia_w,
		ie_refracao_w,
		ie_auto_refracao_w,
		ie_microscopia_especular_w,
		ie_motilidade_ocular_w,
		ie_angiofluoresceinografia_w,
		ie_acuidade_visual_w,
		ie_anamnese_inicial_w,
		ie_exame_ocular_externo_w,
		ie_tonometria_pneumatica_w,
		ie_tonometria_aplanacao_w,
		ie_conduta_w,
		ie_paquimetria_w,
		ie_campimetria_w,
		ie_ceratometria_w,
		ie_potencial_acuidade_w,
		ie_iridectomia_w,
		ie_daltonismo_w,
		ie_mapeamento_retina_w,
		ie_retinografia_w,
		ie_receita_oculos_w,
		ie_sobrecarga_hidrica_w,
		ie_distancia_pupilar_w,
		ie_death_certf_w,
		ie_ciap_w,
		ie_encaminhamento_w,
    ie_ged_w,
		ie_plano_cuidado_w,
		ie_time_motion_w
	from	prontuario_emissao a,
			pessoa_fisica b
	where	a.cd_pessoa_fisica = b.cd_pessoa_fisica
	and	a.nr_sequencia	= nr_sequencia_p;

		-- Itens PEP
		/*Select 	obter_desc_expressao(689963,'Itens PEP')
		into 	ds_expressao_w
		from 	dual;

		ds_retorno_N_w := ds_expressao_w||': ';
		ds_retorno_s_w := ds_expressao_w||': ';*/
		-- Anamnese
		Select 	obter_desc_expressao(283455)
		into STRICT 	ds_expressao_w
		;
		
		if ( ie_anamnese_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Evolucao
		Select 	obter_desc_expressao(289676)
		into STRICT 	ds_expressao_w
		;

		if ( IE_EVOLUCAO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Diagnostico
		Select 	obter_desc_expressao(287694)
		into STRICT 	ds_expressao_w
		;

		if ( IE_DIAGNOSTICO_W = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Atestado
		Select 	obter_desc_expressao(283879)
		into STRICT 	ds_expressao_w
		;

		if ( IE_ATESTADO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Sinais vitais
		Select 	obter_desc_expressao(298520)
		into STRICT 	ds_expressao_w
		;

		if ( IE_SINAIS_VITAIS_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Prescricoes
		Select 	obter_desc_expressao(310451)
		into STRICT 	ds_expressao_w
		;

		if ( IE_PRESCRICAO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Exames laboratoriais
		Select 	obter_desc_expressao(289736)
		into STRICT 	ds_expressao_w
		;

		if ( IE_EXAME_LAB_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Exames nao laboratoriais
		Select 	obter_desc_expressao(289737)
		into STRICT 	ds_expressao_w
		;

		if ( IE_LAUDO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Historico de saude
		Select 	obter_desc_expressao(291350)
		into STRICT 	ds_expressao_w
		;

		if ( IE_HISTORICO_SAUDE_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Oftalmologia
		Select 	obter_desc_expressao(294764)
		into STRICT 	ds_expressao_w
		;
		
		if ( IE_OFTALMOLOGIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Orientacao de alta
		Select 	obter_desc_expressao(294900)
		into STRICT 	ds_expressao_w
		;

		if ( IE_ORIENTACAO_ALTA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- IE_PARECER_MEDICO
		Select 	obter_desc_expressao(295288)
		into STRICT 	ds_expressao_w
		;

		if ( IE_PARECER_MEDICO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Receita
		Select 	obter_desc_expressao(297315)
		into STRICT 	ds_expressao_w
		;

		if ( IE_RECEITA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- SAE
		Select 	obter_desc_expressao(297968)
		into STRICT 	ds_expressao_w
		;

		if ( IE_SAE_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Solicitacao de exames externos
		Select 	obter_desc_expressao(298645)
		into STRICT 	ds_expressao_w
		;

		if ( IE_SOLIC_EXAME_EXT_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Declaracoes de recebimentos
		Select 	obter_desc_expressao(287351)
		into STRICT 	ds_expressao_w
		;
		
		if ( IE_DECLARACAO_RECEB_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Consentimentos
		Select 	obter_desc_expressao(285718)
		into STRICT 	ds_expressao_w
		;
		
		if ( IE_CONSENTIMENTO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Consulta ambulatorial
		Select 	obter_desc_expressao(289676)
		into STRICT 	ds_expressao_w
		;

		if ( IE_CONSULTA_AMB_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Ganhos e perdas
		Select 	obter_desc_expressao(290561)
		into STRICT 	ds_expressao_w
		;

		if ( IE_GANHO_PERDA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Obstetricia/Nascimentos
		Select 	obter_desc_expressao(294687)
		into STRICT 	ds_expressao_w
		;

		if ( IE_OBSTETRICIA_NASC_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Avaliacoes
		Select 	obter_desc_expressao(284113)
		into STRICT 	ds_expressao_w
		;

		if ( IE_AVALIACAO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Check-up
		Select 	obter_desc_expressao(284861)
		into STRICT 	ds_expressao_w
		;

		if ( IE_CHECKUP_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Diagnostico do tumor
		Select 	obter_desc_expressao(287703)
		into STRICT 	ds_expressao_w
		;

		if ( IE_DIAG_TUMOR_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Tratamento oncologico
		Select 	obter_desc_expressao(300457)
		into STRICT 	ds_expressao_w
		;

		if ( IE_TRAT_ONCO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Templates
		Select 	obter_desc_expressao(307982)
		into STRICT 	ds_expressao_w
		;

		if ( IE_TEMPLATE_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Alertas
		Select 	obter_desc_expressao(289736)
		into STRICT 	ds_expressao_w
		;

		if ( IE_ALERTAS_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Orientacoes gerais
		Select 	obter_desc_expressao(314145)
		into STRICT 	ds_expressao_w
		;

		if ( IE_ORIENTACOES_GERAIS_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;
		
		-- CIAP
		Select 	obter_desc_expressao(699114)
		into STRICT 	ds_expressao_w
		;

		if ( ie_ciap_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;
		
		-- Encaminhamentos
		Select 	obter_desc_expressao(317061)
		into STRICT 	ds_expressao_w
		;

		if ( ie_encaminhamento_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;	

		-- GED
		Select 	obter_desc_expressao(288147)
		into STRICT 	ds_expressao_w
		;

		if ( ie_ged_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Plano de cuidado
		Select 	obter_desc_expressao(784741)
		into STRICT 	ds_expressao_w
		;

		if ( ie_plano_cuidado_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;	
		
		-- ITENS PEPO
		/*
		ds_retorno_N_w := ds_retorno_N_w ||chr(13)||chr(13);
		ds_retorno_s_w := ds_retorno_s_w ||chr(13)||chr(13);

		Select 	obter_desc_expressao(292307,'Itens do PEPO')
		into 	ds_expressao_w
		from 	dual;

		ds_retorno_N_w := ds_retorno_N_w || ds_expressao_w||': ';
		ds_retorno_s_w := ds_retorno_s_w || ds_expressao_w||': ';
		*/
		--Agentes anestesicos
		Select 	obter_desc_expressao(283254)
		into STRICT 	ds_expressao_w
		;

		if ( IE_AGENTES_ANESTESICOS_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Medicamentos
		Select 	obter_desc_expressao(293085)
		into STRICT 	ds_expressao_w
		;

		if ( IE_MEDICAMENTOS_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Anestesia - Tecnica e descricao
		Select 	obter_desc_expressao(283469)
		into STRICT 	ds_expressao_w
		;

		if ( IE_TECNICA_DESCRICAO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Terapia hidroeletrolitica
		Select 	obter_desc_expressao(299297)
		into STRICT 	ds_expressao_w
		;

		if ( IE_TERAPIA_HIDROELETROLITICA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Hemoderivados
		Select 	obter_desc_expressao(291246)
		into STRICT 	ds_expressao_w
		;

		if ( IE_HEMODERIVADOS_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Materiais
		Select 	obter_desc_expressao(292949)
		into STRICT 	ds_expressao_w
		;

		if ( IE_MATERIAIS_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Posicao
		Select 	obter_desc_expressao(296094)
		into STRICT 	ds_expressao_w
		;

		if ( IE_POSICAO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Pele
		Select 	obter_desc_expressao(295400)
		into STRICT 	ds_expressao_w
		;

		if ( IE_PELE_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Incisao
		Select 	obter_desc_expressao(291793)
		into STRICT 	ds_expressao_w
		;

		if ( IE_INCISAO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Curativo
		Select 	obter_desc_expressao(286423)
		into STRICT 	ds_expressao_w
		;

		if ( IE_CURATIVO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Avaliacao pre-anestesica - APAE
		Select 	obter_desc_expressao(284109)
		into STRICT 	ds_expressao_w
		;

		if ( IE_APAE_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Cirurgia - resumo e descricao
		Select 	obter_desc_expressao(554575,'Cirurgia - resumo e descricao')
		into STRICT 	ds_expressao_w
		;

		if ( IE_RESUMO_DESCRICAO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

        	-- Escalas e indices
		
		Select 	obter_desc_expressao(314487,'Escalas e indices')
		into STRICT 	ds_expressao_w
		;

		if ( ie_escala_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Faturamento medico
		Select 	obter_desc_expressao(283469)
		into STRICT 	ds_expressao_w
		;

		if ( IE_FATURAMENTO_MEDICO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Materiais e medicamentos utilizados
		Select 	obter_desc_expressao(315268)
		into STRICT 	ds_expressao_w
		;

		if ( IE_UTILIZADOS_CIRURGIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Itens Oftalmo
		/*
		ds_retorno_N_w := ds_retorno_N_w ||chr(13)||chr(13);
		ds_retorno_s_w := ds_retorno_s_w ||chr(13)||chr(13);

		Select 	obter_desc_expressao(292309,'Itens Oftalmologia')
		into 	ds_expressao_w
		from 	dual;

		ds_retorno_N_w := ds_retorno_N_w || ds_expressao_w||': ';
		ds_retorno_s_w := ds_retorno_s_w || ds_expressao_w||': ';
		*/
		-- Avaliacao lacrimal
		Select 	obter_desc_expressao(614403)
		into STRICT 	ds_expressao_w
		;

		if ( IE_AVALIACAO_LACRIMAL_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Gonioscopia
		Select 	obter_desc_expressao(316821)
		into STRICT 	ds_expressao_w
		;

		if ( IE_GONIOSCOPIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Curva tensional
		Select 	obter_desc_expressao(316801)
		into STRICT 	ds_expressao_w
		;

		if ( IE_CURVA_TENSIONAL_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		--Biometria
		Select 	obter_desc_expressao(284312)
		into STRICT 	ds_expressao_w
		;

		if ( IE_BIOMETRIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Biomicroscopia
		Select 	obter_desc_expressao(284315)
		into STRICT 	ds_expressao_w
		;

		if ( IE_BIOMICROSCOPIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;
		
		-- Fundoscopia
		Select 	obter_desc_expressao(286423)
		into STRICT 	ds_expressao_w
		;

		if ( IE_FUNDOSCOPIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Tomografia do olho
		Select 	obter_desc_expressao(314983)
		into STRICT 	ds_expressao_w
		;

		if ( IE_TOMOGRAFIA_OLHO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Fotocoagulacao
		Select 	obter_desc_expressao(670374)
		into STRICT 	ds_expressao_w
		;

		if ( IE_FOTOCOAGULACAO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Capsulotomia
		Select 	obter_desc_expressao(670975)
		into STRICT 	ds_expressao_w
		;

		if ( IE_CAPSULOTOMIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Tomografia de coerencia optica
		Select 	obter_desc_expressao(314981)
		into STRICT 	ds_expressao_w
		;

		if ( IE_TOMOGRAFIA_COERENCIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		--Refracao
		Select 	obter_desc_expressao(297403)
		into STRICT 	ds_expressao_w
		;

		if ( IE_REFRACAO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Auto refracao
		Select 	obter_desc_expressao(339867)
		into STRICT 	ds_expressao_w
		;

		if ( IE_AUTO_REFRACAO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Pupilometria
		Select 	obter_desc_expressao(314931)
		into STRICT 	ds_expressao_w
		;

		if ( IE_PUPILOMETRIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Microscopia Especular
		Select 	obter_desc_expressao(561090)
		into STRICT 	ds_expressao_w
		;

		if ( IE_MICROSCOPIA_ESPECULAR_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Motilidade ocular completo
		Select 	obter_desc_expressao(314933)
		into STRICT 	ds_expressao_w
		;

		if ( IE_MOTILIDADE_OCULAR_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Angiofluoresceinografia
		Select 	obter_desc_expressao(935634)
		into STRICT 	ds_expressao_w
		;

		if ( IE_ANGIOFLUORESCEINOGRAFIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Acuidade visual
		Select 	obter_desc_expressao(830097)
		into STRICT 	ds_expressao_w
		;

		if ( IE_ACUIDADE_VISUAL_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Anamnese inicial
		Select 	obter_desc_expressao(314981)
		into STRICT 	ds_expressao_w
		;

		if ( IE_ANAMNESE_INICIAL_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		--Exame ocular externo
		Select 	obter_desc_expressao(316798)
		into STRICT 	ds_expressao_w
		;

		if ( IE_EXAME_OCULAR_EXTERNO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Tonometria pneumatica
		Select 	obter_desc_expressao(316818)
		into STRICT 	ds_expressao_w
		;

		if ( IE_TONOMETRIA_PNEUMATICA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;
		
		-- Tonometria aplanacao
		Select 	obter_desc_expressao(316805)
		into STRICT 	ds_expressao_w
		;

		if ( IE_TONOMETRIA_APLANACAO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Conduta
		Select 	obter_desc_expressao(285675)
		into STRICT 	ds_expressao_w
		;

		if ( IE_CONDUTA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Paquimetria
		Select 	obter_desc_expressao(314932)
		into STRICT 	ds_expressao_w
		;

		if ( IE_PAQUIMETRIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Campimetria Computadorizada
		Select 	obter_desc_expressao(561092)
		into STRICT 	ds_expressao_w
		;

		if ( IE_CAMPIMETRIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Ceratometria
		Select 	obter_desc_expressao(284805)
		into STRICT 	ds_expressao_w
		;

		if ( IE_CERATOMETRIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Potencial de acuidade visual
		Select 	obter_desc_expressao(315031)
		into STRICT 	ds_expressao_w
		;

		if ( IE_POTENCIAL_ACUIDADE_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Iridectomia
		Select 	obter_desc_expressao(613821)
		into STRICT 	ds_expressao_w
		;

		if ( IE_IRIDECTOMIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Daltonismo
		Select 	obter_desc_expressao(614414)
		into STRICT 	ds_expressao_w
		;
		
		if ( IE_DALTONISMO_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Mapeamento da retina
		Select 	obter_desc_expressao(706717)
		into STRICT 	ds_expressao_w
		;

		if ( IE_MAPEAMENTO_RETINA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		--Retinografia
		Select 	obter_desc_expressao(496733)
		into STRICT 	ds_expressao_w
		;
		
		if ( IE_RETINOGRAFIA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Receita de oculos
		Select 	obter_desc_expressao(316816)
		into STRICT 	ds_expressao_w
		;
		
		if ( IE_RECEITA_OCULOS_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;
		-- Sobrecarga hidrica
		Select 	obter_desc_expressao(670627)
		into STRICT 	ds_expressao_w
		;
		if ( IE_SOBRECARGA_HIDRICA_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;

		-- Distancia pupilar
		Select 	obter_desc_expressao(316807)
		into STRICT 	ds_expressao_w
		;

		if ( IE_DISTANCIA_PUPILAR_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		ELSE
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;
		
		-- Declaracao de obito
		Select 	obter_desc_expressao(314115)
		into STRICT 	ds_expressao_w
		;
		
		if (ie_death_certf_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		else
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;
		
		-- Tempos e movimentos
		Select 	obter_desc_expressao(315155)
		into STRICT 	ds_expressao_w
		;
		
		if (ie_time_motion_w = 'S') then
			ds_retorno_s_w := ds_retorno_s_w ||ds_expressao_w||', ';
		else
			ds_retorno_N_w := ds_retorno_N_w ||ds_expressao_w||', ';
		end if;
		
	if ( ie_opcao_p = 'CHECADO_S' ) then
		ds_retorno_w := substr(ds_retorno_s_w, 1, (LENGTH(ds_retorno_s_w)-2));
	else
		ds_retorno_w := substr(ds_retorno_n_w, 1, (LENGTH(ds_retorno_n_w)-2));
	end if;

end if;

return	ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_dados_solic_prontuario ( nr_sequencia_p bigint, nm_usuario_p text, ie_opcao_p text) FROM PUBLIC;

