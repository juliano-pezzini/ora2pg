-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_dados_pacote_tipo_acomod (IE_OPCAO_P text, NR_SEQ_TIPO_ACOMOD_P bigint) RETURNS varchar AS $body$
DECLARE

/*	VH	-	RETORNA VALOR DO HONRÁRIO
	VP	-	RETORNA VALOR DO PACOTE
	PP	-	RETORNA QT_PONTO_PACOTE
	PH	-	RETORNA QT_PNOTO_HONORARIO
	CL	- 	Classificacao
	TA	-	Tipo Acomodação
	TC	-	Tipo acomodação + classificacao
	TCP	-	Tipo acomodação + classificacao + Procedimento
	PTC	-	Procedimento + Tipo acomodação + classificacao
	DP	-	Dias pacote
	DS	-	Dias setor
	DU	-	Dias UTI
*/
vl_pacote_W		varchar(100);
vl_honorario_W	varchar(100);
qt_ponto_pacote_W	varchar(100);
qt_ponto_honorario_W	varchar(100);
ie_tipo_acomod_w	varchar(015);
ie_classificacao_w	varchar(015);
ds_classif_w		varchar(255);
ds_tipo_acomod_w	varchar(255);
ds_procedimento_w	varchar(255);
qt_dias_pacote_w	integer;
qt_dias_hospital_w	integer;
qt_dias_uti_w		integer;


BEGIN
SELECT	vl_pacote,
	vl_honorario,
	qt_ponto_pacote,
	qt_ponto_honorario,
	ie_tipo_acomod,
	ie_classificacao,
	Obter_Descricao_Procedimento(cd_procedimento, ie_origem_proced),
	qt_dias_pacote,
	qt_dias_hospital,
	qt_dias_uti
INTO STRICT	vl_pacote_W,
	vl_honorario_W,
	qt_ponto_pacote_W,
	qt_ponto_honorario_W,
	ie_tipo_acomod_w,
	ie_classificacao_w,
	ds_procedimento_w,
	qt_dias_pacote_w,
	qt_dias_hospital_w,
	qt_dias_uti_w
FROM	PACOTE_TIPO_ACOMODACAO
WHERE	NR_SEQUENCIA = NR_SEQ_TIPO_ACOMOD_P;

if	ie_opcao_p = 'VH'	then
	return	vl_honorario_w;
elsif	ie_opcao_p = 'VP'	then
	return	vl_pacote_w;
elsif	ie_opcao_p = 'PP'	then
	return	qt_ponto_pacote_W;
elsif	ie_opcao_p = 'PH'	then
	return	qt_ponto_honorario_W;
elsif	ie_opcao_p = 'CL'	then
	select	obter_valor_dominio(1200, ie_classificacao_w)
	into STRICT	ds_classif_w	;
	ds_classif_w		:= replace(ds_classif_w,'  ','');
	return	ds_classif_w;
elsif	ie_opcao_p = 'TA'	then
	select	obter_valor_dominio(56, ie_tipo_acomod_w)
	into STRICT	ds_tipo_acomod_w	;
	ds_tipo_acomod_w	:= replace(ds_tipo_acomod_w,'  ','');
	return	ds_tipo_acomod_w;
elsif	ie_opcao_p = 'TC'	then
	select	obter_valor_dominio(1200, ie_classificacao_w)
	into STRICT	ds_classif_w	;
	select	obter_valor_dominio(56,ie_tipo_acomod_w)
	into STRICT	ds_tipo_acomod_w	;
	ds_classif_w		:= replace(ds_classif_w,'  ','');
	ds_tipo_acomod_w	:= replace(ds_tipo_acomod_w,'  ','');
	return	ds_tipo_acomod_w || ' ' || ds_classif_w;
elsif	ie_opcao_p = 'TCP'	then
	select	obter_valor_dominio(1200, ie_classificacao_w)
	into STRICT	ds_classif_w	;
	select	obter_valor_dominio(56,ie_tipo_acomod_w)
	into STRICT	ds_tipo_acomod_w	;
	ds_classif_w		:= replace(ds_classif_w,'  ','');
	ds_tipo_acomod_w	:= replace(ds_tipo_acomod_w,'  ','');
	return	ds_tipo_acomod_w || ' ' || ds_classif_w || ' ' || ds_procedimento_w;
elsif	ie_opcao_p = 'PTC'	then
	select	obter_valor_dominio(1200, ie_classificacao_w)
	into STRICT	ds_classif_w	;
	select	obter_valor_dominio(56,ie_tipo_acomod_w)
	into STRICT	ds_tipo_acomod_w	;
	ds_classif_w		:= replace(ds_classif_w,'  ','');
	ds_tipo_acomod_w	:= replace(ds_tipo_acomod_w,'  ','');
	return	ds_procedimento_w || ' ' || ds_tipo_acomod_w || ' ' || ds_classif_w;
elsif (ie_opcao_p = 'DP') then
	return	qt_dias_pacote_w;
elsif (ie_opcao_p = 'DS') then
	return	qt_dias_hospital_w;
elsif (ie_opcao_p = 'DU') then
	return	qt_dias_uti_w;
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_dados_pacote_tipo_acomod (IE_OPCAO_P text, NR_SEQ_TIPO_ACOMOD_P bigint) FROM PUBLIC;

