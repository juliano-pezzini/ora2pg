-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_informacao_rediluicao_md ( qt_dose_red_p bigint, nr_casas_diluicao_p bigint, ds_uom_p text, ds_dose_diferenciada_p text, ds_solucao_str_p text, ds_item_concat_p text, ds_material_p text ) RETURNS varchar AS $body$
DECLARE

  qt_resul_calc_w    varchar(20);
  qt_vol_w           numeric(16, 4);
  ds_dose_diluicao_w varchar(2000);
  ds_item_concat_w   varchar(2000) := ds_item_concat_p;

BEGIN
	
	qt_vol_w := round(qt_dose_red_p, nr_casas_diluicao_p);
	
	qt_resul_calc_w := formatar_dosage_md(qt_vol_w);
	
	ds_dose_diluicao_w := qt_resul_calc_w || ' ' || ds_uom_p;

	if (ds_dose_diferenciada_p IS NOT NULL AND ds_dose_diferenciada_p::text <> '') then
		ds_dose_diluicao_w := qt_vol_w || ' ' || ds_uom_p;
	end if;
	
	qt_vol_w := round(ds_solucao_str_p, nr_casas_diluicao_p);
	
	qt_resul_calc_w := formatar_dosage_md(qt_vol_w);

	ds_item_concat_w := ds_item_concat_w || ' ' ||
	                    qt_resul_calc_w || ' ' ||
					    wheb_mensagem_pck.get_texto(750517) || ' ' || 
					    wheb_mensagem_pck.get_texto(307105) || ' ' ||
						ds_dose_diluicao_w || ' '|| 
					    wheb_mensagem_pck.get_texto(307090) || ' ' ||
						ds_material_p || chr(13);
					
	return ds_item_concat_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_informacao_rediluicao_md ( qt_dose_red_p bigint, nr_casas_diluicao_p bigint, ds_uom_p text, ds_dose_diferenciada_p text, ds_solucao_str_p text, ds_item_concat_p text, ds_material_p text ) FROM PUBLIC;

