-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_tipos_avaliacao_onc ( cd_cid10_p text, cd_topografia_p text, cd_morfologia_p text) RETURNS bigint AS $body$
DECLARE


nr_seq_tipo_avaliacao_w     CIDO_MORFOLOGIA_TOPOGRAFIA.nr_seq_tipo_avaliacao%type;


BEGIN
    if (cd_cid10_p IS NOT NULL AND cd_cid10_p::text <> '' AND cd_topografia_p IS NOT NULL AND cd_topografia_p::text <> '') then
        if (cd_morfologia_p IS NOT NULL AND cd_morfologia_p::text <> '') then

            SELECT  nr_seq_tipo_avaliacao
            into STRICT    nr_seq_tipo_avaliacao_w
            FROM CIDO_MORFOLOGIA_TOPOGRAFIA
            where   cd_morfologia = cd_morfologia_p
            and     cd_topografia = cd_topografia_p;

        end if;

        if (coalesce(nr_seq_tipo_avaliacao_w::text, '') = '' or nr_seq_tipo_avaliacao_w = '') then
            
            SELECT  nr_seq_tipo_avaliacao
            into STRICT    nr_seq_tipo_avaliacao_w
            FROM    CIDO_TOPOGRAFIA
            where   cd_cid10 = cd_cid10_p
            and     cd_topografia = cd_topografia_p;

        end if;
    end if;

    return nr_seq_tipo_avaliacao_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_tipos_avaliacao_onc ( cd_cid10_p text, cd_topografia_p text, cd_morfologia_p text) FROM PUBLIC;

