-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION get_schedule_describle_html (ds_description_p text, ds_name_p text, ds_born_date_p text, cd_paciente_p text) RETURNS varchar AS $body$
DECLARE


ds_retorno_w		varchar(4000);
ds_sexo_w		varchar(1);
ds_caminho_icon_w	varchar(255);
ds_descricao_icon_w	varchar(30);


BEGIN

ds_retorno_w	:= '<div style="width:100%; heigth: 100%; background-color:pink">' || chr(13) || chr(10);


/*  NAME */

ds_retorno_w := ds_retorno_w || '<span style="background-color:blue;' || chr(13) || chr(10) ||
		 'font-size:14px;  ' || chr(13) || chr(10) ||
		 'float:left;' || chr(13) || chr(10) ||
		 'height:14px;'|| chr(13) || chr(10) ||
		 'width:40%;'|| chr(13) || chr(10) ||
		 'display:block;' ||  chr(13) || chr(10) ||
		 'overflow:hidden;' || chr(13) || chr(10) ||
		 'text-overflow:ellipsis;' || chr(13) || chr(10) ||
		 'white-space:nowrap;">' || chr(13) || chr(10) ||
		 '<strong>'|| ds_name_p ||'</strong>' || chr(13) || chr(10) ||
		'</span>' || chr(13) || chr(10);


/* BORN DATE */

ds_retorno_w := ds_retorno_w || '<span style="background-color:green;' || chr(13) || chr(10) ||
	      'font-size:13px;' || chr(13) || chr(10) ||
	      'float:left;' || chr(13) || chr(10)  ||
	      'margin-left:20px;' || chr(13) || chr(10) ||
	      'height:13px;' || chr(13) || chr(10) ||
	      'width:30%;' || chr(13) || chr(10) ||
	      'display:block;' || chr(13) || chr(10) ||
	      'overflow:hidden;' || chr(13) || chr(10) ||
	      'text-overflow:ellipsis;' || chr(13) || chr(10) ||
	      'white-space: nowrap;">' || chr(13) || chr(10) ||
	      '<strong>'|| ds_born_date_p ||'</strong>' || chr(13) || chr(10) ||
	     '</span>' || chr(13) || chr(10);


/*  GENDER */

select coalesce(substr(obter_sexo_pf(cd_paciente_p,'C'),1,1),'X')
into STRICT   ds_sexo_w
;

if (ds_sexo_w <> 'X') then
	if (ds_sexo_w = 'F') then
	  ds_caminho_icon_w := 'assets/icons/status-and-feedback/female.svg';
	  ds_descricao_icon_w := 'Female';
	elsif (ds_sexo_w = 'M') then
	  ds_caminho_icon_w := 'assets/icons/status-and-feedback/male.svg';
	  ds_descricao_icon_w := 'Male';
	end if;

	ds_retorno_w := ds_retorno_w || '<div style="float:rigth;' || chr(13) || chr(10) ||
				       ' width:25px;'  || chr(13) || chr(10) ||
				       ' heigth:25px;' || chr(13) || chr(10) ||
				       ' background-image:url('|| ds_caminho_icon_w ||');" uib-tooltip="'|| ds_descricao_icon_w ||'"></div>' || chr(13) || chr(10);

end if;


/*   DESCRIPTION */

ds_retorno_w := ds_retorno_w || '<div style="background-color:red;' ||  chr(13) || chr(10) ||
	    'min-width:100%;' || chr(13) || chr(10) ||
	    'min-height:100px;' || chr(13) || chr(10) ||
	    'top:40px;' || chr(13) || chr(10) ||
	    'position:absolute;">' || replace(replace(ds_description_p,'<b>','<span style="float:left">'),'</b>','</span>') || chr(13) || chr(10) ||
	    '</div>' || chr(13) || chr(10);


ds_retorno_w := ds_retorno_w || '</div>';

return ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION get_schedule_describle_html (ds_description_p text, ds_name_p text, ds_born_date_p text, cd_paciente_p text) FROM PUBLIC;

