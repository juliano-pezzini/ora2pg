-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION cpoe_convert_standard_hours (ds_horario_p text) RETURNS varchar AS $body$
DECLARE


ds_horarios_w		cpoe_material.ds_horarios%type;
ds_horario_conv_w		cpoe_material.ds_horarios%type;
ds_hora_w 		varchar(8);
i 			integer(5);
k			integer(5);
nr_hour			integer(4);
ds_hora_int_w   		integer(4);


BEGIN
ds_horarios_w := ds_horario_p || ' ';
if (ds_horario_p IS NOT NULL AND ds_horario_p::text <> '') then

	while	(ds_horarios_w IS NOT NULL AND ds_horarios_w::text <> '') loop
		begin
		i := position(' ' in ds_horarios_w);

		if (i > 1) and ((substr(ds_horarios_w, 1, i -1) IS NOT NULL AND (substr(ds_horarios_w, 1, i -1))::text <> ''))  then

			ds_hora_w		:= substr(ds_horarios_w, 1, i-1);
			ds_hora_w		:= replace(ds_hora_w, ' ','');
			k := position(':' in ds_hora_w);
			nr_hour 			:= substr(ds_hora_w, 1, k-1);
			ds_hora_int_w 		:= (nr_hour)::numeric;
			ds_horarios_w		:= substr(ds_horarios_w, i + 1, 2000);
			if (ds_hora_int_w > 12) then
				ds_hora_int_w := ds_hora_int_w - 12;
				if (ds_hora_int_w < 10) then
					ds_horario_conv_w := ds_horario_conv_w || '0' || ds_hora_int_w || ':00PM ';
				else
					ds_horario_conv_w := ds_horario_conv_w || ds_hora_int_w || ':00PM ';
				end if;
			else
				ds_horario_conv_w := ds_horario_conv_w || ds_hora_w || 'AM ';
			end if;

		elsif (ds_horarios_w IS NOT NULL AND ds_horarios_w::text <> '') then
			begin
			ds_horarios_w		:= '';
			end;
		end if;
		end;
	end loop;
end if;

return ds_horario_conv_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION cpoe_convert_standard_hours (ds_horario_p text) FROM PUBLIC;

