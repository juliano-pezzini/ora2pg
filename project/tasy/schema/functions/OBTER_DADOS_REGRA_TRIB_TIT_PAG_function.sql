-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_dados_regra_trib_tit_pag (cd_tributo_p bigint, cd_estabelecimento_p bigint, cd_cgc_titulo_p text, cd_pf_titulo_p text, dt_referencia_p timestamp, ie_origem_p text, ie_opcao_p text) RETURNS varchar AS $body$
DECLARE



cd_beneficiario_w		varchar(20)	:= null;
pr_aliquota_w		double precision	:= null;
cd_cond_pagto_w		bigint	:= null;
cd_conta_financ_w		bigint	:= null;
nr_seq_trans_reg_w	bigint	:= null;
nr_seq_trans_baixa_w	bigint	:= null;
vl_minimo_base_w		double precision	:= 0;
vl_minimo_tributo_w		double precision	:= 0;
ie_acumulativo_w		varchar(1);
VL_TETO_BASE_w	double precision	:= 0;
vl_desc_dependente_w	double precision	:= 0;
cd_darf_w		varchar(20);
cd_variacao_w		varchar(2)	:= null;
ie_periodicidade_w		varchar(1)	:= null;

ds_retorno_w		varchar(255) 	:= null;
ds_irrelevante_w		varchar(4000);
nr_seq_regra_w		bigint;

/* IE_OPCAO_P
'VLD' - Valor desconto dependente
'SR' - SequÃªncia da regra
*/
BEGIN

SELECT * FROM OBTER_DADOS_TRIB_TIT_PAGAR(cd_tributo_p, cd_estabelecimento_p, cd_cgc_titulo_p, cd_pf_titulo_p, cd_beneficiario_w, pr_aliquota_w, cd_cond_pagto_w, cd_conta_financ_w, nr_seq_trans_reg_w, nr_seq_trans_baixa_w, VL_MINIMO_BASE_w, VL_MINIMO_TRIBUTO_w, ie_acumulativo_w, VL_TETO_BASE_w, vl_desc_dependente_w, cd_darf_w, dt_referencia_p, cd_variacao_w, ie_periodicidade_w, ie_origem_p, null, null, null, null, null, nr_seq_regra_w, null, 0, ds_irrelevante_w, ds_irrelevante_w, null, 'N', null, null, null, null) INTO STRICT cd_beneficiario_w, pr_aliquota_w, cd_cond_pagto_w, cd_conta_financ_w, nr_seq_trans_reg_w, nr_seq_trans_baixa_w, VL_MINIMO_BASE_w, VL_MINIMO_TRIBUTO_w, ie_acumulativo_w, VL_TETO_BASE_w, vl_desc_dependente_w, cd_darf_w, cd_variacao_w, ie_periodicidade_w, nr_seq_regra_w, ds_irrelevante_w, ds_irrelevante_w;

if (ie_opcao_p = 'VLD')	then
	ds_retorno_w	:= vl_desc_dependente_w;
elsif (ie_opcao_p = 'SR') then
	ds_retorno_w	:= nr_seq_regra_w;
end if;

return	ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_dados_regra_trib_tit_pag (cd_tributo_p bigint, cd_estabelecimento_p bigint, cd_cgc_titulo_p text, cd_pf_titulo_p text, dt_referencia_p timestamp, ie_origem_p text, ie_opcao_p text) FROM PUBLIC;

