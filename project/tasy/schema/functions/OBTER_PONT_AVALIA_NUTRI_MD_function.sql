-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_pont_avalia_nutri_md ( ie_mudou_peso_p text, PR_PERDA_p text, ie_mudanca_dieta_p text, IE_DIETA_HIPOCALORICA_p text, IE_DIET_PASTOSA_HIPOCAL_p text, IE_DIET_LIQUIDA_p text, IE_JEJUM_p text, IE_MUDANCA_PERSISTENTE_p text, ie_disfagia_p text, ie_nausea_p text, ie_vomito_p text, ie_diarreia_p text, ie_anorexia_p text, ie_capacidade_func_p text, ie_diagnostico_p text, ie_perda_gordura_p text, ie_edema_sacral_p text, ie_ascite_p text, ie_musculo_estriado_p text, ie_edema_tornozelo_p text, IE_PERDA_PESO_p text ) RETURNS bigint AS $body$
DECLARE


    qt_ponto_w		bigint;

 
BEGIN
qt_ponto_w		:= 0;
if (ie_mudou_peso_p = 'S') then
	qt_ponto_w	:= qt_ponto_w	+ 1;
end if;
if (PR_PERDA_p > 10) then
	qt_ponto_w	:= qt_ponto_w	+ 2;
elsif (PR_PERDA_p > 0) then
	qt_ponto_w	:= qt_ponto_w	+ 1;
end if;
if (ie_mudanca_dieta_p	= 'S') then
	qt_ponto_w	:= qt_ponto_w	+ 1;

	if (IE_DIETA_HIPOCALORICA_p	= 'S') then
		qt_ponto_w	:= qt_ponto_w	+ 1;
	end if;
	if (IE_DIET_PASTOSA_HIPOCAL_p	= 'S') then
		qt_ponto_w	:= qt_ponto_w	+ 2;
	end if;
	if (IE_DIET_LIQUIDA_p	= 'S') then
		qt_ponto_w	:= qt_ponto_w	+ 2;
	end if;
	if (IE_JEJUM_p	= 'S') then
		qt_ponto_w	:= qt_ponto_w	+ 3;
	end if;
	if (IE_MUDANCA_PERSISTENTE_p	= 'S') then
		qt_ponto_w	:= qt_ponto_w	+ 2;
	end if;

end if;

if (ie_disfagia_p = 'S') then
	qt_ponto_w	:= qt_ponto_w	+ 1;
end if;
if (ie_nausea_p = 'S') then
	qt_ponto_w	:= qt_ponto_w	+ 1;
end if;
if (ie_vomito_p = 'S') then
	qt_ponto_w	:= qt_ponto_w	+ 1;
end if;
if (ie_diarreia_p = 'S') then
	qt_ponto_w	:= qt_ponto_w	+ 1;
end if;
if (ie_anorexia_p = 'S') then
	qt_ponto_w	:= qt_ponto_w	+ 2;
end if;

qt_ponto_w	:= qt_ponto_w	+ Somente_Numero_Md(ie_capacidade_func_p);
qt_ponto_w	:= qt_ponto_w	+ Somente_Numero_Md(ie_diagnostico_p);
qt_ponto_w	:= qt_ponto_w	+ Somente_Numero_Md(ie_perda_gordura_p);
qt_ponto_w	:= qt_ponto_w	+ Somente_Numero_Md(ie_edema_sacral_p);
qt_ponto_w	:= qt_ponto_w	+ Somente_Numero_Md(ie_ascite_p);
qt_ponto_w	:= qt_ponto_w	+ Somente_Numero_Md(ie_musculo_estriado_p);
qt_ponto_w	:= qt_ponto_w	+ Somente_Numero_Md(ie_edema_tornozelo_p);

if (coalesce(IE_PERDA_PESO_p, 'N') = 'S') then
	qt_ponto_w	:= qt_ponto_w	+ 1;
end if;

    RETURN qt_ponto_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_pont_avalia_nutri_md ( ie_mudou_peso_p text, PR_PERDA_p text, ie_mudanca_dieta_p text, IE_DIETA_HIPOCALORICA_p text, IE_DIET_PASTOSA_HIPOCAL_p text, IE_DIET_LIQUIDA_p text, IE_JEJUM_p text, IE_MUDANCA_PERSISTENTE_p text, ie_disfagia_p text, ie_nausea_p text, ie_vomito_p text, ie_diarreia_p text, ie_anorexia_p text, ie_capacidade_func_p text, ie_diagnostico_p text, ie_perda_gordura_p text, ie_edema_sacral_p text, ie_ascite_p text, ie_musculo_estriado_p text, ie_edema_tornozelo_p text, IE_PERDA_PESO_p text ) FROM PUBLIC;

