-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_horarios_regra ( ds_horarios_p text) RETURNS varchar AS $body$
DECLARE

	
	exibe_horarios_w cpoe_presentation_rule.ie_exibe_horarios%type;
	ds_horarios_w varchar(2000) := '';


BEGIN
 select max(ie_exibe_horarios)
	into STRICT exibe_horarios_w
    from cpoe_presentation_rule
	where ie_exibe_horarios = 'S'
		and ((coalesce(cd_estabelecimento::text, '') = '') or (cd_estabelecimento = wheb_usuario_pck.get_cd_estabelecimento))
		and ((coalesce(cd_perfil::text, '') = '') or (cd_perfil = obter_perfil_ativo));
		
if (exibe_horarios_w = 'S' and (ds_horarios_p IS NOT NULL AND ds_horarios_p::text <> '')) then
  if (position(obter_texto_tasy(439834, wheb_usuario_pck.get_nr_seq_idioma) in ds_horarios_p)>0)then
	ds_horarios_w := cpoe_retirar_das_as(ds_horarios_p);
	ds_horarios_w := '( ' || substr(replace(ds_horarios_w, ':00', ''), 1,2000) || ' )';
  else
	ds_horarios_w := '( ' || substr(replace(ds_horarios_p, ':00', ''), 1,2000) || ' )';
	end if;
end if;
return ds_horarios_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_horarios_regra ( ds_horarios_p text) FROM PUBLIC;

