-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION pls_obter_nm_prest_web ( nr_seq_prestador_p bigint) RETURNS varchar AS $body$
DECLARE

 
nm_prestador_w		varchar(255);				
ie_tipo_nome_w		varchar(2);
cd_estabelecimento_w	estabelecimento.cd_estabelecimento%type;


BEGIN 
 
select	cd_estabelecimento 
into STRICT 	cd_estabelecimento_w 
from 	pls_prestador 
where 	nr_sequencia	= nr_seq_prestador_p;
	 
select	coalesce(max(ie_nome_prestador),'RS') 
into STRICT	ie_tipo_nome_w 
from	pls_web_param_geral 
where	cd_estabelecimento	= cd_estabelecimento_w;
 
if (ie_tipo_nome_w = 'NF') then 
	select	initcap(substr( coalesce(obter_dados_pf_pj(cd_pessoa_fisica, cd_cgc, 'F'),obter_nome_pf_pj(cd_pessoa_fisica, cd_cgc) ) ,1,255)) 
	into STRICT	nm_prestador_w 
	from	pls_prestador 
	where  nr_sequencia = nr_seq_prestador_p;
else 
	select	initcap(substr(obter_nome_pf_pj(cd_pessoa_fisica, cd_cgc),1,255)) 
	into STRICT	nm_prestador_w 
	from	pls_prestador 
	where  nr_sequencia = nr_seq_prestador_p;
end if;
 
return	nm_prestador_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pls_obter_nm_prest_web ( nr_seq_prestador_p bigint) FROM PUBLIC;

