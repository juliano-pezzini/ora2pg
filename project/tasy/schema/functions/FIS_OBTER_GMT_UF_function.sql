-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION fis_obter_gmt_uf ( uf_p text, ie_hr_verao text default 'N') RETURNS varchar AS $body$
DECLARE


gmt_w bigint := 3;

/*

Function criada pois em ambiente cloud n√£o conseguimos pegar o GMT correto do cliente.
OS 2028615

Metodo antigo: select lpad(TZ_OFFSET(SESSIONTIMEZONE), 6,0) from dual

*/
BEGIN

	if (	uf_p = 'MT'
		or uf_p = 'MS' 
		or  uf_p = 'AM' 
		or  uf_p = 'RO' 
		or  uf_p = 'RR' 
		or  uf_p = 'AM') then
		
		gmt_w := 4;
		
	elsif (uf_p = 'AC') then
	
		gmt_w := 5;
		
	end if;
	
	if (ie_hr_verao = 'S'
		and (	uf_p = 'RS' 
		or 	uf_p = 'SC' 
		or 	uf_p = 'PR' 
		or 	uf_p = 'SP'
		or  	uf_p = 'RJ' 
		or  	uf_p = 'MG' 
		or  	uf_p = 'ES' 
		or  	uf_p = 'GO'
		or  	uf_p = 'MT' 
		or 	uf_p = 'MS' 
		or 	uf_p = 'DF' 
		or 	uf_p = 'TO' )) then
		
		gmt_w := gmt_w - 1;
		
	end if;
	
return '-0' || gmt_w || ':00';

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION fis_obter_gmt_uf ( uf_p text, ie_hr_verao text default 'N') FROM PUBLIC;

