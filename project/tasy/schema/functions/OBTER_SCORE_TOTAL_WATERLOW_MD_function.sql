-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_score_total_waterlow_md (ie_skin_type_p bigint, ie_tissue_malnut_p bigint, ie_surg_trauma_p bigint, ie_bmi_p bigint, qt_score_mst_p bigint, ie_continenece_p bigint, ie_mobility_p bigint, ie_neurological_def_p bigint, ie_sex_p bigint, ie_age_p bigint, ie_medication_p bigint ) RETURNS bigint AS $body$
DECLARE


   ie_skin_type_w      smallint   := 0;
   ie_tissue_malnut_w  smallint   := 0;
   ie_surg_trauma_w    smallint   := 0;
   qt_waterlow_w       bigint;

BEGIN
    if (ie_skin_type_p = 5 or ie_skin_type_p = 6 or ie_skin_type_p = 7 or ie_skin_type_p = 8) then
      ie_skin_type_w := 1;
    else
      ie_skin_type_w := ie_skin_type_p;
    end if;

    if (ie_tissue_malnut_p = 6 ) then
      ie_tissue_malnut_w := 5;
    elsif (ie_tissue_malnut_p = 9 ) then
      ie_tissue_malnut_w := 8;
    else
      ie_tissue_malnut_w := ie_tissue_malnut_p;
    end if;

    if (ie_surg_trauma_p = 6 ) then
      ie_surg_trauma_w := 5;
    else
      ie_surg_trauma_w := ie_surg_trauma_p;
    end if;

    qt_waterlow_w := coalesce(ie_bmi_p,0)              +
                     coalesce(ie_skin_type_w,0)        + 
                     coalesce(qt_score_mst_p,0)        + 
                     coalesce(ie_continenece_p,0)      +
                     coalesce(ie_mobility_p,0)         + 
                     coalesce(ie_tissue_malnut_w,0)    + 
                     coalesce(ie_neurological_def_p,0) + 
                     coalesce(ie_surg_trauma_w,0)      + 
                     coalesce(ie_sex_p,0)              + 
                     coalesce( ie_age_p,0)             + 
                     coalesce(ie_medication_p,0);
    --- Fim MD2
    RETURN coalesce(qt_waterlow_w,0);
   
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_score_total_waterlow_md (ie_skin_type_p bigint, ie_tissue_malnut_p bigint, ie_surg_trauma_p bigint, ie_bmi_p bigint, qt_score_mst_p bigint, ie_continenece_p bigint, ie_mobility_p bigint, ie_neurological_def_p bigint, ie_sex_p bigint, ie_age_p bigint, ie_medication_p bigint ) FROM PUBLIC;

