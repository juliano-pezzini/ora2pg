-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_qtd_nomes_duplicados ( nm_pessoa text) RETURNS bigint AS $body$
DECLARE

    qtd_nomes_duplicados bigint;

BEGIN
    SELECT
        COUNT(1) INTO STRICT qtd_nomes_duplicados 
    FROM pessoa_fisica pf
    INNER JOIN person_name pn ON pf.nr_seq_person_name = pn.nr_sequencia
    WHERE
        UPPER(pf.nm_pessoa_fisica) = UPPER(nm_pessoa) or 
        UPPER(pn.ds_given_name||' '||pn.ds_family_name) = UPPER(nm_pessoa);
    RETURN qtd_nomes_duplicados;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_qtd_nomes_duplicados ( nm_pessoa text) FROM PUBLIC;

