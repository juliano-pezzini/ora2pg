-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_ds_label_elemento (NR_SEQ_ELEMENTO_P bigint) RETURNS varchar AS $body$
DECLARE

    ds_label_elemento DIC_EXPRESSAO_IDIOMA.DS_EXPRESSAO%type;
    nr_seq_elemento_w EHR_TEMPLATE_CONTEUDO.NR_SEQ_ELEMENTO%type;

BEGIN

    SELECT NR_SEQ_ELEMENTO
      INTO STRICT nr_seq_elemento_w
      FROM EHR_TEMPLATE_CONTEUDO 
     WHERE NR_SEQUENCIA = NR_SEQ_ELEMENTO_P;

    IF (nr_seq_elemento_w = 1613) THEN

        SELECT OBTER_DESC_EXPRESSAO(ld.cd_exp_title)
          INTO STRICT ds_label_elemento
          FROM EHR_TEMPLATE_CONTEUDO tc, LINKED_DATA ld
         WHERE tc.nr_seq_linked_data = ld.nr_sequencia 
           AND tc.NR_SEQUENCIA = NR_SEQ_ELEMENTO_P;

    ELSE

        SELECT coalesce(tc.DS_LABEL, ehr.ds_label_tela) DS_LABEL
          INTO STRICT ds_label_elemento
          FROM EHR_TEMPLATE_CONTEUDO tc,
               EHR_ELEMENTO ehr 
         WHERE tc.nr_seq_elemento = ehr.nr_sequencia 
           AND tc.NR_SEQUENCIA = NR_SEQ_ELEMENTO_P;

    END IF;

    RETURN ds_label_elemento;

EXCEPTION
      when no_data_found then return null;
      when too_many_rows then return null;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_ds_label_elemento (NR_SEQ_ELEMENTO_P bigint) FROM PUBLIC;

