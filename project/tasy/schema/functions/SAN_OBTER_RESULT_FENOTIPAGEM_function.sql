-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION san_obter_result_fenotipagem ( nr_sequencia_p bigint, ie_rh_p bigint default 0) RETURNS varchar AS $body$
DECLARE


    ds_retorno_w   varchar(255);
    ds_d_w         varchar(1);
    ds_c_w         varchar(1);
    ds_e_w         varchar(1);
    ds_c_min_w     varchar(1);
    ds_e_min_w     varchar(1);
    ds_f_min_w     varchar(1);
    ds_cw_w        varchar(1);
    ds_k_w         varchar(1);
    ds_k_min_w     varchar(1);
    ds_kpa_w       varchar(1);
    ds_kpb_w       varchar(1);
    ds_jsa_w       varchar(1);
    ds_jsb_w       varchar(1);
    ds_fya_w       varchar(1);
    ds_fyb_w       varchar(1);
    ds_jka_w       varchar(1);
    ds_jkb_w       varchar(1);
    ds_lea_w       varchar(1);
    ds_leb_w       varchar(1);
    ds_s_w         varchar(1);
    ds_s_min_w     varchar(1);
    ds_m_w         varchar(1);
    ds_n_w         varchar(1);
    ds_p1_w        varchar(1);
    ds_lua_w       varchar(1);
    ds_lub_w       varchar(1);
    ds_dia_w       varchar(1);

BEGIN
	ds_retorno_w := '';
	IF (nr_sequencia_p IS NOT NULL AND nr_sequencia_p::text <> '') THEN
        BEGIN
		SELECT
			ds_d,
			ds_c,
			ds_e,
			ds_c_min,
			ds_e_min,
			ds_f_min,
			ds_cw,
			ds_k,
			ds_k_min,
			ds_kpa,
			ds_kpb,
			ds_jsa,
			ds_jsb,
			ds_fya,
			ds_fyb,
			ds_jka,
			ds_jkb,
			ds_lea,
			ds_leb,
			ds_s,
			ds_s_min,
			ds_m,
			ds_n,
			ds_p1,
			ds_lua,
			ds_lub,
			ds_dia
		INTO STRICT
			ds_d_w,
			ds_c_w,
			ds_e_w,
			ds_c_min_w,
			ds_e_min_w,
			ds_f_min_w,
			ds_cw_w,
			ds_k_w,
			ds_k_min_w,
			ds_kpa_w,
			ds_kpb_w,
			ds_jsa_w,
			ds_jsb_w,
			ds_fya_w,
			ds_fyb_w,
			ds_jka_w,
			ds_jkb_w,
			ds_lea_w,
			ds_leb_w,
			ds_s_w,
			ds_s_min_w,
			ds_m_w,
			ds_n_w,
			ds_p1_w,
			ds_lua_w,
			ds_lub_w,
			ds_dia_w
		FROM
			san_result_fenotipagem
		WHERE
			nr_sequencia = nr_sequencia_p
			AND (dt_liberacao IS NOT NULL AND dt_liberacao::text <> '')
			AND coalesce(dt_inativacao::text, '') = '';
		
		IF ( ds_d_w = '1' ) THEN
			ds_retorno_w := ds_retorno_w || 'D+ ';
		ELSIF (ds_d_w = '0' ) THEN
			ds_retorno_w := ds_retorno_w || 'D- ';
		END IF;	
	
		IF ( ds_c_w = '1' ) THEN
			ds_retorno_w := ds_retorno_w || 'C+ ';
		ELSIF ( ds_c_w = '0' ) THEN
			ds_retorno_w := ds_retorno_w || 'C- ';
		END IF;
	
		IF ( ds_c_min_w = '1' ) THEN
			ds_retorno_w := ds_retorno_w || 'c+ ';
		ELSIF ( ds_c_min_w = '0' ) THEN
			ds_retorno_w := ds_retorno_w || 'c- ';
		END IF;
	
		IF ( ds_e_w = '1' ) THEN
			ds_retorno_w := ds_retorno_w || 'E+ ';
		ELSIF ( ds_e_w = '0' ) THEN
			ds_retorno_w := ds_retorno_w || 'E- ';
		END IF;
	
		IF ( ds_e_min_w = '1' ) THEN
			ds_retorno_w := ds_retorno_w || 'e+ ';
		ELSIF ( ds_e_min_w = '0' ) THEN
			ds_retorno_w := ds_retorno_w || 'e- ';
		END IF;
	
		IF ( ie_rh_p = 0 ) THEN

			IF ( ds_f_min_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'f+ ';
			ELSIF ( ds_f_min_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'f- ';
			END IF;
		
			IF ( ds_cw_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'Cw+ ';
			ELSIF ( ds_cw_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'Cw- ';
			END IF;
		
			IF ( ds_k_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'K+ ';
			ELSIF ( ds_k_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'K- ';
			END IF;
		
			IF ( ds_k_min_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'k+ ';
			ELSIF ( ds_k_min_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'k- ';
			END IF;
		
			IF ( ds_kpa_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'Kpa+ ';
			ELSIF ( ds_kpa_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'Kpa- ';
			END IF;
		
			IF ( ds_kpb_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'Kpb+ ';
			ELSIF ( ds_kpb_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'Kpb- ';
			END IF;
		
			IF ( ds_jsa_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'Jsa+ ';
			ELSIF ( ds_jsa_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'Jsa- ';
			END IF;
		
			IF ( ds_jsb_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'Jsb+ ';
			ELSIF ( ds_jsb_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'Jsb- ';
			END IF;
		
			IF ( ds_fya_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'Fya+ ';
			ELSIF ( ds_fya_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'Fya- ';
			END IF;
		
			IF ( ds_fyb_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'Fyb+ ';
			ELSIF ( ds_fyb_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'Fyb- ';
			END IF;
		
			IF ( ds_jka_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'Jka+ ';
			ELSIF ( ds_jka_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'Jka- ';
			END IF;
		
			IF ( ds_jkb_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'Jkb+ ';
			ELSIF ( ds_jkb_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'Jkb- ';
			END IF;
		
			IF ( ds_lea_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'Lea+ ';
			ELSIF ( ds_lea_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'Lea- ';
			END IF;
		
			IF ( ds_leb_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'Leb+ ';
			ELSIF ( ds_leb_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'Leb- ';
			END IF;
		
			IF ( ds_p1_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'P1+ ';
			ELSIF ( ds_p1_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'P1- ';
			END IF;
		
			IF ( ds_m_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'M+ ';
			ELSIF ( ds_m_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'M- ';
			END IF;
		
			IF ( ds_n_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'N+ ';
			ELSIF ( ds_n_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'N- ';
			END IF;
		
			IF ( ds_s_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'S+ ';
			ELSIF ( ds_s_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'S- ';
			END IF;
		
			IF ( ds_s_min_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 's+ ';
			ELSIF ( ds_s_min_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 's- ';
			END IF;
		
			IF ( ds_lua_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'Lua+ ';
			ELSIF ( ds_lua_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'Lua- ';
			END IF;
		
			IF ( ds_lub_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'Lub+ ';
			ELSIF ( ds_lub_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'Lub- ';
			END IF;
		
			IF ( ds_dia_w = '1' ) THEN
				ds_retorno_w := ds_retorno_w || 'DIA+ ';
			ELSIF ( ds_dia_w = '0' ) THEN
				ds_retorno_w := ds_retorno_w || 'DIA- ';
			END IF;
		END IF;

        END;

    END IF;

    RETURN ds_retorno_w;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION san_obter_result_fenotipagem ( nr_sequencia_p bigint, ie_rh_p bigint default 0) FROM PUBLIC;

