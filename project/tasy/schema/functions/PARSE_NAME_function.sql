-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION parse_name ( cd_pessoa_fisica_p text , option_p text default 'FULLN') RETURNS varchar AS $body$
DECLARE


       ds_retorno_w     varchar(60 );
       is_space_present bigint;


BEGIN
       if (cd_pessoa_fisica_p IS NOT NULL AND cd_pessoa_fisica_p::text <> '') then
              begin
                     select
                            substr( trim(both nm_pessoa_fisica ) , 1 , 60 )
                     into STRICT
                            ds_retorno_w
                     from
                            pessoa_fisica
                     where
                            cd_pessoa_fisica= cd_pessoa_fisica_p;
              end;

              is_space_present           :=instr( ds_retorno_w , ' ' , 1 , 1 );

              if ( is_space_present        >0 ) then
                     if ( option_p         = 'FN' ) then
                            ds_retorno_w := substr( ds_retorno_w , 1 , instr( ds_retorno_w , ' ' , 1 , 1 ) );
                     elsif ( option_p      = 'MN' ) then
                            ds_retorno_w := substr( ds_retorno_w , instr( ds_retorno_w , ' ' , 1 , 1 ) , instr( ds_retorno_w , ' ' , -1 , 1 ) - instr(
                            ds_retorno_w , ' ' , 1 , 1 ) );
                     elsif ( option_p      = 'LN' )then
                            ds_retorno_w := substr( ds_retorno_w , instr( ds_retorno_w , ' ' , -1 , 1 )+1 );
                     end if;
              else
                     if ( option_p       <> 'FN' ) then
                            ds_retorno_w:=null;
                     end if;
              end if;
       end if;

return ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION parse_name ( cd_pessoa_fisica_p text , option_p text default 'FULLN') FROM PUBLIC;

