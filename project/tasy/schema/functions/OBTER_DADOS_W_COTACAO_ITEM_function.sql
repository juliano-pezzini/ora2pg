-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_dados_w_cotacao_item ( nr_sequencia_p bigint, nr_seq_coluna_p bigint, ie_opcao_p text) RETURNS bigint AS $body$
DECLARE


/* Ie_opcao_p
F - Fornecedor
V - Valor
Q - Quantidade,
I - Valor IPI
C - Condição pagamento
T - Frete
E - Dias entrega
*/
qt_fornecedor_w		double precision;
vl_fornecedor_w		double precision;
vl_ipi_w			double precision;
cd_condicao_pagamento_w	bigint;
vl_frete_w		double precision;
qt_dias_entrega_w		integer;
cd_fornecedor_w		varchar(14);


BEGIN

select	cd_fornecedor,
	coalesce(qt_fornecedor,0),
	coalesce(vl_fornecedor,0),
	coalesce(vl_ipi,0),
	cd_condicao_pagamento,
	coalesce(vl_frete,0),
	qt_dias_entrega
into STRICT	cd_fornecedor_w,
	qt_fornecedor_w,
	vl_fornecedor_w,
	vl_ipi_w,
	cd_condicao_pagamento_w,
	vl_frete_w,
	qt_dias_entrega_w
from	w_cotacao_item_coluna
where	nr_seq_cotacao_item	= nr_sequencia_p
and	nr_seq_coluna		= nr_seq_coluna_p;

if (ie_opcao_p IS NOT NULL AND ie_opcao_p::text <> '') then
	if (ie_opcao_p = 'Q') then
		return	qt_fornecedor_w;
	elsif (ie_opcao_p = 'F') then
		return	cd_fornecedor_w;
	elsif (ie_opcao_p = 'V') then
		return	vl_fornecedor_w;
	elsif (ie_opcao_p = 'I') then
		return	vl_ipi_w;
	elsif (ie_opcao_p = 'C') then
		return	cd_condicao_pagamento_w;
	elsif (ie_opcao_p = 'T') then
		return	vl_frete_w;
	elsif (ie_opcao_p = 'E') then
		return	qt_dias_entrega_w;
	end if;
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_dados_w_cotacao_item ( nr_sequencia_p bigint, nr_seq_coluna_p bigint, ie_opcao_p text) FROM PUBLIC;

