-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION lab_obter_cd_mat_exame_integr ( cd_material_exame_p material_exame_lab.cd_material_exame%type, ds_sigla_p equipamento_lab.ds_sigla%type) RETURNS varchar AS $body$
DECLARE


cd_material_integr_w        material_exame_lab_int.cd_material_integracao%type;


BEGIN

    begin

    select a.cd_material_integracao
    into STRICT cd_material_integr_w
    from material_exame_lab c,
    material_exame_lab_int a,
    equipamento_lab b
    where a.cd_equipamento = b.cd_equipamento
    and UPPER(b.ds_sigla) = UPPER(ds_sigla_p)
    and c.nr_sequencia = a.nr_seq_material
    and c.cd_material_exame = cd_material_exame_p;

    exception
      when no_data_found then
        return null;
      when too_many_rows then
        CALL gravar_log_lab_pragma(37893, 'Foi encontrado mais de um registro.', ds_sigla_p);
    end;

  return cd_material_integr_w;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION lab_obter_cd_mat_exame_integr ( cd_material_exame_p material_exame_lab.cd_material_exame%type, ds_sigla_p equipamento_lab.ds_sigla%type) FROM PUBLIC;

