-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_prazo_resposta_bo ( dt_envio_p timestamp, qt_dias_resposta_p bigint, cd_estab_bo_p bigint) RETURNS timestamp AS $body$
DECLARE


dt_prazo_resposta_w		timestamp;
dt_envio_w			timestamp 		:= dt_envio_p;
ie_prazo_resp_dia_util_w	varchar(255)	:= coalesce(obter_valor_param_usuario(2000,204,wheb_usuario_pck.get_cd_perfil,wheb_usuario_pck.get_nm_usuario,wheb_usuario_pck.get_cd_estabelecimento),'N'); --revisar se N mesmo
qt_dias_prazo_w			bigint;


BEGIN

begin
qt_dias_prazo_w	:= coalesce(obter_valor_param_usuario(2000,88,wheb_usuario_pck.get_cd_perfil,wheb_usuario_pck.get_nm_usuario,wheb_usuario_pck.get_cd_estabelecimento),0);
exception
when others then
	qt_dias_prazo_w := 0;
end;

if (qt_dias_prazo_w = 0) then
	qt_dias_prazo_w := coalesce(qt_dias_resposta_p,0);
end if;

if (ie_prazo_resp_dia_util_w = 'N') then
	begin
	dt_prazo_resposta_w := dt_envio_w + qt_dias_prazo_w;
	if (obter_se_dia_util(dt_envio_w + qt_dias_prazo_w,cd_estab_bo_p) = 'N') then
		dt_prazo_resposta_w := obter_proximo_dia_util(cd_estab_bo_p,dt_envio_w + qt_dias_prazo_w);
	end if;
	end;
else
	dt_prazo_resposta_w := obter_dia_util_periodo(cd_estab_bo_p,dt_envio_w,qt_dias_prazo_w);
end if;

return dt_prazo_resposta_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_prazo_resposta_bo ( dt_envio_p timestamp, qt_dias_resposta_p bigint, cd_estab_bo_p bigint) FROM PUBLIC;

