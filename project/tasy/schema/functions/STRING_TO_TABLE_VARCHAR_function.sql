-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION string_to_table_varchar ( ds_texto_p text, ie_separador_p text ) RETURNS DBMS_SQL.VARCHAR2_TABLE AS $body$
DECLARE

  x            dbms_sql.varchar2_table;
  ds_texto_w   varchar(32767);
  pos_w        bigint;

BEGIN
  begin
    ds_texto_w := replace(ds_texto_p, chr(32), null);
    ds_texto_w := replace(ds_texto_w, chr(13), null);
    ds_texto_w := replace(ds_texto_w, chr(10), null);
  exception
    when others then
      ds_texto_w := null;
  end;

  if (ds_texto_w IS NOT NULL AND ds_texto_w::text <> '') then
    begin
      << while_loop >>
      while(ds_texto_w IS NOT NULL AND ds_texto_w::text <> '') loop
        begin
          pos_w := coalesce(position(ie_separador_p in ds_texto_w), 0);
          if ( pos_w = 0 ) then
            begin
              x(x.count + 1) := substr(ds_texto_w, 1, 255);
              ds_texto_w := null;
            end;
          else
            begin
              x(x.count + 1) := substr(ds_texto_w, 1, pos_w - 1);
              ds_texto_w := substr(ds_texto_w, pos_w + 1, 32767);
            end;
          end if;
        end;
      end loop;
    end;
  end if;

  return x;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 IMMUTABLE;
-- REVOKE ALL ON FUNCTION string_to_table_varchar ( ds_texto_p text, ie_separador_p text ) FROM PUBLIC;

