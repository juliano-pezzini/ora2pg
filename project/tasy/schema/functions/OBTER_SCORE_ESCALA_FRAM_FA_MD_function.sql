-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_score_escala_fram_fa_md ( qt_idade_p bigint, qt_pa_sistolica_p bigint, ie_diabetes_p text, ie_tabagismo_p text, ie_iam_icc_p text, ie_sopro_mitral_p text, ie_hve_ecg_p text ) RETURNS bigint AS $body$
DECLARE

  qt_score_w smallint;

BEGIN
  qt_score_w := 0;

  if (qt_idade_p = 56) then
    qt_score_w := 1;
  elsif (qt_idade_p = 57) then
    qt_score_w := 2;
  elsif ((qt_idade_p = 58) or (qt_idade_p = 59)) then
    qt_score_w := 3;
  elsif (qt_idade_p = 60) then
    qt_score_w := 4;
  elsif (qt_idade_p = 61) then
    qt_score_w := 5;
  elsif (qt_idade_p = 62) then
    qt_score_w := 6;
  elsif (qt_idade_p = 63) then
    qt_score_w := 7;
  elsif ((qt_idade_p = 64) or (qt_idade_p = 65)) then
    qt_score_w := 8;
  elsif (qt_idade_p = 66) then
    qt_score_w := 9;
  elsif (qt_idade_p <= 67) then
    qt_score_w := 10;
  elsif (qt_idade_p <= 68) then
    qt_score_w := 11;
  elsif (qt_idade_p <= 69) then
    qt_score_w := 12;
  elsif ((qt_idade_p = 70) or (qt_idade_p = 71)) then
    qt_score_w := 13;
  elsif (qt_idade_p = 72) then
    qt_score_w := 14;
  elsif (qt_idade_p <= 73) then
    qt_score_w := 15;
  elsif (qt_idade_p <= 74) then
    qt_score_w := 16;
  elsif (qt_idade_p <= 75) then
    qt_score_w := 17;
  elsif ((qt_idade_p = 76) or (qt_idade_p = 77)) then
    qt_score_w := 18;
  elsif (qt_idade_p = 78) then
    qt_score_w := 19;
  elsif (qt_idade_p = 79) then
    qt_score_w := 20;
  elsif (qt_idade_p = 80) then
    qt_score_w := 21;
  elsif (qt_idade_p = 81) then
    qt_score_w := 22;
  elsif ((qt_idade_p = 82) or (qt_idade_p = 83)) then
    qt_score_w := 23;
  elsif (qt_idade_p = 84) then
    qt_score_w := 24;
  elsif (qt_idade_p = 85) then
    qt_score_w := 25;
  elsif (qt_idade_p = 86) then
    qt_score_w := 26;
  elsif (qt_idade_p = 87) then
    qt_score_w := 27;
  elsif (qt_idade_p = 88) then
    qt_score_w := 28;
  elsif (qt_idade_p = 89) then
    qt_score_w := 29;
  elsif ((qt_idade_p = 90) or (qt_idade_p = 91)) then
    qt_score_w := 30;
  elsif (qt_idade_p = 92) then
    qt_score_w := 31;
  elsif (qt_idade_p = 93) then
    qt_score_w := 32;
  elsif (qt_idade_p = 94) then
    qt_score_w := 33;
  end if;

  if (qt_pa_sistolica_p > 120 AND qt_pa_sistolica_p < 139) then
    qt_score_w := qt_score_w + 1;
  elsif (qt_pa_sistolica_p > 140 AND qt_pa_sistolica_p < 159) then
    qt_score_w := qt_score_w + 2;
  elsif (qt_pa_sistolica_p > 160 AND qt_pa_sistolica_p < 179) then
    qt_score_w := qt_score_w + 3;
  elsif (qt_pa_sistolica_p > 179) then
    qt_score_w := qt_score_w + 5;
  end if;

  if (ie_diabetes_p = 'S') then
    qt_score_w := qt_score_w + 4;
  end if;

  if (ie_tabagismo_p = 'S') then
    qt_score_w := qt_score_w + 5;
  end if;

  if (ie_iam_icc_p = 'S') then
    qt_score_w := qt_score_w + 6;
  end if;

  if (ie_sopro_mitral_p = 'S') then
    qt_score_w := qt_score_w + 4;
  end if;

  if (ie_hve_ecg_p = 'S') then
    qt_score_w := qt_score_w + 2;
  end if;

  return qt_score_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_score_escala_fram_fa_md ( qt_idade_p bigint, qt_pa_sistolica_p bigint, ie_diabetes_p text, ie_tabagismo_p text, ie_iam_icc_p text, ie_sopro_mitral_p text, ie_hve_ecg_p text ) FROM PUBLIC;

