-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_orderby_med_valor_dom (cd_dominio_p bigint, ie_excessao_p text default 'N') RETURNS varchar AS $body$
DECLARE

ds_return_w	varchar(255);
ie_ordenacao_desc_w	varchar(1);
dt_Atualizacao_w	timestamp;


BEGIN

begin
	select ie_ordenacao_desc, dt_atualizacao
	into STRICT ie_ordenacao_desc_w, dt_Atualizacao_w
	from med_dominio
	where nr_sequencia = cd_dominio_p;
exception
	when no_data_found then
		ie_ordenacao_desc_w	:= 'S';
		dt_Atualizacao_w	:= trunc(clock_timestamp());
end;

if 	ie_ordenacao_desc_w = 'S' then
	ds_return_w := 'ds_valor_dominio';
elsif	ie_ordenacao_desc_w = 'N' then
	ds_return_w := 'vl_dominio';
elsif	ie_ordenacao_desc_w = 'A' then
	ds_return_w := 'nr_seq_apresent';
else
	ds_return_w := 'ds_valor_dominio';
end if;

if (ie_excessao_p = 'S')
and (trunc(dt_Atualizacao_w) < to_date('22/03/2012','dd/mm/yy')) then
	ds_return_w := 'nr_seq_apresent, ' || ds_return_w;
end if;

return	ds_return_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_orderby_med_valor_dom (cd_dominio_p bigint, ie_excessao_p text default 'N') FROM PUBLIC;

