-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION pls_obter_rede_atendimento ( nr_seq_segurado_p bigint, nr_seq_plano_p bigint) RETURNS varchar AS $body$
DECLARE

 
ds_retorno_w		varchar(10);
ds_acomodacao_w		varchar(15);
ie_retorno_w		varchar(15);
ie_abrangencia_w	varchar(10);
			

BEGIN 
 
select	substr(pls_obter_dados_cart_unimed(nr_seq_segurado_p,nr_seq_plano_p,'DA',0),1,13) 
into STRICT	ds_acomodacao_w
;
 
select	ie_abrangencia 
into STRICT	ie_abrangencia_w 
from	pls_plano 
where	nr_sequencia	= nr_seq_plano_p;
 
if (ie_abrangencia_w = 'GM') then 
	ie_retorno_w	:= 'RB';
elsif (ie_abrangencia_w = 'M') then 
	ie_retorno_w	:= 'MU';
end if;	
 
if (UPPER(ds_acomodacao_w) = 'ENFERMARIA') then 
	ds_retorno_w	:= ie_retorno_w || '01';
elsif (UPPER(ds_acomodacao_w) = 'APARTAMENTO') then 
	ds_retorno_w	:= ie_retorno_w || '02';
end if;	
 
return	ds_retorno_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pls_obter_rede_atendimento ( nr_seq_segurado_p bigint, nr_seq_plano_p bigint) FROM PUBLIC;

