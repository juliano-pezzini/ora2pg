-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_informacao_pessoa ( cd_pessoa_fisica_p text, ie_opcao_p text) RETURNS varchar AS $body$
DECLARE

    ds_retorno_w varchar(40);

BEGIN
    IF ( coalesce(cd_pessoa_fisica_p, 0) > 0 ) THEN
            IF ( ie_opcao_p = 'ie_sexo' ) THEN
                SELECT ie_sexo into STRICT ds_retorno_w FROM (SELECT a.ie_sexo
                    FROM
                        pessoa_fisica a
                    WHERE
                    a.cd_pessoa_fisica = cd_pessoa_fisica_p
                    ORDER BY DT_ATUALIZACAO DESC) alias3 LIMIT 1;
            ELSIF ( ie_opcao_p = 'dt_nascimento' ) THEN
                SELECT dt_nascimento into STRICT ds_retorno_w FROM (SELECT
                        a.dt_nascimento
                    FROM
                        pessoa_fisica a
                    WHERE
                    a.cd_pessoa_fisica = cd_pessoa_fisica_p
                    ORDER BY DT_ATUALIZACAO DESC) alias1 LIMIT 1;
            ELSIF ( ie_opcao_p = 'ie_tipo_sangue' ) THEN
                SELECT ie_tipo_sangue into STRICT ds_retorno_w FROM (SELECT
                        a.ie_tipo_sangue
                    FROM
                        pessoa_fisica a
                    WHERE
                        a.cd_pessoa_fisica = cd_pessoa_fisica_p
                    ORDER BY DT_ATUALIZACAO DESC) alias1 LIMIT 1;
            ELSIF ( ie_opcao_p = 'ie_fator_rh' ) THEN
                SELECT ie_fator_rh into STRICT ds_retorno_w FROM (SELECT
                        a.ie_fator_rh
                    FROM
                        pessoa_fisica a
                    WHERE
                        a.cd_pessoa_fisica = cd_pessoa_fisica_p
                    ORDER BY DT_ATUALIZACAO) alias1 LIMIT 1;
            ELSIF ( ie_opcao_p = 'ds_address_catalog' ) THEN
                SELECT cd_cep into STRICT ds_retorno_w FROM (SELECT
                        a.cd_cep
                    FROM
                        compl_pessoa_fisica a
                    WHERE
                        a.cd_pessoa_fisica = cd_pessoa_fisica_p
                    ORDER BY DT_ATUALIZACAO) alias1 LIMIT 1;
            ELSIF ( ie_opcao_p = 'nr_telefone' ) THEN
                SELECT nr_telefone into STRICT ds_retorno_w FROM (SELECT
                        a.nr_telefone
                    FROM
                        compl_pessoa_fisica a
                    WHERE
                        a.cd_pessoa_fisica = cd_pessoa_fisica_p
                    ORDER BY DT_ATUALIZACAO) alias1 LIMIT 1;
            ELSIF ( ie_opcao_p = 'nr_telefone_celular' ) THEN
                SELECT nr_telefone_celular into STRICT ds_retorno_w FROM (SELECT
                        a.nr_telefone_celular
                    FROM
                        compl_pessoa_fisica a
                    WHERE
                        a.cd_pessoa_fisica = cd_pessoa_fisica_p
                    ORDER BY DT_ATUALIZACAO) alias1 LIMIT 1;
            ELSIF ( ie_opcao_p = 'ds_fone_adic' ) THEN
                SELECT ds_fone_adic into STRICT ds_retorno_w FROM (SELECT
                        a.ds_fone_adic
                    FROM
                        compl_pessoa_fisica a
                    WHERE
                        a.cd_pessoa_fisica = cd_pessoa_fisica_p
                    ORDER BY DT_ATUALIZACAO) alias1 LIMIT 1;
            ELSIF ( ie_opcao_p = 'nm_contato' ) THEN
                SELECT nm_contato into STRICT ds_retorno_w FROM (SELECT
                        a.nm_contato
                    FROM
                        compl_pessoa_fisica a
                    WHERE
                        a.cd_pessoa_fisica = cd_pessoa_fisica_p
                    ORDER BY DT_ATUALIZACAO) alias1 LIMIT 1;
            ELSIF ( ie_opcao_p = 'ie_tipo_complemento' ) THEN
                SELECT ie_tipo_complemento into STRICT ds_retorno_w FROM (SELECT
                        a.ie_tipo_complemento
                    FROM
                        compl_pessoa_fisica a
                    WHERE
                        a.cd_pessoa_fisica = cd_pessoa_fisica_p
                    ORDER BY DT_ATUALIZACAO) alias1 LIMIT 1;
            ELSIF ( ie_opcao_p = 'ds_observacao' ) THEN
                SELECT ds_observacao into STRICT ds_retorno_w FROM (SELECT
                        a.ds_observacao
                    FROM
                        compl_pessoa_fisica a
                    WHERE
                        a.cd_pessoa_fisica = cd_pessoa_fisica_p
                    ORDER BY DT_ATUALIZACAO) alias1 LIMIT 1;
            END IF;
    END IF;

    RETURN ds_retorno_w;
EXCEPTION
    WHEN no_data_found THEN
        RETURN '';
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_informacao_pessoa ( cd_pessoa_fisica_p text, ie_opcao_p text) FROM PUBLIC;

