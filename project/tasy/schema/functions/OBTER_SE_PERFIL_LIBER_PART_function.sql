-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_se_perfil_liber_part ( cd_perfil_p bigint, cd_pessoa_p text) RETURNS bigint AS $body$
DECLARE


qt_regra_perfil_w  bigint;


BEGIN

IF (cd_perfil_p IS NOT NULL AND cd_perfil_p::text <> '') AND (cd_pessoa_p IS NOT NULL AND cd_pessoa_p::text <> '') THEN

	SELECT COUNT(*)
	INTO STRICT   qt_regra_perfil_w
	FROM   regra_consulta_contato a
	WHERE  cd_pessoa_fisica = cd_pessoa_p
	AND    EXISTS ( SELECT  1
	   		FROM   regra_consulta_contato_lib x
			WHERE  x.nr_seq_regra_consulta = a.nr_sequencia
			AND    x.cd_perfil = cd_perfil_p);

END IF;


RETURN	qt_regra_perfil_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_se_perfil_liber_part ( cd_perfil_p bigint, cd_pessoa_p text) FROM PUBLIC;

