-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION bsc_obter_periodo_inf ( nr_seq_indicador_p bigint, nr_seq_inf_p bigint, cd_ano_p bigint, cd_periodo_p bigint) RETURNS varchar AS $body$
DECLARE


cd_ano_w			smallint;
cd_periodo_w			smallint;
ie_periodo_w			varchar(1);
ds_periodo_w			varchar(20);

BEGIN

cd_ano_w			:= cd_ano_p;
cd_periodo_w			:= cd_periodo_p;


if (coalesce(nr_seq_inf_p,0) <> 0) then
	select	max(cd_ano),
		max(cd_periodo)
	into STRICT	cd_ano_w,
		cd_periodo_w
	from	bsc_ind_inf
	where	nr_sequencia = nr_seq_inf_p;
end if;

select	coalesce(ie_periodo,'M')
into STRICT	ie_periodo_w
from	bsc_indicador
where	nr_sequencia = nr_seq_indicador_p;

if (ie_periodo_w = 'A') then
	ds_periodo_w	:= to_char(cd_ano_w);
else
	ds_periodo_w	:= lpad(cd_periodo_w,2,0) || '/' || to_char(cd_ano_w);
end if;

return	ds_periodo_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION bsc_obter_periodo_inf ( nr_seq_indicador_p bigint, nr_seq_inf_p bigint, cd_ano_p bigint, cd_periodo_p bigint) FROM PUBLIC;

