-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION ctb_orc_cen_obter_regra ( ie_retorno_p text, ie_regra_valor_p text) RETURNS varchar AS $body$
DECLARE


ds_atributo_w				varchar(2000);
ds_atributo_obrig_w				varchar(2000);
ds_atributo_desabilitar_w			varchar(2000);


BEGIN

/* Function para controlar a habilitação dos campos na tabela CTB_ORC_CEN_REGRA Dominio 1690*/

/* Todos os atributos visiveis da tabela*/

ds_atributo_obrig_w				:= 'NR_SEQ_REGRA;NR_SEQ_MES_REF_ORIG;CD_CENTRO_CUSTO;CD_CONTA_CONTABIL;' ||
					   'CD_CLASSIF_CONTA;CD_CLASSIF_CENTRO;DT_MES_INIC;DT_MES_FIM;CD_CENTRO_ORIGEM;CD_CONTA_ORIGEM;' ||
					   'IE_REGRA_VALOR;PR_APLICAR;IE_SOBREPOR;VL_FIXO;NR_SEQ_CRITERIO_RATEIO';

ds_atributo_w				:= '';

if (ie_regra_valor_p = 'VF') then
	ds_atributo_desabilitar_w		:= 'NR_SEQ_MES_REF_ORIG;CD_CONTA_ORIGEM;CD_CENTRO_ORIGEM;CD_CLASSIF_CONTA;CD_CLASSIF_CENTRO;PR_APLICAR';
elsif (ie_regra_valor_p = 'PV') then
	ds_atributo_desabilitar_w		:= 'VL_FIXO;NR_SEQ_MES_REF_ORIG;NR_SEQ_CRITERIO_RATEIO';
elsif (ie_regra_valor_p in ('PAV','PPV')) then
	ds_atributo_desabilitar_w		:= 'VL_FIXO;NR_SEQ_CRITERIO_RATEIO';
elsif (ie_regra_valor_p = 'CM') then
	ds_atributo_desabilitar_w		:= 'NR_SEQ_MES_REF_ORIG;CD_CONTA_CONTABIL;CD_CLASSIF_CONTA;CD_CLASSIF_CENTRO;' ||
						   'PR_APLICAR;VL_FIXO;CD_CENTRO_ORIGEM;CD_CONTA_ORIGEM;NR_SEQ_CRITERIO_RATEIO';
elsif (ie_regra_valor_p = 'OD') then
	ds_atributo_desabilitar_w		:= 'NR_SEQ_MES_REF_ORIG;CD_CONTA_CONTABIL;CD_CLASSIF_CONTA;CD_CLASSIF_CENTRO;' ||
						   'PR_APLICAR;VL_FIXO;CD_CENTRO_ORIGEM;CD_CONTA_ORIGEM;NR_SEQ_CRITERIO_RATEIO;' ||
						   'CD_CENTRO_CUSTO;CD_CONTA_CONTABIL;IE_SOBREPOR;DT_MES_INIC;DT_MES_FIM';
end if;

if (ie_retorno_p = 'S') then
	ds_atributo_w				:= ds_atributo_obrig_w;
elsif (ie_retorno_p = 'N') then
	ds_atributo_w				:= ds_atributo_desabilitar_w;
end if;

Return	ds_atributo_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION ctb_orc_cen_obter_regra ( ie_retorno_p text, ie_regra_valor_p text) FROM PUBLIC;

