-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION cpoe_obter_solucao_perit_rel ( ie_tipo_peritoneal_p text, nr_etapas_p bigint, qt_volume_sol_p bigint, pr_concentracao_p bigint, qt_temp_solucao_p bigint, qt_tempo_infusao_p text, qt_tempo_permanencia_p text, qt_tempo_drenagem_p text, ie_lavar_linhas_p text, ie_tidal_p text, ie_ultima_bolsa_p text, opcao_linha_p bigint) RETURNS varchar AS $body$
DECLARE


ds_linha_um_w		varchar(4000);
ds_linha_dois_w		varchar(4000);
ds_retorno_w		varchar(4000);

	function etapas return text is
	;
BEGIN
		return obter_desc_expressao(293763, null) || ': ' || nr_etapas_p || '   ';
	end;

	function volume_sol return varchar2 is
	begin
		return obter_desc_expressao(302274, null) || ': '|| qt_volume_sol_p || '   ';
	end;

	function concentracao return varchar2 is
	begin
		return ' ' || obter_desc_expressao(285621, null) || ': ' || pr_concentracao_p || '   ';
	end;

	function temperatura return varchar2 is
	begin
		return ' ' || obter_desc_expressao(299211, null) || ': ' || qt_temp_solucao_p || '   ';
	end;

	function tempo_infusao return varchar2 is
	begin
		return obter_desc_expressao(668387, null) || ': ' || qt_tempo_infusao_p || '   ';
	end;

	function tempo_permanencia return varchar2 is
	begin
		return obter_desc_expressao(309094, null) || ': ' || qt_tempo_permanencia_p || '   ';
	end;

	function tempo_drenagem return varchar2 is
	begin
		return obter_desc_expressao(299232, null) || ': ' || qt_tempo_drenagem_p || '   ';
	end;

	function dados_dpa return varchar2 is
	begin
		return obter_desc_expressao(292463, null) || ': '|| obter_valor_dominio(6,ie_lavar_linhas_p) || '   ' || obter_desc_expressao(288297, null) || ': '|| obter_valor_dominio(6,ie_tidal_p)
			|| '   ' || obter_desc_expressao(300653, null) || ': '|| obter_valor_dominio(6,ie_ultima_bolsa_p);
	end;

begin

	if (ie_tipo_peritoneal_p = 'DPI') then
		ds_linha_um_w := etapas();
	end if;

	ds_linha_um_w := ds_linha_um_w || volume_sol();

	if (ie_tipo_peritoneal_p <> 'CAPD') then
		ds_linha_um_w := ds_linha_um_w || concentracao();
	end if;

	ds_linha_um_w := ds_linha_um_w || temperatura();

	if (ie_tipo_peritoneal_p <> 'DPA') then
		ds_linha_dois_w := tempo_infusao();
	end if;

	ds_linha_dois_w := ds_linha_dois_w || tempo_permanencia();

	if (ie_tipo_peritoneal_p <> 'DPA') then
		ds_linha_dois_w := ds_linha_dois_w || tempo_drenagem();
	end if;

	if (ie_tipo_peritoneal_p = 'DPA') then
		ds_linha_dois_w := ds_linha_dois_w || dados_dpa();
	end if;

	if (opcao_linha_p = 1) then
		ds_retorno_w := ds_linha_um_w;
	else
		ds_retorno_w := ds_linha_dois_w;
	end if;

	return	ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION cpoe_obter_solucao_perit_rel ( ie_tipo_peritoneal_p text, nr_etapas_p bigint, qt_volume_sol_p bigint, pr_concentracao_p bigint, qt_temp_solucao_p bigint, qt_tempo_infusao_p text, qt_tempo_permanencia_p text, qt_tempo_drenagem_p text, ie_lavar_linhas_p text, ie_tidal_p text, ie_ultima_bolsa_p text, opcao_linha_p bigint) FROM PUBLIC;

