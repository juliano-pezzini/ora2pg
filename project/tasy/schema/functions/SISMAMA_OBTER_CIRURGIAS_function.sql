-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION sismama_obter_cirurgias (nr_sequencia_p bigint) RETURNS varchar AS $body$
DECLARE


dt_segmentectomia_dir_w		varchar(4);
dt_dutectomia_dir_w		varchar(4);
dt_mastectomia_dir_w		varchar(4);
dt_mastectomia_pele_dir_w	varchar(4);
dt_esvaziamento_dir_w		varchar(4);
dt_biopsia_linf_sent_dir_w	varchar(4);
dt_reconstrucao_dir_w		varchar(4);
dt_plastic_redutora_dir_w	varchar(4);
dt_plastic_implante_dir_w	varchar(4);
dt_tumorectomia_dir_w		varchar(4);
dt_tumorectomia_esq_w		varchar(4);
dt_segmentectomia_esq_w		varchar(4);
dt_dutectomia_esq_w		varchar(4);
dt_mastectomia_esq_w		varchar(4);
dt_mastectomia_pele_esq_w	varchar(4);
dt_esvaziamento_esq_w		varchar(4);
dt_biopsia_linf_sent_esq_w	varchar(4);
dt_reconstrucao_esq_w		varchar(4);
dt_plastic_redutora_esq_w	varchar(4);
dt_plastic_implante_esq_w	varchar(4);
ds_retorno_w			varchar(255);


BEGIN

select	dt_segmentectomia_dir,
	dt_dutectomia_dir,
	dt_mastectomia_dir,
	dt_mastectomia_pele_dir,
	dt_esvaziamento_dir,
	dt_biopsia_linf_sent_dir,
	dt_reconstrucao_dir,
	dt_plastic_redutora_dir,
	dt_plastic_implante_dir,
	dt_tumorectomia_dir,
	dt_tumorectomia_esq,
	dt_segmentectomia_esq,
	dt_dutectomia_esq,
	dt_mastectomia_esq,
	dt_mastectomia_pele_esq,
	dt_esvaziamento_esq,
	dt_biopsia_linf_sent_esq,
	dt_reconstrucao_esq,
	dt_plastic_redutora_esq,
	dt_plastic_implante_esq
into STRICT	dt_segmentectomia_dir_w,
	dt_dutectomia_dir_w,
	dt_mastectomia_dir_w,
	dt_mastectomia_pele_dir_w,
	dt_esvaziamento_dir_w,
	dt_biopsia_linf_sent_dir_w,
	dt_reconstrucao_dir_w,
	dt_plastic_redutora_dir_w,
	dt_plastic_implante_dir_w,
	dt_tumorectomia_dir_w,
	dt_tumorectomia_esq_w,
	dt_segmentectomia_esq_w,
	dt_dutectomia_esq_w,
	dt_mastectomia_esq_w,
	dt_mastectomia_pele_esq_w,
	dt_esvaziamento_esq_w,
	dt_biopsia_linf_sent_esq_w,
	dt_reconstrucao_esq_w,
	dt_plastic_redutora_esq_w,
	dt_plastic_implante_esq_w
from	sismama_anamnese_rad
where	nr_seq_sismama = nr_sequencia_p;

if (coalesce(dt_segmentectomia_dir_w,'X') <> 'X') then
	ds_retorno_w := ' Segmentectomia direita,';
end if;
if (coalesce(dt_dutectomia_dir_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Dutectomia direita,';
end if;
if (coalesce(dt_mastectomia_dir_w ,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Mastectomia direita,';
end if;
if (coalesce(dt_mastectomia_pele_dir_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' mastectomia pele direita,';
end if;
if (coalesce(dt_esvaziamento_dir_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Esvaziamento direito,';
end if;
if (coalesce(dt_biopsia_linf_sent_dir_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Biopsia direita,';
end if;
if (coalesce(dt_reconstrucao_dir_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Recontrução direita,';
end if;
if (coalesce(dt_plastic_redutora_dir_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Plastica redutora direita,';
end if;
if (coalesce(dt_plastic_implante_dir_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Plastica implante direita,';
end if;
if (coalesce(dt_tumorectomia_dir_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Tumorectomia direita,';
end if;
if (coalesce(dt_tumorectomia_esq_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Tumorectomia esquerda,';
end if;
if (coalesce(dt_segmentectomia_esq_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Segmentomia esquerda,';
end if;
if (coalesce(dt_dutectomia_esq_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Dutectomia esquerda,';
end if;
if (coalesce(dt_mastectomia_esq_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Mastectomia esquerda,';
end if;
if (coalesce(dt_mastectomia_pele_esq_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Mastectomia pele esquerda,';
end if;
if (coalesce(dt_esvaziamento_esq_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Esvaziamento esquerda,';
end if;
if (coalesce(dt_biopsia_linf_sent_esq_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Biopsia linf esquerda,';
end if;
if (coalesce(dt_reconstrucao_esq_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Recontrução esquerda,';
end if;
if (coalesce(dt_plastic_redutora_esq_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Plástica redutora esquerda,';
end if;
if (coalesce(dt_plastic_implante_esq_w,'X') <> 'X') then
	ds_retorno_w := ds_retorno_w ||' Plástica implante esquerda,';
end if;


return	ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION sismama_obter_cirurgias (nr_sequencia_p bigint) FROM PUBLIC;

