-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION qua_obter_macro_disp_comunic ( cd_tipo_p bigint) RETURNS varchar AS $body$
DECLARE


ds_retorno_w		varchar(2000);
ds_enter_w		varchar(10) := chr(13) || chr(10);


BEGIN

ds_retorno_w :=	substr('@documento = ' || wheb_mensagem_pck.get_texto(301781) || ds_enter_w ||
		'@descricao_documento = ' || wheb_mensagem_pck.get_texto(301785) || ds_enter_w ||
		'@endereco = ' || wheb_mensagem_pck.get_texto(301786)|| ds_enter_w ||
		'@pessoa_revisao = ' || wheb_mensagem_pck.get_texto(301788) || ds_enter_w ||
		'@pessoa_valid_revisao = ' || wheb_mensagem_pck.get_texto(301791) || ds_enter_w ||
		'@pessoa_aprov_revisao = ' || wheb_mensagem_pck.get_texto(301792)|| ds_enter_w ||
		'@pessoa_validacao = ' || wheb_mensagem_pck.get_texto(301793) || ds_enter_w ||
		'@pessoa_aprovacao = ' || wheb_mensagem_pck.get_texto(301794)|| ds_enter_w ||
		'@pessoa_elaboracao = ' || wheb_mensagem_pck.get_texto(301795)|| ds_enter_w ||
		'@data_revisao = ' || wheb_mensagem_pck.get_texto(301797)|| ds_enter_w ||
		'@observacao_revisao = ' || wheb_mensagem_pck.get_texto(301799) || ds_enter_w ||
		'@ds_historico_doc = ' || wheb_mensagem_pck.get_texto(301800) || ds_enter_w ||
		'@data_aprovacao = ' || wheb_mensagem_pck.get_texto(301801)|| ds_enter_w ||
		'@data_validacao = ' || wheb_mensagem_pck.get_texto(301803)|| ds_enter_w ||
		'@data_elaboracao = ' || wheb_mensagem_pck.get_texto(301806)|| ds_enter_w ||
		'@tipo_documento = ' || wheb_mensagem_pck.get_texto(301807) || ds_enter_w ||
		'@dias_revisao = ' || wheb_mensagem_pck.get_texto(301808)|| ds_enter_w ||
		'@status_documento = ' || wheb_mensagem_pck.get_texto(301809) || ds_enter_w ||
		'@situacao_documento = ' || wheb_mensagem_pck.get_texto(301810)|| ds_enter_w ||
		'@data_envio_comunic = ' || wheb_mensagem_pck.get_texto(301811)|| ds_enter_w ||
		'@pessoa_envio_comunic = ' || wheb_mensagem_pck.get_texto(301812)|| ds_enter_w ||
		'@liberacao_arquivo = ' || wheb_mensagem_pck.get_texto(301814),1,2000);


if (cd_tipo_p in ('12','33')) then
	begin
	ds_retorno_w	:= substr(ds_retorno_w || ds_enter_w ||
			   '@nome_treinamento = ' || wheb_mensagem_pck.get_texto(301818)|| ds_enter_w ||
			   '@dt_prev_treinamento = ' || wheb_mensagem_pck.get_texto(301819)|| ds_enter_w ||
			   '@qt_tempo_prev_trein = ' || wheb_mensagem_pck.get_texto(301820)|| ds_enter_w ||
			   '@ds_setor_treinamento = ' || wheb_mensagem_pck.get_texto(301821)|| ds_enter_w ||
			   '@obs_treinamento = ' || wheb_mensagem_pck.get_texto(301822) || ds_enter_w ||
			   '@responsavel_treinamento = ' || wheb_mensagem_pck.get_texto(301823),1,2000);
	end;
end if;

if (cd_tipo_p in ('2','3','4','5','6','7','17','18','20','23','25','37'))  then
	begin
	ds_retorno_w  := substr('@nao_conformidade = ' || wheb_mensagem_pck.get_texto(302055)|| ds_enter_w ||
			'@tipo_nc = ' || wheb_mensagem_pck.get_texto(301839)|| ds_enter_w ||
			'@nome_nao_conformidade = ' || wheb_mensagem_pck.get_texto(301840) || ds_enter_w ||
			'@dt_esperada_rnc = ' || wheb_mensagem_pck.get_texto(301842)|| ds_enter_w ||
			'@nome_estabelecimento = ' || wheb_mensagem_pck.get_texto(301843) || ds_enter_w ||
			'@resp_abertura = ' || wheb_mensagem_pck.get_texto(301844)|| ds_enter_w ||
			'@setor_abertura = ' || wheb_mensagem_pck.get_texto(301846)|| ds_enter_w ||
			'@resp_setor_abertura = ' || wheb_mensagem_pck.get_texto(301847)|| ds_enter_w ||
			'@setor_receptor = ' || wheb_mensagem_pck.get_texto(390359)|| ds_enter_w ||
			'@resp_analise_eficacia = ' || wheb_mensagem_pck.get_texto(301848),1,2000);

	if (cd_tipo_p = '3') then
		ds_retorno_w :=	substr('@ds_ult_historico_os = ' || wheb_mensagem_pck.get_texto(301850) || ds_enter_w || ds_retorno_w,1,2000);
	end if;

	if (cd_tipo_p in ('20','37')) then
		ds_retorno_w :=	substr('@acao = ' || wheb_mensagem_pck.get_texto(343900) || ds_enter_w ||
				'@dano = ' || wheb_mensagem_pck.get_texto(343902)|| ds_enter_w || ds_retorno_w,1,2000);
	elsif (cd_tipo_p = '23') then
		ds_retorno_w :=	substr('@ds_historico_nc = ' || wheb_mensagem_pck.get_texto(343901) || ds_enter_w || ds_retorno_w,1,2000);
	end if;
	end;
elsif (cd_tipo_p = '15')  then
	ds_retorno_w  := substr('@acao = ' || wheb_mensagem_pck.get_texto(343900)|| ds_enter_w ||
			'@dano = ' || wheb_mensagem_pck.get_texto(343902),1,2000);
elsif (cd_tipo_p in ('24','30')) then
	begin
	select	substr(qua_obter_macro_ata(cd_tipo_p),1,2000)
	into STRICT	ds_retorno_w
	;
	end;
elsif (cd_tipo_p = '34') then
	select	substr(qua_obter_macro_disp_evento(cd_tipo_p),1,2000)
	into STRICT	ds_retorno_w
	;
end if;

return ds_retorno_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION qua_obter_macro_disp_comunic ( cd_tipo_p bigint) FROM PUBLIC;

