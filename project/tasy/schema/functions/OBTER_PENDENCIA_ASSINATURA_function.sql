-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_pendencia_assinatura ( nm_usuario_p text, nr_sequencia_p bigint, ie_opcao_p text) RETURNS varchar AS $body$
DECLARE

     ie_retorno_w char(1)                                       := 'N';
     nr_seq_item_pepo_w pep_item_Pendente.nr_seq_item_pepo%TYPE := 0;
     /*
     -- Legenda das pastas

     -- Pastas   Opcao

     -- Anamnese   AN

     -- Anamnese Oncologica   AON     

     -- Atestado   AT

     -- Diagnostico  DG

     -- EHR   ER

     -- Procedimentos PPD

     -- Evolucao   EV

     -- Loco Reg   LR

     -- Parecer Medico  PM

     -- Perda e ganho  PG

     -- Sinal Vital  SV

     -- SAPS / SAE  SA

     -- Aldrete   AD

     -- Posicao   PO

     -- Pele   PL

     -- Incisao   IC

     -- Curativo   CR

     -- Conjunto   CJ

     -- Avaliacao  AV

     --Medicamentos  CAAM

     --Agentes anestesicos  CAAA

     --Terapia hidroeletrolitica  CAAT

     --Materiais   CAAMAT

     --Hemocomponente  CAAH

     -- Monitoramento Analgesia  SVMA

     -- Monit Hemodinamico SVMH

     -- Monit Respiratorio SVMR

     -- Receita   REC

     -- Receita ambulatorial RECAMB

     -- Tecnica Anestesica   CTA

     -- Descricao Anestesica   CDA

     -- Anotacao Quimioterapia QLAN

     -- Medicacao Quimioterapia QLM

     -- Intercorrencia Quimioterapia QLI

     -- Orientacao de Alta OA

     -- Precaucao CIH  CIH

     -- Orientacao de Alta Enf OAE

     -- Tratamento oncologico - Atendimento do ciclo ONC

     -- Historico de saude - Alergia / Reacoes adversas  HSAL

     -- Historico de saude - Doencas previas e atuais  HSAC

     -- Historico de saude - Medicamentos em uso    HSMU

     -- Historico de saude - Habitos       HSHV

     -- Historico de saude - Cirugias      HSCI

     -- Historico de saude - Ocorrencias      HSO

     -- Historico de saude - Acessorio/Ortese/Protese  HSAS

     -- Historico de saude - Historia Familiar    HSAM

     -- Historico de saude - Internacoes      HSI

     -- Historico de saude - Tratamento anteriores   HST

     -- Historico de saude - Soc/Econ/Cult/Out hab   HSS

     -- Historico de saude - Vacina       HSV

     -- Historico de saude - Deficiencia paciente   HSD

     -- Historico de saude - Declaracao saude    HSDS

     -- Historico de saude - Exames do paciente    HSP

     -- Historico de saude - Transfusao      HSTR

     -- Historico de saude - saude de mulher     HSM

     -- Participante -  Fanep        PP

     -- Escala Chung  Fanep      ESC

     -- Escala Possum  Fanep      ESP

     -- Avaliacoes  Fanep      LAVAL

     -- Equipamentos  Fanep      EFAN

     -- Tempos e moviemtnos TMOV

     -- Adm Terapia hidroeletrolitica ADTH	

     -- Adm Hemocomponete/Hemoderivados ADHE				

     -- Adm  Medicamentos ADMD		

     -- Adm Agentes Anestesicos ADAA

     -- Eventos   Fanep      EVT

	 -- Eventos Adversos EVAD

      -- Justificativas / Solicitacoes  JS

      -- Declaracao de obito   DOB

      -- Sumario de alta   SUM

      -- Descricao cirurgia   CDC

       --Participantes  CP

       --Apae APN Alertas anestesia

     */
BEGIN
     IF (ie_opcao_p = 'SVMR') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_atend_monit_resp = nr_sequencia_p
          AND ie_tipo_pendencia       = 'A'
          AND nm_usuario              = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p            = 'SVMA') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE NR_SEQ_ATEND_AVAL_ANALGESIA = nr_sequencia_p
          AND ie_tipo_pendencia           = 'A'
          AND nm_usuario                  = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p                = 'PP') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_pepo_partic = nr_sequencia_p
          AND ie_tipo_pendencia  = 'A'
          AND nm_usuario         = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p       = 'ESP') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_escala_possum = nr_sequencia_p
          AND ie_tipo_pendencia    = 'A'
          AND nm_usuario           = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p         = 'SVMH') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE NR_SEQ_ATEND_MONIT_HEMO = nr_sequencia_p
          AND ie_tipo_pendencia       = 'A'
          AND nm_usuario              = nm_usuario_p LIMIT 1;
          --Evolucao
     ELSIF (ie_opcao_p = 'EV') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE cd_evolucao       = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
          -- Sinal Vital
     ELSIF (ie_opcao_p = 'SV') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_sinal_vital = nr_sequencia_p
          AND ie_tipo_pendencia  = 'A'
          AND nm_usuario         = nm_usuario_p LIMIT 1;
          --Diagnostico
     ELSIF (ie_opcao_p = 'DG') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_diag_doenca = nr_sequencia_p
          AND ie_tipo_pendencia  = 'A'
          AND nm_usuario         = nm_usuario_p LIMIT 1;
          --SAPS / SAE
     ELSIF (ie_opcao_p = 'SA') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_sae        = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
          -- Parecer Medico
     ELSIF (ie_opcao_p = 'PM') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_parecer        = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
          -- Anamnese
     ELSIF (ie_opcao_p = 'AN') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_anamnese   = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
          -- Perda e ganho
     ELSIF (ie_opcao_p = 'PG') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_perda_ganho = nr_sequencia_p
          AND ie_tipo_pendencia  = 'A'
          AND nm_usuario         = nm_usuario_p LIMIT 1;
          -- Loco Reg
     ELSIF (ie_opcao_p = 'LR') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_loco_reg   = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
          -- EHR
     ELSIF (ie_opcao_p = 'ER') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_ehr_reg    = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
          -- PR
     ELSIF (ie_opcao_p = 'PR') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE NR_PRESCRICAO                                 = nr_sequencia_p
          AND ie_tipo_pendencia                             = 'A'
          AND Obter_se_pendencia_prescr(nr_sequencia,'PEP') = 'S'
          AND nm_usuario                                    = nm_usuario_p LIMIT 1;
          -- Atestado
     ELSIF (ie_opcao_p = 'AT') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_atestado   = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
          -- Aldrete
     ELSIF (ie_opcao_p = 'AD') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_aldrete    = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
          -- Posicao
     ELSIF (ie_opcao_p = 'PO') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_posicao    = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
          -- Escala Chung
     ELSIF (ie_opcao_p = 'ESCCC') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_escala_chung = nr_sequencia_p
          AND ie_tipo_pendencia   = 'A'
          AND nm_usuario          = nm_usuario_p LIMIT 1;
          -- Pele
     ELSIF (ie_opcao_p = 'PL') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_pele       = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
          -- Incisao
     ELSIF (ie_opcao_p = 'IC') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_incisao    = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
          -- Curativo
     ELSIF (ie_opcao_p = 'CR') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_curativo   = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
          -- Conjunto
     ELSIF (ie_opcao_p = 'CJ') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_conjunto   = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
          -- Avaliacao
     ELSIF (ie_opcao_p = 'AV') THEN
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_avaliacao  = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p      = 'CAAM') OR   --Medicamentos
          (ie_opcao_p           = 'CAAA') OR   --Agentes anestesicos
          (ie_opcao_p           = 'CAAT') OR   --Terapia hidroeletrolitica
          (ie_opcao_p           = 'CAAMAT') OR --Materiais
          (ie_opcao_p           = 'CAAH') THEN --Hemocomponente
          IF (ie_opcao_p        = 'CAAM') THEN
               nr_seq_item_pepo_w  := 13;
          ELSIF (ie_opcao_p     = 'CAAA') THEN
               nr_seq_item_pepo_w  := 9;
          ELSIF (ie_opcao_p     = 'CAAT') THEN
               nr_seq_item_pepo_w  := 10;
          ELSIF (ie_opcao_p     = 'CAAMAT') THEN
               nr_seq_item_pepo_w  := 37;
          ELSIF (ie_opcao_p     = 'CAAH') THEN
               nr_seq_item_pepo_w  := 43;
          END IF;
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_cirur_agente = nr_sequencia_p
          AND nr_seq_item_pepo    = nr_seq_item_pepo_w
          AND ie_tipo_pendencia   = 'A'
          AND nm_usuario          = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p        = 'HSAL') THEN -- Historico de saude - Alergia / Reacoes adversas
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_alergia = nr_sequencia_p
          AND ie_tipo_pendencia         = 'A'
          AND nm_usuario                = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p              = 'HSAC') THEN -- Historico de saude - Doencas previas e atuais
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_clinico = nr_sequencia_p
          AND ie_tipo_pendencia         = 'A'
          AND nm_usuario                = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p              = 'HSMU') THEN -- Historico de saude - Medicamentos em uso
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_medic_uso = nr_sequencia_p
          AND ie_tipo_pendencia           = 'A'
          AND nm_usuario                  = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p                = 'HSHV') THEN -- Historico de saude - Habitos
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_vicio = nr_sequencia_p
          AND ie_tipo_pendencia       = 'A'
          AND nm_usuario              = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p            = 'HSCI') THEN -- Historico de saude - Cirugias
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_cirurgia = nr_sequencia_p
          AND ie_tipo_pendencia          = 'A'
          AND nm_usuario                 = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p               = 'HSO') THEN -- Historico de saude - Ocorrencias
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_ocorrencia = nr_sequencia_p
          AND ie_tipo_pendencia            = 'A'
          AND nm_usuario                   = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p                 = 'HSAS') THEN -- Historico de saude - Acessorio/Ortese/Protese
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_acessorio = nr_sequencia_p
          AND ie_tipo_pendencia           = 'A'
          AND nm_usuario                  = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p                = 'HSAM') THEN -- Historico de saude - Historia Familiar
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_atend_medic = nr_sequencia_p
          AND ie_tipo_pendencia             = 'A'
          AND nm_usuario                    = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p                  = 'HSI') THEN -- Historico de saude - Internacoes
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_internacao = nr_sequencia_p
          AND ie_tipo_pendencia            = 'A'
          AND nm_usuario                   = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p                 = 'HST') THEN -- Historico de saude - Tratamento anteriores
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_tratamento = nr_sequencia_p
          AND ie_tipo_pendencia            = 'A'
          AND nm_usuario                   = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p                 = 'HSS') THEN -- Historico de saude - Soc/Econ/Cult/Out hab
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_social = nr_sequencia_p
          AND ie_tipo_pendencia        = 'A'
          AND nm_usuario               = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p             = 'HSV') THEN -- Historico de saude - Vacina
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_vacina = nr_sequencia_p
          AND ie_tipo_pendencia        = 'A'
          AND nm_usuario               = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p             = 'HSD') THEN -- Historico de saude - Deficiencia paciente
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_deficiencia = nr_sequencia_p
          AND ie_tipo_pendencia             = 'A'
          AND nm_usuario                    = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p                  = 'HSDS') THEN -- Historico de saude - Declaracao saude
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_declaracao = nr_sequencia_p
          AND ie_tipo_pendencia            = 'A'
          AND nm_usuario                   = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p                 = 'HSP') THEN -- Historico de saude - Exames do paciente
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_exame = nr_sequencia_p
          AND ie_tipo_pendencia       = 'A'
          AND nm_usuario              = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p            = 'HSTR') THEN -- Historico de saude - Transfusao
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_transfusao = nr_sequencia_p
          AND ie_tipo_pendencia            = 'A'
          AND nm_usuario                   = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p                 = 'HSM') THEN -- Historico de saude - saude de mulher
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_hist_saude_mulher = nr_sequencia_p
          AND ie_tipo_pendencia        = 'A'
          AND nm_usuario               = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p             = 'REC') THEN -- Receita
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_receita    = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p      = 'RECAMB') THEN -- Receita Ambulatorial
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_receita_amb = nr_sequencia_p
          AND ie_tipo_pendencia  = 'A'
          AND nm_usuario         = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p       = 'CTA') THEN -- Tecnica Anestesica
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_tecnica_anest = nr_sequencia_p
          AND ie_tipo_pendencia    = 'A'
          AND nm_usuario           = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p         = 'CDA') THEN -- Descricao Anestesica
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_desc_anest = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p      = 'QLAN') THEN -- Anotacao Quimioterapia
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_anotacao   = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p      = 'QLM') THEN -- Medicacao Quimioterapia
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_pac_medic  = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p      = 'QLI') THEN -- Intercorrencia Quimioterapia
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_intercorrencia = nr_sequencia_p
          AND ie_tipo_pendencia     = 'A'
          AND nm_usuario            = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p          = 'OA') THEN -- Orientacao de alta
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE NR_SEQ_ORIENT_ALTA = nr_sequencia_p
          AND ie_tipo_pendencia  = 'A'
          AND nm_usuario         = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p       = 'CIH') THEN -- Precaucao CIH
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE NR_SEQ_PRECAUCAO  = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p      = 'OAF') THEN -- Orientacao de alta enfermagem
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE NR_SEQ_ORIENT_ALTA_ENF = nr_sequencia_p
          AND ie_tipo_pendencia      = 'A'
          AND nm_usuario             = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p           = 'LAVAL') THEN -- Avaliacoes
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE NR_SEQ_ATEND_SRPA = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p      = 'EFAN') THEN -- Equipamentos
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_equip_cirurgia = nr_sequencia_p
          AND ie_tipo_pendencia     = 'A'
          AND nm_usuario            = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p          = 'EVT') THEN -- EVENTOS
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_evento     = nr_sequencia_p
          AND ie_tipo_pendencia = 'A'
          AND nm_usuario        = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p      = 'ONC') THEN -- Tratamento oncologico - Atendimento do ciclo
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE NR_SEQ_ATEND_CICLO = nr_sequencia_p
          AND ie_tipo_pendencia  = 'A'
          AND nm_usuario         = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p      = 'AP') THEN -- Anamnese PEP
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE NR_SEQ_ANAMNESE = nr_sequencia_p
          AND ie_tipo_pendencia  = 'A'
          AND nm_usuario         = nm_usuario_p LIMIT 1;
     ELSIF (ie_opcao_p  =  'JS'  )      -- JS - Justificativas / Solicitacoes 
		OR (ie_opcao_p  =  'DOB' )      -- Declaracao de obito
		OR (ie_opcao_p  =  'APAE')      -- APAE	
		OR (ie_opcao_p  =  'SUM' )      -- Sumario de alta        
		OR (ie_opcao_p  =  'PEE' )      -- Pedido Exame externo
		or (ie_opcao_p  =  'TMOV')      -- Tempos e moviemtnos TMOV	
		or (ie_opcao_p  =  'ADTH')      -- Adm Terapia hidroeletrolitica ADTH	
		or (ie_opcao_p  =  'ADHE')      -- Adm Hemocomponete/Hemoderivados ADHE				
		or (ie_opcao_p  =  'ADMD')      -- Adm  Medicamentos ADMD		
		or (ie_opcao_p  =  'ADAA')      -- Adm Agentes Anestesicos ADAA		
		OR (ie_opcao_p  =  'AON' )  -- Anamnese oncologica                  
		OR (ie_opcao_p  =  'EVL'  )	-- Evolucoes Oftalmologia                
		OR (ie_opcao_p  =  'AGRL' )	-- Angioretinofluoresceinografia Oftalmologia
      OR (ie_opcao_p  =  'ARTL' )	-- Angioretinofluoresceinografia Oftalmologia
		OR (ie_opcao_p  =  'BIOL' )	-- Biometria Oftalmologia
		OR (ie_opcao_p  =  'BICL' )	-- Biomicroscopia Oftalmologia
		OR (ie_opcao_p  =  'CAPL' )	-- Campimetria Oftalmologia
		OR (ie_opcao_p  =  'CERL' ) -- Ceratometria Oftalmologia
		OR (ie_opcao_p  =  'AVNL' )	-- Acuidade visual nova Oftalmologia
		OR (ie_opcao_p  =  'CTL'  )	-- Curva tensional
		OR (ie_opcao_p  =  'DNPL' )	-- Distancia naso pupilar
		OR (ie_opcao_p  =  'EOEL' )	-- Exame ocular externo    
		OR (ie_opcao_p  =  'FNCL' )	-- Fundoscopia
		OR (ie_opcao_p  =  'GNOL' ) -- Gonioscopia
		OR (ie_opcao_p  =  'MIEL' )	-- Microscopia Especular
		OR (ie_opcao_p  =  'ALP' )	-- Alerta paciente  
		OR (ie_opcao_p  =  'EVAD' )	-- Eventos Adversos
		OR (ie_opcao_p  =  'ALA' )	-- Alerta atendimento  
		OR (ie_opcao_p  =  'MOOL' )	-- Motilidade Ocular  
		OR (ie_opcao_p  =  'PAQL' )	--Paquimetria
		OR (ie_opcao_p  =  'PQUL' )	--Paquimetria
		OR (ie_opcao_p  =  'PAVL' ) --Potencial de acuidade visual
		OR (ie_opcao_p  =  'PUPL' ) --Pupilometria
		OR (ie_opcao_p  =  'TOCL' ) --Tomografia de coerencia optica
		OR (ie_opcao_p  =  'TOGL' ) --Tomografia do olho
		OR (ie_opcao_p  =  'TAPL' ) --Tonometria aplanacao
		OR (ie_opcao_p  =  'TPNL' ) --Tonometria aplanacao
		OR (ie_opcao_p  =  'ULTL' ) --Ultrassonografia
		OR (ie_opcao_p  =  'IRIL' ) --Iridectomia
		OR (ie_opcao_p  =  'AVAL' ) --Avaliacao Lacrimal
		OR (ie_opcao_p  =  'DATL' ) --Daltonismo
		OR (ie_opcao_p  =  'CASL' ) --Capsulotomia
		OR (ie_opcao_p  =  'REFL' ) --Refracao
		OR (ie_opcao_p  =  'AURL' ) --Auto Refracao
		OR (ie_opcao_p  =  'MARL' ) --Mapeamento da retina		
		OR (ie_opcao_p  =  'SOHL' ) --Sobrecarga hidrica
		OR (ie_opcao_p  =  'FOTL' ) --Fotocoagulacao
		OR (ie_opcao_p  =  'ACUL' ) --Acuidade Visual
		OR (ie_opcao_p  =  'RECL' ) --Receita
		OR (ie_opcao_p  =  'REOL' ) --Receita de Oculos
		OR (ie_opcao_p  =  'AVN' ) --Avaliacao nutricional
		OR (ie_opcao_p  =  'PPD' ) --Procedimentos PEP
		OR (ie_opcao_p  =  'CDC' ) /*Descricao cirurgia */
		OR (ie_opcao_p  =  'CP' ) /*Descricao cirurgia */
		OR (ie_opcao_p  =  'GRAV' ) /*Gravidez */
		OR (ie_opcao_p  =  'ONL' ) /*Anamnese oftalmo*/
		OR (ie_opcao_p  =  'OAL' ) /*Anexo oftalmo*/
		OR (ie_opcao_p  =  'CNL' ) /*Consentimentos*/
		OR (ie_opcao_p  =  'ODL' ) /*Diagnostico oftalmo*/
		OR (ie_opcao_p  =  'ODF' ) /*Diagnostico oftalmo*/
		OR (ie_opcao_p  =  'OGL' ) /*Orientacoes*/
		OR (ie_opcao_p  =  'OCL' ) /*Conduta oftalmo*/
		OR (ie_opcao_p  =  'OIL' ) /*Imagem oftalmo*/
		OR (ie_opcao_p  =  'LCC' ) /*Controle de cavidade*/
		OR (ie_opcao_p  =  'LFM' ) /*Faturamento Medico*/
		OR (ie_opcao_p  =  'ABP' ) /*Analisador bioquimico*/
		OR (ie_opcao_p  =  'LBI' ) /*Boletim informativo*/
		OR (ie_opcao_p  =  'AEL' ) /*Escala Lee*/
		OR (ie_opcao_p  =  'HSFR' ) /*Historico de saude - Fatores de Risco*/
		OR (ie_opcao_p  =  'HRP' ) /*Historico de saude - Restricoes*/
		OR (ie_opcao_p  =  'ABRO' ) /*Aberrometria ocular*/
		OR (ie_opcao_p  =  'CMA' )  /*Complicacoes Anestesicas*/
     
		OR (ie_opcao_p  =  'APN' )  /*APAE Alertas anestesia*/
		OR (ie_opcao_p  =  'HSAP' ) /*Historico de saude - Amputacoes*/
		OR (ie_opcao_p  =  'HSAT' ) /*Historico de saude - Antecedentes Sexuais*/
		OR (ie_opcao_p  =  'PART') -- Partograma
		OR (ie_opcao_p	=  'NASC') -- Nascimento
		THEN
		
          SELECT coalesce(MAX('S'),'N')
          INTO STRICT ie_retorno_w
          FROM pep_item_Pendente WHERE nr_seq_registro = nr_sequencia_p
          and  IE_TIPO_REGISTRO = ie_opcao_p
          AND ie_tipo_pendencia  = 'A'
          AND nm_usuario         = nm_usuario_p LIMIT 1;
     END IF;

     RETURN ie_retorno_w;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_pendencia_assinatura ( nm_usuario_p text, nr_sequencia_p bigint, ie_opcao_p text) FROM PUBLIC;

