-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION hsm_obter_proc_hor_esp (dt_item_p timestamp, cd_item_p text, cd_item_conv_p text) RETURNS varchar AS $body$
DECLARE



cd_item_w		varchar(20);
ie_dia_semana_w		varchar(01);


BEGIN

cd_item_w	:= cd_item_conv_p;

if (cd_item_p	= 10014) then
	begin

	cd_item_w	:= 610038;

	select	pkg_date_utils.get_WeekDay(dt_item_p)
	into STRICT	ie_dia_semana_w
	;

	if (ie_dia_semana_w = '1') then
		cd_item_w	:= 650013;
	elsif (ie_dia_semana_w = '7') and
		((to_date('01/01/1900 ' || to_char(dt_item_p,'hh24:mi:ss'), 'dd/mm/yyyy hh24:mi:ss') between
				to_date('01/01/1900 00:00:01','dd/mm/yyyy hh24:mi:ss') and
				to_date('01/01/1900 06:59:59','dd/mm/yyyy hh24:mi:ss')) or (to_date('01/01/1900 ' || to_char(dt_item_p,'hh24:mi:ss'), 'dd/mm/yyyy hh24:mi:ss') between
				to_date('01/01/1900 12:00:01','dd/mm/yyyy hh24:mi:ss') and
				to_date('01/01/1900 23:59:59','dd/mm/yyyy hh24:mi:ss'))) then
		cd_item_w	:= 650013;
	elsif	((to_date('01/01/1900 ' || to_char(dt_item_p,'hh24:mi:ss'), 'dd/mm/yyyy hh24:mi:ss') between
				to_date('01/01/1900 00:00:01','dd/mm/yyyy hh24:mi:ss') and
				to_date('01/01/1900 06:59:59','dd/mm/yyyy hh24:mi:ss')) or (to_date('01/01/1900 ' || to_char(dt_item_p,'hh24:mi:ss'), 'dd/mm/yyyy hh24:mi:ss') between
				to_date('01/01/1900 19:00:01','dd/mm/yyyy hh24:mi:ss') and
				to_date('01/01/1900 23:59:59','dd/mm/yyyy hh24:mi:ss'))) then
		cd_item_w	:= 650013;
	end if;


/*	cd_item_w	:= 650013; */

	end;
end if;

return	cd_item_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION hsm_obter_proc_hor_esp (dt_item_p timestamp, cd_item_p text, cd_item_conv_p text) FROM PUBLIC;

