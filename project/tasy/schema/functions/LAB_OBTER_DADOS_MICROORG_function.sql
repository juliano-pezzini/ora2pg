-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION lab_obter_dados_microorg (CD_MEDICAMENTO_P bigint, CD_MICROORGANISMO_P bigint, nr_seq_material_p bigint, IE_OPCAO_P bigint) RETURNS varchar AS $body$
DECLARE


ds_resultado_w		varchar(150);
ds_grupo_w		varchar(40);

/*
Opção 1 - Grupo do medicamento
*/
BEGIN
SELECT 	MAX(ds_grupo)
INTO STRICT	ds_grupo_w
FROM	cih_grupo_microorg	b,
	cih_microorg_medic	a
WHERE	a.nr_seq_grupo_micro 	= b.nr_sequencia
AND	a.cd_microorganismo 	= coalesce(cd_microorganismo_p,a.cd_microorganismo)
AND	a.nr_seq_material	= coalesce(nr_seq_material_p, a.nr_seq_material)
AND	a.cd_medicamento	= cd_medicamento_p;

IF (ie_opcao_p = 1) THEN
	ds_resultado_w := ds_grupo_w;
END IF;

RETURN ds_resultado_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION lab_obter_dados_microorg (CD_MEDICAMENTO_P bigint, CD_MICROORGANISMO_P bigint, nr_seq_material_p bigint, IE_OPCAO_P bigint) FROM PUBLIC;

