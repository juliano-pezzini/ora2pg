-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION cpoe_obter_item_incons (cd_item_p text, ie_tipo_item_p text) RETURNS varchar AS $body$
DECLARE

ds_retorno_w		varchar(2000);

BEGIN

if (ie_tipo_item_p = 'M' or ie_tipo_item_p = 'MAT' or ie_tipo_item_p = 'MCOMP1' or ie_tipo_item_p = 'MCOMP2' or ie_tipo_item_p = 'MCOMP3'
		or ie_tipo_item_p = 'MCOMP4' or ie_tipo_item_p = 'MCOMP5' or ie_tipo_item_p = 'MCOMP6' or ie_tipo_item_p = 'MDIL'
		or ie_tipo_item_p = 'PMAT1' or ie_tipo_item_p = 'PMAT2' or ie_tipo_item_p = 'PMAT3' or ie_tipo_item_p = 'PMAT4' or ie_tipo_item_p = 'PMAT5'
		or ie_tipo_item_p = 'HMAT1' or ie_tipo_item_p = 'HMAT2' or ie_tipo_item_p = 'HMAT3' or ie_tipo_item_p = 'HMAT4' or ie_tipo_item_p = 'HMAT5'
		or ie_tipo_item_p = 'HMAT11'or ie_tipo_item_p = 'HMAT12' or ie_tipo_item_p = 'HMAT13' or ie_tipo_item_p = 'HMAT14'
		or ie_tipo_item_p = 'HMAT21'or ie_tipo_item_p = 'HMAT22' or ie_tipo_item_p = 'HMAT23' or ie_tipo_item_p = 'HMAT24'
		or ie_tipo_item_p = 'HMAT31'or ie_tipo_item_p = 'HMAT32' or ie_tipo_item_p = 'HMAT33' or ie_tipo_item_p = 'HMAT34'
		or ie_tipo_item_p = 'HMAT41'or ie_tipo_item_p = 'HMAT42' or ie_tipo_item_p = 'HMAT43' or ie_tipo_item_p = 'HMAT44'
		or ie_tipo_item_p = 'HMAT51'or ie_tipo_item_p = 'HMAT52' or ie_tipo_item_p = 'HMAT53' or ie_tipo_item_p = 'HMAT54'
		or ie_tipo_item_p = 'HMAT61'or ie_tipo_item_p = 'HMAT62' or ie_tipo_item_p = 'HMAT73' or ie_tipo_item_p = 'HMAT64'
		or ie_tipo_item_p = 'HMAT71'or ie_tipo_item_p = 'HMAT72' or ie_tipo_item_p = 'HMAT63' or ie_tipo_item_p = 'HMAT74'
		or ie_tipo_item_p = 'GMAT1'or ie_tipo_item_p = 'GMAT2' or ie_tipo_item_p = 'GMAT3'
		or ie_tipo_item_p = 'MCOMPADD') then
	ds_retorno_w := obter_desc_material((cd_item_p)::numeric );
elsif (ie_tipo_item_p = 'G') then
	ds_retorno_w := obter_desc_gas((cd_item_p)::numeric );
elsif (ie_tipo_item_p = 'P') then
	ds_retorno_w := obter_desc_proc_interno((cd_item_p)::numeric );
elsif (ie_tipo_item_p = 'R') then
	ds_retorno_w := obter_desc_recomendacao((cd_item_p)::numeric );
elsif (ie_tipo_item_p = 'E' or ie_tipo_item_p = 'S' or ie_tipo_item_p = 'L') then
	ds_retorno_w := obter_desc_material((cd_item_p)::numeric );
elsif (ie_tipo_item_p = 'J') then
	select   max(ds_tipo)
	into STRICT     ds_retorno_w
	from     rep_tipo_jejum
	where    nr_sequencia = (cd_item_p)::numeric;
elsif (ie_tipo_item_p = 'O') then
	ds_retorno_w := substr(obter_nome_dieta((cd_item_p)::numeric ),1,80);
elsif (ie_tipo_item_p = 'HBC') then
	select	max(ds_derivado)
	into STRICT	ds_retorno_w
	from	san_derivado
	where	ie_situacao = 'A'
	and		ie_mostra_prescricao = 'S'
	and		nr_sequencia = (cd_item_p)::numeric;
elsif (ie_tipo_item_p = 'HP') then
	select	max(a.ds_proc_exame) ds
	into STRICT	ds_retorno_w
	from	procedimento b,
			proc_interno a
	where	a.ie_tipo = 'BS'
	and		a.cd_procedimento    = b.cd_procedimento
	and		a.ie_origem_proced   = b.ie_origem_proced
	and		coalesce(a.ie_situacao,'A') = 'A'
	and		coalesce(b.ie_situacao,'A') = 'A'
	and		coalesce(a.ie_exibe_rep,'S') = 'S'
	and	a.cd_procedimento = (cd_item_p)::numeric;
elsif (ie_tipo_item_p = 'DI') then
	if (cd_item_p = 'S') then
		ds_retorno_w := obter_desc_expressao(489925, '');
	elsif (cd_item_p = 'E') then
		ds_retorno_w := obter_desc_expressao(489926, '');
	end if;
elsif (ie_tipo_item_p = 'DP') then
	ds_retorno_w := obter_desc_expressao(314156, '');
elsif (ie_tipo_item_p = 'AP') then
	ds_retorno_w := obter_desc_proc_interno((cd_item_p)::numeric );
elsif (ie_tipo_item_p = 'IR') then
	ds_retorno_w := obter_valor_dominio(10225, cd_item_p);
end if;

return	substr(ds_retorno_w,1,255);

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION cpoe_obter_item_incons (cd_item_p text, ie_tipo_item_p text) FROM PUBLIC;

