-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION intpd_obter_nome_arquivo ( ds_arquivo_p text) RETURNS varchar AS $body$
DECLARE


/*Essa funtion serve para retornar somente o nome do arquivo.
Exemplo: Agente passa para a procedure a string tasy-storage://4eb38bbd-bdc5-42d1-86b8-5e50d4de1978/teste.png?teste.png
A function retorna somente o nome do arquivo, ou seja, teste.png*/
ds_retorno_w			varchar(2000);
ds_arquivo_w			varchar(2000);
ds_arquivo_ww			varchar(2000);
qt_posicao_w			bigint;
qt_posicao_ww			bigint := 0;


BEGIN
ds_arquivo_w		:= substr(ds_arquivo_p,1,2000);

while position('/' in ds_arquivo_w) > 0 loop
	begin
	ds_arquivo_w := substr(ds_arquivo_w,position('/' in ds_arquivo_w)+1,2000);
	end;
end loop;

if (position('?' in ds_arquivo_w) > 0) then
	ds_arquivo_ww := ds_arquivo_w;
	begin
	while position('?' in ds_arquivo_ww) > 0 loop
		begin
		qt_posicao_w	:= position('?' in ds_arquivo_ww);
		ds_arquivo_ww 	:= substr(ds_arquivo_ww, qt_posicao_w +1,2000);
		qt_posicao_ww	:= qt_posicao_ww + qt_posicao_w;
		end;
	end loop;
	ds_arquivo_w := substr(ds_arquivo_w,1,qt_posicao_ww -1);
	end;
end if;

return	ds_arquivo_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION intpd_obter_nome_arquivo ( ds_arquivo_p text) FROM PUBLIC;

