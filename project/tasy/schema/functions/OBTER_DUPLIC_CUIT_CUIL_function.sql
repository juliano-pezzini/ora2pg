-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_duplic_cuit_cuil ( cd_rfc_p pessoa_fisica.cd_rfc%type, cd_curp_p pessoa_fisica.cd_curp%type, cd_pessoa_fisica_p pessoa_fisica.cd_pessoa_fisica%type ) RETURNS varchar AS $body$
DECLARE

qt_duplic_w	bigint;

BEGIN

select	count(*)
into STRICT    qt_duplic_w
from    pessoa_fisica
where (cd_rfc 		= cd_rfc_p
or	cd_curp 		= cd_curp_p)
and	cd_pessoa_fisica	<> cd_pessoa_fisica_p;

if qt_duplic_w > 0 then
        return 'S';
end if;

return 'N';

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_duplic_cuit_cuil ( cd_rfc_p pessoa_fisica.cd_rfc%type, cd_curp_p pessoa_fisica.cd_curp%type, cd_pessoa_fisica_p pessoa_fisica.cd_pessoa_fisica%type ) FROM PUBLIC;

