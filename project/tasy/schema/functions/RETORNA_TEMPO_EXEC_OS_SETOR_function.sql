-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION retorna_tempo_exec_os_setor ( NR_SEQUENCIA_OS_P bigint, CD_SETOR_ATENDIMENTO_P bigint DEFAULT -1) RETURNS bigint AS $body$
DECLARE

 QT_MIN_OS_W		bigint;


BEGIN
  BEGIN
    SELECT coalesce(SUM(A.QT_MINUTO),0)
      INTO STRICT QT_MIN_OS_W
      FROM MAN_ORDEM_SERV_ATIV A,
           USUARIO U
     WHERE A.NM_USUARIO = U.NM_USUARIO
       AND A.NR_SEQ_ORDEM_SERV = NR_SEQUENCIA_OS_P
       AND ((U.CD_SETOR_ATENDIMENTO = CD_SETOR_ATENDIMENTO_P) OR (CD_SETOR_ATENDIMENTO_P = -1));
 EXCEPTION
 	WHEN no_data_found THEN
 		QT_MIN_OS_W := 0;
 	WHEN OTHERS THEN
 		QT_MIN_OS_W := 0;
	END;

 RETURN	QT_MIN_OS_W;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION retorna_tempo_exec_os_setor ( NR_SEQUENCIA_OS_P bigint, CD_SETOR_ATENDIMENTO_P bigint DEFAULT -1) FROM PUBLIC;

