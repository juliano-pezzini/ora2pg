-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_tempo_atend_triagem ( nr_seq_classif_p bigint ) RETURNS bigint AS $body$
DECLARE


qt_min_espera_w				bigint;
immediate_resuscitation_w 	triagem_classif_risco.ie_classif_manchester%type :=	'V';
less_urgent_w 				triagem_classif_risco.ie_classif_manchester%type :=	'VE';
non_urgent_w 				triagem_classif_risco.ie_classif_manchester%type :=	'AZ';
urgente_w 					triagem_classif_risco.ie_classif_manchester%type :=	'A';
very_urgent_w 				triagem_classif_risco.ie_classif_manchester%type :=	'L';
ie_classif_manchester_w		triagem_classif_risco.ie_classif_manchester%type;


BEGIN

	select 	max(ie_classif_manchester)
	into STRICT	ie_classif_manchester_w
	from 	triagem_classif_risco
	where 	IE_SITUACAO = 'A'
	and 	nr_sequencia = nr_seq_classif_p;

	if (ie_classif_manchester_w = immediate_resuscitation_w) then
		qt_min_espera_w := 0;
	elsif (ie_classif_manchester_w = very_urgent_w) then
		qt_min_espera_w := 10;
	elsif (ie_classif_manchester_w = urgente_w) then
		qt_min_espera_w := 30;
	elsif (ie_classif_manchester_w = less_urgent_w) then
		qt_min_espera_w := 90;
	elsif (ie_classif_manchester_w = non_urgent_w) then
		qt_min_espera_w := 120;
	end if;

	return qt_min_espera_w;
	
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_tempo_atend_triagem ( nr_seq_classif_p bigint ) FROM PUBLIC;

