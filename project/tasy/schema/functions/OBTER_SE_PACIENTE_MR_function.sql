-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION obter_se_paciente_mr (NR_ATENDIMENTO_P bigint) RETURNS varchar AS $body$
DECLARE


DS_RETORNO_W	varchar(1);


BEGIN

SELECT  coalesce(MAX('S'), 'N')
INTO STRICT	DS_RETORNO_W
FROM    CIH_CULTURA A,
	CIH_FICHA_OCORRENCIA B
WHERE   1 = 1
AND	NOT EXISTS (	SELECT	1
			FROM	ATENDIMENTO_PACIENTE X
			WHERE	NR_ATENDIMENTO_P = X.NR_ATENDIMENTO
			AND	(DT_DESCOLONIZAR_PACIENTE IS NOT NULL AND DT_DESCOLONIZAR_PACIENTE::text <> '')
			AND	(NM_DESCOLONIZAR_PACIENTE IS NOT NULL AND NM_DESCOLONIZAR_PACIENTE::text <> ''))
AND     A.IE_MULTI_RESISTENTE = 'S'
AND	A.NR_FICHA_OCORRENCIA = B.NR_FICHA_OCORRENCIA
AND	B.NR_ATENDIMENTO = NR_ATENDIMENTO_P;

RETURN	DS_RETORNO_W;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_se_paciente_mr (NR_ATENDIMENTO_P bigint) FROM PUBLIC;

