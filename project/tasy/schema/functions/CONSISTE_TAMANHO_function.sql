-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE FUNCTION consiste_tamanho ( codigo_p text, tamanhos_p text) RETURNS varchar AS $body$
DECLARE


ds_retorno_w	varchar(1) := 'N';
ie_separador_w	varchar(10) := ';';
pos_atual_w	varchar(10);
qt_reg_w	smallint;
pos_ini_w	integer := 1;
pos_fim_w	integer;
nr_atual_w	varchar(50);
tamanhos_w	varchar(255);
BEGIN

tamanhos_w := tamanhos_p;

if (coalesce(tamanhos_w::text, '') = '' or tamanhos_w = '') then
	ds_retorno_w := 'S';
else
	if (position(ie_separador_w in tamanhos_w) = 0) then
		for i in 1..length(tamanhos_w) loop
			pos_atual_w := substr(tamanhos_w,i-1,i);
			if (position(pos_atual_w in '0123456789') = 0) then
				ie_separador_w := pos_atual_w;
				goto PART2;
			end if;
		end loop;
	end if;

<<PART2>>	qt_reg_w := length(tamanhos_w) - length(translate(tamanhos_w, ' ' || ie_separador_w, ' ')) + 1;

	if (qt_reg_w > 1) then
		pos_fim_w := length(substr(tamanhos_w, pos_ini_w, position(ie_separador_w in tamanhos_w) - 1));
	else
		qt_reg_w := 1;
		pos_fim_w := length(codigo_p);
	end if;

	for i in 1..qt_reg_w loop
		nr_atual_w := substr(tamanhos_w, pos_ini_w, pos_fim_w);
		tamanhos_w := substr(tamanhos_w, position(ie_separador_w in tamanhos_w) + 1, length(tamanhos_w));

		if (nr_atual_w = '') then
			nr_atual_w := '999';
		end if;

		if (nr_atual_w = length(codigo_p)) then
			ds_retorno_w := 'S';
			goto FINAL;
		end if;

		if (position(ie_separador_w in tamanhos_w) = 0) then
			pos_fim_w := length(tamanhos_w);
		else
			pos_fim_w := length(substr(tamanhos_w, pos_ini_w, position(ie_separador_w in tamanhos_w) - 1));
		end if;

	end loop;
end if;

<<FINAL>> return ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION consiste_tamanho ( codigo_p text, tamanhos_p text) FROM PUBLIC;

