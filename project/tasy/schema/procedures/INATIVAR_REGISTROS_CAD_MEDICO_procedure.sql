-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE inativar_registros_cad_medico (NM_USUARIO_P text, IE_ORIGEM_IMPORT_P text, NR_SEQUENCIA_P bigint DEFAULT NULL) AS $body$
BEGIN
  IF (trim(both IE_ORIGEM_IMPORT_P) IN ('T', 'X')) THEN
    IF (coalesce(NR_SEQUENCIA_P, 0) = 0) THEN
      UPDATE CADASTRO_MEDICO CM
         SET CM.IE_ORIGEM_IMPORT = IE_ORIGEM_IMPORT_P || 'D',
             CM.NM_USUARIO       = NM_USUARIO_P,
             CM.DT_ATUALIZACAO   = clock_timestamp()
       WHERE CM.IE_ORIGEM_IMPORT = IE_ORIGEM_IMPORT_P;
    ELSE
      UPDATE CADASTRO_MEDICO CM
         SET CM.IE_ORIGEM_IMPORT = IE_ORIGEM_IMPORT_P || 'D',
             CM.NM_USUARIO       = NM_USUARIO_P,
             CM.DT_ATUALIZACAO   = clock_timestamp()
       WHERE CM.NR_SEQUENCIA = NR_SEQUENCIA_P
         AND CM.IE_ORIGEM_IMPORT = IE_ORIGEM_IMPORT_P;
    END IF;

    COMMIT;
  END IF;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE inativar_registros_cad_medico (NM_USUARIO_P text, IE_ORIGEM_IMPORT_P text, NR_SEQUENCIA_P bigint DEFAULT NULL) FROM PUBLIC;

