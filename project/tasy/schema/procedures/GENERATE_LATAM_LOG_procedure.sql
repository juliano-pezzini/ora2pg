-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE generate_latam_log ( nr_seq_requisito_p LATAM_LOG.NR_SEQ_REQUISITO%type, ie_liberar_desenv_old_p LATAM_LOG.IE_LIBERAR_DESENV%type, nr_seq_objeto_p DIC_OBJETO.NR_SEQUENCIA%type ) AS $body$
DECLARE

    ds_observacao_w         LATAM_REQUISITO.DS_OBSERVACAO%type;
    nm_usuario_w            LATAM_REQUISITO.NM_USUARIO%type;
    ie_liberar_desenv_w     LATAM_REQUISITO.ie_liberar_desenv%type;

BEGIN

SELECT IE_LIBERAR_DESENV
INTO STRICT   ie_liberar_desenv_w
FROM   LATAM_REQUISITO
WHERE  LATAM_REQUISITO.NR_SEQUENCIA = nr_seq_requisito_p;

ds_observacao_w := SUBSTR(obter_desc_expressao(nr_seq_objeto_p),1, 2000);
nm_usuario_w    := wheb_usuario_pck.get_nm_usuario;

INSERT INTO LATAM_LOG(NR_SEQUENCIA,
                       DT_ATUALIZACAO,
                       NM_USUARIO,
                       NR_SEQ_REQUISITO,
                       IE_LIBERAR_DESENV_OLD,
                       IE_LIBERAR_DESENV,
                       DS_OBSERVACAO)
            VALUES (nextval('latam_log_seq'),
                       clock_timestamp(),
                       nm_usuario_w,
                       nr_seq_requisito_p,
                       ie_liberar_desenv_old_p,
                       ie_liberar_desenv_w,
                       ds_observacao_w);
                       
COMMIT;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE generate_latam_log ( nr_seq_requisito_p LATAM_LOG.NR_SEQ_REQUISITO%type, ie_liberar_desenv_old_p LATAM_LOG.IE_LIBERAR_DESENV%type, nr_seq_objeto_p DIC_OBJETO.NR_SEQUENCIA%type ) FROM PUBLIC;

