-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE alterar_item_lote_audit_just (nr_seq_hist_item_p bigint, cd_motivo_glosa_p bigint, ie_acao_glosa_p text, ds_justificativa_p text, nm_usuario_p text) AS $body$
DECLARE



ie_acao_glosa_w		varchar(1);
cd_motivo_glosa_w	integer;
ds_observacao_w		varchar(4000);



BEGIN

select	max(a.ie_acao_glosa),
	max(a.cd_motivo_glosa),
	max(a.ds_observacao)
into STRICT	ie_acao_glosa_w,
	cd_motivo_glosa_w,
	ds_observacao_w
from	lote_audit_hist_item a
where	a.nr_sequencia		= nr_seq_hist_item_p;

ie_acao_glosa_w 	:= coalesce(ie_acao_glosa_p ,ie_acao_glosa_w);
cd_motivo_glosa_w 	:= coalesce(cd_motivo_glosa_p ,cd_motivo_glosa_w);
ds_observacao_w 	:= coalesce(ds_justificativa_p ,ds_observacao_w);
	
update	lote_audit_hist_item
set	dt_atualizacao		= clock_timestamp(),
	nm_usuario		= nm_usuario_p,
	ie_acao_glosa		= ie_acao_glosa_w,
	cd_motivo_glosa		= cd_motivo_glosa_w,
	ds_observacao		= ds_observacao_w
where	nr_sequencia		= nr_seq_hist_item_p;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE alterar_item_lote_audit_just (nr_seq_hist_item_p bigint, cd_motivo_glosa_p bigint, ie_acao_glosa_p text, ds_justificativa_p text, nm_usuario_p text) FROM PUBLIC;

