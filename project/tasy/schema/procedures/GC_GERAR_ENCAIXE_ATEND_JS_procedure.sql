-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gc_gerar_encaixe_atend_js ( cd_medico_enc_atend_p text, qt_min_dur_atend_p bigint, cd_pessoa_enc_atend_p text, ds_pessoa_enc_atend_p text, nr_atendimento_p bigint, nr_seq_proc_interno_p bigint, cd_procedimento_p bigint, ie_origem_proced_p bigint, ie_lado_atend_p text, obs_enc_atend_p text, nm_pessoa_contato_enc_p text, cd_agenda_p bigint, dt_agenda_p timestamp, hr_inicio_p timestamp, ie_status_agenda_p text, nm_usuario_p text, cd_estabelecimento_p bigint, ie_carater_cirurgia_p text default null, cd_procedencia_p text default null) AS $body$
DECLARE


nr_seq_agenda_w	bigint;
ds_erro_2_w	varchar(255);
					

BEGIN

CALL consiste_se_agenda_unica(0,cd_agenda_p,dt_agenda_p,hr_inicio_p,ie_status_agenda_p,nm_usuario_p,cd_estabelecimento_p);
	
if (cd_medico_enc_atend_p <> '') then
	begin
	CALL WHEB_MENSAGEM_PCK.Exibir_Mensagem_Abort(53486);
	end;
end if;
	
SELECT * FROM gerar_encaixe_atend_agenda(	dt_agenda_p, qt_min_dur_atend_p, cd_pessoa_enc_atend_p, ds_pessoa_enc_atend_p, nr_atendimento_p, cd_medico_enc_atend_p, nr_seq_proc_interno_p, cd_procedimento_p, ie_origem_proced_p, ie_lado_atend_p, cd_agenda_p, cd_estabelecimento_p, nm_usuario_p, obs_enc_atend_p, nm_pessoa_contato_enc_p, nr_seq_agenda_w, ie_carater_cirurgia_p, cd_procedencia_p, ds_erro_2_w, null) INTO STRICT nr_seq_agenda_w, ds_erro_2_w;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gc_gerar_encaixe_atend_js ( cd_medico_enc_atend_p text, qt_min_dur_atend_p bigint, cd_pessoa_enc_atend_p text, ds_pessoa_enc_atend_p text, nr_atendimento_p bigint, nr_seq_proc_interno_p bigint, cd_procedimento_p bigint, ie_origem_proced_p bigint, ie_lado_atend_p text, obs_enc_atend_p text, nm_pessoa_contato_enc_p text, cd_agenda_p bigint, dt_agenda_p timestamp, hr_inicio_p timestamp, ie_status_agenda_p text, nm_usuario_p text, cd_estabelecimento_p bigint, ie_carater_cirurgia_p text default null, cd_procedencia_p text default null) FROM PUBLIC;

