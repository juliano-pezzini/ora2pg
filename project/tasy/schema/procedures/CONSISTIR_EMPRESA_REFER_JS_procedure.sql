-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE consistir_empresa_refer_js ( cd_empresa_p bigint, cd_convenio_p bigint, ds_msg_aviso_p INOUT text) AS $body$
DECLARE


qt_empresa_referencia_w	bigint;
ds_empresa_w		varchar(100);


BEGIN

select 	coalesce(count(*),0)
into STRICT	qt_empresa_referencia_w
from   	empresa_referencia_conv
where  	cd_empr_ref = cd_empresa_p
and    	(cd_convenio IS NOT NULL AND cd_convenio::text <> '');

if (qt_empresa_referencia_w > 0)then
	begin

	select 	coalesce(count(*),0)
	into STRICT	qt_empresa_referencia_w
	from   	empresa_referencia_conv
	where  	cd_empr_ref = cd_empresa_p
	and    	cd_convenio = cd_convenio_p;

	if (qt_empresa_referencia_w = 0)then
		begin

		ds_empresa_w	:= obter_nome_empresa_ref(cd_empresa_p);
		ds_msg_aviso_p	:= wheb_mensagem_pck.get_texto(313584,'NM_EMPRESA_CONV='||ds_empresa_w);

		end;
	end if;

	end;
end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE consistir_empresa_refer_js ( cd_empresa_p bigint, cd_convenio_p bigint, ds_msg_aviso_p INOUT text) FROM PUBLIC;

