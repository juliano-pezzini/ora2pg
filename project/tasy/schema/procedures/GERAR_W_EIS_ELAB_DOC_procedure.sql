-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_w_eis_elab_doc () AS $body$
BEGIN

delete	from W_EIS_QUA_DOC_ELAB;


/******* Ano anterior *********/

insert into W_EIS_QUA_DOC_ELAB(
	CD_ESTABELECIMENTO,
	CD_SETOR_ATENDIMENTO,
	CD_ANO,
	NR_ANO,
	QT_JAN,
	QT_FEV,
	QT_MAR,
	QT_ABR,
	QT_MAI,
	QT_JUN,
	QT_JUL,
	QT_AGO,
 	QT_SET,
	QT_OUT,
	QT_NOV,
	QT_DEZ,
	QT_MEDIA)
SELECT	coalesce(cd_estabelecimento,0),
	cd_setor_atendimento,
	TO_CHAR(TRUNC(clock_timestamp(), 'yy')-1, 'yyyy') cd_ano,
	somente_numero(TO_CHAR(TRUNC(clock_timestamp(), 'yy')-1, 'yyyy')) nr_ano,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='01' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_jan,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='02' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_fev,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='03' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_mar,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='04' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_abr,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='05' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_mai,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='06' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_jun,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='07' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_jul,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='08' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_ago,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='09' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_set,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='10' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_out,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='11' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_nov,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='12' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_dez,
	dividir(SUM(dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100) , SUM(CASE WHEN dividir(QT_DOC_ELABORADO, QT_DOCUMENTO)=0 THEN  0  ELSE 1 END )) qt_media
from 	eis_qua_doc_elab
where (TRUNC(dt_referencia, 'yy')) = TRUNC((TRUNC(clock_timestamp(), 'yy')-1),'yy')
GROUP	BY TO_CHAR(TRUNC(clock_timestamp(), 'yy')-1, 'yyyy'),
	somente_numero(TO_CHAR(TRUNC(clock_timestamp(), 'yy')-1, 'yyyy')),
	cd_estabelecimento, cd_setor_atendimento;

insert into W_EIS_QUA_DOC_ELAB(
	CD_ESTABELECIMENTO,
	CD_SETOR_ATENDIMENTO,
	CD_ANO,
	NR_ANO,
	QT_JAN,
	QT_FEV,
	QT_MAR,
	QT_ABR,
	QT_MAI,
	QT_JUN,
	QT_JUL,
	QT_AGO,
 	QT_SET,
	QT_OUT,
	QT_NOV,
	QT_DEZ,
	QT_MEDIA)
SELECT	cd_estab,
		nr_seq,
		cd_ano,
		nr_ano,
		sum(qt_jan),
		sum(qt_fev),
		sum(qt_mar),
		sum(qt_abr),
		sum(qt_mai),
		sum(qt_jun),
		sum(qt_jul),
		sum(qt_ago),
		sum(qt_set),
		sum(qt_out),
		sum(qt_nov),
		sum(qt_dez),
		sum(qt_media) / 12
from	(select	coalesce(cd_estabelecimento,0) cd_estab,
				-1 nr_seq,
				TO_CHAR(TRUNC(clock_timestamp(), 'yy')-1, 'yyyy') cd_ano,
				somente_numero(TO_CHAR(TRUNC(clock_timestamp(), 'yy')-1, 'yyyy')) nr_ano,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='01' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='01' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_jan,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='02' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='02' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_fev,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='03' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='03' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_mar,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='04' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='04' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_abr,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='05' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='05' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_mai,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='06' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='06' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_jun,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='07' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='07' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_jul,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='08' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='08' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_ago,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='09' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='09' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_set,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='10' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='10' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_out,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='11' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='11' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_nov,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='12' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='12' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_dez,
				coalesce((dividir(SUM(QT_DOC_ELABORADO), SUM(qt_documento)) * 100),0) qt_media
		FROM 	eis_qua_doc_elab
		WHERE (TRUNC(dt_referencia, 'yy')) = TRUNC((TRUNC(clock_timestamp(), 'yy')-1),'yy')
		GROUP	BY TO_CHAR(TRUNC(clock_timestamp(), 'yy')-1, 'yyyy'),
				somente_numero(TO_CHAR(TRUNC(clock_timestamp(), 'yy')-1, 'yyyy')),
				cd_estabelecimento,
				dt_referencia) alias124
group  by	cd_estab,
			nr_seq,
			cd_ano,
			nr_ano;

/******* Ano atual *********/

insert into W_EIS_QUA_DOC_ELAB(
	CD_ESTABELECIMENTO,
	CD_SETOR_ATENDIMENTO,
	CD_ANO,
	NR_ANO,
	QT_JAN,
	QT_FEV,
	QT_MAR,
	QT_ABR,
	QT_MAI,
	QT_JUN,
	QT_JUL,
	QT_AGO,
 	QT_SET,
	QT_OUT,
	QT_NOV,
	QT_DEZ,
	QT_MEDIA)
SELECT	coalesce(cd_estabelecimento,0),
	cd_setor_atendimento,
	to_char(trunc(clock_timestamp(), 'yy'), 'yyyy') cd_ano,
	somente_numero(to_char(trunc(clock_timestamp(), 'yy'), 'yyyy')) nr_ano,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='01' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_jan,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='02' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_fev,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='03' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_mar,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='04' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_abr,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='05' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_mai,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='06' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_jun,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='07' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_jul,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='08' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_ago,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='09' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_set,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='10' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_out,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='11' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_nov,
	coalesce(max(CASE WHEN to_char(dt_referencia, 'mm')='12' THEN  dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100  ELSE 0 END ),0) qt_dez,
	dividir(SUM(dividir(QT_DOC_ELABORADO, QT_DOCUMENTO) * 100) , SUM(CASE WHEN dividir(QT_DOC_ELABORADO, QT_DOCUMENTO)=0 THEN  0  ELSE 1 END )) qt_media
from 	eis_qua_doc_elab
where	trunc(dt_referencia, 'yy') = trunc(clock_timestamp(), 'yy')
group	by to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'),
	somente_numero(to_char(trunc(clock_timestamp(), 'yy'), 'yyyy')),
	cd_estabelecimento, cd_setor_atendimento;

insert into W_EIS_QUA_DOC_ELAB(
	CD_ESTABELECIMENTO,
	CD_SETOR_ATENDIMENTO,
	CD_ANO,
	NR_ANO,
	QT_JAN,
	QT_FEV,
	QT_MAR,
	QT_ABR,
	QT_MAI,
	QT_JUN,
	QT_JUL,
	QT_AGO,
 	QT_SET,
	QT_OUT,
	QT_NOV,
	QT_DEZ,
	QT_MEDIA)
SELECT	cd_estab,
		nr_seq,
		cd_ano,
		nr_ano,
		sum(qt_jan),
		sum(qt_fev),
		sum(qt_mar),
		sum(qt_abr),
		sum(qt_mai),
		sum(qt_jun),
		sum(qt_jul),
		sum(qt_ago),
		sum(qt_set),
		sum(qt_out),
		sum(qt_nov),
		sum(qt_dez),
		sum(qt_media) / 12
from	(SELECT	coalesce(cd_estabelecimento,0) cd_estab,
				-1 nr_seq,
				TO_CHAR(TRUNC(clock_timestamp(), 'yy'), 'yyyy') cd_ano,
				somente_numero(TO_CHAR(TRUNC(clock_timestamp(), 'yy'), 'yyyy')) nr_ano,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='01' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='01' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_jan,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='02' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='02' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_fev,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='03' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='03' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_mar,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='04' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='04' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_abr,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='05' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='05' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_mai,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='06' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='06' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_jun,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='07' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='07' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_jul,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='08' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='08' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_ago,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='09' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='09' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_set,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='10' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='10' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_out,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='11' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='11' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_nov,
				coalesce((dividir(CASE WHEN TO_CHAR(dt_referencia, 'mm')='12' THEN SUM(QT_DOC_ELABORADO)  ELSE 0 END  , CASE WHEN TO_CHAR(dt_referencia, 'mm')='12' THEN SUM(QT_DOCumento)  ELSE 0 END ) * 100),0) qt_dez,
				coalesce((dividir(SUM(QT_DOC_ELABORADO), SUM(qt_documento)) * 100),0) qt_media
		FROM 	eis_qua_doc_elab
		WHERE	TRUNC(dt_referencia, 'yy') = TRUNC(clock_timestamp(), 'yy')
		GROUP	BY TO_CHAR(TRUNC(clock_timestamp(), 'yy'), 'yyyy'),
				somente_numero(TO_CHAR(TRUNC(clock_timestamp(), 'yy'), 'yyyy')),
				cd_estabelecimento,
				dt_referencia) alias121
group  by	cd_estab,
			nr_seq,
			cd_ano,
			nr_ano;

insert into W_EIS_QUA_DOC_ELAB(
	CD_ESTABELECIMENTO,
	CD_SETOR_ATENDIMENTO,
	CD_ANO,
	NR_ANO,
	QT_JAN,
	QT_FEV,
	QT_MAR,
	QT_ABR,
	QT_MAI,
	QT_JUN,
	QT_JUL,
	QT_AGO,
 	QT_SET,
	QT_OUT,
	QT_NOV,
	QT_DEZ,
	QT_MEDIA)
SELECT	coalesce(cd_estabelecimento,0),
	0 cd_setor_atendimento,
	'Meta' cd_ano,
	0,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 1, 'P') qt_jan,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 1, 'P') qt_fev,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 1, 'P') qt_mar,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 1, 'P') qt_abr,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 1, 'P') qt_mai,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 1, 'P') qt_jun,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 2, 'P') qt_jul,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 2, 'P') qt_ago,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 2, 'P') qt_set,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 2, 'P') qt_out,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 2, 'P') qt_nov,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 2, 'P') qt_dez,
	0 qt_media
from 	estabelecimento
group by cd_estabelecimento;

insert into W_EIS_QUA_DOC_ELAB(
	CD_ESTABELECIMENTO,
	CD_SETOR_ATENDIMENTO,
	CD_ANO,
	NR_ANO,
	QT_JAN,
	QT_FEV,
	QT_MAR,
	QT_ABR,
	QT_MAI,
	QT_JUN,
	QT_JUL,
	QT_AGO,
 	QT_SET,
	QT_OUT,
	QT_NOV,
	QT_DEZ,
	QT_MEDIA)
SELECT	cd_estabelecimento,
	0 cd_setor_atendimento,
	'Bench' cd_ano,
	1,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 1, 'B') qt_jan,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 1, 'B') qt_fev,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 1, 'B') qt_mar,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 1, 'B') qt_abr,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 1, 'B') qt_mai,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 1, 'B') qt_jun,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 2, 'B') qt_jul,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 2, 'B') qt_ago,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 2, 'B') qt_set,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 2, 'B') qt_out,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 2, 'B') qt_nov,
	Eis_Obter_Meta_Indicador(cd_estabelecimento, 451, (to_char(trunc(clock_timestamp(), 'yy'), 'yyyy'))::numeric , 2, 'B') qt_dez,
	0 qt_media
from 	estabelecimento
group by cd_estabelecimento;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_w_eis_elab_doc () FROM PUBLIC;

