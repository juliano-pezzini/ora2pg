-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE baca_ajustar_interf_susunif ( nm_usuario_p text) AS $body$
DECLARE



qt_registro_w		bigint;
qt_carateres_w		integer	:= 0;
ie_tipo_atributo_w	varchar(10);
qt_tamanho_w		bigint;



BEGIN

/* Felipe 27/01/2008 - Alterar para Varchar2 o campo CD_CBOR da w_susaih_interf_conta */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CONTA'
	and 	column_name	= 'CD_CBOR'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CONTA ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CONTA modify CD_CBOR VARCHAR2(6)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CONTA'
	and	nm_atributo	= 'CD_CBOR';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CONTA' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'CD_CBOR' || chr(39));
	end if;
end if;

/* Felipe 27/01/2008 - Alterar para Varchar2 o campo CD_CNAER da w_susaih_interf_conta */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CONTA'
	and 	column_name	= 'CD_CNAER'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CONTA ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CONTA modify CD_CNAER VARCHAR2(3)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CONTA'
	and	nm_atributo	= 'CD_CNAER';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CONTA' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'CD_CNAER' || chr(39));
	end if;
end if;

/* Felipe 27/01/2008 - Alterar para Varchar2 o campo IE_VINCULO_PREV da w_susaih_interf_conta */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CONTA'
	and 	column_name	= 'IE_VINCULO_PREV'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CONTA ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CONTA modify IE_VINCULO_PREV VARCHAR2(1)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CONTA'
	and	nm_atributo	= 'IE_VINCULO_PREV';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CONTA' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'IE_VINCULO_PREV' || chr(39));
	end if;
end if;

/* Felipe 27/01/2008 - Alterar o campo 65 - CD_CBOR para Varchar */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	qt_decimais		 = NULL,
			ie_tipo_atributo	= 'VARCHAR2'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'CD_CBOR'
		and	nr_seq_atributo		= 65;
		commit;
	end if;
end if;

/* Felipe 27/01/2008 - Alterar o campo 66 - CD_CNAER para Varchar */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	qt_decimais		 = NULL,
			ie_tipo_atributo	= 'VARCHAR2'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'CD_CNAER'
		and	nr_seq_atributo		= 66;
		commit;
	end if;
end if;

/* Felipe 27/01/2008 - Alterar o campo 67 - IE_VINCULO_PREV para Varchar */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	qt_decimais		 = NULL,
			ie_tipo_atributo	= 'VARCHAR2'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'IE_VINCULO_PREV'
		and	nr_seq_atributo		= 67;
		commit;
	end if;
end if;

/* Felipe 27/01/2008 - Alterar para Varchar2 o campo NR_CPF_DIRETOR_CLI da w_susaih_interf_conta */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CONTA'
	and 	column_name	= 'NR_CPF_DIRETOR_CLI'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CONTA ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CONTA modify NR_CPF_DIRETOR_CLI VARCHAR2(11)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CONTA'
	and	nm_atributo	= 'NR_CPF_DIRETOR_CLI';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CONTA' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'NR_CPF_DIRETOR_CLI' || chr(39));
	end if;
end if;

/* Felipe 27/01/2008 - Alterar para Varchar2 o campo NR_CPF_MEDICO_AUT da w_susaih_interf_conta */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CONTA'
	and 	column_name	= 'NR_CPF_MEDICO_AUT'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CONTA ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CONTA modify NR_CPF_MEDICO_AUT VARCHAR2(11)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CONTA'
	and	nm_atributo	= 'NR_CPF_MEDICO_AUT';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CONTA' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'NR_CPF_MEDICO_AUT' || chr(39));
	end if;
end if;

/* Felipe 27/01/2008 - Alterar para Varchar2 o campo NR_CPF_MEDICO_RESP da w_susaih_interf_conta */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CONTA'
	and 	column_name	= 'NR_CPF_MEDICO_RESP'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CONTA ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CONTA modify NR_CPF_MEDICO_RESP VARCHAR2(11)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CONTA'
	and	nm_atributo	= 'NR_CPF_MEDICO_RESP';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CONTA' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'NR_CPF_MEDICO_RESP' || chr(39));
	end if;
end if;

/* Felipe 27/01/2008 - Alterar para Varchar2 o campo NR_CPF_MEDICO_SOLIC da w_susaih_interf_conta */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CONTA'
	and 	column_name	= 'NR_CPF_MEDICO_SOLIC'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CONTA ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CONTA modify NR_CPF_MEDICO_SOLIC VARCHAR2(11)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CONTA'
	and	nm_atributo	= 'NR_CPF_MEDICO_SOLIC';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CONTA' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'NR_CPF_MEDICO_SOLIC' || chr(39));
	end if;
end if;

/* Felipe 27/01/2008 - Alterar para Varchar2 o campo NR_CPF_EXECUTOR da w_susaih_interf_item */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_ITEM'
	and 	column_name	= 'NR_CPF_EXECUTOR'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_ITEM ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_ITEM modify NR_CPF_EXECUTOR VARCHAR2(11)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_ITEM'
	and	nm_atributo	= 'NR_CPF_EXECUTOR';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_ITEM' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'NR_CPF_EXECUTOR' || chr(39));
	end if;
end if;

/* Felipe 27/01/2008 - Alterar o campo 27 - CD_DOC_MEDICO_SOLIC para Varchar */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	qt_decimais		 = NULL,
			ie_tipo_atributo	= 'VARCHAR2'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'CD_DOC_MEDICO_SOLIC'
		and	nr_seq_atributo		= 27;
		commit;
	end if;
end if;

/* Felipe 27/01/2008 - Alterar o campo 29 - CD_DOC_MEDICO_RESP para Varchar */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	qt_decimais		 = NULL,
			ie_tipo_atributo	= 'VARCHAR2'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'CD_DOC_MEDICO_RESP'
		and	nr_seq_atributo		= 29;
		commit;
	end if;
end if;


/* Felipe 27/01/2008 - Alterar o campo 31 - CD_DOC_MEDICO_SOLIC para Varchar */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	qt_decimais		 = NULL,
			ie_tipo_atributo	= 'VARCHAR2'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'CD_DOC_DIRETOR_CLI'
		and	nr_seq_atributo		= 31;
		commit;
	end if;
end if;


/* Felipe 27/01/2008 - Alterar o campo 33 - CD_DOC_MEDICO_SOLIC para Varchar */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	qt_decimais		 = NULL,
			ie_tipo_atributo	= 'VARCHAR2'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'CD_DOC_MEDICO_AUT'
		and	nr_seq_atributo		= 27;
		commit;
	end if;
end if;

/* Felipe 28/01/2008 - Alterar para Varchar2 o campo CD_RACA_COR da w_susbpa_interf */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSBPA_INTERF'
	and 	column_name	= 'CD_RACA_COR'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSBPA_INTERF ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSBPA_INTERF modify CD_RACA_COR VARCHAR2(2)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSBPA_INTERF'
	and	nm_atributo	= 'CD_RACA_COR';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSBPA_INTERF' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'CD_RACA_COR' || chr(39));
	end if;
end if;

/* Felipe 28/01/2008 - Alterar para Varchar2 o campo CD_CNES_HOSPITAL da w_susaih_interf_cab */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CAB'
	and 	column_name	= 'CD_CNES_HOSPITAL'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CAB ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CAB modify CD_CNES_HOSPITAL VARCHAR2(7)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CAB'
	and	nm_atributo	= 'CD_CNES_HOSPITAL';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CAB' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'CD_CNES_HOSPITAL' || chr(39));
	end if;
end if;

/* Felipe 28/01/2008 - Alterar para Varchar2 o campo CD_CNES da w_susaih_interf_item */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_ITEM'
	and 	column_name	= 'CD_CNES'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_ITEM ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_ITEM modify CD_CNES VARCHAR2(7)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_ITEM'
	and	nm_atributo	= 'CD_CNES';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_ITEM' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'CD_CNES' || chr(39));
	end if;
end if;

/* Felipe 28/01/2008 - Alterar para Varchar2 o campo CD_CARATER_ATENDIMENTO da w_susbpa_interf*/

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSBPA_INTERF'
	and 	column_name	= 'CD_CARATER_ATENDIMENTO'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSBPA_INTERF ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSBPA_INTERF modify CD_CARATER_ATENDIMENTO VARCHAR2(2)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSBPA_INTERF'
	and	nm_atributo	= 'CD_CARATER_ATENDIMENTO';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSBPA_INTERF' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'CD_CARATER_ATENDIMENTO' || chr(39));
	end if;
end if;

/* Felipe 04/02/2008 - Alterar para Varchar2 o campo NR_DOC_PACIENTE da w_susaih_interf_conta */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CONTA'
	and 	column_name	= 'NR_DOC_PACIENTE'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CONTA ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CONTA modify NR_DOC_PACIENTE VARCHAR2(11)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CONTA'
	and	nm_atributo	= 'NR_DOC_PACIENTE';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CONTA' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'NR_DOC_PACIENTE' || chr(39));
	end if;
end if;

/* Felipe 04/02/2008 - Alterar o campo 46 - NR_DOC_PACIENTE para Varchar */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	qt_decimais		 = NULL,
			ie_tipo_atributo	= 'VARCHAR2'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'NR_DOC_PACIENTE'
		and	nr_seq_atributo		= 46;
		commit;
	end if;
end if;

/* Felipe 04/02/2008 - Alterar para Varchar2 o campo NR_ENFERMARIA da w_susaih_interf_conta */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CONTA'
	and 	column_name	= 'NR_ENFERMARIA'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CONTA ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CONTA modify NR_ENFERMARIA VARCHAR2(4)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CONTA'
	and	nm_atributo	= 'NR_ENFERMARIA';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CONTA' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'NR_ENFERMARIA' || chr(39));
	end if;
end if;

/* Felipe 04/02/2008 - Alterar para Varchar2 o campo NR_ENFERMARIA da w_susaih_interf_conta */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CONTA'
	and 	column_name	= 'NR_LEITO'
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CONTA ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CONTA modify NR_LEITO VARCHAR2(4)');
	end if;

	select	coalesce(max(ie_tipo_atributo),'')
	into STRICT	ie_tipo_atributo_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CONTA'
	and	nm_atributo	= 'NR_LEITO';

	if (ie_tipo_atributo_w <> 'VARCHAR2') then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set ie_tipo_atributo = ' || chr(39) || 'VARCHAR2' || chr(39) ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CONTA' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'NR_LEITO' || chr(39));
	end if;
end if;

/* Felipe 04/02/2008 - Alterar o campo 58 - NR_ENFERMARIA para Varchar */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	qt_decimais		 = NULL,
			ie_tipo_atributo	= 'VARCHAR2'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'NR_ENFERMARIA'
		and	nr_seq_atributo		= 58;
		commit;
	end if;
end if;

/* Felipe 04/02/2008 - Alterar o campo 59 - NR_LEITO para Varchar */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	qt_decimais		 = NULL,
			ie_tipo_atributo	= 'VARCHAR2'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'NR_LEITO'
		and	nr_seq_atributo		= 59;
		commit;
	end if;
end if;


/* Felipe 06/02/2008 - Aumentar o campo QT_AIH_PROTOCOLO da w_susaih_interf_cab */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CAB'
	and 	column_name	= 'QT_AIH_PROTOCOLO'
	and	data_precision	<> 5;
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CAB ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CAB modify QT_AIH_PROTOCOLO NUMBER(5)');
	end if;

	select	coalesce(max(qt_tamanho),5)
	into STRICT	qt_tamanho_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CAB'
	and	nm_atributo	= 'QT_AIH_PROTOCOLO';

	if (qt_tamanho_w <> 5) then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set qt_tamanho = 5 ' ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CAB' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'QT_AIH_PROTOCOLO' || chr(39));
	end if;
end if;

select	count(*)
into STRICT	qt_registro_w
from	tabela_atributo
where	nm_tabela	= 'W_SUSAIH_INTERF_CAB'
and	nm_atributo	= 'QT_AIH_LOTE';
if (qt_registro_w	= 0) then
	CALL Exec_sql_Dinamico('Felipe', 'ALTER TABLE W_SUSAIH_INTERF_CAB ADD (QT_AIH_LOTE NUMBER (05,0) NULL)');
end if;

select	count(*)
into STRICT	qt_registro_w
from	tabela_atributo
where	nm_tabela	= 'W_SUSAIH_INTERF_CAB'
and	nm_atributo	= 'NR_SEQ_LOTE';
if (qt_registro_w	= 0) then
	CALL Exec_sql_Dinamico('Felipe', 'ALTER TABLE W_SUSAIH_INTERF_CAB ADD (NR_SEQ_LOTE NUMBER (10,0) NULL)');
end if;

/* Felipe 06/02/2008 - Alterar o campo 03 - QT_AIH_PROTOCOLO para QT_AIH_LOTE */

if (clock_timestamp() < to_date('10/05/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	nm_atributo		= 'QT_AIH_LOTE'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'QT_AIH_PROTOCOLO'
		and	nr_seq_atributo		= 3;
		commit;
	end if;
end if;

/* Felipe 06/02/2008 - Alterar o campo 02 - NR_SEQ_PROTOCOLO para exportar zeros*/

if (clock_timestamp() < to_date('10/06/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	ds_valor		= '00000000',
			ds_regra_validacao	= 'ValorPadrão'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'NR_SEQ_PROTOCOLO'
		and	nr_seq_atributo		= 2;
		commit;
	end if;
end if;

/* Felipe 06/02/2008 - Alterar o campo 03 - QT_AIH_LOTE para exportar zeros*/

if (clock_timestamp() < to_date('10/06/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	ds_valor		= '000',
			ds_regra_validacao	= 'ValorPadrão'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'QT_AIH_LOTE'
		and	nr_seq_atributo		= 3;
		commit;
	end if;
end if;

/* Felipe 06/02/2008 - Alterar o campo 05 - NR_SEQ_AIH_PROT para exportar zeros*/

if (clock_timestamp() < to_date('10/06/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from	interface
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then
		update 	interface_atributo
		set	ds_valor		= '000',
			ds_regra_validacao	= 'ValorPadrão'
		where 	cd_interface		= 1321
		and 	upper(nm_atributo)	= 'NR_SEQ_AIH_PROT'
		and	nr_seq_atributo		= 5;
		commit;
	end if;
end if;

/* Felipe 15/02/2008 - Aumentar o campo QT_AIH_PROTOCOLO da w_susaih_interf_cab */

if (clock_timestamp() < to_date('10/06/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CAB'
	and 	column_name	= 'QT_AIH_PROTOCOLO'
	and	data_precision	<> 10;
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CAB ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CAB modify QT_AIH_PROTOCOLO NUMBER(10)');
	end if;

	select	coalesce(max(qt_tamanho),10)
	into STRICT	qt_tamanho_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CAB'
	and	nm_atributo	= 'QT_AIH_PROTOCOLO';

	if (qt_tamanho_w <> 10) then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set qt_tamanho = 10 ' ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CAB' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'QT_AIH_PROTOCOLO' || chr(39));
	end if;
end if;

/* Felipe 15/02/2008 - Aumentar o campo NR_SEQ_AIH_PROT da w_susaih_interf_cab */

if (clock_timestamp() < to_date('10/06/2008','dd/mm/yyyy')) then
	select	count(*)
	into STRICT	qt_registro_w
	from 	user_tab_columns
	where 	table_name 	= 'W_SUSAIH_INTERF_CAB'
	and 	column_name	= 'NR_SEQ_AIH_PROT'
	and	data_precision	<> 10;
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'truncate table W_SUSAIH_INTERF_CAB ');
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CAB modify NR_SEQ_AIH_PROT NUMBER(10)');
	end if;

	select	coalesce(max(qt_tamanho),10)
	into STRICT	qt_tamanho_w
	from	tabela_atributo
	where	nm_tabela	= 'W_SUSAIH_INTERF_CAB'
	and	nm_atributo	= 'NR_SEQ_AIH_PROT';

	if (qt_tamanho_w <> 10) then
		CALL Exec_sql_Dinamico('Felipe', 'update tabela_atributo set qt_tamanho = 10 ' ||
				' where nm_tabela = ' || chr(39) || 'W_SUSAIH_INTERF_CAB' || chr(39) || ' and nm_atributo = ' || chr(39) ||
				'NR_SEQ_AIH_PROT' || chr(39));
	end if;
end if;

commit;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE baca_ajustar_interf_susunif ( nm_usuario_p text) FROM PUBLIC;

