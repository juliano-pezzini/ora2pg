-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE executar_saps_dblclick_js ( nr_prescricao_p bigint, nr_seq_result_p bigint, nr_seq_item_p bigint, nm_usuario_p text, nr_sequencia_p INOUT bigint, ie_topografia_examinar_p INOUT text, ie_observacao_p INOUT text, ie_topografia_resultado_p INOUT text) AS $body$
DECLARE


nr_sequencia_w  bigint;
ie_topografia_examinar_w varchar(1);
ie_topografia_resultado_w varchar(1);
nr_prescricao_w  bigint;
ie_observacao_w  varchar(1);

BEGIN

if (nr_prescricao_p IS NOT NULL AND nr_prescricao_p::text <> '') then
 begin
 if (nr_prescricao_p = 0) then
  begin
  nr_prescricao_w := null;
  end;
 else
  begin
  nr_prescricao_w := nr_prescricao_p;
  end;
 end if;

 CALL selecionar_resultado(nr_prescricao_w, nr_seq_result_p, nr_seq_item_p, null, null, nm_usuario_p);

 select coalesce(max(nr_sequencia),0)
 into STRICT nr_sequencia_w
 from pe_prescr_item_result
 where nr_seq_prescr = nr_prescricao_p;

 select coalesce(max(ie_topografia),'N')
 into STRICT ie_topografia_examinar_w
 from pe_item_examinar
 where nr_sequencia = nr_seq_item_p;

 select coalesce(max(ie_topografia),'N')
 into STRICT ie_topografia_resultado_w
 from pe_item_resultado
 where nr_sequencia = nr_seq_result_p;

 SELECT coalesce(max(ie_observacao),'N')
 into STRICT ie_observacao_w
 FROM PE_ITEM_RESULTADO
 WHERE nr_sequencia = nr_seq_result_p;

 end;
end if;

nr_sequencia_p            := nr_sequencia_w;
ie_topografia_examinar_p  :=  ie_topografia_examinar_w;
ie_topografia_resultado_p := ie_topografia_resultado_w;
ie_observacao_p := ie_observacao_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE executar_saps_dblclick_js ( nr_prescricao_p bigint, nr_seq_result_p bigint, nr_seq_item_p bigint, nm_usuario_p text, nr_sequencia_p INOUT bigint, ie_topografia_examinar_p INOUT text, ie_observacao_p INOUT text, ie_topografia_resultado_p INOUT text) FROM PUBLIC;

