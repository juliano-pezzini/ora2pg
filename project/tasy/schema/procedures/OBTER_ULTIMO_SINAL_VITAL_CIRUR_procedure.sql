-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_ultimo_sinal_vital_cirur ( nr_cirurgia_p bigint, qt_temp_p INOUT bigint, qt_freq_resp_p INOUT bigint, qt_freq_cardiaca_p INOUT bigint, qt_pa_sistolica_p INOUT bigint, qt_pa_diastolica_p INOUT bigint, qt_pam_p INOUT bigint, qt_saturacao_o2_p INOUT bigint ) AS $body$
DECLARE



qt_temp_w		real;
qt_freq_resp_w		smallint;
qt_freq_cardiaca_w	smallint;
qt_pa_sistolica_w	smallint;
qt_pa_diastolica_w	smallint;
qt_pam_w		smallint;
qt_saturacao_o2_w	smallint;


BEGIN

begin
select	qt_temp,
	qt_freq_resp,
	qt_freq_cardiaca,
	qt_pa_sistolica,
	qt_pa_diastolica,
	qt_pam,
	qt_saturacao_o2
into STRICT	qt_temp_w,
	qt_freq_resp_w,
	qt_freq_cardiaca_w,
	qt_pa_sistolica_w,
	qt_pa_diastolica_w,
	qt_pam_w,
	qt_saturacao_o2_w
from	atendimento_sinal_vital
where	nr_sequencia	=	(	SELECT	max(nr_sequencia)
					from	atendimento_sinal_vital
					where	nr_cirurgia	=	nr_cirurgia_p);
exception
when others then
	qt_temp_w		:= null;
	qt_freq_resp_w		:= null;
	qt_freq_cardiaca_w	:= null;
	qt_pa_sistolica_w	:= null;
	qt_pa_diastolica_w	:= null;
	qt_pam_w		:= null;
	qt_saturacao_o2_w	:= null;
end;

qt_temp_p			:= qt_temp_w;
qt_freq_resp_p			:= qt_freq_resp_w;
qt_freq_cardiaca_p		:= qt_freq_cardiaca_w;
qt_pa_sistolica_p		:= qt_pa_sistolica_w;
qt_pa_diastolica_p		:= qt_pa_diastolica_w;
qt_pam_p			:= qt_pam_w;
qt_saturacao_o2_p		:= qt_saturacao_o2_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_ultimo_sinal_vital_cirur ( nr_cirurgia_p bigint, qt_temp_p INOUT bigint, qt_freq_resp_p INOUT bigint, qt_freq_cardiaca_p INOUT bigint, qt_pa_sistolica_p INOUT bigint, qt_pa_diastolica_p INOUT bigint, qt_pam_p INOUT bigint, qt_saturacao_o2_p INOUT bigint ) FROM PUBLIC;

