-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE exec_submit_job_command (DS_COMMAND_P text, NM_USUARIO_P text, SET_USER_SESSION_P boolean DEFAULT TRUE, NEXT_DATE_P timestamp DEFAULT NULL, INTERVAL_P text DEFAULT NULL) AS $body$
DECLARE

  JOBNO        bigint;
  DS_COMANDO_W varchar(4000);

BEGIN
  IF (SET_USER_SESSION_P) THEN
    DS_COMANDO_W := '
BEGIN
  PHILIPS_PARAM_PCK.SET_NR_SEQ_IDIOMA(' || coalesce(coalesce(PHILIPS_PARAM_PCK.GET_NR_SEQ_IDIOMA(), OBTER_NR_SEQ_IDIOMA(NM_USUARIO_P)), 1) || ');
  WHEB_USUARIO_PCK.SET_CD_ESTABELECIMENTO(' || OBTER_ESTABELECIMENTO_ATIVO || ');
  WHEB_USUARIO_PCK.SET_NM_USUARIO(''' || NM_USUARIO_P || ''');

  ' || DS_COMMAND_P || '
END;';
  ELSE
    DS_COMANDO_W := DS_COMMAND_P;
  END IF;

  DBMS_JOB.SUBMIT(JOBNO,
                  DS_COMANDO_W,
                  coalesce(NEXT_DATE_P, clock_timestamp() + INTERVAL '1' SECOND),
                  INTERVAL_P);
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE exec_submit_job_command (DS_COMMAND_P text, NM_USUARIO_P text, SET_USER_SESSION_P boolean DEFAULT TRUE, NEXT_DATE_P timestamp DEFAULT NULL, INTERVAL_P text DEFAULT NULL) FROM PUBLIC;

