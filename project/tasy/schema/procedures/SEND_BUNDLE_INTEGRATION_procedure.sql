-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE send_bundle_integration (nr_atendimento_p bigint, nr_sequencia_p bigint, dt_liberacao_p timestamp, nr_seq_tipo_avaliacao_p bigint, dt_atualizacao_p timestamp, dt_avaliacao_p timestamp) AS $body$
DECLARE

				
hospital_attendance_number_w	med_avaliacao_paciente.nr_atendimento%type;
patient_id_w 					pessoa_fisica.cd_pessoa_fisica%type;
checklist_id_w					med_avaliacao_paciente.nr_sequencia%type;
module_id_w						varchar(3);
checklist_date_w				varchar(40);
question_id_w					varchar(2);
answer_id_w						varchar(5);
aux_answer_w					varchar(200);
aux_question_w					varchar(200);
module_name_w					varchar(40);
ds_integracao_w					text;
updatetimestamp_w				varchar(50);
updatetimestampfilter_w			varchar(50);
nm_user_w						med_avaliacao_paciente.nm_usuario%type;
separator_w						varchar(1) := '@';
establishment_id_w   smallint;

c01 CURSOR FOR		
SELECT distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 0
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_1', 1)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 1
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_1', 2) 
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 2
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_1', 3) 
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 3
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_1', 4)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 1) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (SELECT nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_1', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_1_A', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 1) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_1_A', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_1_B', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 1) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_1_B', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_1_C', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 1) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_1_C', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_1_D', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 1) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_1_D', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 0
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_2', 1) 
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 1
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_2', 2) 
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 2
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_2', 3)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 3
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_2', 4)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 2) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_2', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_2_A', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 2) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_2_A', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_2_B', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 2) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_2_B', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_2_C', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 2) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_2_C', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_2_D', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 2) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_2_D', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 0
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_3', 1)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 1
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_3', 2)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 2
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_3', 3) 
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 3
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_3', 4) 
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 4
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_3', 5)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 3) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_3', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_3_A', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 3) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_3_A', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_3_B', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 3) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_3_B', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_3_C', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 3) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_3_C', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_3_D', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 3) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_3_D', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_3_E', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 3) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_3_E', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 0
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_4', 1)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 1
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_4', 2)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 2
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_4', 3)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 3
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_4', 4)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 4) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_4', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_4_A', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 4) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_4_A', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_4_B', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 4) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_4_B', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_4_C', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 4) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_4_C', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_4_D', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 4) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_4_D', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 0
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_5', 1) 
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 1
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_5', 2)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 5) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_5', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_5_A', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 5) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_5_A', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_5_B', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 5) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_5_B', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_6_A', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 6) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_6_A', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_6_B', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 6) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_6_B', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_6_C', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 6) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_6_C', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_6_3', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 6) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_6_3', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_6_E', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 6) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_6_E', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 0
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_7', 1)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 1
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_7', 2)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 2
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_7', 3)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 3
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_7', 4)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 7) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_7', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_7_A', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 7) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_7_A', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_7_B', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 7) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_7_B', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_7_C', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 7) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_7_C', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_7_D', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 7) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_7_D', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 0
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_8', 1)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 1
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_8', 2)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 8) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_8', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_8_A', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 8) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_8_A', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_8_B', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 8) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_8_B', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_9_A', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 9) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_9_A', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_9_B', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 9) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_9_B', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_9_C', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 9) question_id 
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_9_C', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 0
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_10', 1)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 1
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_10', 2)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 2
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_10', 3)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 3
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_10', 4)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 10) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_10', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_10_A', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 10) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_10_A', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_10_B', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 10) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_10_B', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_10_C', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 10) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_10_C', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_10_D', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 10) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_10_D', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 0
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_11', 1)
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 1
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_11', 2)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 11) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_11', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_11_A', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 11) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_11_A', 1))
  
union all

  select distinct(
    case
      when obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item, nr_seq_tipo_avaliacao_p, nr_atendimento_p) = 'Sim'
      then obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_11_B', 1)
    end ) answer_id,
    obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','QUESTION_ID', 11) question_id
  from med_avaliacao_result b
  where b.nr_seq_avaliacao = nr_sequencia_p
  and b.nr_seq_item    =
    (select nr_sequencia from med_item_avaliar where ds_alias = obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','DS_ALIAS_CADASTRO_11_B', 1));


BEGIN

if (obter_setor(obter_setor_atual_paciente(nr_atendimento_p)) is not null and (dt_liberacao_p IS NOT NULL AND dt_liberacao_p::text <> '')) then
	
	nm_user_w := WHEB_USUARIO_PCK.GET_NM_USUARIO;
	checklist_id_w := nr_sequencia_p;
	module_id_w := obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','MODULE_ID', 1);
	checklist_date_w := to_char(dt_atualizacao_p, 'yyyymmddhh24miss');
	updatetimestamp_w := to_char(dt_avaliacao_p, 'yyyymmddhh24miss');
	hospital_attendance_number_w := nr_atendimento_p;
	patient_id_w := OBTER_PESSOA_ATENDIMENTO(nr_atendimento_p,'C');
	module_name_w := obter_conversao_externa(null,'MED_AVALIACAO_PACIENTE','MODULE_NAME', 1);
	
	open c01;
	loop
	fetch c01 into
		answer_id_w,	
		question_id_w;
	EXIT WHEN NOT FOUND; /* apply on C01 */
	begin
	if (answer_id_w IS NOT NULL AND answer_id_w::text <> '') then
	
		if (coalesce(aux_answer_w::text, '') = '') then
			aux_answer_w := answer_id_w;
			aux_question_w := question_id_w;
		else
			aux_answer_w := aux_answer_w||separator_w||answer_id_w;
			aux_question_w := aux_question_w||separator_w||question_id_w;
		end if;
	end if;
	
	end;
	end loop;
	close c01;
	if (coalesce(patient_id_w, 0) > 0 ) and (aux_answer_w IS NOT NULL AND aux_answer_w::text <> '') then

    select
      obter_estabelecimento_setor(obter_setor_atual_paciente(nr_atendimento_p))
    into STRICT
      establishment_id_w
;
	
		select bifrost.send_integration( 'patientinformation.bundle',
									'com.philips.tasy.integration.atepac.patientinformation.bundle.Bundle',
									'{ "bundleDate" : "' ||checklist_date_w || '",'
									||'"patientId" : "' ||patient_id_w || '",'
                  ||'"establishmentId" : "'||establishment_id_w||'",'
									||'"hospitalAttendance" : "' ||hospital_attendance_number_w || '",'
									||'"bundleId" : "' || checklist_id_w ||'",'
									||'"moduleId" : "' || module_id_w ||'" ,'
									||'"moduleName" : "' || module_name_w ||'" ,'
									||'"updateTimeStamp" : "' || to_char(dt_atualizacao_p, 'yyyymmddhh24miss') ||'" ,'
									||'"questionId" : "' || aux_question_w ||'" ,'
									||'"answerId" : "' || aux_answer_w ||'"'
									||'}',
									nm_user_w)
		into STRICT ds_integracao_w
		;
				
		end if;
	
	
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE send_bundle_integration (nr_atendimento_p bigint, nr_sequencia_p bigint, dt_liberacao_p timestamp, nr_seq_tipo_avaliacao_p bigint, dt_atualizacao_p timestamp, dt_avaliacao_p timestamp) FROM PUBLIC;

