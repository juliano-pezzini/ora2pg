-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE customer_privacy_read_status ( NM_USUARIO_P PRIVACY_NOTICE_USER_READ.LOGGED_IN_USER%type, PRIVACY_CUSTOMER_PHILIPS_ID_P text , PRIVACY_TAB_TYPE text , ds_retorno_p INOUT text) AS $body$
DECLARE

  -- CPN : CUSTOMER PRIVIACY NOTICE
  -- S0P : SERVICE ORDER PRIVACY NOTICE
  -- AUTHOR : ANAND MENTHE
BEGIN
  IF (PRIVACY_TAB_TYPE ='CPN' ) THEN
    INSERT
    INTO PRIVACY_NOTICE_USER_READ(
        nr_sequencia,
        DT_ATUALIZACAO,
        LOGGED_IN_USER,
        PRIVACY_CUSTOMER_ID,
        PRIVACY_PHILIPS_ID,
        PRIVACY_READ_STATUS
      )
      VALUES (
        nextval('privacy_notice_user_read_seq'),
        clock_timestamp(),
        NM_USUARIO_P,
        PRIVACY_CUSTOMER_PHILIPS_ID_P,
        NULL,
        'S'
      );
    SELECT coalesce(MAX(1),0)
    INTO STRICT ds_retorno_p
    FROM PRIVACY_NOTICE_USER_READ
    WHERE PRIVACY_CUSTOMER_ID=PRIVACY_CUSTOMER_PHILIPS_ID_P;
  END IF;
  IF (PRIVACY_TAB_TYPE ='SOP' ) THEN
    INSERT
    INTO PRIVACY_NOTICE_USER_READ(
        nr_sequencia,
        DT_ATUALIZACAO,
        LOGGED_IN_USER,
        PRIVACY_CUSTOMER_ID,
        PRIVACY_PHILIPS_ID,
        PRIVACY_READ_STATUS
      )
      VALUES (
        nextval('privacy_notice_user_read_seq'),
        clock_timestamp(),
        NM_USUARIO_P,
        NULL,
        PRIVACY_CUSTOMER_PHILIPS_ID_P,
        'S'
      );
    SELECT coalesce(MAX(1),0)
    INTO STRICT ds_retorno_p
    FROM PRIVACY_NOTICE_USER_READ
    WHERE PRIVACY_PHILIPS_ID=PRIVACY_CUSTOMER_PHILIPS_ID_P;
  END IF;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE customer_privacy_read_status ( NM_USUARIO_P PRIVACY_NOTICE_USER_READ.LOGGED_IN_USER%type, PRIVACY_CUSTOMER_PHILIPS_ID_P text , PRIVACY_TAB_TYPE text , ds_retorno_p INOUT text) FROM PUBLIC;

