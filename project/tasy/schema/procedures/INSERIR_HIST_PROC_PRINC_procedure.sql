-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE inserir_hist_proc_princ ( nr_seq_proc_princ_p bigint, ds_titulo_p text, ds_historico_p text, nm_usuario_p text) AS $body$
DECLARE

ds_historico_w	varchar(255);

BEGIN

if (nr_seq_proc_princ_p IS NOT NULL AND nr_seq_proc_princ_p::text <> '') and (ds_titulo_p IS NOT NULL AND ds_titulo_p::text <> '') and (ds_historico_p IS NOT NULL AND ds_historico_p::text <> '') and (nm_usuario_p IS NOT NULL AND nm_usuario_p::text <> '') then

begin

	ds_historico_w := substr(obter_texto_tasy(136720, wheb_usuario_pck.get_nr_seq_idioma),1,255) || chr(10) || ds_historico_p;

	insert	into	proc_princ_hist(
					nr_sequencia,
					dt_atualizacao,
					nm_usuario,
					ds_historico,
					nr_seq_proc_princ,
					ds_titulo,
					dt_liberacao,
					ie_tipo_historico)
	values (
					nextval('proc_princ_hist_seq'),
					clock_timestamp(),
					nm_usuario_p,
					ds_historico_w,
					nr_seq_proc_princ_p,
					ds_titulo_p,
					clock_timestamp(),
					'A');

	commit;

end;

end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE inserir_hist_proc_princ ( nr_seq_proc_princ_p bigint, ds_titulo_p text, ds_historico_p text, nm_usuario_p text) FROM PUBLIC;

