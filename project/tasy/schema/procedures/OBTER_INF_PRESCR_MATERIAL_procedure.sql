-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_inf_prescr_material ( cd_material_p bigint, ie_via_p text, nr_prescricao_p bigint, nm_usuario_p text, ie_via_aplicacao_p INOUT text, ie_disp_inf_p INOUT text, qt_min_aplic_p INOUT text, ds_justificativa_p INOUT text, qt_hora_aplic_p INOUT text, qt_solucao_p INOUT text, qt_dose_p INOUT bigint, cd_unidade_padrao_p INOUT text, cd_intervalo_padrao_p INOUT text ) AS $body$
DECLARE

 
cd_setor_atendimento_w	integer;
cd_pessoa_fisica_w	varchar(10);	
qt_peso_w		real;
idade_w			double precision;
ie_via_aplicacao_w	varchar(5);
ie_disp_inf_w		varchar(1);
qt_min_aplic_w		smallint;
ds_justificativa_w	varchar(2000);
qt_hora_aplic_w		smallint;
qt_solucao_w		double precision;
qt_dose_w		double precision;
cd_unidade_padrao_w	varchar(30);
cd_intervalo_padrao_w	varchar(7);
nr_atendimento_w		bigint;


BEGIN 
 
select	cd_setor_atendimento, 
		cd_pessoa_fisica, 
		qt_peso 
into STRICT	cd_setor_atendimento_w, 
		cd_pessoa_fisica_w, 
		qt_peso_w 
from	prescr_medica 
where	nr_prescricao	= nr_prescricao_p;
 
 
idade_w			:= Obter_Idade_PF(cd_pessoa_fisica_w, clock_timestamp(), 'A');
 
ie_via_aplicacao_w 	:= Obter_Padrao_Param_Prescr(nr_atendimento_w,cd_material_p, ie_via_p, cd_setor_atendimento_w, cd_pessoa_fisica_w, idade_w, qt_peso_w, 'N','V', null);
 
ie_disp_inf_w		:= Obter_Padrao_Param_Prescr(nr_atendimento_w,cd_material_p, ie_via_p, cd_setor_atendimento_w, cd_pessoa_fisica_w, idade_w, qt_peso_w, 'N','DI', null);
 
qt_min_aplic_w		:= Obter_Padrao_Param_Prescr(nr_atendimento_w,cd_material_p, ie_via_p, cd_setor_atendimento_w, cd_pessoa_fisica_w, idade_w, qt_peso_w, 'N','MA', null);
 
ds_justificativa_w	:= Obter_Padrao_Param_Prescr(nr_atendimento_w,cd_material_p, ie_via_p, cd_setor_atendimento_w, cd_pessoa_fisica_w, idade_w, qt_peso_w, 'N','J', null);
 
qt_hora_aplic_w		:= Obter_Padrao_Param_Prescr(nr_atendimento_w,cd_material_p, ie_via_p, cd_setor_atendimento_w, cd_pessoa_fisica_w, idade_w, qt_peso_w, 'N','HA', null);
 
qt_solucao_w		:= Obter_Padrao_Param_Prescr(nr_atendimento_w,cd_material_p, ie_via_p, cd_setor_atendimento_w, cd_pessoa_fisica_w, idade_w, qt_peso_w, 'N','S', null);
 
qt_dose_w			:= Obter_Padrao_Param_Prescr(nr_atendimento_w,cd_material_p, ie_via_p, cd_setor_atendimento_w, cd_pessoa_fisica_w, idade_w, qt_peso_w, 'N','D', null);
 
cd_unidade_padrao_w	:= Obter_Padrao_Param_Prescr(nr_atendimento_w,cd_material_p, ie_via_p, cd_setor_atendimento_w, cd_pessoa_fisica_w, idade_w, qt_peso_w, 'N','U', null);
 
cd_intervalo_padrao_w	:= Obter_Padrao_Param_Prescr(nr_atendimento_w,cd_material_p, ie_via_p, cd_setor_atendimento_w, cd_pessoa_fisica_w, idade_w, qt_peso_w, 'N','I', null);
 
ie_via_aplicacao_p	:= ie_via_aplicacao_w;
qt_min_aplic_p		:= qt_min_aplic_w;		
ds_justificativa_p	:= ds_justificativa_w;	
qt_hora_aplic_p		:= qt_hora_aplic_w;	
ie_disp_inf_p		:= ie_disp_inf_w;
qt_solucao_p		:= qt_solucao_w;
qt_dose_p			:= qt_dose_w;	
cd_unidade_padrao_p	:= cd_unidade_padrao_w;
cd_intervalo_padrao_p	:= cd_intervalo_padrao_w;
 
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_inf_prescr_material ( cd_material_p bigint, ie_via_p text, nr_prescricao_p bigint, nm_usuario_p text, ie_via_aplicacao_p INOUT text, ie_disp_inf_p INOUT text, qt_min_aplic_p INOUT text, ds_justificativa_p INOUT text, qt_hora_aplic_p INOUT text, qt_solucao_p INOUT text, qt_dose_p INOUT bigint, cd_unidade_padrao_p INOUT text, cd_intervalo_padrao_p INOUT text ) FROM PUBLIC;

