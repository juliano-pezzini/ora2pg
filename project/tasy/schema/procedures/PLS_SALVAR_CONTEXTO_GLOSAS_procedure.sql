-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pls_salvar_contexto_glosas ( nr_seq_fatura_p bigint, cd_estabelecimento_p bigint, nm_usuario_p text ) AS $body$
BEGIN

insert into pls_analise_glosa_original(nr_sequencia, nr_seq_conta, cd_estabelecimento,
	 dt_atualizacao, nm_usuario, dt_atualizacao_nrec,
	 nm_usuario_nrec, nr_seq_conta_proc, nr_seq_conta_mat,
	 nr_seq_glosa, nr_seq_ocorrencia, qt_glosa,
	 vl_glosa, nr_seq_conta_pos_estab, nr_seq_fatura)
SELECT	 nextval('pls_analise_conta_item_seq'), b.nr_sequencia, b.cd_estabelecimento,
	 clock_timestamp(), nm_usuario_p, clock_timestamp(),
	 nm_usuario_p, a.nr_seq_conta_proc, a.nr_seq_conta_mat,
	 a.nr_seq_glosa, a.nr_seq_ocorrencia, a.qt_glosa,
	 a.vl_glosa, a.nr_seq_conta_pos_estab, b.nr_seq_fatura
from	pls_analise_conta_item a,
	pls_conta b
where	coalesce(a.nr_seq_discussao::text, '') = ''
and	coalesce(a.nr_seq_conta_pos_estab::text, '') = ''
and 	b.nr_seq_fatura 	= nr_seq_fatura_p
and	a.ie_pre_analise	= 'S'
and	a.nr_seq_conta		= b.nr_sequencia;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_salvar_contexto_glosas ( nr_seq_fatura_p bigint, cd_estabelecimento_p bigint, nm_usuario_p text ) FROM PUBLIC;

