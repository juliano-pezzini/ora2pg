-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE dar_remap_tables (CD_ESTABELECIMENTO_P dar_tables_relat.CD_ESTABELECIMENTO%TYPE, NM_USUARIO_P dar_tables_relat.NM_USUARIO%TYPE) AS $body$
DECLARE

  LOOP_TB RECORD;

BEGIN
  DELETE FROM DAR_TABLES_RELAT;
  COMMIT;
  FOR LOOP_TB IN (SELECT * FROM DAR_TABLES_FK)
  LOOP
	CALL DAR_START_MAPPING_TABLES_RELAT(LOOP_TB.DS_TABLE, CD_ESTABELECIMENTO_P, NM_USUARIO_P);
	UPDATE DAR_TABLES_FK SET DT_PROCESSAMENTO = clock_timestamp() WHERE DS_TABLE = LOOP_TB.DS_TABLE;
  END LOOP LOOP_TB;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE dar_remap_tables (CD_ESTABELECIMENTO_P dar_tables_relat.CD_ESTABELECIMENTO%TYPE, NM_USUARIO_P dar_tables_relat.NM_USUARIO%TYPE) FROM PUBLIC;

