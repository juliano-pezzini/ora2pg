-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE duplicar_escala ( nr_sequencia_p bigint, cd_pessoa_fisica_p text, nm_tabela_p text, nm_usuario_p text, nr_atendimento_p bigint) AS $body$
DECLARE


nr_seq_escala_tissa_w	escala_tissa.nr_sequencia%TYPE;
				
C01 CURSOR FOR
	SELECT	*
	from	ESCALA_SAPS
	where	nr_sequencia = nr_sequencia_p;
	
C02 CURSOR FOR
	SELECT	*
	from	ESCALA_NAS
	where	nr_sequencia = nr_sequencia_p;
	
C03 CURSOR FOR
	SELECT	*
	from	ESCALA_DOWNTON
	where	nr_sequencia = nr_sequencia_p;
	
C04 CURSOR FOR
	SELECT	*
	from	apache
	where	nr_sequencia = nr_sequencia_p;
	

C05 CURSOR FOR
	SELECT	*
	from	ESCALA_RISCO_DELIRIUM
	where	nr_sequencia = nr_sequencia_p;	


C06 CURSOR FOR
	SELECT	*
	from	atend_escala_indice
	where	nr_sequencia = nr_sequencia_p;
	
c07 CURSOR FOR
	SELECT	*
	from	escala_karnofsky
	where	nr_sequencia = nr_sequencia_p;	
	
C08 CURSOR FOR
	SELECT	*
	from	escala_tev
	where	nr_sequencia = nr_sequencia_p;

C09 CURSOR FOR
	SELECT	*
	from	escala_ashworth	
	where	nr_sequencia = nr_sequencia_p;

C10 CURSOR FOR
	SELECT	*
	from	escala_ashworth_item	
	where	nr_seq_ashworth = nr_sequencia_p;
	
C11 CURSOR FOR
	SELECT	*
	from	escala_eif
	where	nr_sequencia = nr_sequencia_p;
	
C12 CURSOR FOR
	SELECT	*
	from	ESCALA_MORSE
	where	nr_sequencia = nr_sequencia_p;	
	

C13 CURSOR FOR
	SELECT	*
	from	ESCALA_ASG_PPP
	where	nr_sequencia = nr_sequencia_p;		
	
C14 CURSOR FOR
	SELECT	*
	from	ESCALA_NTISS
	where	nr_sequencia = nr_sequencia_p;		
	
C15 CURSOR FOR
	SELECT	*
	from	TISS_INTERV_TERAPEUTICA_10
	where	nr_sequencia = nr_sequencia_p;	

C16 CURSOR FOR
	SELECT	*
	from	ESCALA_TISSA
	where	nr_sequencia = nr_sequencia_p;	
	
c01_w c01%rowtype;
c02_w c02%rowtype;
c03_w c03%rowtype;
c04_w c04%rowtype;
c05_w c05%rowtype;
c06_w c06%rowtype;
c07_w c07%rowtype;
c08_w c08%rowtype;
c09_w c09%rowtype;
c10_w c10%rowtype;
c11_w c11%rowtype;
c12_w c12%rowtype;
c13_w c13%rowtype;
c14_w c14%rowtype;
c15_w c15%rowtype;
c16_w c16%rowtype;

nr_seq_retorno_w	        bigint;
nr_seq_ashworth_w	        bigint;
nr_atendimento_score_flex_w     bigint;
NR_SEQ_ATEND_CONS_PEPA_W	bigint;


BEGIN

if (upper(nm_tabela_p)	= 'ESCALA_SAPS') then
	open C01;
	loop
	fetch C01 into	
		c01_w;
	EXIT WHEN NOT FOUND; /* apply on C01 */
		begin
		INSERT INTO ESCALA_SAPS(
		NR_SEQUENCIA, NR_ATENDIMENTO, DT_ATUALIZACAO, 
		NM_USUARIO, DT_ATUALIZACAO_NREC, NM_USUARIO_NREC, 
		DT_AVALIACAO, DT_LIBERACAO, CD_PROFISSIONAL, 
		IE_TIPO_ADMISSAO, IE_AIDS, IE_MALIG_HEMATOLOGICA, 
		IE_CANCRO_METASTATICO, QT_GLASGOW, QT_IDADE, 
		QT_PA_SISTOLICA, QT_FREQ_CARDIACA, QT_TEMP, 
		QT_REL_PAO2_FIO2, QT_DIURESE, QT_UREIA, 
		QT_GLOBULOS_BRANCOS, QT_POTASSIO, QT_SODIO, 
		QT_BICARBONATO, QT_BILIRRUBINA, QT_DIAS_ANTES_UTI, 
		IE_ORIGEM_PACIENTE, IE_CATEGORIA_CLINICA, IE_INTOXICACAO, 
		QT_PTO_TIPO_ADM, QT_PTO_DOENCA_CRO, QT_PTO_GLASGOW, 
		QT_PTO_IDADE, QT_PTO_PA_SITOLICA, QT_PTO_FREC_CARD, 
		QT_PTO_TEMP, QT_PTO_PAO2_FIO2, QT_PTO_DIURESE, 
		QT_PTO_UREIA, QT_PTO_GLOB_BRANCO, QT_PTO_POTASSIO, 
		QT_PTO_SODIO, QT_PTO_BICARBONATO, QT_PTO_BILIRRUBINA, 
		QT_SAPS, QT_PTO_DIAS_UTI, QT_PTO_ORIGEM_PAC, 
		QT_PTO_CATEG_CLINICA, QT_PTO_INTOXIC, QT_SAPS_EXPAND, 
		PR_MORTALIDADE, QT_PTO_SEXO, PR_MORT_EXPAND, 
		CD_PERFIL_ATIVO, IE_SITUACAO, DT_INATIVACAO, 
		NM_USUARIO_INATIVACAO, DS_JUSTIFICATIVA ) 
		 VALUES ( 
		nextval('escala_saps_seq'), nr_atendimento_p, clock_timestamp(), 
		nm_usuario_p, clock_timestamp(), nm_usuario_p, 
		clock_timestamp(), null,cd_pessoa_fisica_p, 
		c01_w.IE_TIPO_ADMISSAO, c01_w.IE_AIDS, c01_w.IE_MALIG_HEMATOLOGICA, 
		c01_w.IE_CANCRO_METASTATICO, c01_w.QT_GLASGOW, c01_w.QT_IDADE, 
		c01_w.QT_PA_SISTOLICA, c01_w.QT_FREQ_CARDIACA, c01_w.QT_TEMP, 
		c01_w.QT_REL_PAO2_FIO2, c01_w.QT_DIURESE, c01_w.QT_UREIA, 
		c01_w.QT_GLOBULOS_BRANCOS, c01_w.QT_POTASSIO, c01_w.QT_SODIO, 
		c01_w.QT_BICARBONATO, c01_w.QT_BILIRRUBINA, c01_w.QT_DIAS_ANTES_UTI, 
		c01_w.IE_ORIGEM_PACIENTE, c01_w.IE_CATEGORIA_CLINICA, c01_w.IE_INTOXICACAO, 
		c01_w.QT_PTO_TIPO_ADM, c01_w.QT_PTO_DOENCA_CRO, c01_w.QT_PTO_GLASGOW, 
		c01_w.QT_PTO_IDADE, c01_w.QT_PTO_PA_SITOLICA, c01_w.QT_PTO_FREC_CARD, 
		c01_w.QT_PTO_TEMP, c01_w.QT_PTO_PAO2_FIO2, c01_w.QT_PTO_DIURESE, 
		c01_w.QT_PTO_UREIA, c01_w.QT_PTO_GLOB_BRANCO, c01_w.QT_PTO_POTASSIO, 
		c01_w.QT_PTO_SODIO, c01_w.QT_PTO_BICARBONATO, c01_w.QT_PTO_BILIRRUBINA, 
		c01_w.QT_SAPS, c01_w.QT_PTO_DIAS_UTI, c01_w.QT_PTO_ORIGEM_PAC, 
		c01_w.QT_PTO_CATEG_CLINICA, c01_w.QT_PTO_INTOXIC, c01_w.QT_SAPS_EXPAND, 
		c01_w.PR_MORTALIDADE, c01_w.QT_PTO_SEXO, c01_w.PR_MORT_EXPAND, 
		c01_w.CD_PERFIL_ATIVO, 'A', null, 
		null,null );
		end;
	end loop;
	close C01;
elsif (upper(nm_tabela_p)	= 'ESCALA_NAS') then
	open C02;
	loop
	fetch C02 into	
		c02_w;
	EXIT WHEN NOT FOUND; /* apply on C02 */
		begin
		INSERT INTO ESCALA_NAS(
		NR_SEQUENCIA, DT_ATUALIZACAO, NM_USUARIO, 
		DT_ATUALIZACAO_NREC, NM_USUARIO_NREC, NR_ATENDIMENTO, 
		CD_PROFISSIONAL, DT_AVALIACAO, DT_LIBERACAO, 
		DS_ITEM_1A, DS_ITEM_1B, DS_ITEM_1C, 
		DS_ITEM_2, DS_ITEM_3, DS_ITEM_4A, 
		DS_ITEM_4B, DS_ITEM_4C, DS_ITEM_5, 
		DS_ITEM_6A, DS_ITEM_6B, DS_ITEM_6C, 
		DS_ITEM_7A, DS_ITEM_7B, DS_ITEM_8A, 
		DS_ITEM_8B, DS_ITEM_8C, DS_ITEM_9, 
		DS_ITEM_10, DS_ITEM_11, DS_ITEM_12, 
		DS_ITEM_13, DS_ITEM_14, DS_ITEM_15, 
		DS_ITEM_16, DS_ITEM_17, DS_ITEM_18, 
		DS_ITEM_19, DS_ITEM_20, DS_ITEM_21, 
		DS_ITEM_22, DS_ITEM_23, QT_PONTUACAO, 
		CD_PERFIL_ATIVO, IE_SITUACAO, DT_INATIVACAO, 
		NM_USUARIO_INATIVACAO, DS_JUSTIFICATIVA, NR_HORA ) 
		 VALUES ( 
		nextval('escala_nas_seq'), clock_timestamp(),nm_usuario_p, 
		clock_timestamp(),nm_usuario_p, nr_atendimento_p, 
		cd_pessoa_fisica_p, clock_timestamp(),null, 
		c02_w.DS_ITEM_1A, c02_w.DS_ITEM_1B, c02_w.DS_ITEM_1C, 
		c02_w.DS_ITEM_2, c02_w.DS_ITEM_3, c02_w.DS_ITEM_4A, 
		c02_w.DS_ITEM_4B, c02_w.DS_ITEM_4C, c02_w.DS_ITEM_5, 
		c02_w.DS_ITEM_6A, c02_w.DS_ITEM_6B, c02_w.DS_ITEM_6C, 
		c02_w.DS_ITEM_7A, c02_w.DS_ITEM_7B, c02_w.DS_ITEM_8A, 
		c02_w.DS_ITEM_8B, c02_w.DS_ITEM_8C, c02_w.DS_ITEM_9, 
		c02_w.DS_ITEM_10, c02_w.DS_ITEM_11, c02_w.DS_ITEM_12, 
		c02_w.DS_ITEM_13, c02_w.DS_ITEM_14, c02_w.DS_ITEM_15, 
		c02_w.DS_ITEM_16, c02_w.DS_ITEM_17, c02_w.DS_ITEM_18, 
		c02_w.DS_ITEM_19, c02_w.DS_ITEM_20, c02_w.DS_ITEM_21, 
		c02_w.DS_ITEM_22, c02_w.DS_ITEM_23, c02_w.QT_PONTUACAO, 
		c02_w.CD_PERFIL_ATIVO, 'A',null,
		null,null,null );

		end;
	end loop;
	close C02;
elsif (upper(nm_tabela_p)	= 'ESCALA_DOWNTON') then
	open C03;
	loop
	fetch C03 into	
		c03_w;
	EXIT WHEN NOT FOUND; /* apply on C03 */
		begin
		INSERT INTO ESCALA_DOWNTON(
		NR_SEQUENCIA, DT_ATUALIZACAO, NM_USUARIO, 
		DT_ATUALIZACAO_NREC, NM_USUARIO_NREC, NR_ATENDIMENTO, 
		CD_PROFISSIONAL, DT_AVALIACAO, IE_SITUACAO, 
		DT_LIBERACAO, DT_INATIVACAO, NM_USUARIO_INATIVACAO, 
		DS_JUSTIFICATIVA, IE_CAIDAS_PREVIAS, IE_USO_MEDIC, 
		IE_ESTADO_MENTAL, IE_DEAMBULACAO, QT_PONTUACAO, 
		IE_DEFCTIS_VISUAL, IE_DEFCTIS_AUDITIVO, IE_DEFCTIS_EXTREMIDADES, 
		NR_HORA ) 
		 VALUES ( 
		nextval('escala_downton_seq'), clock_timestamp(), nm_usuario_p, 
		clock_timestamp(),nm_usuario_p, nr_atendimento_p, 
		cd_pessoa_fisica_p, clock_timestamp(), 'A', 
		null, null, null, 
		null, c03_w.IE_CAIDAS_PREVIAS, c03_w.IE_USO_MEDIC, 
		c03_w.IE_ESTADO_MENTAL, c03_w.IE_DEAMBULACAO, c03_w.QT_PONTUACAO, 
		c03_w.IE_DEFCTIS_VISUAL, c03_w.IE_DEFCTIS_AUDITIVO, c03_w.IE_DEFCTIS_EXTREMIDADES, 
		null );
		end;
	end loop;
	close C03;
elsif (upper(nm_tabela_p)	= 'APACHE') then
	open C04;
	loop
	fetch C04 into	
		C04_w;
	EXIT WHEN NOT FOUND; /* apply on C04 */
		begin
		INSERT INTO APACHE(
		NR_SEQUENCIA, NR_ATENDIMENTO, DT_ATUALIZACAO, CD_PROFISSIONAL, 
		NM_USUARIO, DT_APACHE, QT_TEMP_RETAL, 
		QT_PAL_MEDIA, QT_FREQ_CARD, QT_FREQ_RESP, 
		QT_OXIGENACAO_FIO2, QT_OXIGENACAO_PAAO2, QT_OXIGENACAO_PAO2, 
		QT_PH_ARTERIAL, QT_SODIO_SERICO, QT_POTASSIO_SERICO, 
		QT_CREATININA, QT_HEMATOCRITO, QT_GLOBULOS_BRANCOS, 
		QT_ESCALA_GLASGOW, IE_IRA, IE_PO_URGENCIA, 
		QT_PONT_VAR_FISIOLOGICAS, QT_PONT_IDADE, QT_PONT_DOENCA_CRONICA, 
		QT_APACHE_II, QT_RISCO_CALCULADO, QT_OXIGENACAO_PCO2, 
		PR_RISCO, QT_TEMP_AXILAR, QT_PTO_TEMP, 
		QT_PTO_PA_MED, QT_PTO_FC, QT_PTO_FR, 
		QT_PTO_OXIG, QT_PTO_PH_ART, QT_PTO_CREATININA, 
		QT_PTO_HEMATOCRITO, QT_PTO_GLOB_BRANCO, QT_PTO_GLASGOW, 
		QT_PTO_SODIO_SERICO, QT_PTO_POT_SERICO, QT_BICARBONATO_SERICO, 
		QT_PONTO_BICARB_SERICO, QT_PESO_CAT_DIAG, NR_SEQ_CAT_DIAG, 
		QT_PB, QT_PAD, QT_PAS, 
		DT_LIBERACAO, IE_TIPO_CATEGORIA, CD_SETOR_PACIENTE, 
		CD_PERFIL_ATIVO, IE_SITUACAO, DT_INATIVACAO, 
		NM_USUARIO_INATIVACAO, DS_JUSTIFICATIVA, NR_HORA ) 
		 VALUES ( 
		nextval('apache_seq'), nr_atendimento_p, clock_timestamp(), c04_w.CD_PROFISSIONAL,
		nm_usuario_p, clock_timestamp(), c04_w.QT_TEMP_RETAL, 
		c04_w.QT_PAL_MEDIA, c04_w.QT_FREQ_CARD, c04_w.QT_FREQ_RESP, 
		c04_w.QT_OXIGENACAO_FIO2, c04_w.QT_OXIGENACAO_PAAO2, c04_w.QT_OXIGENACAO_PAO2, 
		c04_w.QT_PH_ARTERIAL, c04_w.QT_SODIO_SERICO, c04_w.QT_POTASSIO_SERICO, 
		c04_w.QT_CREATININA, c04_w.QT_HEMATOCRITO, c04_w.QT_GLOBULOS_BRANCOS, 
		c04_w.QT_ESCALA_GLASGOW, c04_w.IE_IRA, c04_w.IE_PO_URGENCIA, 
		c04_w.QT_PONT_VAR_FISIOLOGICAS, c04_w.QT_PONT_IDADE, c04_w.QT_PONT_DOENCA_CRONICA, 
		c04_w.QT_APACHE_II, c04_w.QT_RISCO_CALCULADO, c04_w.QT_OXIGENACAO_PCO2, 
		c04_w.PR_RISCO, c04_w.QT_TEMP_AXILAR, c04_w.QT_PTO_TEMP, 
		c04_w.QT_PTO_PA_MED, c04_w.QT_PTO_FC, c04_w.QT_PTO_FR, 
		c04_w.QT_PTO_OXIG, c04_w.QT_PTO_PH_ART, c04_w.QT_PTO_CREATININA, 
		c04_w.QT_PTO_HEMATOCRITO, c04_w.QT_PTO_GLOB_BRANCO, c04_w.QT_PTO_GLASGOW, 
		c04_w.QT_PTO_SODIO_SERICO, c04_w.QT_PTO_POT_SERICO, c04_w.QT_BICARBONATO_SERICO, 
		c04_w.QT_PONTO_BICARB_SERICO, c04_w.QT_PESO_CAT_DIAG, c04_w.NR_SEQ_CAT_DIAG, 
		c04_w.QT_PB, c04_w.QT_PAD, c04_w.QT_PAS, 
		null, c04_w.IE_TIPO_CATEGORIA, c04_w.CD_SETOR_PACIENTE, 
		c04_w.CD_PERFIL_ATIVO, 'A', null, 
		null, null,null);
		end;
	end loop;
	close C04;
elsif (upper(nm_tabela_p)	= 'ESCALA_RISCO_DELIRIUM') then
	open C05;
	loop
	fetch C05 into	
		c05_w;
	EXIT WHEN NOT FOUND; /* apply on C05 */
		begin
		INSERT INTO ESCALA_RISCO_DELIRIUM(
		NR_SEQUENCIA, DT_ATUALIZACAO, NM_USUARIO, 
		DT_ATUALIZACAO_NREC, NM_USUARIO_NREC, NR_ATENDIMENTO, 
		CD_PROFISSIONAL, DT_AVALIACAO, DT_LIBERACAO, 
		IE_SITUACAO, DT_INATIVACAO, QT_IDADE, 
		IE_ABUSO_ALCOOL, IE_DISFUCAO_COGNITIVA_PREV, IE_DOENCA_GRAVE, 
		IE_DIST_METAB_OPERAT, IE_CIRURGIA_ANEURISMA, NM_USUARIO_INATIVACAO, 
		DS_JUSTIFICATIVA, IE_CIRURGIA_TORAXICA, NR_SEQ_REG_ELEMENTO, 
		NR_SEQ_AVAL_PRE, NR_HORA ) 
		 VALUES ( 
		nextval('escala_risco_delirium_seq'), clock_timestamp(), nm_usuario_p, 
		clock_timestamp(), nm_usuario_p, nr_atendimento_p, 
		cd_pessoa_fisica_p, clock_timestamp(), null, 
		'A', null, c05_w.QT_IDADE, 
		c05_w.IE_ABUSO_ALCOOL, c05_w.IE_DISFUCAO_COGNITIVA_PREV, c05_w.IE_DOENCA_GRAVE, 
		c05_w.IE_DIST_METAB_OPERAT, c05_w.IE_CIRURGIA_ANEURISMA, c05_w.NM_USUARIO_INATIVACAO, 
		null, c05_w.IE_CIRURGIA_TORAXICA, c05_w.NR_SEQ_REG_ELEMENTO, 
		c05_w.NR_SEQ_AVAL_PRE,null );


		end;
	end loop;
	close C05;
	
elsif (upper(nm_tabela_p)	= 'ATEND_ESCALA_INDICE' ) then	
	
	open C06;
	loop
	fetch C06 into	
		c06_w;
	EXIT WHEN NOT FOUND; /* apply on C06 */
		begin
		INSERT INTO ATEND_ESCALA_INDICE(
		NR_SEQUENCIA, NR_ATENDIMENTO, DT_ATUALIZACAO, 
		NM_USUARIO, CD_PESSOA_FISICA, QT_GLASGOW, 
		IE_RESPOSTA_MOTORA, IE_RESPOSTA_VERBAL, IE_ABERTURA_OCULAR, 
		DT_AVALIACAO, DT_ATUALIZACAO_NREC, NM_USUARIO_NREC, 
		CD_SETOR_ATENDIMENTO, DT_LIBERACAO, IE_CLASSIF_ETARIA, 
		CD_PERFIL_ATIVO, IE_SITUACAO, DT_INATIVACAO, 
		NM_USUARIO_INATIVACAO, DS_JUSTIFICATIVA, NR_HORA,cd_paciente ) 
		 VALUES ( 
		nextval('atend_escala_indice_seq'), nr_atendimento_p, clock_timestamp(), 
		nm_usuario_p, cd_pessoa_fisica_p, c06_w.QT_GLASGOW, 
		c06_w.IE_RESPOSTA_MOTORA, c06_w.IE_RESPOSTA_VERBAL, c06_w.IE_ABERTURA_OCULAR, 
		clock_timestamp(), c06_w.DT_ATUALIZACAO_NREC, c06_w.NM_USUARIO_NREC, 
		c06_w.CD_SETOR_ATENDIMENTO, null, c06_w.IE_CLASSIF_ETARIA, 
		c06_w.CD_PERFIL_ATIVO, 'A', null, 
		null, null,null,c06_w.cd_paciente);
		
		end;
	end loop;
	close C06;

elsif (upper(nm_tabela_p)	= 'ESCALA_KARNOFSKY' ) then	
	
	open C07;
	loop
	fetch C07 into	
		c07_w;
	EXIT WHEN NOT FOUND; /* apply on C07 */
		begin
		
		IF (wheb_usuario_pck.get_cd_funcao = 381) THEN
			select	NR_SEQ_ATEND_CONS_PEPA
			into STRICT 	NR_SEQ_ATEND_CONS_PEPA_W
			from	escala_karnofsky
			where	nr_sequencia = nr_sequencia_p;
		ELSE
			NR_SEQ_ATEND_CONS_PEPA_W := null;
		END IF;
		
		INSERT INTO ESCALA_KARNOFSKY(
		NR_SEQUENCIA, NR_ATENDIMENTO, DT_ATUALIZACAO, 
		NM_USUARIO, CD_PROFISSIONAL, IE_KARNOFSKY, 
		DT_AVALIACAO, DT_ATUALIZACAO_NREC, NM_USUARIO_NREC, 
		DT_LIBERACAO,IE_SITUACAO, DT_INATIVACAO, 
		NM_USUARIO_INATIVACAO, DS_JUSTIFICATIVA, NR_HORA, NR_SEQ_ATEND_CONS_PEPA ) 
		 VALUES ( 
		nextval('escala_karnofsky_seq'), nr_atendimento_p, clock_timestamp(), 
		nm_usuario_p, cd_pessoa_fisica_p, c07_w.IE_KARNOFSKY, 
		clock_timestamp(), c07_w.DT_ATUALIZACAO_NREC, c07_w.NM_USUARIO_NREC, 
		null, 'A', null, 
		null, null,null, NR_SEQ_ATEND_CONS_PEPA_W);		
		end;
	end loop;
	close C07;
elsif (upper(nm_tabela_p)	= 'ATEND_ESCALA_BRADEN' ) then
	CALL DUPLICAR_ESCALA_BRADEN(nr_sequencia_p,nm_usuario_p,cd_pessoa_fisica_p,nr_atendimento_p);
elsif (upper(nm_tabela_p)	= 'ATEND_ESCALA_BRADEN_Q' ) then
	CALL DUPLICAR_ESCALA_BRADEN_Q(nr_sequencia_p,nm_usuario_p,cd_pessoa_fisica_p,nr_atendimento_p);
elsif (upper(nm_tabela_p)	= 'GCA_ATENDIMENTO' ) then
	nr_seq_retorno_w := DUPLICAR_ESCALA_COMPLEXIDADE(nr_sequencia_p, nm_usuario_p, cd_pessoa_fisica_p, nr_seq_retorno_w, nr_atendimento_p);
elsif (upper(nm_tabela_p)	= 'TISS_INTERV_TERAPEUTICA' ) then
	CALL DUPLICAR_ESCALA_TISS(nr_sequencia_p,nm_usuario_p,cd_pessoa_fisica_p,nr_atendimento_p);
	
elsif (upper(nm_tabela_p)	= 'ESCALA_TEV') then
	begin
	
	
	open C08;
	loop
	fetch C08 into	
		c08_w;
	EXIT WHEN NOT FOUND; /* apply on C08 */
		begin
		insert into ESCALA_TEV(
					 NR_SEQUENCIA,
					 DT_ATUALIZACAO,
					 NM_USUARIO,
					 DT_ATUALIZACAO_NREC,
					 NM_USUARIO_NREC,
					 IE_RISCO,
					 NR_ATENDIMENTO,
					 DT_AVALIACAO,
					 IE_SITUACAO,
					 DT_LIBERACAO,
					 DT_INATIVACAO,
					 NM_USUARIO_INATIVACAO,
					 DS_JUSTIFICATIVA,
					 CD_PROFISSIONAL,
					 IE_CLINICO_CIRURGICO,
					 QT_IDADE,
					 IE_INSUF_ARTERIAL,
					 IE_MOBILIDADE_REDUZIDA,
					 IE_FATOR_RISCO,
					 IE_CONDICAO,
					 IE_ALTISSIMO_RISCO,
					 IE_ALTO_RISCO,
					 IE_AVCI,
					 IE_TROMBOFILIA,
					 IE_TVP_EP_PREVIA,
					 IE_HIST_FAMILIAR_TEV,
					 IE_ANTICONCEPCIONAIS,
					 IE_PUERPERIO,
					 IE_OBESIDADE,
					 IE_INTERNACAO_UTI,
					 IE_CAT_VENOSO_CENTRAL,
					 IE_INSUF_RESP,
					 IE_PARALISIA_INF,
					 IE_ICC,
					 IE_DPOC,
					 IE_PNEUMONIA,
					 IE_INFLA_INTESTINAL,
					 IE_VARIZES,
					 IE_INFECSAO_GRAVE,
					 IE_QUIMIOTERAPIA,
					 IE_SINDROME_NEFROTICA,
					 IE_DOENCA_AUTOIMUNE,
					 IE_TRAUMA,
					 IE_ABORTAMENTO,
					 IE_IAM,
					 IE_ECLAMPSIA,
					 IE_QUEIMADO,
					 IE_OUTROS,
					 IE_SANGRAMENTO_ULCERA,
					 IE_COAGULOPATIA,
					 IE_HIPERTENSAO,
					 IE_INSUF_RENAL,
					 IE_CIRURGIA_INTRACRANIANA,
					 IE_PUNCAO_LIQUORICA,
					 IE_HIPERSENSIBILIDADE_HEPARINA,
					 IE_CIRUR_ORTOPEDICA,
					 IE_CIRUR_CANCER,
					 IE_TRAUMA_GRAVE,
					 IE_TRAUM_RAQUIMEDULARES,
					 IE_CANCER,
					 IE_CIRUR_GRANDE,
					 IE_MEMBROS_IMOB,
					 IE_TRH,
					 IE_NENHUM_ALT_RISCO,
					 IE_RESTRICAO_PROLONG,
					 IE_NENHUM_ALTISSIMO_RISCO,
					 IE_NENHUM_RISCO,
					 DS_RESULTADO,
					 NR_SEQ_REG_ELEMENTO,
					 QT_PESO,
					 QT_ALTURA_CM,
					 IE_GRAVIDEZ,
					 IE_IDADE_MAIOR,
					 IE_TABAGISMO,
					 IE_DOENCA_REUMATOL,
					 IE_ULCERA_ATIVA,
					 IE_RISCO_CIRURGIA,
					 IE_PORTE_CIRURGIA,
					 IE_IDADE_MENOR,
					 IE_IDADE_AVANCADA,
					 IE_PLAQUETOPENIA_HEPARINA,
					 IE_ESCARA,
					 IE_FRATURA_EXPOSTA,
					 IE_INFECCAO_MMII,
					 IE_INSUF_ART_MMII,
					 IE_INSUF_CARD_GRAVE,
					 IE_PADRAO,
					 IE_CIR_ALTO_RISCO,
					 IE_CIR_GRANDE_MEDIO_PORTE,
					 IE_CIR_PEQUENO_PORTE,
					 IE_NENHUMA_CONTRA_INDIC,
					 IE_ARTROPLASTIA_JOELHO,
					 IE_ARTROPLASTIA_QUADRIL,
					 IE_FRATURA_QUADRIL,
					 IE_ONCOL_CURATIVA,
					 IE_TRAUMA_MEDULAR,
					 IE_POLITRAUMA,
					 IE_NENHUM_RISCO_PROF,
					 IE_ANTICOAGULACAO,
					 IE_QUIMIOPROFILAXIA,
					 IE_PROFILAXIA_MEC,
					 IE_CONTRA_INDIC,
					 NR_SEQ_MOTIVO_TEV,
					 IE_NAO_SE_APLICA,
					 NR_HORA,
					 QT_PONTUACAO,
					 NR_SEQ_ASSINATURA,
					 NR_SEQ_ASSINAT_INATIVACAO,
					 IE_BARIATRICA,
					 IE_TRAUMA_CRANIANO, 
					 IE_DEMAIS_CIRURGIAS, 
					 IE_CONT_POLITRAUMA, 
					 IE_MOB_RED_FINALIZADA, 
					 IE_CI_INESP_1,  
					 IE_CI_INESP_2,  
					 IE_CI_INESP_3)
				values (
					 nextval('escala_tev_seq'),
					 clock_timestamp(),
					 nm_usuario_p,
					 clock_timestamp(),
					 nm_usuario_p,
					 c08_w.IE_RISCO,
					 nr_atendimento_p,
					 clock_timestamp(),
					 'A',
					 null,
					 null,
					 null,
					 null,
					 cd_pessoa_fisica_p,
					 c08_w.IE_CLINICO_CIRURGICO,
					 c08_w.QT_IDADE,
					 c08_w.IE_INSUF_ARTERIAL,
					 c08_w.IE_MOBILIDADE_REDUZIDA,
					 c08_w.IE_FATOR_RISCO,
					 c08_w.IE_CONDICAO,
					 c08_w.IE_ALTISSIMO_RISCO,
					 c08_w.IE_ALTO_RISCO,
					 c08_w.IE_AVCI,
					 c08_w.IE_TROMBOFILIA,
					 c08_w.IE_TVP_EP_PREVIA,
					 c08_w.IE_HIST_FAMILIAR_TEV,
					 c08_w.IE_ANTICONCEPCIONAIS,
					 c08_w.IE_PUERPERIO,
					 c08_w.IE_OBESIDADE,
					 c08_w.IE_INTERNACAO_UTI,
					 c08_w.IE_CAT_VENOSO_CENTRAL,
					 c08_w.IE_INSUF_RESP,
					 c08_w.IE_PARALISIA_INF,
					 c08_w.IE_ICC,
					 c08_w.IE_DPOC,
					 c08_w.IE_PNEUMONIA,
					 c08_w.IE_INFLA_INTESTINAL,
					 c08_w.IE_VARIZES,
					 c08_w.IE_INFECSAO_GRAVE,
					 c08_w.IE_QUIMIOTERAPIA,
					 c08_w.IE_SINDROME_NEFROTICA,
					 c08_w.IE_DOENCA_AUTOIMUNE,
					 c08_w.IE_TRAUMA,
					 c08_w.IE_ABORTAMENTO,
					 c08_w.IE_IAM,
					 c08_w.IE_ECLAMPSIA,
					 c08_w.IE_QUEIMADO,
					 c08_w.IE_OUTROS,
					 c08_w.IE_SANGRAMENTO_ULCERA,
					 c08_w.IE_COAGULOPATIA,
					 c08_w.IE_HIPERTENSAO,
					 c08_w.IE_INSUF_RENAL,
					 c08_w.IE_CIRURGIA_INTRACRANIANA,
					 c08_w.IE_PUNCAO_LIQUORICA,
					 c08_w.IE_HIPERSENSIBILIDADE_HEPARINA,
					 c08_w.IE_CIRUR_ORTOPEDICA,
					 c08_w.IE_CIRUR_CANCER,
					 c08_w.IE_TRAUMA_GRAVE,
					 c08_w.IE_TRAUM_RAQUIMEDULARES,
					 c08_w.IE_CANCER,
					 c08_w.IE_CIRUR_GRANDE,
					 c08_w.IE_MEMBROS_IMOB,
					 c08_w.IE_TRH,
					 c08_w.IE_NENHUM_ALT_RISCO,
					 c08_w.IE_RESTRICAO_PROLONG,
					 c08_w.IE_NENHUM_ALTISSIMO_RISCO,
					 c08_w.IE_NENHUM_RISCO,
					 c08_w.DS_RESULTADO,
					 c08_w.NR_SEQ_REG_ELEMENTO,
					 c08_w.QT_PESO,
					 c08_w.QT_ALTURA_CM,
					 c08_w.IE_GRAVIDEZ,
					 c08_w.IE_IDADE_MAIOR,
					 c08_w.IE_TABAGISMO,
					 c08_w.IE_DOENCA_REUMATOL,
					 c08_w.IE_ULCERA_ATIVA,
					 c08_w.IE_RISCO_CIRURGIA,
					 c08_w.IE_PORTE_CIRURGIA,
					 c08_w.IE_IDADE_MENOR,
					 c08_w.IE_IDADE_AVANCADA,
					 c08_w.IE_PLAQUETOPENIA_HEPARINA,
					 c08_w.IE_ESCARA,
					 c08_w.IE_FRATURA_EXPOSTA,
					 c08_w.IE_INFECCAO_MMII,
					 c08_w.IE_INSUF_ART_MMII,
					 c08_w.IE_INSUF_CARD_GRAVE,
					 c08_w.IE_PADRAO,
					 c08_w.IE_CIR_ALTO_RISCO,
					 c08_w.IE_CIR_GRANDE_MEDIO_PORTE,
					 c08_w.IE_CIR_PEQUENO_PORTE,
					 c08_w.IE_NENHUMA_CONTRA_INDIC,
					 c08_w.IE_ARTROPLASTIA_JOELHO,
					 c08_w.IE_ARTROPLASTIA_QUADRIL,
					 c08_w.IE_FRATURA_QUADRIL,
					 c08_w.IE_ONCOL_CURATIVA,
					 c08_w.IE_TRAUMA_MEDULAR,
					 c08_w.IE_POLITRAUMA,
					 c08_w.IE_NENHUM_RISCO_PROF,
					 c08_w.IE_ANTICOAGULACAO,
					 c08_w.IE_QUIMIOPROFILAXIA,
					 c08_w.IE_PROFILAXIA_MEC,
					 c08_w.IE_CONTRA_INDIC,
					 c08_w.NR_SEQ_MOTIVO_TEV,
					 c08_w.IE_NAO_SE_APLICA,
					 c08_w.NR_HORA,
					 c08_w.QT_PONTUACAO,
					 null,
					 null,					 
					 c08_w.IE_BARIATRICA, 
					 c08_w.IE_TRAUMA_CRANIANO, 
					 c08_w.IE_DEMAIS_CIRURGIAS, 
					 c08_w.IE_CONT_POLITRAUMA, 
					 c08_w.IE_MOB_RED_FINALIZADA, 
					 c08_w.IE_CI_INESP_1,  
					 c08_w.IE_CI_INESP_2,  
					 c08_w.IE_CI_INESP_3);

		end;
	end loop;
	close C08;
	
	
	end;
elsif (upper(nm_tabela_p)	= 'ESCALA_ASHWORTH') then
	begin
	 		
	open C09;
	loop
	fetch C09 into	
		c09_w;
	EXIT WHEN NOT FOUND; /* apply on C09 */
		begin
		insert into ESCALA_ASHWORTH(nr_sequencia,
						 dt_atualizacao,
						 nm_usuario,
						 dt_atualizacao_nrec,
						 nm_usuario_nrec,
						 nr_atendimento,
						 cd_profissional,
						 dt_avaliacao,
						 ie_situacao,
						 dt_liberacao,
						 dt_inativacao,
						 nm_usuario_inativacao,
						 ds_justificativa,
						 ie_tipo_avaliacao
						)
					values (nextval('escala_ashworth_seq'),
						clock_timestamp(),
						nm_usuario_p,
						clock_timestamp(),
						nm_usuario_p,
						nr_atendimento_p,
						cd_pessoa_fisica_p,
						clock_timestamp(),
						'A',
						null,
						null,
						null,
						null,
						c09_w.ie_tipo_avaliacao);
		select 	max(nr_sequencia)
		into STRICT	nr_seq_ashworth_w
		from	escala_ashworth
		where 	nr_Atendimento = nr_atendimento_p;		
		
		open C10;
		loop
		fetch C10 into	
			c10_w;
		EXIT WHEN NOT FOUND; /* apply on C10 */
			begin
			insert into ESCALA_ASHWORTH_ITEM(nr_sequencia,
							 dt_atualizacao,
							 nm_usuario,
							 dt_atualizacao_nrec,
							 nm_usuario_nrec,
							 nr_seq_ashworth,
							 nr_seq_art_mov_musculo,
							 ie_ashworth_d,
							 ie_ashworth_e
							)
						values (nextval('escala_ashworth_item_seq'),
							clock_timestamp(),
							nm_usuario_p,
							clock_timestamp(),
							nm_usuario_p,
							nr_seq_ashworth_w,
							c10_w.nr_seq_art_mov_musculo,
							c10_w.ie_ashworth_d,
							c10_w.ie_ashworth_e);

			end;
		end loop;
		close C10;

		end;
	end loop;
	close C09;
	
	
	end;
elsif (upper(nm_tabela_p)	= 'ESCALA_EIF') then
	begin
	 		
	open C11;
	loop
	fetch C11 into	
		c11_w;
	EXIT WHEN NOT FOUND; /* apply on C11 */
		begin
                if (nr_atendimento_p = 0) then
                    nr_atendimento_score_flex_w := null;
                 else
                    nr_atendimento_score_flex_w := nr_atendimento_p;
                end if;

                insert into escala_eif(cd_profissional,
					 ds_justificativa,
					 dt_atualizacao,
					 dt_atualizacao_nrec,
					 dt_avaliacao,
					 dt_inativacao,
					 dt_liberacao,
					 ie_situacao,
					 nm_usuario,
					 nm_usuario_inativacao,
					 nm_usuario_nrec,
					 nr_atendimento,
					 nr_sequencia,
					 nr_seq_escala,
					 nr_seq_result,
					 qt_pontos,
                     cd_pessoa_fisica
					)
				values (obter_pessoa_fisica_usuario(nm_usuario_p, 'C'),
					null,
					clock_timestamp(),
					clock_timestamp(),
					clock_timestamp(),
					null,
					null,
					'A',
					nm_usuario_p,
					null,
					nm_usuario_p,
					nr_atendimento_score_flex_w,
					nextval('escala_eif_seq'),
					c11_w.nr_seq_escala,
					c11_w.nr_seq_result,
					c11_w.qt_pontos,
                    c11_w.cd_pessoa_fisica
					);		

		end;
	end loop;
	close C11;
	
			update 	escala_eif_item e
			set	e.ie_resultado = 'S'
			where	e.nr_seq_escala = ( SELECT 	max(t.nr_Sequencia)
						    from	escala_eif t,
								escala_eif_item w
						    where	nr_Atendimento = nr_Atendimento_p
						    and		w.nr_seq_escala = t.nr_sequencia
						    and		w.nr_seq_item = e.nr_seq_item)
			and (select b.ie_resultado
				 from	escala_eif_item b
				 where	b.nr_Seq_item = e.nr_Seq_item
				 and	b.nr_seq_escala = nr_Sequencia_p) = 'S';		
	
	
	end;		
	
elsif (upper(nm_tabela_p)	= 'ESCALA_MORSE')	then
	begin
	open C12;
	loop
	fetch C12 into	
		c12_w;
	EXIT WHEN NOT FOUND; /* apply on C12 */
		begin
		
			insert into escala_morse(	NR_SEQUENCIA,
							DT_ATUALIZACAO,
							NM_USUARIO,                     
							DT_ATUALIZACAO_NREC,            
							NM_USUARIO_NREC,                
							NR_ATENDIMENTO,                 
							CD_PROFISSIONAL,                
							IE_SITUACAO,                    
							DT_LIBERACAO,                   
							DT_INATIVACAO,                  
							NM_USUARIO_INATIVACAO,          
							DS_JUSTIFICATIVA,               
							IE_HIST_QUEDA,                  
							IE_DIAG_SECUNDARIO,             
							IE_AJUDA_DEAMBULAR,             
							IE_USO_HEPARINA,                
							IE_MODO_ANDAR,                  
							IE_ESTADO_MENTAL,               
							QT_PONTUACAO,                   
							DT_AVALIACAO,                   
							NR_HORA,                        
							NR_SEQ_ASSINATURA,              
							NR_SEQ_ASSINAT_INATIVACAO)
					values (	nextval('escala_morse_seq'),
							clock_timestamp(),
							nm_usuario_p,
							clock_timestamp(),
							nm_usuario_p,
							nr_atendimento_p,
							cd_pessoa_fisica_p,
							'A',
							null,
							null,
							null,
							null,
							c12_w.IE_HIST_QUEDA,                  
							c12_w.IE_DIAG_SECUNDARIO,             
							c12_w.IE_AJUDA_DEAMBULAR,             
							c12_w.IE_USO_HEPARINA,                
							c12_w.IE_MODO_ANDAR,                  
							c12_w.IE_ESTADO_MENTAL,               
							c12_w.QT_PONTUACAO,                   
							clock_timestamp(),                   
							c12_w.NR_HORA,                        
							null,              
							null);
		
		end;
	end loop;
	close C12;
	end;
elsif (upper(nm_tabela_p)	= 'ESCALA_ASG_PPP')	then
	
	open C13;
	loop
	fetch C13 into	
		C13_w;
	EXIT WHEN NOT FOUND; /* apply on C13 */
		begin
		insert into ESCALA_ASG_PPP(
			 NR_SEQUENCIA,
			 DT_ATUALIZACAO,
			 NM_USUARIO,
			 DT_ATUALIZACAO_NREC,
			 NM_USUARIO_NREC,
			 CD_PROFISSIONAL,
			 NR_ATENDIMENTO,
			 DT_AVALIACAO,
			 IE_SITUACAO,
			 DT_LIBERACAO,
			 DT_INATIVACAO,
			 NM_USUARIO_INATIVACAO,
			 DS_JUSTIFICATIVA,
			 QT_PESO_ATUAL,
			 QT_PESO_MES,
			 QT_PESO_6_MES,
			 QT_ALTURA_CM,
			 QT_PONTO_PESO,
			 IE_AUMENTO_PESO,
			 IE_INGESTAO_MES,
			 IE_INGESTAO_ATUAL,
			 QT_PONTO_INGESTAO,
			 IE_SEM_PROBLEMA_ALIMENTAR,
			 IE_SEM_APETITE,
			 IE_NAUSEA,
			 IE_VOMITO,
			 IE_CONSTIPACAO,
			 IE_DIARREIA,
			 IE_FERIDA_BOCA,
			 IE_BOCA_SECA,
			 IE_ALIMENTO_SEM_GOSTO,
			 IE_CHEIRO_ENJOAM,
			 IE_PROBLEMA_ENGOLIR,
			 IE_RAPIDAMENTE_SAT,
			 IE_DOR,
			 IE_OUTROS,
			 QT_PONTO_SINTOMAS,
			 IE_ATIVIDADE,
			 QT_PONTO_ATIVIDADE,
			 IE_CANCER,
			 IE_AIDS,
			 IE_CAQUEIXA,
			 IE_ULCERA,
			 IE_IDADE_65,
			 QT_PONTO_DOENCA,
			 IE_FEBRE,
			 IE_DURACAO_FEBRE,
			 IE_CORTICOSTEROIDES,
			 QT_PONTO_ESTRESSE,
			 IE_REG_PERI_ORBITAL,
			 IE_PREGA_TRICEPS,
			 IE_GORDURA_COSTELA,
			 IE_GERAL_DEF_GORDURA,
			 IE_TEMPORAS,
			 IE_CLAVICULAS,
			 IE_OMBROS,
			 IE_MUSC_INTRA_OSSEA,
			 IE_ESCAPULA,
			 IE_COXA,
			 IE_PANTURRILHA,
			 IE_GERAL_DEF_MUSC,
			 IE_EDEMA_TORNOZELO,
			 IE_EDEMA_SACRAL,
			 IE_ASCITE,
			 IE_GERAL_EST_HIDRATACAO,
			 QT_PONTO_EXAME_FIS,
			 IE_TRAUMA,
			 QT_PONTO_TOTAL,
			 IE_AVALIACAO_GLOBAL,
			 IE_PESO_MES_ANT,
			 DS_DOR,
			 DS_OUTROS_SINTOMAS,
			 IE_PESO_6_MESES,
			 QT_PONTO_A,
			 PR_PERDA_MES,
			 PR_PERDA_6_MES,
			 QT_PONTOS_GORDURA,
			 QT_PONTOS_MUSCULO,
			 QT_PONTOS_HIDRATACAO,
			 DS_OBSERVACAO,
			 NR_SEQ_ASSINAT_INATIVACAO,
			 NR_SEQ_ASSINATURA,
			 IE_COMIDA_NORMAL_MENOR,
			 IE_COMIDA_NORMAL_POUCA,
			 IE_APENAS_LIQUIDO,
			 IE_APENAS_SUPLEMENTO,
			 IE_POUCA_COMIDA,
			 IE_ALIMENTO_SONDA,
			 IE_AVALIADOR_AUX,
			 DT_LIBERACAO_AUX)
		values (
			 nextval('escala_asg_ppp_seq'),
			 clock_timestamp(),
			 nm_usuario_p,
			 clock_timestamp(),
			 nm_usuario_p,
			 cd_pessoa_fisica_p,
			 NR_ATENDIMENTO_p,
			 clock_timestamp(),
			 'A',
			 null,
			 Null,
			 null,
			 Null,
			 c13_w.QT_PESO_ATUAL,
			 c13_w.QT_PESO_MES,
			 c13_w.QT_PESO_6_MES,
			 c13_w.QT_ALTURA_CM,
			 c13_w.QT_PONTO_PESO,
			 c13_w.IE_AUMENTO_PESO,
			 c13_w.IE_INGESTAO_MES,
			 c13_w.IE_INGESTAO_ATUAL,
			 c13_w.QT_PONTO_INGESTAO,
			 c13_w.IE_SEM_PROBLEMA_ALIMENTAR,
			 c13_w.IE_SEM_APETITE,
			 c13_w.IE_NAUSEA,
			 c13_w.IE_VOMITO,
			 c13_w.IE_CONSTIPACAO,
			 c13_w.IE_DIARREIA,
			 c13_w.IE_FERIDA_BOCA,
			 c13_w.IE_BOCA_SECA,
			 c13_w.IE_ALIMENTO_SEM_GOSTO,
			 c13_w.IE_CHEIRO_ENJOAM,
			 c13_w.IE_PROBLEMA_ENGOLIR,
			 c13_w.IE_RAPIDAMENTE_SAT,
			 c13_w.IE_DOR,
			 c13_w.IE_OUTROS,
			 c13_w.QT_PONTO_SINTOMAS,
			 c13_w.IE_ATIVIDADE,
			 c13_w.QT_PONTO_ATIVIDADE,
			 c13_w.IE_CANCER,
			 c13_w.IE_AIDS,
			 c13_w.IE_CAQUEIXA,
			 c13_w.IE_ULCERA,
			 c13_w.IE_IDADE_65,
			 c13_w.QT_PONTO_DOENCA,
			 c13_w.IE_FEBRE,
			 c13_w.IE_DURACAO_FEBRE,
			 c13_w.IE_CORTICOSTEROIDES,
			 c13_w.QT_PONTO_ESTRESSE,
			 c13_w.IE_REG_PERI_ORBITAL,
			 c13_w.IE_PREGA_TRICEPS,
			 c13_w.IE_GORDURA_COSTELA,
			 c13_w.IE_GERAL_DEF_GORDURA,
			 c13_w.IE_TEMPORAS,
			 c13_w.IE_CLAVICULAS,
			 c13_w.IE_OMBROS,
			 c13_w.IE_MUSC_INTRA_OSSEA,
			 c13_w.IE_ESCAPULA,
			 c13_w.IE_COXA,
			 c13_w.IE_PANTURRILHA,
			 c13_w.IE_GERAL_DEF_MUSC,
			 c13_w.IE_EDEMA_TORNOZELO,
			 c13_w.IE_EDEMA_SACRAL,
			 c13_w.IE_ASCITE,
			 c13_w.IE_GERAL_EST_HIDRATACAO,
			 c13_w.QT_PONTO_EXAME_FIS,
			 c13_w.IE_TRAUMA,
			 c13_w.QT_PONTO_TOTAL,
			 c13_w.IE_AVALIACAO_GLOBAL,
			 c13_w.IE_PESO_MES_ANT,
			 c13_w.DS_DOR,
			 c13_w.DS_OUTROS_SINTOMAS,
			 c13_w.IE_PESO_6_MESES,
			 c13_w.QT_PONTO_A,
			 c13_w.PR_PERDA_MES,
			 c13_w.PR_PERDA_6_MES,
			 c13_w.QT_PONTOS_GORDURA,
			 c13_w.QT_PONTOS_MUSCULO,
			 c13_w.QT_PONTOS_HIDRATACAO,
			 c13_w.DS_OBSERVACAO,
			 null,
			 null,
			 c13_w.IE_COMIDA_NORMAL_MENOR,
			 c13_w.IE_COMIDA_NORMAL_POUCA,
			 c13_w.IE_APENAS_LIQUIDO,
			 c13_w.IE_APENAS_SUPLEMENTO,
			 c13_w.IE_POUCA_COMIDA,
			 c13_w.IE_ALIMENTO_SONDA,
			 'N',
			 null);

		end;
	end loop;
	close C13;
	
elsif (upper(nm_tabela_p)	= 'ESCALA_NTISS')	then
	
	open C14;
	loop
	fetch C14 into	
		C14_w;
	EXIT WHEN NOT FOUND; /* apply on C14 */
		begin
		insert into ESCALA_NTISS(
			 NR_SEQUENCIA,
			 NR_ATENDIMENTO,
			 CD_PROFISSIONAL,
			 DT_ATUALIZACAO,
			 DT_LIBERACAO,
			 DT_AVALIACAO,
			 NM_USUARIO,
			 NM_USUARIO_NREC,
			 DT_ATUALIZACAO_NREC,
			 IE_VENTILACAO,
			 QT_PTO_VENT,
			 IE_SURFACTANTE,
			 QT_PTO_SURFACTANTE,
			 IE_INTUBACAO_TRAQ,
			 QT_PTO_INTUBACAO,
			 IE_TRAQUEOSTOMIA,
			 QT_PTO_TRAQUEOSTOMIA,
			 IE_ECMO,
			 QT_PTO_ECMO,
			 IE_USO_ATB,
			 QT_PTO_ATB,
			 IE_USO_DIURETICO,
			 QT_PTO_DIURETICO,
			 IE_ANTICONVULSIVANTE,
			 QT_PTO_ANTICONVULSIVANTE,
			 IE_AMINOFILINA,
			 QT_PTO_AMINOFILINA,
			 IE_MEDIC_NAO_PROG,
			 QT_PTO_MEDIC_NAO_PROG,
			 IE_CORTICOIDE,
			 QT_PTO_CORTICOIDE,
			 IE_RESINA,
			 QT_PTO_RESINA,
			 IE_TRAT_METABOLICO,
			 QT_PTO_TRAT_META,
			 IE_ALIMENT_GAVAGEM,
			 QT_PTO_ALIMENT_GAVAGEM,
			 IE_FOTOTERAPIA,
			 QT_PTO_FOTOTERAPIA,
			 IE_EMULSAO_LIPIDICA,
			 QT_PTO_EMULSAO,
			 IE_INFUSAO_AMINOACIDO,
			 QT_PTO_INFUSAO_AMINO,
			 IE_ADM_INSULINA,
			 QT_PTO_ADM_INSULINA,
			 IE_INFUSAO_POTASSIO,
			 QT_PTO_INFUSAO_POT,
			 IE_TRANSPORTE,
			 QT_PTO_TRANSPORTE,
			 IE_DIALISE,
			 QT_PTO_DIALISE,
			 IE_DRENAGEM,
			 QT_PTO_DRENAGEM,
			 IE_TORACOCENTESE,
			 QT_PTO_TORACOCENTESE,
			 IE_PERICARDIO,
			 QT_PTO_PERICARDIO,
			 IE_OPERACAO,
			 QT_PTO_OPERACAO,
			 IE_INDOMETACINA,
			 QT_PTO_INDOMETACINA,
			 IE_EXPANSAO,
			 QT_PTO_EXPANSAO,
			 IE_VASOPRESSOR,
			 QT_PTO_VASOPRESSOR,
			 IE_RESSUCITACAO,
			 QT_PTO_RESSUCITACAO,
			 IE_MARCAPASSO,
			 QT_PTO_MARCAPASSO,
			 IE_SINAL_VITAL,
			 QT_PTO_SINAL_VITAL,
			 IE_COLETA_SANGUE,
			 QT_PTO_COLETA,
			 IE_MONITOR_CARDIO,
			 QT_PTO_MONIT_CARDIO,
			 IE_AMB_TERMOREGULADO,
			 QT_PTO_TERMOREGULADO,
			 IE_OXIMETRIA,
			 QT_PTO_OXIMETRIA,
			 IE_MONIT_PA,
			 QT_PTO_MONIT_PA,
			 IE_MONIT_PVC,
			 QT_PTO_MONIT_PVC,
			 IE_CATETER,
			 QT_PTO_CATETER,
			 IE_BALANCO_HIDRICO,
			 QT_PTO_BALANCO_HIDRICO,
			 IE_GAMAGLOBULINA,
			 QT_PTO_GAMAGLOBULINA,
			 IE_EXSANGUINEOTRA,
			 QT_PTO_EXSANGUINEOTRA,
			 IE_EXSANGUINEOTRA_PARCIAL,
			 QT_PTO_EXSANGUINEO_PAR,
			 IE_TRANSFUSAO_PLAQ,
			 QT_PTO_TRANSF_PLAQ,
			 IE_TRANSFUSAO_PLASMA,
			 QT_PTO_TRANSF_PLASMA,
			 IE_ACESSO_ARTERIAL,
			 QT_PTO_ACESSO_ARTERIAL,
			 IE_ACESSO_VENOSO_PER,
			 QT_PTO_ACESSO_VENOSO_PER,
			 IE_ACESSO_VENOSO_CENTRAL,
			 QT_PTO_ACESSO_VENOSO_CEN,
			 IE_HEMOTRANSF_MENOR,
			 QT_PTO_HEMOTRANSF_MENOR,
			 QT_PTO_TOTAL,
			 CD_PERFIL_ATIVO,
			 IE_SITUACAO,
			 DT_INATIVACAO,
			 NM_USUARIO_INATIVACAO,
			 DS_JUSTIFICATIVA,
			 NR_HORA)
		values (
			 nextval('escala_ntiss_seq'),
			 NR_ATENDIMENTO_p,
			 cd_pessoa_fisica_p,
			 clock_timestamp(),
			 null,
			 clock_timestamp(),
			 nm_usuario_p,
			 nm_usuario_p,
			 clock_timestamp(),
			 c14_w.IE_VENTILACAO,
			 c14_w.QT_PTO_VENT,
			 c14_w.IE_SURFACTANTE,
			 c14_w.QT_PTO_SURFACTANTE,
			 c14_w.IE_INTUBACAO_TRAQ,
			 c14_w.QT_PTO_INTUBACAO,
			 c14_w.IE_TRAQUEOSTOMIA,
			 c14_w.QT_PTO_TRAQUEOSTOMIA,
			 c14_w.IE_ECMO,
			 c14_w.QT_PTO_ECMO,
			 c14_w.IE_USO_ATB,
			 c14_w.QT_PTO_ATB,
			 c14_w.IE_USO_DIURETICO,
			 c14_w.QT_PTO_DIURETICO,
			 c14_w.IE_ANTICONVULSIVANTE,
			 c14_w.QT_PTO_ANTICONVULSIVANTE,
			 c14_w.IE_AMINOFILINA,
			 c14_w.QT_PTO_AMINOFILINA,
			 c14_w.IE_MEDIC_NAO_PROG,
			 c14_w.QT_PTO_MEDIC_NAO_PROG,
			 c14_w.IE_CORTICOIDE,
			 c14_w.QT_PTO_CORTICOIDE,
			 c14_w.IE_RESINA,
			 c14_w.QT_PTO_RESINA,
			 c14_w.IE_TRAT_METABOLICO,
			 c14_w.QT_PTO_TRAT_META,
			 c14_w.IE_ALIMENT_GAVAGEM,
			 c14_w.QT_PTO_ALIMENT_GAVAGEM,
			 c14_w.IE_FOTOTERAPIA,
			 c14_w.QT_PTO_FOTOTERAPIA,
			 c14_w.IE_EMULSAO_LIPIDICA,
			 c14_w.QT_PTO_EMULSAO,
			 c14_w.IE_INFUSAO_AMINOACIDO,
			 c14_w.QT_PTO_INFUSAO_AMINO,
			 c14_w.IE_ADM_INSULINA,
			 c14_w.QT_PTO_ADM_INSULINA,
			 c14_w.IE_INFUSAO_POTASSIO,
			 c14_w.QT_PTO_INFUSAO_POT,
			 c14_w.IE_TRANSPORTE,
			 c14_w.QT_PTO_TRANSPORTE,
			 c14_w.IE_DIALISE,
			 c14_w.QT_PTO_DIALISE,
			 c14_w.IE_DRENAGEM,
			 c14_w.QT_PTO_DRENAGEM,
			 c14_w.IE_TORACOCENTESE,
			 c14_w.QT_PTO_TORACOCENTESE,
			 c14_w.IE_PERICARDIO,
			 c14_w.QT_PTO_PERICARDIO,
			 c14_w.IE_OPERACAO,
			 c14_w.QT_PTO_OPERACAO,
			 c14_w.IE_INDOMETACINA,
			 c14_w.QT_PTO_INDOMETACINA,
			 c14_w.IE_EXPANSAO,
			 c14_w.QT_PTO_EXPANSAO,
			 c14_w.IE_VASOPRESSOR,
			 c14_w.QT_PTO_VASOPRESSOR,
			 c14_w.IE_RESSUCITACAO,
			 c14_w.QT_PTO_RESSUCITACAO,
			 c14_w.IE_MARCAPASSO,
			 c14_w.QT_PTO_MARCAPASSO,
			 c14_w.IE_SINAL_VITAL,
			 c14_w.QT_PTO_SINAL_VITAL,
			 c14_w.IE_COLETA_SANGUE,
			 c14_w.QT_PTO_COLETA,
			 c14_w.IE_MONITOR_CARDIO,
			 c14_w.QT_PTO_MONIT_CARDIO,
			 c14_w.IE_AMB_TERMOREGULADO,
			 c14_w.QT_PTO_TERMOREGULADO,
			 c14_w.IE_OXIMETRIA,
			 c14_w.QT_PTO_OXIMETRIA,
			 c14_w.IE_MONIT_PA,
			 c14_w.QT_PTO_MONIT_PA,
			 c14_w.IE_MONIT_PVC,
			 c14_w.QT_PTO_MONIT_PVC,
			 c14_w.IE_CATETER,
			 c14_w.QT_PTO_CATETER,
			 c14_w.IE_BALANCO_HIDRICO,
			 c14_w.QT_PTO_BALANCO_HIDRICO,
			 c14_w.IE_GAMAGLOBULINA,
			 c14_w.QT_PTO_GAMAGLOBULINA,
			 c14_w.IE_EXSANGUINEOTRA,
			 c14_w.QT_PTO_EXSANGUINEOTRA,
			 c14_w.IE_EXSANGUINEOTRA_PARCIAL,
			 c14_w.QT_PTO_EXSANGUINEO_PAR,
			 c14_w.IE_TRANSFUSAO_PLAQ,
			 c14_w.QT_PTO_TRANSF_PLAQ,
			 c14_w.IE_TRANSFUSAO_PLASMA,
			 c14_w.QT_PTO_TRANSF_PLASMA,
			 c14_w.IE_ACESSO_ARTERIAL,
			 c14_w.QT_PTO_ACESSO_ARTERIAL,
			 c14_w.IE_ACESSO_VENOSO_PER,
			 c14_w.QT_PTO_ACESSO_VENOSO_PER,
			 c14_w.IE_ACESSO_VENOSO_CENTRAL,
			 c14_w.QT_PTO_ACESSO_VENOSO_CEN,
			 c14_w.IE_HEMOTRANSF_MENOR,
			 c14_w.QT_PTO_HEMOTRANSF_MENOR,
			 c14_w.QT_PTO_TOTAL,
			 null,
			 'A',
			 NULL,
			 NULL,
			 NULL,
			 NULL);
		end;
	end loop;
	close C14;
	
elsif (upper(nm_tabela_p)	= 'TISS_INTERV_TERAPEUTICA_10')	then
	
	open C15;
	loop
	fetch C15 into	
		C15_w;
	EXIT WHEN NOT FOUND; /* apply on C15 */
		begin
		insert into tiss_interv_terapeutica_10(
			nr_sequencia, 
			dt_atualizacao, 
			nm_usuario, 
			dt_atualizacao_nrec, 
			nm_usuario_nrec, 
			dt_avaliacao, 
			nr_atendimento, 
			cd_profissional, 
			ie_situacao, 
			dt_liberacao, 
			dt_inativacao, 
			nm_usuario_inativacao, 
			ds_justificativa, 
			ie_ventilacao, 
			ie_catecolaminas, 
			ie_fluidos, 
			ie_cateter, 
			ie_pulmonar_cateter, 
			ie_dialise, 
			ie_pressao_intr, 
			ie_tratamento, 
			ie_especial_int, 
			ie_acao, 
			ie_nivel_atencao, 
			qt_pontuacao 		) 
	   values ( 
			nextval('tiss_interv_terapeutica_10_seq'), 
			clock_timestamp(), 
			nm_usuario_p, 
			clock_timestamp(), 
			nm_usuario_p, 
			clock_timestamp(), 
			nr_atendimento_p, 
			cd_pessoa_fisica_p, 
			'A', 
			null, 
			null, 
			null,
			null, 
			C15_w.ie_ventilacao, 
			C15_w.ie_catecolaminas, 
			C15_w.ie_fluidos, 
			C15_w.ie_cateter, 
			C15_w.ie_pulmonar_cateter, 
			C15_w.ie_dialise, 
			C15_w.ie_pressao_intr, 
			C15_w.ie_tratamento, 
			C15_w.ie_especial_int, 
			C15_w.ie_acao, 
			C15_w.ie_nivel_atencao, 
			C15_w.qt_pontuacao
	   );
		end;
	end loop;
	close C15;
elsif (upper(nm_tabela_p)	= 'ESCALA_TISSA')	then
	
	open C16;
	loop
	fetch C16 into	
		C16_w;
	EXIT WHEN NOT FOUND; /* apply on C16 */
		begin
        select nextval('escala_tissa_seq')
        into STRICT nr_seq_escala_tissa_w
;
		insert into escala_tissa(
			nr_sequencia,                  	
			dt_atualizacao,                
			nm_usuario,                    
			dt_atualizacao_nrec,           
			nm_usuario_nrec,               
			nr_atendimento,                
			dt_avaliacao,                  
			cd_profissional,               
			ie_situacao,                   
			dt_liberacao,                  
			dt_inativacao,                 
			nm_usuario_inativacao,         
			ie_monit_padrao,               
			ie_laboratorio,                
			ie_medicacao,                  
			ie_mudanca_curativo,           
			ie_manut_drenagem,             
			ie_modo_respiracao,            
			ie_acesso_via_respiratoria,    
			ie_cuid_estomia_tubular,       
			ie_terapia_respiratoria,       
			ie_evasao_droga,               
			ie_reposicao_fluido,           
			ie_cateter_arterial,           
			ie_dinamica_monitor,           
			ie_cateter_ven_central,        
			ie_rean_cardio_pulmo,          
			ie_terapia_repo_renal,         
			ie_balanco_urina,              
			ie_diurese,                    
			ie_pressao_intracraniana,      
			ie_metabolico,                 
			ie_enteral,                    
			ie_parenteral,                 
			ie_intervencao,                
			ie_terapia_ibs,                
			ie_assistir_cardiaco,          
			ie_assistir_pulmonar,          
			ie_terapia_hipotermica,        
			ie_sup_figado_extra_corpo,     
			ie_anticonvulsivante     ) 
	   values ( 
			nr_seq_escala_tissa_w, 
			clock_timestamp(), 
			nm_usuario_p,                    
			clock_timestamp(),           
			nm_usuario_p,               
			nr_atendimento_p,                
			clock_timestamp(),                  
		    cd_pessoa_fisica_p,               
			'A',                 
			null,                  
			null,                 
			null,         
			'N',               
			'N',                
			C16_w.ie_medicacao,                  
			C16_w.ie_mudanca_curativo,           
			C16_w.ie_manut_drenagem,             
			C16_w.ie_modo_respiracao,            
			C16_w.ie_acesso_via_respiratoria,    
			C16_w.ie_cuid_estomia_tubular,       
			C16_w.ie_terapia_respiratoria,       
			C16_w.ie_evasao_droga,               
			C16_w.ie_reposicao_fluido,           
			C16_w.ie_cateter_arterial,           
			C16_w.ie_dinamica_monitor,           
			C16_w.ie_cateter_ven_central,        
			C16_w.ie_rean_cardio_pulmo,          
			C16_w.ie_terapia_repo_renal,         
			C16_w.ie_balanco_urina,              
			C16_w.ie_diurese,                    
			C16_w.ie_pressao_intracraniana,      
			C16_w.ie_metabolico,                 
			C16_w.ie_enteral,                    
			C16_w.ie_parenteral,                 
			C16_w.ie_intervencao,                
			C16_w.ie_terapia_ibs,                
			C16_w.ie_assistir_cardiaco,          
			C16_w.ie_assistir_pulmonar,          
			C16_w.ie_terapia_hipotermica,        
			C16_w.ie_sup_figado_extra_corpo,     
			C16_w.ie_anticonvulsivante
	   );
		end;
	end loop;
	close C16;

end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE duplicar_escala ( nr_sequencia_p bigint, cd_pessoa_fisica_p text, nm_tabela_p text, nm_usuario_p text, nr_atendimento_p bigint) FROM PUBLIC;

