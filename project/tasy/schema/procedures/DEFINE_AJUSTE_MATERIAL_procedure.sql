-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE define_ajuste_material ( cd_estabelecimento_p bigint, cd_material_p bigint, dt_parametro_p timestamp, cd_convenio_p bigint, cd_categoria_p text, tx_ajuste_p INOUT bigint) AS $body$
DECLARE

tx_ajuste_w			double precision	:= 0;
vl_negociado_w			double precision	:= 0;
ie_preco_informado_w   		varchar(1)		:= '';
ie_glosa_w   			varchar(1)		:= '';
tx_brasindice_pfb_w		REGRA_AJUSTE_MATERIAL.TX_BRASINDICE_PFB%type    := 0; --number(15,4)	:= 0;
tx_brasindice_pmc_w		CONVENIO_BRASINDICE.TX_BRASINDICE_PMC%type      := 0;--number(15,4)	:= 0;
tx_pmc_neg_w			CONVENIO_BRASINDICE.TX_PMC_NEG%type             := 0;--number(15,4)	:= 0;
tx_pmc_pos_w			CONVENIO_BRASINDICE.TX_PMC_POS%type             := 0;--number(15,4)	:= 0;
tx_afaturar_w			double precision	:= 0;
cd_tipo_acomodacao_w          	smallint;
ie_tipo_atendimento_w         		smallint;
cd_setor_atendimento_w        		integer;
tx_simpro_pfb_w			double precision;
tx_simpro_pmc_w			double precision;
ie_origem_preco_w			varchar(05);
ie_precedencia_w			varchar(01);
pr_glosa_w			double precision;
vl_glosa_w			double precision;
cd_tabela_preco_w			bigint;
cd_motivo_exc_conta_w		bigint;
nr_seq_regra_w			bigint;
ie_autor_particular_w		varchar(1);
cd_convenio_glosa_ww		integer:= 0;
cd_categoria_glosa_ww		varchar(10):= ' ';

tx_pfb_neg_w			CONVENIO_BRASINDICE.TX_PFB_NEG%type     := 0;--number(15,4)	:= 0;
tx_pfb_pos_w			CONVENIO_BRASINDICE.TX_PFB_POS%type     := 0;--number(15,4)	:= 0;
vl_neutro_w				varchar(10);
tx_simpro_pos_pfb_w		double precision;
tx_simpro_neg_pfb_w		double precision;
tx_simpro_pos_pmc_w		double precision;
tx_simpro_neg_pmc_w		double precision;



BEGIN
cd_tipo_acomodacao_w         := null;
ie_tipo_atendimento_w         	:= null;
cd_setor_atendimento_w        := null;

SELECT * FROM obter_regra_ajuste_mat(	cd_estabelecimento_p, 	--cd_estabelecimento_p
				cd_convenio_p,           --cd_convenio_p
				cd_categoria_p,          --cd_categoria_p
				cd_material_p,           --cd_material_p
				dt_parametro_p,          --dt_vigencia_p
				cd_tipo_acomodacao_w,    --cd_tipo_acomodacao_p
				ie_tipo_atendimento_w,   --ie_tipo_atendimento_p
				cd_setor_atendimento_w,  --cd_setor_atendimento_p
				0,                       --qt_idade_p
				0,                       --nr_sequencia_p
				null,                    --cd_plano_p
				null,                    --cd_proc_referencia_p
				null,                    --ie_origem_proced_p
				null,                    --nr_seq_proc_interno_p
				null,                    --dt_entrada_p
				tx_ajuste_w,             --OUT tx_ajuste_p
				vl_negociado_w,          --OUT vl_negociado_p
				ie_preco_informado_w,    --OUT ie_preco_informado_p
				ie_glosa_w,              --OUT ie_glosa_p
				tx_brasindice_pfb_w,     --OUT tx_brasindice_pfb_p
				tx_brasindice_pmc_w,     --OUT tx_brasindice_pmc_p
				tx_pmc_neg_w,            --OUT tx_pmc_neg_p
				tx_pmc_pos_w,            --OUT tx_pmc_pos_p
				tx_afaturar_w,           --OUT tx_afaturar_p
				tx_simpro_pfb_w,         --OUT tx_simpro_pfb_p
				tx_simpro_pmc_w,         --OUT tx_simpro_pmc_p
				ie_origem_preco_w,       --OUT ie_origem_preco_p
				ie_precedencia_w,        --OUT ie_precedencia_p
				pr_glosa_w,              --OUT pr_glosa_p
				vl_glosa_w,              --OUT vl_glosa_p
				cd_tabela_preco_w,       --OUT cd_tabela_preco_p
				cd_motivo_exc_conta_w,   --OUT cd_motivo_exc_conta_p
				nr_seq_regra_w,          --OUT nr_seq_regra_p
				ie_autor_particular_w,   --OUT ie_autor_particular_p
				cd_convenio_glosa_ww,    --OUT cd_convenio_glosa_p
				cd_categoria_glosa_ww,   --OUT cd_categoria_glosa_p
				null,                    --ie_atend_retorno_p
				tx_pfb_neg_w,            --OUT tx_pfb_neg_p 
				tx_pfb_pos_w,            --OUT tx_pfb_pos_p
				vl_neutro_w,             --OUT ie_ignora_preco_venda_p
				tx_simpro_pos_pfb_w,     --OUT tx_simpro_pos_pfb_p
				tx_simpro_neg_pfb_w,     --OUT tx_simpro_neg_pfb_p
				tx_simpro_pos_pmc_w,     --OUT tx_simpro_pos_pmc_p
				tx_simpro_neg_pmc_w,     --OUT tx_simpro_neg_pmc_p
				null,                    --nr_seq_origem_p
				null,                    --nr_seq_cobertura_p
				0,                       --qt_dias_internacao_p
				null,                    --nr_seq_regra_lanc_p
				null,                    --nr_seq_lib_dieta_conv_p
				null,                    --ie_clinica_p
				null,                    --cd_usuario_convenio_p
				null) INTO STRICT 
				tx_ajuste_w, 
				vl_negociado_w, 
				ie_preco_informado_w, 
				ie_glosa_w, 
				tx_brasindice_pfb_w, 
				tx_brasindice_pmc_w, 
				tx_pmc_neg_w, 
				tx_pmc_pos_w, 
				tx_afaturar_w, 
				tx_simpro_pfb_w, 
				tx_simpro_pmc_w, 
				ie_origem_preco_w, 
				ie_precedencia_w, 
				pr_glosa_w, 
				vl_glosa_w, 
				cd_tabela_preco_w, 
				cd_motivo_exc_conta_w, 
				nr_seq_regra_w, 
				ie_autor_particular_w, 
				cd_convenio_glosa_ww, 
				cd_categoria_glosa_ww, 
				tx_pfb_neg_w, 
				tx_pfb_pos_w, 
				vl_neutro_w, 
				tx_simpro_pos_pfb_w, 
				tx_simpro_neg_pfb_w, 
				tx_simpro_pos_pmc_w, 
				tx_simpro_neg_pmc_w;                  --nr_seq_classif_atend_p
tx_ajuste_p := tx_ajuste_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE define_ajuste_material ( cd_estabelecimento_p bigint, cd_material_p bigint, dt_parametro_p timestamp, cd_convenio_p bigint, cd_categoria_p text, tx_ajuste_p INOUT bigint) FROM PUBLIC;

