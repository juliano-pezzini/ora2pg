-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_reg_alter_fila ( nr_seq_fila_p bigint, nr_seq_evento_sistema_p bigint) AS $body$
DECLARE


intpd_reg_alter_fila_w	intpd_reg_alter_fila%rowtype;
ie_existe_w	varchar(1);


BEGIN
	begin
	select	'S'
	into STRICT	ie_existe_w
	from	intpd_eventos_sistema a,
		intpd_config_evento_tab b		
	where	a.nr_seq_projeto_xml = b.nr_seq_proj_xml	
	and	a.nr_sequencia = nr_seq_evento_sistema_p  LIMIT 1;	
	exception
	when others then
		ie_existe_w	:=	'N';
	end;
	
	if (ie_existe_w = 'S') then
		begin
		select	nextval('intpd_reg_alter_fila_seq')
		into STRICT	intpd_reg_alter_fila_w.nr_sequencia
		;
		
		begin
		select	sid,	
			serial#
		into STRICT	intpd_reg_alter_fila_w.sid,
			intpd_reg_alter_fila_w.serial
		from	v$session
		where	audsid = (SELECT userenv('sessionid') );		
		exception
		when others then
			intpd_reg_alter_fila_w.sid	:=	null;
			intpd_reg_alter_fila_w.serial	:=	null;
		end;
		
		intpd_reg_alter_fila_w.nr_seq_fila	:=	nr_seq_fila_p;
		
		insert into intpd_reg_alter_fila values (intpd_reg_alter_fila_w.*);
		end;
	end if;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_reg_alter_fila ( nr_seq_fila_p bigint, nr_seq_evento_sistema_p bigint) FROM PUBLIC;

