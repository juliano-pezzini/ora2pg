-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE prescr_proc_aftpost_abort_eup (nr_prescricao_p bigint, nr_seq_prescr_p bigint, nr_atendimento_p bigint, cd_convenio_p bigint, cd_procedimento_p bigint, ie_origem_proced_p bigint, dt_procedimento_p timestamp, qt_procedimento_p bigint, ie_tipo_atendimento_p bigint, cd_plano_p text, cd_setor_atendimento_p bigint, nr_seq_exame_p bigint, nr_seq_proc_interno_p bigint, cd_categoria_p text, cd_setor_entrega_prescr_p bigint, cd_medico_p text, nr_sequencia_p bigint, nr_acao_executada_p bigint, nr_prescr_medica_p bigint, nm_usuario_p text, cd_funcao_p bigint, cd_perfil_p bigint, cd_estabelecimento_p bigint, nr_seq_prescricao_p bigint, entra_if_2_p text, ds_msg_erro_p INOUT bigint, ds_msg_aviso_p INOUT text, ie_chamar_funcao_p INOUT text, ie_necis_medico_p INOUT text, ds_texto_p INOUT text, nr_seq_avaliacao_p INOUT bigint) AS $body$
BEGIN
 
SELECT * FROM consistir_proc_conv_eup_js(nr_prescricao_p, nr_seq_prescr_p, nr_atendimento_p, cd_convenio_p, cd_procedimento_p, ie_origem_proced_p, dt_procedimento_p, qt_procedimento_p, ie_tipo_atendimento_p, cd_plano_p, cd_setor_atendimento_p, nr_seq_exame_p, nr_seq_proc_interno_p, cd_categoria_p, cd_setor_entrega_prescr_p, cd_medico_p, nr_sequencia_p, nr_acao_executada_p, nr_prescr_medica_p, nm_usuario_p, cd_funcao_p, cd_perfil_p, cd_estabelecimento_p, ds_msg_aviso_p, ie_chamar_funcao_p, nr_seq_avaliacao_p) INTO STRICT ds_msg_aviso_p, ie_chamar_funcao_p, nr_seq_avaliacao_p;
	 
ds_msg_erro_p := Consistir_Prescr_Procedimento(nr_prescricao_p, nr_seq_prescricao_p, nm_usuario_p, cd_perfil_p, ds_msg_erro_p);
 
if (entra_if_2_p = 'S') then 
	begin 
		select 	coalesce(ie_necessita_medic_uso,'N'), 
				obter_texto_tasy(80399, 1) 
		into STRICT	ie_necis_medico_p, 
				ds_texto_p 
		from  	exame_laboratorio 
		where 	nr_seq_exame = nr_seq_exame_p;
	end;
end if;
 
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE prescr_proc_aftpost_abort_eup (nr_prescricao_p bigint, nr_seq_prescr_p bigint, nr_atendimento_p bigint, cd_convenio_p bigint, cd_procedimento_p bigint, ie_origem_proced_p bigint, dt_procedimento_p timestamp, qt_procedimento_p bigint, ie_tipo_atendimento_p bigint, cd_plano_p text, cd_setor_atendimento_p bigint, nr_seq_exame_p bigint, nr_seq_proc_interno_p bigint, cd_categoria_p text, cd_setor_entrega_prescr_p bigint, cd_medico_p text, nr_sequencia_p bigint, nr_acao_executada_p bigint, nr_prescr_medica_p bigint, nm_usuario_p text, cd_funcao_p bigint, cd_perfil_p bigint, cd_estabelecimento_p bigint, nr_seq_prescricao_p bigint, entra_if_2_p text, ds_msg_erro_p INOUT bigint, ds_msg_aviso_p INOUT text, ie_chamar_funcao_p INOUT text, ie_necis_medico_p INOUT text, ds_texto_p INOUT text, nr_seq_avaliacao_p INOUT bigint) FROM PUBLIC;

