-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE atual_juros_tit_bordero_pagar (nr_sequencia_p bigint, nr_titulo_p bigint, ie_opcao_p text, ie_considera_saldo_p text) AS $body$
DECLARE


/* ie_opcao_p
A	Forma antiga do border√¥
N	Forma nova do bordero.
*/
vl_juros_w	double precision := 0;
vl_multa_w	double precision := 0;


BEGIN

SELECT * FROM calcular_juro_multa_titulo( nr_titulo_p, null, clock_timestamp(), ie_considera_saldo_p, 'N', vl_juros_w, vl_multa_w) INTO STRICT vl_juros_w, vl_multa_w;

if (ie_opcao_p = 'A') then

	update 	titulo_pagar
	set	vl_juros_bordero 	= vl_juros_w,
		vl_multa_bordero 	= vl_multa_w
	where 	nr_titulo 		= nr_titulo_p;

elsif (ie_opcao_p = 'N') then

	update 	bordero_tit_pagar
	set	vl_juros_bordero 	= vl_juros_w,
		vl_multa_bordero 	= vl_multa_w
	where 	nr_sequencia 		= nr_sequencia_p;

end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE atual_juros_tit_bordero_pagar (nr_sequencia_p bigint, nr_titulo_p bigint, ie_opcao_p text, ie_considera_saldo_p text) FROM PUBLIC;

