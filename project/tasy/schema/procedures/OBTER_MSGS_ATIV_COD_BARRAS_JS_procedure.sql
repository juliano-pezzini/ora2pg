-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_msgs_ativ_cod_barras_js ( nr_cirurgia_p bigint, nr_prescricao_p bigint, nr_seq_pepo_p bigint, ie_chama_fanep_p text, ds_mensagem_1_p INOUT text, ds_mensagem_2_p INOUT text, ds_mensagem_3_p INOUT text, ds_mensagem_4_p INOUT text, ds_mensagem_5_p INOUT text, ds_mensagem_6_p INOUT text, ds_mensagem_7_p INOUT text) AS $body$
DECLARE

 
ds_mensagem_1_w			varchar(255);
ds_mensagem_2_w			varchar(255);
ds_mensagem_3_w			varchar(255);
ds_mensagem_4_w			varchar(255);
ds_mensagem_5_w			varchar(255);
ds_mensagem_6_w			varchar(255);
ds_mensagem_7_w			varchar(255);

 

BEGIN 
 
if (ie_chama_fanep_p = 'N')	then 
	select	max(substr(obter_nome_pf(cd_pessoa_fisica) ||' / ' || obter_desc_expressao(283863) || ': '|| nr_atendimento ||' / ' || obter_desc_expressao(296208) || ': ' || nr_prescricao, 1, 255)) 
	into STRICT	ds_mensagem_1_w 
	from	cirurgia		 
	where	nr_cirurgia		= nr_cirurgia_p;
else 
	select	max(substr(obter_nome_pf(cd_pessoa_fisica) ||' / ' || obter_desc_expressao(283863) || ': '|| nr_atendimento ||' / ' || obter_desc_expressao(296208) || ': ' || nr_prescricao, 1, 255)) 
	into STRICT	ds_mensagem_1_w 
	from	pepo_cirurgia		 
	where  nr_sequencia		= nr_seq_pepo_p;
end if;
 
select	max(substr(obter_nome_pf(cd_pessoa_fisica) ||' / ' || obter_desc_expressao(283863) || ': ' || nr_atendimento ||' / ' || obter_desc_expressao(296208) || ': ' || nr_prescricao, 1, 255)), 
	max(substr(obter_desc_expressao(285912) || ' - ' || obter_nome_pf(cd_pessoa_fisica), 1, 255)), --Consistir 
	max(substr(obter_desc_expressao(763758) || ' - ' || obter_nome_pf(cd_pessoa_fisica), 1, 255)), --Consistir Especiais 
	max(substr(obter_desc_expressao(328716) || ' - ' || obter_nome_pf(cd_pessoa_fisica), 1, 255)), --Adicionar 
	max(substr(obter_desc_expressao(763760) || ' - ' || obter_nome_pf(cd_pessoa_fisica), 1, 255)), --Consistir kit 
	max(substr(obter_desc_expressao(287647) || ' - ' || obter_nome_pf(cd_pessoa_fisica), 1, 255)) --Devolução 
into STRICT	ds_mensagem_2_w, 
	ds_mensagem_3_w, 
	ds_mensagem_4_w, 
	ds_mensagem_5_w, 
	ds_mensagem_6_w, 
	ds_mensagem_7_w 
from	prescr_medica 
where	nr_prescricao 	= nr_prescricao_p;
 
 
ds_mensagem_1_p		:= ds_mensagem_1_w;
ds_mensagem_2_p		:= ds_mensagem_2_w;
ds_mensagem_3_p		:= ds_mensagem_3_w;
ds_mensagem_4_p		:= ds_mensagem_4_w;
ds_mensagem_5_p		:= ds_mensagem_5_w;
ds_mensagem_6_p		:= ds_mensagem_6_w;
ds_mensagem_7_p		:= ds_mensagem_7_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_msgs_ativ_cod_barras_js ( nr_cirurgia_p bigint, nr_prescricao_p bigint, nr_seq_pepo_p bigint, ie_chama_fanep_p text, ds_mensagem_1_p INOUT text, ds_mensagem_2_p INOUT text, ds_mensagem_3_p INOUT text, ds_mensagem_4_p INOUT text, ds_mensagem_5_p INOUT text, ds_mensagem_6_p INOUT text, ds_mensagem_7_p INOUT text) FROM PUBLIC;

