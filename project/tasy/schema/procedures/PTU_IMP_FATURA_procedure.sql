-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE ptu_imp_fatura ( ds_conteudo_p text, ie_tipo_arquivo_p bigint, cd_estabelecimento_p bigint, nr_linha_p bigint, nm_usuario_p text, ie_versao_p INOUT text, nr_seq_fatura_p INOUT bigint, nr_seq_fat_imp_p INOUT ptu_fatura.nr_sequencia%type) AS $body$
DECLARE


/*++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Finalidade:		IMPORTAÇÃO DO ARQUIVO A500 - UTILIZADO NO DELPHI
-------------------------------------------------------------------------------------------------------------------

Locais de chamada direta: 
[ X]  Objetos do dicionário [X] Tasy (Delphi/Java) [  ] Portal [  ]  Relatórios [ ] Outros:
 ------------------------------------------------------------------------------------------------------------------

Pontos de atenção:	Transação - Versão PTU

F 15 - 3.7		F 16 - 3.8		F 17 - 4.0		F 18 - 4.1	
F 19 - 4.1a		F 19 - 4.1b		F 20 - 5.0		F 21 - 5.0a		
F 22 - 6.0		F 23 - 6.1		F24 - 6.3		F 25 - 7.0
F 26 - 8.0		F 27 - 9.0		F28 - 9.0		F29 - 10.0
F30 - 10.0a
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/ 
				

BEGIN
-- REMOVER NO FUTURO
CALL pls_aliment_dt_ref_cam_cong();

-- OBTER A VERSÃO DE TRANSAÇÃO
if (coalesce(ie_versao_p::text, '') = '') then
	select	substr(ds_conteudo_p,115,2)
	into STRICT	ie_versao_p
	;
end if;

-- VERSÃO PTU 4.1B (INFERIOR)
if (ie_versao_p in ('15','16','17','18','19')) then
	ptu_imp_fatura_v41b( ds_conteudo_p, ie_tipo_arquivo_p, cd_estabelecimento_p, nr_linha_p, nm_usuario_p, nr_seq_fatura_p);

-- VERSÃO PTU 5.0
elsif (ie_versao_p in ('20','21')) then
	ptu_imp_fatura_v50( ds_conteudo_p, ie_tipo_arquivo_p, cd_estabelecimento_p, nr_linha_p, nm_usuario_p, nr_seq_fatura_p);

-- VERSÃO PTU 6.0
elsif (ie_versao_p in ('22')) then
	ptu_imp_fatura_v60( ds_conteudo_p, ie_tipo_arquivo_p, cd_estabelecimento_p, nr_linha_p, nm_usuario_p, nr_seq_fatura_p);

-- VERSÃO PTU 6.1
elsif (ie_versao_p in ('23')) then
	ptu_imp_fatura_v61( ds_conteudo_p, ie_tipo_arquivo_p, cd_estabelecimento_p, nr_linha_p, nm_usuario_p, nr_seq_fatura_p);
	
-- VERSÃO PTU 6.3
elsif (ie_versao_p in ('24')) then
	ptu_imp_fatura_v63( ds_conteudo_p, ie_tipo_arquivo_p, cd_estabelecimento_p, nr_linha_p, nm_usuario_p, nr_seq_fatura_p);

-- VERSÃO PTU 7.0
elsif (ie_versao_p in ('25')) then
	ptu_imp_fatura_v70( ds_conteudo_p, ie_tipo_arquivo_p, cd_estabelecimento_p, nr_linha_p, nm_usuario_p, nr_seq_fatura_p);
	
-- VERSÃO PTU 8.0
elsif (ie_versao_p in ('26')) then
	ptu_imp_fatura_v80( ds_conteudo_p, ie_tipo_arquivo_p, cd_estabelecimento_p, nr_linha_p, nm_usuario_p, nr_seq_fatura_p, nr_seq_fat_imp_p);

-- VERSÃO PTU 9.0
elsif (ie_versao_p in ('27')) then
	ptu_imp_fatura_v90( ds_conteudo_p, ie_tipo_arquivo_p, cd_estabelecimento_p, nr_linha_p, nm_usuario_p, nr_seq_fatura_p, nr_seq_fat_imp_p);
	
-- VERSÃO PTU 9.1
elsif (ie_versao_p in ('28')) then
	ptu_imp_fatura_v91( ds_conteudo_p, ie_tipo_arquivo_p, cd_estabelecimento_p, nr_linha_p, nm_usuario_p, nr_seq_fatura_p, nr_seq_fat_imp_p);
	
-- VERSÃO PTU 10.0
elsif (ie_versao_p in ('29')) then
	ptu_imp_fatura_v100( ds_conteudo_p, ie_tipo_arquivo_p, cd_estabelecimento_p, nr_linha_p, nm_usuario_p, nr_seq_fatura_p, nr_seq_fat_imp_p);
	
-- VERSÃO PTU 10.0a
elsif (ie_versao_p in ('30')) then
	SELECT * FROM ptu_imp_fatura_v100a( ds_conteudo_p, ie_tipo_arquivo_p, cd_estabelecimento_p, nr_linha_p, nm_usuario_p, nr_seq_fatura_p, nr_seq_fat_imp_p) INTO STRICT nr_seq_fatura_p, nr_seq_fat_imp_p;
	
-- VERSÃO PTU 11.0
elsif (ie_versao_p in ('31')) then
	SELECT * FROM ptu_imp_fatura_v110( ds_conteudo_p, ie_tipo_arquivo_p, cd_estabelecimento_p, nr_linha_p, nm_usuario_p, nr_seq_fatura_p, nr_seq_fat_imp_p) INTO STRICT nr_seq_fatura_p, nr_seq_fat_imp_p;
	
-- VERSÃO PTU 11.0a e 11.3
elsif (ie_versao_p in ('32', '33')) then
	SELECT * FROM ptu_imp_fatura_v110a( ds_conteudo_p, ie_tipo_arquivo_p, cd_estabelecimento_p, nr_linha_p, nm_usuario_p, nr_seq_fatura_p, nr_seq_fat_imp_p) INTO STRICT nr_seq_fatura_p, nr_seq_fat_imp_p;
end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ptu_imp_fatura ( ds_conteudo_p text, ie_tipo_arquivo_p bigint, cd_estabelecimento_p bigint, nr_linha_p bigint, nm_usuario_p text, ie_versao_p INOUT text, nr_seq_fatura_p INOUT bigint, nr_seq_fat_imp_p INOUT ptu_fatura.nr_sequencia%type) FROM PUBLIC;

