-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE baca_ajusta_fksus_retorno () AS $body$
DECLARE


qt_registro_w	integer;
ds_comando_w	varchar(255);


BEGIN

/*Recriar FK SUSAICP_PROCONV_FK como CASCADE*/

select	count(*)
	into STRICT	qt_registro_w
	from	user_constraints
	where	constraint_name = 'SUSAICP_PROCONV_FK'
	and	delete_rule = 'NO ACTION';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'alter table sus_aih_controle_proc drop constraint

SUSAICP_PROCONV_FK');
		ds_comando_w := 'ALTER TABLE SUS_AIH_CONTROLE_PROC ADD ( CONSTRAINT SUSAICP_PROCONV_FK

FOREIGN KEY (' ||
				'NR_SEQ_PROTOCOLO) REFERENCES PROTOCOLO_CONVENIO (NR_SEQ_PROTOCOLO) ON

DELETE  CASCADE)';
		CALL Exec_sql_Dinamico('Felipe', ds_comando_w);
	end if;

/*Recriar FK SUSAIRE_PROCONV_FK como CASCADE*/

select	count(*)
	into STRICT	qt_registro_w
	from	user_constraints
	where	constraint_name = 'SUSAIRE_PROCONV_FK'
	and	delete_rule = 'NO ACTION';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'alter table sus_aih_rejeitada drop constraint

SUSAIRE_PROCONV_FK');
		ds_comando_w := 'ALTER TABLE SUS_AIH_REJEITADA ADD ( CONSTRAINT SUSAIRE_PROCONV_FK  FOREIGN

KEY (' ||
				'NR_SEQ_PROTOCOLO) REFERENCES PROTOCOLO_CONVENIO (NR_SEQ_PROTOCOLO) ON

DELETE  CASCADE)';
		CALL Exec_sql_Dinamico('Felipe', ds_comando_w);
	end if;

/*Recriar FK AIHPAGA_PROCONV_FK como CASCADE*/

select	count(*)
	into STRICT	qt_registro_w
	from	user_constraints
	where	constraint_name = 'AIHPAGA_PROCONV_FK'
	and	delete_rule = 'NO ACTION';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'alter table sus_aih_paga drop constraint AIHPAGA_PROCONV_FK');
		ds_comando_w := 'ALTER TABLE SUS_AIH_PAGA ADD ( CONSTRAINT AIHPAGA_PROCONV_FK  FOREIGN KEY

(' ||
				'NR_SEQ_PROTOCOLO) REFERENCES PROTOCOLO_CONVENIO (NR_SEQ_PROTOCOLO) ON

DELETE  CASCADE)';
		CALL Exec_sql_Dinamico('Felipe', ds_comando_w);
	end if;

/*Recriar FK SUSOPPG_PROCONV_FK como CASCADE*/

select	count(*)
	into STRICT	qt_registro_w
	from	user_constraints
	where	constraint_name = 'SUSOPPG_PROCONV_FK'
	and	delete_rule = 'NO ACTION';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'alter table sus_aih_opm_paga drop constraint

SUSOPPG_PROCONV_FK');
		ds_comando_w := 'ALTER TABLE SUS_AIH_OPM_PAGA ADD ( CONSTRAINT SUSOPPG_PROCONV_FK  FOREIGN

KEY (' ||
				'NR_SEQ_PROTOCOLO) REFERENCES PROTOCOLO_CONVENIO (NR_SEQ_PROTOCOLO) ON

DELETE  CASCADE)';
		CALL Exec_sql_Dinamico('Felipe', ds_comando_w);
	end if;

/*Recriar FK SUSD160_PROCONV_FK como CASCADE*/

select	count(*)
	into STRICT	qt_registro_w
	from	user_constraints
	where	constraint_name = 'SUSD160_PROCONV_FK'
	and	delete_rule = 'NO ACTION';
	if (qt_registro_w > 0) then
		CALL Exec_sql_Dinamico('Felipe', 'alter table sus_daih160 drop constraint SUSD160_PROCONV_FK');
		ds_comando_w := 'ALTER TABLE SUS_DAIH160 ADD ( CONSTRAINT SUSD160_PROCONV_FK  FOREIGN KEY

(' ||
				'NR_SEQ_PROTOCOLO) REFERENCES PROTOCOLO_CONVENIO (NR_SEQ_PROTOCOLO) ON

DELETE  CASCADE)';
		CALL Exec_sql_Dinamico('Felipe', ds_comando_w);
	end if;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE baca_ajusta_fksus_retorno () FROM PUBLIC;

