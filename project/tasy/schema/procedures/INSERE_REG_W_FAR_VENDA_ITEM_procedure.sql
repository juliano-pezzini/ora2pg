-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE insere_reg_w_far_venda_item ( cd_material_p bigint, pr_tributo_p bigint, qt_material_p bigint, vl_desconto_p bigint, vl_total_p bigint, vl_unitario_p bigint, nr_seq_lote_p bigint, ie_limpar_tabela_p text, nm_usuario_p text, ie_origem_proced_p bigint default null, cd_fornecedor_p text default null) AS $body$
BEGIN

if ('S' = upper(ie_limpar_tabela_p)) then
	delete from w_far_venda_item;
end if;


if (cd_material_p IS NOT NULL AND cd_material_p::text <> '') and (qt_material_p IS NOT NULL AND qt_material_p::text <> '') and (vl_desconto_p IS NOT NULL AND vl_desconto_p::text <> '') and (vl_total_p IS NOT NULL AND vl_total_p::text <> '') and (vl_unitario_p IS NOT NULL AND vl_unitario_p::text <> '') then

	insert into w_far_venda_item(
		cd_material,
		pr_tributo,
		qt_material,
		vl_desconto,
		vl_total,
		vl_unitario,
		nr_seq_lote,
		cd_procedimento,
		ie_origem_proced,
		cd_fornecedor)
	values (	CASE WHEN coalesce(ie_origem_proced_p,0)=0 THEN  cd_material_p  ELSE 0 END ,
		pr_tributo_p,
		qt_material_p,
		vl_desconto_p,
		vl_total_p,
		vl_unitario_p,
		nr_seq_lote_p,
		CASE WHEN coalesce(ie_origem_proced_p,0)=0 THEN  0  ELSE cd_material_p END ,
		ie_origem_proced_p,
		cd_fornecedor_p);
end if;
commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE insere_reg_w_far_venda_item ( cd_material_p bigint, pr_tributo_p bigint, qt_material_p bigint, vl_desconto_p bigint, vl_total_p bigint, vl_unitario_p bigint, nr_seq_lote_p bigint, ie_limpar_tabela_p text, nm_usuario_p text, ie_origem_proced_p bigint default null, cd_fornecedor_p text default null) FROM PUBLIC;

