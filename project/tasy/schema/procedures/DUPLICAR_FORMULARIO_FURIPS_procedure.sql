-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE duplicar_formulario_furips ( nr_sequence_p atend_formulario_furips.nr_sequencia%TYPE, ie_inativar_p text, ds_justificativa_p atend_formulario_furips.ds_justificativa%TYPE ) AS $body$
DECLARE


ds_justificativa_w atend_formulario_furips.ds_justificativa%TYPE;


BEGIN

insert into atend_formulario_furips(
    nr_sequencia,
    dt_atualizacao,
    nm_usuario,
    dt_atualizacao_nrec,
    nm_usuario_nrec,
    dt_registro,
    ie_resp_glosa,
    nr_registro,
    nr_registro_ant,
    nr_atendimento,
    nr_seq_tipo_acidente,
    ds_quadro_descritivo,
    ds_placa,
    nr_seq_tipo_servico,
    cd_seguradora,
    nr_apolice_seguro,
    ie_interv_autoridade,
    dt_inicio_vigencia,
    dt_fim_vigencia,
    ie_coleta_apolice,
    nm_propietario_veiculo,
    nm_sobrenome_prop_veic,
    nm_prim_apelido_prop,
    nm_seg_apelido_prop,
    nr_seq_tipo_doc_prop,
    nr_doc_proprietario,
    ds_endereco_prop,
    nr_telefone_prop,
    nm_condutor_veiculo,
    nm_sobrenome_cond,
    nm_prim_apelido_cond,
    nm_seg_apelido_cond,
    nr_seq_tipo_doc_cond,
    nr_doc_condutor,
    ds_endereco_cond,
    nr_telefone_cond,
    dt_remissao,
    nm_profissional_envio,
    cd_cargo_prof_envio,
    dt_aceitacao,
    nm_prestador_receb,
    nm_profissional_receb,
    cd_cargo_prof_receb,
    ds_placa_veiculo,
    ds_ponto_partida,
    ds_ponto_chegada,
    ds_justificativa_alteracao,
    ie_situacao,
    dt_liberacao,
    ds_justificativa,
    dt_inativacao,
    nm_usuario_inativacao,
    nr_seq_classif_acidente,
    ie_outro_acidente,
    ds_outro_acidente,
    ie_zona_acidente,
    nr_seq_situacao_veiculo,
    ds_veiculo,
    ie_tipo_referencia,
    ie_tipo_transporte,
    ie_zona,
    cd_cep_condutor,
    cd_cep_proprietario,
    ie_condicao_vitima,
    dt_evento,
    ds_estado_prop,
    ds_municipio_prop,
    ds_estado_cond,
    ds_municipio_cond,
    Cd_inscricao_envio,
    cd_inscricao_receb,
    ds_direcao,
    nm_prestador_envio,
    nr_seq_pessoa_endereco_cond,
    nr_seq_pessoa_endereco_prop,
	nr_ddd_tel_cond,
	nr_ddd_tel_prop,
	nr_ddi_tel_cond,
	nr_ddi_tel_prop)
SELECT nextval('atend_formulario_furips_seq'),
    clock_timestamp(),
    obter_usuario_ativo,
    dt_atualizacao_nrec,
    nm_usuario_nrec,
    dt_registro,
    ie_resp_glosa,
    nr_registro,
    nr_registro_ant,
    nr_atendimento,
    nr_seq_tipo_acidente,
    ds_quadro_descritivo,
    ds_placa,
    nr_seq_tipo_servico,
    cd_seguradora,
    nr_apolice_seguro,
    ie_interv_autoridade,
    dt_inicio_vigencia,
    dt_fim_vigencia,
    ie_coleta_apolice,
    nm_propietario_veiculo,
    nm_sobrenome_prop_veic,
    nm_prim_apelido_prop,
    nm_seg_apelido_prop,
    nr_seq_tipo_doc_prop,
    nr_doc_proprietario,
    ds_endereco_prop,
    nr_telefone_prop,
    nm_condutor_veiculo,
    nm_sobrenome_cond,
    nm_prim_apelido_cond,
    nm_seg_apelido_cond,
    nr_seq_tipo_doc_cond,
    nr_doc_condutor,
    ds_endereco_cond,
    nr_telefone_cond,
    dt_remissao,
    nm_profissional_envio,
    cd_cargo_prof_envio,
    dt_aceitacao,
    nm_prestador_receb,
    nm_profissional_receb,
    cd_cargo_prof_receb,
    ds_placa_veiculo,
    ds_ponto_partida,
    ds_ponto_chegada,
    ds_justificativa_p,
    'A',
    null,
    null,
    null,
    null,
    nr_seq_classif_acidente,
    ie_outro_acidente,
    ds_outro_acidente,
    ie_zona_acidente,
    nr_seq_situacao_veiculo,
    ds_veiculo,
    ie_tipo_referencia,
    ie_tipo_transporte,
    ie_zona,
    cd_cep_condutor,
    cd_cep_proprietario,
    ie_condicao_vitima,
    dt_evento,
    ds_estado_prop,
    ds_municipio_prop,
    ds_estado_cond,
    ds_municipio_cond,
    cd_inscricao_envio,
    cd_inscricao_receb,
    ds_direcao,
    nm_prestador_envio,
    nr_seq_pessoa_endereco_cond,
    nr_seq_pessoa_endereco_prop,
	nr_ddd_tel_cond,
	nr_ddd_tel_prop,
	nr_ddi_tel_cond,
	nr_ddi_tel_prop
from	atend_formulario_furips a
where	a.nr_sequencia	= nr_sequence_p;

IF (ie_inativar_p = 'S') THEN
	SELECT
		max(ds_justificativa)
	INTO STRICT
		ds_justificativa_w
	FROM
		atend_formulario_furips
	WHERE
		nr_sequencia = nr_sequence_p;

	CALL inativar_informacao('ATEND_FORMULARIO_FURIPS',
						'NR_SEQUENCIA',
						nr_sequence_p,
						coalesce(ds_justificativa_w, ds_justificativa_p),
						obter_usuario_ativo);
END IF;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE duplicar_formulario_furips ( nr_sequence_p atend_formulario_furips.nr_sequencia%TYPE, ie_inativar_p text, ds_justificativa_p atend_formulario_furips.ds_justificativa%TYPE ) FROM PUBLIC;

