-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE aprazar_item_ok_click ( ie_aprazar_interv_p text, cd_estabelecimento_p bigint, nr_atendimento_p bigint, cd_item_p text, cd_intervalo_p text, qt_item_p bigint, dt_horario_p timestamp, nr_prescricoes_p text, nr_prescricao_p bigint, nr_seq_item_p bigint, nr_seq_motivo_p bigint, ds_justificativa_p text, nm_usuario_p text, ie_acm_sn_p text, ie_inconsistencia_p INOUT text, ds_pergunta_pri_p INOUT text, ds_pergunta_sec_p INOUT text, ie_via_aplicacao_p text, ie_tipo_item_p text default 'M') AS $body$
DECLARE

 
ie_inconsistencia_w	varchar(1)	:= '';
ds_inconsistentes_w	varchar(255) 	:= '';	
					 

BEGIN 
 
if (nr_atendimento_p IS NOT NULL AND nr_atendimento_p::text <> '')and (nr_prescricao_p IS NOT NULL AND nr_prescricao_p::text <> '')then 
	begin 
	 
	SELECT * FROM aprazar_item_prescr(	ie_aprazar_interv_p, cd_estabelecimento_p, nr_atendimento_p, ie_tipo_item_p, 0, cd_item_p, cd_intervalo_p, qt_item_p, dt_horario_p, nr_prescricoes_p, nr_prescricao_p, nr_seq_item_p, 'N', nr_seq_motivo_p, ds_justificativa_p, nm_usuario_p, ie_inconsistencia_w, ds_inconsistentes_w, null, null, ie_acm_sn_p, null, null, 'N', null, null, null, null, '', null, ie_via_aplicacao_p) INTO STRICT ie_inconsistencia_w, ds_inconsistentes_w;
	 
	ds_pergunta_pri_p	:= obter_texto_tasy(29743, wheb_usuario_pck.get_nr_seq_idioma);
	ds_pergunta_sec_p	:= REPLACE(SUBSTR(obter_texto_tasy(29745, wheb_usuario_pck.get_nr_seq_idioma),1,255), '#@MENSAGEM#@', ds_inconsistentes_w);
	ie_inconsistencia_p 	:= ie_inconsistencia_w;
	 
	end;
end if;
					 
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE aprazar_item_ok_click ( ie_aprazar_interv_p text, cd_estabelecimento_p bigint, nr_atendimento_p bigint, cd_item_p text, cd_intervalo_p text, qt_item_p bigint, dt_horario_p timestamp, nr_prescricoes_p text, nr_prescricao_p bigint, nr_seq_item_p bigint, nr_seq_motivo_p bigint, ds_justificativa_p text, nm_usuario_p text, ie_acm_sn_p text, ie_inconsistencia_p INOUT text, ds_pergunta_pri_p INOUT text, ds_pergunta_sec_p INOUT text, ie_via_aplicacao_p text, ie_tipo_item_p text default 'M') FROM PUBLIC;

