-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_w_suites ( dt_referencia_p timestamp) AS $body$
DECLARE

 
			 
		 
cd_setor_desejado_w		integer;
cd_unidade_basica_w		varchar(20);
cd_unidade_compl_w		varchar(20);
dt_entrada_w			timestamp;
dt_saida_w			timestamp;
nr_sequencia_w			bigint;
dt_entrada_ant_w			timestamp	:=	clock_timestamp();
dt_saida_ant_w			timestamp :=	clock_timestamp();
qt_dia_w				bigint;
i				integer;
ds_cor_w				varchar(20);
nr_seq_suite_w			bigint;

qt_existe_registro_suite_w		bigint;
cd_setor_desejado_ant_w		integer;
cd_unidade_basica_ant_w		varchar(20);
cd_unidade_compl_ant_w		varchar(20);
dt_refer_w			timestamp;

 
 
DIA1_w          varchar(20);
DIA2_w          varchar(20);
DIA3_w          varchar(20);
DIA4_w          varchar(20);
DIA5_w          varchar(20);
DIA6_w          varchar(20);
DIA7_w          varchar(20);
DIA8_w          varchar(20);
DIA9_w          varchar(20);
DIA10_w          varchar(20);
DIA11_w          varchar(20);
DIA12_w          varchar(20);
DIA13_w          varchar(20);
DIA14_w          varchar(20);
DIA15_w          varchar(20);
DIA16_w          varchar(20);
DIA17_w          varchar(20);
DIA18_w          varchar(20);
DIA19_w          varchar(20);
DIA20_w          varchar(20);
DIA21_w          varchar(20);
DIA22_w          varchar(20);
DIA23_w          varchar(20);
DIA24_w          varchar(20);
DIA25_w          varchar(20);
DIA26_w          varchar(20);
DIA27_w          varchar(20);
DIA28_w          varchar(20);
DIA29_w          varchar(20);
DIA30_w          varchar(20);
DIA31_w          varchar(20);

ds_cor_ant_w		varchar(20);
dt_referencia_w		timestamp;
c01 CURSOR FOR
SELECT	cd_setor_desejado, 
	cd_unidade_basica, 
	cd_unidade_compl, 
	PKG_DATE_UTILS.start_of(dt_prevista,'dd',0) dt_entrada, 
	PKG_DATE_UTILS.start_of(dt_prevista,'dd',0) + qt_dia dt_saida, 
	qt_dia 
from 	gestao_vaga 
where (dt_prevista between PKG_DATE_UTILS.start_of(dt_referencia_p,'month',0) and PKG_DATE_UTILS.END_OF(dt_referencia_p, 'MONTH', 0)) 
and	(cd_unidade_basica IS NOT NULL AND cd_unidade_basica::text <> '') 
and	ie_status = 'R' 
and	obter_se_controla_leitos(cd_setor_desejado,cd_unidade_basica,cd_unidade_compl) = 'S' 
and	cd_estabelecimento	=	wheb_usuario_pck.get_cd_estabelecimento 

union
 
SELECT	cd_setor_desejado, 
	cd_unidade_basica, 
	cd_unidade_compl, 
	PKG_DATE_UTILS.start_of(dt_referencia_p,'month',0) dt_entrada, 
	PKG_DATE_UTILS.start_of(dt_referencia_p,'dd') + (qt_dia - abs(PKG_DATE_UTILS.start_of(dt_prevista,'dd') - PKG_DATE_UTILS.add_month(PKG_DATE_UTILS.start_of(PKG_DATE_UTILS.end_of(dt_referencia_p,'MONTH'), 'DD'), - 1)) - 1) dt_saida, 
	(qt_dia - abs(trunc(dt_prevista,'dd') - pkg_date_utils.add_month(last_day(trunc(dt_referencia_p,'dd')), - 1, 0)) - 1) qt_dia 
from 	gestao_vaga 
where 	((PKG_DATE_UTILS.ADD_MONTH(dt_prevista + qt_dia - PKG_DATE_UTILS.extract_field('DAY', PKG_DATE_UTILS.END_OF(dt_referencia_p, 'MONTH', 0)),1,0) between PKG_DATE_UTILS.start_of(dt_referencia_p,'month',0) and PKG_DATE_UTILS.END_OF(PKG_DATE_UTILS.ADD_MONTH(dt_referencia_p,12,0), 'MONTH', 0)) and 
	((trunc(dt_prevista,'mm') <> trunc(dt_referencia_p,'mm')) and (trunc(dt_referencia_p,'dd') + (qt_dia - abs(trunc(dt_prevista,'dd') - pkg_date_utils.add_month(last_day(trunc(dt_referencia_p,'dd')), - 1, 0)) - 1) > trunc(dt_referencia_p,'mm')))) 
AND	(cd_unidade_basica IS NOT NULL AND cd_unidade_basica::text <> '') 
and	dt_prevista < PKG_DATE_UTILS.start_of(dt_referencia_p,'month',0) 
and	ie_status = 'R' 
and	obter_se_controla_leitos(cd_setor_desejado,cd_unidade_basica,cd_unidade_compl) = 'S' 
and	cd_estabelecimento	=	wheb_usuario_pck.get_cd_estabelecimento 
order by cd_setor_desejado, cd_unidade_basica, dt_entrada;
			

BEGIN 
 
delete FROM w_suites;
 
 
open C01;
loop 
fetch C01 into	 
	cd_setor_desejado_w, 
	cd_unidade_basica_w, 
	cd_unidade_compl_w, 
	dt_entrada_w, 
	dt_saida_w, 
	qt_dia_w;
EXIT WHEN NOT FOUND; /* apply on C01 */
	begin 
	select	coalesce(max(nr_sequencia),0) +1 
	into STRICT	nr_sequencia_w 
	from 	w_suites;
	 
	select PKG_DATE_UTILS.start_of(dt_entrada_w,'month',0) 
	into STRICT	dt_referencia_w 
	;
	 
	ds_cor_w := 'clLime';
	 
	if (ds_cor_ant_w = 'clLime') then 
		ds_cor_w	:=	'clBlue';
	elsif (ds_cor_ant_w = 'clBlue') then 
		ds_cor_w	:= 	'clLime';
	else 
		ds_cor_w	:= 'clLime';
	end if;
	 
	 
	 
	if (cd_setor_desejado_w 	<> cd_setor_desejado_ant_w) or (cd_unidade_basica_w	<> cd_unidade_basica_ant_w) or (cd_unidade_compl_w	<> cd_unidade_compl_ant_w) 	then 
		begin 
		dia1_w  := '';
		dia2_w  := '';
		dia3_w  := '';
		dia4_w  := '';
		dia5_w  := '';
		dia6_w  := '';
		dia7_w  := '';
		dia8_w  := '';
		dia9_w  := '';
		dia10_w  := '';
		dia11_w  := '';
		dia12_w  := '';
		dia13_w  := '';
		dia14_w  := '';
		dia15_w  := '';
		dia16_w  := '';
		dia17_w  := '';
		dia18_w  := '';
		dia19_w  := '';
		dia20_w  := '';
		dia21_w  := '';
		dia22_w  := '';
		dia23_w  := '';
		dia24_w  := '';
		dia25_w  := '';
		dia26_w  := '';
		dia27_w  := '';
		dia28_w  := '';
		dia29_w  := '';
		dia30_w  := '';
		dia31_w  := '';		
		end;
	end if;
 
		dt_refer_w	:=	dt_entrada_w;
	if (qt_dia_w > 0) then 
		begin 
		i	:=	0;
		while qt_dia_w >= 0 loop 
		begin		 
	 
		if (PKG_DATE_UTILS.start_of(dt_referencia_w,'month',0) = PKG_DATE_UTILS.start_of(dt_refer_w,'month',0)) then 
			begin		 
			if	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '01') then 
				dia1_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '02') then	 
				dia2_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '03') then 
				dia3_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '04') then 
				dia4_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '05') then 
				dia5_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '06') then 
				dia6_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '07') then 
				dia7_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '08') then 
				dia8_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '09') then 
				dia9_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '10') then 
				dia10_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '11') then 
				dia11_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '12') then 
				dia12_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '13') then	 
				dia13_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '14') then				 
				dia14_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '15') then 
				dia15_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '16') then 
				dia16_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '17') then 
				dia17_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '18') then 
				dia18_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '19') then 
				dia19_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '20') then 
				dia20_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '21') then 
				dia21_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '22') then 
				dia22_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '23') then 
				dia23_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '24') then 
				dia24_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '25') then 
				dia25_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '26') then	 
				dia26_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '27') then 
				dia27_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '28') then 
				dia28_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '29') then 
				dia29_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '30') then 
				dia30_w	:=	ds_cor_w;
			elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0) + i,1,2)) = '31') then 
				dia31_w	:=	ds_cor_w;
			end if;
		 
			select	count(*) 
			into STRICT	qt_existe_registro_suite_w 
			from	w_suites 
			where	cd_setor_atendimento = cd_setor_desejado_w 
			and	cd_unidade_basica = cd_unidade_basica_w 
			and	cd_unidade_compl = cd_unidade_compl_w;
					 
			if (qt_existe_registro_suite_w = 0) then 
				begin 
			 
				insert into w_suites( 
					nr_sequencia,              
					cd_setor_atendimento,          
					cd_unidade_basica,            
					cd_unidade_compl,            
					dia1,                  
					dia2,                  
					dia3,                 
					dia4,                  
					dia5,                  
					dia6,                  
					dia7,                  
					dia8,                  
					dia9,                  
					dia10,                  
					dia11,                  
					dia12,                  
					dia13,                  
					dia14,                  
					dia15,                  
					dia16,                  
					dia17,                  
					dia18,                  
					dia19,                  
					dia20,                  
					dia21,                  
					dia22,                  
					dia23,                  
					dia24,                  
					dia25,                 
					dia26,                  
					dia27,                  
					dia28,                  
					dia29,                  
					dia30,                  
					dia31,                  
					dt_referencia) 
					values ( 
					nr_sequencia_w, 
					cd_setor_desejado_w, 
					cd_unidade_basica_w, 
					cd_unidade_compl_w,		 
					dia1_w, 
					dia2_w, 
					dia3_w, 
					dia4_w, 
					dia5_w, 
					dia6_w, 
					dia7_w, 
					dia8_w, 
					dia9_w, 
					dia10_w, 
					dia11_w, 
					dia12_w, 
					dia13_w, 
					dia14_w, 
					dia15_w, 
					dia16_w, 
					dia17_w, 
					dia18_w, 
					dia19_w, 
					dia20_w, 
					dia21_w, 
					dia22_w, 
					dia23_w, 
					dia24_w, 
					dia25_w, 
					dia26_w, 
					dia27_w, 
					dia28_w, 
					dia29_w, 
					dia30_w, 
					dia31_w, 
					dt_referencia_w);
 
				end;
			else 
				begin 
				select nr_sequencia 
				into STRICT	nr_seq_suite_w 
				from	w_suites 
				where	cd_setor_atendimento = cd_setor_desejado_w 
				and	cd_unidade_basica = cd_unidade_basica_w 
				and	cd_unidade_compl = cd_unidade_compl_w;
				 
				 
				update w_suites 
				set	dia1   = 	dia1_w,                    
					dia2   = 	dia2_w,                    
					dia3   =       dia3_w,              
					dia4   =       dia4_w,               
					dia5   =       dia5_w,              
					dia6   =       dia6_w,               
					dia7   =       dia7_w,               
					dia8   =       dia8_w,               
					dia9   =       dia9_w,               
					dia10   =      dia10_w,               
					dia11   =      dia11_w,               
					dia12   =      dia12_w,               
					dia13   =      dia13_w,               
					dia14   =      dia14_w,               
					dia15   =      dia15_w,               
					dia16   =      dia16_w,               
					dia17   =      dia17_w,               
					dia18   =      dia18_w,               
					dia19   =      dia19_w,               
					dia20   =      dia20_w,               
					dia21   =      dia21_w,               
					dia22   =      dia22_w,               
					dia23   =      dia23_w,               
					dia24   =      dia24_w,               
					dia25   =      dia25_w,               
					dia26   =      dia26_w,              
					dia27   =      dia27_w,               
					dia28   =      dia28_w,               
					dia29   =      dia29_w,               
					dia30   =      dia30_w, 
					dia31   =      dia31_w 
				where nr_sequencia = nr_seq_suite_w;			
				end;		
			end if;		
		end;
		end if;
		i		:=	i + 1;
		qt_dia_w	:=	qt_dia_w -1;
		dt_refer_w	:=	dt_refer_w + 1;
		end;
		end loop;
		end;
	else 
		begin 
		if	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '01') then 
			dia1_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '02') then	 
			dia2_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '03') then 
			dia3_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '04') then 
			dia4_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '05') then 
			dia5_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '06') then 
			dia6_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '07') then 
			dia7_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '08') then 
			dia8_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '09') then 
			dia9_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '10') then 
			dia10_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '11') then 
			dia11_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '12') then 
			dia12_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '13') then	 
			dia13_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '14') then				 
			dia14_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '15') then 
			dia15_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '16') then 
			dia16_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '17') then 
			dia17_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '18') then 
			dia18_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '19') then 
			dia19_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '20') then 
			dia20_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '21') then 
			dia21_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '22') then 
			dia22_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '23') then 
			dia23_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '24') then 
			dia24_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '25') then 
			dia25_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '26') then	 
			dia26_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '27') then 
			dia27_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '28') then 
			dia28_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '29') then 
			dia29_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '30') then 
			dia30_w	:=	ds_cor_w;
		elsif	((substr(PKG_DATE_UTILS.start_of(dt_entrada_w,'dd',0),1,2)) = '31') then 
			dia31_w	:=	ds_cor_w;
		end if;
		 
		insert into w_suites( 
			nr_sequencia,              
			cd_setor_atendimento,          
			cd_unidade_basica,            
			cd_unidade_compl,            
			dia1,                  
			dia2,                  
			dia3,                 
			dia4,                  
			dia5,                  
			dia6,                  
			dia7,                  
			dia8,                  
			dia9,                  
			dia10,                  
			dia11,                  
			dia12,                  
			dia13,                  
			dia14,                  
			dia15,                  
			dia16,                  
			dia17,                  
			dia18,                  
			dia19,                  
			dia20,                  
			dia21,                  
			dia22,                  
			dia23,                  
			dia24,                  
			dia25,                 
			dia26,                  
			dia27,                  
			dia28,                  
			dia29,                  
			dia30,                  
			dia31,                  
			dt_referencia) 
			values ( 
			nr_sequencia_w, 
			cd_setor_desejado_w, 
			cd_unidade_basica_w, 
			cd_unidade_compl_w,		 
			dia1_w, 
			dia2_w, 
			dia3_w, 
			dia4_w, 
			dia5_w, 
			dia6_w, 
			dia7_w, 
			dia8_w, 
			dia9_w, 
			dia10_w, 
			dia11_w, 
			dia12_w, 
			dia13_w, 
			dia14_w, 
			dia15_w, 
			dia16_w, 
			dia17_w, 
			dia18_w, 
			dia19_w, 
			dia20_w, 
			dia21_w, 
			dia22_w, 
			dia23_w, 
			dia24_w, 
			dia25_w, 
			dia26_w, 
			dia27_w, 
			dia28_w, 
			dia29_w, 
			dia30_w, 
			dia31_w, 
			dt_referencia_w);
		end;
	end if;		
	 
	dt_entrada_ant_w	:= dt_entrada_w;	
	dt_saida_ant_w		:= dt_saida_w;
	cd_setor_desejado_ant_w	:=	cd_setor_desejado_w;
	cd_unidade_basica_ant_w := 	cd_unidade_basica_w;
	cd_unidade_compl_ant_w :=	cd_unidade_compl_w;
	ds_cor_ant_w		:=	ds_cor_w;
	end;
end loop;
close C01;
 
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_w_suites ( dt_referencia_p timestamp) FROM PUBLIC;

