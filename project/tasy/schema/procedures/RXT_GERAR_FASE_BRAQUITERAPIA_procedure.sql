-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE rxt_gerar_fase_braquiterapia ( nr_seq_planejamento_fisico_p bigint, nr_seq_fase_p bigint, cd_estabelecimento_p bigint, nm_usuario_p text ) AS $body$
DECLARE

			
nr_sequencia_w 		bigint;
dt_atualizacao_w 		timestamp;
nm_usuario_w 		varchar(15);
dt_atualizacao_nrec_w 	timestamp;
nm_usuario_nrec_w 	varchar(15);
nr_seq_aplic_w 		bigint;
ds_resultado_w 		varchar(80);
nr_insercao_w       		integer;
nr_seq_campo_w 		bigint;
qt_atividade_ci_w 		double precision;
qt_tempo_w  		bigint;
qt_angulacao_w  		bigint;
nr_seq_braq_aplic_trat_w 	bigint;
ie_situacao_w 		varchar(1);



BEGIN

	select
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_seq_aplic,
	ds_resultado,
	nr_insercao,
	nr_seq_campo,
	qt_atividade_ci,
	qt_tempo,
	qt_angulacao,
	nr_seq_braq_aplic_trat,
	ie_situacao
	into STRICT
	nr_sequencia_w, 
	dt_atualizacao_w,
	nm_usuario_w,
	dt_atualizacao_nrec_w,
	nm_usuario_nrec_w,
	nr_seq_aplic_w,
	ds_resultado_w,
	nr_insercao_w,
	nr_seq_campo_w,
	qt_atividade_ci_w,
	qt_tempo_w,
	qt_angulacao_w,
	nr_seq_braq_aplic_trat_w,
	ie_situacao_w
	from  rxt_plan_braqui_fisico
	where nr_Sequencia = nr_seq_planejamento_fisico_p
	and nm_usuario = nm_usuario_p;

	insert into rxt_braq_campo_aplic_trat(
	nr_sequencia,
	nm_usuario,
	nm_usuario_nrec,
	dt_atualizacao,
	dt_atualizacao_nrec,
	nr_insercao,
	nr_seq_campo,
	qt_atividade_ci,
	qt_tempo,
	qt_angulacao,
	ds_resultado,
	ie_situacao,
	nr_seq_aplic_trat,
	cd_estabelecimento,
	dt_envio_fisico,
	dt_lib_fisico
	)
	values (
	nextval('rxt_braq_campo_aplic_trat_seq'),
	nm_usuario_p,
	nm_usuario_p,
	clock_timestamp(),
	clock_timestamp(),
	nr_insercao_w,
	nr_seq_campo_w,
	qt_atividade_ci_w,
	qt_tempo_w,
	qt_angulacao_w,
	ds_resultado_w,
	'A',
	nr_seq_fase_p,
	cd_estabelecimento_p,
	clock_timestamp(),
	clock_timestamp()
	);
							
commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE rxt_gerar_fase_braquiterapia ( nr_seq_planejamento_fisico_p bigint, nr_seq_fase_p bigint, cd_estabelecimento_p bigint, nm_usuario_p text ) FROM PUBLIC;

