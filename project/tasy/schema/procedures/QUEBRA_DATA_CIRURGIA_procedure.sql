-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE quebra_data_cirurgia ( nr_cirurgia_p bigint) AS $body$
DECLARE


dt_inicio_real_w	timestamp;
dt_termino_w		timestamp;


BEGIN

dt_inicio_real_w := null;
/* TABELA INATIVADA DO SISTEMA.
delete from w_cirurgia_quebra_data where nr_cirurgia = nr_cirurgia_p;
commit;

select	dt_inicio_real,
	dt_termino
into	dt_inicio_real_w,
	dt_termino_w
from	cirurgia
where	nr_cirurgia = nr_cirurgia_p;

dt_inicio_real_w := dt_inicio_real_w - 15/1440;

while	(dt_inicio_real_w < dt_termino_w) loop
	insert into w_cirurgia_quebra_data
					(dt_inicio,
					dt_fim,
					nr_cirurgia)
	values				(dt_inicio_real_w,
					 dt_inicio_real_w + 45/1440,
					 nr_cirurgia_p);
	commit;
	dt_inicio_real_w := dt_inicio_real_w + 45/1440;
end loop;
*/
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE quebra_data_cirurgia ( nr_cirurgia_p bigint) FROM PUBLIC;

