-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE insert_application_comp_tasy (ds_aplicacao_p text, cd_versao_aplicacao_p text, cd_versao_p text, nr_service_pack_p bigint, nm_usuario_p text) AS $body$
DECLARE


count_w bigint;


BEGIN
    if (coalesce(ds_aplicacao_p::text, '') = '') then
        return;
    end if;

    if (coalesce(cd_versao_aplicacao_p::text, '') = '') then
        return;
    end if;

    if (coalesce(cd_versao_p::text, '') = '') then
        return;
    end if;

    if (coalesce(nr_service_pack_p::text, '') = '') then
        return;
    end if;

    select count(*) into STRICT count_w
    from APPLICATION_COMP_TASY
    where ds_application = ds_aplicacao_p
    and cd_versao_aplicacao = cd_versao_aplicacao_p
    and cd_versao = cd_versao_p
    and nr_service_pack = nr_service_pack_p;

    if (count_w > 0) then
        return;
    end if;

    insert into APPLICATION_COMP_TASY(
        nr_sequencia,
        dt_atualizacao,
        dt_atualizacao_nrec,
        nm_usuario,
        nm_usuario_nrec,
        ds_application,
        cd_versao_aplicacao,
        cd_versao,
        nr_service_pack)
    values (
        nextval('application_comp_tasy_seq'),
        clock_timestamp(),
        clock_timestamp(),
        nm_usuario_p,
        nm_usuario_p,
        ds_aplicacao_p,
        cd_versao_aplicacao_p,
        cd_versao_p,
        nr_service_pack_p);

    commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE insert_application_comp_tasy (ds_aplicacao_p text, cd_versao_aplicacao_p text, cd_versao_p text, nr_service_pack_p bigint, nm_usuario_p text) FROM PUBLIC;

