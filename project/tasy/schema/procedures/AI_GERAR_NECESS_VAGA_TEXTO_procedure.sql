-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE ai_gerar_necess_vaga_texto ( nr_seq_ageint_p bigint, ie_gerar_necessidade_p text, ie_chamar_necessidade_p text, ie_enviar_p INOUT text, ds_email_checklist_p INOUT text, ie_tipo_agendamento_p INOUT text, nr_seq_agenda_p INOUT bigint) AS $body$
DECLARE

		 
ie_tipo_agendamento_w	varchar(15);
nr_seq_agenda_w		bigint;
ie_enviar_w		varchar(1);
ds_email_checklist_w	varchar(5000);


BEGIN 
 
	if (ie_gerar_necessidade_p = 'S') and (ie_chamar_necessidade_p = 'S') then 
		begin 
		SELECT * FROM ageint_gerar_necess_vaga_serv(nr_seq_ageint_p, ie_tipo_agendamento_w, nr_seq_agenda_w) INTO STRICT ie_tipo_agendamento_w, nr_seq_agenda_w;
		end;
	end if;	
	 
	select	CASE WHEN count(*)=0 THEN 'N'  ELSE 'S' END  
	into STRICT	ie_enviar_w 
	from	ageint_check_list_pac_item_v 
	where	ds_resultado = 'S' 
	and 	nr_seq_ageint = nr_seq_ageint_p;
	 
	ds_email_checklist_w := ageint_obter_emails_check(nr_seq_ageint_p);	
	 
ie_enviar_p 		:= ie_enviar_w;
ds_email_checklist_p	:= ds_email_checklist_w;
ie_tipo_agendamento_p	:= ie_tipo_agendamento_w;
nr_seq_agenda_p		:= nr_seq_agenda_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ai_gerar_necess_vaga_texto ( nr_seq_ageint_p bigint, ie_gerar_necessidade_p text, ie_chamar_necessidade_p text, ie_enviar_p INOUT text, ds_email_checklist_p INOUT text, ie_tipo_agendamento_p INOUT text, nr_seq_agenda_p INOUT bigint) FROM PUBLIC;

