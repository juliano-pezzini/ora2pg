-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE ajustar_objeto_schem_html5 ( nr_seq_funcao_schematic_p funcao_schematic.nr_sequencia%type, ie_ajustar_mascara_curr_p text, ie_ajustar_atalhos_p text, ie_ajustar_ordem_ok_cancel_p text, ie_ajustar_wdlg_modal_p text) AS $body$
DECLARE



c01 CURSOR FOR
SELECT	*
from	objeto_schematic
where	nr_seq_funcao_schematic	= nr_seq_funcao_schematic_p;

BEGIN

for	r_c01_w in c01 loop
	if (r_c01_w.nr_seq_dic_objeto IS NOT NULL AND r_c01_w.nr_seq_dic_objeto::text <> '') and (r_c01_w.ie_tipo_componente = 'WCP') then		-- WCpanels
		if (ie_ajustar_mascara_curr_p = 'S') then
			update	dic_objeto
			set		ds_mascara				= 'currency()'
			where	nr_seq_obj_sup			= r_c01_w.nr_seq_dic_objeto
			and		ie_tipo_objeto			= 'AC'
			and		upper(nm_campo_base)	like 'VL_%';
		end if;

	elsif (r_c01_w.nr_seq_dic_objeto IS NOT NULL AND r_c01_w.nr_seq_dic_objeto::text <> '') and (r_c01_w.ie_tipo_componente = 'WPOPUP') then	-- POPUPs
		if (ie_ajustar_atalhos_p = 'S') then
			update	dic_objeto
			set		ie_ctrl					= 'N',
					ie_shift				= 'N',
					ie_alt					= 'N',
					ie_atalho				 = NULL
			where	nr_seq_obj_sup			= r_c01_w.nr_seq_dic_objeto;
		end if;

	elsif (r_c01_w.nr_seq_dic_objeto IS NOT NULL AND r_c01_w.nr_seq_dic_objeto::text <> '') and (r_c01_w.ie_tipo_componente in ('WDF','WF')) then		-- Dinamic forms e Filtros
		if (ie_ajustar_mascara_curr_p = 'S') then
			update	DIC_OBJETO_FILTRO
			set	ds_mascara				= 'currency()'
			where	nr_seq_objeto				= r_c01_w.nr_seq_dic_objeto
			and	upper(nm_atributo)			like 'VL_%';
		end if;

	elsif (r_c01_w.nm_tabela IS NOT NULL AND r_c01_w.nm_tabela::text <> '') and (r_c01_w.nr_seq_visao IS NOT NULL AND r_c01_w.nr_seq_visao::text <> '') then					-- DBPanels
		if (ie_ajustar_mascara_curr_p = 'S') then
			update	tabela_visao_atributo
			set		ds_mascara				= 'currency()'
			where	nr_sequencia			= r_c01_w.nr_seq_visao
			and		upper(nm_atributo)		like 'VL_%';
		end if;

	elsif (r_c01_w.ie_tipo_componente = 'WDLG') then	-- WDLGs
		if (ie_ajustar_ordem_ok_cancel_p = 'S') then
			update	objeto_schematic
			set		nr_seq_apres		= 1
			where	nr_seq_obj_sup		= r_c01_w.nr_sequencia
			and		ie_tipo_obj_button	= 'CANCEL';

			update	objeto_schematic
			set		nr_seq_apres		= 2
			where	nr_seq_obj_sup		= r_c01_w.nr_sequencia
			and		ie_tipo_obj_button	= 'OK';
		end if;

		if (ie_ajustar_wdlg_modal_p = 'S') then
			update	objeto_schematic_prop
			set		ie_habilita_modal		= 'S'
			where	nr_seq_objeto			= r_c01_w.nr_sequencia;
		end if;

	end if;
end loop;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ajustar_objeto_schem_html5 ( nr_seq_funcao_schematic_p funcao_schematic.nr_sequencia%type, ie_ajustar_mascara_curr_p text, ie_ajustar_atalhos_p text, ie_ajustar_ordem_ok_cancel_p text, ie_ajustar_wdlg_modal_p text) FROM PUBLIC;

