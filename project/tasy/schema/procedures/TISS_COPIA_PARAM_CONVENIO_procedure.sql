-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE tiss_copia_param_convenio ( cd_convenio_orig_p bigint, cd_estab_orig_p bigint, cd_convenio_dest_p bigint, cd_estab_dest_p bigint, nm_tabela_p text, nm_usuario_p text, ie_excluir_p text) AS $body$
DECLARE


nr_seq_w			bigint;
nr_sequencia_w			bigint;


c022 CURSOR FOR
	SELECT	nr_sequencia
	from	tiss_regra_guia
	where	cd_convenio = cd_convenio_orig_p
	and 	cd_estabelecimento = cd_estab_orig_p;

C023 CURSOR FOR
	SELECT	nr_sequencia
	from	tiss_regra_campo_esp
	where	cd_convenio = cd_convenio_orig_p
	and 	cd_estabelecimento = cd_estab_orig_p;

C024 CURSOR FOR
	SELECT	nr_sequencia
	from	tiss_regra_partic_adic
	where	cd_convenio = cd_convenio_orig_p
	and 	cd_estabelecimento = cd_estab_orig_p;

C025 CURSOR FOR
	SELECT	nr_sequencia
	from	tiss_regra_arquivo_adic
	where	cd_convenio = cd_convenio_orig_p
	and 	cd_estabelecimento = cd_estab_orig_p;


BEGIN

if (nm_tabela_p	= 'TISS_REGRA_TABELA_MAT') then

	if (ie_excluir_p = 'S') then
		delete	from tiss_regra_tabela_mat
		where	cd_convenio = cd_convenio_dest_p
		and	cd_estabelecimento	= cd_estab_dest_p;
	end if;

	insert	into tiss_regra_tabela_mat(
		nr_sequencia,
		cd_estabelecimento,
		dt_atualizacao,
		nm_usuario,
		dt_atualizacao_nrec,
		nm_usuario_nrec,
		cd_convenio,
		cd_categoria,
		dt_inicio_vigencia,
		cd_grupo_material,
		cd_subgrupo_material,
		cd_classe_material,
		cd_material,
		nr_seq_tiss_tabela,
		ie_cod_material,
		ie_conversao_externa,
		ie_situacao,
		cd_material_tiss,
		ds_material_tiss,
		ie_tipo_atendimento,
		cd_setor_atendimento,
		ie_origem_preco,
		cd_adicional,
		ie_desc_material,
		ie_prioridade,
		cd_tab_preco_material,
		dt_final_vigencia,
		ie_pacote,
		vl_inicial,
		vl_final,
		ie_registro_anvisa,
		ie_material_tuss,
		nr_seq_familia,
		ie_tipo_material)
	SELECT	nextval('tiss_regra_tabela_mat_seq'),
		cd_estab_dest_p,
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		nm_usuario_p,
		cd_convenio_dest_p,
		cd_categoria,
		dt_inicio_vigencia,
		cd_grupo_material,
		cd_subgrupo_material,
		cd_classe_material,
		cd_material,
		nr_seq_tiss_tabela,
		ie_cod_material,
		ie_conversao_externa,
		ie_situacao,
		cd_material_tiss,
		ds_material_tiss,
		ie_tipo_atendimento,
		cd_setor_atendimento,
		ie_origem_preco,
		cd_adicional,
		ie_desc_material,
		ie_prioridade,
		cd_tab_preco_material,
		dt_final_vigencia,
		ie_pacote,
		vl_inicial,
		vl_final,
		ie_registro_anvisa,
		ie_material_tuss,
		nr_seq_familia,
		ie_tipo_material
	from	tiss_regra_tabela_mat
	where	cd_estabelecimento	= cd_estab_orig_p
	and	cd_convenio = cd_convenio_orig_p;



elsif (nm_tabela_p = 'TISS_SENHA_CONEXAO') then

	if (ie_excluir_p = 'S') then
		delete	from tiss_senha_conexao
		where	cd_convenio = cd_convenio_dest_p
		and	cd_estabelecimento	= cd_estab_dest_p;
	end if;

	insert into tiss_senha_conexao(
		nr_sequencia,
		cd_estabelecimento,
		nm_usuario_tiss,
		ds_senha_tiss,
		dt_atualizacao,
		nm_usuario,
		dt_atualizacao_nrec,
		nm_usuario_nrec,
		cd_convenio,
		nm_usuario_senha,
		ie_comunicacao,
		ds_dir_entrada,
		ds_dir_saida,
		ds_caminho_certificado,
		ds_senha_certificado,
		ds_caminho_keystore,
		ds_senha_keystore)
	SELECT	nextval('tiss_senha_conexao_seq'),
		cd_estab_dest_p,
		nm_usuario_tiss,
		ds_senha_tiss,
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		nm_usuario_p,
		cd_convenio_dest_p,
		nm_usuario_senha,
		ie_comunicacao,
		ds_dir_entrada,
		ds_dir_saida,
		ds_caminho_certificado,
		ds_senha_certificado,
		ds_caminho_keystore,
		ds_senha_keystore
	from	tiss_senha_conexao
	where	cd_estabelecimento = cd_estab_orig_p
	and	cd_convenio = cd_convenio_orig_p;

elsif (nm_tabela_p = 'TISS_REGRA_TABELA_PROC') then

	if (ie_excluir_p = 'S') then
		delete	from tiss_regra_tabela_proc
		where	cd_convenio = cd_convenio_dest_p
		and	cd_estabelecimento = cd_estab_dest_p;
	end if;

	insert into tiss_regra_tabela_proc(
		nr_sequencia,
		cd_estabelecimento,
		dt_atualizacao,
		nm_usuario,
		dt_atualizacao_nrec,
		nm_usuario_nrec,
		cd_convenio,
		cd_categoria,
		dt_inicio_vigencia,
		cd_area_procedimento,
		cd_especialidade,
		cd_grupo_proc,
		nr_seq_tiss_tabela,
		cd_procedimento,
		ie_origem_proced,
		ie_pacote,
		cd_procedimento_convenio,
		ds_procedimento_convenio,
		ie_tipo_atendimento,
		dt_fim_vigencia,
		ie_clinica,
		nr_seq_proc_interno,
		cd_plano)
	SELECT	nextval('tiss_regra_tabela_proc_seq'),
		cd_estab_dest_p,
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		nm_usuario_p,
		cd_convenio_dest_p,
		cd_categoria,
		dt_inicio_vigencia,
		cd_area_procedimento,
		cd_especialidade,
		cd_grupo_proc,
		nr_seq_tiss_tabela,
		cd_procedimento,
		ie_origem_proced,
		ie_pacote,
		cd_procedimento_convenio,
		ds_procedimento_convenio,
		ie_tipo_atendimento,
		dt_fim_vigencia,
		ie_clinica,
		nr_seq_proc_interno,
		cd_plano
	from	tiss_regra_tabela_proc
	where	cd_estabelecimento = cd_estab_orig_p
	and	cd_convenio = cd_convenio_orig_p;


elsif (nm_tabela_p = 'TISS_REGRA_CAMPO_CONV') then

	if (ie_excluir_p = 'S') then
		delete	from tiss_regra_campo_conv
		where	cd_convenio = cd_convenio_dest_p
		and	cd_estabelecimento = cd_estab_dest_p;
	end if;

	insert into tiss_regra_campo_conv(
		nr_sequencia,
		cd_estabelecimento,
		dt_atualizacao,
		nm_usuario,
		dt_atualizacao_nrec,
		nm_usuario_nrec,
		cd_convenio,
		nr_seq_campo,
		ie_envio,
		ds_padrao,
		ie_tipo_atendimento,
		cd_categoria,
		ie_taxas,
		vl_max_campo,
		ds_valor_gerado,
		ie_gases,
		ie_medicamento,
		ie_material,
		ie_taxas_diversas,
		ie_diarias,
		ie_alugueis,
		ie_clinica,
		nr_seq_classificacao,
		cd_setor_entrada,
		ie_tipo_atend_tiss,
		ie_tipo_atend_proc_tiss)
	SELECT	nextval('tiss_regra_campo_conv_seq'),
		cd_estab_dest_p,
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		nm_usuario_p,
		cd_convenio_dest_p,
		nr_seq_campo,
		ie_envio,
		ds_padrao,
		ie_tipo_atendimento,
		cd_categoria,
		ie_taxas,
		vl_max_campo,
		ds_valor_gerado,
		ie_gases,
		ie_medicamento,
		ie_material,
		ie_taxas_diversas,
		ie_diarias,
		ie_alugueis,
		ie_clinica,
		nr_seq_classificacao,
		cd_setor_entrada,
		ie_tipo_atend_tiss,
		ie_tipo_atend_proc_tiss
	from	tiss_regra_campo_conv
	where	cd_estabelecimento	= cd_estab_orig_p
	and	cd_convenio		= cd_convenio_orig_p;

elsif (nm_tabela_p		= 'TISS_PARAMETROS_CONVENIO') then
	if (ie_excluir_p = 'S') then
		delete	from tiss_parametros_convenio
		where	cd_convenio 		= cd_convenio_dest_p
		and	cd_estabelecimento	= cd_estab_dest_p;
	end if;


		insert into tiss_parametros_convenio(
 			nr_sequencia         		,
 			cd_estabelecimento             	,
 			dt_atualizacao                 	,
 			nm_usuario                     	,
 			dt_atualizacao_nrec            	,
 			nm_usuario_nrec                	,
 			cd_convenio                    	,
 			ie_data_despesa               	,
 			ie_medico_solic_atend         	,
 			ie_agrupar_proc                	,
 			ie_fechar_conta_incons         	,
 			ie_cid_spsadt                  	,
 			ie_partic_conveniado           	,
 			ds_observacao                  	,
 			ie_consiste_codigo    	        ,
 			ie_atualizar_alta              	,
 			ie_exec_spsadt                 	,
 			ie_totalizar_opm               	,
 			ie_consiste_tiss               	,
 			ie_spsadt_zerado               	,
 			ie_ri_zerado                   	,
 			ie_guia_protocolo              	,
 			ie_despesa_zerada              	,
 			ds_mascara_usuario             	,
 			ie_arredondamento_desp         	,
 			ie_proc_partic                 	,
 			ie_proc_solic_spsadt           	,
 			ie_consiste_autor_spsadt       	,
 			ie_solicitante                 	,
 			ie_numero_lote                 	,
 			ie_crm                         	,
 			ie_guia_prestador              	,
 			ie_desp_tiss_internado         	,
 			ie_consiste_desp_neg           	,
 			ie_consiste_via_acesso         	,
 			ie_cod_tiss_brasindice         	,
 			ie_saida_internacao            	,
 			ie_total_guia_desp             	,
 			ie_data_proc                   	,
 			ie_gerar_cta_dif_tiss          	,
 			ie_senha_guia                  	,
 			ie_guia_honorario              	,
 			ie_fechar_prot_incons          	,
 			ie_campo_boolean               	,
 			ie_guia_princ_honor            	,
 			ie_mascara_cid                 	,
 			ds_formato_carteira            	,
 			ie_envio_carteira              	,
 			ds_mascara_lote                	,
 			ie_desc_proc_interno           	,
 			ie_ordenacao_od                	,
 			ie_honor_partic                	,
 			ie_consistir_obs               	,
 			qt_dias_validade_guia          	,
 			ds_email_autor                 	,
 			nr_seq_saida_spsadt            	,
 			ie_partic_spsadt               	,
 			ie_assinatura_solic            	,
 			ie_emite_opm_zerado            	,
			ie_digitos_desp			,
			ie_aborto_nasc         		,
			ie_consiste_indicacao  		,
			ie_reducao_acresc		,
			ie_total_opm           		,
			ie_contratado_consulta 		,
			qt_guias_protocolo     		,
			ie_data_entrada_ri     		,
			qt_max_despesa         		,
			ie_consistir_proc      		,
			ie_contrat_exec_hi     		,
			ie_consistir_decl_obito		,
			ie_dt_contrat_ri       		,
			ie_periodo_desp        		,
			ie_consiste_tec_util   		,
			ie_participante_ri     		,
			ie_consistir_guia_senha		,
			ie_relat_autor         		,
			ie_regra_mascara       		,
			ie_separar_spsadt_honor		,
			ie_valor_desconto      		,
			ie_tipo_acomod         		,
			ie_exec_ri             		,
			ie_formato_red_acres   		,
			ie_emite_honor_sadt_pep		,
			ie_ordenacao_xml       		,
			ie_data_trans_xml      		,
			ie_agrupar_desp_pac    		,
			ie_medico_rep          		,
			ie_honor_zerado        		,
			ie_nome_arquivo        		,
			ie_consiste_tipo_saida 		,
			ie_consiste_cid_autor  		,
			ie_cid_solic_externo   		,
			ie_especialidade_exec  		,
			ie_observacao          		,
			ie_valor_unitario		,
			ie_protocolo_ret 		,
			ie_ordenacao_spsadt            	,
			ie_carteira_med                	,
			ie_guia_desp_med               	,
			ie_dt_emissao_guia             	,
			ie_total_geral_opm             	,
			ie_valor_unitario_opm          	,
			ie_obs_urgente                 	,
			ie_lado_rep                    	,
			ie_quebra_proc_pep             	,
			ie_conversao_qtde_mat          	,
			ds_dir_padrao                  	,
			ds_dir_padrao_ret              	,
			ie_agrup_resp_cred             	,
			ie_data_entrada_alta           	,
			nr_seq_saida_int               	,
			ie_pacote                      	,
			ie_proc_tuss                   	,
			ie_prescr_unica                	,
			ie_data_ass_prest              	,
			ie_nome_abrev                  	,
			ie_senha_guia_princ            	,
			ie_desc_plano                  	,
			ie_desc_convenio               	,
			ie_prot_solic_status           	,
			ie_data_ref_tab_mat            	,
			ie_consistir_cpf               	,
			ie_consistir_uf_crm_solic	,
			ds_arquivo_logo_comp           	,
			ie_consistir_guia_dup          	,
			ie_dt_proc_tasymed             	,
			ie_consistir_proc_zerado	,
			ie_atual_conta           	,
			ie_cons_tempo_doenca      	,
			ie_agrup_exame             	,
			ie_dt_autor_sadt            	,
			ie_forcar_agrup              	,
			ie_tipo_fatur_tiss            	,
			nr_seq_saida_consulta          	,
			ie_gerar_tiss                  	,
			ds_function_obs_spsadt         	,
			ie_consiste_cbo                	,
			ie_senha_autor                 	,
			ds_adicional_guia_prest        	,
			cd_adic_crm                    	,
			ie_consiste_senha_autor        	,
			ie_dt_autor_ri                 	,
			ie_dt_validade_senha_ri        	,
			ie_membro_exec                 	,
			ie_dt_assin_solic              	,
			ie_alt_tipo_atend_conta        	,
			ds_function_obs_consulta	,
			ie_gravar_log_conta      	,
			ie_gestacao_nasc_vivos    	,
			ie_gestacao_dif_aborto         	,
			ie_consiste_qt_proc     	,
			ie_atualiza_senha_conta        	,
			ie_transtorno_aborto           	,
			nr_seq_trans_tiss              	,
			ds_mascara_crm                 	,
			ie_cid_ri                      	,
			ds_namespace                   	,
			ie_codigo_interno_desp         	,
			ie_cd_autorizacao_relat        	,
			ie_desc_exame_ext              	,
			ie_prest_spsadt_tasymed        	,
			ie_fonte_pagadora              	,
			nr_lote_atual                  	,
			ie_topo_rep                    	,
			ie_mascara_dnv                 	,
			ie_data_atecaco                	,
			ie_guia_numerica               	,
			ie_forcar_agrup_partic         	,
			ie_medico_convenio             	,
			ie_tipo_fatur_periodo          	,
			ie_spsadt_atend_retorno        	,
			ie_cons_atend_retorno          	,
			ie_ordenacao_ri                	,
			ie_atualiza_nr_guia            	,
			ie_cod_tiss_simpro             	,
			ie_crm_contrat_solic           	,
			ie_lado_conta                  	,
			ie_consiste_grau_partic        	,
			ie_solic_dem_pagto             	,
			ie_nao_honorario_sadt          	,
			ie_guia_desp_proc_princ        	,
			ie_sadt_autor_sem_proc 		,
			ie_medico_solic_exame          	,
			ie_diag_tipo_atend             	,
			ie_emitir_hemocomponente	,
			ie_assinatura_exec             	,
			ie_quebra_grupo_exame		,
			ie_agrupar_honor		,
			ie_guia_princ_autor		,
			ie_ultima_prescricao		,
			ie_guia_operadora_autor		,
			ie_conversao_sadt_solic		,
			ie_arquivos_zip			,
			ie_consiste_cns			,
			ie_material_exec		,
			ie_qtd_material			,
			ie_senha_proc_prescr		,
			ie_guia_solic_inte_proc		,
			ie_consiste_codigo_ans		,
			ie_tipo_saida_parcial		,
			ie_obito_parcial		,
			ds_caracteres_xml		,
			ie_agrupar_opme			,
			ie_quebra_horarios_prescr	,
			ie_lote_xml_despesa		,
			ie_desc_laudo_fatur_med		,
			ie_consiste_valor_guia		,
			ie_data_assin_autor		,
			ie_quebra_guia_prescr_assoc	,
			ie_guia_pedido_exame		,
			ie_obs_prescr_autor		,
			ie_guia_ref_prorrog		,
			ie_senha_mat_guia_proc		,
			ie_prest_exec_pedido_exame	,
			ie_data_lote_anexo		,
			ie_qt_dose_solic_quimio		,
			ie_ref_solic_dem_pagto		,
			ie_cbo_autor_espec		,
			ie_setor_exec_proc		,
			ie_consiste_tuss_autor		,
			ie_dose_quimio			,
			ie_senha_taxa_guia_proc		,
			ie_consiste_just_espec_opm	,
			ie_guia_ref_anexo		,
			ie_indicacao_proc_prescr	,
			ie_prest_solic_odonto		,
			ie_contrat_exec_odonto		,
			ie_prof_exec_odonto		,
			nm_usuario_assinatura_contrat	,
			qt_dias_int_titular_conv	,
			ie_qt_proc_prescr_interv	,
			nr_guia_oper_rec_glosa		,
			ie_atualiza_vinculo_tuss	,
			ie_desp_agrup_valor		,
			ie_import_itens_dem_grg		,
			ie_data_rec_glosa_tiss		,
			ie_imp_validade_guia_senha
			)
		SELECT	nextval('tiss_parametros_convenio_seq'),
			cd_estab_dest_p			,
			clock_timestamp()				,
			nm_usuario_p			,
			clock_timestamp()				,
			nm_usuario_p			,
			cd_convenio_dest_p,
 			ie_data_despesa,
 			ie_medico_solic_atend         	,
 			ie_agrupar_proc                	,
 			ie_fechar_conta_incons         	,
 			ie_cid_spsadt                  	,
 			ie_partic_conveniado           	,
 			ds_observacao                  	,
 			ie_consiste_codigo    	        ,
 			ie_atualizar_alta              	,
 			ie_exec_spsadt                 	,
 			ie_totalizar_opm               	,
 			ie_consiste_tiss               	,
 			ie_spsadt_zerado               	,
 			ie_ri_zerado                   	,
 			ie_guia_protocolo              	,
 			ie_despesa_zerada              	,
 			ds_mascara_usuario             	,
 			ie_arredondamento_desp         	,
 			ie_proc_partic                 	,
 			ie_proc_solic_spsadt           	,
 			ie_consiste_autor_spsadt       	,
 			ie_solicitante                 	,
 			ie_numero_lote                 	,
 			ie_crm                         	,
 			ie_guia_prestador              	,
 			ie_desp_tiss_internado         	,
 			ie_consiste_desp_neg           	,
 			ie_consiste_via_acesso         	,
 			ie_cod_tiss_brasindice         	,
 			ie_saida_internacao            	,
 			ie_total_guia_desp             	,
 			ie_data_proc                   	,
 			ie_gerar_cta_dif_tiss          	,
 			ie_senha_guia                  	,
 			ie_guia_honorario              	,
 			ie_fechar_prot_incons          	,
 			ie_campo_boolean               	,
 			ie_guia_princ_honor            	,
 			ie_mascara_cid                 	,
 			ds_formato_carteira            	,
 			ie_envio_carteira              	,
 			ds_mascara_lote                	,
 			ie_desc_proc_interno           	,
 			ie_ordenacao_od                	,
 			ie_honor_partic                	,
 			ie_consistir_obs               	,
 			qt_dias_validade_guia          	,
 			ds_email_autor                 	,
 			nr_seq_saida_spsadt            	,
 			ie_partic_spsadt               	,
 			ie_assinatura_solic            	,
 			ie_emite_opm_zerado            	,
			ie_digitos_desp			,
			ie_aborto_nasc         		,
			ie_consiste_indicacao  		,
			ie_reducao_acresc		,
			ie_total_opm           		,
			ie_contratado_consulta 		,
			qt_guias_protocolo     		,
			ie_data_entrada_ri     		,
			qt_max_despesa         		,
			ie_consistir_proc      		,
			ie_contrat_exec_hi     		,
			ie_consistir_decl_obito		,
			ie_dt_contrat_ri       		,
			ie_periodo_desp        		,
			ie_consiste_tec_util   		,
			ie_participante_ri     		,
			ie_consistir_guia_senha		,
			ie_relat_autor         		,
			ie_regra_mascara       		,
			ie_separar_spsadt_honor		,
			ie_valor_desconto      		,
			ie_tipo_acomod         		,
			ie_exec_ri             		,
			ie_formato_red_acres   		,
			ie_emite_honor_sadt_pep		,
			ie_ordenacao_xml       		,
			ie_data_trans_xml      		,
			ie_agrupar_desp_pac    		,
			ie_medico_rep          		,
			ie_honor_zerado        		,
			ie_nome_arquivo        		,
			ie_consiste_tipo_saida 		,
			ie_consiste_cid_autor  		,
			ie_cid_solic_externo   		,
			ie_especialidade_exec  		,
			ie_observacao          		,
			ie_valor_unitario		,
			ie_protocolo_ret 		,
			ie_ordenacao_spsadt            	,
			ie_carteira_med                	,
			ie_guia_desp_med               	,
			ie_dt_emissao_guia             	,
			ie_total_geral_opm             	,
			ie_valor_unitario_opm          	,
			ie_obs_urgente                 	,
			ie_lado_rep                    	,
			ie_quebra_proc_pep             	,
			ie_conversao_qtde_mat          	,
			ds_dir_padrao                  	,
			ds_dir_padrao_ret              	,
			ie_agrup_resp_cred             	,
			ie_data_entrada_alta           	,
			nr_seq_saida_int               	,
			ie_pacote                      	,
			ie_proc_tuss                   	,
			ie_prescr_unica                	,
			ie_data_ass_prest              	,
			ie_nome_abrev                  	,
			ie_senha_guia_princ            	,
			ie_desc_plano                  	,
			ie_desc_convenio               	,
			ie_prot_solic_status           	,
			ie_data_ref_tab_mat            	,
			ie_consistir_cpf               	,
			coalesce(ie_consistir_uf_crm_solic,'S'),
			ds_arquivo_logo_comp           	,
			ie_consistir_guia_dup          	,
			ie_dt_proc_tasymed             	,
			ie_consistir_proc_zerado	,
			ie_atual_conta           	,
			ie_cons_tempo_doenca      	,
			ie_agrup_exame             	,
			ie_dt_autor_sadt            	,
			ie_forcar_agrup              	,
			ie_tipo_fatur_tiss            	,
			nr_seq_saida_consulta          	,
			ie_gerar_tiss                  	,
			ds_function_obs_spsadt         	,
			ie_consiste_cbo                	,
			ie_senha_autor                 	,
			ds_adicional_guia_prest        	,
			cd_adic_crm                    	,
			ie_consiste_senha_autor        	,
			ie_dt_autor_ri                 	,
			ie_dt_validade_senha_ri        	,
			ie_membro_exec                 	,
			ie_dt_assin_solic              	,
			ie_alt_tipo_atend_conta        	,
			ds_function_obs_consulta	,
			ie_gravar_log_conta      	,
			ie_gestacao_nasc_vivos    	,
			ie_gestacao_dif_aborto         	,
			ie_consiste_qt_proc     	,
			ie_atualiza_senha_conta        	,
			ie_transtorno_aborto           	,
			nr_seq_trans_tiss              	,
			ds_mascara_crm                 	,
			ie_cid_ri                      	,
			ds_namespace                   	,
			ie_codigo_interno_desp         	,
			ie_cd_autorizacao_relat        	,
			ie_desc_exame_ext              	,
			ie_prest_spsadt_tasymed        	,
			ie_fonte_pagadora              	,
			nr_lote_atual                  	,
			ie_topo_rep                    	,
			ie_mascara_dnv                 	,
			ie_data_atecaco                	,
			ie_guia_numerica               	,
			ie_forcar_agrup_partic         	,
			ie_medico_convenio             	,
			ie_tipo_fatur_periodo          	,
			ie_spsadt_atend_retorno        	,
			ie_cons_atend_retorno          	,
			ie_ordenacao_ri                	,
			ie_atualiza_nr_guia            	,
			ie_cod_tiss_simpro             	,
			ie_crm_contrat_solic           	,
			ie_lado_conta                  	,
			ie_consiste_grau_partic        	,
			ie_solic_dem_pagto             	,
			ie_nao_honorario_sadt          	,
			ie_guia_desp_proc_princ        	,
			ie_sadt_autor_sem_proc 		,
			ie_medico_solic_exame          	,
			ie_diag_tipo_atend             	,
			ie_emitir_hemocomponente	,
			ie_assinatura_exec             	,
			ie_quebra_grupo_exame		,
			ie_agrupar_honor		,
			ie_guia_princ_autor		,
			ie_ultima_prescricao		,
			ie_guia_operadora_autor		,
			ie_conversao_sadt_solic		,
			ie_arquivos_zip			,
			ie_consiste_cns			,
			ie_material_exec		,
			ie_qtd_material			,
			ie_senha_proc_prescr		,
			ie_guia_solic_inte_proc		,
			ie_consiste_codigo_ans		,
			ie_tipo_saida_parcial		,
			ie_obito_parcial		,
			ds_caracteres_xml		,
			ie_agrupar_opme			,
			ie_quebra_horarios_prescr	,
			ie_lote_xml_despesa		,
			ie_desc_laudo_fatur_med		,
			ie_consiste_valor_guia		,
			ie_data_assin_autor		,
			ie_quebra_guia_prescr_assoc	,
			ie_guia_pedido_exame		,
			ie_obs_prescr_autor		,
			ie_guia_ref_prorrog		,
			ie_senha_mat_guia_proc		,
			ie_prest_exec_pedido_exame	,
			ie_data_lote_anexo		,
			ie_qt_dose_solic_quimio		,
			ie_ref_solic_dem_pagto		,
			ie_cbo_autor_espec		,
			ie_setor_exec_proc		,
			ie_consiste_tuss_autor		,
			ie_dose_quimio			,
			ie_senha_taxa_guia_proc		,
			ie_consiste_just_espec_opm	,
			ie_guia_ref_anexo		,
			ie_indicacao_proc_prescr	,
			ie_prest_solic_odonto		,
			ie_contrat_exec_odonto		,
			ie_prof_exec_odonto		,
			nm_usuario_assinatura_contrat	,
			qt_dias_int_titular_conv	,
			ie_qt_proc_prescr_interv	,
			nr_guia_oper_rec_glosa		,
			ie_atualiza_vinculo_tuss	,
			ie_desp_agrup_valor		,
			ie_import_itens_dem_grg		,
			ie_data_rec_glosa_tiss		,
			ie_imp_validade_guia_senha
		from	tiss_parametros_convenio
		where	cd_estabelecimento	= cd_estab_orig_p
		and	cd_convenio		= cd_convenio_orig_p;

elsif (nm_tabela_p		= 'TISS_REGRA_PRESTADOR') then

	if (ie_excluir_p = 'S') then
		delete	from tiss_regra_prestador
		where	cd_convenio 		= cd_convenio_dest_p
		and	cd_estabelecimento	= cd_estab_dest_p;
	end if;


	insert into tiss_regra_prestador(
			nr_sequencia  			,
			cd_estabelecimento      	,
			dt_atualizacao           	,
			nm_usuario              	,
			dt_atualizacao_nrec           	,
			nm_usuario_nrec               	,
			cd_convenio                    	,
			ie_responsavel_credito        	,
			cd_cgc_prestador_tiss          	,
			ie_tipo_atendimento            	,
			ie_tipo_regra                 	,
			cd_cgc_prestador               	,
			ie_guia_ri                     	,
			ie_solicitante			,
			ie_guia_honorario		,
			ds_prestador_tiss      		,
			cd_categoria           		,
			cd_procedimento        		,
			ie_origem_proced      		,
			cd_area_procedimento		,
			cd_especialidade     		,
			cd_grupo_proc         		,
			cd_medico_atend        		,
			ie_prestador           		,
			cd_cgc_solic_prescr    		,
			ie_med_exec            		,
			ie_escala              		,
			ie_fatur_medico        		,
			ie_prioridade          		,
			dt_inicio_vigencia     		,
			dt_fim_vigencia        		,
			cd_medico_referido     		,
			cd_tipo_acomodacao     		,
			cd_procedencia         		,
			cd_plano               		,
			nr_seq_classificacao   		,
			ie_vinculo_medico      			)
		SELECT	nextval('tiss_regra_prestador_seq'),
			cd_estab_dest_p,
			clock_timestamp(),
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			cd_convenio_dest_p,
			ie_responsavel_credito        	,
			cd_cgc_prestador_tiss          	,
			ie_tipo_atendimento            	,
			ie_tipo_regra                 	,
			cd_cgc_prestador               	,
			ie_guia_ri             		,
			ie_solicitante,
			coalesce(ie_guia_honorario,'N')	,
			ds_prestador_tiss      		,
			cd_categoria           		,
			cd_procedimento        		,
			ie_origem_proced      		,
			cd_area_procedimento		,
			cd_especialidade     		,
			cd_grupo_proc         		,
			cd_medico_atend        		,
			ie_prestador           		,
			cd_cgc_solic_prescr    		,
			ie_med_exec            		,
			ie_escala              		,
			ie_fatur_medico        		,
			ie_prioridade          		,
			dt_inicio_vigencia     		,
			dt_fim_vigencia        		,
			cd_medico_referido     		,
			cd_tipo_acomodacao     		,
			cd_procedencia         		,
			cd_plano               		,
			nr_seq_classificacao   		,
			ie_vinculo_medico
		from	tiss_regra_prestador
		where	cd_estabelecimento	= cd_estab_orig_p
		and	cd_convenio		= cd_convenio_orig_p;

elsif (nm_tabela_p	= 'TISS_REGRA_GUIA') then
	if (ie_excluir_p = 'S') then
		delete	from tiss_regra_guia
		where	cd_convenio 		= cd_convenio_dest_p
		and	cd_estabelecimento	= cd_estab_dest_p;
	end if;

	open c022;

	loop
	fetch c022 into
		nr_seq_w;
	EXIT WHEN NOT FOUND; /* apply on c022 */

	select	nextval('tiss_regra_guia_seq')
	into STRICT	nr_sequencia_w
	;

	insert	into	tiss_regra_guia(
			nr_sequencia     ,
			dt_atualizacao   ,
			nm_usuario       ,
			dt_atualizacao_nrec,
			nm_usuario_nrec    ,
			cd_estabelecimento ,
			cd_convenio        ,
			ie_tiss_tipo_guia  ,
			ie_forma           ,
			ds_adicional       ,
			ie_tipo_atendimento,
			nr_inicial         ,
			nr_final           ,
			nr_atual           ,
			ds_mascara         ,
			cd_perfil_comunic  ,
			nr_doc_conv_comunic,
			ie_guia_honorario  ,
			qt_max_proc        ,
			ie_guia_prestador  ,
			ie_responsavel_credito,
			ie_funcao_medico      ,
			ie_cbos ,
			ie_guia_medico         ,
			qt_itens_guia          ,
			ie_guia                ,
			ie_guia_partic_dif     ,
			ie_senha               ,
			ie_setor_atendimento   ,
			ie_medico_req          ,
			ie_prescricao          ,
			cd_setor_atendimento   ,
			ie_medico_solic_prescr ,
			ie_tipo_atend_conta    ,
			ie_funcionario         ,
			cd_funcao              ,
			ie_considerar_setor    ,
			ie_tipo_guia_atend     ,
			cd_procedimento        ,
			ie_origem_proced       ,
			cd_area_procedimento   ,
			cd_especialidade       ,
			cd_grupo_proc          ,
			ie_considerar_tipo_guia,
			ie_tipo_procedimento   ,
			ie_data_item           ,
			ie_tipo_atend_tiss_proc,
			ie_restringir_conta    ,
			ie_setor_proc_prescr   ,
			ie_restringir_honor    )
		SELECT	nr_sequencia_w,
			clock_timestamp(),
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			cd_estab_dest_p,
			cd_convenio_dest_p,
			ie_tiss_tipo_guia  ,
			ie_forma           ,
			ds_adicional       ,
			ie_tipo_atendimento,
			nr_inicial         ,
			nr_final           ,
			nr_atual           ,
			ds_mascara         ,
			cd_perfil_comunic  ,
			nr_doc_conv_comunic,
			ie_guia_honorario  ,
			qt_max_proc        ,
			ie_guia_prestador  ,
			ie_responsavel_credito,
			ie_funcao_medico      ,
			ie_cbos,
			ie_guia_medico         ,
			qt_itens_guia          ,
			ie_guia                ,
			ie_guia_partic_dif     ,
			ie_senha               ,
			ie_setor_atendimento   ,
			ie_medico_req          ,
			ie_prescricao          ,
			cd_setor_atendimento   ,
			ie_medico_solic_prescr ,
			ie_tipo_atend_conta    ,
			ie_funcionario         ,
			cd_funcao              ,
			ie_considerar_setor    ,
			ie_tipo_guia_atend     ,
			cd_procedimento        ,
			ie_origem_proced       ,
			cd_area_procedimento   ,
			cd_especialidade       ,
			cd_grupo_proc          ,
			ie_considerar_tipo_guia,
			ie_tipo_procedimento   ,
			ie_data_item           ,
			ie_tipo_atend_tiss_proc,
			ie_restringir_conta    ,
			ie_setor_proc_prescr   ,
			ie_restringir_honor
		from	tiss_regra_guia
		where	nr_sequencia	= nr_seq_w;

	insert into	tiss_regra_guia_adic(
			nr_sequencia         ,
			dt_atualizacao       ,
			nm_usuario           ,
			dt_atualizacao_nrec  ,
			nm_usuario_nrec      ,
			nr_seq_regra         ,
			ie_resp_credito_fora,
			cd_setor_prescr_fora	)
		SELECT	nextval('tiss_regra_guia_adic_seq'),
			clock_timestamp(),
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			nr_sequencia_w,
			ie_resp_credito_fora,
			cd_setor_prescr_fora
		from	tiss_regra_guia_adic
		where	nr_seq_regra	= nr_seq_w;

	end loop;
	close c022;

elsif (nm_tabela_p		= upper('tiss_regra_honor_spsadt')) then

	if (ie_excluir_p = 'S') then
		delete	from tiss_regra_honor_spsadt
		where	cd_convenio 		= cd_convenio_dest_p
		and	cd_estabelecimento	= cd_estab_dest_p;
	end if;

	insert into tiss_regra_honor_spsadt(
			nr_sequencia      ,
 			cd_estabelecimento ,
 			dt_atualizacao      ,
 			nm_usuario          ,
 			dt_atualizacao_nrec ,
 			nm_usuario_nrec     ,
 			cd_convenio         ,
 			ie_responsavel_credito,
 			ie_tipo_atendimento,
 			ie_prestador       ,
 			ie_exec_compl,
			ie_medico_exec	)
		SELECT	nextval('tiss_regra_honor_spsadt_seq'),
			cd_estab_dest_p,
			clock_timestamp(),
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			cd_convenio_dest_p,
 			ie_responsavel_credito,
 			ie_tipo_atendimento,
 			ie_prestador       ,
 			ie_exec_compl  ,
			ie_medico_exec
		from	tiss_regra_honor_spsadt
		where	cd_estabelecimento	= cd_estab_orig_p
		and	cd_convenio		= cd_convenio_orig_p;

elsif (nm_tabela_p	= 'TISS_REGRA_VALOR_PROC') then

	if (ie_excluir_p = 'S') then
		delete	from tiss_regra_valor_proc
		where	cd_convenio 		= cd_convenio_dest_p
		and	cd_estabelecimento	= cd_estab_dest_p;
	end if;


		insert into tiss_regra_valor_proc(
			nr_sequencia  ,
			cd_estabelecimento,
			dt_atualizacao    ,
			nm_usuario        ,
			dt_atualizacao_nrec,
			nm_usuario_nrec    ,
			cd_convenio        ,
			ie_tiss_tipo_guia  ,
			cd_cgc_prestador   ,
			ie_responsavel_credito,
			ie_regra_valor,
			cd_procedimento,
			ie_origem_proced,
			cd_area_procedimento,
			cd_especialidade,
			cd_grupo_proc,
			ie_funcao_medico,
			ie_honorario,
			ie_pacote,
			cd_plano_convenio,
			dt_fim_vigencia,
			dt_inicio_vigencia,
			ie_tipo_atendimento)
		SELECT	nextval('tiss_regra_valor_proc_seq'),
			cd_estab_dest_p,
			clock_timestamp(),
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			cd_convenio_dest_p,
			ie_tiss_tipo_guia  ,
			cd_cgc_prestador   ,
			ie_responsavel_credito,
			ie_regra_valor,
			cd_procedimento,
			ie_origem_proced,
			cd_area_procedimento,
			cd_especialidade,
			cd_grupo_proc,
			ie_funcao_medico,
			ie_honorario,
			ie_pacote,
			cd_plano_convenio,
			DT_FIM_VIGENCIA,
			DT_INICIO_VIGENCIA,
			IE_TIPO_ATENDIMENTO
		from	tiss_regra_valor_proc
		where	cd_estabelecimento	= cd_estab_orig_p
		and	cd_convenio		= cd_convenio_orig_p;

elsif (nm_tabela_p		='TISS_REGRA_GUIA_PRINC') then
	if (ie_excluir_p = 'S') then
		delete	from tiss_regra_guia_princ
		where	cd_convenio 		= cd_convenio_dest_p
		and	cd_estabelecimento	= cd_estab_dest_p;
	end if;
		insert into	tiss_regra_guia_princ(
			nr_sequencia  ,
			cd_estabelecimento,
			dt_atualizacao    ,
			nm_usuario        ,
			dt_atualizacao_nrec,
			nm_usuario_nrec    ,
			cd_convenio        ,
			ie_tiss_tipo_guia  ,
			ie_regra           ,
			ie_tipo_atendimento,
			ie_mesma_guia)
		SELECT	nextval('tiss_regra_guia_princ_seq'),
			cd_estab_dest_p,
			clock_timestamp(),
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			cd_convenio_dest_p,
			ie_tiss_tipo_guia  ,
			ie_regra           ,
			ie_tipo_atendimento,
			ie_mesma_guia
		from	tiss_regra_guia_princ
		where	cd_estabelecimento	= cd_estab_orig_p
		and	cd_convenio		= cd_convenio_orig_p;

elsif (nm_tabela_p		= 'TISS_REGRA_PRESTADOR_SOLIC') then
	if (ie_excluir_p = 'S') then
		delete	from tiss_regra_prestador_solic
		where	cd_convenio 		= cd_convenio_dest_p
		and	cd_estabelecimento	= cd_estab_dest_p;
	end if;

	insert into tiss_regra_prestador_solic(
			nr_sequencia,
			dt_atualizacao,
			nm_usuario,
			dt_atualizacao_nrec,
			nm_usuario_nrec,
			cd_estabelecimento ,
			cd_convenio,
			ie_tipo_atendimento,
			ie_clinica,
			cd_setor_entrada,
			ie_solicitante,
			cd_cgc_prestador,
			ie_autorizacao,
			cd_medico_atendimento,
			cd_medico_prest,
			cd_procedencia,
			cd_interno,
			ds_prestador_tiss,
			cd_medico_referido,
			cd_categoria,
			dt_inicio_vigencia,
			dt_fim_vigencia,
			ie_tipo_protocolo,
			ie_vinculo_medico,
			cd_medico_prescr,
			nr_seq_plano)
		SELECT	nextval('tiss_regra_prestador_solic_seq'),
			clock_timestamp(),
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			cd_estab_dest_p,
			cd_convenio_dest_p,
			ie_tipo_atendimento,
			ie_clinica,
			cd_setor_entrada,
			ie_solicitante,
			cd_cgc_prestador,
			ie_autorizacao,
			cd_medico_atendimento,
			cd_medico_prest,
			cd_procedencia,
			cd_interno,
			ds_prestador_tiss,
			cd_medico_referido,
			cd_categoria,
			dt_inicio_vigencia,
			dt_fim_vigencia,
			ie_tipo_protocolo,
			ie_vinculo_medico,
			cd_medico_prescr,
			nr_seq_plano
		from	tiss_regra_prestador_solic
		where	cd_estabelecimento	= cd_estab_orig_p
		and	cd_convenio		= cd_convenio_orig_p;

elsif (nm_tabela_p = 'TISS_REGRA_CAMPO_ESP') then

	open C023;
	loop
	fetch C023 into
		nr_seq_w;
	EXIT WHEN NOT FOUND; /* apply on C023 */
		begin

		select	nextval('tiss_regra_campo_esp_seq')
		into STRICT	nr_sequencia_w
		;

		insert	into tiss_regra_campo_esp(
			cd_area_procedimento,
			cd_cgc_prestador,
			cd_convenio,
			cd_especialidade ,
			cd_estabelecimento,
			cd_grupo_proc,
			cd_medico_executor,
			cd_procedimento,
			ds_campo,
			dt_atualizacao,
			dt_atualizacao_nrec,
			ie_guia,
			ie_origem_proced,
			ie_responsavel_credito,
			ie_tipo_atendimento,
			ie_tipo_guia,
			nm_usuario,
			nm_usuario_nrec,
			nr_sequencia,
			cd_setor_atendimento)
		SELECT	cd_area_procedimento,
			cd_cgc_prestador,
			cd_convenio_dest_p,
			cd_especialidade ,
			cd_estab_dest_p,
			cd_grupo_proc,
			cd_medico_executor,
			cd_procedimento,
			ds_campo,
			clock_timestamp(),
			clock_timestamp(),
			ie_guia,
			ie_origem_proced,
			ie_responsavel_credito,
			ie_tipo_atendimento,
			ie_tipo_guia,
			nm_usuario_p,
			nm_usuario_p,
			nr_sequencia_w,
			cd_setor_atendimento
		from	tiss_regra_campo_esp
		where	nr_sequencia = nr_seq_w;

		insert into tiss_campo_esp_compl(
			ds_anterior,
			ds_campo,
			ds_posterior,
			dt_atualizacao,
			dt_atualizacao_nrec,
			nm_usuario,
			nm_usuario_nrec,
			nr_seq_apresentacao,
			nr_seq_regra,
			nr_sequencia,
			vl_padrao)
		SELECT	ds_anterior,
			ds_campo,
			ds_posterior,
			clock_timestamp(),
			clock_timestamp(),
			nm_usuario_p,
			nm_usuario_p,
			nr_seq_apresentacao,
			nr_sequencia_w,
			nextval('tiss_campo_esp_compl_seq'),
			vl_padrao
		from	tiss_campo_esp_compl
		where	nr_seq_regra = nr_seq_w;

		insert into tiss_campo_esp_conv(
			ds_campo,
			dt_atualizacao,
			dt_atualizacao_nrec,
			nm_usuario,
			nm_usuario_nrec,
			nr_seq_regra,
			nr_sequencia,
			vl_conversao,
			vl_origem)
		SELECT	ds_campo,
			clock_timestamp(),
			clock_timestamp(),
			nm_usuario_p,
			nm_usuario_p,
			nr_sequencia_w,
			nextval('tiss_campo_esp_conv_seq'),
			vl_conversao,
			vl_origem
		from	tiss_campo_esp_conv
		where	nr_seq_regra = nr_seq_w;

		end;
	end loop;
	close C023;
elsif (nm_tabela_p = 'TISS_REGRA_PREST_EQUIPE') then

	insert	into tiss_regra_prest_equipe(
		cd_cgc_prestador,
		cd_convenio,
		cd_estabelecimento,
		cd_setor_atendimento,
		dt_atualizacao,
		dt_atualizacao_nrec,
		ie_grau_partic,
		ie_responsavel_credito,
		ie_tiss_tipo_guia,
		nm_usuario,
		nm_usuario_nrec ,
		nr_conselho,
		nr_sequencia ,
		sg_conselho,
		uf_conselho)
	SELECT	cd_cgc_prestador,
		cd_convenio_dest_p,
		cd_estab_dest_p,
		cd_setor_atendimento,
		clock_timestamp(),
		clock_timestamp(),
		ie_grau_partic,
		ie_responsavel_credito,
		ie_tiss_tipo_guia,
		nm_usuario_p,
		nm_usuario_p ,
		nr_conselho,
		nextval('tiss_regra_prest_equipe_seq') ,
		sg_conselho,
		uf_conselho
	from	tiss_regra_prest_equipe
	where	cd_estabelecimento	= cd_estab_orig_p
	and	cd_convenio		= cd_convenio_orig_p;

elsif (nm_tabela_p = 'TISS_REGRA_PARTIC_ADIC') then

	open C024;
	loop
	fetch C024 into
		nr_seq_w;
	EXIT WHEN NOT FOUND; /* apply on C024 */
		begin

		select	nextval('tiss_regra_partic_adic_seq')
		into STRICT	nr_sequencia_w
		;

		insert into tiss_regra_partic_adic(
			cd_area_procedimento,
			cd_convenio,
			cd_especialidade,
			cd_estabelecimento,
			cd_grupo_proc ,
			cd_procedimento,
			dt_atualizacao,
			dt_atualizacao_nrec,
			ie_origem_proced,
			ie_responsavel_credito,
			ie_tiss_tipo_guia,
			nm_usuario,
			nm_usuario_nrec,
			nr_sequencia)
		SELECT	cd_area_procedimento,
			cd_convenio_dest_p,
			cd_especialidade,
			cd_estab_dest_p,
			cd_grupo_proc ,
			cd_procedimento,
			clock_timestamp(),
			clock_timestamp(),
			ie_origem_proced,
			ie_responsavel_credito,
			ie_tiss_tipo_guia,
			nm_usuario_p,
			nm_usuario_p,
			nr_sequencia_w
		from	tiss_regra_partic_adic
		where	nr_sequencia = nr_seq_w;


		insert into	tiss_partic_adic(
			cd_cbos,
			cd_interno,
			dt_atualizacao,
			dt_atualizacao_nrec,
			ie_funcao,
			ie_medico_atend,
			nm_participante,
			nm_usuario,
			nm_usuario_nrec,
			nr_cpf,
			nr_crm,
			nr_seq_regra,
			nr_sequencia,
			sg_conselho,
			uf_crm)
		SELECT	cd_cbos,
			cd_interno,
			dt_atualizacao,
			dt_atualizacao_nrec,
			ie_funcao,
			ie_medico_atend,
			nm_participante,
			nm_usuario_p,
			nm_usuario_p,
			nr_cpf,
			nr_crm,
			nr_sequencia_w,
			nextval('tiss_partic_adic_seq'),
			sg_conselho,
			uf_crm
		from	tiss_partic_adic
		where	nr_seq_regra = nr_seq_w;

		end;
	end loop;
	close C024;
elsif (nm_tabela_p = 'TISS_REGRA_ARQUIVO_ADIC') then

	open C025;
	loop
	fetch C025 into
		nr_seq_w;
	EXIT WHEN NOT FOUND; /* apply on C025 */
		begin

		select	nextval('tiss_regra_arquivo_adic_seq')
		into STRICT	nr_sequencia_w
		;

		insert into tiss_regra_arquivo_adic(
			cd_cgc,
			cd_convenio,
			cd_estabelecimento,
			cd_interno,
			dt_atualizacao,
			dt_atualizacao_nrec,
			ie_tiss_tipo_guia,
			nm_usuario,
			nm_usuario_nrec,
			nr_sequencia)
		SELECT	cd_cgc,
			cd_convenio_dest_p,
			cd_estab_dest_p,
			cd_interno,
			clock_timestamp(),
			clock_timestamp(),
			ie_tiss_tipo_guia,
			nm_usuario_p,
			nm_usuario_p,
			nr_sequencia_w
		from	tiss_regra_arquivo_adic
		where	nr_sequencia = nr_seq_w;


		insert 	into tiss_regra_arq_adic_crit(
			cd_cgc,
			cd_cgc_compl,
			cd_interno,
			cd_interno_compl,
			cd_interno_honor,
			dt_atualizacao,
			dt_atualizacao_nrec,
			nm_usuario,
			nm_usuario_nrec,
			nr_cpf_honor,
			nr_seq_regra,
			nr_sequencia)
		SELECT	cd_cgc,
			cd_cgc_compl,
			cd_interno,
			cd_interno_compl,
			cd_interno_honor,
			clock_timestamp(),
			clock_timestamp(),
			nm_usuario_p,
			nm_usuario_p,
			nr_cpf_honor,
			nr_sequencia_w,
			nextval('tiss_regra_arq_adic_crit_seq')
		from	tiss_regra_arq_adic_crit
		where	nr_seq_regra =  nr_seq_w;

		end;
	end loop;
	close C025;
elsif (nm_tabela_p = 'TISS_REGRA_AGRUP') then

	insert into  tiss_regra_agrup(
		cd_area_procedimento,
		cd_convenio,
		cd_especialidade,
		cd_estabelecimento,
		cd_grupo_proc,
		cd_procedimento,
		dt_atualizacao,
		dt_atualizacao_nrec,
		ie_agrupar,
		ie_origem_proced ,
		nm_usuario,
		nm_usuario_nrec,
		nr_sequencia)
	SELECT	cd_area_procedimento,
		cd_convenio_dest_p,
		cd_especialidade,
		cd_estab_dest_p,
		cd_grupo_proc,
		cd_procedimento,
		clock_timestamp(),
		clock_timestamp(),
		ie_agrupar,
		ie_origem_proced ,
		nm_usuario_p,
		nm_usuario_p,
		nextval('tiss_regra_agrup_seq')
	from	tiss_regra_agrup
	where	cd_estabelecimento	= cd_estab_orig_p
	and	cd_convenio		= cd_convenio_orig_p;
elsif (nm_tabela_p = 'TISS_REGRA_PROC_XML') then

	insert into tiss_regra_proc_xml(
		cd_area_procedimento,
		cd_convenio,
		cd_especialidade,
		cd_estabelecimento,
		cd_grupo_proc,
		cd_procedimento,
		dt_atualizacao,
		dt_atualizacao_nrec,
		ie_enviar_xml,
		ie_origem_proced,
		ie_responsavel_credito,
		ie_tiss_tipo_guia,
		nm_usuario,
		nm_usuario_nrec,
		nr_sequencia)
	SELECT	cd_area_procedimento,
		cd_convenio_dest_p,
		cd_especialidade,
		cd_estab_dest_p,
		cd_grupo_proc,
		cd_procedimento,
		clock_timestamp(),
		clock_timestamp(),
		ie_enviar_xml,
		ie_origem_proced,
		ie_responsavel_credito,
		ie_tiss_tipo_guia,
		nm_usuario_p,
		nm_usuario_p,
		nextval('tiss_regra_proc_xml_seq')
	from	tiss_regra_proc_xml
	where	cd_estabelecimento	= cd_estab_orig_p
	and	cd_convenio		= cd_convenio_orig_p;

elsif (nm_tabela_p = 'TISS_REGRA_MAT_OPM') then
	if (ie_excluir_p = 'S') then
		delete	from tiss_regra_mat_opm
		where	cd_convenio = cd_convenio_dest_p
		and	cd_estabelecimento	= cd_estab_dest_p;
	end if;

	insert into tiss_regra_mat_opm(
		cd_classe_material,
		cd_convenio,
		cd_estabelecimento,
		cd_grupo_material,
		cd_material,
		cd_subgrupo_material,
		dt_atualizacao,
		dt_atualizacao_nrec,
		ie_opm,
		ie_tipo_atendimento,
		nm_usuario,
		nm_usuario_nrec,
		nr_sequencia,
		vl_material_max,
		vl_material_min)
	SELECT	cd_classe_material,
		cd_convenio_dest_p,
		cd_estab_dest_p,
		cd_grupo_material,
		cd_material,
		cd_subgrupo_material,
		clock_timestamp(),
		clock_timestamp(),
		ie_opm,
		ie_tipo_atendimento,
		nm_usuario_p,
		nm_usuario_p,
		nextval('tiss_regra_mat_opm_seq'),
		vl_material_max,
		vl_material_min
	from	tiss_regra_mat_opm
	where	cd_estabelecimento	= cd_estab_orig_p
	and	cd_convenio		= cd_convenio_orig_p;

end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE tiss_copia_param_convenio ( cd_convenio_orig_p bigint, cd_estab_orig_p bigint, cd_convenio_dest_p bigint, cd_estab_dest_p bigint, nm_tabela_p text, nm_usuario_p text, ie_excluir_p text) FROM PUBLIC;

