-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_analise_ortografica ( ds_lista_tabela_p text, dt_inicial_p timestamp, dt_final_p timestamp, ds_lista_usuario_p text, nr_seq_gerencia_p bigint, nr_seq_grupo_p bigint, nm_usuario_p text, ie_function_p text, nr_seq_lote_p INOUT bigint) AS $body$
DECLARE


/*

ie_function_p

	S	- Considerar atributos do tipo FUNCTION ou scripts
	N	- Desconsiderar atributos do tipo FUNCTION e scripts

*/
ds_lista_tabela_w		varchar(2000);

nm_tabela_origem_w		varchar(50);
nr_sequencia_w			bigint;
dt_inicial_w			timestamp;
dt_final_w			timestamp;
nr_seq_lote_w			bigint;
dt_origem_w			timestamp;

nm_usuario_origem_w		varchar(15);
ie_tipo_atributo_w		varchar(10);
ie_componente_w			varchar(5);

nm_tabela_w			varchar(50);
nm_atributo_w			varchar(50);
nr_seq_visao_w			bigint;
nr_seq_objeto_w			bigint;
nr_seq_obj_filtro_w		bigint;
nr_seq_cor_w			bigint;
cd_dominio_w			integer;
vl_dominio_w			varchar(15);
cd_funcao_w			integer;
nr_seq_parametro_w		integer;
nr_seq_relatorio_w		bigint;
nr_seq_campo_relat_w		bigint;
nr_seq_param_relat_w		bigint;
nr_seq_ind_gestao_w		indicador_gestao.nr_sequencia%type;
nr_seq_ind_gestao_atrib_w	indicador_gestao_atrib.nr_sequencia%type;
nr_seq_subind_gestao_w		subindicador_gestao.nr_sequencia%type;
nr_seq_subind_gestao_atrib_w	subindicador_gestao_atrib.nr_sequencia%type;
cd_interface_w			interface.cd_interface%type;
nr_seq_referencia_w		bigint;
cd_tipo_lote_contabil_w		tipo_lote_contabil.cd_tipo_lote_contabil%type;

sql_errm_w			varchar(255);
qt_analise_w			bigint;

ds_campo_w			varchar(255);
ds_conteudo_campo_w		varchar(4000);
cd_expressao_w			dic_expressao.cd_expressao%type;
nr_seq_idioma_w			bigint;

c01 CURSOR FOR
SELECT	a.nm_tabela,
	a.nm_atributo,
	a.nm_usuario,
	a.dt_atualizacao,
	a.ie_componente,
	a.ie_tipo_atributo
from	tabela_atributo a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c02 CURSOR FOR
SELECT	b.nm_tabela,
	a.nm_atributo,
	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	a.ie_componente,
	c.ie_tipo_atributo
from	tabela_atributo c,
	tabela_visao b,
	tabela_visao_atributo a
where	c.nm_atributo		= a.nm_atributo
and	b.nm_tabela		= c.nm_tabela
and	a.nr_sequencia		= b.nr_sequencia
and (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c03 CURSOR FOR
SELECT	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao
from	dic_objeto a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c04 CURSOR FOR
SELECT	a.nr_seq_objeto,
	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao
from	dic_objeto_filtro a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c05 CURSOR FOR
SELECT	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao
from	tasy_padrao_cor a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c06 CURSOR FOR
SELECT	a.cd_dominio,
	a.vl_dominio,
	a.nm_usuario,
	a.dt_atualizacao
from	valor_dominio_v a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c07 CURSOR FOR
SELECT	a.cd_funcao,
	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao
from	funcao_parametro a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c08 CURSOR FOR
SELECT	a.nr_sequencia nr_seq_relatorio,
	a.nm_usuario,
	a.dt_atualizacao
from	relatorio a
where	substr(coalesce(a.cd_classif_relat,'X'),1,1)	= 'W'
and (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c09 CURSOR FOR
SELECT	c.nr_sequencia nr_seq_relatorio,
	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao
from	relatorio c,
	banda_relatorio b,
	banda_relat_campo a
where	substr(coalesce(c.cd_classif_relat,'X'),1,1)	= 'W'
and	b.nr_seq_relatorio	= c.nr_sequencia
and	a.nr_seq_banda		= b.nr_sequencia
and (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c10 CURSOR FOR
SELECT	b.nr_sequencia nr_seq_relatorio,
	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao
from	relatorio b,
	relatorio_parametro a
where	substr(coalesce(b.cd_classif_relat,'X'),1,1)	= 'W'
and	a.nr_seq_relatorio	= b.nr_sequencia
and (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c11 CURSOR FOR
SELECT	b.ds_campo
from	analise_ort_regra_campo b,
	analise_ortografica_regra a
where	('S' = coalesce(ie_function_p,'N') or (b.ds_campo <> 'DS_VALORES') or (ie_tipo_atributo_w <> 'FUNCTION' AND ie_componente_w <> 'lcb'))
and	a.nr_sequencia	= b.nr_seq_regra
and	a.ie_origem	= 'T'
and	a.ds_origem	= nm_tabela_origem_w;

c12 CURSOR FOR
SELECT	a.cd_dominio,
	a.nm_usuario,
	a.dt_atualizacao
from	dominio a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c13 CURSOR FOR
SELECT	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao
from	indicador_gestao a
where	coalesce(a.nr_seq_wheb,0)	<> 0
and (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c14 CURSOR FOR
SELECT	a.nr_seq_ind_gestao,
	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao
from	indicador_gestao b,
	indicador_gestao_atrib a
where	coalesce(b.nr_seq_wheb,0)	<> 0
and	a.nr_seq_ind_gestao	= b.nr_sequencia
and (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c15 CURSOR FOR
SELECT	a.nr_seq_indicador,
	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao
from	indicador_gestao b,
	subindicador_gestao a
where	coalesce(b.nr_seq_wheb,0)	<> 0
and	a.nr_seq_indicador	= b.nr_sequencia
and (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c16 CURSOR FOR
SELECT	a.nr_seq_subindicador,
	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao
from	indicador_gestao c,
	subindicador_gestao b,
	subindicador_gestao_atrib a
where	coalesce(c.nr_seq_wheb,0)	<> 0
and	b.nr_seq_indicador	= c.nr_sequencia
and	a.nr_seq_subindicador	= b.nr_sequencia
and (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c17 CURSOR FOR
SELECT	a.cd_interface,
	a.nm_usuario,
	a.dt_atualizacao
from	interface a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c18 CURSOR FOR
SELECT	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'ANVISA_FORMA_FORMACEUTICA' nm_tabela_origem
from	anvisa_forma_formaceutica a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', ANVISA_FORMA_FORMACEUTICA,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'ANVISA_VIA_ADMINISTRACAO' nm_tabela_origem
from	anvisa_via_administracao a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', ANVISA_VIA_ADMINISTRACAO,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'CLASSIFICACAO_PARAMETRO' nm_tabela_origem
from	classificacao_parametro a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', CLASSIFICACAO_PARAMETRO,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'CONSISTENCIA_LIB_PEPO' nm_tabela_origem
from	consistencia_lib_pepo a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', CONSISTENCIA_LIB_PEPO,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'EHR_ARQUETIPO' nm_tabela_origem
from	ehr_arquetipo a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', EHR_ARQUETIPO,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'EHR_CEFALOCAUDAL' nm_tabela_origem
from	ehr_cefalocaudal a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', EHR_CEFALOCAUDAL,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'EHR_DOENCA' nm_tabela_origem
from	ehr_doenca a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', EHR_DOENCA,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'EHR_ELEMENTO' nm_tabela_origem
from	ehr_elemento a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', EHR_ELEMENTO,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'EHR_ELEMENTO_VISUAL' nm_tabela_origem
from	ehr_elemento_visual a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', EHR_ELEMENTO_VISUAL,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'EHR_ENTIDADE_TASY' nm_tabela_origem
from	ehr_entidade_tasy a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', EHR_ENTIDADE_TASY,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'EHR_ESPECIALIDADE' nm_tabela_origem
from	ehr_especialidade a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', EHR_ESPECIALIDADE,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'EHR_GRUPO_ELEMENTO' nm_tabela_origem
from	ehr_grupo_elemento a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', EHR_GRUPO_ELEMENTO,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'EHR_SUBGRUPO_ELEMENTO' nm_tabela_origem
from	ehr_subgrupo_elemento a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', EHR_SUBGRUPO_ELEMENTO,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'EHR_UNIDADE_MEDIDA' nm_tabela_origem
from	ehr_unidade_medida a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', EHR_UNIDADE_MEDIDA,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'FANEP_ITEM' nm_tabela_origem
from	fanep_item a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', FANEP_ITEM,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'FICHA_FINANC_ITEM' nm_tabela_origem
from	ficha_financ_item a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', FICHA_FINANC_ITEM,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'INCONSISTENCIA' nm_tabela_origem
from	inconsistencia a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', INCONSISTENCIA,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'INCONSISTENCIA_ESCRIT' nm_tabela_origem
from	inconsistencia_escrit a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', INCONSISTENCIA_ESCRIT,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'MAN_SEVERIDADE' nm_tabela_origem
from	man_severidade a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', MAN_SEVERIDADE,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'OFT_ACAO' nm_tabela_origem
from	oft_acao a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', OFT_ACAO,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'OFTALMOLOGIA_ITEM' nm_tabela_origem
from	oftalmologia_item a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', OFTALMOLOGIA_ITEM,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'PEP_ACAO' nm_tabela_origem
from	pep_acao a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', PEP_ACAO,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'PEPO_ACAO' nm_tabela_origem
from	pepo_acao a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', PEPO_ACAO,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'PEPO_ITEM' nm_tabela_origem
from	pepo_item a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', PEPO_ITEM,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'PERGUNTA_RECUP_SENHA' nm_tabela_origem
from	pergunta_recup_senha a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', PERGUNTA_RECUP_SENHA,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'PRONTUARIO_ITEM' nm_tabela_origem
from	prontuario_item a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', PRONTUARIO_ITEM,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'PRONTUARIO_PASTA' nm_tabela_origem
from	prontuario_pasta a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', PRONTUARIO_PASTA,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'REGRA_CONSISTE_ONC' nm_tabela_origem
from	regra_consiste_onc a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', REGRA_CONSISTE_ONC,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'REGRA_CONSISTE_PRESCR' nm_tabela_origem
from	regra_consiste_prescr a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', REGRA_CONSISTE_PRESCR,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'REGRA_CONSISTE_SAE' nm_tabela_origem
from	regra_consiste_sae a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', REGRA_CONSISTE_SAE,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'SAEP_ITEM' nm_tabela_origem
from	saep_item a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', SAEP_ITEM,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'SAME_OPERACAO' nm_tabela_origem
from	same_operacao a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', SAME_OPERACAO,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'TIPO_AMPUTACAO' nm_tabela_origem
from	tipo_amputacao a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', TIPO_AMPUTACAO,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'TIPO_LOCALIZAR' nm_tabela_origem
from	tipo_localizar a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', TIPO_LOCALIZAR,' in ds_lista_tabela_w) > 0)

union all

select	a.nr_sequencia,
	a.nm_usuario,
	a.dt_atualizacao,
	'TIPO_LOCALIZAR_ATRIBUTO' nm_tabela_origem
from	tipo_localizar_atributo a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w
and (coalesce(ds_lista_tabela_p::text, '') = '' or position(', TIPO_LOCALIZAR_ATRIBUTO,' in ds_lista_tabela_w) > 0);

c19 CURSOR FOR
SELECT	a.cd_funcao,
	a.nm_usuario,
	a.dt_atualizacao
from	funcao a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c20 CURSOR FOR
SELECT	a.cd_tipo_lote_contabil,
	a.nm_usuario,
	a.dt_atualizacao
from	tipo_lote_contabil a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;

c21 CURSOR FOR
SELECT	a.cd_expressao,
	a.nm_usuario,
	a.dt_atualizacao
from	dic_expressao a
where (coalesce(nr_seq_grupo_p,0) = 0 or substr(obter_se_usuario_grupo_des(a.nm_usuario,nr_seq_grupo_p),1,1) = 'S')
and (coalesce(nr_seq_gerencia_p,0) = 0 or substr(obter_se_usuario_gerencia(a.nm_usuario,nr_seq_gerencia_p),1,1) = 'S')
and (coalesce(ds_lista_usuario_p::text, '') = '' or ',' || ds_lista_usuario_p || ',' like '%, ' || a.nm_usuario || ',%')
and	a.dt_atualizacao	between dt_inicial_w and dt_final_w;


BEGIN

ds_lista_tabela_w	:= ', ' || replace(trim(both ds_lista_tabela_p),chr(39),null) || ',';

select	max(a.nr_sequencia)
into STRICT	nr_sequencia_w
from	analise_ortografica a;

select	coalesce(max(a.nr_sequencia),0) + 1
into STRICT	nr_seq_lote_w
from	analise_ortografica_lote a;

dt_inicial_w	:= trunc(dt_inicial_p,'dd');
dt_final_w	:= fim_dia(dt_final_p);

nr_seq_lote_w := gerar_analise_ortografica_lote(null, nm_usuario_p, null, clock_timestamp(), null, ie_function_p, 'N', 'BD', nr_seq_lote_w);

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', TABELA_ATRIBUTO,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'TABELA_ATRIBUTO';

	open	c01;
	loop
	fetch	c01 into
		nm_tabela_w,
		nm_atributo_w,
		nm_usuario_origem_w,
		dt_origem_w,
		ie_componente_w,
		ie_tipo_atributo_w;
	EXIT WHEN NOT FOUND; /* apply on c01 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.nm_atributo		= nm_atributo_w
		and	a.nm_tabela		= nm_tabela_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from tabela_atributo' ||
							' where nm_atributo = :nm_atributo_param and nm_tabela = :nm_tabela_param', 'nm_atributo_param=' || nm_atributo_w || ';nm_tabela_param=' || nm_tabela_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_atributo,
					nm_tabela_origem,
					nm_tabela,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_lote,
					nr_sequencia)
				values (ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_atributo_w,
					nm_tabela_origem_w,
					nm_tabela_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_lote_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c01;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', TABELA_VISAO_ATRIBUTO,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'TABELA_VISAO_ATRIBUTO';

	open	c02;
	loop
	fetch	c02 into
		nm_tabela_w,
		nm_atributo_w,
		nr_seq_visao_w,
		nm_usuario_origem_w,
		dt_origem_w,
		ie_componente_w,
		ie_tipo_atributo_w;
	EXIT WHEN NOT FOUND; /* apply on c02 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.nr_seq_visao		= nr_seq_visao_w
		and	a.nm_atributo		= nm_atributo_w
		and	a.nm_tabela		= nm_tabela_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from tabela_visao_atributo' ||
							' where nm_atributo = :nm_atributo_param and nr_sequencia = :nr_seq_visao', 'nm_atributo_param=' || nm_atributo_w || ';nr_seq_visao=' || nr_seq_visao_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_atributo,
					nm_tabela_origem,
					nm_tabela,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_lote,
					nr_seq_visao,
					nr_sequencia)
				values (ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_atributo_w,
					nm_tabela_origem_w,
					nm_tabela_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_lote_w,
					nr_seq_visao_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c02;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', DIC_OBJETO,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'DIC_OBJETO';

	open	c03;
	loop
	fetch	c03 into
		nr_seq_objeto_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c03 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.nr_seq_objeto		= nr_seq_objeto_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from dic_objeto' ||
							' where nr_sequencia = :nr_seq_objeto', 'nr_seq_objeto=' || nr_seq_objeto_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_lote,
					nr_seq_objeto,
					nr_sequencia)
				values (ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_lote_w,
					nr_seq_objeto_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c03;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', DIC_OBJETO_FILTRO,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'DIC_OBJETO_FILTRO';

	open	c04;
	loop
	fetch	c04 into
		nr_seq_objeto_w,
		nr_seq_obj_filtro_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c04 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.nr_seq_obj_filtro	= nr_seq_obj_filtro_w
		and	a.nr_seq_objeto		= nr_seq_objeto_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from dic_objeto_filtro' ||
							' where nr_sequencia = :nr_seq_obj_filtro and nr_seq_objeto = :nr_seq_objeto', 'nr_seq_obj_filtro=' || nr_seq_obj_filtro_w || ';nr_seq_objeto=' || nr_seq_objeto_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_lote,
					nr_seq_obj_filtro,
					nr_seq_objeto,
					nr_sequencia)
				values (ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_lote_w,
					nr_seq_obj_filtro_w,
					nr_seq_objeto_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c04;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', TASY_PADRAO_COR,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'TASY_PADRAO_COR';

	open	c05;
	loop
	fetch	c05 into
		nr_seq_cor_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c05 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.nr_seq_cor		= nr_seq_cor_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from tasy_padrao_cor' ||
							' where nr_sequencia = :nr_seq_cor', 'nr_seq_cor=' || nr_seq_cor_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_cor,
					nr_seq_lote,
					nr_sequencia)
				values (ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_cor_w,
					nr_seq_lote_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c05;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', VALOR_DOMINIO_V,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'VALOR_DOMINIO_V';

	open	c06;
	loop
	fetch	c06 into
		cd_dominio_w,
		vl_dominio_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c06 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.vl_dominio		= vl_dominio_w
		and	a.cd_dominio		= cd_dominio_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from valor_dominio' ||
							' where vl_dominio = :vl_dominio and cd_dominio = :cd_dominio', 'vl_dominio=' || vl_dominio_w || ';cd_dominio=' || cd_dominio_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(cd_dominio,
					ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_lote,
					nr_sequencia,
					vl_dominio)
				values (cd_dominio_w,
					ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_lote_w,
					nr_sequencia_w,
					vl_dominio_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c06;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', FUNCAO_PARAMETRO,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'FUNCAO_PARAMETRO';

	open	c07;
	loop
	fetch	c07 into
		cd_funcao_w,
		nr_seq_parametro_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c07 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.cd_funcao		= cd_funcao_w
		and	a.nr_seq_parametro	= nr_seq_parametro_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from funcao_parametro' ||
							' where cd_funcao = :cd_funcao and nr_sequencia = :nr_seq_parametro', 'cd_funcao=' || cd_funcao_w || ';nr_seq_parametro=' || nr_seq_parametro_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(cd_funcao,
					ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_lote,
					nr_seq_parametro,
					nr_sequencia)
				values (cd_funcao_w,
					ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_lote_w,
					nr_seq_parametro_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c07;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', RELATORIO,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'RELATORIO';

	open	c08;
	loop
	fetch	c08 into
		nr_seq_relatorio_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c08 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.nr_seq_relatorio	= nr_seq_relatorio_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from relatorio' ||
							' where nr_sequencia = :nr_seq_relatorio', 'nr_seq_relatorio=' || nr_seq_relatorio_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_lote,
					nr_seq_relatorio,
					nr_sequencia)
				values (ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_lote_w,
					nr_seq_relatorio_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c08;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', BANDA_RELAT_CAMPO,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'BANDA_RELAT_CAMPO';

	open	c09;
	loop
	fetch	c09 into
		nr_seq_relatorio_w,
		nr_seq_campo_relat_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c09 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.nr_seq_relatorio	= nr_seq_relatorio_w
		and	a.nr_seq_campo_relat	= nr_seq_campo_relat_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(b.' || ds_campo_w || ')' ||
							' from banda_relat_campo b, banda_relatorio a' ||
							' where b.nr_sequencia = :nr_seq_campo_relat and a.nr_sequencia = b.nr_seq_banda and a.nr_seq_relatorio = :nr_seq_relatorio', 'nr_seq_campo_relat=' || nr_seq_campo_relat_w || ';nr_seq_relatorio=' || nr_seq_relatorio_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_campo_relat,
					nr_seq_lote,
					nr_seq_relatorio,
					nr_sequencia)
				values (ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_campo_relat_w,
					nr_seq_lote_w,
					nr_seq_relatorio_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c09;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', RELATORIO_PARAMETRO,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'RELATORIO_PARAMETRO';

	open	c10;
	loop
	fetch	c10 into
		nr_seq_relatorio_w,
		nr_seq_param_relat_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c10 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.nr_seq_relatorio	= nr_seq_relatorio_w
		and	a.nr_seq_param_relat	= nr_seq_param_relat_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from relatorio_parametro' ||
							' where nr_sequencia = :nr_seq_param_relat and nr_seq_relatorio = :nr_seq_relatorio', 'nr_seq_param_relat=' || nr_seq_param_relat_w || ';nr_seq_relatorio=' || nr_seq_relatorio_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_lote,
					nr_seq_param_relat,
					nr_seq_relatorio,
					nr_sequencia)
				values (ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_lote_w,
					nr_seq_param_relat_w,
					nr_seq_relatorio_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c10;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', DOMINIO,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'DOMINIO';

	open	c12;
	loop
	fetch	c12 into
		cd_dominio_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c12 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.cd_dominio		= cd_dominio_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from dominio' ||
							' where cd_dominio = :cd_dominio', 'cd_dominio=' || cd_dominio_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(cd_dominio,
					ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_lote,
					nr_sequencia)
				values (cd_dominio_w,
					ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_lote_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c12;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', INDICADOR_GESTAO,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'INDICADOR_GESTAO';

	open	c13;
	loop
	fetch	c13 into
		nr_seq_ind_gestao_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c13 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.nr_seq_ind_gestao	= nr_seq_ind_gestao_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from indicador_gestao' ||
							' where nr_sequencia = :nr_seq_ind_gestao', 'nr_seq_ind_gestao=' || nr_seq_ind_gestao_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_ind_gestao,
					nr_seq_lote,
					nr_sequencia)
				values (ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_ind_gestao_w,
					nr_seq_lote_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c13;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', INDICADOR_GESTAO_ATRIB,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'INDICADOR_GESTAO_ATRIB';

	open	c14;
	loop
	fetch	c14 into
		nr_seq_ind_gestao_w,
		nr_seq_ind_gestao_atrib_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c14 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.nr_seq_ind_gestao_atrib	= nr_seq_ind_gestao_atrib_w
		and	a.nr_seq_ind_gestao		= nr_seq_ind_gestao_w
		and	a.nm_tabela_origem		= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from indicador_gestao_atrib' ||
							' where nr_sequencia = :nr_seq_ind_gestao_atrib' ||
							' and nr_seq_ind_gestao = :nr_seq_ind_gestao', 'nr_seq_ind_gestao=' || nr_seq_ind_gestao_w || ';nr_seq_ind_gestao_atrib=' || nr_seq_ind_gestao_atrib_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_ind_gestao,
					nr_seq_ind_gestao_atrib,
					nr_seq_lote,
					nr_sequencia)
				values (ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_ind_gestao_w,
					nr_seq_ind_gestao_atrib_w,
					nr_seq_lote_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c14;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', SUBINDICADOR_GESTAO,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'SUBINDICADOR_GESTAO';

	open	c15;
	loop
	fetch	c15 into
		nr_seq_ind_gestao_w,
		nr_seq_subind_gestao_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c15 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.nr_seq_subind_gestao		= nr_seq_subind_gestao_w
		and	a.nr_seq_ind_gestao		= nr_seq_ind_gestao_w
		and	a.nm_tabela_origem		= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from subindicador_gestao' ||
							' where nr_sequencia = :nr_seq_subind_gestao' ||
							' and nr_seq_indicador = :nr_seq_ind_gestao', 'nr_seq_ind_gestao=' || nr_seq_ind_gestao_w || ';nr_seq_subind_gestao=' || nr_seq_subind_gestao_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_ind_gestao,
					nr_seq_subind_gestao,
					nr_seq_lote,
					nr_sequencia)
				values (ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_ind_gestao_w,
					nr_seq_subind_gestao_w,
					nr_seq_lote_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c15;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', SUBINDICADOR_GESTAO_ATRIB,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'SUBINDICADOR_GESTAO_ATRIB';

	open	c16;
	loop
	fetch	c16 into
		nr_seq_subind_gestao_w,
		nr_seq_subind_gestao_atrib_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c16 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.nr_seq_subind_gestao		= nr_seq_subind_gestao_w
		and	a.nr_seq_subind_gestao_atrib	= nr_seq_subind_gestao_atrib_w
		and	a.nm_tabela_origem		= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from subindicador_gestao_atrib' ||
							' where nr_sequencia = :nr_seq_subind_gestao_atrib' ||
							' and nr_seq_subindicador = :nr_seq_subind_gestao', 'nr_seq_subind_gestao=' || nr_seq_subind_gestao_w || ';nr_seq_subind_gestao_atrib=' || nr_seq_subind_gestao_atrib_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_subind_gestao,
					nr_seq_subind_gestao_atrib,
					nr_seq_lote,
					nr_sequencia)
				values (ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_subind_gestao_w,
					nr_seq_subind_gestao_atrib_w,
					nr_seq_lote_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c16;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', INTERFACE,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'INTERFACE';

	open	c17;
	loop
	fetch	c17 into
		cd_interface_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c17 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.cd_interface		= cd_interface_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from interface' ||
							' where cd_interface = :cd_interface', 'cd_interface=' || cd_interface_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(cd_interface,
					ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_lote,
					nr_sequencia)
				values (cd_interface_w,
					ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_lote_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c17;

end if;

open	c18;
loop
fetch	c18 into
	nr_seq_referencia_w,
	nm_usuario_origem_w,
	dt_origem_w,
	nm_tabela_origem_w;
EXIT WHEN NOT FOUND; /* apply on c18 */

	/* excluir para não gerar registros duplicados */

	delete	from analise_ortografica a
	where	a.nr_seq_referencia	= nr_seq_referencia_w
	and	a.nm_tabela_origem	= nm_tabela_origem_w
	and	exists (SELECT	1
		from	analise_ortografica_lote x
		where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
		and	coalesce(x.dt_confirmacao::text, '') = ''
		and	x.nr_sequencia		= a.nr_seq_lote)
	and	not exists (select	1
		from	analise_ortografica_lote y,
			analise_ortografica x
		where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
		and	x.nr_seq_lote		= y.nr_sequencia
		and	x.nr_seq_origem		= a.nr_sequencia);

	open	c11;
	loop
	fetch	c11 into
		ds_campo_w;
	EXIT WHEN NOT FOUND; /* apply on c11 */

		ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
						' from ' || nm_tabela_origem_w ||
						' where nr_sequencia = :nr_seq_referencia', 'nr_seq_referencia=' || nr_seq_referencia_w || ';', ds_conteudo_campo_w);

		if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

			nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

			insert	into analise_ortografica(ds_campo,
				ds_conteudo_campo,
				dt_atualizacao,
				dt_atualizacao_nrec,
				dt_origem,
				ie_origem,
				nm_tabela_origem,
				nm_usuario,
				nm_usuario_nrec,
				nm_usuario_origem,
				nr_seq_lote,
				nr_seq_referencia,
				nr_sequencia)
			values (ds_campo_w,
				ds_conteudo_campo_w,
				clock_timestamp(),
				clock_timestamp(),
				dt_origem_w,
				'U',
				nm_tabela_origem_w,
				nm_usuario_p,
				nm_usuario_p,
				nm_usuario_origem_w,
				nr_seq_lote_w,
				nr_seq_referencia_w,
				nr_sequencia_w);

		end if;

	end	loop;
	close	c11;

end	loop;
close	c18;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', FUNCAO,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'FUNCAO';

	open	c19;
	loop
	fetch	c19 into
		cd_funcao_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c19 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.cd_funcao		= cd_funcao_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from funcao' ||
							' where cd_funcao = :cd_funcao', 'cd_funcao=' || cd_funcao_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(cd_funcao,
					ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_lote,
					nr_sequencia)
				values (cd_funcao_w,
					ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_lote_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c19;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', TIPO_LOTE_CONTABIL,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'TIPO_LOTE_CONTABIL';

	open	c20;
	loop
	fetch	c20 into
		cd_tipo_lote_contabil_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c20 */

		/* excluir para não gerar registros duplicados */

		delete	from analise_ortografica a
		where	a.cd_tipo_lote_contabil	= cd_tipo_lote_contabil_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from tipo_lote_contabil' ||
							' where cd_tipo_lote_contabil = :cd_tipo_lote_contabil', 'cd_tipo_lote_contabil=' || cd_tipo_lote_contabil_w || ';', ds_conteudo_campo_w);

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(cd_tipo_lote_contabil,
					ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_lote,
					nr_sequencia)
				values (cd_tipo_lote_contabil_w,
					ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_lote_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end	loop;
	close	c20;

end if;

if (coalesce(ds_lista_tabela_p::text, '') = '') or (position(', DIC_EXPRESSAO,' in ds_lista_tabela_w)	> 0) then

	nm_tabela_origem_w	:= 'DIC_EXPRESSAO';

	open c21;
	loop
	fetch c21 into
		cd_expressao_w,
		nm_usuario_origem_w,
		dt_origem_w;
	EXIT WHEN NOT FOUND; /* apply on c21 */

		delete	from analise_ortografica a
		where	a.cd_expressao		= cd_expressao_w
		and	a.nm_tabela_origem	= nm_tabela_origem_w
		and	exists (SELECT	1
			from	analise_ortografica_lote x
			where	(x.dt_analise IS NOT NULL AND x.dt_analise::text <> '')
			and	coalesce(x.dt_confirmacao::text, '') = ''
			and	x.nr_sequencia		= a.nr_seq_lote)
		and	not exists (select	1
			from	analise_ortografica_lote y,
				analise_ortografica x
			where	(y.dt_confirmacao IS NOT NULL AND y.dt_confirmacao::text <> '')
			and	x.nr_seq_lote		= y.nr_sequencia
			and	x.nr_seq_origem		= a.nr_sequencia);

		open	c11;
		loop
		fetch	c11 into
			ds_campo_w;
		EXIT WHEN NOT FOUND; /* apply on c11 */

			nr_seq_idioma_w	:= null;
			if (ds_campo_w	= 'DS_EXPRESSAO_BR') then
				nr_seq_idioma_w	:= 1;
			elsif (ds_campo_w	= 'DS_EXPRESSAO_MX') then
				nr_seq_idioma_w	:= 2;
			elsif (ds_campo_w	= 'DS_EXPRESSAO_US') then
				nr_seq_idioma_w	:= 5;
			elsif (ds_campo_w	= 'DS_EXPRESSAO_DE') then
				nr_seq_idioma_w	:= 7;
			end if;


			if (nr_seq_idioma_w IS NOT NULL AND nr_seq_idioma_w::text <> '') then
				ds_conteudo_campo_w	:= obter_desc_expressao_idioma(cd_expressao_w,null,nr_seq_idioma_w);
			else

				ds_conteudo_campo_w := obter_valor_dinamico_4000_bv(	'select max(' || ds_campo_w || ')' ||
							' from dic_expressao' ||
							' where cd_expressao = :cd_expressao', 'cd_expressao=' || cd_expressao_w || ';', ds_conteudo_campo_w);
			end if;

			if ((trim(both ds_conteudo_campo_w) IS NOT NULL AND (trim(both ds_conteudo_campo_w))::text <> '')) then

				nr_sequencia_w	:= coalesce(nr_sequencia_w,0) + 1;

				insert	into analise_ortografica(cd_expressao,
					ds_campo,
					ds_conteudo_campo,
					dt_atualizacao,
					dt_atualizacao_nrec,
					dt_origem,
					ie_origem,
					nm_tabela_origem,
					nm_usuario,
					nm_usuario_nrec,
					nm_usuario_origem,
					nr_seq_lote,
					nr_sequencia)
				values (cd_expressao_w,
					ds_campo_w,
					ds_conteudo_campo_w,
					clock_timestamp(),
					clock_timestamp(),
					dt_origem_w,
					'U',
					nm_tabela_origem_w,
					nm_usuario_p,
					nm_usuario_p,
					nm_usuario_origem_w,
					nr_seq_lote_w,
					nr_sequencia_w);

			end if;

		end	loop;
		close	c11;

	end loop;
	close c21;
end if;

/* se não gerar nenhuma análise, não precisa do lote */

select	count(*)
into STRICT	qt_analise_w
from	analise_ortografica a
where	a.nr_seq_lote	= nr_seq_lote_w;

if (coalesce(qt_analise_w,0)	= 0) then

	delete	from analise_ortografica_lote
	where	nr_sequencia	= nr_seq_lote_w;

	nr_seq_lote_w	:= null;

end if;

nr_seq_lote_p	:= nr_seq_lote_w;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_analise_ortografica ( ds_lista_tabela_p text, dt_inicial_p timestamp, dt_final_p timestamp, ds_lista_usuario_p text, nr_seq_gerencia_p bigint, nr_seq_grupo_p bigint, nm_usuario_p text, ie_function_p text, nr_seq_lote_p INOUT bigint) FROM PUBLIC;

