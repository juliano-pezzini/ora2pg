-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE lab_valida_data_interface (dt_data_p text, qt_anos_p INOUT bigint, ds_erro_p INOUT text ) AS $body$
DECLARE



dataValida_w 	timestamp;
ds_erro_w		varchar(255);


BEGIN
ds_erro_w := '';
begin
	select 	to_date(dt_data_p,'ddmmyyyy')
	into STRICT	dataValida_w
	;
exception
	when others then
		begin
			ds_erro_w := substr(sqlerrm,1,255);
			select 	to_date(dt_data_p,'mmddyyyy')
			into STRICT	dataValida_w
			;
	exception
			when others then
				begin
					ds_erro_w := substr(sqlerrm,1,255);
					select 	to_date(dt_data_p,'yyyymmdd')
					into STRICT	dataValida_w
					;
				exception
					when others then
						begin
							ds_erro_w := substr(sqlerrm,1,255);
							select 	to_date(dt_data_p,'yyyyddmm')
							into STRICT	dataValida_w
							;
							exception
								when others then
								ds_erro_w := substr(sqlerrm,1,255);
						end;

				end;

		end;
end;

if (dataValida_w IS NOT NULL AND dataValida_w::text <> '') then

	ds_erro_w := '';

	select (trunc(clock_timestamp()) - trunc(dataValida_w))/365.25
	into STRICT	qt_anos_p
	;

end if;


ds_erro_p := ds_erro_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE lab_valida_data_interface (dt_data_p text, qt_anos_p INOUT bigint, ds_erro_p INOUT text ) FROM PUBLIC;

