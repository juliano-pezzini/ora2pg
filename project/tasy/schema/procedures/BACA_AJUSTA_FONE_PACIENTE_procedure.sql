-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE baca_ajusta_fone_paciente () AS $body$
DECLARE


nr_registros_w	bigint;


BEGIN

CALL wheb_usuario_pck.SET_IE_EXECUTAR_TRIGGER('N');

select	count(*)
into STRICT	nr_registros_w
from	compl_pessoa_fisica
where	nr_telefone <> to_char(somente_numero(nr_telefone));

WHILE(NR_REGISTROS_W > 0) LOOP
update	compl_pessoa_fisica
set	nr_telefone = elimina_caracteres_especiais(to_char(somente_numero(nr_telefone)))
where	nr_telefone <> to_char(somente_numero(nr_telefone))  LIMIT 500;

nr_registros_w := nr_registros_w - 500;

commit;
END LOOP;

select	count(*)
into STRICT	nr_registros_w
from	compl_pessoa_fisica
where	ds_fone_adic <> to_char(somente_numero(ds_fone_adic));

WHILE(NR_REGISTROS_W > 0) LOOP
update	compl_pessoa_fisica
set	ds_fone_adic = elimina_caracteres_especiais(to_char(somente_numero(ds_fone_adic)))
where	ds_fone_adic <> to_char(somente_numero(ds_fone_adic))  LIMIT 500;

nr_registros_w := nr_registros_w - 500;

commit;
END LOOP;

select	count(*)
into STRICT	nr_registros_w
from	compl_pessoa_fisica
where	ds_fax <> to_char(somente_numero(ds_fax));

WHILE(NR_REGISTROS_W > 0) LOOP
update	compl_pessoa_fisica
set	ds_fax = elimina_caracteres_especiais(to_char(somente_numero(ds_fax)))
where	ds_fax <> to_char(somente_numero(ds_fax))  LIMIT 500;

nr_registros_w := nr_registros_w - 500;

commit;
END LOOP;

select	count(*)
into STRICT	nr_registros_w
from	pessoa_fisica
where	nr_telefone_celular <> to_char(somente_numero(nr_telefone_celular));

WHILE(NR_REGISTROS_W > 0) LOOP
update	pessoa_fisica
set	nr_telefone_celular = elimina_caracteres_especiais(to_char(somente_numero(nr_telefone_celular)))
where	nr_telefone_celular <> to_char(somente_numero(nr_telefone_celular))  LIMIT 500;

nr_registros_w := nr_registros_w - 500;

commit;
END LOOP;

CALL wheb_usuario_pck.SET_IE_EXECUTAR_TRIGGER('S');

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE baca_ajusta_fone_paciente () FROM PUBLIC;

