-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pls_copiar_motivos_impug ( nr_seq_conta_p pls_processo_conta.nr_sequencia%type, nr_seq_formulario_p pls_formulario.nr_sequencia%type, nm_usuario_p text) AS $body$
DECLARE



nr_seq_formulario_w	pls_formulario.nr_sequencia%type;
C01 CURSOR FOR

	SELECT	coalesce(ds_desc_doc_comp,' ') ds_desc_doc_comp,
		coalesce(ds_desc_mot_impugnacao,' ') ds_desc_mot_impugnacao,
		coalesce(ds_memoria_calc,' ') ds_memoria_calc,
		nr_seq_formulario,
		nr_seq_motivo_impugnacao,
		nr_seq_texto_doc_comp,
		nr_seq_texto_mem_calc,
		nr_seq_texto_mot_impug,
		vl_franq_copart
	from	pls_formulario_motivo
	where	nr_seq_formulario = nr_seq_formulario_w;

BEGIN

select	max(nr_sequencia)
into STRICT	nr_seq_formulario_w
from	pls_formulario
where	nr_seq_conta = nr_seq_conta_p
and	ie_tipo_peticao = 1;

for c_01_w in C01 loop
	begin
	insert 	into 	pls_formulario_motivo(	nr_sequencia, 				ds_desc_doc_comp,     		 ds_desc_mot_impugnacao,       	ds_memoria_calc,
							nr_seq_formulario,      		nr_seq_motivo_impugnacao,     	 nr_seq_texto_doc_comp,        	nr_seq_texto_mem_calc,
							nr_seq_texto_mot_impug,			vl_franq_copart,		 dt_atualizacao,		dt_atualizacao_nrec,
							nm_usuario,				nm_usuario_nrec)
					values (	nextval('pls_formulario_motivo_seq'), 	c_01_w.ds_desc_doc_comp,	 c_01_w.ds_desc_mot_impugnacao,	c_01_w.ds_memoria_calc,
							nr_seq_formulario_p,            	c_01_w.nr_seq_motivo_impugnacao, c_01_w.nr_seq_texto_doc_comp,	c_01_w.nr_seq_texto_mem_calc,
							c_01_w.nr_seq_texto_mot_impug,    	c_01_w.vl_franq_copart,		 clock_timestamp(),			 clock_timestamp(),
							nm_usuario_p,				nm_usuario_p);
	end;
end loop;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_copiar_motivos_impug ( nr_seq_conta_p pls_processo_conta.nr_sequencia%type, nr_seq_formulario_p pls_formulario.nr_sequencia%type, nm_usuario_p text) FROM PUBLIC;

