-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE schematic4test_double_preset (NR_SEQUENCIA_P bigint, NM_USUARIO_P text) AS $body$
DECLARE

DS_PRESET_W varchar(255);
DS_INFO_W varchar(255);
IE_RUNTYPE_W varchar(255);
IE_SITUACAO_W varchar(255);
NR_SEQ_BROWSER_W bigint;
NR_SEQ_GRID_W bigint;
NR_SEQ_ROBOT_W bigint;
NR_SEQ_SERVICE_W bigint;
NR_SEQ_URL_W bigint;
DS_PRESET_W2 varchar(255);


BEGIN
  --procedure that duplicate profile
	INSERT INTO SCHEM_TEST_BEHOLDER(nr_sequencia, nm_usuario, dt_atualizacao, nm_usuario_nrec, dt_atualizacao_nrec, ds_interaction, ds_param_a)
    VALUES (nextval('schem_test_beholder_seq'), NM_USUARIO_P, clock_timestamp(), 'Robot', clock_timestamp(), 'SCHEMATIC4TEST_DOUBLE_PRESET',
	'NR_SEQUENCIA_P as '||NR_SEQUENCIA_P);
	
  SELECT preset.DS_PRESET, preset.DS_INFO, preset.IE_RUNTYPE, preset.IE_SITUACAO, preset.NR_SEQ_BROWSER, preset.NR_SEQ_GRID, preset.NR_SEQ_ROBOT, preset.NR_SEQ_SERVICE, preset.NR_SEQ_URL
     INTO STRICT DS_PRESET_W, DS_INFO_W, IE_RUNTYPE_W, IE_SITUACAO_W, NR_SEQ_BROWSER_W, NR_SEQ_GRID_W, NR_SEQ_ROBOT_W, NR_SEQ_SERVICE_W, NR_SEQ_URL_W
  FROM SCHEM_TEST_PRESET preset WHERE preset.NR_SEQUENCIA = NR_SEQUENCIA_P;

  DS_PRESET_W2 := 'COPY OF '||DS_PRESET_W;
  
  IF (DS_PRESET_W IS NOT NULL AND DS_PRESET_W::text <> '') THEN  
    INSERT INTO SCHEM_TEST_PRESET(NR_SEQUENCIA, DS_PRESET, DS_INFO, IE_RUNTYPE, IE_SITUACAO, NR_SEQ_BROWSER, NR_SEQ_GRID, NR_SEQ_ROBOT, NR_SEQ_SERVICE, NR_SEQ_URL, NM_USUARIO, NM_USUARIO_NREC, DT_ATUALIZACAO, DT_ATUALIZACAO_NREC) 
        VALUES (nextval('schem_test_preset_seq'), DS_PRESET_W2, DS_INFO_W, IE_RUNTYPE_W, IE_SITUACAO_W, NR_SEQ_BROWSER_W, NR_SEQ_GRID_W, NR_SEQ_ROBOT_W, NR_SEQ_SERVICE_W, NR_SEQ_URL_W, NM_USUARIO_P, NM_USUARIO_P, clock_timestamp(), clock_timestamp());
  END IF;

  COMMIT;

  EXCEPTION
  WHEN no_data_found THEN
     RAISE NOTICE 'Erro: Data not found';
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE schematic4test_double_preset (NR_SEQUENCIA_P bigint, NM_USUARIO_P text) FROM PUBLIC;

