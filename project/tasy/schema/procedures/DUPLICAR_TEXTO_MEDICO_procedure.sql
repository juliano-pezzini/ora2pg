-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE duplicar_texto_medico (nr_sequencia_p bigint) AS $body$
DECLARE


	nr_new_seq_w med_editor_texto.nr_sequencia%type;


BEGIN

if ((nr_sequencia_p IS NOT NULL AND nr_sequencia_p::text <> '') and nr_sequencia_p > 0) then

	select	nextval('med_editor_texto_seq')
	into STRICT	nr_new_seq_w
	;

	insert into med_editor_texto(
						nr_sequencia,
						ds_titulo,
						ie_tipo_texto,
						dt_atualizacao,
						nm_usuario,
						ds_texto,
						cd_medico,
						dt_atualizacao_nrec,
						nm_usuario_nrec)
	SELECT		nr_new_seq_w,
				ds_titulo,
				ie_tipo_texto,
				clock_timestamp(),
				wheb_usuario_pck.get_nm_usuario,
				' ',
				cd_medico,
				clock_timestamp(),
				wheb_usuario_pck.get_nm_usuario
	from		med_editor_texto
	where		nr_sequencia = nr_sequencia_p;

	commit;

	copia_campo_long_de_para_Java(	'MED_EDITOR_TEXTO',
		'DS_TEXTO',
		' where nr_sequencia = :nr_sequencia_old',
		'nr_sequencia_old='||nr_sequencia_p,
		'MED_EDITOR_TEXTO',
		'DS_TEXTO',
		' where nr_sequencia = :nr_sequencia_new',
		'nr_sequencia_new='||nr_new_seq_w,
		'L');

	commit;

end if;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE duplicar_texto_medico (nr_sequencia_p bigint) FROM PUBLIC;

