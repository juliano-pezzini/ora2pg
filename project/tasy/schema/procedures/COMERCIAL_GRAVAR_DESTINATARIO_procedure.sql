-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE comercial_gravar_destinatario ( nr_seq_comunicado_p bigint, nr_sequencia_p bigint, cd_cnpj_p text, nm_usuario_p text) AS $body$
DECLARE

 
nr_seq_localizacao_w		bigint;
ds_email_w			varchar(255);
nm_pessoa_contato_w		varchar(40);


BEGIN 
 
select	max(a.nm_pessoa_contato), 
	max(a.ds_email) 
into STRICT	nm_pessoa_contato_w, 
	ds_email_w 
from	pessoa_juridica_compl a 
where	a.nr_sequencia = nr_sequencia_p 
and	cd_cgc		= cd_cnpj_p;
 
insert into comercial_comunicado_dest(	nr_sequencia, 
		dt_atualizacao, 
		nm_usuario, 
		dt_atualizacao_nrec, 
		nm_usuario_nrec, 
		nr_seq_comunicado, 
		ds_email, 
		cd_pessoa_fisica, 
		cd_cnpj, 
		ie_enviar_email, 
		nm_destinatario) 
values (	nextval('comercial_comunicado_dest_seq'), 
		clock_timestamp(), 
		nm_usuario_p, 
		clock_timestamp(), 
		nm_usuario_p, 
		nr_seq_comunicado_p, 
		ds_email_w, 
		null, 
		cd_cnpj_p, 
		'S', 
		nm_pessoa_contato_w);
		 
		 
 
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE comercial_gravar_destinatario ( nr_seq_comunicado_p bigint, nr_sequencia_p bigint, cd_cnpj_p text, nm_usuario_p text) FROM PUBLIC;

