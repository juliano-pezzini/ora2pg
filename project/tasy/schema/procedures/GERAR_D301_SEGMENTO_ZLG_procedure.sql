-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_d301_segmento_zlg (nr_seq_dataset_p bigint, nm_usuario_p text) AS $body$
DECLARE



  ie_dataset_w       d301_dataset_envio.ie_dataset%type;

  nr_atendimento_w   d301_dataset_envio.nr_atendimento%type;

  nr_interno_conta_w d301_dataset_envio.nr_interno_conta%type;



BEGIN

  select

    d3.ie_dataset,

    d3.nr_atendimento,

    d3.nr_interno_conta

  into STRICT ie_dataset_w,

       nr_atendimento_w,

       nr_interno_conta_w

  from d301_dataset_envio d3

  where d3.nr_sequencia = nr_seq_dataset_p;



  if ie_dataset_w = 'AMBO' then

    CALL gerar_d301_seg_zlg_ambo(nr_interno_conta_w,nr_seq_dataset_p,nm_usuario_p);

  elsif ie_dataset_w = 'RECH' then

    CALL gerar_d301_seg_zlg_rech(nr_interno_conta_w,nr_seq_dataset_p,nm_usuario_p);

  end if;





end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_d301_segmento_zlg (nr_seq_dataset_p bigint, nm_usuario_p text) FROM PUBLIC;

