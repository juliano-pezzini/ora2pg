-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE copy_atend_anzics ( nr_sequencia_p bigint, nr_atendimento_p bigint, NM_USUARIO_P atend_anzics_result.nm_usuario%TYPE ) AS $body$
DECLARE


NR_SEQ_ANZICS_version_W bigint;
nr_seq_atend_anzics_w bigint;

BEGIN

   Insert INTO atend_anzics(
        nr_sequencia,
        dt_atualizacao,
        nm_usuario ,
        dt_atualizacao_nrec ,
        nm_usuario_nrec ,
        NR_ATENDIMENTO ,
        IE_SITUACAO,
        DT_GENERATE ,
        NR_SEQ_ANZICS
      )
      VALUES (
        nextval('atend_anzics_seq'),
        clock_timestamp(),
        nm_usuario_p,
        clock_timestamp(),
        nm_usuario_p,
        nr_atendimento_p,
        'A',
        clock_timestamp(),
        nr_seq_anzics_version_w
      ) returning nr_sequencia into nr_seq_atend_anzics_w;

     insert into atend_anzics_result(NR_SEQUENCIA , 
                                      DT_ATUALIZACAO,     
                                      NM_USUARIO,
                                      DT_ATUALIZACAO_NREC,    
                                      NM_USUARIO_NREC,
                                      NR_SEQ_ATEND_ANZICS ,
                                      NR_SEQ_ANZICS_ITEM ,
                                      QT_VALUE ,
                                      DS_VALUE ,
                                      DT_VALUE )
                                      SELECT nextval('atend_anzics_result_seq'),
                                             clock_timestamp(),
                                             nm_usuario_p,
                                             clock_timestamp(),
                                             nm_usuario_p,
                                             nr_seq_atend_anzics_w,
                                             NR_SEQ_ANZICS_ITEM,
                                             QT_VALUE ,
                                             DS_VALUE ,
                                             DT_VALUE from atend_anzics_result where nr_seq_atend_anzics = nr_sequencia_p;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE copy_atend_anzics ( nr_sequencia_p bigint, nr_atendimento_p bigint, NM_USUARIO_P atend_anzics_result.nm_usuario%TYPE ) FROM PUBLIC;

