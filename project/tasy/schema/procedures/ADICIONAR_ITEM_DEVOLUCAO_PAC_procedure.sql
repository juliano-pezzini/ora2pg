-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE adicionar_item_devolucao_pac ( CD_MATERIAL_P bigint, QT_MATERIAL_P bigint, NR_DEVOLUCAO_P bigint, DT_ATENDIMENTO_P timestamp, CD_LOCAL_ESTOQUE_P bigint, CD_UNIDADE_MEDIDA_P text, NM_USUARIO_DEVOL_P text, CD_MOTIVO_DEVOLUCAO_P bigint, NM_USUARIO_P text, NR_SEQ_JUSTIFICATIVA_P bigint default null, DS_JUSTIFICATIVA_P text default null, CD_CGC_FORNEC_P bigint default null, CD_SETOR_ATENDIMENTO_P bigint default null, NR_SEQ_LOTE_P bigint default null, NR_SEQ_LOTE_FORNEC_P bigint default null, NR_PRESCRICAO_P bigint default null, NR_SEQ_PRESC_P bigint default null, DT_ENTRADA_UNIDADE_P timestamp default null, NR_SEQ_ATENDIMENTO_P bigint default null, IE_GERACAO_P text default null) AS $body$
DECLARE


nr_sequencia_w	ITEM_DEVOLUCAO_MATERIAL_PAC.NR_SEQUENCIA%type;

BEGIN
	select	max(nr_sequencia) + 1
	into STRICT	nr_sequencia_w
	from	ITEM_DEVOLUCAO_MATERIAL_PAC
	where	nr_devolucao = NR_DEVOLUCAO_P;

	insert 	into ITEM_DEVOLUCAO_MATERIAL_PAC(
			NR_SEQUENCIA,
			NM_USUARIO,
			DT_ATUALIZACAO,
			CD_MATERIAL,
			QT_MATERIAL,
			NR_DEVOLUCAO,
			DT_ATENDIMENTO,
			CD_LOCAL_ESTOQUE,
			CD_UNIDADE_MEDIDA,
			NM_USUARIO_DEVOL,
			CD_MOTIVO_DEVOLUCAO,
			CD_CGC_FORNEC,
			CD_SETOR_ATENDIMENTO,
			NR_SEQ_LOTE,
			NR_SEQ_LOTE_FORNEC,
			NR_PRESCRICAO,
			NR_SEQUENCIA_PRESCRICAO,
			DT_ENTRADA_UNIDADE,
			NR_SEQ_ATENDIMENTO,
			IE_GERACAO,
			NR_SEQ_JUSTIFICATIVA,
			DS_JUSTIFICATIVA)
	values (	nr_sequencia_w,
			NM_USUARIO_P,
			clock_timestamp(),
			CD_MATERIAL_P,
			QT_MATERIAL_P,
			NR_DEVOLUCAO_P,
			DT_ATENDIMENTO_P,
			CD_LOCAL_ESTOQUE_P,
			CD_UNIDADE_MEDIDA_P,
			NM_USUARIO_DEVOL_P,
			CD_MOTIVO_DEVOLUCAO_P,
			CD_CGC_FORNEC_P,
			CD_SETOR_ATENDIMENTO_P,
			NR_SEQ_LOTE_P,
			NR_SEQ_LOTE_FORNEC_P,
			NR_PRESCRICAO_P,
			NR_SEQ_PRESC_P,
			DT_ENTRADA_UNIDADE_P,
			NR_SEQ_ATENDIMENTO_P,
			IE_GERACAO_P,
			NR_SEQ_JUSTIFICATIVA_P,
			DS_JUSTIFICATIVA_P);
	commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE adicionar_item_devolucao_pac ( CD_MATERIAL_P bigint, QT_MATERIAL_P bigint, NR_DEVOLUCAO_P bigint, DT_ATENDIMENTO_P timestamp, CD_LOCAL_ESTOQUE_P bigint, CD_UNIDADE_MEDIDA_P text, NM_USUARIO_DEVOL_P text, CD_MOTIVO_DEVOLUCAO_P bigint, NM_USUARIO_P text, NR_SEQ_JUSTIFICATIVA_P bigint default null, DS_JUSTIFICATIVA_P text default null, CD_CGC_FORNEC_P bigint default null, CD_SETOR_ATENDIMENTO_P bigint default null, NR_SEQ_LOTE_P bigint default null, NR_SEQ_LOTE_FORNEC_P bigint default null, NR_PRESCRICAO_P bigint default null, NR_SEQ_PRESC_P bigint default null, DT_ENTRADA_UNIDADE_P timestamp default null, NR_SEQ_ATENDIMENTO_P bigint default null, IE_GERACAO_P text default null) FROM PUBLIC;

