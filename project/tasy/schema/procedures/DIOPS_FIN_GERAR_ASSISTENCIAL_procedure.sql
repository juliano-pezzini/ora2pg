-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE diops_fin_gerar_assistencial ( nr_seq_periodo_p bigint, nm_usuario_p text, cd_estabelecimento_p bigint) AS $body$
DECLARE


ds_conta_contabil_w	varchar(20);
ie_tipo_quadro_w	varchar(2);
ie_cobertura_w		varchar(5);
ie_tipo_w		varchar(5);
ds_plano_w		varchar(255);
vl_consulta_rp_w	double precision	:= 0;
vl_consulta_rc_w	double precision	:= 0;
vl_consulta_re_w	double precision	:= 0;
vl_consulta_ie_w	double precision	:= 0;
vl_exame_rp_w		double precision	:= 0;
vl_exame_rc_w		double precision	:= 0;
vl_exame_re_w		double precision	:= 0;
vl_exame_ie_w		double precision	:= 0;
vl_terapia_rp_w		double precision	:= 0;
vl_terapia_rc_w		double precision	:= 0;
vl_terapia_re_w		double precision	:= 0;
vl_terapia_ie_w		double precision	:= 0;
vl_intern_rp_w		double precision	:= 0;
vl_intern_rc_w		double precision	:= 0;
vl_intern_re_w		double precision	:= 0;
vl_intern_ie_w		double precision	:= 0;
vl_atendimento_rp_w	double precision	:= 0;
vl_atendimento_rc_w	double precision	:= 0;
vl_atendimento_re_w	double precision	:= 0;
vl_atendimento_ie_w	double precision	:= 0;
vl_despesas_rp_w	double precision	:= 0;
vl_despesas_rc_w	double precision	:= 0;
vl_despesas_re_w	double precision	:= 0;
vl_despesas_ie_w	double precision	:= 0;
vl_consulta_op_w	double precision	:= 0;
vl_exame_op_w		double precision	:= 0;
vl_terapia_op_w		double precision	:= 0;
vl_intern_op_w		double precision	:= 0;
vl_atendimento_op_w	double precision	:= 0;
vl_despesas_op_w	double precision	:= 0;
vl_odonto_rp_w		double precision	:= 0;
vl_odonto_rc_w		double precision	:= 0;
vl_odonto_re_w		double precision	:= 0;
vl_odonto_ie_w		double precision	:= 0;
dt_periodo_inicial_w	timestamp;
dt_periodo_final_w	timestamp;
ie_preco_w		varchar(2);
ie_tipo_contratacao_w	varchar(2);
ie_regulamentacao_w	varchar(2);
ie_tipo_dado_w		varchar(2);
ie_status_prov_pagto_w	varchar(2);
vl_liberado_w		double precision;
ds_grupo_diops_w	varchar(255);
ie_ato_w		varchar(255);
ie_tipo_outorgante_w	pls_outorgante.ie_tipo_outorgante%type;
ie_forma_geracao_w	varchar(1);

nr_seq_conta_mat_w		pls_conta_mat.nr_sequencia%type;
nr_seq_conta_proc_w		pls_conta_proc.nr_sequencia%type;
nr_seq_conta_w			pls_conta.nr_sequencia%type;
nr_seq_conta_copartic_w		pls_conta_coparticipacao.nr_sequencia%type;
ie_cobertura_assistencial_w	pls_parametros.ie_cobertura_assistencial%type;

c_dominio CURSOR FOR
	SELECT	vl_dominio,
		ie_ato
	from	(SELECT	vl_dominio,
			'0' ie_ato
		from	valor_dominio
		where	cd_dominio = 5832
		and (ie_tipo_outorgante_w not('3','4')
		or	ie_forma_geracao_w	= 'S')
		and	((dt_periodo_final_w < to_date('01/01/2016','dd/mm/yyyy'))
		or (vl_dominio not in (7,8,9,10,11,12)))
		
union all

		select	vl_dominio,
			'1' ie_ato
		from	valor_dominio
		where	cd_dominio = 5832
		and	ie_tipo_outorgante_w in ('3','4')
		and	((dt_periodo_final_w < to_date('01/01/2016','dd/mm/yyyy'))
		or (vl_dominio not in (7,8,9,10,11,12)))
		and	ie_forma_geracao_w	= 'A'
		
union all

		select	vl_dominio,
			'2' ie_ato
		from	valor_dominio
		where	cd_dominio = 5832
		and	ie_tipo_outorgante_w in ('3','4')
		and	((dt_periodo_final_w < to_date('01/01/2016','dd/mm/yyyy'))
		or (vl_dominio not in (7,8,9,10,11,12)))
		and	ie_forma_geracao_w	= 'A'
		
union all

		select	vl_dominio,
			'7' ie_ato
		from	valor_dominio
		where	cd_dominio = 5832
		and	ie_tipo_outorgante_w in ('3','4')
		and	((dt_periodo_final_w < to_date('01/01/2016','dd/mm/yyyy'))
		or (vl_dominio not in (7,8,9,10,11,12)))
		and	ie_forma_geracao_w	= 'A') alias25
	order by
		ie_ato,
		(vl_dominio)::numeric;

/* DESPESAS */

c_itens_conta CURSOR FOR
	SELECT	'RP' ie_tipo_dado,
		sum(a.vl_liberado) vl_liberado,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		a.nr_sequencia nr_seq_conta_proc,
		null nr_seq_conta_mat,
		b.nr_sequencia nr_seq_conta
	FROM pls_prestador h, pls_protocolo_conta f, pls_plano d, pls_segurado c, pls_conta b, pls_conta_proc a
LEFT OUTER JOIN ans_grupo_despesa g ON (a.nr_seq_grupo_ans = g.nr_sequencia)
WHERE a.nr_seq_conta		= b.nr_sequencia and b.nr_seq_segurado	= c.nr_sequencia and b.nr_seq_plano		= d.nr_sequencia and b.nr_seq_protocolo	= f.nr_sequencia and b.nr_seq_prestador_exec	= h.nr_sequencia  and ((b.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (f.ie_status in ('3','4','6')))) and f.dt_mes_competencia between dt_periodo_inicial_w and dt_periodo_final_w and ds_conta_contabil_w  in (	SELECT	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	pls_conta_medica_resumo z,
							conta_contabil	e
						where	z.nr_seq_conta = b.nr_sequencia
						and	z.nr_seq_conta_proc = a.nr_sequencia
						and	coalesce(z.cd_conta_prov_deb,z.cd_conta_deb) = e.cd_conta_contabil
						
union

						select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	conta_contabil e
						where	coalesce(a.cd_conta_provisao_deb,a.cd_conta_deb) = e.cd_conta_contabil) and (((ie_tipo_quadro_w = '1') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R'))) and h.ie_tipo_relacao in ('C','P') and c.ie_tipo_segurado not in ('T','C','I') and f.ie_tipo_protocolo <> 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END
	
union all

	select	'RC' ie_tipo_dado,
		sum(a.vl_liberado) vl_liberado,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		a.nr_sequencia nr_seq_conta_proc,
		null nr_seq_conta_mat,
		b.nr_sequencia nr_seq_conta
	FROM pls_prestador h, pls_protocolo_conta f, pls_plano d, pls_segurado c, pls_conta b, pls_conta_proc a
LEFT OUTER JOIN ans_grupo_despesa g ON (a.nr_seq_grupo_ans = g.nr_sequencia)
WHERE a.nr_seq_conta		= b.nr_sequencia and b.nr_seq_segurado	= c.nr_sequencia and b.nr_seq_plano		= d.nr_sequencia and b.nr_seq_protocolo	= f.nr_sequencia and b.nr_seq_prestador_exec	= h.nr_sequencia  and ((b.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (f.ie_status in ('3','4','6')))) and f.dt_mes_competencia between dt_periodo_inicial_w and dt_periodo_final_w and ds_conta_contabil_w in (	select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	pls_conta_medica_resumo z,
							conta_contabil	e
						where	z.nr_seq_conta = b.nr_sequencia
						and	z.nr_seq_conta_proc = a.nr_sequencia
						and	coalesce(z.cd_conta_prov_deb,z.cd_conta_deb) = e.cd_conta_contabil
						
union

						select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	conta_contabil e
						where	coalesce(a.cd_conta_provisao_deb,a.cd_conta_deb) = e.cd_conta_contabil) and (((ie_tipo_quadro_w = '1') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R'))) and h.ie_tipo_relacao not in ('C','P') and c.ie_tipo_segurado not in ('T','C','I') and f.ie_tipo_protocolo <> 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END 
	
union all

	select	'RE' ie_tipo_dado,
		sum(a.vl_liberado) vl_liberado,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		a.nr_sequencia nr_seq_conta_proc,
		null nr_seq_conta_mat,
		b.nr_sequencia nr_seq_conta
	FROM pls_protocolo_conta f, pls_plano d, pls_segurado c, pls_conta b, pls_conta_proc a
LEFT OUTER JOIN ans_grupo_despesa g ON (a.nr_seq_grupo_ans = g.nr_sequencia)
WHERE a.nr_seq_conta		= b.nr_sequencia and b.nr_seq_segurado	= c.nr_sequencia and b.nr_seq_plano		= d.nr_sequencia and b.nr_seq_protocolo	= f.nr_sequencia  and ((b.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (f.ie_status in ('3','4','6')))) and f.dt_mes_competencia between dt_periodo_inicial_w and dt_periodo_final_w and ds_conta_contabil_w in (	select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	pls_conta_medica_resumo z,
							conta_contabil	e
						where	z.nr_seq_conta = b.nr_sequencia
						and	z.nr_seq_conta_proc = a.nr_sequencia
						and	coalesce(z.cd_conta_prov_deb,z.cd_conta_deb) = e.cd_conta_contabil
						
union

						select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	conta_contabil e
						where	coalesce(a.cd_conta_provisao_deb,a.cd_conta_deb) = e.cd_conta_contabil) and (((ie_tipo_quadro_w = '1') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R'))) and f.ie_tipo_protocolo = 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END 
	
union all

	select	'IE' ie_tipo_dado,
		sum(a.vl_liberado) vl_liberado,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		a.nr_sequencia nr_seq_conta_proc,
		null nr_seq_conta_mat,
		b.nr_sequencia nr_seq_conta
	FROM pls_prestador h, pls_protocolo_conta f, pls_plano d, pls_segurado c, pls_conta b, pls_conta_proc a
LEFT OUTER JOIN ans_grupo_despesa g ON (a.nr_seq_grupo_ans = g.nr_sequencia)
WHERE a.nr_seq_conta		= b.nr_sequencia and b.nr_seq_segurado	= c.nr_sequencia and c.nr_seq_plano		= d.nr_sequencia and b.nr_seq_protocolo	= f.nr_sequencia and b.nr_seq_prestador_exec	= h.nr_sequencia  and ((b.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (f.ie_status in ('3','4','6')))) and f.dt_mes_competencia between dt_periodo_inicial_w and dt_periodo_final_w and ds_conta_contabil_w in (	select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	pls_conta_medica_resumo z,
							conta_contabil	e
						where	z.nr_seq_conta = b.nr_sequencia
						and	z.nr_seq_conta_proc = a.nr_sequencia
						and	coalesce(z.cd_conta_prov_deb,z.cd_conta_deb) = e.cd_conta_contabil
						
union

						select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	conta_contabil e
						where	coalesce(a.cd_conta_provisao_deb,a.cd_conta_deb) = e.cd_conta_contabil) and (((ie_tipo_quadro_w = '1') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R'))) and c.ie_tipo_segurado in ('T','C','I') and f.ie_tipo_protocolo <> 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END 
	
union all

	select	'RP' ie_tipo_dado,
		sum(a.vl_liberado) vl_liberado,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		null nr_seq_conta_proc,
		a.nr_sequencia nr_seq_conta_mat,
		b.nr_sequencia nr_seq_conta
	FROM pls_prestador h, pls_protocolo_conta f, pls_plano d, pls_segurado c, pls_conta b, pls_conta_mat a
LEFT OUTER JOIN ans_grupo_despesa g ON (a.nr_seq_grupo_ans = g.nr_sequencia)
WHERE a.nr_seq_conta		= b.nr_sequencia and b.nr_seq_segurado	= c.nr_sequencia and b.nr_seq_plano		= d.nr_sequencia and b.nr_seq_protocolo	= f.nr_sequencia and b.nr_seq_prestador_exec	= h.nr_sequencia  and ((b.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (f.ie_status in ('3','4','6')))) and f.dt_mes_competencia between dt_periodo_inicial_w and dt_periodo_final_w and ds_conta_contabil_w in (	select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	pls_conta_medica_resumo z,
							conta_contabil	e
						where	z.nr_seq_conta = b.nr_sequencia
						and	z.nr_seq_conta_mat = a.nr_sequencia
						and	coalesce(z.cd_conta_prov_deb,z.cd_conta_deb) = e.cd_conta_contabil
						
union

						select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	conta_contabil e
						where	coalesce(a.cd_conta_provisao_deb,a.cd_conta_deb) = e.cd_conta_contabil) and (((ie_tipo_quadro_w = '1') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R'))) and h.ie_tipo_relacao in ('C','P') and c.ie_tipo_segurado not in ('T','C','I') and f.ie_tipo_protocolo <> 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END 
	
union all

	select	'RC' ie_tipo_dado,
		sum(a.vl_liberado) vl_liberado,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		null nr_seq_conta_proc,
		a.nr_sequencia nr_seq_conta_mat,
		b.nr_sequencia nr_seq_conta
	FROM pls_prestador h, pls_protocolo_conta f, pls_plano d, pls_segurado c, pls_conta b, pls_conta_mat a
LEFT OUTER JOIN ans_grupo_despesa g ON (a.nr_seq_grupo_ans = g.nr_sequencia)
WHERE a.nr_seq_conta		= b.nr_sequencia and b.nr_seq_segurado	= c.nr_sequencia and b.nr_seq_plano		= d.nr_sequencia and b.nr_seq_protocolo	= f.nr_sequencia and b.nr_seq_prestador_exec	= h.nr_sequencia  and ((b.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (f.ie_status in ('3','4','6')))) and f.dt_mes_competencia between dt_periodo_inicial_w and dt_periodo_final_w and ds_conta_contabil_w in (	select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	pls_conta_medica_resumo z,
							conta_contabil	e
						where	z.nr_seq_conta = b.nr_sequencia
						and	z.nr_seq_conta_mat = a.nr_sequencia
						and	coalesce(z.cd_conta_prov_deb,z.cd_conta_deb) = e.cd_conta_contabil
						
union

						select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	conta_contabil e
						where	coalesce(a.cd_conta_provisao_deb,a.cd_conta_deb) = e.cd_conta_contabil) and (((ie_tipo_quadro_w = '1') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R'))) and h.ie_tipo_relacao not in ('C','P') and c.ie_tipo_segurado not in ('T','C','I') and f.ie_tipo_protocolo <> 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END 
	
union all

	select	'RE' ie_tipo_dado,
		sum(a.vl_liberado) vl_liberado,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		null nr_seq_conta_proc,
		a.nr_sequencia nr_seq_conta_mat,
		b.nr_sequencia nr_seq_conta
	FROM pls_protocolo_conta f, pls_plano d, pls_segurado c, pls_conta b, pls_conta_mat a
LEFT OUTER JOIN ans_grupo_despesa g ON (a.nr_seq_grupo_ans = g.nr_sequencia)
WHERE a.nr_seq_conta		= b.nr_sequencia and b.nr_seq_segurado	= c.nr_sequencia and b.nr_seq_plano		= d.nr_sequencia and b.nr_seq_protocolo	= f.nr_sequencia  and ((b.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (f.ie_status in ('3','4','6')))) and f.dt_mes_competencia between dt_periodo_inicial_w and dt_periodo_final_w and ds_conta_contabil_w in (	select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	pls_conta_medica_resumo z,
							conta_contabil	e
						where	z.nr_seq_conta = b.nr_sequencia
						and	z.nr_seq_conta_mat = a.nr_sequencia
						and	coalesce(z.cd_conta_prov_deb,z.cd_conta_deb) = e.cd_conta_contabil
						
union

						select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	conta_contabil e
						where	coalesce(a.cd_conta_provisao_deb,a.cd_conta_deb) = e.cd_conta_contabil) and (((ie_tipo_quadro_w = '1') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R'))) and f.ie_tipo_protocolo = 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END 
	
union all

	select	'IE' ie_tipo_dado,
		sum(a.vl_liberado) vl_liberado,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		null nr_seq_conta_proc,
		a.nr_sequencia nr_seq_conta_mat,
		b.nr_sequencia nr_seq_conta
	FROM pls_prestador h, pls_protocolo_conta f, pls_plano d, pls_segurado c, pls_conta b, pls_conta_mat a
LEFT OUTER JOIN ans_grupo_despesa g ON (a.nr_seq_grupo_ans = g.nr_sequencia)
WHERE a.nr_seq_conta		= b.nr_sequencia and b.nr_seq_segurado	= c.nr_sequencia and c.nr_seq_plano		= d.nr_sequencia and b.nr_seq_protocolo	= f.nr_sequencia and b.nr_seq_prestador_exec	= h.nr_sequencia  and ((b.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (f.ie_status in ('3','4','6')))) and f.dt_mes_competencia between dt_periodo_inicial_w and dt_periodo_final_w and ds_conta_contabil_w in (	select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	pls_conta_medica_resumo z,
							conta_contabil	e
						where	z.nr_seq_conta = b.nr_sequencia
						and	z.nr_seq_conta_mat = a.nr_sequencia
						and	coalesce(z.cd_conta_prov_deb,z.cd_conta_deb) = e.cd_conta_contabil
						
union

						select	substr(replace(e.cd_classificacao_atual,'.',''),1,8)
						from	conta_contabil e
						where	coalesce(a.cd_conta_provisao_deb,a.cd_conta_deb) = e.cd_conta_contabil) and (((ie_tipo_quadro_w = '1') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (d.ie_preco = '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'I') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CA') and (d.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (d.ie_preco <> '1') and (d.ie_tipo_contratacao = 'CE') and (d.ie_regulamentacao <> 'R'))) and c.ie_tipo_segurado in ('T','C','I') and f.ie_tipo_protocolo <> 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		CASE WHEN g.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN g.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN g.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN g.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN g.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN g.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END;

/* COPARTICIPAÇÃO */

c_coparticipacao CURSOR FOR
	SELECT	'RP' ie_tipo_dado,
		sum(coalesce(b.vl_copartic_mens,b.vl_coparticipacao)) vl_liberado,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		a.nr_sequencia nr_seq_conta_proc,
		null nr_seq_conta_mat,
		c.nr_sequencia nr_seq_conta,
		b.nr_sequencia nr_seq_conta_copartic
	FROM pls_protocolo_conta k, pls_prestador j, pls_plano g, pls_mensalidade f, pls_segurado e, pls_mensalidade_segurado d, pls_conta c, pls_conta_proc a
LEFT OUTER JOIN ans_grupo_despesa h ON (a.nr_seq_grupo_ans = h.nr_sequencia)
, pls_conta_coparticipacao b
LEFT OUTER JOIN conta_contabil i ON (b.cd_conta_cred = i.cd_conta_contabil)
WHERE b.nr_seq_conta_proc	= a.nr_sequencia and a.nr_seq_conta		= c.nr_sequencia and b.nr_seq_conta		= c.nr_sequencia and b.nr_seq_mensalidade_seg = d.nr_sequencia and d.nr_seq_segurado	= e.nr_sequencia and d.nr_seq_mensalidade	= f.nr_sequencia and c.nr_seq_plano		= g.nr_sequencia and c.nr_seq_prestador_exec	= j.nr_sequencia and c.nr_seq_protocolo	= k.nr_sequencia   and ((c.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (k.ie_status in ('3','4','6')))) and f.dt_referencia between dt_periodo_inicial_w and dt_periodo_final_w and substr(replace(i.cd_classificacao_atual,'.',''),1,8) = ds_conta_contabil_w and (((ie_tipo_quadro_w = '1') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R'))) and j.ie_tipo_relacao in ('C','P') and e.ie_tipo_segurado not in ('T','C','I') and k.ie_tipo_protocolo <> 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		c.nr_sequencia,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END
	
union all

	SELECT	'RC' ie_tipo_dado,
		sum(coalesce(b.vl_copartic_mens,b.vl_coparticipacao)) vl_liberado,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		a.nr_sequencia nr_seq_conta_proc,
		null nr_seq_conta_mat,
		c.nr_sequencia nr_seq_conta,
		b.nr_sequencia nr_seq_conta_copartic
	FROM pls_protocolo_conta k, pls_prestador j, pls_plano g, pls_mensalidade f, pls_segurado e, pls_mensalidade_segurado d, pls_conta c, pls_conta_proc a
LEFT OUTER JOIN ans_grupo_despesa h ON (a.nr_seq_grupo_ans = h.nr_sequencia)
, pls_conta_coparticipacao b
LEFT OUTER JOIN conta_contabil i ON (b.cd_conta_cred = i.cd_conta_contabil)
WHERE b.nr_seq_conta_proc	= a.nr_sequencia and a.nr_seq_conta		= c.nr_sequencia and b.nr_seq_conta		= c.nr_sequencia and b.nr_seq_mensalidade_seg = d.nr_sequencia and d.nr_seq_segurado	= e.nr_sequencia and d.nr_seq_mensalidade	= f.nr_sequencia and c.nr_seq_plano		= g.nr_sequencia and c.nr_seq_prestador_exec	= j.nr_sequencia and c.nr_seq_protocolo	= k.nr_sequencia   and ((c.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (k.ie_status in ('3','4','6')))) and f.dt_referencia between dt_periodo_inicial_w and dt_periodo_final_w and substr(replace(i.cd_classificacao_atual,'.',''),1,8) = ds_conta_contabil_w and (((ie_tipo_quadro_w = '1') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R'))) and j.ie_tipo_relacao not in ('C','P') and c.ie_tipo_segurado not in ('T','C','I') and k.ie_tipo_protocolo <> 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		c.nr_sequencia,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END 
	
union all

	select	'RE' ie_tipo_dado,
		sum(coalesce(b.vl_copartic_mens,b.vl_coparticipacao)) vl_liberado,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		a.nr_sequencia nr_seq_conta_proc,
		null nr_seq_conta_mat,
		c.nr_sequencia nr_seq_conta,
		b.nr_sequencia nr_seq_conta_copartic
	FROM pls_protocolo_conta k, pls_plano g, pls_segurado e, pls_conta c, pls_conta_coparticipacao b, pls_conta_proc a
LEFT OUTER JOIN ans_grupo_despesa h ON (a.nr_seq_grupo_ans = h.nr_sequencia)
LEFT OUTER JOIN conta_contabil i ON (a.cd_conta_copartic_deb = i.cd_conta_contabil)
WHERE b.nr_seq_conta_proc	= a.nr_sequencia and a.nr_seq_conta		= c.nr_sequencia and b.nr_seq_conta		= c.nr_sequencia and c.nr_seq_segurado	= e.nr_sequencia and c.nr_seq_plano		= g.nr_sequencia and c.nr_seq_protocolo	= k.nr_sequencia   and ((c.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (k.ie_status in ('3','4','6')))) and k.dt_mes_competencia between dt_periodo_inicial_w and dt_periodo_final_w and substr(replace(i.cd_classificacao_atual,'.',''),1,8) = ds_conta_contabil_w and (((ie_tipo_quadro_w = '1') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R'))) and k.ie_tipo_protocolo = 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		c.nr_sequencia,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END 
	
union all

	select	'IE' ie_tipo_dado,
		sum(coalesce(b.vl_copartic_mens,b.vl_coparticipacao)) vl_liberado,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		a.nr_sequencia nr_seq_conta_proc,
		null nr_seq_conta_mat,
		c.nr_sequencia nr_seq_conta,
		b.nr_sequencia nr_seq_conta_copartic
	FROM pls_protocolo_conta k, pls_prestador j, pls_plano g, pls_mensalidade f, pls_segurado e, pls_mensalidade_segurado d, pls_conta c, pls_conta_proc a
LEFT OUTER JOIN ans_grupo_despesa h ON (a.nr_seq_grupo_ans = h.nr_sequencia)
, pls_conta_coparticipacao b
LEFT OUTER JOIN conta_contabil i ON (b.cd_conta_cred = i.cd_conta_contabil)
WHERE b.nr_seq_conta_proc	= a.nr_sequencia and a.nr_seq_conta		= c.nr_sequencia and b.nr_seq_conta		= c.nr_sequencia and b.nr_seq_mensalidade_seg = d.nr_sequencia and d.nr_seq_segurado	= e.nr_sequencia and d.nr_seq_mensalidade	= f.nr_sequencia and e.nr_seq_plano		= g.nr_sequencia and c.nr_seq_prestador_exec	= j.nr_sequencia and c.nr_seq_protocolo	= k.nr_sequencia   and ((c.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (k.ie_status in ('3','4','6')))) and f.dt_referencia between dt_periodo_inicial_w and dt_periodo_final_w and substr(replace(i.cd_classificacao_atual,'.',''),1,8) = ds_conta_contabil_w and (((ie_tipo_quadro_w = '1') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R'))) and c.ie_tipo_segurado in ('T','C','I') and k.ie_tipo_protocolo <> 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		c.nr_sequencia,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END 
	
union all

	select	'RP' ie_tipo_dado,
		sum(coalesce(b.vl_copartic_mens,b.vl_coparticipacao)) vl_liberado,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		null nr_seq_conta_proc,
		a.nr_sequencia nr_seq_conta_mat,
		c.nr_sequencia nr_seq_conta,
		b.nr_sequencia nr_seq_conta_copartic
	FROM pls_protocolo_conta k, pls_prestador j, pls_plano g, pls_mensalidade f, pls_segurado e, pls_mensalidade_segurado d, pls_conta c, pls_conta_mat a
LEFT OUTER JOIN ans_grupo_despesa h ON (a.nr_seq_grupo_ans = h.nr_sequencia)
, pls_conta_coparticipacao b
LEFT OUTER JOIN conta_contabil i ON (b.cd_conta_cred = i.cd_conta_contabil)
WHERE b.nr_seq_conta_mat	= a.nr_sequencia and a.nr_seq_conta		= c.nr_sequencia and b.nr_seq_conta		= c.nr_sequencia and b.nr_seq_mensalidade_seg = d.nr_sequencia and d.nr_seq_segurado	= e.nr_sequencia and d.nr_seq_mensalidade	= f.nr_sequencia and c.nr_seq_plano		= g.nr_sequencia and c.nr_seq_prestador_exec	= j.nr_sequencia and c.nr_seq_protocolo	= k.nr_sequencia   and ((c.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (k.ie_status in ('3','4','6')))) and f.dt_referencia between dt_periodo_inicial_w and dt_periodo_final_w and substr(replace(i.cd_classificacao_atual,'.',''),1,8) = ds_conta_contabil_w and (((ie_tipo_quadro_w = '1') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R'))) and j.ie_tipo_relacao in ('C','P') and e.ie_tipo_segurado not in ('T','C','I') and k.ie_tipo_protocolo <> 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		c.nr_sequencia,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END 
	
union all

	select	'RC' ie_tipo_dado,
		sum(coalesce(b.vl_copartic_mens,b.vl_coparticipacao)) vl_liberado,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		null nr_seq_conta_proc,
		a.nr_sequencia nr_seq_conta_mat,
		c.nr_sequencia nr_seq_conta,
		b.nr_sequencia nr_seq_conta_copartic
	FROM pls_protocolo_conta k, pls_prestador j, pls_plano g, pls_mensalidade f, pls_segurado e, pls_mensalidade_segurado d, pls_conta c, pls_conta_mat a
LEFT OUTER JOIN ans_grupo_despesa h ON (a.nr_seq_grupo_ans = h.nr_sequencia)
, pls_conta_coparticipacao b
LEFT OUTER JOIN conta_contabil i ON (b.cd_conta_cred = i.cd_conta_contabil)
WHERE b.nr_seq_conta_mat	= a.nr_sequencia and a.nr_seq_conta		= c.nr_sequencia and b.nr_seq_conta		= c.nr_sequencia and b.nr_seq_mensalidade_seg = d.nr_sequencia and d.nr_seq_segurado	= e.nr_sequencia and d.nr_seq_mensalidade	= f.nr_sequencia and c.nr_seq_plano		= g.nr_sequencia and c.nr_seq_prestador_exec	= j.nr_sequencia and c.nr_seq_protocolo	= k.nr_sequencia   and ((c.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (k.ie_status in ('3','4','6')))) and f.dt_referencia between dt_periodo_inicial_w and dt_periodo_final_w and substr(replace(i.cd_classificacao_atual,'.',''),1,8) = ds_conta_contabil_w and (((ie_tipo_quadro_w = '1') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R'))) and j.ie_tipo_relacao not in ('C','P') and c.ie_tipo_segurado not in ('T','C','I') and k.ie_tipo_protocolo <> 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		c.nr_sequencia,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END 
	
union all

	/*select	'RE' ie_tipo_dado,
		sum(b.vl_coparticipacao) vl_liberado,
		decode(h.ie_tipo_grupo_ans,'10','Consultas',
				'20','Exames',
				'30','Terapias',
				'41','Internação','42','Internação','43','Internação','44','Internação','45','Internação','46','Internação','49','Internação',
				'50','Outros atendimentos',
				'60','Demais despesas',
				'Sem grupo ANS') ds_grupo_diops
	from	pls_conta_mat			a,
		pls_conta_coparticipacao	b,
		pls_conta			c,
		pls_segurado			e,
		pls_plano			g,
		ans_grupo_despesa		h,
		conta_contabil			i,
		pls_protocolo_conta		k
	where	b.nr_seq_conta_proc	= a.nr_sequencia
	and	a.nr_seq_conta		= c.nr_sequencia
	and	b.nr_seq_conta		= c.nr_sequencia
	and	c.nr_seq_segurado	= e.nr_sequencia
	and	e.nr_seq_plano		= g.nr_sequencia
	and	c.nr_seq_protocolo	= k.nr_sequencia
	and	h.nr_sequencia(+)	= a.nr_seq_grupo_ans
	and	a.cd_conta_copartic_deb	= i.cd_conta_contabil(+)
	and	k.dt_mes_competencia between dt_periodo_inicial_w and dt_periodo_final_w
	and	substr(replace(i.cd_classificacao_atual,'.',''),1,8) = ds_conta_contabil_w
	and	(((ie_tipo_quadro_w = '1') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R')))
	and	k.ie_tipo_protocolo = 'R'
	group by decode(h.ie_tipo_grupo_ans,'10','Consultas',
				'20','Exames',
				'30','Terapias',
				'41','Internação','42','Internação','43','Internação','44','Internação','45','Internação','46','Internação','49','Internação',
				'50','Outros atendimentos',
				'60','Demais despesas',
				'Sem grupo ANS')
	union all*/
	select	'IE' ie_tipo_dado,
		sum(coalesce(b.vl_copartic_mens,b.vl_coparticipacao)) vl_liberado,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END  ds_grupo_diops,
		null nr_seq_conta_proc,
		a.nr_sequencia nr_seq_conta_mat,
		c.nr_sequencia nr_seq_conta,
		b.nr_sequencia nr_seq_conta_copartic
	FROM pls_protocolo_conta k, pls_prestador j, pls_plano g, pls_mensalidade f, pls_segurado e, pls_mensalidade_segurado d, pls_conta c, pls_conta_mat a
LEFT OUTER JOIN ans_grupo_despesa h ON (a.nr_seq_grupo_ans = h.nr_sequencia)
, pls_conta_coparticipacao b
LEFT OUTER JOIN conta_contabil i ON (b.cd_conta_cred = i.cd_conta_contabil)
WHERE b.nr_seq_conta_mat	= a.nr_sequencia and a.nr_seq_conta		= c.nr_sequencia and b.nr_seq_conta		= c.nr_sequencia and b.nr_seq_mensalidade_seg = d.nr_sequencia and d.nr_seq_segurado	= e.nr_sequencia and d.nr_seq_mensalidade	= f.nr_sequencia and e.nr_seq_plano		= g.nr_sequencia and c.nr_seq_prestador_exec	= j.nr_sequencia and c.nr_seq_protocolo	= k.nr_sequencia   and ((c.ie_status = ie_status_prov_pagto_w)
	or	((ie_status_prov_pagto_w <> 'F')
	and (k.ie_status in ('3','4','6')))) and f.dt_referencia between dt_periodo_inicial_w and dt_periodo_final_w and substr(replace(i.cd_classificacao_atual,'.',''),1,8) = ds_conta_contabil_w and (((ie_tipo_quadro_w = '1') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '2') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '3') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '4') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '5') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '6') and (g.ie_preco = '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '7') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '8') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'I') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '9') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '10') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CA') and (g.ie_regulamentacao <> 'R')) or
		 ((ie_tipo_quadro_w = '11') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao = 'R')) or
		 ((ie_tipo_quadro_w = '12') and (g.ie_preco <> '1') and (g.ie_tipo_contratacao = 'CE') and (g.ie_regulamentacao <> 'R'))) and c.ie_tipo_segurado in ('T','C','I') and k.ie_tipo_protocolo <> 'R' group by
		a.nr_sequencia,
		b.nr_sequencia,
		c.nr_sequencia,
		CASE WHEN h.ie_tipo_grupo_ans='10' THEN 'Consultas' WHEN h.ie_tipo_grupo_ans='20' THEN 'Exames' WHEN h.ie_tipo_grupo_ans='30' THEN 'Terapias' WHEN h.ie_tipo_grupo_ans='41' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='42' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='43' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='44' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='45' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='46' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='49' THEN 'Internação' WHEN h.ie_tipo_grupo_ans='50' THEN 'Outros atendimentos' WHEN h.ie_tipo_grupo_ans='60' THEN 'Demais despesas'  ELSE 'Sem grupo ANS' END;

c_agrupador CURSOR FOR
	SELECT	ds_conta_contabil,
		ie_tipo_quadro,
		ds_plano,
		ie_cobertura,
		ie_tipo,
		sum(vl_consulta_rp) vl_consulta_rp,
		sum(vl_consulta_rc) vl_consulta_rc,
		sum(vl_consulta_re) vl_consulta_re,
		sum(vl_consulta_ie) vl_consulta_ie,
		sum(vl_exame_rp) vl_exame_rp,
		sum(vl_exame_rc) vl_exame_rc,
		sum(vl_exame_re) vl_exame_re,
		sum(vl_exame_ie) vl_exame_ie,
		sum(vl_terapia_rp) vl_terapia_rp,
		sum(vl_terapia_rc) vl_terapia_rc,
		sum(vl_terapia_re) vl_terapia_re,
		sum(vl_terapia_ie) vl_terapia_ie,
		sum(vl_intern_rp) vl_intern_rp,
		sum(vl_intern_rc) vl_intern_rc,
		sum(vl_intern_re) vl_intern_re,
		sum(vl_intern_ie) vl_intern_ie,
		sum(vl_atendimento_rp) vl_atendimento_rp,
		sum(vl_atendimento_rc) vl_atendimento_rc,
		sum(vl_atendimento_re) vl_atendimento_re,
		sum(vl_atendimento_ie) vl_atendimento_ie,
		sum(vl_despesas_rp) vl_despesas_rp,
		sum(vl_despesas_rc) vl_despesas_rc,
		sum(vl_despesas_re) vl_despesas_re,
		sum(vl_despesas_ie) vl_despesas_ie,
		sum(vl_consulta_op) vl_consulta_op,
		sum(vl_exame_op) vl_exame_op,
		sum(vl_terapia_op) vl_terapia_op,
		sum(vl_intern_op) vl_intern_op,
		sum(vl_atendimento_op) vl_atendimento_op,
		sum(vl_despesas_op) vl_despesas_op,
		sum(vl_odonto_rp) vl_odonto_rp,
		sum(vl_odonto_rc) vl_odonto_rc,
		sum(vl_odonto_re) vl_odonto_re,
		sum(vl_odonto_ie) vl_odonto_ie
	from	w_diops_fin_cob_assist
	where	nr_seq_periodo	= nr_seq_periodo_p
	group by
		ds_conta_contabil,
		ie_tipo_quadro,
		ds_plano,
		ie_cobertura,
		ie_tipo;


BEGIN
delete	from diops_fin_cob_assist
where	nr_seq_periodo	= nr_seq_periodo_p;

delete 	from w_diops_fin_cob_assist
where	nr_seq_periodo	= nr_seq_periodo_p;

ie_forma_geracao_w	:= obter_valor_param_usuario(1227,9,obter_perfil_ativo,nm_usuario_p,cd_estabelecimento_p);
pls_obter_pls_parametros(cd_estabelecimento_p,'ie_cobertura_assistencial','G',ie_cobertura_assistencial_w);

select	trunc(dt_periodo_inicial,'year'), /* Conforme conversado com Claudinei, o quadro assistencial deve gerar o acumulado do ano, assim como é o balancete */
	fim_dia(dt_periodo_final)
into STRICT	dt_periodo_inicial_w,
	dt_periodo_final_w
from	diops_periodo
where	nr_sequencia	= nr_seq_periodo_p;

select	max(a.ie_tipo_outorgante)
into STRICT	ie_tipo_outorgante_w
from	pls_outorgante	a
where	a.cd_estabelecimento	= cd_estabelecimento_p;

select	max(coalesce(ie_status_prov_pagto,'NC'))
into STRICT	ie_status_prov_pagto_w
from	pls_parametro_contabil
where	cd_estabelecimento 	= cd_estabelecimento_p;

/* HOSPITALAR */

open c_dominio;
loop
fetch c_dominio into
	ie_tipo_quadro_w,
	ie_ato_w;
EXIT WHEN NOT FOUND; /* apply on c_dominio */
	begin
	ie_tipo_w		:= 'H';

	if (ie_tipo_quadro_w = '1') then
		ds_conta_contabil_w	:= '411111' || ie_ato_w || '1';
		ie_cobertura_w		:= '1';
		ds_plano_w		:= 'IFAL';
	elsif (ie_tipo_quadro_w = '2') then
		ds_conta_contabil_w	:= '411111' || ie_ato_w || '2';
		ie_cobertura_w		:= '1';
		ds_plano_w		:= 'IFPL';
	elsif (ie_tipo_quadro_w = '3') then
		ds_conta_contabil_w	:= '411111' || ie_ato_w || '3';
		ie_cobertura_w		:= '1';
		ds_plano_w		:= 'PLAL';
	elsif (ie_tipo_quadro_w = '4') then
		ds_conta_contabil_w	:= '411111' || ie_ato_w || '4';
		ie_cobertura_w		:= '1';
		ds_plano_w		:= 'PLAP';
	elsif (ie_tipo_quadro_w = '5') then
		ds_conta_contabil_w	:= '411111' || ie_ato_w || '5';
		ie_cobertura_w		:= '1';
		ds_plano_w		:= 'PCEA';
	elsif (ie_tipo_quadro_w = '6') then
		ds_conta_contabil_w	:= '411111' || ie_ato_w || '6';
		ie_cobertura_w		:= '1';
		ds_plano_w		:= 'PCEL';--'PCEA';
	elsif (ie_tipo_quadro_w = '7') then
		ds_conta_contabil_w	:= '411112' || ie_ato_w || '1';
		ie_cobertura_w		:= '2';
		ds_plano_w		:= 'IFAL';
	elsif (ie_tipo_quadro_w = '8') then
		ds_conta_contabil_w	:= '411112' || ie_ato_w || '2';
		ie_cobertura_w		:= '2';
		ds_plano_w		:= 'IFPL';
	elsif (ie_tipo_quadro_w = '9') then
		ds_conta_contabil_w	:= '411112' || ie_ato_w || '3';
		ie_cobertura_w		:= '2';
		ds_plano_w		:= 'PLAL';
	elsif (ie_tipo_quadro_w = '10') then
		ds_conta_contabil_w	:= '411112' || ie_ato_w || '4';
		ie_cobertura_w		:= '2';
		ds_plano_w		:= 'PLAP';
	elsif (ie_tipo_quadro_w = '11') then
		ds_conta_contabil_w	:= '411112' || ie_ato_w || '5';
		ie_cobertura_w		:= '2';
		ds_plano_w		:= 'PCEA';
	elsif (ie_tipo_quadro_w = '12') then
		ds_conta_contabil_w	:= '411112' || ie_ato_w || '6';
		ie_cobertura_w		:= '2';
		ds_plano_w		:= 'PCEL';--'PCEA';
	end if;

	vl_consulta_rp_w	:= 0;
	vl_consulta_rc_w	:= 0;
	vl_consulta_re_w	:= 0;
	vl_consulta_ie_w	:= 0;
	vl_exame_rp_w		:= 0;
	vl_exame_rc_w		:= 0;
	vl_exame_re_w		:= 0;
	vl_exame_ie_w		:= 0;
	vl_terapia_rp_w		:= 0;
	vl_terapia_rc_w		:= 0;
	vl_terapia_re_w		:= 0;
	vl_terapia_ie_w		:= 0;
	vl_intern_rp_w		:= 0;
	vl_intern_rc_w		:= 0;
	vl_intern_re_w		:= 0;
	vl_intern_ie_w		:= 0;
	vl_atendimento_rp_w	:= 0;
	vl_atendimento_rc_w	:= 0;
	vl_atendimento_re_w	:= 0;
	vl_atendimento_ie_w	:= 0;
	vl_despesas_rp_w	:= 0;
	vl_despesas_rc_w	:= 0;
	vl_despesas_re_w	:= 0;
	vl_despesas_ie_w	:= 0;
	vl_exame_op_w		:= 0;
	vl_terapia_op_w		:= 0;
	vl_intern_op_w		:= 0;
	vl_atendimento_op_w	:= 0;
	vl_despesas_op_w	:= 0;

	vl_odonto_rp_w		:= 0;
	vl_odonto_rc_w		:= 0;
	vl_odonto_re_w		:= 0;
	vl_odonto_ie_w		:= 0;

	insert into w_diops_fin_cob_assist(nr_sequencia, nr_seq_periodo, ds_conta_contabil, ie_tipo_quadro,
		nm_usuario, nm_usuario_nrec, dt_atualizacao, dt_atualizacao_nrec,
		ds_plano, ie_cobertura, ie_tipo,
		vl_consulta_rp, vl_consulta_rc, vl_consulta_re, vl_consulta_ie, vl_consulta_op,
		vl_exame_rp, vl_exame_rc, vl_exame_re, vl_exame_ie, vl_exame_op,
		vl_terapia_rp, vl_terapia_rc, vl_terapia_re, vl_terapia_ie, vl_terapia_op,
		vl_intern_rp, vl_intern_rc, vl_intern_re, vl_intern_ie, vl_intern_op,
		vl_atendimento_rp, vl_atendimento_rc, vl_atendimento_re, vl_atendimento_ie, vl_atendimento_op,
		vl_despesas_rp, vl_despesas_rc, vl_despesas_re, vl_despesas_ie, vl_despesas_op,
		nr_seq_conta_proc, nr_seq_conta_mat, nr_seq_conta,
		vl_odonto_rp, vl_odonto_rc, vl_odonto_re, vl_odonto_ie)
	values (nextval('diops_fin_cob_assist_seq'), nr_seq_periodo_p, ds_conta_contabil_w, ie_tipo_quadro_w,
		nm_usuario_p, nm_usuario_p, clock_timestamp(), clock_timestamp(),
		ds_plano_w, ie_cobertura_w, ie_tipo_w,
		vl_consulta_rp_w, vl_consulta_rc_w, vl_consulta_re_w, vl_consulta_ie_w, vl_consulta_op_w,
		vl_exame_rp_w, vl_exame_rc_w, vl_exame_re_w, vl_exame_ie_w, vl_exame_op_w,
		vl_terapia_rp_w, vl_terapia_rc_w, vl_terapia_re_w, vl_terapia_ie_w, vl_terapia_op_w,
		vl_intern_rp_w, vl_intern_rc_w, vl_intern_re_w, vl_intern_ie_w, vl_intern_op_w,
		vl_atendimento_rp_w, vl_atendimento_rc_w, vl_atendimento_re_w, vl_atendimento_ie_w, vl_atendimento_op_w,
		vl_despesas_rp_w, vl_despesas_rc_w, vl_despesas_re_w, vl_despesas_ie_w, vl_despesas_op_w,
		null, null, null,
		vl_odonto_rp_w, vl_odonto_rc_w, vl_odonto_re_w, vl_odonto_ie_w);

	if (ie_cobertura_assistencial_w in ('G','GI')) then
		begin
		open c_itens_conta;
		loop
		fetch c_itens_conta into
			ie_tipo_dado_w,
			vl_liberado_w,
			ds_grupo_diops_w,
			nr_seq_conta_proc_w,
			nr_seq_conta_mat_w,
			nr_seq_conta_w;
		EXIT WHEN NOT FOUND; /* apply on c_itens_conta */
			begin

			vl_consulta_rp_w	:= 0;
			vl_consulta_rc_w	:= 0;
			vl_consulta_re_w	:= 0;
			vl_consulta_ie_w	:= 0;
			vl_exame_rp_w		:= 0;
			vl_exame_rc_w		:= 0;
			vl_exame_re_w		:= 0;
			vl_exame_ie_w		:= 0;
			vl_terapia_rp_w		:= 0;
			vl_terapia_rc_w		:= 0;
			vl_terapia_re_w		:= 0;
			vl_terapia_ie_w		:= 0;
			vl_intern_rp_w		:= 0;
			vl_intern_rc_w		:= 0;
			vl_intern_re_w		:= 0;
			vl_intern_ie_w		:= 0;
			vl_atendimento_rp_w	:= 0;
			vl_atendimento_rc_w	:= 0;
			vl_atendimento_re_w	:= 0;
			vl_atendimento_ie_w	:= 0;
			vl_despesas_rp_w	:= 0;
			vl_despesas_rc_w	:= 0;
			vl_despesas_re_w	:= 0;
			vl_despesas_ie_w	:= 0;
			vl_consulta_op_w	:= 0;
			vl_exame_op_w		:= 0;
			vl_terapia_op_w		:= 0;
			vl_intern_op_w		:= 0;
			vl_atendimento_op_w	:= 0;
			vl_despesas_op_w	:= 0;

			vl_odonto_rp_w		:= 0;
			vl_odonto_rc_w		:= 0;
			vl_odonto_re_w		:= 0;
			vl_odonto_ie_w		:= 0;

			if (ds_grupo_diops_w = 'Consultas') then
				if (ie_tipo_dado_w = 'RP') then
					vl_consulta_rp_w	:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'RC') then
					vl_consulta_rc_w	:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'RE') then
					vl_consulta_re_w	:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'IE') then
					vl_consulta_ie_w	:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'OP') then
					vl_consulta_op_w	:= coalesce(vl_liberado_w,0);
				end if;
			elsif (ds_grupo_diops_w = 'Exames') then
				if (ie_tipo_dado_w = 'RP') then
					vl_exame_rp_w		:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'RC') then
					vl_exame_rc_w		:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'RE') then
					vl_exame_re_w		:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'IE') then
					vl_exame_ie_w		:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'OP') then
					vl_exame_op_w	:= coalesce(vl_liberado_w,0);
				end if;
			elsif (ds_grupo_diops_w = 'Terapias') then
				if (ie_tipo_dado_w = 'RP') then
					vl_terapia_rp_w		:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'RC') then
					vl_terapia_rc_w		:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'RE') then
					vl_terapia_re_w		:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'IE') then
					vl_terapia_ie_w		:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'OP') then
					vl_terapia_op_w		:= coalesce(vl_liberado_w,0);
				end if;
			elsif (ds_grupo_diops_w = 'Internação') then
				if (ie_tipo_dado_w = 'RP') then
					vl_intern_rp_w		:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'RC') then
					vl_intern_rc_w		:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'RE') then
					vl_intern_re_w		:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'IE') then
					vl_intern_ie_w		:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'OP') then
					vl_intern_op_w		:= coalesce(vl_liberado_w,0);
				end if;
			elsif (ds_grupo_diops_w = 'Outros atendimentos') then
				if (ie_tipo_dado_w = 'RP') then
					vl_atendimento_rp_w	:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'RC') then
					vl_atendimento_rc_w	:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'RE') then
					vl_atendimento_re_w	:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'IE') then
					vl_atendimento_ie_w	:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'OP') then
					vl_atendimento_op_w	:= coalesce(vl_liberado_w,0);
				end if;
			elsif (ds_grupo_diops_w = 'Demais despesas') then
				if (ie_tipo_dado_w = 'RP') then
					vl_despesas_rp_w	:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'RC') then
					vl_despesas_rc_w	:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'RE') then
					vl_despesas_re_w	:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'IE') then
					vl_despesas_ie_w	:= coalesce(vl_liberado_w,0);
				elsif (ie_tipo_dado_w = 'OP') then
					vl_despesas_op_w	:= coalesce(vl_liberado_w,0);
				end if;
			end if;

			insert into w_diops_fin_cob_assist(nr_sequencia, nr_seq_periodo, ds_conta_contabil, ie_tipo_quadro,
				nm_usuario, nm_usuario_nrec, dt_atualizacao, dt_atualizacao_nrec,
				ds_plano, ie_cobertura, ie_tipo,
				vl_consulta_rp, vl_consulta_rc, vl_consulta_re, vl_consulta_ie, vl_consulta_op,
				vl_exame_rp, vl_exame_rc, vl_exame_re, vl_exame_ie, vl_exame_op,
				vl_terapia_rp, vl_terapia_rc, vl_terapia_re, vl_terapia_ie, vl_terapia_op,
				vl_intern_rp, vl_intern_rc, vl_intern_re, vl_intern_ie, vl_intern_op,
				vl_atendimento_rp, vl_atendimento_rc, vl_atendimento_re, vl_atendimento_ie, vl_atendimento_op,
				vl_despesas_rp, vl_despesas_rc, vl_despesas_re, vl_despesas_ie, vl_despesas_op,
				nr_seq_conta_proc, nr_seq_conta_mat, nr_seq_conta,
				vl_odonto_rp, vl_odonto_rc, vl_odonto_re, vl_odonto_ie)
			values (nextval('diops_fin_cob_assist_seq'), nr_seq_periodo_p, ds_conta_contabil_w, ie_tipo_quadro_w,
				nm_usuario_p, nm_usuario_p, clock_timestamp(), clock_timestamp(),
				ds_plano_w, ie_cobertura_w, ie_tipo_w,
				vl_consulta_rp_w, vl_consulta_rc_w, vl_consulta_re_w, vl_consulta_ie_w, 0,
				vl_exame_rp_w, vl_exame_rc_w, vl_exame_re_w, vl_exame_ie_w, 0,
				vl_terapia_rp_w, vl_terapia_rc_w, vl_terapia_re_w, vl_terapia_ie_w, 0,
				vl_intern_rp_w, vl_intern_rc_w, vl_intern_re_w, vl_intern_ie_w, 0,
				vl_atendimento_rp_w, vl_atendimento_rc_w, vl_atendimento_re_w, vl_atendimento_ie_w, 0,
				vl_despesas_rp_w, vl_despesas_rc_w, vl_despesas_re_w, vl_despesas_ie_w, 0,
				nr_seq_conta_proc_w, nr_seq_conta_mat_w, nr_seq_conta_w,
				vl_odonto_rp_w, vl_odonto_rc_w, vl_odonto_re_w, vl_odonto_ie_w);
			end;
		end loop;
		close c_itens_conta;

		open c_coparticipacao;
		loop
		fetch c_coparticipacao into
			ie_tipo_dado_w,
			vl_liberado_w,
			ds_grupo_diops_w,
			nr_seq_conta_proc_w,
			nr_seq_conta_mat_w,
			nr_seq_conta_w,
			nr_seq_conta_copartic_w;
		EXIT WHEN NOT FOUND; /* apply on c_coparticipacao */
			begin
			vl_consulta_rp_w	:= 0;
			vl_consulta_rc_w	:= 0;
			vl_consulta_re_w	:= 0;
			vl_consulta_ie_w	:= 0;
			vl_exame_rp_w		:= 0;
			vl_exame_rc_w		:= 0;
			vl_exame_re_w		:= 0;
			vl_exame_ie_w		:= 0;
			vl_terapia_rp_w		:= 0;
			vl_terapia_rc_w		:= 0;
			vl_terapia_re_w		:= 0;
			vl_terapia_ie_w		:= 0;
			vl_intern_rp_w		:= 0;
			vl_intern_rc_w		:= 0;
			vl_intern_re_w		:= 0;
			vl_intern_ie_w		:= 0;
			vl_atendimento_rp_w	:= 0;
			vl_atendimento_rc_w	:= 0;
			vl_atendimento_re_w	:= 0;
			vl_atendimento_ie_w	:= 0;
			vl_despesas_rp_w	:= 0;
			vl_despesas_rc_w	:= 0;
			vl_despesas_re_w	:= 0;
			vl_despesas_ie_w	:= 0;
			vl_consulta_op_w	:= 0;
			vl_exame_op_w		:= 0;
			vl_terapia_op_w		:= 0;
			vl_intern_op_w		:= 0;
			vl_atendimento_op_w	:= 0;
			vl_despesas_op_w	:= 0;
			vl_odonto_rp_w		:= 0;
			vl_odonto_rc_w		:= 0;
			vl_odonto_re_w		:= 0;
			vl_odonto_ie_w		:= 0;

			if (ds_grupo_diops_w = 'Consultas') then
				if (ie_tipo_dado_w = 'RP') then
					vl_consulta_rp_w	:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'RC') then
					vl_consulta_rc_w	:= coalesce(vl_liberado_w,0)  * -1;
				elsif (ie_tipo_dado_w = 'RE') then
					vl_consulta_re_w	:= coalesce(vl_liberado_w,0)  * -1;
				elsif (ie_tipo_dado_w = 'IE') then
					vl_consulta_ie_w	:= coalesce(vl_liberado_w,0)  * -1;
				elsif (ie_tipo_dado_w = 'OP') then
					vl_consulta_op_w	:= coalesce(vl_liberado_w,0)  * -1;
				end if;
			elsif (ds_grupo_diops_w = 'Exames') then
				if (ie_tipo_dado_w = 'RP') then
					vl_exame_rp_w		:= coalesce(vl_liberado_w,0)  * -1;
				elsif (ie_tipo_dado_w = 'RC') then
					vl_exame_rc_w		:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'RE') then
					vl_exame_re_w		:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'IE') then
					vl_exame_ie_w		:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'OP') then
					vl_exame_op_w		:= coalesce(vl_liberado_w,0)  * -1;
				end if;
			elsif (ds_grupo_diops_w = 'Terapias') then
				if (ie_tipo_dado_w = 'RP') then
					vl_terapia_rp_w		:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'RC') then
					vl_terapia_rc_w		:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'RE') then
					vl_terapia_re_w		:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'IE') then
					vl_terapia_ie_w		:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'OP') then
					vl_terapia_op_w		:= coalesce(vl_liberado_w,0)  * -1;
				end if;
			elsif (ds_grupo_diops_w = 'Internação') then
				if (ie_tipo_dado_w = 'RP') then
					vl_intern_rp_w		:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'RC') then
					vl_intern_rc_w		:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'RE') then
					vl_intern_re_w		:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'IE') then
					vl_intern_ie_w		:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'OP') then
					vl_intern_op_w		:= coalesce(vl_liberado_w,0)  * -1;
				end if;
			elsif (ds_grupo_diops_w = 'Outros atendimentos') then
				if (ie_tipo_dado_w = 'RP') then
					vl_atendimento_rp_w	:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'RC') then
					vl_atendimento_rc_w	:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'RE') then
					vl_atendimento_re_w	:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'IE') then
					vl_atendimento_ie_w	:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'OP') then
					vl_atendimento_op_w	:= coalesce(vl_liberado_w,0)  * -1;
				end if;
			elsif (ds_grupo_diops_w = 'Demais despesas') then
				if (ie_tipo_dado_w = 'RP') then
					vl_despesas_rp_w	:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'RC') then
					vl_despesas_rc_w	:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'RE') then
					vl_despesas_re_w	:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'IE') then
					vl_despesas_ie_w	:= coalesce(vl_liberado_w,0) * -1;
				elsif (ie_tipo_dado_w = 'OP') then
					vl_despesas_op_w	:= coalesce(vl_liberado_w,0)  * -1;
				end if;
			end if;

			insert into w_diops_fin_cob_assist(nr_sequencia, nr_seq_periodo, ds_conta_contabil, ie_tipo_quadro,
				nm_usuario, nm_usuario_nrec, dt_atualizacao, dt_atualizacao_nrec,
				ds_plano, ie_cobertura, ie_tipo,
				vl_consulta_rp, vl_consulta_rc, vl_consulta_re, vl_consulta_ie,
				vl_exame_rp, vl_exame_rc, vl_exame_re, vl_exame_ie,
				vl_terapia_rp, vl_terapia_rc, vl_terapia_re, vl_terapia_ie,
				vl_intern_rp, vl_intern_rc, vl_intern_re, vl_intern_ie,
				vl_atendimento_rp, vl_atendimento_rc, vl_atendimento_re, vl_atendimento_ie,
				vl_despesas_rp, vl_despesas_rc, vl_despesas_re, vl_despesas_ie,
				nr_seq_conta_proc, nr_seq_conta_mat, nr_seq_conta, nr_seq_conta_copartic,
				vl_odonto_rp, vl_odonto_rc, vl_odonto_re, vl_odonto_ie)
			values (nextval('diops_fin_cob_assist_seq'), nr_seq_periodo_p, ds_conta_contabil_w, ie_tipo_quadro_w,
				nm_usuario_p, nm_usuario_p, clock_timestamp(), clock_timestamp(),
				ds_plano_w, ie_cobertura_w, ie_tipo_w,
				vl_consulta_rp_w, vl_consulta_rc_w, vl_consulta_re_w, vl_consulta_ie_w,
				vl_exame_rp_w, vl_exame_rc_w, vl_exame_re_w, vl_exame_ie_w,
				vl_terapia_rp_w, vl_terapia_rc_w, vl_terapia_re_w, vl_terapia_ie_w,
				vl_intern_rp_w, vl_intern_rc_w, vl_intern_re_w, vl_intern_ie_w,
				vl_atendimento_rp_w, vl_atendimento_rc_w, vl_atendimento_re_w, vl_atendimento_ie_w,
				vl_despesas_rp_w, vl_despesas_rc_w, vl_despesas_re_w, vl_despesas_ie_w,
				nr_seq_conta_proc_w, nr_seq_conta_mat_w, nr_seq_conta_w, nr_seq_conta_copartic_w,
				vl_odonto_rp_w, vl_odonto_rc_w, vl_odonto_re_w, vl_odonto_ie_w);
			end;
		end loop;
		close c_coparticipacao;
		end;
	end if;
	end;
end loop;
close c_dominio;

/* ODONTOLÓGICO */

open c_dominio;
loop
fetch c_dominio into
	ie_tipo_quadro_w,
	ie_ato_w;
EXIT WHEN NOT FOUND; /* apply on c_dominio */
	begin
	ie_tipo_w		:= 'O';

	if (ie_tipo_quadro_w = '1') then
		ds_conta_contabil_w	:= '411121' || ie_ato_w || '1';
		ie_cobertura_w		:= '1';
		ds_plano_w		:= 'IFAL';
	elsif (ie_tipo_quadro_w = '2') then
		ds_conta_contabil_w	:= '411121' || ie_ato_w || '2';
		ie_cobertura_w		:= '1';
		ds_plano_w		:= 'IFPL';
	elsif (ie_tipo_quadro_w = '3') then
		ds_conta_contabil_w	:= '411121' || ie_ato_w || '3';
		ie_cobertura_w		:= '1';
		ds_plano_w		:= 'PLAL';
	elsif (ie_tipo_quadro_w = '4') then
		ds_conta_contabil_w	:= '411121' || ie_ato_w || '4';
		ie_cobertura_w		:= '1';
		ds_plano_w		:= 'PLAP';
	elsif (ie_tipo_quadro_w = '5') then
		ds_conta_contabil_w	:= '411121' || ie_ato_w || '5';
		ie_cobertura_w		:= '1';
		ds_plano_w		:= 'PCEA';
	elsif (ie_tipo_quadro_w = '6') then
		ds_conta_contabil_w	:= '411121' || ie_ato_w || '6';
		ie_cobertura_w		:= '1';
		ds_plano_w		:= 'PCEL';
	elsif (ie_tipo_quadro_w = '7') then
		ds_conta_contabil_w	:= '411122' || ie_ato_w || '1';
		ie_cobertura_w		:= '2';
		ds_plano_w		:= 'IFAL';
	elsif (ie_tipo_quadro_w = '8') then
		ds_conta_contabil_w	:= '411122' || ie_ato_w || '2';
		ie_cobertura_w		:= '2';
		ds_plano_w		:= 'IFPL';
	elsif (ie_tipo_quadro_w = '9') then
		ds_conta_contabil_w	:= '411122' || ie_ato_w || '3';
		ie_cobertura_w		:= '2';
		ds_plano_w		:= 'PLAL';
	elsif (ie_tipo_quadro_w = '10') then
		ds_conta_contabil_w	:= '411122' || ie_ato_w || '4';
		ie_cobertura_w		:= '2';
		ds_plano_w		:= 'PLAP';
	elsif (ie_tipo_quadro_w = '11') then
		ds_conta_contabil_w	:= '411122' || ie_ato_w || '5';
		ie_cobertura_w		:= '2';
		ds_plano_w		:= 'PCEA';
	elsif (ie_tipo_quadro_w = '12') then
		ds_conta_contabil_w	:= '411122' || ie_ato_w || '6';
		ie_cobertura_w		:= '2';
		ds_plano_w		:= 'PCEL';
	end if;

	vl_consulta_rp_w	:= null;
	vl_consulta_rc_w	:= null;
	vl_consulta_re_w	:= null;
	vl_consulta_ie_w	:= null;
	vl_exame_rp_w		:= null;
	vl_exame_rc_w		:= null;
	vl_exame_re_w		:= null;
	vl_exame_ie_w		:= null;
	vl_terapia_rp_w		:= null;
	vl_terapia_rc_w		:= null;
	vl_terapia_re_w		:= null;
	vl_terapia_ie_w		:= null;
	vl_intern_rp_w		:= null;
	vl_intern_rc_w		:= null;
	vl_intern_re_w		:= null;
	vl_intern_ie_w		:= null;
	vl_atendimento_rp_w	:= null;
	vl_atendimento_rc_w	:= null;
	vl_atendimento_re_w	:= null;
	vl_atendimento_ie_w	:= null;
	vl_despesas_rp_w	:= null;
	vl_despesas_rc_w	:= null;
	vl_despesas_re_w	:= null;
	vl_despesas_ie_w	:= null;
	vl_consulta_op_w	:= null;
	vl_exame_op_w		:= null;
	vl_terapia_op_w		:= null;
	vl_intern_op_w		:= null;
	vl_atendimento_op_w	:= null;
	vl_despesas_op_w	:= null;

	vl_odonto_rp_w		:= 0;
	vl_odonto_rc_w		:= 0;
	vl_odonto_re_w		:= 0;
	vl_odonto_ie_w		:= 0;

	insert into w_diops_fin_cob_assist(nr_sequencia, nr_seq_periodo, ds_conta_contabil, ie_tipo_quadro,
		nm_usuario, nm_usuario_nrec, dt_atualizacao, dt_atualizacao_nrec,
		ds_plano, ie_cobertura, ie_tipo,
		vl_consulta_rp, vl_consulta_rc, vl_consulta_re, vl_consulta_ie, vl_consulta_op,
		vl_exame_rp, vl_exame_rc, vl_exame_re, vl_exame_ie, vl_exame_op,
		vl_terapia_rp, vl_terapia_rc, vl_terapia_re, vl_terapia_ie, vl_terapia_op,
		vl_intern_rp, vl_intern_rc, vl_intern_re, vl_intern_ie, vl_intern_op,
		vl_atendimento_rp, vl_atendimento_rc, vl_atendimento_re, vl_atendimento_ie, vl_atendimento_op,
		vl_despesas_rp, vl_despesas_rc, vl_despesas_re, vl_despesas_ie, vl_despesas_op,
		nr_seq_conta_proc, nr_seq_conta_mat, nr_seq_conta,
		vl_odonto_rp, vl_odonto_rc, vl_odonto_re, vl_odonto_ie)
	values (nextval('diops_fin_cob_assist_seq'), nr_seq_periodo_p, ds_conta_contabil_w, ie_tipo_quadro_w,
		nm_usuario_p, nm_usuario_p, clock_timestamp(), clock_timestamp(),
		ds_plano_w, ie_cobertura_w, ie_tipo_w,
		vl_consulta_rp_w, vl_consulta_rc_w, vl_consulta_re_w, vl_consulta_ie_w, 0,
		vl_exame_rp_w, vl_exame_rc_w, vl_exame_re_w, vl_exame_ie_w, 0,
		vl_terapia_rp_w, vl_terapia_rc_w, vl_terapia_re_w, vl_terapia_ie_w, 0,
		vl_intern_rp_w, vl_intern_rc_w, vl_intern_re_w, vl_intern_ie_w, 0,
		vl_atendimento_rp_w, vl_atendimento_rc_w, vl_atendimento_re_w, vl_atendimento_ie_w, 0,
		vl_despesas_rp_w, vl_despesas_rc_w, vl_despesas_re_w, vl_despesas_ie_w, 0,
		null, null, null,
		vl_odonto_rp_w, vl_odonto_rc_w, vl_odonto_re_w, vl_odonto_ie_w);

	if (ie_cobertura_assistencial_w in ('G','GI')) then
		begin
		open c_itens_conta;
		loop
		fetch c_itens_conta into
			ie_tipo_dado_w,
			vl_liberado_w,
			ds_grupo_diops_w,
			nr_seq_conta_proc_w,
			nr_seq_conta_mat_w,
			nr_seq_conta_w;
		EXIT WHEN NOT FOUND; /* apply on c_itens_conta */
			begin

			vl_consulta_rp_w	:= null;
			vl_consulta_rc_w	:= null;
			vl_consulta_re_w	:= null;
			vl_consulta_ie_w	:= null;
			vl_exame_rp_w		:= null;
			vl_exame_rc_w		:= null;
			vl_exame_re_w		:= null;
			vl_exame_ie_w		:= null;
			vl_terapia_rp_w		:= null;
			vl_terapia_rc_w		:= null;
			vl_terapia_re_w		:= null;
			vl_terapia_ie_w		:= null;
			vl_intern_rp_w		:= null;
			vl_intern_rc_w		:= null;
			vl_intern_re_w		:= null;
			vl_intern_ie_w		:= null;
			vl_atendimento_rp_w	:= null;
			vl_atendimento_rc_w	:= null;
			vl_atendimento_re_w	:= null;
			vl_atendimento_ie_w	:= null;
			vl_despesas_rp_w	:= null;
			vl_despesas_rc_w	:= null;
			vl_despesas_re_w	:= null;
			vl_despesas_ie_w	:= null;

			vl_odonto_rp_w		:= 0;
			vl_odonto_rc_w		:= 0;
			vl_odonto_re_w		:= 0;
			vl_odonto_ie_w		:= 0;

			if (ie_tipo_dado_w = 'RP') then
				vl_odonto_rp_w	:= coalesce(vl_liberado_w,0);
			elsif (ie_tipo_dado_w = 'RC') then
				vl_odonto_rc_w	:= coalesce(vl_liberado_w,0);
			elsif (ie_tipo_dado_w = 'RE') then
				vl_odonto_re_w	:= coalesce(vl_liberado_w,0);
			elsif (ie_tipo_dado_w = 'IE') then
				vl_odonto_ie_w	:= coalesce(vl_liberado_w,0);
			end if;

			insert into w_diops_fin_cob_assist(nr_sequencia, nr_seq_periodo, ds_conta_contabil, ie_tipo_quadro,
				nm_usuario, nm_usuario_nrec, dt_atualizacao, dt_atualizacao_nrec,
				ds_plano, ie_cobertura, ie_tipo,
				vl_consulta_rp, vl_consulta_rc, vl_consulta_re, vl_consulta_ie,
				vl_exame_rp, vl_exame_rc, vl_exame_re, vl_exame_ie,
				vl_terapia_rp, vl_terapia_rc, vl_terapia_re, vl_terapia_ie,
				vl_intern_rp, vl_intern_rc, vl_intern_re, vl_intern_ie,
				vl_atendimento_rp, vl_atendimento_rc, vl_atendimento_re, vl_atendimento_ie,
				vl_despesas_rp, vl_despesas_rc, vl_despesas_re, vl_despesas_ie,
				nr_seq_conta_proc, nr_seq_conta_mat, nr_seq_conta,
				vl_odonto_rp, vl_odonto_rc, vl_odonto_re, vl_odonto_ie)
			values (nextval('diops_fin_cob_assist_seq'), nr_seq_periodo_p, ds_conta_contabil_w, ie_tipo_quadro_w,
				nm_usuario_p, nm_usuario_p, clock_timestamp(), clock_timestamp(),
				ds_plano_w, ie_cobertura_w, ie_tipo_w,
				vl_consulta_rp_w, vl_consulta_rc_w, vl_consulta_re_w, vl_consulta_ie_w,
				vl_exame_rp_w, vl_exame_rc_w, vl_exame_re_w, vl_exame_ie_w,
				vl_terapia_rp_w, vl_terapia_rc_w, vl_terapia_re_w, vl_terapia_ie_w,
				vl_intern_rp_w, vl_intern_rc_w, vl_intern_re_w, vl_intern_ie_w,
				vl_atendimento_rp_w, vl_atendimento_rc_w, vl_atendimento_re_w, vl_atendimento_ie_w,
				vl_despesas_rp_w, vl_despesas_rc_w, vl_despesas_re_w, vl_despesas_ie_w,
				nr_seq_conta_proc_w, nr_seq_conta_mat_w, nr_seq_conta_w,
				vl_odonto_rp_w, vl_odonto_rc_w, vl_odonto_re_w, vl_odonto_ie_w);
			end;
		end loop;
		close c_itens_conta;

		open c_coparticipacao;
		loop
		fetch c_coparticipacao into
			ie_tipo_dado_w,
			vl_liberado_w,
			ds_grupo_diops_w,
			nr_seq_conta_proc_w,
			nr_seq_conta_mat_w,
			nr_seq_conta_w,
			nr_seq_conta_copartic_w;
		EXIT WHEN NOT FOUND; /* apply on c_coparticipacao */
			begin
			vl_consulta_rp_w	:= null;
			vl_consulta_rc_w	:= null;
			vl_consulta_re_w	:= null;
			vl_consulta_ie_w	:= null;
			vl_exame_rp_w		:= null;
			vl_exame_rc_w		:= null;
			vl_exame_re_w		:= null;
			vl_exame_ie_w		:= null;
			vl_terapia_rp_w		:= null;
			vl_terapia_rc_w		:= null;
			vl_terapia_re_w		:= null;
			vl_terapia_ie_w		:= null;
			vl_intern_rp_w		:= null;
			vl_intern_rc_w		:= null;
			vl_intern_re_w		:= null;
			vl_intern_ie_w		:= null;
			vl_atendimento_rp_w	:= null;
			vl_atendimento_rc_w	:= null;
			vl_atendimento_re_w	:= null;
			vl_atendimento_ie_w	:= null;
			vl_despesas_rp_w	:= null;
			vl_despesas_rc_w	:= null;
			vl_despesas_re_w	:= null;
			vl_despesas_ie_w	:= null;

			vl_odonto_rp_w		:= 0;
			vl_odonto_rc_w		:= 0;
			vl_odonto_re_w		:= 0;
			vl_odonto_ie_w		:= 0;

			if (ie_tipo_dado_w = 'RP') then
				vl_odonto_rp_w	:= coalesce(vl_liberado_w,0) * -1;
			elsif (ie_tipo_dado_w = 'RC') then
				vl_odonto_rc_w	:= coalesce(vl_liberado_w,0) * -1;
			elsif (ie_tipo_dado_w = 'RE') then
				vl_odonto_re_w	:= coalesce(vl_liberado_w,0) * -1;
			elsif (ie_tipo_dado_w = 'IE') then
				vl_odonto_ie_w	:= coalesce(vl_liberado_w,0) * -1;
			end if;

			insert into w_diops_fin_cob_assist(nr_sequencia, nr_seq_periodo, ds_conta_contabil, ie_tipo_quadro,
				nm_usuario, nm_usuario_nrec, dt_atualizacao, dt_atualizacao_nrec,
				ds_plano, ie_cobertura, ie_tipo,
				vl_consulta_rp, vl_consulta_rc, vl_consulta_re, vl_consulta_ie,
				vl_exame_rp, vl_exame_rc, vl_exame_re, vl_exame_ie,
				vl_terapia_rp, vl_terapia_rc, vl_terapia_re, vl_terapia_ie,
				vl_intern_rp, vl_intern_rc, vl_intern_re, vl_intern_ie,
				vl_atendimento_rp, vl_atendimento_rc, vl_atendimento_re, vl_atendimento_ie,
				vl_despesas_rp, vl_despesas_rc, vl_despesas_re, vl_despesas_ie,
				nr_seq_conta_proc, nr_seq_conta_mat, nr_seq_conta, nr_seq_conta_copartic,
				vl_odonto_rp, vl_odonto_rc, vl_odonto_re, vl_odonto_ie)
			values (nextval('diops_fin_cob_assist_seq'), nr_seq_periodo_p, ds_conta_contabil_w, ie_tipo_quadro_w,
				nm_usuario_p, nm_usuario_p, clock_timestamp(), clock_timestamp(),
				ds_plano_w, ie_cobertura_w, ie_tipo_w,
				vl_consulta_rp_w, vl_consulta_rc_w, vl_consulta_re_w, vl_consulta_ie_w,
				vl_exame_rp_w, vl_exame_rc_w, vl_exame_re_w, vl_exame_ie_w,
				vl_terapia_rp_w, vl_terapia_rc_w, vl_terapia_re_w, vl_terapia_ie_w,
				vl_intern_rp_w, vl_intern_rc_w, vl_intern_re_w, vl_intern_ie_w,
				vl_atendimento_rp_w, vl_atendimento_rc_w, vl_atendimento_re_w, vl_atendimento_ie_w,
				vl_despesas_rp_w, vl_despesas_rc_w, vl_despesas_re_w, vl_despesas_ie_w,
				nr_seq_conta_proc_w, nr_seq_conta_mat_w, nr_seq_conta_w, nr_seq_conta_copartic_w,
				vl_odonto_rp_w, vl_odonto_rc_w, vl_odonto_re_w, vl_odonto_ie_w);
			end;
		end loop;
		close c_coparticipacao;
		end;
	end if;
	end;
end loop;
close c_dominio;

vl_consulta_rp_w	:= 0;
vl_consulta_rc_w	:= 0;
vl_consulta_re_w	:= 0;
vl_consulta_ie_w	:= 0;
vl_exame_rp_w		:= 0;
vl_exame_rc_w		:= 0;
vl_exame_re_w		:= 0;
vl_exame_ie_w		:= 0;
vl_terapia_rp_w		:= 0;
vl_terapia_rc_w		:= 0;
vl_terapia_re_w		:= 0;
vl_terapia_ie_w		:= 0;
vl_intern_rp_w		:= 0;
vl_intern_rc_w		:= 0;
vl_intern_re_w		:= 0;
vl_intern_ie_w		:= 0;
vl_atendimento_rp_w	:= 0;
vl_atendimento_rc_w	:= 0;
vl_atendimento_re_w	:= 0;
vl_atendimento_ie_w	:= 0;
vl_despesas_rp_w	:= 0;
vl_despesas_rc_w	:= 0;
vl_despesas_re_w	:= 0;
vl_despesas_ie_w	:= 0;
vl_consulta_op_w        := 0;
vl_exame_op_w           := 0;
vl_terapia_op_w         := 0;
vl_intern_op_w          := 0;
vl_atendimento_op_w     := 0;
vl_despesas_op_w        := 0;

open c_agrupador;
loop
fetch c_agrupador into
	ds_conta_contabil_w,
	ie_tipo_quadro_w,
	ds_plano_w,
	ie_cobertura_w,
	ie_tipo_w,
	vl_consulta_rp_w,
	vl_consulta_rc_w,
	vl_consulta_re_w,
	vl_consulta_ie_w,
	vl_exame_rp_w,
	vl_exame_rc_w,
	vl_exame_re_w,
	vl_exame_ie_w,
	vl_terapia_rp_w,
	vl_terapia_rc_w,
	vl_terapia_re_w,
	vl_terapia_ie_w,
	vl_intern_rp_w,
	vl_intern_rc_w,
	vl_intern_re_w,
	vl_intern_ie_w,
	vl_atendimento_rp_w,
	vl_atendimento_rc_w,
	vl_atendimento_re_w,
	vl_atendimento_ie_w,
	vl_despesas_rp_w,
	vl_despesas_rc_w,
	vl_despesas_re_w,
	vl_despesas_ie_w,
	vl_consulta_op_w,
	vl_exame_op_w,
	vl_terapia_op_w,
	vl_intern_op_w,
	vl_atendimento_op_w,
	vl_odonto_rp_w,
	vl_odonto_rc_w,
	vl_despesas_op_w,
	vl_odonto_re_w,
	vl_odonto_ie_w;
EXIT WHEN NOT FOUND; /* apply on c_agrupador */
	begin
	insert into diops_fin_cob_assist(nr_sequencia, nr_seq_periodo, ds_conta_contabil, ie_tipo_quadro,
		nm_usuario, nm_usuario_nrec, dt_atualizacao, dt_atualizacao_nrec,
		ds_plano, ie_cobertura, ie_tipo,
		vl_consulta_rp, vl_consulta_rc, vl_consulta_re, vl_consulta_ie, vl_consulta_op,
		vl_exame_rp, vl_exame_rc, vl_exame_re, vl_exame_ie, vl_exame_op,
		vl_terapia_rp, vl_terapia_rc, vl_terapia_re, vl_terapia_ie, vl_terapia_op,
		vl_intern_rp, vl_intern_rc, vl_intern_re, vl_intern_ie, vl_intern_op,
		vl_atendimento_rp, vl_atendimento_rc, vl_atendimento_re, vl_atendimento_ie, vl_atendimento_op,
		vl_despesas_rp, vl_despesas_rc, vl_despesas_re, vl_despesas_ie, vl_despesas_op,
		vl_odonto_rp, vl_odonto_rc, vl_odonto_re, vl_odonto_ie)
	values (nextval('diops_fin_cob_assist_seq'), nr_seq_periodo_p, ds_conta_contabil_w, ie_tipo_quadro_w,
		nm_usuario_p, nm_usuario_p, clock_timestamp(), clock_timestamp(),
		ds_plano_w, ie_cobertura_w, ie_tipo_w,
		vl_consulta_rp_w, vl_consulta_rc_w, vl_consulta_re_w, vl_consulta_ie_w, 0,
		vl_exame_rp_w, vl_exame_rc_w, vl_exame_re_w, vl_exame_ie_w, 0,
		vl_terapia_rp_w, vl_terapia_rc_w, vl_terapia_re_w, vl_terapia_ie_w, 0,
		vl_intern_rp_w, vl_intern_rc_w, vl_intern_re_w, vl_intern_ie_w, 0,
		vl_atendimento_rp_w, vl_atendimento_rc_w, vl_atendimento_re_w, vl_atendimento_ie_w, 0,
		vl_despesas_rp_w, vl_despesas_rc_w, vl_despesas_re_w, vl_despesas_ie_w, 0,
		vl_odonto_rp_w, vl_odonto_rc_w, vl_odonto_re_w, vl_odonto_ie_w);
	end;
end loop;
close c_agrupador;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE diops_fin_gerar_assistencial ( nr_seq_periodo_p bigint, nm_usuario_p text, cd_estabelecimento_p bigint) FROM PUBLIC;

