-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE execute_bifrost_integration ( cd_integration_p bigint, ds_parameters_p text, nm_usuario_p text default null) AS $body$
DECLARE

			
/*
01 - directcontrol.oec
02 - directcontrol.oec.resend
03 - directcontrol.encounter.billing
04 - directcontrol.transmitihc.resend
05 - patient.registration.update
07 - patient.address.update
10 - patient.admission
15 - patient.create
17 - patient.insurance.update
20 - patient.discharge
30 - patient.transfer
40 - patient.vitalsigns.result

50 - prescription.image.order.request
60 - prescription.image.order.update
70 - prescription.image.order.report.result
80 - prescription.image.order.report.acknowledged

90 - prescription.laboratory.order.request
100 - prescription.laboratory.order.update
110 - prescription.laboratory.order.report.result
120 - prescription.laboratory.order.report.acknowledged

130 - cpoe.batch.order.request

150 - generate.report
160 - send.batch.accounting


165 - directcontrol.transmitclaim
166 - directcontrol.transmitclaim.resend
167 - directcontrol.era
168 - directcontrol.transmitpc


170 - mhr.upload.discharge.summary
172 - mhr.upload.event.summary
174 - mhr.download.document
175 - mhr.create.discharge.summary.file
176 - mhr.create.event.summary.file
178 - mhr.patient.records.refresh
180 - mhr.remove.document
182 - mhr.supersede.discharge.summary
184 - mhr.supersede.event.summary
185 - mhr.patient.pcehr.exist

187 - eclipse.oec.request
188 - eclipse.dva.request
189 - eclipse.dvr.request
190 - eclipse.dvy.request
191 - eclipse.rtv.request

195 - surgery.image.order.request

196 - patient.discharge.cancel
197 - patient.admission.cancel

198 - eclipse.sts.era.event
199 - eclipse.dbs.event

200 - directcontrol.private.fund.eligibilitycheck

201 - eclipse.dpr.event
202 - eclipse.dpy.event

203 - patient.information.update

204 - laboratory.report.result
206 - eclipse.ihc.sts.batch.event

262 - order.requested
263 - order.medication.item.cancel

271 - nais.mla.injection
272 - nais.mla.radiology
273 - nais.mla.physiology
281 - nais.mla.InpatientPrescription.batch	
282	- nais.mla.outpatient.orderbatch

303 - nais.mla.bloodtransfusion

*/
			

jobno 						bigint;
ds_event_w					varchar(255);
ds_java_class_w				varchar(255);
ie_use_integration_w		varchar(2);
ie_tasy_backend_w 			char := null;
ds_parameters_w         	text := ds_parameters_p;
return_w                	text;
ie_si_or_sic_w				varchar(3) := 'SI';

EXECUTE_DISPENSARY_SECTOR	constant integer := 353;
EXECUTE_DISPENSARY_SECTOR_EVT constant varchar(30) := 'tasy.send.sectors.equipament';

EXECUTE_DISPENSARY_PATIENTS	constant integer := 454;
EXECUTE_DISPENSARY_PATIENT_EVT constant varchar(33) := 'tasy.send.pte.answered.equipament';

EXECUTE_DISPENSARY_PRESCR	constant integer := 666;
EXECUTE_DISPENSARY_PRESCR_EVT constant varchar(35) := 'tasy.send.presc.answered.equipament';

SUS_GERPAC_REQUEST	constant integer := 997;
SUS_GERPAC_REQUEST_EVT 	constant varchar(27) := 'billing.apac.gerpac.request';

PERFORM_APAC_PARAM_RQT	constant integer := 1000;
PERFORM_APAC_PARAM_RQT_EVT constant varchar(32) := 'billing.performAPACParam.request';

SUS_APAC_EXECUTOR_REQUEST constant integer := 1002;
SUS_APAC_EXECUTOR_REQUEST_EVT constant varchar(29) := 'billing.sus.get.apac.executor';

SUS_GERPAC_PATIENT_REQUEST constant integer := 1003;
SUS_GERPAC_PATIENT_REQUEST_EVT constant varchar(40) := 'billing.sus.get.apac.request.patient';

EXECUTE_DISPENSARY_USER	constant integer := 1074;
EXECUTE_DISPENSARY_USER_EVT constant varchar(26) := 'tasy.send.users.equipament';

EXECUTE_DISPENSARY_PRODUCT	constant integer := 1077;
EXECUTE_DISPENSARY_PRODUCT_EVT constant varchar(27) := 'tasy.send.matmed.equipament';

EXECUTE_DISPENSARY_KIT	constant integer := 1078;
EXECUTE_DISPENSARY_KIT_EVT constant varchar(26) := 'tasy.send.kits.equipament';

EXECUTE_DISPENSARY_PAT_REL	constant integer := 1080;
EXECUTE_DISPENSARY_PAT_REL_EVT constant varchar(34) := 'tasy.send.pte.discharge.equipament';

EXECUTE_DISPENSARY_PRC_SUSP	constant integer := 984;
EXECUTE_DISPENSARY_PRC_SSP_EVT constant varchar(36) := 'tasy.send.presc.suspended.equipament';

EXECUTE_DISPENSARY_RESS	constant integer := 1155;
EXECUTE_DISPENSARY_RESS_EVT constant varchar(40) := 'tasy.send.replacement.matmed.equipament';

EXC_DADO_CLI_RT_TIE_RES	constant integer := 1172;
EXC_DADO_CLI_RT_TIE_RES_EVT constant varchar(36) := 'api.unimedbh.elegibilidade.oncologia';


BEGIN



if (cd_integration_p = 1) then
	ds_event_w 	:= 'directcontrol.oec';	
	ds_java_class_w	:= 'com.philips.tasy.integration.rcm.accounting.appointment.outbound.Appointment';	
elsif (cd_integration_p = 2) then
	ds_event_w 	:= 'directcontrol.oec.resend';
	ds_java_class_w	:= 'com.philips.tasy.integration.rcm.accounting.appointment.outbound.Appointment';
elsif (cd_integration_p = 3) then
	ds_event_w 	:= 'directcontrol.encounter.billing';
	ds_java_class_w	:= 'com.philips.tasy.integration.rcm.billing.outbound.EpisodeAndTransmitClaims';	
elsif (cd_integration_p = 4) then
	ds_event_w 	:= 'directcontrol.transmitihc.resend';
	ds_java_class_w	:= 'com.philips.tasy.integration.rcm.billing.outbound.TransmitClaims';	
elsif (cd_integration_p = 5) then
	ds_event_w 	:= 'patient.registration.update';
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.encounter.admission.outbound.PatientRegistration';	
elsif (cd_integration_p = 6) then
	ds_event_w 	:= 'transmit.era';
	ds_java_class_w	:= 'com.philips.tasy.integration.rcm.accounting.claims.outbound.ClaimsDateRange';
elsif (cd_integration_p = 7) then
	ds_event_w 	:= 'patient.address.update';
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.encounter.admission.outbound.PatientRegistration';
elsif (cd_integration_p = 10) then
	ds_event_w 	:= 'patient.admission';
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.encounter.admission.outbound.Admission';
elsif (cd_integration_p = 15) then
	ds_event_w 	:= 'patient.create';	
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.encounter.admission.outbound.PatientRegistration';	
elsif (cd_integration_p = 17) then
	ds_event_w 	:= 'patient.insurance.update';	
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.encounter.admission.outbound.PatientRegistration';		
elsif (cd_integration_p = 20) then
	ds_event_w 	:= 'patient.discharge';
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.encounter.admission.outbound.AdmissionDischageTransfer';	
elsif (cd_integration_p = 30) then
	ds_event_w 	:= 'patient.transfer';
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.encounter.transfer.outbound.Transfer';	
elsif (cd_integration_p = 40) then
	ds_event_w 	:= 'patient.vitalsigns.result';
	ds_java_class_w	:= '';	
elsif (cd_integration_p = 50) then
	ds_event_w 	:= 'prescription.image.order.request';
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.image.order.outbound.ImageExamOrder';	
elsif (cd_integration_p = 60) then
	ds_event_w 	:= 'prescription.image.order.update';
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.image.order.outbound.ImageExamOrder';	
elsif (cd_integration_p = 70) then
	ds_event_w 	:= 'prescription.image.order.report.result';
	ds_java_class_w	:= '';	
elsif (cd_integration_p = 80) then
	ds_event_w 	:= 'prescription.image.order.report.acknowledged';
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.image.order.outbound.ImageExamOrder';	
elsif (cd_integration_p = 90) then
	ds_event_w 	:= 'prescription.laboratory.order.request';	
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.laboratory.order.outbound.LabExamOrder';
elsif (cd_integration_p = 100) then
	ds_event_w 	:= 'prescription.laboratory.order.update';
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.laboratory.order.outbound.LabExamOrder';	
elsif (cd_integration_p = 110) then
	ds_event_w 	:= 'prescription.laboratory.order.report.result';
	ds_java_class_w	:= '';	
elsif (cd_integration_p = 120) then
	ds_event_w 	:= 'prescription.laboratory.order.report.acknowledged';
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.laboratory.order.outbound.LabExamOrder';	
elsif (cd_integration_p = 130) then
	ds_event_w 	:= 'cpoe.batch.order.request';
	ds_java_class_w	:= 'com.philips.tasy.integration.clinical.pharmacy.order.SendMedicineBatch';		
elsif (cd_integration_p = 150) then
	ds_event_w 	:= 'generate.report';
	ds_java_class_w	:= 'com.philips.tasy.app.outbound.report.ReportGenerator';	
elsif (cd_integration_p = 160) then
	ds_event_w 	:= 'send.batch.accounting';
	ds_java_class_w	:= 'com.philips.tasy.integration.rcm.accounting.batch.outbound.AccountingBatch';	
elsif (cd_integration_p = 165) then
	ds_event_w 	:= 'directcontrol.transmitclaim';
	ds_java_class_w	:= 'com.philips.tasy.integration.rcm.billing.outbound.EpisodeAndTransmitClaims';	
elsif (cd_integration_p = 166) then
	ds_event_w 	:= 'directcontrol.getreportbbdva';
	ds_java_class_w	:= 'com.philips.tasy.integration.rcm.accounting.claims.outbound.ClaimsDateRange';		
elsif (cd_integration_p = 167) then
	ds_event_w 	:= 'directcontrol.getreportihc';
	ds_java_class_w	:= 'com.philips.tasy.integration.rcm.accounting.claims.outbound.ClaimsDateRange';	
elsif (cd_integration_p = 168) then
	ds_event_w 	:= 'directcontrol.transmitpc';
	ds_java_class_w	:= 'com.philips.tasy.integration.rcm.billing.outbound.EpisodeAndTransmitClaims';			
elsif (cd_integration_p = 170) then
	ds_event_w 	:= 'mhr.upload.discharge.summary';
	ds_java_class_w	:= 'com.philips.tasy.app.outbound.clinical.mhr.MHRDischargeLetter';	
	ie_tasy_backend_w := 'S';
elsif (cd_integration_p = 172) then
	ds_event_w 	:= 'mhr.upload.event.summary';
	ds_java_class_w	:= 'com.philips.tasy.integration.clinical.eventsummary.outbound.MHRUploadDocument';	
elsif (cd_integration_p = 174) then
	ds_event_w 	:= 'mhr.download.document';
	ds_java_class_w	:= 'com.philips.tasy.app.outbound.clinical.mhr.MHRDischargeLetter';	
	ie_tasy_backend_w := 'S';
elsif (cd_integration_p = 175) then
	ds_event_w 	:= 'mhr.create.discharge.summary.file';
	ds_java_class_w	:= 'com.philips.tasy.app.outbound.clinical.mhr.MHRDischargeLetter';	
	ie_tasy_backend_w := 'S';
elsif (cd_integration_p = 176) then
	ds_event_w 	:= 'mhr.create.event.summary.file';
	ds_java_class_w	:= 'com.philips.tasy.integration.clinical.eventsummary.outbound.MHRUploadDocument';	
elsif (cd_integration_p = 178) then
	ds_event_w 	:= 'mhr.patient.records.refresh';
	ds_java_class_w	:= 'com.philips.tasy.app.outbound.clinical.mhr.MHRDischargeLetter';	
	ie_tasy_backend_w := 'S';
elsif (cd_integration_p = 180) then
	ds_event_w 	:= 'mhr.remove.document';
	ds_java_class_w	:= 'com.philips.tasy.app.outbound.clinical.mhr.MHRDischargeLetter';	
	ie_tasy_backend_w := 'S';
elsif (cd_integration_p = 182) then
	ds_event_w	:= 'mhr.supersede.discharge.summary';
	ds_java_class_w	:= 'com.philips.tasy.app.outbound.clinical.mhr.MHRDischargeLetter';	
	ie_tasy_backend_w := 'S';
elsif (cd_integration_p = 184) then
	ds_event_w	:= 'mhr.supersede.event.summary';
	ds_java_class_w	:= 'com.philips.tasy.integration.clinical.eventsummary.outbound.MHRUploadDocument';
elsif (cd_integration_p = 185) then
	ds_event_w 	:= 'mhr.patient.pcehr.exist';
	ds_java_class_w	:= 'com.philips.tasy.app.outbound.clinical.mhr.MHRDischargeLetter';	
	ie_tasy_backend_w := 'S';
elsif (cd_integration_p = 187) then
	ds_event_w	:= 'eclipse.oec.request';
	ds_java_class_w	:= 'com.philips.tasy.integration.claims.oec.outbound.OECClaimDetails';
elsif (cd_integration_p = 188) then
	ds_event_w	:= 'eclipse.dva.request';
	ds_java_class_w	:= 'com.philips.tasy.integration.claims.dva.outbound.DVAClaimDetails';
elsif (cd_integration_p = 189) then
	ds_event_w	:= 'eclipse.dvr.request';
	ds_java_class_w	:= 'com.philips.tasy.integration.claims.dva.outbound.DVAProcessingReportDetails';
elsif (cd_integration_p = 190) then
	ds_event_w	:= 'eclipse.dvy.request';
	ds_java_class_w	:= 'com.philips.tasy.integration.claims.dva.outbound.DVAPaymentReportDetails';
elsif (cd_integration_p = 191) then
	ds_event_w	:= 'eclipse.rtv.request';
	ds_java_class_w := 'com.philips.tasy.integration.claims.ihc.outbound.IhcClaimsDetails';
elsif (cd_integration_p = 195) then
	ds_event_w 	:= 'surgery.image.order.request';
	ds_java_class_w	:= 'com.philips.tasy.integration.patient.image.order.outbound.ImageExamOrder';
elsif (cd_integration_p = 196) then
  ds_event_w := 'patient.discharge.cancel';
  ds_java_class_w := 'com.philips.tasy.integration.patient.encounter.admission.outbound.AdmissionDischageTransfer';
elsif (cd_integration_p = 197) then
  ds_event_w := 'patient.admission.cancel';
  ds_java_class_w := 'com.philips.tasy.integration.patient.encounter.admission.outbound.Admission';
elsif (cd_integration_p = 198) then
  ds_event_w	:= 'eclipse.sts.era.event';
  ds_java_class_w := 'com.philips.tasy.integration.claims.era.outbound.EclipseRemitanceAdviceDetails';
elsif (cd_integration_p = 199) then
  ds_event_w	:= 'eclipse.dbs.event';
  ds_java_class_w := 'com.philips.tasy.integration.claims.dbs.outbound.DBSClaimDetails';
elsif (cd_integration_p = 200) then
  ds_event_w	:= 'directcontrol.private.fund.eligibilitycheck';
  ds_java_class_w := 'com.philips.tasy.integration.rcm.accounting.appointment.outbound.Appointment';
elsif (cd_integration_p = 201) then
  ds_event_w	:= 'eclipse.dpr.event';
  ds_java_class_w := 'com.philips.tasy.integration.claims.dbs.outbound.DBSProcessingReportDetails';
elsif (cd_integration_p = 202) then
  ds_event_w	:= 'eclipse.dpy.event';
  ds_java_class_w := 'com.philips.tasy.integration.claims.dbs.outbound.DBSPaymentReportDetails';
elsif (cd_integration_p = 203) then
  ds_event_w	:= 'patient.information.update';
  ds_java_class_w := 'com.philips.tasy.integration.patient.encounter.admission.outbound.Admission';
elsif (cd_integration_p = 204) then
  ds_event_w	:= 'laboratory.report.result';
  return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
  ds_parameters_w := null;
elsif (cd_integration_p = 205) then
  ds_event_w	:= 'eclipse.acir.gen.event';
  ds_java_class_w := 'com.philips.tasy.integration.claims.acir.gen.outbound.GENClaimDetails';
elsif (cd_integration_p = 206) then
  ds_event_w	:= 'eclipse.ihc.sts.batch.event';
  ds_java_class_w := 'com.philips.tasy.integration.claims.ihc.outbound.IhcClaimsDetails';
elsif (cd_integration_p = 251) then
  ds_event_w	:= 'nais.admission.confirmed';
  return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
  ds_parameters_w := null;
elsif (cd_integration_p = 252) then
  ds_event_w	:= 'nais.change.physician';
  return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
  ds_parameters_w := null;
elsif (cd_integration_p = 253) then
  ds_event_w	:= 'nais.discharge.confirmed';
  ie_si_or_sic_w := 'SIC';
elsif (cd_integration_p = 255) then
  ds_event_w	:= 'nais.appointment.consultation';
  ie_si_or_sic_w := 'SIC';
elsif (cd_integration_p = 256) then
  ds_event_w	:= 'nais.appointment.exam';
  return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
  ds_parameters_w := null;
elsif (cd_integration_p = 257) then
  ds_event_w	:= 'nais.appointment.service';
  return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
  ds_parameters_w := null;
elsif (cd_integration_p = 258) then
  ds_event_w	:= 'nais.acceptance.consultation';
  return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
  ds_parameters_w := null;
elsif (cd_integration_p = 259) then
  ds_event_w	:= 'nais.acceptance.exam';
  return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
  ds_parameters_w := null;
elsif (cd_integration_p = 260) then
  ds_event_w	:= 'nais.dpc.info';
  ie_si_or_sic_w := 'SIC';
elsif (cd_integration_p = 261) then
  ds_event_w	:= 'nais.acceptance.service';
  return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
  ds_parameters_w := null;
elsif (cd_integration_p = 262) then
  ds_event_w	:= 'order.requested';
  return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
  ds_parameters_w := null;
elsif (cd_integration_p = 263) then
  ds_event_w	:= 'order.medication.item.cancel';
  return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
  ds_parameters_w := null;
elsif (cd_integration_p = 264) then
  ds_event_w	:= 'nais.appointment.message';
  return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
  ds_parameters_w := null;
elsif (cd_integration_p = 265) then
  ds_event_w	:= 'nais.unexecutedOrder.message';
  return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
  ds_parameters_w := null;
elsif (cd_integration_p = 266) then   
  ds_event_w	:= 'nais.itemOrder.cancelation';
  return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
  ds_parameters_w := null;
elsif (cd_integration_p = 267) then 
    ds_event_w	:= 'nais.appointment.message.rehabilitation';
    return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = 268) then    
    ds_event_w	:= 'nais.nutrition.info';
    select  count(1)
    into STRICT  ds_parameters_w
    
    where REGEXP_LIKE(ds_parameters_p, '^{.*}$');

    if ( ds_parameters_w  = '0') then
		CALL wheb_usuario_pck.set_nm_usuario(ds_parameters_p);
		ds_parameters_w :=  '{ '
					|| '"recordId" : "' ||ds_parameters_p|| '"' ||' , '
					|| '"fromJob" : "' || 'S' || '"'
					|| ' }';
    else 
       ds_parameters_w := ds_parameters_p;
    end if;
    return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null; 	
elsif (cd_integration_p = 269) then
    ds_event_w	:= 'nais.pathology.info';
    return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = 270) then 
    ds_event_w	:= 'nais.surgery.info';
    return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = 271) then 
    ds_event_w	:= 'nais.mla.injection';
    ie_si_or_sic_w := 'SIC';
elsif (cd_integration_p = 272) then
    ds_event_w	:= 'nais.mla.radiology';
    return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = 273) then
    ds_event_w	:= 'nais.mla.physiology';
    return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = 274) then
    ds_event_w    := 'nais.mla.specimen';
    return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = 275) then
    ds_event_w    := 'nais.mla.bacteria';
    return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = 276) then
    ds_event_w    := 'nais.mla.specimen.execution';
    return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = 277) then
        ds_event_w    := 'nais.mla.InpatientPrescription';
        return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
        ds_parameters_w := null;
elsif (cd_integration_p = 278) then
	ds_event_w    := 'nais.mla.InpatientPrescription.cancellation';
	return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
	ds_parameters_w := null;
elsif (cd_integration_p = 279) then
    ds_event_w    := 'nais.mla.medicaldisease';
    ie_si_or_sic_w := 'SIC';
elsif (cd_integration_p = 281) then
	ds_event_w    := 'nais.mla.InpatientPrescription.batch';
	return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
	ds_parameters_w := null;
elsif (cd_integration_p = 282) then
	ds_event_w    := 'nais.mla.outpatient.orderbatch';
	return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
	ds_parameters_w := null;
elsif (cd_integration_p = 949) then
        ds_event_w    := 'api.wint.exam.record';
        return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
        ds_parameters_w := null;
elsif (cd_integration_p = 454) then
        ds_event_w    := 'tasy.send.pte.answered.equipament';
        return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
        ds_parameters_w := null;
elsif (cd_integration_p = 666) then
    ds_event_w    := 'tasy.send.presc.answered.equipament';
    return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = SUS_GERPAC_REQUEST) then
	ds_event_w	:= SUS_GERPAC_REQUEST_EVT;
	return_w 	:= bifrost.send_integration_content(nm_event => ds_event_w, ds_content => ds_parameters_w, nm_user => COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
        ds_parameters_w := null;
elsif (cd_integration_p = EXECUTE_DISPENSARY_PRC_SUSP) then
    	ds_event_w :=  EXECUTE_DISPENSARY_PRC_SSP_EVT;
	return_w := bifrost.send_integration_content(nm_event => ds_event_w, ds_content => ds_parameters_w, nm_user => COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    	ds_parameters_w := null;
elsif (cd_integration_p = PERFORM_APAC_PARAM_RQT) then
    ds_event_w :=  PERFORM_APAC_PARAM_RQT_EVT;
	return_w := bifrost.send_integration_content(nm_event => ds_event_w, ds_content => ds_parameters_w, nm_user => COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = SUS_APAC_EXECUTOR_REQUEST) then
	ds_event_w    	:=  SUS_APAC_EXECUTOR_REQUEST_EVT;
	return_w 	:= bifrost.send_integration_content(nm_event => ds_event_w, ds_content => ds_parameters_w, nm_user => COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
	ds_parameters_w := null;
        ds_parameters_w := null;
elsif (cd_integration_p = 280) then
    ds_event_w    := 'nais.unexecutedOrderPrescriptionCancel.message';
    ie_si_or_sic_w := 'SIC';
elsif (cd_integration_p = SUS_GERPAC_PATIENT_REQUEST) then
        ds_event_w    := SUS_GERPAC_PATIENT_REQUEST_EVT;
        return_w := bifrost.send_integration_content(ds_event_w, ds_parameters_w, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
        ds_parameters_w := null;
elsif (cd_integration_p = EXECUTE_DISPENSARY_USER) then
    ds_event_w :=  EXECUTE_DISPENSARY_USER_EVT;
	return_w := bifrost.send_integration_content(nm_event => ds_event_w, ds_content => ds_parameters_w, nm_user => COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = EXECUTE_DISPENSARY_PRODUCT) then
    ds_event_w :=  EXECUTE_DISPENSARY_PRODUCT_EVT;
	return_w := bifrost.send_integration_content(nm_event => ds_event_w, ds_content => ds_parameters_w, nm_user => COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = EXECUTE_DISPENSARY_KIT) then
    ds_event_w :=  EXECUTE_DISPENSARY_KIT_EVT;
	return_w := bifrost.send_integration_content(nm_event => ds_event_w, ds_content => ds_parameters_w, nm_user => COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = EXECUTE_DISPENSARY_PAT_REL) then
    ds_event_w :=  EXECUTE_DISPENSARY_PAT_REL_EVT;
	return_w := bifrost.send_integration_content(nm_event => ds_event_w, ds_content => ds_parameters_w, nm_user => COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = EXECUTE_DISPENSARY_RESS) then
    ds_event_w :=  EXECUTE_DISPENSARY_RESS_EVT;
	return_w := bifrost.send_integration_content(nm_event => ds_event_w, ds_content => ds_parameters_w, nm_user => COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = EXC_DADO_CLI_RT_TIE_RES) then
    ds_event_w :=  EXC_DADO_CLI_RT_TIE_RES_EVT;
	return_w := bifrost.send_integration_content(nm_event => ds_event_w, ds_content => ds_parameters_w, nm_user => COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = EXECUTE_DISPENSARY_SECTOR) then 
    ds_event_w :=  EXECUTE_DISPENSARY_SECTOR_EVT;
	return_w := bifrost.send_integration_content(nm_event => ds_event_w, ds_content => ds_parameters_w, nm_user => COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = EXECUTE_DISPENSARY_PATIENTS) then 
    ds_event_w :=  EXECUTE_DISPENSARY_PATIENT_EVT;
	return_w := bifrost.send_integration_content(nm_event => ds_event_w, ds_content => ds_parameters_w, nm_user => COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario));
    ds_parameters_w := null;
elsif (cd_integration_p = 303) then   
	ds_event_w	:= 'nais.mla.bloodtransfusion';
	ie_si_or_sic_w := 'SIC';
end if;

ie_use_integration_w := obter_param_usuario(9041, 10, obter_perfil_ativo, COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario), wheb_usuario_pck.get_cd_estabelecimento, ie_use_integration_w);

if (ie_use_integration_w = 'S' AND ds_parameters_w IS NOT NULL AND ds_parameters_w::text <> '') then
	begin

	dbms_job.submit(jobno, 'job_execute_bft_integration('|| cd_integration_p ||','''|| ds_event_w ||''','''|| ds_java_class_w ||''','''|| ds_parameters_p ||''','''||
					COALESCE(nm_usuario_p,wheb_usuario_pck.get_nm_usuario) || ''','''|| wheb_usuario_pck.get_cd_estabelecimento || ''','''|| ie_tasy_backend_w || ''',''' || ie_si_or_sic_w || ''');' );
	end;
end if;


end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE execute_bifrost_integration ( cd_integration_p bigint, ds_parameters_p text, nm_usuario_p text default null) FROM PUBLIC;

