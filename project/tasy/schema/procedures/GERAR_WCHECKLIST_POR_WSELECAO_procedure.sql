-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_wchecklist_por_wselecao ( cd_funcao_p bigint, nr_seq_objeto_p bigint, nm_usuario_p text, nr_new_obj_p INOUT bigint) AS $body$
DECLARE


nr_seq_objeto_w	bigint;
nr_seq_grupo_w	bigint;
nr_seq_grupo_novo_w	bigint;

c01 CURSOR FOR
SELECT	nr_sequencia
from 	dic_objeto
where	nr_seq_obj_sup = nr_seq_objeto_p
and 	ie_tipo_objeto = 'GCWSCB';


BEGIN

if (cd_funcao_p IS NOT NULL AND cd_funcao_p::text <> '') and (nr_seq_objeto_p IS NOT NULL AND nr_seq_objeto_p::text <> '') and (nm_usuario_p IS NOT NULL AND nm_usuario_p::text <> '') then
	begin

	select	nextval('dic_objeto_seq')
	into STRICT	nr_seq_objeto_w
	;

	insert into dic_objeto(
        nr_sequencia,
		dt_atualizacao,
		nm_usuario,
		dt_atualizacao_nrec,
		nm_usuario_nrec,
		cd_funcao,
		ie_tipo_objeto,
		nm_objeto,
		ds_texto,
		ds_sql,
		nm_campo_tela,
		qt_largura,
		ie_geracao_inf_wdp,
		ie_tipo_comp_wdp,
		ie_apresent_serie_wchart,
		ie_incremento_wchart,
		ie_read_only,
		ie_situacao,
		ie_momento_obj,
		ie_tipo_obj_col_wcp,
		ie_totalizar,
		ie_estilo_fonte,
		ie_alinhamento,
		ie_tipo_obj_painel,
		ie_versao_objeto ,
		ie_obrigatorio ,
		cd_exp_texto,
		cd_exp_informacao,
		nr_seq_menu_sup,
		nm_campo_base,
		nr_seq_apres)
	  SELECT nr_seq_objeto_w,
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		nm_usuario_p,
		cd_funcao_p,
		'CWCBL',
		nm_objeto,
		ds_texto,
		ds_sql,
		nm_campo_tela,
		qt_largura,
		ie_geracao_inf_wdp,
		ie_tipo_comp_wdp,
		ie_apresent_serie_wchart,
		ie_incremento_wchart,
		ie_read_only,
		ie_situacao,
		ie_momento_obj,
		ie_tipo_obj_col_wcp,
		ie_totalizar,
		ie_estilo_fonte,
		ie_alinhamento,
		ie_tipo_obj_painel,
		'A',
		'N',
		cd_exp_texto,
		cd_exp_informacao,
		nr_seq_menu_sup,
		nm_campo_base,
		nr_seq_apres
	from	dic_objeto
	where 	nr_sequencia = nr_seq_objeto_p;

	commit;

	open c01;
	loop
	fetch c01 into
		nr_seq_grupo_w;
	EXIT WHEN NOT FOUND; /* apply on c01 */
	begin

	select	nextval('dic_objeto_seq')
	into STRICT	nr_seq_grupo_novo_w
	;

	insert into dic_objeto(
		nr_sequencia,
		dt_atualizacao,
		nm_usuario,
		dt_atualizacao_nrec,
		nm_usuario_nrec,
		cd_funcao,
		ie_tipo_objeto,
		nm_objeto,
		ds_texto,
		nr_seq_obj_sup,
		ds_sql,
		ds_informacao,

		nm_campo_tela /*ds_grupo*/
,
		qt_altura,
		ie_geracao_inf_wdp,
		ie_tipo_comp_wdp,
		ie_apresent_serie_wchart,
		ie_incremento_wchart,
		ie_read_only,
		ie_situacao,
		ie_momento_obj,
		ie_tipo_obj_col_wcp,
		ie_totalizar,
		ie_estilo_fonte,
		ie_alinhamento,
		ie_tipo_obj_painel,
		ie_versao_objeto ,
		ie_obrigatorio ,
		cd_exp_texto,
		cd_exp_informacao,
		vl_default,
		ds_grupo /*nm_campo_base*/
,
		nr_seq_apres)
	 SELECT nr_seq_grupo_novo_w,
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		nm_usuario_p,
		cd_funcao_p,
		'GCWCBL',
		nm_objeto,
		ds_texto,
		nr_seq_objeto_w,
		ds_sql,
		ds_informacao,
		ds_grupo,

		qt_altura,
		ie_geracao_inf_wdp,
		ie_tipo_comp_wdp,
		ie_apresent_serie_wchart,
		ie_incremento_wchart,
		ie_read_only,
		ie_situacao,
		ie_momento_obj,
		ie_tipo_obj_col_wcp,
		ie_totalizar,
		ie_estilo_fonte,
		ie_alinhamento,
		ie_tipo_obj_painel,
		'A',
		'N',
		cd_exp_texto,
		cd_exp_informacao,
		vl_default,
		nm_campo_base,
		nr_seq_apres
		from 	dic_objeto
		where 	nr_sequencia 	= nr_seq_grupo_w
		and		ie_tipo_objeto	= 'GCWSCB';

	insert into dic_objeto(
		nr_sequencia,
		dt_atualizacao,
		nm_usuario,
		dt_atualizacao_nrec,
		nm_usuario_nrec,
		cd_funcao,
		ie_tipo_objeto,
		nm_objeto,
		ds_texto,
		nr_seq_obj_sup,
		ds_sql,
		nm_campo_tela,
		qt_altura,
		ie_geracao_inf_wdp,
		ie_tipo_comp_wdp,
		ie_apresent_serie_wchart,
		ie_incremento_wchart,
		ie_read_only,
		ie_situacao,
		ie_momento_obj,
		ie_tipo_obj_col_wcp,
		ie_totalizar,
		ie_estilo_fonte,
		ie_alinhamento,
		ie_tipo_obj_painel,
		ie_versao_objeto ,
		ie_obrigatorio ,
		cd_exp_texto,
		cd_exp_informacao,
		vl_default,
		nm_campo_base,
		nr_seq_apres)
	 SELECT nextval('dic_objeto_seq'),
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		nm_usuario_p,
		cd_funcao_p,
		'APWCBL',
		nm_objeto,
		ds_texto,
		nr_seq_grupo_novo_w,
		ds_sql,
		nm_campo_tela,
		qt_altura,
		ie_geracao_inf_wdp,
		ie_tipo_comp_wdp,
		ie_apresent_serie_wchart,
		ie_incremento_wchart,
		ie_read_only,
		ie_situacao,
		ie_momento_obj,
		ie_tipo_obj_col_wcp,
		ie_totalizar,
		ie_estilo_fonte,
		ie_alinhamento,
		ie_tipo_obj_painel,
		'A',
		'N',
		cd_exp_texto,
		cd_exp_informacao,
		vl_default,
		nm_campo_base,
		nr_seq_apres
		from 	dic_objeto
		where 	nr_seq_obj_sup 	= nr_seq_grupo_w
		and		ie_tipo_objeto	='APWSCB';


		end;
	end loop;
	close c01;

	commit;

	insert into dic_objeto(cd_funcao,
        nr_sequencia,
        dt_atualizacao,
        nm_usuario,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        ie_tipo_objeto,
        nm_objeto,
        ds_texto,
        nr_seq_obj_sup,
        ds_sql,
        nm_campo_tela,
        qt_altura,
        ie_geracao_inf_wdp,
        ie_tipo_comp_wdp,
        ie_apresent_serie_wchart,
        ie_incremento_wchart,
        ie_read_only,
        ie_situacao,
        ie_momento_obj,
        ie_tipo_obj_col_wcp,
        ie_totalizar,
        ie_estilo_fonte,
        ie_alinhamento,
        ie_tipo_obj_painel,
        ie_versao_objeto ,
        ie_obrigatorio ,
        cd_exp_texto,
        cd_exp_informacao,
        vl_default,
        nm_campo_base,
        nr_seq_apres)
     SELECT cd_funcao_p,
        nextval('dic_objeto_seq'),
        clock_timestamp(),
        nm_usuario_p,
        clock_timestamp(),
        nm_usuario_p,
        'ACCWCBL',
        nm_objeto,
        ds_texto,
        nr_seq_objeto_w,
        ds_sql,
        nm_campo_tela,
        qt_altura,
        ie_geracao_inf_wdp,
        ie_tipo_comp_wdp,
        ie_apresent_serie_wchart,
        ie_incremento_wchart,
        ie_read_only,
        ie_situacao,
        ie_momento_obj,
        ie_tipo_obj_col_wcp,
        ie_totalizar,
        ie_estilo_fonte,
        ie_alinhamento,
        ie_tipo_obj_painel,
        'A',
        'N',
        cd_exp_texto,
        cd_exp_informacao,
        vl_default,
        nm_campo_base,
        nr_seq_apres
    from 	dic_objeto
    where 	nr_seq_obj_sup = nr_seq_objeto_p
    and 	ie_tipo_objeto='ACCWSCB';

    end;
end if;

commit;

nr_new_obj_p := nr_seq_objeto_w;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_wchecklist_por_wselecao ( cd_funcao_p bigint, nr_seq_objeto_p bigint, nm_usuario_p text, nr_new_obj_p INOUT bigint) FROM PUBLIC;

