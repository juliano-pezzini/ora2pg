-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE sus_altera_campo_diag_cito () AS $body$
DECLARE



qt_existe_w		bigint;


BEGIN
select	count(*)
into STRICT	qt_existe_w
from	sus_laudo_padrao_dados
where	(cd_diag_cito_hist IS NOT NULL AND cd_diag_cito_hist::text <> '');

if (qt_existe_w > 0) then
	CALL exec_sql_dinamico('Anderson', 'alter table sus_laudo_padrao_dados add cd_diag_cito_hist2 varchar2(10)');
	CALL exec_sql_dinamico('Anderson', 'update sus_laudo_padrao_dados set cd_diag_cito_hist2 = cd_diag_cito_hist where cd_diag_cito_hist is not null');
	CALL exec_sql_dinamico('Anderson', 'alter table sus_laudo_padrao_dados drop column cd_diag_cito_hist');
	CALL exec_sql_dinamico('Anderson', 'alter table sus_laudo_padrao_dados rename column cd_diag_cito_hist2 to cd_diag_cito_hist');
else
	CALL exec_sql_dinamico('Anderson', 'alter table sus_laudo_padrao_dados modify cd_diag_cito_hist varchar2(10)');
end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE sus_altera_campo_diag_cito () FROM PUBLIC;

