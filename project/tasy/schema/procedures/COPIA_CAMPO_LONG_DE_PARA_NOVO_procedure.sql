-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE copia_campo_long_de_para_novo ( nm_tabela_p text, nm_coluna_p text, ds_restricao_where_p text, ds_param_select_p text, nm_tabela_update_p text, nm_coluna_update_p text, ds_restricao_where_update_p text, ds_param_update_p text, ie_tipo_campo_p text, ie_html_p text DEFAULT 'N') AS $body$
DECLARE

					

ie_existe_w			varchar(1) := 'N';

BEGIN

--Verifica se o objeto java existe no banco, senao usa o PL/SQL
select	coalesce(max('S'), 'N')
into STRICT	ie_existe_w
from	user_objects
where	object_type LIKE 'JAVA%'
and		status	= 'VALID'
and		object_name  LIKE '%CopiaCampoLong%';


if (ie_existe_w = 'N') OR (ie_html_p = 'S') then
	CALL copia_campo_long_de_para(
				nm_tabela_p,
				nm_coluna_p,
				ds_restricao_where_p,
				ds_param_select_p,
				nm_tabela_update_p,
				nm_coluna_update_p,
				ds_restricao_where_update_p,
				ds_param_update_p);
else
	copia_campo_long_de_para_java(
				nm_tabela_p,
				nm_coluna_p,
				ds_restricao_where_p,
				ds_param_select_p,
				nm_tabela_update_p,
				nm_coluna_update_p,
				ds_restricao_where_update_p,
				ds_param_update_p,
				ie_tipo_campo_p);
	
end if;


end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE copia_campo_long_de_para_novo ( nm_tabela_p text, nm_coluna_p text, ds_restricao_where_p text, ds_param_select_p text, nm_tabela_update_p text, nm_coluna_update_p text, ds_restricao_where_update_p text, ds_param_update_p text, ie_tipo_campo_p text, ie_html_p text DEFAULT 'N') FROM PUBLIC;

