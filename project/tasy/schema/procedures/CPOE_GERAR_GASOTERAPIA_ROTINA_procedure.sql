-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE cpoe_gerar_gasoterapia_rotina ( nr_atendimento_p bigint, nr_seq_produto_p bigint, cd_estabelecimento_p bigint, cd_perfil_p bigint, nm_usuario_p text, cd_pessoa_fisica_p text, nr_seq_item_gerado_p INOUT bigint, nr_seq_transcricao_p bigint default null, ie_item_alta_p text default 'N', ie_prescritor_aux_p text default 'N', cd_medico_p bigint default null, ie_retrogrado_p text default 'N', dt_inicio_p timestamp default null, nr_seq_pepo_p bigint default null, nr_cirurgia_p bigint default null, nr_cirurgia_patologia_p bigint default null, nr_seq_agenda_p bigint default null, nr_seq_conclusao_apae_p bigint default null, ie_futuro_p text default 'N', cd_intervalo_p text default null, qt_dose_p bigint default null, cd_unidade_medida_p text default null, nr_seq_cpoe_order_unit_p cpoe_order_unit.nr_sequencia%type default null) AS $body$
DECLARE

							
nr_seq_item_w			protocolo_medic_gas.nr_sequencia%type;
cd_protocolo_w			protocolo_medic_gas.cd_protocolo%type;
nr_seq_protocolo_w		protocolo_medic_gas.nr_seq_protocolo%type;

c01 CURSOR FOR
SELECT  a.nr_sequencia,
        a.cd_protocolo,
        a.nr_seq_protocolo
from    protocolo_medic_gas a
where  	a.ie_rotina = 'S'
and 	a.nr_sequencia = nr_seq_produto_p;


BEGIN

open c01;
loop
fetch c01 into	nr_seq_item_w,
				cd_protocolo_w,
				nr_seq_protocolo_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
	begin
	nr_seq_item_gerado_p := CPOE_Gerar_prot_gasoterapia(cd_estabelecimento_p, cd_perfil_p, nm_usuario_p, cd_protocolo_w, nr_seq_protocolo_w, nr_seq_item_w, nr_atendimento_p, cd_pessoa_fisica_p, nr_seq_item_gerado_p, null, nr_seq_transcricao_p, ie_item_alta_p, ie_prescritor_aux_p, cd_medico_p, ie_retrogrado_p, dt_inicio_p, nr_seq_pepo_p, nr_cirurgia_p, nr_cirurgia_patologia_p, nr_seq_agenda_p, nr_seq_conclusao_apae_p, null, null, null, ie_futuro_p, cd_intervalo_p, qt_dose_p, cd_unidade_medida_p, nr_seq_cpoe_order_unit_p);
	end;
end loop;
close c01;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE cpoe_gerar_gasoterapia_rotina ( nr_atendimento_p bigint, nr_seq_produto_p bigint, cd_estabelecimento_p bigint, cd_perfil_p bigint, nm_usuario_p text, cd_pessoa_fisica_p text, nr_seq_item_gerado_p INOUT bigint, nr_seq_transcricao_p bigint default null, ie_item_alta_p text default 'N', ie_prescritor_aux_p text default 'N', cd_medico_p bigint default null, ie_retrogrado_p text default 'N', dt_inicio_p timestamp default null, nr_seq_pepo_p bigint default null, nr_cirurgia_p bigint default null, nr_cirurgia_patologia_p bigint default null, nr_seq_agenda_p bigint default null, nr_seq_conclusao_apae_p bigint default null, ie_futuro_p text default 'N', cd_intervalo_p text default null, qt_dose_p bigint default null, cd_unidade_medida_p text default null, nr_seq_cpoe_order_unit_p cpoe_order_unit.nr_sequencia%type default null) FROM PUBLIC;

