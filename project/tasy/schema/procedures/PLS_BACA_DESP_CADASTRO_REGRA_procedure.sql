-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pls_baca_desp_cadastro_regra () AS $body$
DECLARE


cd_perfil_w		integer;
cd_estabelecimento_w	integer;
ie_controle_w		varchar(10);

C01 CURSOR FOR
	SELECT	cd_estabelecimento,
		cd_perfil,
		ie_controle
	from	pls_cad_regra_item_perfil
	where	nr_seq_item	= 176;


BEGIN

update	pls_cadastro_regra_item
set	ie_liberacao_perfil	= 'S'
where	nr_sequencia		= 34;

open C01;
loop
fetch C01 into
	cd_estabelecimento_w,
	cd_perfil_w,
	ie_controle_w;
EXIT WHEN NOT FOUND; /* apply on C01 */
	begin
	insert into pls_cad_regra_item_perfil(nr_sequencia, dt_atualizacao, nm_usuario,
		dt_atualizacao_nrec, nm_usuario_nrec, nr_seq_item,
		cd_estabelecimento, cd_perfil, ie_controle)
	values (nextval('pls_cad_regra_item_perfil_seq'), clock_timestamp(), 'Wheb',
		clock_timestamp(), 'Wheb', 34,
		cd_estabelecimento_w, cd_perfil_w, ie_controle_w);
	end;
end loop;
close C01;

delete	FROM pls_cad_regra_item_perfil
where	nr_seq_item	= 177;

delete	FROM pls_cad_regra_item_perfil
where	nr_seq_item	= 176;

delete	FROM pls_cadastro_regra_item
where	nr_sequencia = 177;

delete	FROM pls_cadastro_regra_item
where	nr_sequencia = 176;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_baca_desp_cadastro_regra () FROM PUBLIC;

