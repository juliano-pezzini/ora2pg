-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gera_w_carga_dcb_medic_control ( cd_dcb_p text, ds_dcb_p text, nr_cas_p text, ie_deleta_p text, nm_usuario_p text) AS $body$
BEGIN

if (coalesce(cd_dcb_p::text, '') = '') or (coalesce(ds_dcb_p::text, '') = '') then
    CALL WHEB_MENSAGEM_PCK.exibir_mensagem_abort(nr_seq_mensagem_p => 1195559);
end if;

if (ie_deleta_p = 'S') then
	delete from w_carga_dcb_medic_control;
	CALL gravar_carga_dcb_historico( ds_titulo_p     => 'Limpeza na tabela W_CARGA_DCB_MEDIC_CONTROL',
                                ds_historico_p  => 'A procedure GERA_W_CARGA_DCB_MEDIC_CONTROL limpou a tabela W_CARGA_DCB_MEDIC_CONTROL.'
,
                                nm_usuario_p    => nm_usuario_p);
end if;

insert into w_carga_dcb_medic_control(
	cd_dcb,
	ds_dcb,
	nr_cas,
	dt_atualizacao,
	nm_usuario)
values (	substr(cd_dcb_p,1,20),
	substr(ds_dcb_p,1,255),
	substr(nr_cas_p,1,20),
	clock_timestamp(),
	nm_usuario_p);

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gera_w_carga_dcb_medic_control ( cd_dcb_p text, ds_dcb_p text, nr_cas_p text, ie_deleta_p text, nm_usuario_p text) FROM PUBLIC;

