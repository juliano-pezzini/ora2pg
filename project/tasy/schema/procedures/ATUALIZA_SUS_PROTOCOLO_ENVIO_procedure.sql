-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE atualiza_sus_protocolo_envio ( nr_sequencia_p bigint, nr_interno_conta_p bigint, vl_retorno_p bigint, nr_seq_mot_glosa_p text, nm_usuario_p text) AS $body$
DECLARE



vl_saldo_w 					sus_protocolo_envio_conta.vl_saldo%type;
VL_TOTAL_CONTA_SUS_w		sus_protocolo_envio_conta.VL_TOTAL_CONTA_SUS%type;


BEGIN

select 	VL_TOTAL_CONTA_SUS
into STRICT 	VL_TOTAL_CONTA_SUS_w
from 	sus_protocolo_envio_conta
where	nr_interno_conta 	= nr_interno_conta_p
and		nr_sequencia		= nr_sequencia_p;

vl_saldo_w := vl_retorno_p - VL_TOTAL_CONTA_SUS_w;


update	sus_protocolo_envio_conta
set	vl_retorno 	= vl_retorno_p,
	vl_saldo	= vl_saldo_w,
	nr_seq_mot_glosa	= nr_seq_mot_glosa_p
where	nr_interno_conta 	= nr_interno_conta_p
and	nr_sequencia	= nr_sequencia_p;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE atualiza_sus_protocolo_envio ( nr_sequencia_p bigint, nr_interno_conta_p bigint, vl_retorno_p bigint, nr_seq_mot_glosa_p text, nm_usuario_p text) FROM PUBLIC;

