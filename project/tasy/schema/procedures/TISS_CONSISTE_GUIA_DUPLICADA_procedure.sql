-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';



CREATE TYPE reg_guias AS (
	cd_ans				varchar(20),
	cd_autorizacao			varchar(20),
	cd_autorizacao_princ		varchar(20),
	cd_autorizacao_tag		varchar(20),
	cd_cgc_fonte_pag		varchar(14),
	cd_cgc_prestador		varchar(14),
	cd_cid				varchar(10),
	cd_cid_obito			varchar(10),
	cd_cid_2			varchar(10),
	cd_cid_3			varchar(10),
	cd_cid_4			varchar(10),
	cd_convenio			integer,
	cd_medico_executor		varchar(10),
	cd_med_solic_tasymed		varchar(10),
	cd_senha			varchar(20),
	cd_tabela_cid			varchar(10),
	cd_tabela_cid_obito		varchar(20),
	cd_tabela_cid_2			varchar(10),
	ds_cid				varchar(255),
	ds_cid_obito			varchar(255),
	ds_cid_2			varchar(255),
	ds_data_assin_benef		varchar(255),
	ds_data_assin_med		varchar(255),
	ds_indicacao			varchar(255),
	ds_observacao			varchar(4000),
	dt_autorizacao			timestamp,
	dt_emissao_guia   		timestamp,
	dt_fim_faturamento		timestamp,
	dt_fim_vigencia			timestamp,
	dt_inicio_faturamento		timestamp,
	dt_validade_senha		timestamp,
	ie_honorario			varchar(3),
	ie_tipo_acidente		varchar(2),
	ie_tipo_atend_tiss		varchar(3),
	ie_tipo_cid			varchar(5),
	ie_tipo_saida			varchar(10),
	ie_tiss_tipo_guia		varchar(20),
	ie_unidade_tempo_cid            varchar(10),
	nr_guia_prestador		varchar(60),
	nr_interno_conta		bigint,
	nr_sequencia			bigint,
	qt_tempo_cid			bigint);
CREATE TYPE reg_contrat_solic AS (
	cd_cbos_solic		varchar(20),
	cd_cgc			varchar(14),
	cd_cnes			varchar(20),
	cd_interno		varchar(30),
	cd_pessoa_fisica	varchar(10),
	nm_contratado		varchar(255),
	nm_solicitante		varchar(255),
	nr_cpf			varchar(11),
	nr_crm_solic		varchar(40),
	nr_seq_guia		bigint,
	sg_conselho_solic	varchar(20),
	uf_conselho_solic	varchar(10));
CREATE TYPE reg_contrat_exec AS (
	cd_cbos_compl		varchar(20),
	cd_cep			varchar(20),
	cd_cgc			varchar(14),
	cd_cgc_compl		varchar(14),
	cd_cgc_honor		varchar(20),
	cd_cnes                 varchar(20),
	cd_cnes_compl           varchar(20),
	cd_cnes_honor           varchar(50),
	cd_interno              varchar(30),
	cd_interno_compl        varchar(20),
	cd_interno_honor        varchar(30),
	cd_municipio_ibge       varchar(30),
	cd_pessoa_fisica        varchar(10),
	ds_complemento          varchar(255),
	ds_logradouro           varchar(255),
	ie_funcao_medico_compl	varchar(5),
	ie_tipo_acomodacao      varchar(30),
	ie_tipo_logradouro      varchar(10),
	nm_contratado           varchar(255),
	nm_contratado_honor     varchar(255),
	nm_exec_compl           varchar(255),
	nm_municipio            varchar(255),
	nr_cpf                  varchar(11),
	nr_cpf_compl            varchar(11),
	nr_cpf_honor            varchar(30),
	nr_crm_compl            varchar(30),
	nr_crm_compl_id         varchar(30),
	nr_endereco             varchar(20),
	nr_seq_guia             bigint,
	sg_conselho_compl       varchar(20),
	sg_conselho_compl_id    varchar(20),
	sg_estado               varchar(10),
	uf_conselho_compl       varchar(10),
	uf_conselho_compl_id    varchar(10));


CREATE OR REPLACE PROCEDURE tiss_consiste_guia_duplicada (nr_interno_conta_p bigint, ds_seq_guias_p text) AS $body$
DECLARE

type guias is table of reg_guias index by integer;
type contrat_solic is table of reg_contrat_solic index by integer;
type contrat_exec is table of reg_contrat_exec index by integer;


guias_w			guias;
contrat_solic_w		contrat_solic;
contrat_exec_w		contrat_exec;
i			integer := 0;
j			integer := 0;
ds_texto_w		varchar(255);

c01 CURSOR FOR
SELECT	cd_ans,
	cd_autorizacao,
	cd_autorizacao_princ,
	cd_autorizacao_tag,
	cd_cgc_fonte_pag,
	cd_cgc_prestador,
	cd_cid,
	cd_cid_obito,
	cd_cid_2,
	cd_cid_3,
	cd_cid_4,
	cd_medico_executor,
	cd_senha,
	cd_tabela_cid,
	cd_tabela_cid_obito,
	cd_tabela_cid_2,
	ds_cid,
	ds_cid_obito,
	ds_cid_2,
	ds_data_assin_benef,
	ds_data_assin_med,
	ds_indicacao,
	ds_observacao,
	dt_autorizacao,
	dt_emissao_guia,
	dt_fim_faturamento,
	dt_fim_vigencia,
	dt_inicio_faturamento,
	dt_validade_senha,
	ie_honorario,
	ie_tipo_acidente,
	ie_tipo_atend_tiss,
	ie_tipo_cid,
	ie_tipo_saida,
	ie_tiss_tipo_guia,
	ie_unidade_tempo_cid,
	nr_guia_prestador,
	nr_interno_conta,
	nr_sequencia,
	qt_tempo_cid
from	tiss_conta_guia
where	nr_interno_conta	= nr_interno_conta_p
and	obter_se_contido(nr_sequencia,ds_seq_guias_p) = 'S';
Vet01	C01%ROWTYPE;

c02 CURSOR FOR
SELECT	cd_cbos_solic,
	cd_cgc,
	cd_cnes,
	cd_interno,
	cd_pessoa_fisica,
	nm_contratado,
	nm_solicitante,
	nr_cpf,
	nr_crm_solic,
	nr_seq_guia,
	sg_conselho_solic,
	uf_conselho_solic
from	tiss_conta_contrat_solic
where	nr_seq_guia	= Vet01.nr_sequencia;
Vet02	C02%ROWTYPE;

c03 CURSOR FOR
SELECT	cd_cbos_compl,
	cd_cep,
	cd_cgc,
	cd_cgc_compl,
	cd_cgc_honor,
	cd_cnes,
	cd_cnes_compl,
	cd_cnes_honor,
	cd_interno,
	cd_interno_compl,
	cd_interno_honor,
	cd_municipio_ibge,
	cd_pessoa_fisica,
	ds_complemento,
	ds_logradouro,
	ie_funcao_medico_compl,
	ie_tipo_acomodacao,
	ie_tipo_logradouro,
	nm_contratado,
	nm_contratado_honor,
	nm_exec_compl,
	nm_municipio,
	nr_cpf,
	nr_cpf_compl,
	nr_cpf_honor,
	nr_crm_compl,
	nr_crm_compl_id,
	nr_endereco,
	nr_seq_guia,
	sg_conselho_compl,
	sg_conselho_compl_id,
	sg_estado,
	uf_conselho_compl,
	uf_conselho_compl_id
from	tiss_conta_contrat_exec
where	nr_seq_guia	= Vet01.nr_sequencia;
Vet03	C03%ROWTYPE;


BEGIN

open C01;
loop
fetch C01 into
	Vet01;
EXIT WHEN NOT FOUND; /* apply on C01 */
	begin

	i				:= i + 1;
	guias_w[i].cd_ans		:= Vet01.cd_ans;
	guias_w[i].cd_autorizacao	:= Vet01.cd_autorizacao;
	guias_w[i].cd_autorizacao_princ	:= Vet01.cd_autorizacao_princ;
	guias_w[i].cd_autorizacao_tag	:= Vet01.cd_autorizacao_tag;
	guias_w[i].cd_cgc_fonte_pag	:= Vet01.cd_cgc_fonte_pag;
	guias_w[i].cd_cgc_prestador	:= Vet01.cd_cgc_prestador;
	guias_w[i].cd_cid		:= Vet01.cd_cid;
	guias_w[i].cd_cid_obito		:= Vet01.cd_cid_obito;
	guias_w[i].cd_cid_2		:= Vet01.cd_cid_2;
	guias_w[i].cd_cid_3		:= Vet01.cd_cid_3;
	guias_w[i].cd_cid_4		:= Vet01.cd_cid_4;
	guias_w[i].cd_medico_executor	:= Vet01.cd_medico_executor;
	guias_w[i].cd_senha		:= Vet01.cd_senha;
	guias_w[i].cd_tabela_cid	:= Vet01.cd_tabela_cid;
	guias_w[i].cd_tabela_cid_obito	:= Vet01.cd_tabela_cid_obito;
	guias_w[i].cd_tabela_cid_2	:= Vet01.cd_tabela_cid_2;
	guias_w[i].ds_cid		:= Vet01.ds_cid;
	guias_w[i].ds_cid_obito		:= Vet01.ds_cid_obito;
	guias_w[i].ds_cid_2		:= Vet01.ds_cid_2;
	guias_w[i].ds_data_assin_benef	:= Vet01.ds_data_assin_benef;
	guias_w[i].ds_data_assin_med	:= Vet01.ds_data_assin_med;
	guias_w[i].ds_indicacao		:= Vet01.ds_indicacao;
	guias_w[i].ds_observacao	:= Vet01.ds_observacao;
	guias_w[i].dt_autorizacao	:= Vet01.dt_autorizacao;
	guias_w[i].dt_emissao_guia   	:= Vet01.dt_emissao_guia;
	guias_w[i].dt_fim_faturamento	:= Vet01.dt_fim_faturamento;
	guias_w[i].dt_fim_vigencia	:= Vet01.dt_fim_vigencia;
	guias_w[i].dt_inicio_faturamento:= Vet01.dt_inicio_faturamento;
	guias_w[i].dt_validade_senha	:= Vet01.dt_validade_senha;
	guias_w[i].ie_honorario		:= Vet01.ie_honorario;
	guias_w[i].ie_tipo_acidente	:= Vet01.ie_tipo_acidente;
	guias_w[i].ie_tipo_atend_tiss	:= Vet01.ie_tipo_atend_tiss;
	guias_w[i].ie_tipo_cid		:= Vet01.ie_tipo_cid;
	guias_w[i].ie_tipo_saida	:= Vet01.ie_tipo_saida;
	guias_w[i].ie_tiss_tipo_guia	:= Vet01.ie_tiss_tipo_guia;
	guias_w[i].ie_unidade_tempo_cid	:= Vet01.ie_unidade_tempo_cid;
	guias_w[i].nr_guia_prestador	:= Vet01.nr_guia_prestador;
	guias_w[i].nr_interno_conta	:= Vet01.nr_interno_conta;
	guias_w[i].nr_sequencia		:= Vet01.nr_sequencia;
	guias_w[i].qt_tempo_cid		:= Vet01.qt_tempo_cid;

	open C02;
	loop
	fetch C02 into
		Vet02;
	EXIT WHEN NOT FOUND; /* apply on C02 */
		begin

		contrat_solic_w[i].cd_cbos_solic	:= Vet02.cd_cbos_solic;
		contrat_solic_w[i].cd_cgc		:= Vet02.cd_cgc;
		contrat_solic_w[i].cd_cnes		:= Vet02.cd_cnes;
		contrat_solic_w[i].cd_interno		:= Vet02.cd_interno;
		contrat_solic_w[i].cd_pessoa_fisica	:= Vet02.cd_pessoa_fisica;
		contrat_solic_w[i].nm_contratado	:= Vet02.nm_contratado;
		contrat_solic_w[i].nm_solicitante	:= Vet02.nm_solicitante;
		contrat_solic_w[i].nr_cpf		:= Vet02.nr_cpf;
		contrat_solic_w[i].nr_crm_solic		:= Vet02.nr_crm_solic;
		contrat_solic_w[i].nr_seq_guia		:= Vet02.nr_seq_guia;
		contrat_solic_w[i].sg_conselho_solic	:= Vet02.sg_conselho_solic;
		contrat_solic_w[i].uf_conselho_solic	:= Vet02.uf_conselho_solic;

		end;
	end loop;
	close C02;

	open C03;
	loop
	fetch C03 into
		Vet03;
	EXIT WHEN NOT FOUND; /* apply on C03 */
		begin

		contrat_exec_w[i].cd_cbos_compl		:= Vet03.cd_cbos_compl;
		contrat_exec_w[i].cd_cep		:= Vet03.cd_cep;
		contrat_exec_w[i].cd_cgc		:= Vet03.cd_cgc;
		contrat_exec_w[i].cd_cgc_compl		:= Vet03.cd_cgc_compl;
		contrat_exec_w[i].cd_cgc_honor		:= Vet03.cd_cgc_honor;
		contrat_exec_w[i].cd_cnes		:= Vet03.cd_cnes;
		contrat_exec_w[i].cd_cnes_compl		:= Vet03.cd_cnes_compl;
		contrat_exec_w[i].cd_cnes_honor		:= Vet03.cd_cnes_honor;
		contrat_exec_w[i].cd_interno		:= Vet03.cd_interno;
		contrat_exec_w[i].cd_interno_compl	:= Vet03.cd_interno_compl;
		contrat_exec_w[i].cd_interno_honor	:= Vet03.cd_interno_honor;
		contrat_exec_w[i].cd_municipio_ibge	:= Vet03.cd_municipio_ibge;
		contrat_exec_w[i].cd_pessoa_fisica	:= Vet03.cd_pessoa_fisica;
		contrat_exec_w[i].ds_complemento	:= Vet03.ds_complemento;
		contrat_exec_w[i].ds_logradouro		:= Vet03.ds_logradouro;
		contrat_exec_w[i].ie_funcao_medico_compl:= Vet03.ie_funcao_medico_compl;
		contrat_exec_w[i].ie_tipo_acomodacao	:= Vet03.ie_tipo_acomodacao;
		contrat_exec_w[i].ie_tipo_logradouro	:= Vet03.ie_tipo_logradouro;
		contrat_exec_w[i].nm_contratado		:= Vet03.nm_contratado;
		contrat_exec_w[i].nm_contratado_honor	:= Vet03.nm_contratado_honor;
		contrat_exec_w[i].nm_exec_compl		:= Vet03.nm_exec_compl;
		contrat_exec_w[i].nm_municipio		:= Vet03.nm_municipio;
		contrat_exec_w[i].nr_cpf		:= Vet03.nr_cpf;
		contrat_exec_w[i].nr_cpf_compl		:= Vet03.nr_cpf_compl;
		contrat_exec_w[i].nr_cpf_honor		:= Vet03.nr_cpf_honor;
		contrat_exec_w[i].nr_crm_compl		:= Vet03.nr_crm_compl;
		contrat_exec_w[i].nr_crm_compl_id	:= Vet03.nr_crm_compl_id;
		contrat_exec_w[i].nr_endereco		:= Vet03.nr_endereco;
		contrat_exec_w[i].nr_seq_guia		:= Vet03.nr_seq_guia;
		contrat_exec_w[i].sg_conselho_compl	:= Vet03.sg_conselho_compl;
		contrat_exec_w[i].sg_conselho_compl_id	:= Vet03.sg_conselho_compl_id;
		contrat_exec_w[i].sg_estado		:= Vet03.sg_estado;
		contrat_exec_w[i].uf_conselho_compl	:= Vet03.uf_conselho_compl;
		contrat_exec_w[i].uf_conselho_compl_id	:= Vet03.uf_conselho_compl_id;


		end;
	end loop;
	close C03;

	end;
end loop;
close C01;

/*
i	Primeira guia que será verificada
j	Segunda guia que será verificada
*/
for i in 1..guias_w.count loop
	begin
	j	:= i + 1;

	if (i <= 1) then
		/*VERIFICA OS DADOS DAS GUIAS */

		if (guias_w[i].cd_ans <> guias_w[j].cd_ans) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_ANS',
						guias_w[i].cd_ans,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_ANS',
						guias_w[j].cd_ans,
						'');
		end if;
		if (guias_w[i].cd_autorizacao <> guias_w[j].cd_autorizacao) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_AUTORIZACAO',
						guias_w[i].cd_autorizacao,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_AUTORIZACAO',
						guias_w[j].cd_autorizacao,
						'');
		end if;
		if (guias_w[i].cd_autorizacao_princ <> guias_w[j].cd_autorizacao_princ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_AUTORIZACAO_PRINC',
						guias_w[i].cd_autorizacao_princ,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_AUTORIZACAO_PRINC',
						guias_w[j].cd_autorizacao_princ,
						'');
		end if;
		if (guias_w[i].cd_autorizacao_tag <> guias_w[j].cd_autorizacao_tag ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_AUTORIZACAO_TAG',
						guias_w[i].cd_autorizacao_tag,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_AUTORIZACAO_TAG',
						guias_w[j].cd_autorizacao_tag,
						'');
		end if;
		if (guias_w[i].cd_cgc_fonte_pag <> guias_w[j].cd_cgc_fonte_pag ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_CGC_FONTE_PAG',
						guias_w[i].cd_cgc_fonte_pag,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_CGC_FONTE_PAG',
						guias_w[j].cd_cgc_fonte_pag,
						'');
		end if;
		if (guias_w[i].cd_cgc_prestador <> guias_w[j].cd_cgc_prestador ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_CGC_PRESTADOR',
						guias_w[i].cd_cgc_prestador,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_CGC_PRESTADOR',
						guias_w[j].cd_cgc_prestador,
						'');
		end if;
		if (guias_w[i].cd_cid <> guias_w[j].cd_cid ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_CID',
						guias_w[i].cd_cid,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_CID',
						guias_w[j].cd_cid,
						'');
		end if;
		if (guias_w[i].cd_cid_obito <> guias_w[j].cd_cid_obito ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_CID_OBITO',
						guias_w[i].cd_cid_obito,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_CID_OBITO',
						guias_w[j].cd_cid_obito,
						'');
		end if;
		if (guias_w[i].cd_cid_2 <> guias_w[j].cd_cid_2 ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_CID_2',
						guias_w[i].cd_cid_2,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_CID_2',
						guias_w[j].cd_cid_2,
						'');
		end if;
		if (guias_w[i].cd_cid_3 <> guias_w[j].cd_cid_3 ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_CID_3',
						guias_w[i].cd_cid_3,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_CID_3',
						guias_w[j].cd_cid_3,
						'');
		end if;
		if (guias_w[i].cd_cid_4 <> guias_w[j].cd_cid_4 ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_CID_4',
						guias_w[i].cd_cid_4,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_CID_4',
						guias_w[j].cd_cid_4,
						'');
		end if;
		if (guias_w[i].cd_medico_executor <> guias_w[j].cd_medico_executor ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_MEDICO_EXECUTOR',
						guias_w[i].cd_medico_executor,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_MEDICO_EXECUTOR',
						guias_w[j].cd_medico_executor,
						'');
		end if;
		if (guias_w[i].cd_senha <> guias_w[j].cd_senha ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_SENHA',
						guias_w[i].cd_senha,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_SENHA',
						guias_w[j].cd_senha,
						'');
		end if;
		if (guias_w[i].cd_tabela_cid <> guias_w[j].cd_tabela_cid ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_TABELA_CID',
						guias_w[i].cd_tabela_cid,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_TABELA_CID',
						guias_w[j].cd_tabela_cid,
						'');
		end if;
		if (guias_w[i].cd_tabela_cid_obito <> guias_w[j].cd_tabela_cid_obito ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_TABELA_CID_OBITO',
						guias_w[i].cd_tabela_cid_obito,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_TABELA_CID_OBITO',
						guias_w[j].cd_tabela_cid_obito,
						'');
		end if;
		if (guias_w[i].cd_tabela_cid_2 <> guias_w[j].cd_tabela_cid_2 ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'CD_TABELA_CID_2',
						guias_w[i].cd_tabela_cid_2,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'CD_TABELA_CID_2',
						guias_w[j].cd_tabela_cid_2,
						'');
		end if;
		if (guias_w[i].ds_cid <> guias_w[j].ds_cid ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'DS_CID',
						guias_w[i].ds_cid,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'DS_CID',
						guias_w[j].ds_cid,
						'');
		end if;
		if (guias_w[i].ds_cid_obito <> guias_w[j].ds_cid_obito ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'DS_CID_OBITO',
						guias_w[i].ds_cid_obito,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'DS_CID_OBITO',
						guias_w[j].ds_cid_obito,
						'');
		end if;
		if (guias_w[i].ds_cid_2 <> guias_w[j].ds_cid_2 ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'DS_CID_2',
						guias_w[i].ds_cid_2,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'DS_CID_2',
						guias_w[j].ds_cid_2,
						'');
		end if;
		if (guias_w[i].ds_data_assin_benef <> guias_w[j].ds_data_assin_benef ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'DS_DATA_ASSIN_BENEF',
						guias_w[i].ds_data_assin_benef,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'DS_DATA_ASSIN_BENEF',
						guias_w[j].ds_data_assin_benef,
						'');
		end if;
		if (guias_w[i].ds_data_assin_med <> guias_w[j].ds_data_assin_med ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'DS_DATA_ASSIN_MED',
						guias_w[i].ds_data_assin_med,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'DS_DATA_ASSIN_MED',
						guias_w[j].ds_data_assin_med,
						'');
		end if;
		if (guias_w[i].ds_indicacao <> guias_w[j].ds_indicacao ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'DS_INDICACAO',
						guias_w[i].ds_indicacao,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'DS_INDICACAO',
						guias_w[j].ds_indicacao,
						'');
		end if;
		if (guias_w[i].ds_observacao <> guias_w[j].ds_observacao ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'DS_OBSERVACAO',
						guias_w[i].ds_observacao,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'DS_OBSERVACAO',
						guias_w[j].ds_observacao,
						'');
		end if;
		if (guias_w[i].dt_autorizacao <> guias_w[j].dt_autorizacao ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'DT_AUTORIZACAO',
						guias_w[i].dt_autorizacao,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'DT_AUTORIZACAO',
						guias_w[j].dt_autorizacao,
						'');
		end if;
		if (guias_w[i].dt_emissao_guia <> guias_w[j].dt_emissao_guia ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'DT_EMISSAO_GUIA',
						guias_w[i].dt_emissao_guia,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'DT_EMISSAO_GUIA',
						guias_w[j].dt_emissao_guia,
						'');
		end if;
		if (guias_w[i].dt_fim_faturamento <> guias_w[j].dt_fim_faturamento ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'DT_FIM_FATURAMENTO',
						guias_w[i].dt_fim_faturamento,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'DT_FIM_FATURAMENTO',
						guias_w[j].dt_fim_faturamento,
						'');
		end if;
		if (guias_w[i].dt_fim_vigencia <> guias_w[j].dt_fim_vigencia ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'DT_FIM_VIGENCIA',
						guias_w[i].dt_fim_vigencia,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'DT_FIM_VIGENCIA',
						guias_w[j].dt_fim_vigencia,
						'');
		end if;
		if (guias_w[i].dt_inicio_faturamento <> guias_w[j].dt_inicio_faturamento ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'DT_INICIO_FATURAMENTO',
						guias_w[i].dt_inicio_faturamento,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'DT_INICIO_FATURAMENTO',
						guias_w[j].dt_inicio_faturamento,
						'');
		end if;
		if (guias_w[i].dt_validade_senha <> guias_w[j].dt_validade_senha ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'DT_VALIDADE_SENHA',
						guias_w[i].dt_validade_senha,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'DT_VALIDADE_SENHA',
						guias_w[j].dt_validade_senha,
						'');
		end if;
		if (guias_w[i].ie_honorario <> guias_w[j].ie_honorario ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'IE_HONORARIO',
						guias_w[i].ie_honorario,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'IE_HONORARIO',
						guias_w[j].ie_honorario,
						'');
		end if;
		if (guias_w[i].ie_tipo_acidente <> guias_w[j].ie_tipo_acidente ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'IE_TIPO_ACIDENTE',
						guias_w[i].ie_tipo_acidente,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'IE_TIPO_ACIDENTE',
						guias_w[j].ie_tipo_acidente,
						'');
		end if;
		if (guias_w[i].ie_tipo_atend_tiss <> guias_w[j].ie_tipo_atend_tiss ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'IE_TIPO_ATEND_TISS',
						guias_w[i].ie_tipo_atend_tiss,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'IE_TIPO_ATEND_TISS',
						guias_w[j].ie_tipo_atend_tiss,
						'');
		end if;
		if (guias_w[i].ie_tipo_cid <> guias_w[j].ie_tipo_cid ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'IE_TIPO_CID',
						guias_w[i].ie_tipo_cid,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'IE_TIPO_CID',
						guias_w[j].ie_tipo_cid,
						'');
		end if;
		if (guias_w[i].ie_tipo_saida <> guias_w[j].ie_tipo_saida ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'IE_TIPO_SAIDA',
						guias_w[i].ie_tipo_saida,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'IE_TIPO_SAIDA',
						guias_w[j].ie_tipo_saida,
						'');
		end if;
		if (guias_w[i].ie_tiss_tipo_guia <> guias_w[j].ie_tiss_tipo_guia ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'IE_TISS_TIPO_GUIA',
						guias_w[i].ie_tiss_tipo_guia,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'IE_TISS_TIPO_GUIA',
						guias_w[j].ie_tiss_tipo_guia,
						'');
		end if;
		if (guias_w[i].ie_unidade_tempo_cid <> guias_w[j].ie_unidade_tempo_cid ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'IE_UNIDADE_TEMPO_CID',
						guias_w[i].ie_unidade_tempo_cid,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'IE_UNIDADE_TEMPO_CID',
						guias_w[j].ie_unidade_tempo_cid,
						'');
		end if;
		if (guias_w[i].nr_guia_prestador <> guias_w[j].nr_guia_prestador ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'NR_GUIA_PRESTADOR',
						guias_w[i].nr_guia_prestador,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'NR_GUIA_PRESTADOR',
						guias_w[j].nr_guia_prestador,
						'');
		end if;
		if (guias_w[i].qt_tempo_cid <> guias_w[j].qt_tempo_cid ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						'QT_TEMPO_CID',
						guias_w[i].qt_tempo_cid,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						'QT_TEMPO_CID',
						guias_w[j].qt_tempo_cid,
						'');
		end if;

		/*VERIFICA OS DADOS DO CONTRATADO SOLICITANTE */

		ds_texto_w := substr(wheb_mensagem_pck.get_texto(310215),1,255); --Solicitante
		if (contrat_solic_w[i].cd_cbos_solic <> contrat_solic_w[j].cd_cbos_solic ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_CBOS_SOLIC',
						contrat_solic_w[i].cd_cbos_solic,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_CBOS_SOLIC',
						contrat_solic_w[j].cd_cbos_solic,
						'');
		end if;
		if (contrat_solic_w[i].cd_cgc <> contrat_solic_w[j].cd_cgc ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_CGC',
						contrat_solic_w[i].cd_cgc,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_CGC',
						contrat_solic_w[j].cd_cgc,
						'');
		end if;
		if (contrat_solic_w[i].cd_cnes <> contrat_solic_w[j].cd_cnes ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_CNES',
						contrat_solic_w[i].cd_cnes,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_CNES',
						contrat_solic_w[j].cd_cnes,
						'');
		end if;
		if (contrat_solic_w[i].cd_interno <> contrat_solic_w[j].cd_interno ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_INTERNO',
						contrat_solic_w[i].cd_interno,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_INTERNO',
						contrat_solic_w[j].cd_interno,
						'');
		end if;
		if (contrat_solic_w[i].cd_pessoa_fisica <> contrat_solic_w[j].cd_pessoa_fisica ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_PESSOA_FISICA',
						contrat_solic_w[i].cd_pessoa_fisica,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_PESSOA_FISICA',
						contrat_solic_w[j].cd_pessoa_fisica,
						'');
		end if;
		if (contrat_solic_w[i].nm_contratado <> contrat_solic_w[j].nm_contratado ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NM_CONTRATADO',
						contrat_solic_w[i].nm_contratado,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NM_CONTRATADO',
						contrat_solic_w[j].nm_contratado,
						'');
		end if;
		if (contrat_solic_w[i].nm_solicitante <> contrat_solic_w[j].nm_solicitante ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NM_SOLICITANTE',
						contrat_solic_w[i].nm_solicitante,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NM_SOLICITANTE',
						contrat_solic_w[j].nm_solicitante,
						'');
		end if;
		if (contrat_solic_w[i].nr_cpf <> contrat_solic_w[j].nr_cpf ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NR_CPF',
						contrat_solic_w[i].nr_cpf,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NR_CPF',
						contrat_solic_w[j].nr_cpf,
						'');
		end if;
		if (contrat_solic_w[i].nr_crm_solic <> contrat_solic_w[j].nr_crm_solic ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NR_CRM_SOLIC',
						contrat_solic_w[i].nr_crm_solic,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NR_CRM_SOLIC',
						contrat_solic_w[j].nr_crm_solic,
						'');
		end if;
		if (contrat_solic_w[i].sg_conselho_solic <> contrat_solic_w[j].sg_conselho_solic ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - SG_CONSELHO_SOLIC',
						contrat_solic_w[i].sg_conselho_solic,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - SG_CONSELHO_SOLIC',
						contrat_solic_w[j].sg_conselho_solic,
						'');
		end if;
		if (contrat_solic_w[i].uf_conselho_solic <> contrat_solic_w[j].uf_conselho_solic ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - UF_CONSELHO_SOLIC',
						contrat_solic_w[i].uf_conselho_solic,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - UF_CONSELHO_SOLIC',
						contrat_solic_w[j].uf_conselho_solic,
						'');
		end if;

		/*VERIFICA OS DADOS DO CONTRATADO EXECUTANTE */

		ds_texto_w := substr(wheb_mensagem_pck.get_texto(310216),1,255); --Executante
		if (contrat_exec_w[i].cd_cbos_compl <> contrat_exec_w[j].cd_cbos_compl ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_CBOS_COMPL',
						contrat_exec_w[i].cd_cbos_compl,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_CBOS_COMPL',
						contrat_exec_w[j].cd_cbos_compl,
						'');
		end if;
		if (contrat_exec_w[i].cd_cep <> contrat_exec_w[j].cd_cep ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_CEP',
						contrat_exec_w[i].cd_cep,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_CEP',
						contrat_exec_w[j].cd_cep,
						'');
		end if;
		if (contrat_exec_w[i].cd_cgc <> contrat_exec_w[j].cd_cgc ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_CGC',
						contrat_exec_w[i].cd_cgc,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_CGC',
						contrat_exec_w[j].cd_cgc,
						'');
		end if;
		if (contrat_exec_w[i].cd_cgc_compl <> contrat_exec_w[j].cd_cgc_compl ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_CGC_COMPL',
						contrat_exec_w[i].cd_cgc_compl,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_CGC_COMPL',
						contrat_exec_w[j].cd_cgc_compl,
						'');
		end if;
		if (contrat_exec_w[i].cd_cgc_honor <> contrat_exec_w[j].cd_cgc_honor ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_CGC_HONOR',
						contrat_exec_w[i].cd_cgc_honor,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_CGC_HONOR',
						contrat_exec_w[j].cd_cgc_honor,
						'');
		end if;
		if (contrat_exec_w[i].cd_cnes <> contrat_exec_w[j].cd_cnes ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_CNES',
						contrat_exec_w[i].cd_cnes,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_CNES',
						contrat_exec_w[j].cd_cnes,
						'');
		end if;
		if (contrat_exec_w[i].cd_cnes_compl <> contrat_exec_w[j].cd_cnes_compl ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_CNES_COMPL',
						contrat_exec_w[i].cd_cnes_compl,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_CNES_COMPL',
						contrat_exec_w[j].cd_cnes_compl,
						'');
		end if;
		if (contrat_exec_w[i].cd_cnes_honor <> contrat_exec_w[j].cd_cnes_honor ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_CNES_HONOR',
						contrat_exec_w[i].cd_cnes_honor,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_CNES_HONOR',
						contrat_exec_w[j].cd_cnes_honor,
						'');
		end if;
		if (contrat_exec_w[i].cd_interno <> contrat_exec_w[j].cd_interno ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_INTERNO',
						contrat_exec_w[i].cd_interno,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_INTERNO',
						contrat_exec_w[j].cd_interno,
						'');
		end if;
		if (contrat_exec_w[i].cd_interno_compl <> contrat_exec_w[j].cd_interno_compl ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_INTERNO_COMPL',
						contrat_exec_w[i].cd_interno_compl,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_INTERNO_COMPL',
						contrat_exec_w[j].cd_interno_compl,
						'');
		end if;
		if (contrat_exec_w[i].cd_interno_honor <> contrat_exec_w[j].cd_interno_honor ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_INTERNO_HONOR',
						contrat_exec_w[i].cd_interno_honor,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_INTERNO_HONOR',
						contrat_exec_w[j].cd_interno_honor,
						'');
		end if;
		if (contrat_exec_w[i].cd_municipio_ibge <> contrat_exec_w[j].cd_municipio_ibge ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_MUNICIPIO_IBGE',
						contrat_exec_w[i].cd_municipio_ibge,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_MUNICIPIO_IBGE',
						contrat_exec_w[j].cd_municipio_ibge,
						'');
		end if;
		if (contrat_exec_w[i].cd_pessoa_fisica <> contrat_exec_w[j].cd_pessoa_fisica ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - CD_PESSOA_FISICA',
						contrat_exec_w[i].cd_pessoa_fisica,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - CD_PESSOA_FISICA',
						contrat_exec_w[j].cd_pessoa_fisica,
						'');
		end if;
		if (contrat_exec_w[i].ds_complemento <> contrat_exec_w[j].ds_complemento ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - DS_COMPLEMENTO',
						contrat_exec_w[i].ds_complemento,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - DS_COMPLEMENTO',
						contrat_exec_w[j].ds_complemento,
						'');
		end if;
		if (contrat_exec_w[i].ds_logradouro <> contrat_exec_w[j].ds_logradouro ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - DS_LOGRADOURO',
						contrat_exec_w[i].ds_logradouro,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - DS_LOGRADOURO',
						contrat_exec_w[j].ds_logradouro,
						'');
		end if;
		if (contrat_exec_w[i].ie_funcao_medico_compl <> contrat_exec_w[j].ie_funcao_medico_compl ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - IE_FUNCAO_MEDICO_COMPL',
						contrat_exec_w[i].ie_funcao_medico_compl,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - IE_FUNCAO_MEDICO_COMPL',
						contrat_exec_w[j].ie_funcao_medico_compl,
						'');
		end if;
		if (contrat_exec_w[i].ie_tipo_acomodacao <> contrat_exec_w[j].ie_tipo_acomodacao ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - IE_TIPO_ACOMODACAO',
						contrat_exec_w[i].ie_tipo_acomodacao,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - IE_TIPO_ACOMODACAO',
						contrat_exec_w[j].ie_tipo_acomodacao,
						'');
		end if;
		if (contrat_exec_w[i].ie_tipo_logradouro <> contrat_exec_w[j].ie_tipo_logradouro ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - IE_TIPO_LOGRADOURO',
						contrat_exec_w[i].ie_tipo_logradouro,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - IE_TIPO_LOGRADOURO',
						contrat_exec_w[j].ie_tipo_logradouro,
						'');
		end if;
		if (contrat_exec_w[i].nm_contratado <> contrat_exec_w[j].nm_contratado ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NM_CONTRATADO',
						contrat_exec_w[i].nm_contratado,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NM_CONTRATADO',
						contrat_exec_w[j].nm_contratado,
						'');
		end if;
		if (contrat_exec_w[i].nm_contratado_honor <> contrat_exec_w[j].nm_contratado_honor ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NM_CONTRATADO_HONOR',
						contrat_exec_w[i].nm_contratado_honor,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NM_CONTRATADO_HONOR',
						contrat_exec_w[j].nm_contratado_honor,
						'');
		end if;
		if (contrat_exec_w[i].nm_exec_compl <> contrat_exec_w[j].nm_exec_compl ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NM_EXEC_COMPL',
						contrat_exec_w[i].nm_exec_compl,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NM_EXEC_COMPL',
						contrat_exec_w[j].nm_exec_compl,
						'');
		end if;
		if (contrat_exec_w[i].nm_municipio <> contrat_exec_w[j].nm_municipio ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NM_MUNICIPIO',
						contrat_exec_w[i].nm_municipio,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NM_MUNICIPIO',
						contrat_exec_w[j].nm_municipio,
						'');
		end if;
		if (contrat_exec_w[i].nr_cpf <> contrat_exec_w[j].nr_cpf ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NR_CPF',
						contrat_exec_w[i].nr_cpf,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NR_CPF',
						contrat_exec_w[j].nr_cpf,
						'');
		end if;
		if (contrat_exec_w[i].nr_cpf_compl <> contrat_exec_w[j].nr_cpf_compl ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NR_CPF_COMPL',
						contrat_exec_w[i].nr_cpf_compl,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NR_CPF_COMPL',
						contrat_exec_w[j].nr_cpf_compl,
						'');
		end if;
		if (contrat_exec_w[i].nr_cpf_honor <> contrat_exec_w[j].nr_cpf_honor ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NR_CPF_HONOR',
						contrat_exec_w[i].nr_cpf_honor,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NR_CPF_HONOR',
						contrat_exec_w[j].nr_cpf_honor,
						'');
		end if;
		if (contrat_exec_w[i].nr_crm_compl <> contrat_exec_w[j].nr_crm_compl ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NR_CRM_COMPL',
						contrat_exec_w[i].nr_crm_compl,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NR_CRM_COMPL',
						contrat_exec_w[j].nr_crm_compl,
						'');
		end if;
		if (contrat_exec_w[i].nr_crm_compl_id <> contrat_exec_w[j].nr_crm_compl_id ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NR_CRM_COMPL_ID',
						contrat_exec_w[i].nr_crm_compl_id,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NR_CRM_COMPL_ID',
						contrat_exec_w[j].nr_crm_compl_id,
						'');
		end if;
		if (contrat_exec_w[i].nr_endereco <> contrat_exec_w[j].nr_endereco ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - NR_ENDERECO',
						contrat_exec_w[i].nr_endereco,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - NR_ENDERECO',
						contrat_exec_w[j].nr_endereco,
						'');
		end if;
		if (contrat_exec_w[i].sg_conselho_compl <> contrat_exec_w[j].sg_conselho_compl ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - SG_CONSELHO_COMPL',
						contrat_exec_w[i].sg_conselho_compl,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - SG_CONSELHO_COMPL',
						contrat_exec_w[j].sg_conselho_compl,
						'');
		end if;
		if (contrat_exec_w[i].sg_conselho_compl_id <> contrat_exec_w[j].sg_conselho_compl_id ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - SG_CONSELHO_COMPL_ID',
						contrat_exec_w[i].sg_conselho_compl_id,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - SG_CONSELHO_COMPL_ID',
						contrat_exec_w[j].sg_conselho_compl_id,
						'');
		end if;
		if (contrat_exec_w[i].sg_estado <> contrat_exec_w[j].sg_estado ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - SG_ESTADO',
						contrat_exec_w[i].sg_estado,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - SG_ESTADO',
						contrat_exec_w[j].sg_estado,
						'');
		end if;
		if (contrat_exec_w[i].uf_conselho_compl <> contrat_exec_w[j].uf_conselho_compl ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - UF_CONSELHO_COMPL',
						contrat_exec_w[i].uf_conselho_compl,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - UF_CONSELHO_COMPL',
						contrat_exec_w[j].uf_conselho_compl,
						'');
		end if;
		if (contrat_exec_w[i].uf_conselho_compl_id <> contrat_exec_w[j].uf_conselho_compl_id ) then
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[i].nr_sequencia,
						ds_texto_w || ' - UF_CONSELHO_COMPL_ID',
						contrat_exec_w[i].uf_conselho_compl_id,
						'');
			CALL TISS_GRAVAR_DUPL_GUIA(	guias_w[j].nr_sequencia,
						ds_texto_w || ' - UF_CONSELHO_COMPL_ID',
						contrat_exec_w[j].uf_conselho_compl_id,
						'');
		end if;

	end if;
	end;
end loop;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE tiss_consiste_guia_duplicada (nr_interno_conta_p bigint, ds_seq_guias_p text) FROM PUBLIC;

