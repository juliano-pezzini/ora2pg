-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE envia_nova_solic_fila_transm ( nr_solic_compra_p bigint, nm_usuario_p text) AS $body$
BEGIN
 
update	solic_compra 
set	ie_status_envio	= 'F' 
where	nr_solic_compra	= nr_solic_compra_p;
 
insert into solic_compra_fila_transm( 
	nr_sequencia, 
	dt_atualizacao, 
	nm_usuario, 
	dt_atualizacao_nrec, 
	nm_usuario_nrec, 
	nr_solic_compra, 
	ie_evento) 
values (	nextval('solic_compra_fila_transm_seq'), 
	clock_timestamp(), 
	nm_usuario_p, 
	clock_timestamp(), 
	nm_usuario_p, 
	nr_solic_compra_p, 
	'EN');
 
insert into cot_compra_log_integracao( 
	nr_sequencia, 
	dt_atualizacao, 
	nm_usuario, 
	dt_atualizacao_nrec, 
	nm_usuario_nrec, 
	nr_solic_compra, 
	ie_status_envio, 
	ie_tipo_integracao, 
	ds_log) 
values (	nextval('cot_compra_log_integracao_seq'), 
	clock_timestamp(), 
	nm_usuario_p, 
	clock_timestamp(), 
	nm_usuario_p, 
	nr_solic_compra_p, 
	'FS', 
	'S', 
	WHEB_MENSAGEM_PCK.get_texto(299762));
 
commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE envia_nova_solic_fila_transm ( nr_solic_compra_p bigint, nm_usuario_p text) FROM PUBLIC;

