-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE tax_dmed_ir_delphi (ie_procedure_p text, generation_user_p text default '', username_p text default '', sequence_p bigint default 0, batch_monthly_sequence_p bigint default 0, establishment_code_p bigint default 0, batch_code_p bigint default 0, receivable_p bigint default 0, ie_provider_p text default '', document_sequence_p text default '', response_p INOUT text DEFAULT NULL) AS $body$
DECLARE

  response_w varchar(4000);

BEGIN
    /*
        IE_PROCEDURE
        GF - GENERATE_FILE_DATA
        UF - UNDO_FILE_GENERATION
        GD - GENERATE_DATA
        UD - UNDO_MONTHLY_BATCH
        IR - INCLUDE_RECEIVABLE
        RR - REMOVE_RECEIVABLE
        GI - GENERATE_IRPF
        UI - UNDO_IRPF
        SE - SEND_EMAIL_IRPF
        DV - DATA_VALIDATOR
        CI - CONFIRM_IRPF
    */
    if (ie_procedure_p = 'GF') then
        CALL tax_dmed_ir_pck.generate_file_data(sequence_p, generation_user_p);
    elsif (ie_procedure_p = 'UF') then
        CALL tax_dmed_ir_pck.undo_file_generation(sequence_p);
    elsif (ie_procedure_p = 'GD') then
        CALL tax_dmed_ir_pck.generate_data(batch_monthly_sequence_p);
    elsif (ie_procedure_p = 'UD') then
        CALL tax_dmed_ir_pck.undo_monthly_batch(batch_monthly_sequence_p);
    elsif (ie_procedure_p = 'IR') then
        CALL tax_dmed_ir_pck.include_receivable(establishment_code_p, username_p, batch_code_p, receivable_p);
    elsif (ie_procedure_p = 'RR') then
        CALL tax_dmed_ir_pck.remove_receivable(sequence_p);
    elsif (ie_procedure_p = 'GI') then
        CALL tax_dmed_ir_pck.generate_irpf(sequence_p, username_p);
    elsif (ie_procedure_p = 'UI') then
        CALL tax_dmed_ir_pck.undo_irpf(sequence_p, username_p);
    elsif (ie_procedure_p = 'SE') then
        CALL tax_dmed_ir_pck.send_email_irpf(sequence_p, batch_code_p, username_p, establishment_code_p);
    elsif (ie_procedure_p = 'DV') then
        response_w := tax_dmed_ir_pck.data_validator(batch_monthly_sequence_p, document_sequence_p, establishment_code_p, ie_provider_p, response_w);
        response_p := response_w;
    elsif (ie_procedure_p = 'CI') then
        CALL tax_dmed_ir_pck.confirm_irpf(sequence_p, username_p);
    end if;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE tax_dmed_ir_delphi (ie_procedure_p text, generation_user_p text default '', username_p text default '', sequence_p bigint default 0, batch_monthly_sequence_p bigint default 0, establishment_code_p bigint default 0, batch_code_p bigint default 0, receivable_p bigint default 0, ie_provider_p text default '', document_sequence_p text default '', response_p INOUT text DEFAULT NULL) FROM PUBLIC;

