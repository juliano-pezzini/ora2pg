-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE baca_acerto_fluxo_pk (ie_pk_nova_p text) AS $body$
DECLARE


cont_w	integer;


BEGIN

CALL Exec_sql_Dinamico('Edgar','alter table fluxo_caixa drop constraint FLUCAIX_PK');

if (ie_pk_nova_p = 'S') then
	CALL Exec_sql_Dinamico('Edgar',	'ALTER TABLE FLUXO_CAIXA ADD ' ||
					'(  ' ||
					'      CONSTRAINT FLUCAIX_PK Primary Key  ( ' ||
					'		CD_EMPRESA, ' ||
					'               CD_ESTABELECIMENTO, ' ||
					'               DT_REFERENCIA, ' ||
					'               CD_CONTA_FINANC, ' ||
					'               IE_CLASSIF_FLUXO, ' ||
					'               IE_PERIODO, ' ||
					'               IE_INTEGRACAO) ' ||
					'USING INDEX   Tablespace TASY_INDEX) ');
else
	CALL Exec_sql_Dinamico('Edgar',	'ALTER TABLE FLUXO_CAIXA ADD ' ||
					'(  ' ||
					'      CONSTRAINT FLUCAIX_PK Primary Key  ( ' ||
					'               CD_ESTABELECIMENTO, ' ||
					'               DT_REFERENCIA, ' ||
					'               CD_CONTA_FINANC, ' ||
					'               IE_CLASSIF_FLUXO, ' ||
					'               IE_PERIODO, ' ||
					'               IE_INTEGRACAO) ' ||
					'USING INDEX   Tablespace TASY_INDEX) ');
end if;

SELECT	count(*)
into STRICT	cont_w
FROM	USER_CONS_COLUMNS
WHERE	CONSTRAINT_NAME = 'FLUCAIX_PK';

RAISE NOTICE 'Campos da PK: %', cont_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE baca_acerto_fluxo_pk (ie_pk_nova_p text) FROM PUBLIC;

