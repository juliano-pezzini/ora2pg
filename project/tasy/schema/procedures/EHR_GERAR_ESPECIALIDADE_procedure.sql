-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE ehr_gerar_especialidade (nr_seq_elemento_p bigint, ds_lista_p text, nm_usuario_p text) AS $body$
DECLARE


    lista_informacao_w     varchar(800);
    ie_contador_w          bigint := 0;
    tam_lista_w            bigint;
    ie_pos_virgula_w       smallint;
    nr_sequencia_w         bigint;
    nr_seq_especialidade_w bigint;


BEGIN

    lista_informacao_w := ds_lista_p;

    while (lista_informacao_w IS NOT NULL AND lista_informacao_w::text <> '') or ie_contador_w > 200 loop
        begin
            tam_lista_w      := length(lista_informacao_w);
            ie_pos_virgula_w := position(',' in lista_informacao_w);

            if (ie_pos_virgula_w <> 0) then
                nr_seq_especialidade_w := (substr(lista_informacao_w, 1, (ie_pos_virgula_w - 1)))::numeric;
                lista_informacao_w     := substr(lista_informacao_w, (ie_pos_virgula_w + 1), tam_lista_w);
            end if;

            $if $$tasy_local_dict=true $then
            nr_sequencia_w := get_remote_sequence('seq:ehr_elemento_especialidade_seq');
            $else
            select nextval('ehr_elemento_especialidade_seq') into STRICT nr_sequencia_w;
            $end

            insert into ehr_elemento_especialidade(nr_sequencia,
                 dt_atualizacao,
                 nm_usuario,
                 dt_atualizacao_nrec,
                 nm_usuario_nrec,
                 nr_seq_elemento,
                 nr_seq_especialidade)
            values (nr_sequencia_w, clock_timestamp(), nm_usuario_p, clock_timestamp(), nm_usuario_p, nr_seq_elemento_p, nr_seq_especialidade_w);

            ie_contador_w := ie_contador_w + 1;
        end;
    end loop;

    commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ehr_gerar_especialidade (nr_seq_elemento_p bigint, ds_lista_p text, nm_usuario_p text) FROM PUBLIC;

