-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE ajustar_prescr_material_html5 ( nr_prescricao_p bigint, nr_seq_cpoe_p bigint, cd_material_p bigint) AS $body$
DECLARE


c01 CURSOR FOR
SELECT	a.nr_sequencia
from	prescr_material a,
		cpoe_material b
where	a.nr_prescricao = nr_prescricao_p
and		a.nr_seq_mat_cpoe = b.nr_sequencia
and		a.nr_seq_mat_cpoe = nr_seq_cpoe_p
and		b.cd_material = cd_material_p
and		a.ie_agrupador in (1, 5)
and		a.cd_material in (	b.cd_material,
							b.cd_mat_comp1,
							b.cd_mat_comp2,
							b.cd_mat_comp3,
							b.cd_mat_comp4,
							b.cd_mat_comp5,
							b.cd_mat_comp6,
							b.cd_mat_comp7);

BEGIN

	for r_c01_w in c01
	loop

		CALL ajustar_prescr_material(nr_prescricao_p => nr_prescricao_p,
								nr_sequencia_p => r_c01_w.nr_sequencia,
								ie_atualiza_regra_disp_p => 'N');

	end loop;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ajustar_prescr_material_html5 ( nr_prescricao_p bigint, nr_seq_cpoe_p bigint, cd_material_p bigint) FROM PUBLIC;

