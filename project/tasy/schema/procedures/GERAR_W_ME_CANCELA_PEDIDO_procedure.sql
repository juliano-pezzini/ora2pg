-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_w_me_cancela_pedido ( idurl_p text, idbase_p text, empresa_p text, filial_p text, numeropedidowpd_p text, numeropedidome_p text, nm_usuario_p text, nr_seq_pedido_p INOUT text) AS $body$
DECLARE


nr_seq_me_cancela_pedido_w	bigint;


BEGIN

CALL inserir_log_me('OC', substr(numeropedidowpd_p||'@',1,position('@' in numeropedidowpd_p||'@')-1), 'AVISO', 'ROC', WHEB_MENSAGEM_PCK.get_texto(298427,'NR_ORDEM_COMPRA_P='||numeropedidowpd_p), '124', nm_usuario_p,'');
/* Cancelamento da Ordem de Compra n√∫mero #@NR_ORDEM_COMPRA_P#@. */

select	nextval('w_me_cancela_pedido_seq')
into STRICT	nr_seq_me_cancela_pedido_w
;

insert into w_me_cancela_pedido(
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	idurl,
	idbase,
	empresa,
	filial,
	numeropedidowpd,
	numeropedidome,
	ie_lido)
values (	nr_seq_me_cancela_pedido_w,
	clock_timestamp(),
	nm_usuario_p,
	clock_timestamp(),
	nm_usuario_p,
	idurl_p,
	idbase_p,
	empresa_p,
	filial_p,
	numeropedidowpd_p,
	numeropedidome_p,
	'N');

nr_seq_pedido_p:=	nr_seq_me_cancela_pedido_w;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_w_me_cancela_pedido ( idurl_p text, idbase_p text, empresa_p text, filial_p text, numeropedidowpd_p text, numeropedidome_p text, nm_usuario_p text, nr_seq_pedido_p INOUT text) FROM PUBLIC;

