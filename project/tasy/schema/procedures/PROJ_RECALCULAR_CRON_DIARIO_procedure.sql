-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE proj_recalcular_cron_diario () AS $body$
DECLARE


c01 CURSOR FOR
	SELECT	cro.nr_sequencia
	from	proj_projeto prj,
		proj_cronograma cro
	where	prj.nr_sequencia = cro.nr_seq_proj
	 and	prj.ie_origem = 'P'
	 and (coalesce(cro.dt_fim_real::text, '') = '' or cro.dt_fim_real >= clock_timestamp())
	 and	cro.ie_situacao = 'A'
	 and	prj.ie_status not in ('F', 'T');

nr_seq_cronograma_w	proj_cronograma.nr_sequencia%type;

BEGIN

<<proj_recalc_loop>>
for reg01 in c01 loop

	nr_seq_cronograma_w := reg01.nr_sequencia;

	CALL proj_recalcular_ativ_cron(	nr_seq_cronograma_p	=> nr_seq_cronograma_w,
					nm_usuario_p		=> 'Tasy');

	CALL proj_atual_pr_prev_ativ_cron(	nr_seq_cronograma_p	=> nr_seq_cronograma_w,
					nm_usuario_p		=> 'Tasy');

end loop proj_recalc_loop;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE proj_recalcular_cron_diario () FROM PUBLIC;

