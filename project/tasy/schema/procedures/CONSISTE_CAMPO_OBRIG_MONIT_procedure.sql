-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE consiste_campo_obrig_monit ( nr_sequencia_p bigint, ds_retorno_p INOUT text) AS $body$
DECLARE


ie_respiracao_w		varchar(200);
ie_disp_resp_esp_w 	varchar(100);
ie_padrao_resp_w 	varchar(100);
qt_freq_resp_w 		double precision;
ds_freq_resp_w 		varchar(100);
qt_saturacao_o2_w 	double precision;
ds_saturacao_o2_w 	varchar(100);
cd_mod_vent_w 		varchar(100);
qt_rima_labial_w 	double precision;
ds_rima_labial_w 	varchar(100);
qt_vmin_w 			double precision;
ds_vmin_w 			varchar(100);
qt_peep_w 			double precision;
ds_peep_w 			varchar(100);
qt_vce_w 			double precision;
ds_vce_w			varchar(100);
qt_sensib_resp_w		double precision;
ds_sensib_resp_w 		varchar(100);
qt_pressao_cuff_w		double precision;
ds_pressao_cuff_w		varchar(100);
ie_canula_traqueo_w		varchar(15);


BEGIN
if (nr_sequencia_p IS NOT NULL AND nr_sequencia_p::text <> '') then
	select	ie_respiracao,
		ie_disp_resp_esp,
		ie_padrao_resp,
		qt_freq_resp,
		qt_saturacao_o2,
		cd_mod_vent,
		qt_rima_labial,
		qt_vmin,
		qt_peep,
		qt_vce,
		qt_sensib_resp,
		qt_pressao_cuff,
		ie_canula_traqueo
	into STRICT	ie_respiracao_w,
		ie_disp_resp_esp_w,
		ie_padrao_resp_w,
		qt_freq_resp_w,
		qt_saturacao_o2_w,
		cd_mod_vent_w,
		qt_rima_labial_w,
		qt_vmin_w,
		qt_peep_w,
		qt_vce_w,
		qt_sensib_resp_w,
		qt_pressao_cuff_w,
		ie_canula_traqueo_w
	from	atendimento_monit_resp
	where	nr_sequencia	=  nr_sequencia_p;
end if;


if (ie_respiracao_w = 'ESPONT') and
	((ie_disp_resp_esp_w = '') or (ie_padrao_resp_w  	= '') or (coalesce(qt_freq_resp_w::text, '') = '') or (coalesce(qt_saturacao_o2_w::text, '') = '')) then
	select	CASE WHEN ie_padrao_resp='' THEN  obter_desc_expressao(295183) || ';'  ELSE '' END  ie_padrao_resp,
			CASE WHEN ie_disp_resp_esp='' THEN  obter_desc_expressao(288032) || ';'  ELSE '' END  ie_disp_resp_esp,
			CASE WHEN coalesce(qt_freq_resp::text, '') = '' THEN  obter_desc_expressao(290454) || ';'  ELSE '' END  qt_freq_resp,
			CASE WHEN coalesce(qt_saturacao_o2::text, '') = '' THEN  'Sat O² oxi dig (%) '  ELSE '' END  qt_saturacao_o2
	into STRICT	ie_padrao_resp_w,
			ie_disp_resp_esp_w,
			ds_freq_resp_w,
			ds_saturacao_o2_w
	from	atendimento_monit_resp
	where	nr_sequencia	=  nr_sequencia_p;

	ds_retorno_p := obter_desc_expressao(511678)||' '|| ie_padrao_resp_w || ie_disp_resp_esp_w || ds_freq_resp_w || ds_saturacao_o2_w;
elsif (ie_respiracao_w = 'VMI') and
	(((ie_canula_traqueo_w = 'COT') and (coalesce(qt_rima_labial_w::text, '') = '')) or (coalesce(cd_mod_vent_w::text, '') = '') or (coalesce(qt_freq_resp_w::text, '') = '') or (coalesce(qt_vmin_w::text, '') = '')	or (coalesce(qt_peep_w::text, '') = '') or (coalesce(qt_vce_w::text, '') = '') 	or (coalesce(qt_sensib_resp_w::text, '') = '') 	or (coalesce(qt_pressao_cuff_w::text, '') = '') or (coalesce(qt_saturacao_o2_w::text, '') = '')) then
	select	CASE WHEN cd_mod_vent='' THEN 'Mod vent; ' END  cd_mod_vent,
		CASE WHEN ie_canula_traqueo_w='COT' THEN CASE WHEN coalesce(qt_rima_labial::text, '') = '' THEN  obter_desc_expressao(297900) || ';' END   ELSE '' END  qt_rima_labial,
		CASE WHEN coalesce(qt_freq_resp::text, '') = '' THEN  obter_desc_expressao(290454) || ';'  ELSE '' END  qt_freq_resp,
		CASE WHEN coalesce(qt_vmin::text, '') = '' THEN  'Vol min (l/min); '  ELSE '' END  qt_vmin,
		CASE WHEN coalesce(qt_peep::text, '') = '' THEN  obter_desc_expressao(295397) || ';'  ELSE '' END  qt_peep,
		CASE WHEN coalesce(qt_vce::text, '') = '' THEN  'VC exp (ml); '  ELSE '' END  qt_vce_w,
		CASE WHEN coalesce(qt_sensib_resp::text, '') = '' THEN  obter_desc_expressao(741713) || ';'  ELSE '' END  qt_sensib_resp,
		CASE WHEN coalesce(qt_pressao_cuff::text, '') = '' THEN  obter_desc_expressao(296239) || ';'  ELSE '' END  qt_pressao_cuff,
		CASE WHEN coalesce(qt_saturacao_o2::text, '') = '' THEN  'Sat O² oxi dig (%) '  ELSE '' END  qt_saturacao_o2
	into STRICT	cd_mod_vent_w,
		ds_rima_labial_w,
		ds_freq_resp_w,
		ds_vmin_w,
		ds_peep_w,
		ds_vce_w,
		ds_sensib_resp_w,
		ds_pressao_cuff_w,
		ds_saturacao_o2_w
	from	atendimento_monit_resp
	where	nr_sequencia	=  nr_sequencia_p;

	ds_retorno_p := obter_desc_expressao(511678)||' '  || cd_mod_vent_w || ds_rima_labial_w || ds_freq_resp_w || ds_vmin_w ||
					ds_peep_w || ds_vce_w || ds_sensib_resp_w || ds_pressao_cuff_w	|| ds_saturacao_o2_w;
elsif (ie_respiracao_w = 'VMNI') and
	((coalesce(cd_mod_vent_w::text, '') = '') or (coalesce(qt_peep_w::text, '') = '')  or (coalesce(qt_saturacao_o2_w::text, '') = '')) then
	select	CASE WHEN cd_mod_vent='' THEN 'Mod vent; ' END  cd_mod_vent,
			CASE WHEN coalesce(qt_peep::text, '') = '' THEN  obter_desc_expressao(295397)  ELSE '' END  qt_peep,
			CASE WHEN coalesce(qt_saturacao_o2::text, '') = '' THEN  'Sat O² oxi dig (%) '  ELSE '' END  qt_saturacao_o2
	into STRICT	cd_mod_vent_w,
			ds_peep_w,
			ds_saturacao_o2_w
	from	atendimento_monit_resp
	where	nr_sequencia	=  nr_sequencia_p;

	ds_retorno_p := obter_desc_expressao(511678)||' '  || cd_mod_vent_w || ds_peep_w || ds_saturacao_o2_w;
elsif (ie_respiracao_w = 'VMN') and (cd_mod_vent_w = obter_desc_expressao(489569)) or (coalesce(qt_saturacao_o2_w::text, '') = '') then
	select	CASE WHEN coalesce(qt_saturacao_o2::text, '') = '' THEN  'Sat O² oxi dig (%) '  ELSE '' END  qt_saturacao_o2
	into STRICT	ds_saturacao_o2_w
	from	atendimento_monit_resp
	where	nr_sequencia	=  nr_sequencia_p;

	ds_retorno_p := obter_desc_expressao(511678)||' '  || ds_saturacao_o2_w;
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE consiste_campo_obrig_monit ( nr_sequencia_p bigint, ds_retorno_p INOUT text) FROM PUBLIC;

