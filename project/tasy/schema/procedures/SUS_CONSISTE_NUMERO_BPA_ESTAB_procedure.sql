-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE sus_consiste_numero_bpa_estab ( cd_estabelecimento_p bigint, nr_bpa_p text, nr_seq_bpa_p bigint, nm_usuario_p text, ie_tipo_consiste_p bigint, ds_erro_p INOUT text) AS $body$
DECLARE


ds_erro_w               varchar(255)   := '';
qt_digitos_bpa_w	integer	:= 0;


BEGIN

begin
select	coalesce(qt_digitos_bpa,0)
into STRICT	qt_digitos_bpa_w
from	sus_parametros_bpa
where	cd_estabelecimento	= cd_estabelecimento_p;
exception
	when others then
	qt_digitos_bpa_w	:= 0;
end;

if (nr_bpa_p IS NOT NULL AND nr_bpa_p::text <> '')	and (qt_digitos_bpa_w <> 0) 	and (length(nr_bpa_p) <> qt_digitos_bpa_w) then
	if (ie_tipo_consiste_p = 2) then
        	ds_erro_w	:= WHEB_MENSAGEM_PCK.get_texto(281670) || ' ' || qt_digitos_bpa_w || ' ' || WHEB_MENSAGEM_PCK.get_texto(281671);
	end if;
end if;

ds_erro_p	:= ds_erro_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE sus_consiste_numero_bpa_estab ( cd_estabelecimento_p bigint, nr_bpa_p text, nr_seq_bpa_p bigint, nm_usuario_p text, ie_tipo_consiste_p bigint, ds_erro_p INOUT text) FROM PUBLIC;

