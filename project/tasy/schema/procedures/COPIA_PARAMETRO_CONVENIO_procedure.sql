-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE copia_parametro_convenio ( cd_convenio_orig_p bigint, cd_convenio_dest_p text, ie_tipo_acao_p text, nm_tabela_p text, nm_usuario_p text, ie_excluir_p text, cd_estabelecimento_p bigint) AS $body$
DECLARE


nr_seq_w				bigint;
nr_seq_ww			bigint;
nr_sequencia_w			bigint;
nr_sequencia_ww			bigint;
cd_categoria_w			varchar(10);
dt_vigencia_w			timestamp;
dt_vigencia_final_w			timestamp;
cd_cgc_w			varchar(14);
cd_kit_material_w			integer;
cd_material_w			integer;
ie_via_aplicacao_w			varchar(5);
ie_tipo_paciente_w			varchar(3);
qt_material_w			double precision;
ie_situacao_w			varchar(1);
qt_volume_min_w			real;
qt_volume_max_w			real;
ie_baixa_estoque_w 		varchar(1);
cd_medico_w 			varchar(10);
ie_dispensavel_w			varchar(1);
nr_seq_kit_w			integer;
ie_ratear_repasse_w		varchar(2);
cd_tipo_acomodacao_w		smallint;
nr_seq_tabela_mat_w		bigint;
nr_seq_tabela_proc_w		bigint;
nr_seq_campo_conv_w		bigint;
nr_seq_prestador_w		bigint;
nr_seq_regra_guia_w		bigint;
nr_seq_regra_honor_w		bigint;
nr_seq_regra_valor_w		bigint;
nr_seq_guia_princ_w		bigint;
nr_seq_prestador_solic_w		bigint;
nr_seq_regra_prest_w		bigint;
nr_seq_motivo_glosa_w		bigint;
nr_seq_exec_compl_w		bigint;
nr_seq_motivo_glosa_conv_w	bigint;
cd_plano_w			varchar(10);
ds_xml_w				text;
qt_ajuste_w			smallint;
ie_documento_w			varchar(3);
ds_arquivo_w			varchar(255);
ie_video_w			varchar(1);
cd_fornecedor_w			varchar(14);
qt_idade_minima_w			smallint;
qt_idade_maxima_w		smallint;
ie_calcula_preco_w			varchar(1);
ie_entra_conta_w			varchar(1);
nr_seq_tiss_w			bigint;
nr_seq_tipo_atend_w		bigint;
ie_duplica_prescr_w		varchar(1);
ie_multiplica_dose_w		varchar(1);
cd_convenio_dest_w		integer;
nr_seq_tiss_regra_mat_opm_w	bigint;
nr_seq_lib_prescr_mat_w		bigint;
nr_sequencia_mat_w		bigint;
nr_seq_fatur_proc_w		bigint;
nr_seq_proc_w			bigint;
nr_seq_fatur_mat_w 		bigint;
nr_seq_mat_w			bigint;
nr_seq_cancel_conta_w		bigint;
nr_seq_estab_func_lib_w		bigint;
nr_seq_regra_taxa_tempo_w		bigint;
nr_seq_cancel_conta_ww		bigint;
nr_seq_estab_func_lib_ww		bigint;
nr_seq_regra_taxa_tempo_ww	bigint;
nr_seq_regra_lib_atend_w		bigint;
nr_seq_regra_seq_conta_w		bigint;
nr_seq_regra_pacote_w		bigint;
nr_seq_regra_taxa_cir_w		bigint;
nr_seq_porte_cbhpm_w		bigint;
nr_seq_conv_regra_setor_w		bigint;
nr_seq_tiss_regra_tipo_proc_w	bigint;
nr_seq_regra_prot_tipo_atend_w	bigint;
nr_seq_tiss_regra_campo_esp_w	bigint;
nr_seq_regra_campo_esp_w		bigint;
nr_seq_tiss_campo_esp_compl_w	bigint;
nr_seq_tiss_campo_esp_conv_w	bigint;
nr_seq_campo_esp_compl_w		bigint;
nr_seq_campo_esp_conv_w		bigint;
ie_tipo_convenio_w			smallint;
dt_final_vigencia_w			timestamp;
nr_seq_agenda_regra_w		agenda_regra.nr_sequencia%type;
nr_seq_next_agenda_regra_w	agenda_regra.nr_sequencia%type;


c000 CURSOR FOR
	SELECT	coalesce(cd_convenio,0)
	from	convenio
	where	(((ie_tipo_acao_p = '1') and (obter_se_contido(cd_convenio, elimina_aspas(cd_convenio_dest_p)) = 'S')) or
		((ie_tipo_acao_p = '2') and (not obter_se_contido(cd_convenio, elimina_aspas(cd_convenio_dest_p)) = 'S')));

c001 CURSOR FOR
	SELECT	cd_estabelecimento,
		cd_area_proced,
		cd_especial_proced,
		cd_grupo_proced,
		cd_procedimento,
		ie_origem_proced,
		cd_setor_atendimento,
		ie_medico_executor,
		cd_cgc,
		ie_tipo_atendimento,
		cd_medico_exec_filtro,
		cd_tipo_procedimento
	from	consiste_setor_proc
	where	cd_convenio = cd_convenio_orig_p;

c002 CURSOR FOR
	SELECT	nr_seq_exame,
		max(nr_sequencia) nr_sequencia
	from	exame_lab_convenio
	where	exists (
		SELECT	1
		from	exame_lab_convenio
		where	cd_convenio = cd_convenio_orig_p
		)
	group by nr_seq_exame;

c003 CURSOR FOR
	SELECT nr_sequencia
	from regra_lanc_automatico
	where cd_convenio = cd_convenio_orig_p;

c004 CURSOR FOR
	SELECT cd_tipo_acomodacao,
		 max(nr_sequencia) nr_sequencia
	from tipo_acomod_diferenca
	where exists (SELECT 1
			  from tipo_acomod_diferenca
			  where cd_convenio = cd_convenio_orig_p)
	group by cd_tipo_acomodacao;

c005 CURSOR FOR
	SELECT	cd_kit_material,cd_material,  ie_via_aplicacao, ie_tipo_paciente,
		qt_material, ie_situacao, qt_volume_min, qt_volume_max,
		ie_baixa_estoque,  cd_medico,  ie_dispensavel,
		ie_video, cd_fornecedor, qt_idade_minima,
		qt_idade_maxima, ie_calcula_preco,ie_entra_conta, coalesce(ie_duplica_prescr,'S'), coalesce(ie_multiplica_dose,'N'),
		ie_tipo_convenio
	from	componente_kit
	where	cd_convenio = cd_convenio_orig_p
	and	((coalesce(cd_estab_regra::text, '') = '') or (cd_estab_regra = cd_estabelecimento_p));

c006 CURSOR FOR
SELECT 	cd_categoria,
	cd_tipo_acomodacao
from	categoria_convenio
where 	cd_convenio		= cd_convenio_orig_p;

c007 CURSOR FOR
SELECT 	cd_plano
from	convenio_plano
where 	cd_convenio		= cd_convenio_orig_p;

c008 CURSOR FOR
SELECT 	nr_sequencia
from	evento_convenio
where 	cd_convenio		= cd_convenio_orig_p
and 	cd_estabelecimento	= cd_estabelecimento_p;

c009 CURSOR FOR
SELECT	nr_sequencia,
	ds_xml
from 	evento_convenio_xml
where 	nr_seq_evento_conv = nr_seq_w;


c010 CURSOR FOR
SELECT 	ie_documento,
	dt_vigencia,
	ds_arquivo,
	nr_sequencia,
	dt_final_vigencia
from 	convenio_documento
where 	cd_convenio		= cd_convenio_orig_p
and 	cd_estabelecimento	= cd_estabelecimento_p;

c011 CURSOR FOR
SELECT	nr_sequencia
from	tiss_regra_tabela_mat
where	cd_convenio		= cd_convenio_orig_p
and	cd_estabelecimento	= cd_estabelecimento_p;

c012 CURSOR FOR
SELECT	nr_sequencia
from	tiss_regra_tabela_proc
where	cd_convenio	 	= cd_convenio_orig_p
and	cd_estabelecimento	= cd_estabelecimento_p;

c013 CURSOR FOR
SELECT	nr_sequencia
from	tiss_regra_campo_conv
where	cd_convenio	 	= cd_convenio_orig_p
and	cd_estabelecimento	= cd_estabelecimento_p;

c014 CURSOR FOR
SELECT	nr_sequencia
from	tiss_regra_prestador
where	cd_convenio	 	= cd_convenio_orig_p
and	cd_estabelecimento	= cd_estabelecimento_p;

c015 CURSOR FOR
SELECT	nr_sequencia
from	tiss_regra_guia
where	cd_convenio	 	= cd_convenio_orig_p
and	cd_estabelecimento	= cd_estabelecimento_p;

c016 CURSOR FOR
SELECT	nr_sequencia
from	tiss_regra_honor_spsadt
where	cd_convenio	 	= cd_convenio_orig_p
and	cd_estabelecimento	= cd_estabelecimento_p;

c017 CURSOR FOR
SELECT	nr_sequencia
from	tiss_regra_valor_proc
where	cd_convenio	 	= cd_convenio_orig_p
and	cd_estabelecimento	= cd_estabelecimento_p;

c018 CURSOR FOR
SELECT	nr_sequencia
from	tiss_regra_guia_princ
where	cd_convenio	 	= cd_convenio_orig_p
and	cd_estabelecimento	= cd_estabelecimento_p;

c019 CURSOR FOR
SELECT	nr_sequencia
from	tiss_regra_prestador_solic
where	cd_convenio	 	= cd_convenio_orig_p
and	cd_estabelecimento	= cd_estabelecimento_p;

c020 CURSOR FOR
SELECT	nr_sequencia
from	tiss_regra_cod_prestador
where	cd_convenio	 	= cd_convenio_orig_p
and	cd_estabelecimento	= cd_estabelecimento_p;

c021 CURSOR FOR
SELECT	nr_sequencia
from	tiss_motivo_glosa
where	cd_convenio	 	= cd_convenio_orig_p;

c022 CURSOR FOR
SELECT	nr_sequencia
from	tiss_regra_exec_compl
where	cd_convenio	 	= cd_convenio_orig_p
and	cd_estabelecimento	= cd_estabelecimento_p;

c023 CURSOR FOR
SELECT	nr_sequencia
from	tiss_motivo_glosa_conv
where	cd_convenio	 	= cd_convenio_orig_p;

c024 CURSOR FOR
SELECT	nr_sequencia
from	tiss_regra_mat_opm
where	cd_convenio	 = cd_convenio_orig_p;

c025 CURSOR FOR
SELECT	nr_sequencia
from	regra_exec_lib_prescr_mat
where	cd_convenio	 = cd_convenio_orig_p;

c026 CURSOR FOR
SELECT	nr_sequencia
from	conv_regra_fatur_proc
where	cd_convenio	 = cd_convenio_orig_p;

c027 CURSOR FOR
SELECT	nr_sequencia
from	conv_regra_fatur_mat
where	cd_convenio	 = cd_convenio_orig_p;

C028 CURSOR FOR
SELECT	nr_sequencia
from	conv_regra_cancel_conta
where	cd_convenio	 = cd_convenio_orig_p;

C029 CURSOR FOR
SELECT	nr_sequencia
from	conveio_estab_func_lib
where	cd_convenio	 = cd_convenio_orig_p;

C030 CURSOR FOR
SELECT	nr_sequencia
from	conv_regra_taxa_tempo
where	cd_convenio	 = cd_convenio_orig_p;

C031 CURSOR FOR
SELECT	nr_sequencia
from	conv_regra_lib_atend
where	cd_convenio	 = cd_convenio_orig_p;


C032 CURSOR FOR
	SELECT	*
	from	regra_tx_pacote
	where	cd_convenio		= cd_convenio_orig_p;

C033 CURSOR FOR
	SELECT	*
	from	conv_regra_tx_tempo_setor
	where	cd_convenio		= cd_convenio_orig_p;

C034 CURSOR FOR
	SELECT	nr_sequencia
	from	conv_regra_seq_conta
	where	cd_convenio = cd_convenio_orig_p;

C035 CURSOR FOR
	SELECT	nr_sequencia
	from	conv_regra_pacote
	where	cd_convenio = cd_convenio_orig_p;

C036 CURSOR FOR
	SELECT	nr_sequencia
	from	convenio_regra_taxa_cir
	where	cd_convenio = cd_convenio_orig_p;

C037 CURSOR FOR
	SELECT	nr_sequencia
	from	conv_ajuste_porte_cbhpm
	where	cd_convenio		= cd_convenio_orig_p;

C038 CURSOR FOR
	SELECT	nr_sequencia
	from	conv_regra_atend_setor
	where	cd_convenio = cd_convenio_orig_p;

C039 CURSOR FOR
	SELECT	nr_sequencia
	from	tiss_regra_tipo_proc
	where	cd_convenio = cd_convenio_orig_p;

C040 CURSOR FOR
	SELECT	nr_sequencia
	from	REGRA_PROT_TIPO_ATEND
	where	cd_convenio = cd_convenio_orig_p;

C041 CURSOR FOR
	SELECT	nr_sequencia
	from	tiss_regra_campo_esp
	where	cd_convenio = cd_convenio_orig_p;

C042 CURSOR FOR
	SELECT	nr_sequencia
	from	tiss_campo_esp_compl
	where	nr_seq_regra = nr_seq_tiss_regra_campo_esp_w;

c043 CURSOR FOR
	SELECT	nr_sequencia
	from	tiss_campo_esp_conv
	where	nr_seq_regra = nr_seq_tiss_regra_campo_esp_w;


C044 CURSOR FOR
	SELECT	nr_sequencia
	from	tiss_regra_partic_adic
	where	cd_convenio = cd_convenio_orig_p;

C045 CURSOR FOR
	SELECT	nr_sequencia
	from	tiss_regra_arquivo_adic
	where	cd_convenio = cd_convenio_orig_p;

C046 CURSOR FOR
	SELECT	cd_grupo_material,
			cd_subgrupo_material,
			cd_classe_material,
			cd_material,
			ie_opme,
			nr_sequencia
	from	conv_regra_mat_opme
	where	cd_convenio	= cd_convenio_orig_p;
	
c047 CURSOR FOR
SELECT	nr_sequencia
	from	agenda_regra
	where	cd_convenio	 	= cd_convenio_orig_p
	and	cd_estabelecimento	= cd_estabelecimento_p;
	
c048 CURSOR FOR
	SELECT	*
	from	convenio_doc_atend
	where	cd_convenio		= cd_convenio_orig_p
	and 	cd_estabelecimento	= cd_estabelecimento_p;

c001_w	c001%rowtype;
c002_w	c002%rowtype;
c004_w	c004%rowtype;
c032_w	c032%rowtype;
c033_w	c033%rowtype;
c046_w	c046%rowtype;
c048_w	c048%rowtype;


BEGIN



open c000;
loop
fetch c000 into
	cd_convenio_dest_w;
EXIT WHEN NOT FOUND; /* apply on c000 */
	begin

	if (cd_convenio_dest_w > 0) and
		((ie_tipo_acao_p = '1') or (ie_tipo_acao_p = '2' AND cd_convenio_dest_w <> cd_convenio_orig_p)) then

		if (nm_tabela_p = 'COMPONENTE_KIT') then
			if (ie_excluir_p = 'S') then
				delete from componente_kit
				where cd_convenio = cd_convenio_dest_w;
			end if;

			open c005;
				loop
					fetch c005 into
						cd_kit_material_w, cd_material_w, ie_via_aplicacao_w, ie_tipo_paciente_w,
						qt_material_w, ie_situacao_w, qt_volume_min_w, qt_volume_max_w,
						ie_baixa_estoque_w , cd_medico_w, ie_dispensavel_w,
						ie_video_w, cd_fornecedor_w, qt_idade_minima_w,
						qt_idade_maxima_w, ie_calcula_preco_w, ie_entra_conta_w, ie_duplica_prescr_w, ie_multiplica_dose_w, ie_tipo_convenio_w;
					EXIT WHEN NOT FOUND; /* apply on c005 */
					begin
					select	max(nr_sequencia) +1
					into STRICT	nr_seq_kit_w
					from	componente_kit
					where	cd_kit_material	= cd_kit_material_w;

					insert into componente_kit(	cd_kit_material, nr_sequencia,
								cd_material, ie_via_aplicacao,
								ie_tipo_paciente, qt_material,
								ie_situacao, dt_atualizacao,
								nm_usuario, qt_volume_min,
								qt_volume_max,
								ie_baixa_estoque, cd_medico,
								cd_convenio, ie_dispensavel,
								ie_video, cd_fornecedor, qt_idade_minima,
								qt_idade_maxima, ie_calcula_preco,
								ie_entra_conta, ie_duplica_prescr, ie_multiplica_dose,
								ie_tipo_convenio)
					values (	cd_kit_material_w, nr_seq_kit_w,
						cd_material_w, ie_via_aplicacao_w,
						ie_tipo_paciente_w, qt_material_w,
						ie_situacao_w, clock_timestamp(),
						nm_usuario_p, qt_volume_min_w,
						qt_volume_max_w, ie_baixa_estoque_w,
						cd_medico_w, cd_convenio_dest_w,
						ie_dispensavel_w, coalesce(ie_video_w,'A'), cd_fornecedor_w,
						qt_idade_minima_w, qt_idade_maxima_w, ie_calcula_preco_w,
						coalesce(ie_entra_conta_w,'S'), ie_duplica_prescr_w, ie_multiplica_dose_w,
						ie_tipo_convenio_w);
					end;
				end loop;
			close c005;
		/* edilson em 20/07/04 coloquei o cursor acima. dava erro de pk com a rotina abaixo (cd_kit_material, nr_sequencia)
			insert into componente_kit (	cd_kit_material, nr_sequencia,
								cd_material, ie_via_aplicacao,
								ie_tipo_paciente, qt_material,
								ie_situacao, dt_atualizacao,
								nm_usuario, qt_volume_min,
								qt_volume_max,
								ie_baixa_estoque, cd_medico,
								cd_convenio, ie_dispensavel)
			select cd_kit_material, nr_sequencia,
				 cd_material, ie_via_aplicacao,
				 ie_tipo_paciente, qt_material,
				 ie_situacao, sysdate,
				 nm_usuario_p, qt_volume_min,
				 qt_volume_max,
				 ie_baixa_estoque, cd_medico,
				 cd_convenio_dest_p, ie_dispensavel
			from componente_kit
			where cd_convenio = cd_convenio_orig_p;*/
		elsif (nm_tabela_p = 'CONV_REGRA_MAT_OPME') then
			if (ie_excluir_p = 'S') then
				delete from	conv_regra_mat_opme
				where cd_convenio = cd_convenio_dest_w;
			end if;
			open c046;
			loop
			fetch c046 into c046_w;
			EXIT WHEN NOT FOUND; /* apply on c046  */

			select	 nextval('conv_regra_mat_opme_seq')
			into STRICT	c046_w.nr_sequencia
			;

			insert into  conv_regra_mat_opme(
				nr_sequencia,
				cd_grupo_material,
				cd_subgrupo_material,
				cd_classe_material,
				cd_material,
				ie_opme,
				cd_convenio,
				dt_atualizacao,
				nm_usuario)
				values (
				c046_w.nr_sequencia,
				c046_w.cd_grupo_material,
				c046_w.cd_subgrupo_material,
				c046_w.cd_classe_material,
				c046_w.cd_material,
				c046_w.ie_opme,
				cd_convenio_dest_w,
				clock_timestamp(),
				nm_usuario_p);
			end loop;
			close C046;

		elsif (nm_tabela_p = 'CONSISTE_SETOR_PROC') then
			if (ie_excluir_p = 'S') then
				delete from consiste_setor_proc
				where cd_convenio = cd_convenio_dest_w;
			end if;
			open c001;
			loop
				fetch c001 into c001_w;
				EXIT WHEN NOT FOUND; /* apply on c001 */

				select nextval('consiste_setor_proc_seq')
				into STRICT nr_seq_w
				;

				insert into consiste_setor_proc(
					nr_sequencia, cd_estabelecimento,
					dt_atualizacao, nm_usuario,
					cd_area_proced, cd_especial_proced,
					cd_grupo_proced, cd_procedimento,
					ie_origem_proced, cd_convenio,
					cd_setor_atendimento, ie_medico_executor,
					cd_cgc, ie_tipo_atendimento, cd_medico_exec_filtro,
					cd_tipo_procedimento)
				values (nr_seq_w, c001_w.cd_estabelecimento,
					clock_timestamp(), nm_usuario_p,
					c001_w.cd_area_proced,
					c001_w.cd_especial_proced,
					c001_w.cd_grupo_proced,
					c001_w.cd_procedimento,
					c001_w.ie_origem_proced, cd_convenio_dest_w,
					c001_w.cd_setor_atendimento,
					c001_w.ie_medico_executor,
					c001_w.cd_cgc,
					c001_w.ie_tipo_atendimento,
					c001_w.cd_medico_exec_filtro,
					c001_w.cd_tipo_procedimento);
			end loop;
			close c001;
		elsif (nm_tabela_p = 'CONVENIO_DOCUMENTO') then
			if (ie_excluir_p = 'S') then
				delete 	from 	convenio_documento
				where 	cd_convenio = cd_convenio_dest_w
				and	cd_estabelecimento = cd_estabelecimento_p;
			end if;
			begin
			open c010;
				loop
				fetch c010 into
					ie_documento_w,
					dt_vigencia_w,
					ds_arquivo_w,
					nr_seq_w,
					dt_final_vigencia_w;
				EXIT WHEN NOT FOUND; /* apply on c010 */
						begin
						select 	nextval('convenio_documento_seq')
						into STRICT	nr_sequencia_w
						;

						insert into convenio_documento(
							nr_sequencia, cd_convenio, ie_documento, dt_atualizacao, nm_usuario,
							ds_documento, cd_estabelecimento, dt_atualizacao_nrec, nm_usuario_nrec,
							dt_vigencia,ds_arquivo, dt_final_vigencia)
						values (nr_sequencia_w, cd_convenio_dest_w, ie_documento_w, clock_timestamp(),
							nm_usuario_p, '  ', cd_estabelecimento_p, clock_timestamp(), nm_usuario_p,
							dt_vigencia_w, ds_arquivo_w, dt_final_vigencia_w);
						end;
						/* fabricio em 12/02/2008 os 81992 */

						CALL copia_campo_long('CONVENIO_DOCUMENTO','DS_DOCUMENTO','WHERE NR_SEQUENCIA = :NR_SEQUENCIA',
								 'NR_SEQUENCIA='||nr_seq_w,'NR_SEQUENCIA='||nr_sequencia_w);
				end loop;
			close c010;
			end;
		elsif (nm_tabela_p = 'CONVENIO_DOC_ATEND') then
			if (ie_excluir_p = 'S') then
				delete 	from 	convenio_doc_atend
				where 	cd_convenio = cd_convenio_dest_w
				and	cd_estabelecimento = cd_estabelecimento_p;
			end if;
			
			open c048;
				loop
				fetch c048 into
					c048_w;
				EXIT WHEN NOT FOUND; /* apply on c048 */
					begin
						
					select 	nextval('convenio_doc_atend_seq')
					into STRICT	nr_sequencia_w
					;

					insert into convenio_doc_atend(
						nr_sequencia, cd_convenio, ie_documento, dt_atualizacao, nm_usuario,
						ds_documento, cd_estabelecimento, dt_atualizacao_nrec, nm_usuario_nrec,
						cd_plano, ds_titulo)
					values (nr_sequencia_w, cd_convenio_dest_w, c048_w.ie_documento, clock_timestamp(),
						nm_usuario_p, ' ', cd_estabelecimento_p, clock_timestamp(), nm_usuario_p,
						c048_w.cd_plano, c048_w.ds_titulo);
						
					CALL copia_campo_long('CONVENIO_DOC_ATEND','DS_DOCUMENTO','WHERE NR_SEQUENCIA = :NR_SEQUENCIA',
								 'NR_SEQUENCIA=' || c048_w.nr_sequencia,'NR_SEQUENCIA=' || nr_sequencia_w);
								
					end;
				end loop;
			close c048;

		elsif (nm_tabela_p = 'CATEGORIA_CONVENIO') then
			if (ie_excluir_p = 'S') then
				delete	from	cotacao_moeda_convenio
				where	cd_convenio = cd_convenio_dest_w;
			
				delete	from regra_horario_plano
				where 	cd_convenio = cd_convenio_dest_w;

				delete 	from 	cat_conv_tipo_acomodacao
				where 	cd_convenio = cd_convenio_dest_w
				and	cd_estabelecimento = cd_estabelecimento_p;

				delete	from	categoria_convenio_estab
				where	cd_convenio = cd_convenio_dest_w;

				delete 	from convenio_brasindice
				where 	cd_convenio = cd_convenio_dest_w;

				delete 	from convenio_servico
				where 	cd_convenio = cd_convenio_dest_w;

				delete	from convenio_taxa_cirurgia
				where 	cd_convenio = cd_convenio_dest_w;

				delete	from convenio_taxa_servico
				where	cd_convenio = cd_convenio_dest_w;

				delete	from convenio_taxa_exame
				where 	cd_convenio = cd_convenio_dest_w;

				delete 	from convenio_simpro
				where 	cd_convenio = cd_convenio_dest_w;

				delete 	from convenio_preco_mat
				where 	cd_convenio = cd_convenio_dest_w;

				delete from categoria_convenio
				where cd_convenio = cd_convenio_dest_w;

				delete from convenio_plano
				where cd_convenio = cd_convenio_dest_w;

			end if;

			insert into convenio_plano(
				cd_convenio, cd_plano,
				ds_plano, dt_atualizacao, nm_usuario, ie_situacao)
			SELECT cd_convenio_dest_w, cd_plano,
				 ds_plano, clock_timestamp(), nm_usuario_p, 'A'
			from convenio_plano
			where cd_convenio = cd_convenio_orig_p;

			begin
			open c007;
				loop
				fetch c007 into
						cd_plano_w;
				EXIT WHEN NOT FOUND; /* apply on c007 */
						begin
						insert into regra_horario_plano(
							nr_sequencia, cd_convenio, cd_plano, dt_atualizacao, nm_usuario,
							ie_tipo_atendimento,hr_inicio, hr_fim, ie_atende, cd_setor_atendimento,
							ie_dia_semana, dt_atualizacao_nrec, nm_usuario_nrec, ie_feriado,
							cd_empresa, cd_estabelecimento)
						SELECT 	nextval('regra_horario_plano_seq'), cd_convenio_dest_w, cd_plano_w, clock_timestamp(),
							nm_usuario_p, ie_tipo_atendimento,hr_inicio, hr_fim, ie_atende,
							cd_setor_atendimento, ie_dia_semana, clock_timestamp(), nm_usuario_p, ie_feriado,
							cd_empresa,cd_estabelecimento
						from 	regra_horario_plano
						where 	cd_convenio = cd_convenio_orig_p
						and 	cd_plano = cd_plano_w;
						end;
				end loop;
			close c007;
			end;

			insert into categoria_convenio(
				cd_convenio, cd_categoria, ds_categoria, ie_ident_atend,
				ie_empresa,  ie_situacao, cd_tipo_acomodacao, dt_atualizacao,
				nm_usuario, nr_acompanhante, cd_plano_padrao, qt_dieta_acomp,
				ie_lib_dieta, ie_idade_dieta, qt_idade_menores, qt_idade_maiores,
				ie_permite_gerar_pacote, ie_preco_custo)
			SELECT 	cd_convenio_dest_w, cd_categoria, ds_categoria, ie_ident_atend,
				ie_empresa,  ie_situacao, cd_tipo_acomodacao, dt_atualizacao,
				nm_usuario, nr_acompanhante, cd_plano_padrao, qt_dieta_acomp,
				ie_lib_dieta, ie_idade_dieta, qt_idade_menores, qt_idade_maiores,
				ie_permite_gerar_pacote, ie_preco_custo
			from	categoria_convenio
			where 	cd_convenio = cd_convenio_orig_p;

			begin
			open c006;
				loop
				fetch c006 into
					cd_categoria_w,
					cd_tipo_acomodacao_w;
				EXIT WHEN NOT FOUND; /* apply on c006 */
					begin
					insert into cat_conv_tipo_acomodacao(
						nr_sequencia, cd_estabelecimento, cd_convenio, cd_categoria, dt_atualizacao,
						nm_usuario, cd_tipo_acomodacao, dt_atualizacao_nrec, nm_usuario_nrec)
					SELECT 	nextval('cat_conv_tipo_acomodacao_seq'), cd_estabelecimento_p, cd_convenio_dest_w,
						cd_categoria_w, clock_timestamp(),  nm_usuario_p,  cd_tipo_acomodacao, clock_timestamp(), nm_usuario_p
					from 	cat_conv_tipo_acomodacao
					where 	cd_convenio = cd_convenio_orig_p
					and	cd_categoria = cd_categoria_w
					and	cd_estabelecimento = cd_estabelecimento_p;

					insert	into categoria_convenio_estab(
						nr_sequencia, cd_convenio, cd_categoria, cd_estabelecimento, dt_atualizacao,
						nm_usuario, dt_atualizacao_nrec, nm_usuario_nrec)
					SELECT	nextval('categoria_convenio_estab_seq'), cd_convenio_dest_w, cd_categoria_w,
						cd_estabelecimento_p, clock_timestamp(), nm_usuario_p, clock_timestamp(), nm_usuario_p
					from	categoria_convenio_estab
					where 	cd_convenio = cd_convenio_orig_p
					and	cd_categoria = cd_categoria_w;
					end;
				end loop;
			close c006;
			end;
		elsif (nm_tabela_p = 'CONTA_ESTRUT_MAT') then
			if (ie_excluir_p = 'S') then
				delete from conta_estrut_mat
				where cd_convenio = cd_convenio_dest_w;
			end if;
			select max(nr_sequencia)
			into STRICT nr_seq_w
			from conta_estrut_mat;
			insert into conta_estrut_mat(nr_sequencia, cd_estrutura, dt_atualizacao,
								nm_usuario,	cd_grupo_material, cd_subgrupo_material,
								cd_classe_material, cd_material, cd_convenio,
								cd_setor_atendimento, ie_tipo_atendimento, cd_estabelecimento,
								ie_responsavel_credito, ie_tipo_material)
			SELECT nr_seq_w + row_number() OVER () AS rownum, cd_estrutura, clock_timestamp(),
				 nm_usuario_p, cd_grupo_material, cd_subgrupo_material,
				 cd_classe_material, cd_material, cd_convenio_dest_w,
				 cd_setor_atendimento, ie_tipo_atendimento, cd_estabelecimento,
				 ie_responsavel_credito, ie_tipo_material
			from conta_estrut_mat
			where cd_convenio = cd_convenio_orig_p;
		elsif (nm_tabela_p = 'CONVENIO_OPERADORA') then
			if (ie_excluir_p = 'S') then
				delete from convenio_operadora
				where cd_convenio = cd_convenio_dest_w;
			end if;
			insert into convenio_operadora(
				nr_sequencia, cd_convenio, dt_vigencia, dt_atualizacao, nm_usuario, dt_atualizacao_nrec,
				nm_usuario_nrec, nr_vidas_estado, nr_vidas_operadora)
			SELECT 	nextval('convenio_operadora_seq'), cd_convenio_dest_w, dt_vigencia, clock_timestamp(),
				nm_usuario_p, clock_timestamp(), nm_usuario_p, nr_vidas_estado, nr_vidas_operadora
			from	convenio_operadora
			where	cd_convenio = cd_convenio_orig_p;
		elsif (nm_tabela_p = 'CONTA_ESTRUT_PROC') then
			if (ie_excluir_p = 'S') then
				delete from conta_estrut_proc
				where cd_convenio = cd_convenio_dest_w;
			end if;

			select max(nr_sequencia)
			into STRICT nr_seq_w
			from conta_estrut_proc;

			insert into conta_estrut_proc(nr_sequencia, cd_estrutura, dt_atualizacao,
							nm_usuario, cd_area_proced, cd_especial_proced,
							cd_grupo_proced, cd_procedimento, ie_origem_proced,
							cd_convenio, ie_credenciado, ie_honorario,
							cd_setor_atendimento, ie_tipo_atendimento, cd_especialidade,
							cd_medico, cd_edicao_amb, cd_estabelecimento, nr_seq_grupo_lab,
							cd_tipo_procedimento)
			SELECT nr_seq_w + row_number() OVER () AS rownum, cd_estrutura, clock_timestamp(),
				 nm_usuario_p, cd_area_proced, cd_especial_proced,
				 cd_grupo_proced, cd_procedimento, ie_origem_proced,
				 cd_convenio_dest_w, ie_credenciado, ie_honorario,
				 cd_setor_atendimento, ie_tipo_atendimento, cd_especialidade,
				 cd_medico, cd_edicao_amb, cd_estabelecimento, nr_seq_grupo_lab,
				 cd_tipo_procedimento
			from conta_estrut_proc
			where cd_convenio = cd_convenio_orig_p;
		elsif (nm_tabela_p = 'CONTA_FINANC_REGRA') then
			if (ie_excluir_p = 'S') then
				delete from conta_financ_regra
				where cd_convenio = cd_convenio_dest_w;
			end if;
			insert into conta_financ_regra(
				nr_sequencia, cd_estabelecimento,
				nr_seq_conta_financ, ie_entrada_saida,
				dt_atualizacao, nm_usuario,
				cd_grupo_material, cd_subgrupo_material,
				cd_classe_material, nr_seq_familia, cd_area_procedimento,
				cd_especialidade, cd_grupo_proc,
				cd_convenio, cd_setor_atendimento,
				cd_tipo_pessoa, cd_cgc, ie_faturamento,
                dt_atualizacao_nrec,nm_usuario_nrec,
                cd_categoria,ie_tipo_convenio,
                ie_tipo_atendimento,ie_clinica,
                cd_centro_custo,cd_operacao_nf,
                nr_seq_proj_rec,nr_seq_produto,
                cd_local_estoque,nr_seq_trans_fin,
                ds_observacao,cd_material,
                cd_procedimento,ie_origem_tit_rec,
                nr_seq_classe_tr,ie_tipo_titulo_receber,
                ie_origem_tit_pagar,nr_seq_classe_tp,
                ie_tipo_titulo_pagar,cd_pessoa_fisica,
                ie_tipo_pessoa,ie_tipo_financiamento,
                cd_moeda,nr_seq_grupo,
                nr_seq_subgrupo,nr_seq_forma_org,
                ie_complexidade)
			SELECT	nextval('conta_financ_regra_seq'), cd_estabelecimento,
				nr_seq_conta_financ, ie_entrada_saida,
				clock_timestamp(), nm_usuario_p,
				cd_grupo_material, cd_subgrupo_material,
				cd_classe_material, nr_seq_familia, cd_area_procedimento,
				cd_especialidade, cd_grupo_proc, cd_convenio_dest_w,
				cd_setor_atendimento, cd_tipo_pessoa, cd_cgc,
				ie_faturamento,
				clock_timestamp(), nm_usuario_p,
                cd_categoria,ie_tipo_convenio,
                ie_tipo_atendimento,ie_clinica,
                cd_centro_custo,cd_operacao_nf,
                nr_seq_proj_rec,nr_seq_produto,
                cd_local_estoque,nr_seq_trans_fin,
                ds_observacao,cd_material,
                cd_procedimento,ie_origem_tit_rec,
                nr_seq_classe_tr,ie_tipo_titulo_receber,
                ie_origem_tit_pagar,nr_seq_classe_tp,
                ie_tipo_titulo_pagar,cd_pessoa_fisica,
                ie_tipo_pessoa,ie_tipo_financiamento,
                cd_moeda,nr_seq_grupo,
                nr_seq_subgrupo,nr_seq_forma_org,
                ie_complexidade
			from	conta_financ_regra
			where	cd_convenio = cd_convenio_orig_p;
		elsif (nm_tabela_p = 'EVENTO_CONVENIO') then
			if (ie_excluir_p = 'S') then
				delete	from 	evento_convenio_ret
				where  nr_seq_evento_conv in ( SELECT nr_sequencia
							      from   evento_convenio
							      where  cd_convenio = cd_convenio_dest_w
							       and   cd_estabelecimento = cd_estabelecimento_p);
				delete	from 	evento_conv_xml_atrib
				where 	nr_seq_evento_conv in ( SELECT nr_sequencia
							      from    evento_convenio_xml
							      where 	nr_seq_evento_conv in ( select nr_sequencia
											      from   evento_convenio
											      where  cd_convenio = cd_convenio_dest_w
											       and   cd_estabelecimento = cd_estabelecimento_p));
				delete	from 	evento_convenio_xml
				where 	nr_seq_evento_conv in ( SELECT nr_sequencia
							      from   evento_convenio
							      where  cd_convenio = cd_convenio_dest_w
							       and   cd_estabelecimento = cd_estabelecimento_p);
				delete 	from 	evento_convenio
				where 	cd_convenio = cd_convenio_dest_w
				and	cd_estabelecimento = cd_estabelecimento_p;
			end if;

			begin
			open c008;
				loop
				fetch c008 into
						nr_seq_w;
				EXIT WHEN NOT FOUND; /* apply on c008 */

					select  nextval('evento_convenio_seq')
					into STRICT	nr_sequencia_w
					;

					insert into evento_convenio(
						nr_sequencia, cd_convenio, dt_atualizacao, nm_usuario, nr_seq_evento, ds_evento,
						ds_dll, ds_funcao, nr_seq_interface, cd_estabelecimento, nr_seq_apres,
						dt_atualizacao_nrec, nm_usuario_nrec)
					SELECT 	nr_sequencia_w, cd_convenio_dest_w, clock_timestamp(), nm_usuario_p, nr_seq_evento,
						ds_evento, ds_dll, ds_funcao, nr_seq_interface, cd_estabelecimento_p,
						nr_seq_apres, clock_timestamp(), nm_usuario_p
					from 	evento_convenio
					where 	cd_convenio = cd_convenio_orig_p
					and	cd_estabelecimento = cd_estabelecimento_p
					and 	nr_sequencia = nr_seq_w;

					insert into evento_convenio_ret(
						nr_sequencia, nr_seq_evento_conv, dt_atualizacao, nm_usuario, cd_retorno,
						ds_retorno, ie_sucesso, dt_atualizacao_nrec, nm_usuario_nrec)
					SELECT 	nextval('evento_convenio_ret_seq'), nr_sequencia_w, clock_timestamp(), nm_usuario_p,
						cd_retorno, ds_retorno, ie_sucesso, clock_timestamp(), nm_usuario_p
					from 	evento_convenio_ret
					where 	nr_seq_evento_conv = nr_seq_w;

					begin
					open c009;
						loop
						fetch c009 into
							nr_seq_ww,
							ds_xml_w;
						EXIT WHEN NOT FOUND; /* apply on c009 */
						begin
						select 	nextval('evento_convenio_xml_seq')
						into STRICT	nr_sequencia_ww
						;

						insert	into evento_convenio_xml(
							nr_sequencia, nr_seq_evento_conv, dt_atualizacao, nm_usuario, ds_xml,
							dt_atualizacao_nrec, nm_usuario_nrec)
						SELECT	nr_sequencia_ww, nr_sequencia_w, clock_timestamp(), nm_usuario_p, ds_xml_w,
							clock_timestamp(), nm_usuario_p
						from	evento_convenio_xml
						where 	nr_seq_evento_conv = nr_seq_w;

						insert into  evento_conv_xml_atrib(
							nr_sequencia, nr_seq_evento_conv, dt_atualizacao, nm_usuario, ds_estrutura,
							nm_atributo_conv, nm_atributo, nm_tabela, dt_atualizacao_nrec,nm_usuario_nrec)
						SELECT 	nextval('evento_conv_xml_atrib_seq'), nr_sequencia_ww, clock_timestamp(), nm_usuario_p,
							ds_estrutura, nm_atributo_conv, nm_atributo, nm_tabela, clock_timestamp(), nm_usuario_p
						from 	evento_conv_xml_atrib
						where 	nr_seq_evento_conv = nr_seq_ww;
						end;
					end loop;
					close c009;
					end;
				end loop;
			close c008;
			end;
		elsif (nm_tabela_p = 'CONVENIO_ORIGEM_USUARIO') then
			if (ie_excluir_p = 'S') then
				delete from convenio_origem_usuario
				where cd_convenio = cd_convenio_dest_w;
			end if;
			insert into convenio_origem_usuario(
				nr_sequencia, cd_convenio,
				ds_origem, dt_atualizacao, nm_usuario, cd_origem, ie_situacao)
			SELECT nextval('convenio_origem_usuario_seq'), cd_convenio_dest_w,
				 ds_origem, clock_timestamp(), nm_usuario_p, cd_origem, ie_situacao
			from convenio_origem_usuario
			where cd_convenio = cd_convenio_orig_p;
		elsif (nm_tabela_p = 'CONVENIO_REGRA_VENC') then
			if (ie_excluir_p = 'S') then
				delete	from convenio_regra_venc
				where 	cd_convenio = cd_convenio_dest_w
				and (cd_estabelecimento = cd_estabelecimento_p or coalesce(cd_estabelecimento::text, '') = ''); -- afstringari 173097 19/10/2009
			end if;
			insert into convenio_regra_venc(
				nr_sequencia, dt_atualizacao, nm_usuario,
				cd_convenio, cd_condicao_pagamento, ie_tipo_protocolo)
			SELECT	nextval('convenio_regra_venc_seq'), clock_timestamp(), nm_usuario_p,
				cd_convenio_dest_w, cd_condicao_pagamento, ie_tipo_protocolo
			from	convenio_regra_venc
			where 	cd_convenio = cd_convenio_orig_p
			and (cd_estabelecimento = cd_estabelecimento_p or coalesce(cd_estabelecimento::text, '') = ''); -- afstringari 173097 19/10/2009
		elsif (nm_tabela_p = 'EXAME_LAB_CONVENIO') then
			if (ie_excluir_p = 'S') then
				delete from exame_lab_convenio
				where cd_convenio = cd_convenio_dest_w;
			end if;
			open c002;
			loop
				fetch c002 into c002_w;
				EXIT WHEN NOT FOUND; /* apply on c002 */

				insert into exame_lab_convenio(
					nr_seq_exame, nr_sequencia, cd_convenio,
					cd_procedimento, ie_origem_proced, dt_atualizacao,
					nm_usuario, ie_autorizacao)
				SELECT nr_seq_exame, c002_w.nr_sequencia + row_number() OVER () AS rownum, cd_convenio_dest_w,
					cd_procedimento, ie_origem_proced, clock_timestamp(),
					nm_usuario_p, ie_autorizacao
				from exame_lab_convenio
				where cd_convenio = cd_convenio_orig_p
				  and nr_seq_exame = c002_w.nr_seq_exame;
			end loop;
			close c002;
		elsif (nm_tabela_p = 'FUNCAO_MEDICO_CONVENIO') then
			if (ie_excluir_p = 'S') then
				delete from funcao_medico_convenio
				where cd_convenio = cd_convenio_dest_w;
			end if;
			insert into funcao_medico_convenio(
				nr_sequencia, cd_funcao_medico,
				nm_usuario, dt_atualizacao, cd_convenio,
				tx_valor_medico, tx_valor_anestesista, ie_credenciado)
			SELECT nextval('funcao_medico_convenio_seq'), cd_funcao_medico,
				nm_usuario_p, clock_timestamp(), cd_convenio_dest_w,
				tx_valor_medico, tx_valor_anestesista, ie_credenciado
			from funcao_medico_convenio
			where cd_convenio = cd_convenio_orig_p;
		elsif (nm_tabela_p = 'PARAMETROS_CONTA_CONTABIL') then
			if (ie_excluir_p = 'S') then
				delete from parametros_conta_contabil
				where cd_convenio = cd_convenio_dest_w;
			end if;
			insert into parametros_conta_contabil(
				cd_sequencia_parametro, cd_estabelecimento,
				cd_empresa,
				cd_conta_receita, cd_conta_estoque,
				cd_conta_passag_direta, cd_grupo_material,
				cd_subgrupo_material, cd_classe_material,
				cd_material, cd_area_proced,
				cd_especial_proced, cd_grupo_proced,
				cd_procedimento, nm_usuario,
				dt_atualizacao, ie_origem_proced,
				cd_conta_despesa, cd_setor_atendimento,
				ie_tipo_atendimento, ie_classif_convenio,
				cd_convenio, cd_local_estoque, nr_seq_forma_org,
				nr_seq_grupo, nr_seq_subgrupo)
			SELECT nextval('parametros_conta_contabil_seq'), cd_estabelecimento,
				cd_empresa,
				cd_conta_receita, cd_conta_estoque,
				cd_conta_passag_direta, cd_grupo_material,
				cd_subgrupo_material, cd_classe_material,
				cd_material, cd_area_proced,
				cd_especial_proced, cd_grupo_proced,
				cd_procedimento, nm_usuario_p,
				clock_timestamp(), ie_origem_proced,
				cd_conta_despesa, cd_setor_atendimento,
				ie_tipo_atendimento, ie_classif_convenio,
				cd_convenio_dest_w, cd_local_estoque, nr_seq_forma_org,
				nr_seq_grupo, nr_seq_subgrupo
			from parametros_conta_contabil
			where cd_convenio = cd_convenio_orig_p;
		elsif (nm_tabela_p = 'PROC_CRITERIO_HORARIO') then
			if (ie_excluir_p = 'S') then
				delete from proc_criterio_horario
				where cd_convenio = cd_convenio_dest_w;
			end if;
			insert into proc_criterio_horario(
				nr_sequencia, cd_estabelecimento, ie_prioridade, dt_atualizacao, nm_usuario, dt_dia_semana,
				ie_feriado, hr_inicial, hr_final, cd_setor_exclusivo, ie_tipo_atendimento, cd_convenio,
				cd_edicao_amb, cd_area_proced, cd_especial_proced, cd_grupo_proced, cd_procedimento,
				ie_origem_proced, tx_procedimento, tx_medico, tx_anestesista, tx_auxiliares, tx_materiais,
				tx_custo_operacional, ie_carater_inter_sus, dt_atualizacao_nrec, nm_usuario_nrec, ie_carater_cirurgia,
				ie_video, cd_categoria, cd_procedimento_calculo, cd_tipo_acomodacao, dt_final_vigencia, dt_inicio_vigencia,
				ie_credenciado, ie_hora_final_cirurgia, ie_origem_proced_calculo, ie_tipo_feriado, vl_adicional_medico,
				vl_adicional_proc, nr_seq_proc_interno)
			SELECT nextval('proc_criterio_horario_seq'), cd_estabelecimento, ie_prioridade, clock_timestamp(), nm_usuario_p, dt_dia_semana,
				ie_feriado, hr_inicial, hr_final, cd_setor_exclusivo, ie_tipo_atendimento, cd_convenio_dest_w,
				cd_edicao_amb, cd_area_proced, cd_especial_proced, cd_grupo_proced, cd_procedimento,
				ie_origem_proced, tx_procedimento, tx_medico, tx_anestesista, tx_auxiliares, tx_materiais,
				tx_custo_operacional, ie_carater_inter_sus, dt_atualizacao_nrec, nm_usuario_nrec, ie_carater_cirurgia,
				ie_video, cd_categoria, cd_procedimento_calculo, cd_tipo_acomodacao, dt_final_vigencia, dt_inicio_vigencia,
				ie_credenciado, ie_hora_final_cirurgia, ie_origem_proced_calculo, ie_tipo_feriado, vl_adicional_medico,
				vl_adicional_proc, nr_seq_proc_interno
			from proc_criterio_horario
			where cd_convenio = cd_convenio_orig_p;
		elsif (nm_tabela_p = 'REGRA_ALOC_CUSTO_SETOR') then
			if (ie_excluir_p = 'S') then
				delete from regra_aloc_custo_setor
				where cd_convenio = cd_convenio_dest_w;
			end if;
			insert into regra_aloc_custo_setor(
				nr_sequencia, cd_setor_atendimento,
				cd_estabelecimento, dt_atualizacao,
				nm_usuario, ie_calculo_custo,
				pr_aplicar, vl_custo,
				cd_area_procedimento, cd_especialidade,
				cd_grupo_proc, cd_procedimento,
				ie_origem_proced, cd_convenio,
				cd_proc_custo, ie_origem_proc_custo,
				cd_grupo_material, cd_subgrupo_material,
				cd_classe_material, cd_material,
				pr_custo_oper, pr_medico,
				pr_material, ds_criterio_aloc_mat, nr_seq_exame,
				dt_inicio_vigencia, dt_fim_vigencia, IE_CUSTO_HM)
			SELECT nextval('regra_aloc_custo_setor_seq'), cd_setor_atendimento,
				cd_estabelecimento, clock_timestamp(),
				nm_usuario_p, ie_calculo_custo,
				pr_aplicar, vl_custo,
				cd_area_procedimento, cd_especialidade,
				cd_grupo_proc, cd_procedimento,
				ie_origem_proced, cd_convenio_dest_w,
				cd_proc_custo, ie_origem_proc_custo,
				cd_grupo_material, cd_subgrupo_material,
				cd_classe_material, cd_material,
				pr_custo_oper, pr_medico,
				pr_material, ds_criterio_aloc_mat, nr_seq_exame,
				dt_inicio_vigencia, dt_fim_vigencia, coalesce(IE_CUSTO_HM,'S')
			from regra_aloc_custo_setor
			where cd_convenio = cd_convenio_orig_p;
		elsif (nm_tabela_p = 'REGRA_HONORARIO_CRITERIO') then
			if (ie_excluir_p = 'S') then
				delete from regra_honorario_criterio
				where cd_convenio = cd_convenio_dest_w;
			end if;
			insert into regra_honorario_criterio(
				nr_sequencia, cd_estabelecimento,
				cd_regra, dt_atualizacao,
				nm_usuario, cd_convenio,
				cd_edicao_amb, cd_area_procedimento,
				cd_especialidade, cd_grupo_proc,
				cd_procedimento, ie_origem_proced,
				ie_tipo_atendimento, cd_setor_atendimento,
				ie_credenciado, cd_especialidade_medica,
				cd_medico, cd_cgc, ie_corpo_clinico, ie_funcionario,
				cd_categoria, ie_tipo_convenio, ie_pacote,
				ie_tipo_servico_sus, ie_tipo_ato_sus, dt_atualizacao_nrec,
				nm_usuario_nrec, ie_vinculo_medico, ie_situacao,
				ie_clinica, cd_tipo_procedimento, cd_cbo, nr_seq_proc_interno, nr_seq_exame)
			SELECT nextval('regra_honorario_criterio_seq'), cd_estabelecimento,
				cd_regra, clock_timestamp(),
				nm_usuario_p, cd_convenio_dest_w,
				cd_edicao_amb, cd_area_procedimento,
				cd_especialidade, cd_grupo_proc,
				cd_procedimento, ie_origem_proced,
				ie_tipo_atendimento, cd_setor_atendimento,
				ie_credenciado, cd_especialidade_medica,
				cd_medico, cd_cgc, ie_corpo_clinico, coalesce(ie_funcionario,'N'),
				cd_categoria, ie_tipo_convenio, ie_pacote,
				ie_tipo_servico_sus, ie_tipo_ato_sus, clock_timestamp(),
				nm_usuario_p, ie_vinculo_medico, coalesce(ie_situacao,'A'),
				ie_clinica, cd_tipo_procedimento, cd_cbo, nr_seq_proc_interno, nr_seq_exame
			from regra_honorario_criterio
			where cd_convenio = cd_convenio_orig_p;
		elsif (nm_tabela_p = 'REGRA_LANC_AUTOMATICO') then
			if (ie_excluir_p = 'S') then
				delete from regra_lanc_automatico
				where cd_convenio = cd_convenio_dest_w;
				delete from regra_lanc_aut_pac
				where nr_seq_regra in ( SELECT nr_sequencia
							from regra_lanc_automatico
							where cd_convenio = cd_convenio_dest_w);

			end if;
			open c003;
			loop
				fetch c003 into nr_seq_w;
				EXIT WHEN NOT FOUND; /* apply on c003 */

				select nextval('regra_lanc_automatico_seq')
				into STRICT nr_sequencia_w
				;

				insert into regra_lanc_automatico(
					nr_sequencia, cd_estabelecimento, ds_regra, dt_atualizacao,
					nm_usuario, cd_convenio, ie_tipo_atendimento, cd_setor_atendimento,
					cd_medico, nr_seq_evento, cd_area_procedimento, cd_especialidade_proc,
					cd_grupo_proc, cd_procedimento, ie_origem_proced, cd_edicao_amb,
					nr_seq_exame, ie_tipo_convenio, ie_situacao, cd_categoria,
					nr_seq_proc_interno, cd_motivo_alta, ie_clinica, cd_tipo_acomodacao,
					qt_ano_min, qt_ano_max, dt_atualizacao_nrec, nm_usuario_nrec,
					ie_via_aplicacao, cd_material, cd_classe_material, cd_subgrupo_material,
					cd_grupo_material, cd_especialidade, nr_seq_classificacao,
					cd_tipo_anestesia, cd_funcao, cd_espec_medic_atend, cd_plano_convenio,
					ie_evolucao_clinica, ie_conv_parametro, nr_seq_forma_org, nr_seq_subgrupo,
					nr_seq_grupo, ie_vincular_proc_princ, ie_dispara_kit_mat, ie_duplicar_proc_regra)
				SELECT 	nr_sequencia_w, cd_estabelecimento, ds_regra, clock_timestamp(),
					nm_usuario_p, cd_convenio_dest_w, ie_tipo_atendimento, cd_setor_atendimento,
					cd_medico, nr_seq_evento, cd_area_procedimento, cd_especialidade_proc,
					cd_grupo_proc, cd_procedimento, ie_origem_proced, cd_edicao_amb,
					nr_seq_exame, ie_tipo_convenio, ie_situacao, cd_categoria,
					nr_seq_proc_interno, cd_motivo_alta, ie_clinica, cd_tipo_acomodacao,
					qt_ano_min, qt_ano_max, clock_timestamp(), nm_usuario_p,
					ie_via_aplicacao, cd_material, cd_classe_material, cd_subgrupo_material,
					cd_grupo_material, cd_especialidade, nr_seq_classificacao,
					cd_tipo_anestesia, cd_funcao, cd_espec_medic_atend, cd_plano_convenio,
					ie_evolucao_clinica, ie_conv_parametro, nr_seq_forma_org, nr_seq_subgrupo,
					nr_seq_grupo, ie_vincular_proc_princ, ie_dispara_kit_mat, ie_duplicar_proc_regra
				from regra_lanc_automatico
				where nr_sequencia = nr_seq_w;

				insert into regra_lanc_aut_pac(
						nr_seq_regra, nr_seq_lanc, dt_atualizacao, nm_usuario,
						cd_procedimento, ie_origem_proced, cd_material, qt_lancamento,
						ie_medico_atendimento, ie_local_estoque, ie_quantidade, ie_retorno,
						nr_seq_exame, ie_funcao_medico, tx_procedimento, qt_ano_min,
						qt_ano_max, ie_regra_guia, dt_atualizacao_nrec, nm_usuario_nrec,
						ie_forma_func_medico, nr_seq_proc_interno, ie_consiste_item,
						ie_proc_princ_atend, cd_cnpj_prestador,cd_cid_doenca, ie_adic_orcamento, cd_medico)
				SELECT 	nr_sequencia_w, nr_seq_lanc, clock_timestamp(), nm_usuario_p,
						cd_procedimento, ie_origem_proced, cd_material, qt_lancamento,
						ie_medico_atendimento, ie_local_estoque, 'I', 'N',
						nr_seq_exame, ie_funcao_medico, tx_procedimento, qt_ano_min,
						qt_ano_max, ie_regra_guia, clock_timestamp(), nm_usuario_p,
						ie_forma_func_medico, nr_seq_proc_interno, ie_consiste_item,
						ie_proc_princ_atend, cd_cnpj_prestador,cd_cid_doenca, coalesce(ie_adic_orcamento,'N'), cd_medico
				from	regra_lanc_aut_pac
				where nr_seq_regra = nr_seq_w;
			end loop;
			close c003;
		elsif (nm_tabela_p = 'REGRA_MATERIAL_CONTA') then
			if (ie_excluir_p = 'S') then
				delete from regra_material_conta
				where cd_convenio = cd_convenio_dest_w;
			end if;
			insert into regra_material_conta(
				nr_sequencia, dt_atualizacao,
				nm_usuario, ie_regra, cd_convenio)
			SELECT nextval('regra_material_conta_seq'), clock_timestamp(),
				nm_usuario_p, ie_regra, cd_convenio_dest_w
			from regra_material_conta
			where cd_convenio = cd_convenio_orig_p;
		elsif (nm_tabela_p = 'REGRA_ORIGEM_PROCED') then
			if (ie_excluir_p = 'S') then
				delete from regra_origem_proced
				where cd_convenio = cd_convenio_dest_w
				and   cd_estabelecimento = cd_estabelecimento_p;
			end if;
			insert into regra_origem_proced(
				nr_sequencia, ds_regra,
				ie_origem_proced, dt_atualizacao,
				nm_usuario, cd_convenio, cd_categoria,
				ie_tipo_atendimento, ie_tipo_convenio, dt_atualizacao_nrec,
				nm_usuario_nrec, cd_estabelecimento)
			SELECT nextval('regra_origem_proced_seq'), ds_regra,
				ie_origem_proced, clock_timestamp(),
				nm_usuario_p, cd_convenio_dest_w, cd_categoria,
				ie_tipo_atendimento, ie_tipo_convenio, clock_timestamp(),
				nm_usuario_p, cd_estabelecimento_p
			from regra_origem_proced
			where cd_convenio = cd_convenio_orig_p
			and   cd_estabelecimento = cd_estabelecimento_p;
		elsif (nm_tabela_p = 'REGRA_RETORNO') then
			if (ie_excluir_p = 'S') then
				delete from regra_retorno
				where cd_convenio = cd_convenio_dest_w;
			end if;
			insert into regra_retorno(
				nr_sequencia, cd_estabelecimento,
				tx_valor, dt_atualizacao,
				nm_usuario, cd_convenio,
				cd_edicao_amb, cd_area_procedimento,
				cd_especialidade, cd_grupo_proc,
				cd_procedimento, ie_origem_proced,
				ie_tipo_atendimento, cd_setor_atendimento,
				ie_credenciado, cd_especialidade_medica, cd_medico)
			SELECT nextval('regra_retorno_seq'), cd_estabelecimento,
				tx_valor, clock_timestamp(),
				nm_usuario_p, cd_convenio_dest_w,
				cd_edicao_amb, cd_area_procedimento,
				cd_especialidade, cd_grupo_proc,
				cd_procedimento, ie_origem_proced,
				ie_tipo_atendimento, cd_setor_atendimento,
				ie_credenciado, cd_especialidade_medica, cd_medico
			from regra_retorno
			where cd_convenio = cd_convenio_orig_p;
		elsif (nm_tabela_p = 'TIPO_ACOMOD_DIFERENCA') then
			if (ie_excluir_p = 'S') then
				delete from tipo_acomod_diferenca
				where cd_convenio = cd_convenio_dest_w;
			end if;
			open c004;
			loop
				fetch c004 into c004_w;
				EXIT WHEN NOT FOUND; /* apply on c004 */

				insert into tipo_acomod_diferenca(
					cd_tipo_acomodacao, nr_sequencia,
					dt_atualizacao, nm_usuario,
					ie_calculo_diferenca, cd_procedimento,
					ie_origem_proced, cd_convenio,
					cd_tipo_acomod_dif, cd_convenio_base,
					cd_categoria_base, cd_procedimento_base, ie_origem_proc_base, ie_paciente_isolado)
				SELECT cd_tipo_acomodacao, c004_w.nr_sequencia + row_number() OVER () AS rownum,
					clock_timestamp(), nm_usuario_p,
					ie_calculo_diferenca, cd_procedimento,
					ie_origem_proced, cd_convenio_dest_w,
					cd_tipo_acomod_dif, cd_convenio_base,
					cd_categoria_base, cd_procedimento_base, ie_origem_proc_base, ie_paciente_isolado
				from tipo_acomod_diferenca
				where cd_convenio = cd_convenio_orig_p
				  and cd_tipo_acomodacao = c004_w.cd_tipo_acomodacao;
			end loop;
			close c004;
		elsif (nm_tabela_p in ('CONV_REGRA_ENVIO_PROTOCOLO','REGRA_SENHA_CONVENIO','CONVENIO_REGRA_CONTA',
					'CONVENIO_REGRA_MEDICO','COTACAO_MOEDA_CONVENIO','CONV_FECHAMENTO_TIPO_PROT',
					'CONVENIO_FECHAMENTO','REGRA_CONVENIO_PLANO','REGRA_CONVENIO_PLANO_MAT',
					'CONVENIO_REGRA_PROC_PRINC','PARAM_INTERFACE','CONVENIO_REGRA_QTDE_PROC',
					'CONVENIO_REGRA_QTDE_MAT','CONVENIO_CONTA_CONTABIL','CONVENIO_REGRA_ATEND',
					'REGRA_GERAR_AUTORIZACAO','PARAMETRO_NFS','CONV_REGRA_ESTRUT_DESC','CONVENIO_PROCED_PADRAO',
					'CONVENIO_REGRA_ENTREGA', 'CONV_REGRA_TAXA_REPOUSO', 'REGRA_DIETA_ACOMP')) then
			CALL copia_param_conv_regra(cd_convenio_orig_p, cd_convenio_dest_w, nm_tabela_p, nm_usuario_p,
						ie_excluir_p, cd_estabelecimento_p);
		elsif (nm_tabela_p in ('CONVENIO_AMB','REGRA_AJUSTE_PROC(Estrutura)','REGRA_AJUSTE_PROC(Ajuste)','CONVENIO_REGRA_QTDE','CONVENIO_SERVICO',
					'CONVENIO_PRECO_MAT','CONVENIO_BRASINDICE','REGRA_AJUSTE_MATERIAL(Estrutura)','REGRA_AJUSTE_MATERIAL(Ajuste)',
					'CONVENIO_SIMPRO','CONVENIO_CARGA_PRECO','MAT_CONVENIO_REGRA_QTDE',
					'CONVENIO_TAXA_SERVICO','CONVENIO_TAXA_CIRURGIA','TIPO_TAXA_CIRURGICA',
					'CONVENIO_TAXA_EXAME','HEALTH_FUND_DRG','HEALTH_FUND_PRICE_LEVEL')) then
			CALL copia_param_conv_precos(cd_convenio_orig_p, cd_convenio_dest_w, nm_tabela_p, nm_usuario_p,
						ie_excluir_p, cd_estabelecimento_p);
		elsif (nm_tabela_p in ('CONVENIO_ESTABELECIMENTO','CONVENIO_BLOQUEIO','CONVENIO_PRESTADOR','MEDICO_CONVENIO')) then
			CALL copia_param_conv_relaciona(cd_convenio_orig_p, cd_convenio_dest_w, nm_tabela_p,
						nm_usuario_p, ie_excluir_p, cd_estabelecimento_p);
		elsif (nm_tabela_p in ('CONVENIO_RET_REGRA','CONVERSAO_MATERIAL_CONVENIO','CONVERSAO_PROC_CONVENIO',
				       'CONVERSAO_UNIDADE_MEDIDA','CONVERSAO_MEIO_EXTERNO')) then
			CALL copia_param_conv_conversao(cd_convenio_orig_p, cd_convenio_dest_w, nm_tabela_p, nm_usuario_p,
						ie_excluir_p, cd_estabelecimento_p);
		elsif (nm_tabela_p = 'PACOTE') then
			CALL copia_param_conv_pacote(cd_convenio_orig_p, cd_convenio_dest_w, nm_tabela_p,
						nm_usuario_p,ie_excluir_p, cd_estabelecimento_p);
		elsif (nm_tabela_p = 'TISS_PARAMETROS_CONVENIO') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_parametros_convenio
				where	cd_convenio		= cd_convenio_dest_w
				and	cd_estabelecimento	= cd_estabelecimento_p;
			end if;

			select	nextval('tiss_parametros_convenio_seq')
			into STRICT	nr_seq_tiss_w
			;

			insert into tiss_parametros_convenio(
							nr_sequencia, cd_convenio, cd_estabelecimento, DT_ATUALIZACAO, NM_USUARIO, DT_ATUALIZACAO_NREC, NM_USUARIO_NREC,
							IE_DATA_DESPESA,
                                                         IE_MEDICO_SOLIC_ATEND,
                                                         IE_AGRUPAR_PROC,
                                                         IE_FECHAR_CONTA_INCONS,
                                                         IE_CID_SPSADT,
                                                         IE_PARTIC_CONVENIADO,
                                                         DS_OBSERVACAO,
                                                         IE_CONSISTE_CODIGO,
                                                         IE_ATUALIZAR_ALTA,
                                                         IE_EXEC_SPSADT,
                                                         IE_TOTALIZAR_OPM,
                                                         IE_CONSISTE_TISS,
                                                         IE_SPSADT_ZERADO,
                                                         IE_RI_ZERADO,
                                                         IE_GUIA_PROTOCOLO,
                                                         IE_DESPESA_ZERADA,
                                                         DS_MASCARA_USUARIO,
                                                         IE_ARREDONDAMENTO_DESP,
                                                         IE_PROC_PARTIC,
                                                         IE_PROC_SOLIC_SPSADT,
                                                         IE_CONSISTE_AUTOR_SPSADT,
                                                         IE_SOLICITANTE,
                                                         IE_NUMERO_LOTE,
                                                         IE_CRM,
                                                         IE_GUIA_PRESTADOR,
                                                         IE_DESP_TISS_INTERNADO,
                                                         IE_CONSISTE_DESP_NEG,
                                                         IE_CONSISTE_VIA_ACESSO,
                                                         IE_COD_TISS_BRASINDICE,
                                                         IE_SAIDA_INTERNACAO,
                                                         IE_TOTAL_GUIA_DESP,
                                                         IE_DATA_PROC,
                                                         IE_GERAR_CTA_DIF_TISS,
                                                         IE_SENHA_GUIA,
                                                         IE_GUIA_HONORARIO,
                                                         IE_FECHAR_PROT_INCONS,
                                                         IE_CAMPO_BOOLEAN,
                                                         IE_GUIA_PRINC_HONOR,
                                                         IE_MASCARA_CID,
                                                         DS_FORMATO_CARTEIRA,
                                                         IE_ENVIO_CARTEIRA,
                                                         DS_MASCARA_LOTE,
                                                         IE_DESC_PROC_INTERNO,
                                                         IE_ORDENACAO_OD,
                                                         IE_HONOR_PARTIC,
                                                         IE_CONSISTIR_OBS,
                                                         QT_DIAS_VALIDADE_GUIA,
                                                         DS_EMAIL_AUTOR,
                                                         NR_SEQ_SAIDA_SPSADT,
                                                         IE_PARTIC_SPSADT,
                                                         IE_ASSINATURA_SOLIC,
                                                         IE_EMITE_OPM_ZERADO,
                                                         IE_DIGITOS_DESP,
                                                         IE_ABORTO_NASC,
                                                         IE_CONSISTE_INDICACAO,
                                                         IE_REDUCAO_ACRESC,
                                                         IE_TOTAL_OPM,
                                                         IE_CONTRATADO_CONSULTA,
                                                         QT_GUIAS_PROTOCOLO,
                                                         IE_DATA_ENTRADA_RI,
                                                         QT_MAX_DESPESA,
                                                         IE_CONSISTIR_PROC,
                                                         IE_CONTRAT_EXEC_HI,
                                                         IE_CONSISTIR_DECL_OBITO,
                                                         IE_DT_CONTRAT_RI,
                                                         IE_PERIODO_DESP,
                                                         IE_CONSISTE_TEC_UTIL,
                                                         IE_PARTICIPANTE_RI,
                                                         IE_CONSISTIR_GUIA_SENHA,
                                                         IE_RELAT_AUTOR,
                                                         IE_REGRA_MASCARA,
                                                         IE_SEPARAR_SPSADT_HONOR,
                                                         IE_VALOR_DESCONTO,
                                                         IE_TIPO_ACOMOD,
                                                         IE_EXEC_RI,
                                                         IE_FORMATO_RED_ACRES,
                                                         IE_EMITE_HONOR_SADT_PEP,
                                                         IE_ORDENACAO_XML,
                                                         IE_DATA_TRANS_XML,
                                                         IE_AGRUPAR_DESP_PAC,
                                                         IE_MEDICO_REP,
                                                         IE_HONOR_ZERADO,
                                                         IE_NOME_ARQUIVO,
                                                         IE_CONSISTE_TIPO_SAIDA,
                                                         IE_CONSISTE_CID_AUTOR,
                                                         IE_CID_SOLIC_EXTERNO,
                                                         IE_ESPECIALIDADE_EXEC,
                                                         IE_OBSERVACAO,
                                                         IE_VALOR_UNITARIO,
                                                         IE_PROTOCOLO_RET,
                                                         IE_ORDENACAO_SPSADT,
                                                         IE_CARTEIRA_MED,
                                                         IE_GUIA_DESP_MED,
                                                         IE_DT_EMISSAO_GUIA,
                                                         IE_TOTAL_GERAL_OPM,
                                                         IE_VALOR_UNITARIO_OPM,
                                                         IE_OBS_URGENTE,
                                                         IE_LADO_REP,
                                                         IE_QUEBRA_PROC_PEP,
                                                         IE_CONVERSAO_QTDE_MAT,
                                                         DS_DIR_PADRAO,
                                                         DS_DIR_PADRAO_RET,
                                                         IE_AGRUP_RESP_CRED,
                                                         IE_DATA_ENTRADA_ALTA,
                                                         NR_SEQ_SAIDA_INT,
                                                         IE_PACOTE,
							IE_PROC_TUSS                   ,
							IE_PRESCR_UNICA                ,
							IE_DATA_ASS_PREST              ,
							IE_NOME_ABREV                  ,
							IE_SENHA_GUIA_PRINC            ,
							IE_DESC_PLANO                  ,
							IE_DESC_CONVENIO               ,
							IE_PROT_SOLIC_STATUS           ,
							IE_DATA_REF_TAB_MAT            ,
							IE_CONSISTIR_CPF               ,
							IE_CONSISTIR_UF_CRM_SOLIC,
							DS_ARQUIVO_LOGO_COMP      ,
							IE_CONSISTIR_GUIA_DUP      ,
							IE_DT_PROC_TASYMED          ,
							IE_CONSISTIR_PROC_ZERADO     ,
							IE_ATUAL_CONTA                ,
							IE_CONS_TEMPO_DOENCA           ,
							IE_AGRUP_EXAME                 ,
							IE_DT_AUTOR_SADT               ,
							IE_FORCAR_AGRUP                ,
							IE_TIPO_FATUR_TISS             ,
							NR_SEQ_SAIDA_CONSULTA          ,
							IE_GERAR_TISS                  	,
							DS_FUNCTION_OBS_SPSADT         	,
							IE_CONSISTE_CBO                	,
							IE_SENHA_AUTOR                 	,
							DS_ADICIONAL_GUIA_PREST        	,
							CD_ADIC_CRM                    	,
							IE_CONSISTE_SENHA_AUTOR        	,
							IE_DT_AUTOR_RI                 	,
							IE_DT_VALIDADE_SENHA_RI        	,
							IE_MEMBRO_EXEC                 	,
							IE_DT_ASSIN_SOLIC              	,
							IE_ALT_TIPO_ATEND_CONTA        	,
							DS_FUNCTION_OBS_CONSULTA	,
							IE_GRAVAR_LOG_CONTA      	,
							IE_GESTACAO_NASC_VIVOS    	,     
							IE_GESTACAO_DIF_ABORTO         	,
							IE_CONSISTE_QT_PROC     	,       
							IE_ATUALIZA_SENHA_CONTA        	,
							IE_TRANSTORNO_ABORTO           	,
							NR_SEQ_TRANS_TISS              	,
							DS_MASCARA_CRM                 	,
							IE_CID_RI                      	,
							DS_NAMESPACE                   	,
							IE_CODIGO_INTERNO_DESP         	,
							IE_CD_AUTORIZACAO_RELAT        	,
							IE_DESC_EXAME_EXT              	,
							IE_PREST_SPSADT_TASYMED        	,
							IE_FONTE_PAGADORA              	,
							NR_LOTE_ATUAL                  	,
							IE_TOPO_REP                    	,
							IE_MASCARA_DNV                 	,
							IE_DATA_ATECACO                	,
							IE_GUIA_NUMERICA               	,
							IE_FORCAR_AGRUP_PARTIC         	,
							IE_MEDICO_CONVENIO             	,
							IE_TIPO_FATUR_PERIODO          	,
							IE_SPSADT_ATEND_RETORNO        	,
							IE_CONS_ATEND_RETORNO          	,
							IE_ORDENACAO_RI                	,
							IE_ATUALIZA_NR_GUIA            	,
							IE_COD_TISS_SIMPRO             	,
							IE_CRM_CONTRAT_SOLIC           	,
							IE_LADO_CONTA                  	,
							IE_CONSISTE_GRAU_PARTIC        	,
							IE_SOLIC_DEM_PAGTO             	,
							IE_NAO_HONORARIO_SADT          	,
							IE_GUIA_DESP_PROC_PRINC        	,
							IE_SADT_AUTOR_SEM_PROC 		,
							IE_MEDICO_SOLIC_EXAME          	,
							IE_DIAG_TIPO_ATEND             	,
							IE_EMITIR_HEMOCOMPONENTE	,
							IE_ASSINATURA_EXEC             	,
							IE_QUEBRA_GRUPO_EXAME		,
							IE_AGRUPAR_HONOR		,
							IE_GUIA_PRINC_AUTOR		,
							IE_ULTIMA_PRESCRICAO		,
							IE_GUIA_OPERADORA_AUTOR		,
							IE_CONVERSAO_SADT_SOLIC		,
							IE_ARQUIVOS_ZIP			,
							IE_CONSISTE_CNS			,
							IE_MATERIAL_EXEC		,
							IE_QTD_MATERIAL			,
							IE_SENHA_PROC_PRESCR		,
							IE_GUIA_SOLIC_INTE_PROC		,
							IE_CONSISTE_CODIGO_ANS		,
							IE_TIPO_SAIDA_PARCIAL		,
							IE_OBITO_PARCIAL		,
							DS_CARACTERES_XML		,
							IE_AGRUPAR_OPME			,
							IE_QUEBRA_HORARIOS_PRESCR	,
							IE_LOTE_XML_DESPESA		,
							IE_DESC_LAUDO_FATUR_MED		,
							IE_CONSISTE_VALOR_GUIA		,
							IE_DATA_ASSIN_AUTOR		,
							IE_QUEBRA_GUIA_PRESCR_ASSOC	,
							IE_GUIA_PEDIDO_EXAME		,
							IE_OBS_PRESCR_AUTOR		,
							IE_GUIA_REF_PRORROG		,
							IE_SENHA_MAT_GUIA_PROC		,
							IE_PREST_EXEC_PEDIDO_EXAME	,
							IE_DATA_LOTE_ANEXO		,
							IE_QT_DOSE_SOLIC_QUIMIO		,
							IE_REF_SOLIC_DEM_PAGTO		,
							IE_CBO_AUTOR_ESPEC		,
							IE_SETOR_EXEC_PROC		,
							IE_CONSISTE_TUSS_AUTOR		,
							IE_DOSE_QUIMIO			,
							IE_SENHA_TAXA_GUIA_PROC		,
							IE_CONSISTE_JUST_ESPEC_OPM	,
							IE_GUIA_REF_ANEXO		,
							IE_INDICACAO_PROC_PRESCR	,
							IE_PREST_SOLIC_ODONTO		,
							IE_CONTRAT_EXEC_ODONTO		,
							IE_PROF_EXEC_ODONTO		,
							NM_USUARIO_ASSINATURA_CONTRAT	,
							QT_DIAS_INT_TITULAR_CONV	,
							IE_QT_PROC_PRESCR_INTERV	,
							NR_GUIA_OPER_REC_GLOSA		,
							IE_ATUALIZA_VINCULO_TUSS	,
							IE_DESP_AGRUP_VALOR		,
							IE_IMPORT_ITENS_DEM_GRG		,
							IE_DATA_REC_GLOSA_TISS		,
							IE_IMP_VALIDADE_GUIA_SENHA)
			SELECT				nr_seq_tiss_w, cd_convenio_dest_w, cd_estabelecimento_p, clock_timestamp(), nm_usuario_p, clock_timestamp(), nm_usuario_p,
							IE_DATA_DESPESA,
                                                         IE_MEDICO_SOLIC_ATEND,
                                                         IE_AGRUPAR_PROC,
                                                         IE_FECHAR_CONTA_INCONS,
                                                         IE_CID_SPSADT,
                                                         IE_PARTIC_CONVENIADO,
                                                         DS_OBSERVACAO,
                                                         IE_CONSISTE_CODIGO,
                                                         IE_ATUALIZAR_ALTA,
                                                         IE_EXEC_SPSADT,
                                                         IE_TOTALIZAR_OPM,
                                                         IE_CONSISTE_TISS,
                                                         IE_SPSADT_ZERADO,
                                                         IE_RI_ZERADO,
                                                         IE_GUIA_PROTOCOLO,
                                                         IE_DESPESA_ZERADA,
                                                         DS_MASCARA_USUARIO,
                                                         IE_ARREDONDAMENTO_DESP,
                                                         IE_PROC_PARTIC,
                                                         IE_PROC_SOLIC_SPSADT,
                                                         IE_CONSISTE_AUTOR_SPSADT,
                                                         IE_SOLICITANTE,
                                                         IE_NUMERO_LOTE,
                                                         IE_CRM,
                                                         IE_GUIA_PRESTADOR,
                                                         IE_DESP_TISS_INTERNADO,
                                                         IE_CONSISTE_DESP_NEG,
                                                         IE_CONSISTE_VIA_ACESSO,
                                                         IE_COD_TISS_BRASINDICE,
                                                         IE_SAIDA_INTERNACAO,
                                                         IE_TOTAL_GUIA_DESP,
                                                         IE_DATA_PROC,
                                                         IE_GERAR_CTA_DIF_TISS,
                                                         IE_SENHA_GUIA,
                                                         IE_GUIA_HONORARIO,
                                                         IE_FECHAR_PROT_INCONS,
                                                         IE_CAMPO_BOOLEAN,
                                                         IE_GUIA_PRINC_HONOR,
                                                         IE_MASCARA_CID,
                                                         DS_FORMATO_CARTEIRA,
                                                         IE_ENVIO_CARTEIRA,
                                                         DS_MASCARA_LOTE,
                                                         IE_DESC_PROC_INTERNO,
                                                         IE_ORDENACAO_OD,
                                                         IE_HONOR_PARTIC,
                                                         IE_CONSISTIR_OBS,
                                                         QT_DIAS_VALIDADE_GUIA,
                                                         DS_EMAIL_AUTOR,
                                                         NR_SEQ_SAIDA_SPSADT,
                                                         IE_PARTIC_SPSADT,
                                                         IE_ASSINATURA_SOLIC,
                                                         IE_EMITE_OPM_ZERADO,
                                                         IE_DIGITOS_DESP,
                                                         IE_ABORTO_NASC,
                                                         IE_CONSISTE_INDICACAO,
                                                         IE_REDUCAO_ACRESC,
                                                         IE_TOTAL_OPM,
                                                         IE_CONTRATADO_CONSULTA,
                                                         QT_GUIAS_PROTOCOLO,
                                                         IE_DATA_ENTRADA_RI,
                                                         QT_MAX_DESPESA,
                                                         IE_CONSISTIR_PROC,
                                                         IE_CONTRAT_EXEC_HI,
                                                         IE_CONSISTIR_DECL_OBITO,
                                                         IE_DT_CONTRAT_RI,
                                                         IE_PERIODO_DESP,
                                                         IE_CONSISTE_TEC_UTIL,
                                                         IE_PARTICIPANTE_RI,
                                                         IE_CONSISTIR_GUIA_SENHA,
                                                         IE_RELAT_AUTOR,
                                                         IE_REGRA_MASCARA,
                                                         IE_SEPARAR_SPSADT_HONOR,
                                                         IE_VALOR_DESCONTO,
                                                         IE_TIPO_ACOMOD,
                                                         IE_EXEC_RI,
                                                         IE_FORMATO_RED_ACRES,
                                                         IE_EMITE_HONOR_SADT_PEP,
                                                         IE_ORDENACAO_XML,
                                                         IE_DATA_TRANS_XML,
                                                         IE_AGRUPAR_DESP_PAC,
                                                         IE_MEDICO_REP,
                                                         IE_HONOR_ZERADO,
                                                         IE_NOME_ARQUIVO,
                                                         IE_CONSISTE_TIPO_SAIDA,
                                                         IE_CONSISTE_CID_AUTOR,
                                                         IE_CID_SOLIC_EXTERNO,
                                                         IE_ESPECIALIDADE_EXEC,
                                                         IE_OBSERVACAO,
                                                         IE_VALOR_UNITARIO,
                                                         IE_PROTOCOLO_RET,
                                                         IE_ORDENACAO_SPSADT,
                                                         IE_CARTEIRA_MED,
                                                         IE_GUIA_DESP_MED,
                                                         IE_DT_EMISSAO_GUIA,
                                                         IE_TOTAL_GERAL_OPM,
                                                         IE_VALOR_UNITARIO_OPM,
                                                         IE_OBS_URGENTE,
                                                         IE_LADO_REP,
                                                         IE_QUEBRA_PROC_PEP,
                                                         IE_CONVERSAO_QTDE_MAT,
                                                         DS_DIR_PADRAO,
                                                         DS_DIR_PADRAO_RET,
                                                         IE_AGRUP_RESP_CRED,
                                                         IE_DATA_ENTRADA_ALTA,
                                                         NR_SEQ_SAIDA_INT,
                                                         IE_PACOTE,
							IE_PROC_TUSS                   ,
							IE_PRESCR_UNICA                ,
							IE_DATA_ASS_PREST              ,
							IE_NOME_ABREV                  ,
							IE_SENHA_GUIA_PRINC            ,
							IE_DESC_PLANO                  ,
							IE_DESC_CONVENIO               ,
							IE_PROT_SOLIC_STATUS           ,
							IE_DATA_REF_TAB_MAT            ,
							IE_CONSISTIR_CPF               ,
							IE_CONSISTIR_UF_CRM_SOLIC,
							DS_ARQUIVO_LOGO_COMP      ,
							IE_CONSISTIR_GUIA_DUP      ,
							IE_DT_PROC_TASYMED          ,
							IE_CONSISTIR_PROC_ZERADO     ,
							IE_ATUAL_CONTA                ,
							IE_CONS_TEMPO_DOENCA           ,
							IE_AGRUP_EXAME                 ,
							IE_DT_AUTOR_SADT               ,
							IE_FORCAR_AGRUP                ,
							IE_TIPO_FATUR_TISS             ,
							NR_SEQ_SAIDA_CONSULTA          ,
							IE_GERAR_TISS                  	,
							DS_FUNCTION_OBS_SPSADT         	,
							IE_CONSISTE_CBO                	,
							IE_SENHA_AUTOR                 	,
							DS_ADICIONAL_GUIA_PREST        	,
							CD_ADIC_CRM                    	,
							IE_CONSISTE_SENHA_AUTOR        	,
							IE_DT_AUTOR_RI                 	,
							IE_DT_VALIDADE_SENHA_RI        	,
							IE_MEMBRO_EXEC                 	,
							IE_DT_ASSIN_SOLIC              	,
							IE_ALT_TIPO_ATEND_CONTA        	,
							DS_FUNCTION_OBS_CONSULTA	,
							IE_GRAVAR_LOG_CONTA      	,      
							IE_GESTACAO_NASC_VIVOS    	,     
							IE_GESTACAO_DIF_ABORTO         	,
							IE_CONSISTE_QT_PROC     	,       
							IE_ATUALIZA_SENHA_CONTA        	,
							IE_TRANSTORNO_ABORTO           	,
							NR_SEQ_TRANS_TISS              	,
							DS_MASCARA_CRM                 	,
							IE_CID_RI                      	,
							DS_NAMESPACE                   	,
							IE_CODIGO_INTERNO_DESP         	,
							IE_CD_AUTORIZACAO_RELAT        	,
							IE_DESC_EXAME_EXT              	,
							IE_PREST_SPSADT_TASYMED        	,
							IE_FONTE_PAGADORA              	,
							NR_LOTE_ATUAL                  	,
							IE_TOPO_REP                    	,
							IE_MASCARA_DNV                 	,
							IE_DATA_ATECACO                	,
							IE_GUIA_NUMERICA               	,
							IE_FORCAR_AGRUP_PARTIC         	,
							IE_MEDICO_CONVENIO             	,
							IE_TIPO_FATUR_PERIODO          	,
							IE_SPSADT_ATEND_RETORNO        	,
							IE_CONS_ATEND_RETORNO          	,
							IE_ORDENACAO_RI                	,
							IE_ATUALIZA_NR_GUIA            	,
							IE_COD_TISS_SIMPRO             	,
							IE_CRM_CONTRAT_SOLIC           	,
							IE_LADO_CONTA                  	,
							IE_CONSISTE_GRAU_PARTIC        	,
							IE_SOLIC_DEM_PAGTO             	,
							IE_NAO_HONORARIO_SADT          	,
							IE_GUIA_DESP_PROC_PRINC        	,
							IE_SADT_AUTOR_SEM_PROC 		,
							IE_MEDICO_SOLIC_EXAME          	,
							IE_DIAG_TIPO_ATEND             	,
							IE_EMITIR_HEMOCOMPONENTE	,
							IE_ASSINATURA_EXEC             	,
							IE_QUEBRA_GRUPO_EXAME		,
							IE_AGRUPAR_HONOR		,
							IE_GUIA_PRINC_AUTOR		,
							IE_ULTIMA_PRESCRICAO		,
							IE_GUIA_OPERADORA_AUTOR		,
							IE_CONVERSAO_SADT_SOLIC		,
							IE_ARQUIVOS_ZIP			,
							IE_CONSISTE_CNS			,
							IE_MATERIAL_EXEC		,
							IE_QTD_MATERIAL			,
							IE_SENHA_PROC_PRESCR		,
							IE_GUIA_SOLIC_INTE_PROC		,
							IE_CONSISTE_CODIGO_ANS		,
							IE_TIPO_SAIDA_PARCIAL		,
							IE_OBITO_PARCIAL		,
							DS_CARACTERES_XML		,
							IE_AGRUPAR_OPME			,
							IE_QUEBRA_HORARIOS_PRESCR	,
							IE_LOTE_XML_DESPESA		,
							IE_DESC_LAUDO_FATUR_MED		,
							IE_CONSISTE_VALOR_GUIA		,
							IE_DATA_ASSIN_AUTOR		,
							IE_QUEBRA_GUIA_PRESCR_ASSOC	,
							IE_GUIA_PEDIDO_EXAME		,
							IE_OBS_PRESCR_AUTOR		,
							IE_GUIA_REF_PRORROG		,
							IE_SENHA_MAT_GUIA_PROC		,
							IE_PREST_EXEC_PEDIDO_EXAME	,
							IE_DATA_LOTE_ANEXO		,
							IE_QT_DOSE_SOLIC_QUIMIO		,
							IE_REF_SOLIC_DEM_PAGTO		,
							IE_CBO_AUTOR_ESPEC		,
							IE_SETOR_EXEC_PROC		,
							IE_CONSISTE_TUSS_AUTOR		,
							IE_DOSE_QUIMIO			,
							IE_SENHA_TAXA_GUIA_PROC		,
							IE_CONSISTE_JUST_ESPEC_OPM	,
							IE_GUIA_REF_ANEXO		,
							IE_INDICACAO_PROC_PRESCR	,
							IE_PREST_SOLIC_ODONTO		,
							IE_CONTRAT_EXEC_ODONTO		,
							IE_PROF_EXEC_ODONTO		,
							NM_USUARIO_ASSINATURA_CONTRAT	,
							QT_DIAS_INT_TITULAR_CONV	,
							IE_QT_PROC_PRESCR_INTERV	,
							NR_GUIA_OPER_REC_GLOSA		,
							IE_ATUALIZA_VINCULO_TUSS	,
							IE_DESP_AGRUP_VALOR		,
							IE_IMPORT_ITENS_DEM_GRG		,
							IE_DATA_REC_GLOSA_TISS		,
							IE_IMP_VALIDADE_GUIA_SENHA
			from	tiss_parametros_convenio
			where	cd_convenio	 	= cd_convenio_orig_p
			and	cd_estabelecimento	= cd_estabelecimento_p;

		elsif (nm_tabela_p = 'TISS_REGRA_TABELA_MAT') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_regra_tabela_mat
				where	cd_convenio		= cd_convenio_dest_w
				and	cd_estabelecimento	= cd_estabelecimento_p;
			end if;

			open c011;
			loop
			fetch c011 into
				nr_seq_tabela_mat_w;
			EXIT WHEN NOT FOUND; /* apply on c011 */

				select	nextval('tiss_regra_tabela_mat_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_regra_tabela_mat(
					nr_sequencia,
					cd_estabelecimento,
					dt_atualizacao,
					nm_usuario,
					cd_convenio,
					cd_categoria,
					dt_inicio_vigencia,
					cd_grupo_material,
					cd_subgrupo_material,
					cd_classe_material,
					cd_material,
					nr_seq_tiss_tabela,
					ie_cod_material,
					ie_conversao_externa,
					CD_ADICIONAL,
					IE_DESC_MATERIAL,
					IE_PRIORIDADE,
					CD_TAB_PRECO_MATERIAL,
					DT_FINAL_VIGENCIA,
					IE_SITUACAO,
					CD_MATERIAL_TISS,
					DS_MATERIAL_TISS,
					IE_TIPO_ATENDIMENTO,
					CD_SETOR_ATENDIMENTO,
					ie_origem_preco,
					dt_atualizacao_nrec,
					nm_usuario_nrec,
					ie_pacote,
					vl_inicial,
					vl_final,
					ie_registro_anvisa,
					ie_material_tuss,
					nr_seq_familia,
					ie_tipo_material)
				SELECT	nr_seq_tiss_w,
					cd_estabelecimento_p,
					clock_timestamp(), nm_usuario_p,
					cd_convenio_dest_w,
					cd_categoria,
					dt_inicio_vigencia,
					cd_grupo_material,
					cd_subgrupo_material,
					cd_classe_material,
					cd_material,
					nr_seq_tiss_tabela,
					ie_cod_material,
					ie_conversao_externa,
					CD_ADICIONAL,
					IE_DESC_MATERIAL,
					IE_PRIORIDADE,
					CD_TAB_PRECO_MATERIAL,
					DT_FINAL_VIGENCIA,
					IE_SITUACAO,
					CD_MATERIAL_TISS,
					DS_MATERIAL_TISS,
					IE_TIPO_ATENDIMENTO,
					CD_SETOR_ATENDIMENTO,
					ie_origem_preco,
					clock_timestamp(),
					nm_usuario_p,
					ie_pacote,
					vl_inicial,
					vl_final,
					ie_registro_anvisa,
					ie_material_tuss,
					nr_seq_familia,
					ie_tipo_material
				from	tiss_regra_tabela_mat
				where	nr_sequencia	= nr_seq_tabela_mat_w;

			end loop;
			close c011;

		elsif (nm_tabela_p = 'TISS_SENHA_CONEXAO') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_senha_conexao
				where	cd_convenio		= cd_convenio_dest_w
				and	cd_estabelecimento	= cd_estabelecimento_p;
			end if;

			select	nextval('tiss_senha_conexao_seq')
			into STRICT	nr_seq_tiss_w
			;

			insert into tiss_senha_conexao(
				nr_sequencia, cd_estabelecimento, nm_usuario_tiss, ds_senha_tiss, dt_atualizacao, nm_usuario, cd_convenio,
				nm_usuario_senha, ie_comunicacao, ds_dir_entrada, ds_dir_saida, ds_caminho_certificado, ds_senha_certificado,
				ds_caminho_keystore,ds_senha_keystore)
			SELECT	nr_seq_tiss_w, cd_estabelecimento_p, nm_usuario_tiss, ds_senha_tiss, clock_timestamp(), nm_usuario_p,
				cd_convenio_dest_w, nm_usuario_senha, ie_comunicacao, ds_dir_entrada, ds_dir_saida,ds_caminho_certificado, ds_senha_certificado,
				ds_caminho_keystore, ds_senha_keystore
			from	tiss_senha_conexao
			where	cd_convenio	 	= cd_convenio_orig_p
			and	cd_estabelecimento	= cd_estabelecimento_p;

		elsif (nm_tabela_p = 'TISS_REGRA_TABELA_PROC') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_regra_tabela_proc
				where	cd_convenio		= cd_convenio_dest_w
				and	cd_estabelecimento	= cd_estabelecimento_p;
			end if;

			open c012;
			loop
			fetch c012 into
				nr_seq_tabela_proc_w;
			EXIT WHEN NOT FOUND; /* apply on c012 */

				select	nextval('tiss_regra_tabela_proc_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_regra_tabela_proc(
					nr_sequencia, cd_estabelecimento, dt_atualizacao, nm_usuario, cd_convenio,
					cd_categoria, dt_inicio_vigencia, cd_area_procedimento, cd_especialidade, cd_grupo_proc,
					nr_seq_tiss_tabela, cd_procedimento, ie_origem_proced, ie_pacote, cd_procedimento_convenio,
					ds_procedimento_convenio, ie_tipo_atendimento,dt_fim_vigencia, ie_clinica,nr_seq_proc_interno,cd_plano)
				SELECT	nr_seq_tiss_w, cd_estabelecimento_p, clock_timestamp(), nm_usuario_p, cd_convenio_dest_w,
					cd_categoria, dt_inicio_vigencia, cd_area_procedimento, cd_especialidade, cd_grupo_proc,
					nr_seq_tiss_tabela, cd_procedimento, ie_origem_proced, ie_pacote, cd_procedimento_convenio,
					ds_procedimento_convenio,ie_tipo_atendimento,dt_fim_vigencia, ie_clinica,nr_seq_proc_interno,cd_plano
				from	tiss_regra_tabela_proc
				where	nr_sequencia	= nr_seq_tabela_proc_w;

			end loop;
			close c012;

		elsif (nm_tabela_p = 'TISS_REGRA_CAMPO_CONV') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_regra_campo_conv
				where	cd_convenio		= cd_convenio_dest_w
				and	cd_estabelecimento	= cd_estabelecimento_p;
			end if;

			open c013;
			loop
			fetch c013 into
				nr_seq_campo_conv_w;
			EXIT WHEN NOT FOUND; /* apply on c013 */

				select	nextval('tiss_regra_campo_conv_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_regra_campo_conv(
					nr_sequencia, cd_estabelecimento, dt_atualizacao, nm_usuario, cd_convenio,
					nr_seq_campo, ie_envio, ds_padrao, ie_tipo_atendimento, cd_categoria,
					ie_taxas, vl_max_campo, ds_valor_gerado,ie_gases,ie_medicamento,ie_material,ie_taxas_diversas,
					ie_diarias,ie_alugueis,ie_clinica,nr_seq_classificacao,cd_setor_entrada,
					ie_tipo_atend_tiss,ie_tipo_atend_proc_tiss,cd_perfil)
				SELECT	nr_seq_tiss_w, cd_estabelecimento_p, clock_timestamp(), nm_usuario_p, cd_convenio_dest_w,
					nr_seq_campo, ie_envio, ds_padrao, ie_tipo_atendimento, cd_categoria,
					ie_taxas, vl_max_campo, ds_valor_gerado,ie_gases,ie_medicamento,ie_material,ie_taxas_diversas,
					ie_diarias,ie_alugueis,ie_clinica,nr_seq_classificacao,cd_setor_entrada,
					ie_tipo_atend_tiss,ie_tipo_atend_proc_tiss,cd_perfil
				from	tiss_regra_campo_conv
				where	nr_sequencia	= nr_seq_campo_conv_w;

			end loop;
			close c013;

		elsif (nm_tabela_p = 'TISS_REGRA_PRESTADOR') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_regra_prestador
				where	cd_convenio		= cd_convenio_dest_w
				and	cd_estabelecimento	= cd_estabelecimento_p;
			end if;

			open c014;
			loop
			fetch c014 into
				nr_seq_prestador_w;
			EXIT WHEN NOT FOUND; /* apply on c014 */

				select	nextval('tiss_regra_prestador_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_regra_prestador(
					nr_sequencia, cd_estabelecimento, dt_atualizacao, nm_usuario, cd_convenio,
					ie_responsavel_credito, cd_cgc_prestador_tiss, ie_tipo_atendimento, ie_tipo_regra,
					cd_cgc_prestador, ie_guia_ri, ie_solicitante, cd_setor_atendimento, cd_interno, ie_clinica,
					cd_medico_executor, cd_medico_exec_tiss, ie_guia_honorario, ds_prestador_tiss,
					cd_categoria,cd_procedimento,ie_origem_proced,cd_area_procedimento,
					cd_especialidade,cd_grupo_proc,cd_medico_atend,ie_prestador,cd_cgc_solic_prescr,ie_med_exec,
					ie_escala,ie_fatur_medico,ie_prioridade,dt_inicio_vigencia,dt_fim_vigencia,cd_medico_referido,
					cd_tipo_acomodacao,cd_procedencia,cd_plano,nr_seq_classificacao,ie_vinculo_medico)
				SELECT	nr_seq_tiss_w, cd_estabelecimento_p, clock_timestamp(), nm_usuario_p, cd_convenio_dest_w,
					ie_responsavel_credito, cd_cgc_prestador_tiss, ie_tipo_atendimento, ie_tipo_regra,
					cd_cgc_prestador, ie_guia_ri, ie_solicitante, cd_setor_atendimento, cd_interno, ie_clinica,
					cd_medico_executor, cd_medico_exec_tiss, ie_guia_honorario, ds_prestador_tiss,
					cd_categoria,cd_procedimento,ie_origem_proced,cd_area_procedimento,
					cd_especialidade,cd_grupo_proc,cd_medico_atend,ie_prestador,cd_cgc_solic_prescr,ie_med_exec,
					ie_escala,ie_fatur_medico,ie_prioridade,dt_inicio_vigencia,dt_fim_vigencia,cd_medico_referido,
					cd_tipo_acomodacao,cd_procedencia,cd_plano,nr_seq_classificacao,ie_vinculo_medico
				from	tiss_regra_prestador
				where	nr_sequencia	= nr_seq_prestador_w;

			end loop;
			close c014;

		elsif (nm_tabela_p = 'TISS_REGRA_GUIA') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_regra_guia
				where	cd_convenio		= cd_convenio_dest_w
				and	cd_estabelecimento	= cd_estabelecimento_p;
			end if;

			open c015;
			loop
			fetch c015 into
				nr_seq_regra_guia_w;
			EXIT WHEN NOT FOUND; /* apply on c015 */

				select	nextval('tiss_regra_guia_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_regra_guia(
					nr_sequencia, cd_estabelecimento, dt_atualizacao, nm_usuario, cd_convenio,
					ie_tiss_tipo_guia, ie_forma, ds_adicional, ie_tipo_atendimento, nr_inicial, nr_final,
					nr_atual, ds_mascara, cd_perfil_comunic, nr_doc_conv_comunic, ie_guia_honorario, qt_max_proc,
					ie_guia_prestador, ie_responsavel_credito, ie_funcao_medico, ie_cbos, ie_guia_medico, ie_guia_partic_dif,
					ie_senha, ie_setor_atendimento, ie_medico_req, ie_prescricao, cd_setor_atendimento,ie_medico_solic_prescr,
					ie_tipo_atend_conta,ie_funcionario,cd_funcao,ie_considerar_setor,ie_tipo_guia_atend,
					cd_procedimento,ie_origem_proced,cd_area_procedimento,cd_especialidade,cd_grupo_proc,
					ie_considerar_tipo_guia,ie_tipo_procedimento,ie_data_item,ie_tipo_atend_tiss_proc,
					ie_restringir_conta,ie_setor_proc_prescr,ie_restringir_honor, ie_guia)
				SELECT	nr_seq_tiss_w, cd_estabelecimento_p, clock_timestamp(), nm_usuario_p, cd_convenio_dest_w,
					ie_tiss_tipo_guia, ie_forma, ds_adicional, ie_tipo_atendimento, nr_inicial, nr_final,
					nr_atual, ds_mascara, cd_perfil_comunic, nr_doc_conv_comunic, ie_guia_honorario, qt_max_proc,
					ie_guia_prestador, ie_responsavel_credito, ie_funcao_medico, ie_cbos, ie_guia_medico, ie_guia_partic_dif,
					ie_senha, ie_setor_atendimento, ie_medico_req, ie_prescricao, cd_setor_atendimento,ie_medico_solic_prescr,
					ie_tipo_atend_conta,ie_funcionario,cd_funcao,ie_considerar_setor,ie_tipo_guia_atend,
					cd_procedimento,ie_origem_proced,cd_area_procedimento,cd_especialidade,cd_grupo_proc,
					ie_considerar_tipo_guia,ie_tipo_procedimento,ie_data_item,ie_tipo_atend_tiss_proc,
					ie_restringir_conta,ie_setor_proc_prescr,ie_restringir_honor, ie_guia
				from	tiss_regra_guia
				where	nr_sequencia	= nr_seq_regra_guia_w;

			end loop;
			close c015;

		elsif (nm_tabela_p = 'TISS_REGRA_HONOR_SPSADT') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_regra_honor_spsadt
				where	cd_convenio		= cd_convenio_dest_w
				and	cd_estabelecimento	= cd_estabelecimento_p;
			end if;

			open c016;
			loop
			fetch c016 into
				nr_seq_regra_honor_w;
			EXIT WHEN NOT FOUND; /* apply on c016 */

				select	nextval('tiss_regra_honor_spsadt_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_regra_honor_spsadt(
					nr_sequencia, cd_estabelecimento, dt_atualizacao, nm_usuario, cd_convenio,
					ie_responsavel_credito, ie_tipo_atendimento, ie_prestador, ie_exec_compl, cd_setor_entrada, ie_medico_exec)
				SELECT	nr_seq_tiss_w, cd_estabelecimento_p, clock_timestamp(), nm_usuario_p, cd_convenio_dest_w,
					ie_responsavel_credito, ie_tipo_atendimento, ie_prestador, ie_exec_compl, cd_setor_entrada, ie_medico_exec
				from	tiss_regra_honor_spsadt
				where	nr_sequencia	= nr_seq_regra_honor_w;

			end loop;
			close c016;

		elsif (nm_tabela_p = 'TISS_REGRA_VALOR_PROC') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_regra_valor_proc
				where	cd_convenio		= cd_convenio_dest_w
				and	cd_estabelecimento	= cd_estabelecimento_p;
			end if;

			open c017;
			loop
			fetch c017 into
				nr_seq_regra_valor_w;
			EXIT WHEN NOT FOUND; /* apply on c017 */

				select	nextval('tiss_regra_valor_proc_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_regra_valor_proc(
					nr_sequencia, cd_estabelecimento, dt_atualizacao, nm_usuario, cd_convenio,
					ie_tiss_tipo_guia, cd_cgc_prestador, ie_responsavel_credito, ie_regra_valor,
					cd_procedimento,ie_origem_proced,cd_area_procedimento,cd_especialidade,
					cd_grupo_proc,ie_funcao_medico,ie_honorario,ie_pacote,cd_plano_convenio,DT_FIM_VIGENCIA,DT_INICIO_VIGENCIA,	IE_TIPO_ATENDIMENTO)
				SELECT	nr_seq_tiss_w, cd_estabelecimento_p, clock_timestamp(), nm_usuario_p, cd_convenio_dest_w,
					ie_tiss_tipo_guia, cd_cgc_prestador, ie_responsavel_credito, ie_regra_valor,
					cd_procedimento,ie_origem_proced,cd_area_procedimento,cd_especialidade,
					cd_grupo_proc,ie_funcao_medico,ie_honorario,ie_pacote,cd_plano_convenio,DT_FIM_VIGENCIA,DT_INICIO_VIGENCIA,	IE_TIPO_ATENDIMENTO
				from	tiss_regra_valor_proc
				where	nr_sequencia	= nr_seq_regra_valor_w;

			end loop;
			close c017;

		elsif (nm_tabela_p = 'TISS_REGRA_GUIA_PRINC') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_regra_guia_princ
				where	cd_convenio		= cd_convenio_dest_w
				and	cd_estabelecimento	= cd_estabelecimento_p;
			end if;

			open c018;
			loop
			fetch c018 into
				nr_seq_guia_princ_w;
			EXIT WHEN NOT FOUND; /* apply on c018 */

				select	nextval('tiss_regra_guia_princ_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_regra_guia_princ(
					nr_sequencia, cd_estabelecimento, dt_atualizacao, nm_usuario, cd_convenio,
					ie_tiss_tipo_guia, ie_regra, ie_tipo_atendimento, ie_mesma_guia)
				SELECT	nr_seq_tiss_w, cd_estabelecimento_p, clock_timestamp(), nm_usuario_p, cd_convenio_dest_w,
					ie_tiss_tipo_guia, ie_regra, ie_tipo_atendimento, ie_mesma_guia
				from	tiss_regra_guia_princ
				where	nr_sequencia	= nr_seq_guia_princ_w;

			end loop;
			close c018;

		elsif (nm_tabela_p = 'TISS_REGRA_PRESTADOR_SOLIC') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_regra_prestador_solic
				where	cd_convenio		= cd_convenio_dest_w
				and	cd_estabelecimento	= cd_estabelecimento_p;
			end if;

			open c019;
			loop
			fetch c019 into
				nr_seq_prestador_solic_w;
			EXIT WHEN NOT FOUND; /* apply on c019 */

				select	nextval('tiss_regra_prestador_solic_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_regra_prestador_solic(DT_INICIO_VIGENCIA, DT_FIM_VIGENCIA, CD_MEDICO_ATENDIMENTO,
					IE_VINCULO_MEDICO, CD_MEDICO_PRESCR, IE_TIPO_PROTOCOLO,
					nr_sequencia, cd_estabelecimento, dt_atualizacao, nm_usuario, cd_convenio,
					ie_tipo_atendimento, ie_clinica, cd_setor_entrada, ie_solicitante, cd_cgc_prestador,
					cd_procedencia, cd_interno, ds_prestador_tiss, cd_medico_referido, cd_medico_prest)
				SELECT	DT_INICIO_VIGENCIA, DT_FIM_VIGENCIA,CD_MEDICO_ATENDIMENTO,
					IE_VINCULO_MEDICO, CD_MEDICO_PRESCR, IE_TIPO_PROTOCOLO,
					nr_seq_tiss_w, cd_estabelecimento_p, clock_timestamp(), nm_usuario_p, cd_convenio_dest_w,
					ie_tipo_atendimento, ie_clinica, cd_setor_entrada, ie_solicitante, cd_cgc_prestador,
					cd_procedencia, cd_interno, ds_prestador_tiss, cd_medico_referido, cd_medico_prest
				from	tiss_regra_prestador_solic
				where	nr_sequencia	= nr_seq_prestador_solic_w;

			end loop;
			close c019;

		elsif (nm_tabela_p = 'TISS_REGRA_COD_PRESTADOR') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_regra_cod_prestador
				where	cd_convenio		= cd_convenio_dest_w
				and	cd_estabelecimento	= cd_estabelecimento_p;
			end if;

			open c020;
			loop
			fetch c020 into
				nr_seq_regra_prest_w;
			EXIT WHEN NOT FOUND; /* apply on c020 */

				select	nextval('tiss_regra_cod_prestador_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_regra_cod_prestador(
					nr_sequencia, cd_estabelecimento, dt_atualizacao, nm_usuario, cd_convenio,
					cd_prestador_convenio, cd_setor_protocolo, ie_tipo_protocolo, cd_categoria)
				SELECT	nr_seq_tiss_w, cd_estabelecimento_p, clock_timestamp(), nm_usuario_p, cd_convenio_dest_w,
					cd_prestador_convenio, cd_setor_protocolo, ie_tipo_protocolo, cd_categoria
				from	tiss_regra_cod_prestador
				where	nr_sequencia	= nr_seq_regra_prest_w;

			end loop;
			close c020;

		elsif (nm_tabela_p = 'TISS_MOTIVO_GLOSA') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_motivo_glosa
				where	cd_convenio		= cd_convenio_dest_w;
			end if;

			open c021;
			loop
			fetch c021 into
				nr_seq_motivo_glosa_w;
			EXIT WHEN NOT FOUND; /* apply on c021 */

				select	nextval('tiss_motivo_glosa_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_motivo_glosa(
					nr_sequencia, dt_atualizacao, nm_usuario, cd_convenio,
					ie_grupo_glosa, cd_motivo_tiss, ds_motivo_tiss, ie_acao_pls, cd_motivo_glosa,
					ie_fechar_conta,ie_importacao_ops,ie_regra_integracao_ops,ie_permite_alteracao_ops,
					ie_habilita_excecao_ops)
				SELECT	nr_seq_tiss_w, clock_timestamp(), nm_usuario_p, cd_convenio_dest_w,
					ie_grupo_glosa, cd_motivo_tiss, ds_motivo_tiss, ie_acao_pls, cd_motivo_glosa,
					ie_fechar_conta,ie_importacao_ops,ie_regra_integracao_ops,ie_permite_alteracao_ops,
					ie_habilita_excecao_ops
				from	tiss_motivo_glosa
				where	nr_sequencia	= nr_seq_motivo_glosa_w;

			end loop;
			close c021;

		elsif (nm_tabela_p = 'TISS_REGRA_EXEC_COMPL') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_regra_exec_compl
				where	cd_convenio		= cd_convenio_dest_w
				and	cd_estabelecimento	= cd_estabelecimento_p;
			end if;

			open c022;
			loop
			fetch c022 into
				nr_seq_exec_compl_w;
			EXIT WHEN NOT FOUND; /* apply on c022 */

				select	nextval('tiss_regra_exec_compl_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_regra_exec_compl(
					nr_sequencia, cd_estabelecimento, dt_atualizacao, nm_usuario, cd_convenio,
					cd_procedimento, ie_origem_proced, cd_area_procedimento, cd_especialidade,
					cd_grupo_proc, ie_envio, IE_TIPO_ATENDIMENTO, CD_SETOR_ATENDIMENTO, IE_RESPONSAVEL_CREDITO, IE_TISS_TIPO_GUIA,
					CD_MEDICO_EXECUTOR, CD_MEDICO_PREST)
				SELECT	nr_seq_tiss_w, cd_estabelecimento_p, clock_timestamp(), nm_usuario_p, cd_convenio_dest_w,
					cd_procedimento, ie_origem_proced, cd_area_procedimento, cd_especialidade,
					cd_grupo_proc, ie_envio, IE_TIPO_ATENDIMENTO, CD_SETOR_ATENDIMENTO, IE_RESPONSAVEL_CREDITO, IE_TISS_TIPO_GUIA,
					CD_MEDICO_EXECUTOR, CD_MEDICO_PREST
				from	tiss_regra_exec_compl
				where	nr_sequencia	= nr_seq_exec_compl_w;

			end loop;
			close c022;

		elsif (nm_tabela_p = 'TISS_MOTIVO_GLOSA_CONV') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_motivo_glosa_conv
				where	cd_convenio		= cd_convenio_dest_w;
			end if;

			open c023;
			loop
			fetch c023 into
				nr_seq_motivo_glosa_conv_w;
			EXIT WHEN NOT FOUND; /* apply on c023 */

				select	nextval('tiss_motivo_glosa_conv_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_motivo_glosa_conv(
					nr_sequencia, dt_atualizacao, nm_usuario, cd_convenio,
					nr_seq_glosa_tiss, cd_motivo_glosa)
				SELECT	nr_seq_tiss_w, clock_timestamp(), nm_usuario_p, cd_convenio_dest_w,
					nr_seq_glosa_tiss, cd_motivo_glosa
				from	tiss_motivo_glosa_conv
				where	nr_sequencia	= nr_seq_motivo_glosa_conv_w;

			end loop;
			close c023;

		elsif (nm_tabela_p = 'TISS_REGRA_MAT_OPM') then
			if (ie_excluir_p = 'S') then
				delete	from tiss_regra_mat_opm
				where	cd_convenio	= cd_convenio_dest_w;
			end if;

			open c024;
			loop
			fetch c024 into
				nr_seq_tiss_regra_mat_opm_w;
			EXIT WHEN NOT FOUND; /* apply on c024 */

				select	nextval('tiss_regra_mat_opm_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_regra_mat_opm(
					nr_sequencia,
					cd_estabelecimento,
					dt_atualizacao,
					nm_usuario,
					cd_convenio,
					cd_grupo_material,
					cd_subgrupo_material,
					cd_classe_material,
					cd_material,
					ie_opm,
					ie_tipo_atendimento)
				SELECT	nr_seq_tiss_w,
					cd_estabelecimento,
					clock_timestamp(),
					nm_usuario_p,
					cd_convenio_dest_w,
					cd_grupo_material,
					cd_subgrupo_material,
					cd_classe_material,
					cd_material,
					ie_opm,
					ie_tipo_atendimento
				from	tiss_regra_mat_opm
				where	nr_sequencia = nr_seq_tiss_regra_mat_opm_w;

			end loop;
			close c024;

	elsif (nm_tabela_p = 'REGRA_EXEC_LIB_PRESCR_MAT') then
			if (ie_excluir_p = 'S') then
				delete	from regra_exec_lib_prescr_mat
				where	cd_convenio	= cd_convenio_dest_w;
			end if;

			open c025;
			loop
			fetch c025 into
				nr_seq_lib_prescr_mat_w;
			EXIT WHEN NOT FOUND; /* apply on c025 */

				select	nextval('regra_exec_lib_prescr_mat_seq')
				into STRICT	nr_sequencia_mat_w
				;

				insert into regra_exec_lib_prescr_mat(
								nr_sequencia,
								cd_estabelecimento,
								cd_setor_atendimento,
								cd_tipo_baixa,
								dt_atualizacao,
								nm_usuario,
								cd_grupo_material,
								cd_subgrupo_material,
								cd_classe_material,
								cd_material,
								dt_atualizacao_nrec,
								nm_usuario_nrec,
								cd_convenio,
								cd_unidade_medida_dose,
								cd_kit_material,
								ie_acm,
								ie_sn,
								cd_perfil,
								nr_seq_estrutura,
								ie_liberacao,
								cd_protocolo,
								nr_seq_sub_protocolo)
						SELECT	nr_sequencia_mat_w,
								cd_estabelecimento,
								cd_setor_atendimento,
								cd_tipo_baixa,
								clock_timestamp(),
								nm_usuario_p,
								cd_grupo_material,
								cd_subgrupo_material,
								cd_classe_material,
								cd_material,
								clock_timestamp(),
								nm_usuario_p,
								cd_convenio_dest_w,
								cd_unidade_medida_dose,
								cd_kit_material,
								ie_acm,
								ie_sn,
								cd_perfil,
								nr_seq_estrutura,
								ie_liberacao,
								cd_protocolo,
								nr_seq_sub_protocolo
						from	regra_exec_lib_prescr_mat
						where	nr_sequencia = nr_seq_lib_prescr_mat_w;

			end loop;
			close c025;

	elsif (nm_tabela_p = 'CONV_REGRA_FATUR_PROC') then
			if (ie_excluir_p = 'S') then
				delete	from conv_regra_fatur_proc
				where	cd_convenio	= cd_convenio_dest_w;
			end if;

			open c026;
			loop
			fetch c026 into
				nr_seq_fatur_proc_w;
			EXIT WHEN NOT FOUND; /* apply on c026 */

				select	nextval('conv_regra_fatur_proc_seq')
				into STRICT	nr_seq_proc_w
				;

				insert into conv_regra_fatur_proc(
					cd_area_procedimento,
					cd_convenio,
					cd_especialidade,
					cd_estabelecimento,
					cd_grupo_proc,
					cd_perfil,
					cd_procedimento,
					dt_atualizacao,
					dt_atualizacao_nrec,
					ie_alterar_conta,
					ie_excluir_conta,
					ie_incluir_conta,
					ie_origem_proced,
					ie_situacao,
					ie_tipo_atendimento,
					ie_utiliza_valor_inf,
					nm_usuario,
					nm_usuario_nrec,
					nr_sequencia,
					nr_seq_etapa_filtro,
					cd_setor_atendimento)
				SELECT	cd_area_procedimento,
					cd_convenio_dest_w,
					cd_especialidade,
					cd_estabelecimento,
					cd_grupo_proc,
					cd_perfil,
					cd_procedimento,
					clock_timestamp(),
					clock_timestamp(),
					ie_alterar_conta,
					ie_excluir_conta,
					ie_incluir_conta,
					ie_origem_proced,
					ie_situacao,
					ie_tipo_atendimento,
					ie_utiliza_valor_inf,
					nm_usuario_p,
					nm_usuario_p,
					nr_seq_proc_w,
					nr_seq_etapa_filtro,
					cd_setor_atendimento
				from	conv_regra_fatur_proc
				where	nr_sequencia = nr_seq_fatur_proc_w;

			end loop;
			close c026;

	elsif (nm_tabela_p = 'CONV_REGRA_FATUR_MAT') then
			if (ie_excluir_p = 'S') then
				delete	from conv_regra_fatur_mat
				where	cd_convenio	= cd_convenio_dest_w;
			end if;

			open c027;
			loop
			fetch c027 into
				nr_seq_fatur_mat_w;
			EXIT WHEN NOT FOUND; /* apply on c027 */

				select	nextval('conv_regra_fatur_mat_seq')
				into STRICT	nr_seq_mat_w
				;


				insert into conv_regra_fatur_mat(cd_classe_material,
								cd_convenio,
								cd_estabelecimento,
								cd_grupo_material,
								cd_material,
								cd_perfil,
								cd_subgrupo_material,
								dt_atualizacao,
								dt_atualizacao_nrec,
								ie_alterar_conta,
								ie_excluir_conta,
								ie_incluir_conta,
								ie_situacao,
								ie_tipo_atendimento,
								ie_tipo_valor,
								ie_utiliza_valor_inf,
								nm_usuario,
								nm_usuario_nrec,
								nr_sequencia,
								nr_seq_etapa_filtro,
								cd_setor_atendimento,
								VL_MINIMO,
								VL_MAXIMO,              
								NM_USUARIO_FILTRO)
				SELECT	cd_classe_material,
					cd_convenio_dest_w,
					cd_estabelecimento,
					cd_grupo_material,
					cd_material,
					cd_perfil,
					cd_subgrupo_material,
					clock_timestamp(),
					clock_timestamp(),
					ie_alterar_conta,
					ie_excluir_conta,
					ie_incluir_conta,
					ie_situacao,
					ie_tipo_atendimento,
					ie_tipo_valor,
					ie_utiliza_valor_inf,
					nm_usuario_p,
					nm_usuario_p,
					nr_seq_mat_w,
					nr_seq_etapa_filtro,
					cd_setor_atendimento,
					VL_MINIMO,
					VL_MAXIMO,              
					NM_USUARIO_FILTRO
				from	CONV_REGRA_FATUR_MAT
				where	nr_sequencia = nr_seq_fatur_mat_w;

			end loop;
			close c027;
	elsif (nm_tabela_p = 'CONV_REGRA_CANCEL_CONTA') then
		if (ie_excluir_p = 'S') then
			delete	from conv_regra_cancel_conta
			where	cd_convenio	= cd_convenio_dest_w;
		end if;

		open C028;
		loop
		fetch C028 into
			nr_seq_cancel_conta_w;
		EXIT WHEN NOT FOUND; /* apply on C028 */
			begin

			select	nextval('conv_regra_cancel_conta_seq')
			into STRICT	nr_seq_cancel_conta_ww
			;

			insert into conv_regra_cancel_conta(	nr_sequencia,
								cd_estabelecimento,
								dt_atualizacao,
								nm_usuario,
								dt_atualizacao_nrec,
								nm_usuario_nrec,
								cd_convenio,
								cd_perfil,
								ie_permite_cancelar,
								ie_situacao,
								nm_usuario_regra)
			SELECT nr_seq_cancel_conta_ww,
				cd_estabelecimento,
				clock_timestamp(),
				nm_usuario_p,
				clock_timestamp(),
				nm_usuario_p,
				cd_convenio_dest_w,
				cd_perfil,
				ie_permite_cancelar,
				ie_situacao,
				nm_usuario_regra
			from	conv_regra_cancel_conta
			where	nr_sequencia = nr_seq_cancel_conta_w;


			end;
		end loop;
		close C028;

	elsif (nm_tabela_p = 'CONVEIO_ESTAB_FUNC_LIB') then
		if (ie_excluir_p = 'S') then
			delete	from conveio_estab_func_lib
			where	cd_convenio	= cd_convenio_dest_w;
		end if;

		open C029;
		loop
		fetch C029 into
			nr_seq_estab_func_lib_w;
		EXIT WHEN NOT FOUND; /* apply on C029 */
			begin

			select	 nextval('conveio_estab_func_lib_seq')
			into STRICT	nr_seq_estab_func_lib_ww
			;

			insert into conveio_estab_func_lib(	nr_sequencia,
								cd_convenio,
								cd_estabelecimento,
								dt_atualizacao,
								nm_usuario,
								dt_atualizacao_nrec,
								nm_usuario_nrec,
								cd_funcao,
								ie_permite_convenio,
								dt_inicio_regra,
								cd_perfil)
			SELECT	nr_seq_estab_func_lib_ww,
				cd_convenio_dest_w,
				cd_estabelecimento,
				clock_timestamp(),
				nm_usuario_p,
				clock_timestamp(),
				nm_usuario_p,
				cd_funcao,
				ie_permite_convenio,
				dt_inicio_regra,
				cd_perfil
			from	conveio_estab_func_lib
			where	nr_sequencia = nr_seq_estab_func_lib_w;

			end;
		end loop;
		close C029;

	elsif (nm_tabela_p = 'CONV_REGRA_TAXA_TEMPO') then
		if (ie_excluir_p = 'S') then
			delete	from conv_regra_taxa_tempo
			where	cd_convenio	= cd_convenio_dest_w;
		end if;

		open C030;
		loop
		fetch C030 into
			nr_seq_regra_taxa_tempo_w;
		EXIT WHEN NOT FOUND; /* apply on C030 */
			begin

			select	 nextval('conv_regra_taxa_tempo_seq')
			into STRICT	nr_seq_regra_taxa_tempo_ww
			;

			insert into conv_regra_taxa_tempo(	nr_sequencia,
								cd_convenio,
								dt_atualizacao,
								nm_usuario,
								dt_atualizacao_nrec,
								nm_usuario_nrec,
								ie_tipo_atendimento,
								qt_minutos_min,
								qt_tolerancia,
								cd_estabelecimento)
			SELECT	nr_seq_regra_taxa_tempo_ww,
				cd_convenio_dest_w,
				clock_timestamp(),
				nm_usuario_p,
				clock_timestamp(),
				nm_usuario_p,
				ie_tipo_atendimento,
				qt_minutos_min,
				qt_tolerancia,
				cd_estabelecimento
			from	conv_regra_taxa_tempo
			where	nr_sequencia = nr_seq_regra_taxa_tempo_w;

			end;
		end loop;
		close C030;

	elsif (nm_tabela_p = 'CONV_REGRA_LIB_ATEND') then
		if (ie_excluir_p = 'S') then
			delete	from conv_regra_lib_atend
			where	cd_convenio	= cd_convenio_dest_w;
		end if;

		open C031;
		loop
		fetch C031 into
			nr_seq_regra_lib_atend_w;
		EXIT WHEN NOT FOUND; /* apply on C031 */
			begin

			insert into conv_regra_lib_atend(	nr_sequencia,
								cd_estabelecimento,
								dt_atualizacao,
								nm_usuario,
								dt_atualizacao_nrec,
								nm_usuario_nrec,
								cd_perfil,
								cd_convenio,
								ie_tipo_atendimento,
								ie_situacao,
								ie_fecha_atendimento,
								ie_fecha_conta,
								nr_seq_etapa_filtro)
			SELECT	nextval('conv_regra_lib_atend_seq'),
				cd_estabelecimento,
				clock_timestamp(),
				nm_usuario_p,
				clock_timestamp(),
				nm_usuario_p,
				cd_perfil,
				cd_convenio_dest_w,
				ie_tipo_atendimento,
				ie_situacao,
				ie_fecha_atendimento,
				ie_fecha_conta,
				nr_seq_etapa_filtro
			from	conv_regra_lib_atend
			where	nr_sequencia = nr_seq_regra_lib_atend_w;

			end;
		end loop;
		close C031;

	elsif (nm_tabela_p	= 'REGRA_TX_PACOTE') then
		if (ie_excluir_p = 'S') then
			delete	from regra_tx_pacote
			where	cd_convenio 		= cd_convenio_dest_w;
		end if;
		open C032;
		loop
		fetch C032 into
			C032_w;
		EXIT WHEN NOT FOUND; /* apply on C032 */
			begin
			insert into regra_tx_pacote(
				nr_sequencia, cd_estabelecimento, dt_atualizacao,
				nm_usuario, dt_atualizacao_nrec, nm_usuario_nrec,
				tx_pacote_maior, tx_pacote_demais, ie_regra_geral,
				cd_convenio, TX_PACOTE_SEG_MAIOR )
			values (
				nextval('regra_tx_pacote_seq'), C032_w.cd_estabelecimento, clock_timestamp(),
				nm_usuario_p, clock_timestamp(), nm_usuario_p,
				C032_w.tx_pacote_maior, C032_w.tx_pacote_demais, C032_w.ie_regra_geral,
				cd_convenio_dest_w, C032_w.TX_PACOTE_SEG_MAIOR );
			end;
		end loop;
		close C032;

	elsif (nm_tabela_p	= 'CONV_REGRA_TX_TEMPO_SETOR') then
		if (ie_excluir_p = 'S') then
			delete	from conv_regra_tx_tempo_setor
			where	cd_convenio 		= cd_convenio_dest_w;
		end if;

		open C033;
		loop
		fetch C033 into
			C033_w;
		EXIT WHEN NOT FOUND; /* apply on C033 */
			begin
			insert into conv_regra_tx_tempo_setor(
							nr_sequencia,
							cd_convenio,
							dt_atualizacao,
							nm_usuario,
							dt_atualizacao_nrec,
							nm_usuario_nrec,
							nr_seq_proc_interno,
							cd_setor_atendimento,
							cd_procedimento,
							ie_origem_proced,
							qt_tolerancia,
							ie_situacao,
							qt_min_cobranca,
							dt_inicio_vigencia,
							dt_final_vigencia,
							cd_estabelecimento,
							cd_unidade_basica,
							cd_unidade_compl)
					values (
							nextval('conv_regra_tx_tempo_setor_seq'),
							cd_convenio_dest_w,
							clock_timestamp(),
							nm_usuario_p,
							clock_timestamp(),
							nm_usuario_p,
							C033_w.nr_seq_proc_interno,
							C033_w.cd_setor_atendimento,
							C033_w.cd_procedimento,
							C033_w.ie_origem_proced,
							C033_w.qt_tolerancia,
							C033_w.ie_situacao,
							C033_w.qt_min_cobranca,
							C033_w.dt_inicio_vigencia,
							C033_w.dt_final_vigencia,
							c033_w.cd_estabelecimento,
							c033_w.cd_unidade_basica, -- incluido
							c033_w.cd_unidade_compl);
			end;
		end loop;
		close C033;

	elsif (nm_tabela_p = 'CONV_REGRA_SEQ_CONTA') then
		if (ie_excluir_p = 'S') then
			delete	from conv_regra_seq_conta
			where	cd_convenio = cd_convenio_dest_w;
		end if;

		open C034;
		loop
		fetch C034 into
			nr_seq_regra_seq_conta_w;
		EXIT WHEN NOT FOUND; /* apply on C034 */
			begin
			insert into conv_regra_seq_conta(
				nr_sequencia, cd_convenio, cd_estabelecimento, dt_atualizacao, nm_usuario,
				dt_atualizacao_nrec, nm_usuario_nrec, nr_seq_inicial, qt_incremento,
				ie_situacao, ie_tipo_atend_conta)
			SELECT	nextval('conv_regra_seq_conta_seq'), cd_convenio_dest_w, cd_estabelecimento, clock_timestamp(),
				nm_usuario_p, clock_timestamp(), nm_usuario_p, nr_seq_inicial, qt_incremento,
				ie_situacao, ie_tipo_atend_conta
			from	conv_regra_seq_conta
			where	nr_sequencia = nr_seq_regra_seq_conta_w;
			end;
		end loop;
		close C034;

	elsif (nm_tabela_p = 'CONVENIO_REGRA_TAXA_CIR') then
		if (ie_excluir_p = 'S') then
			delete	from convenio_regra_taxa_cir
			where	cd_convenio = cd_convenio_dest_w;
		end if;

		open C036;
		loop
		fetch C036 into
			nr_seq_regra_taxa_cir_w;
		EXIT WHEN NOT FOUND; /* apply on C036 */
			begin
			insert into convenio_regra_taxa_cir(
				nr_sequencia, cd_convenio, dt_atualizacao, nm_usuario,
				dt_atualizacao_nrec, nm_usuario_nrec, nr_min_inicial, nr_min_final,
				ie_situacao, cd_procedimento, ie_origem_proced, nr_min_excesso,
				cd_proc_alternativo, ie_orig_proced_alt, ie_porte, cd_tipo_anestesia, qt_procedimento, cd_estabelecimento,
				qt_porte_inicial, qt_porte_final, nr_seq_classificacao, ie_certificate_type)
			SELECT	nextval('convenio_regra_taxa_cir_seq'), cd_convenio_dest_w, clock_timestamp(),
				nm_usuario_p, clock_timestamp(), nm_usuario_p, nr_min_inicial, nr_min_final,
				ie_situacao, cd_procedimento, ie_origem_proced, nr_min_excesso,
				cd_proc_alternativo, ie_orig_proced_alt, ie_porte, cd_tipo_anestesia, qt_procedimento, cd_estabelecimento,
				qt_porte_inicial, qt_porte_final, nr_seq_classificacao,ie_certificate_type
			from	convenio_regra_taxa_cir
			where	nr_sequencia = nr_seq_regra_taxa_cir_w;
			end;
		end loop;
		close C036;

	elsif (nm_tabela_p = 'CONV_REGRA_PACOTE') then
		if (ie_excluir_p = 'S') then
			delete	from conv_regra_pacote_criterio a
			where	a.nr_seq_regra_pacote = (	SELECT	b.nr_sequencia
								from	conv_regra_pacote b
								where	b.nr_sequencia = a.nr_seq_regra_pacote
								and	b.cd_convenio = cd_convenio_dest_w);
			delete	from conv_regra_pacote
			where	cd_convenio = cd_convenio_dest_w;
		end if;

		open C035;
		loop
		fetch C035 into
			nr_seq_regra_pacote_w;
		EXIT WHEN NOT FOUND; /* apply on C035 */
			begin
			select 	nextval('conv_regra_pacote_seq')
			into STRICT	nr_sequencia_w
			;

			insert into conv_regra_pacote(nr_sequencia, cd_convenio, dt_atualizacao, nm_usuario, dt_atualizacao_nrec,
				nm_usuario_nrec, cd_procedimento, ie_origem_proced)
			SELECT	nr_sequencia_w, cd_convenio_dest_w, clock_timestamp(), nm_usuario_p, clock_timestamp(),
				nm_usuario_p, cd_procedimento, ie_origem_proced
			from	conv_regra_pacote
			where	nr_sequencia = nr_seq_regra_pacote_w;

			insert into conv_regra_pacote_criterio(nr_sequencia, nr_seq_regra_pacote, dt_atualizacao, nm_usuario,
				dt_atualizacao_nrec, nm_usuario_nrec, cd_procedimento, ie_origem_proced)
			SELECT	nextval('conv_regra_pacote_criterio_seq'), nr_sequencia_w, clock_timestamp(), nm_usuario_p,
				clock_timestamp(), nm_usuario_p, cd_procedimento, ie_origem_proced
			from	conv_regra_pacote_criterio
			where	nr_seq_regra_pacote = nr_seq_regra_pacote_w;
			end;
		end loop;
		close C035;
	elsif (nm_tabela_p = 'CONV_AJUSTE_PORTE_CBHPM') then
		if (ie_excluir_p = 'S') then
			delete	from CONV_AJUSTE_PORTE_CBHPM
			where	cd_convenio = cd_convenio_dest_w;
		end if;

		open C037;
		loop
		fetch C037 into
			nr_seq_porte_cbhpm_w;
		EXIT WHEN NOT FOUND; /* apply on C037 */
			begin
			insert into 	conv_ajuste_porte_cbhpm(
					cd_area_procedimento,cd_convenio,cd_especialidade,
					cd_grupo_proc,cd_porte,cd_procedimento,dt_atualizacao,
					dt_atualizacao_nrec,dt_vigencia,ie_origem_proced,ie_tipo_ajuste,
					ie_video,nm_usuario,nm_usuario_nrec,nr_sequencia,tx_ajuste,vl_porte_negociado,
					ie_credenciado, cd_estabelecimento, dt_vigencia_final)
				SELECT	cd_area_procedimento,cd_convenio_dest_w,cd_especialidade,
					cd_grupo_proc,cd_porte,cd_procedimento,dt_atualizacao,
					dt_atualizacao_nrec,dt_vigencia,ie_origem_proced,ie_tipo_ajuste,
					ie_video,nm_usuario,nm_usuario_nrec,nextval('conv_ajuste_porte_cbhpm_seq'),tx_ajuste,vl_porte_negociado,
					ie_credenciado, cd_estabelecimento, dt_vigencia_final
				from	conv_ajuste_porte_cbhpm
				where	nr_sequencia = nr_seq_porte_cbhpm_w;
			end;
		end loop;
		close C037;
	elsif (nm_tabela_p = 'CONV_REGRA_ATEND_SETOR') then
		if (ie_excluir_p = 'S') then
			delete	from conv_regra_atend_setor
			where	cd_convenio = cd_convenio_dest_w;
		end if;

		open C038;
		loop
		fetch C038 into
			nr_seq_conv_regra_setor_w;
		EXIT WHEN NOT FOUND; /* apply on C038 */
			begin
			insert into 	conv_regra_atend_setor(
					nr_sequencia,cd_estabelecimento,dt_atualizacao,nm_usuario,dt_atualizacao_nrec,nm_usuario_nrec,
 					cd_convenio,ie_tipo_atendimento,ie_libera_bloqueia,cd_setor_atendimento,
 					ie_situacao,ds_mensagem,nr_seq_classificacao,ie_clinica,cd_empresa,cd_procedencia,
 					nr_seq_cobertura,nr_seq_tipo_acidente,cd_tipo_acomodacao,cd_medico,qt_idade_min,qt_idade_max,nm_usuario_filtro,
					ie_tipo_convenio,nr_seq_queixa,dt_final_vigencia,dt_inicio_vigencia,cd_especialidade_medica, cd_pessoa_fisica)
				SELECT	nextval('conv_regra_atend_setor_seq'),cd_estabelecimento,clock_timestamp(),nm_usuario_p,clock_timestamp(),nm_usuario_p,
 					cd_convenio_dest_w,ie_tipo_atendimento,ie_libera_bloqueia,cd_setor_atendimento,
 					ie_situacao,ds_mensagem,nr_seq_classificacao,ie_clinica,cd_empresa,cd_procedencia,
 					nr_seq_cobertura,nr_seq_tipo_acidente,cd_tipo_acomodacao,cd_medico,qt_idade_min,qt_idade_max,nm_usuario_filtro,
					ie_tipo_convenio,nr_seq_queixa,dt_final_vigencia,dt_inicio_vigencia,cd_especialidade_medica, cd_pessoa_fisica
				from	conv_regra_atend_setor
				where	nr_sequencia = nr_seq_conv_regra_setor_w;
			end;
		end loop;
		close C038;

	elsif (nm_tabela_p = 'TISS_REGRA_TIPO_PROC') then
		if (ie_excluir_p = 'S') then
				delete	from tiss_regra_tipo_proc
				where	cd_convenio = cd_convenio_dest_w;
			end if;

			open c039;
			loop
			fetch c039 into
				nr_seq_tiss_regra_tipo_proc_w;
			EXIT WHEN NOT FOUND; /* apply on c039 */

				select	nextval('tiss_regra_tipo_proc_seq')
				into STRICT	nr_seq_tiss_w
				;

				insert into tiss_regra_tipo_proc(
					nr_sequencia, cd_estabelecimento, dt_atualizacao, nm_usuario, dt_atualizacao_nrec,
					nm_usuario_nrec, cd_convenio, cd_procedimento, ie_origem_proced,
					cd_area_procedimento, cd_especialidade, cd_grupo_proc, ie_tipo_desp)
				SELECT	nr_seq_tiss_w, cd_estabelecimento, clock_timestamp(), nm_usuario_p,
					dt_atualizacao_nrec, nm_usuario_nrec, cd_convenio_dest_w,
					cd_procedimento, ie_origem_proced, cd_area_procedimento,
					cd_especialidade, cd_grupo_proc, ie_tipo_desp
				from	tiss_regra_tipo_proc
				where	nr_sequencia	= nr_seq_tiss_regra_tipo_proc_w;

			end loop;
			close c039;

	elsif (nm_tabela_p = 'REGRA_PROT_TIPO_ATEND') then
		if (ie_excluir_p = 'S') then
				delete	from regra_prot_tipo_atend
				where	cd_convenio = cd_convenio_dest_w;
			end if;

			open c040;
			loop
			fetch c040 into
				nr_seq_regra_prot_tipo_atend_w;
			EXIT WHEN NOT FOUND; /* apply on c040 */

				select	nextval('regra_prot_tipo_atend_seq')
				into STRICT	nr_seq_tipo_atend_w
				;

				insert into regra_prot_tipo_atend(
					nr_sequencia, dt_atualizacao, nm_usuario, dt_atualizacao_nrec, nm_usuario_nrec,
					cd_convenio, ie_tipo_protocolo, ie_tipo_atendimento, cd_setor_atendimento,
					cd_procedencia, ie_regime_internacao, nm_usuario_regra, cd_perfil, cd_estabelecimento, ie_util_tipo_atend_conta)
				SELECT  nr_seq_tipo_atend_w,clock_timestamp(), nm_usuario_p, clock_timestamp(), nm_usuario_p,
					cd_convenio_dest_w, ie_tipo_protocolo, ie_tipo_atendimento, cd_setor_atendimento,
					cd_procedencia, ie_regime_internacao, nm_usuario_regra, cd_perfil, cd_estabelecimento, ie_util_tipo_atend_conta
				from 	regra_prot_tipo_atend
				where nr_Sequencia = nr_seq_regra_prot_tipo_atend_w;

			end loop;
			close c040;

	elsif (nm_tabela_p = 'CONVENIO_COBERTURA') then

		if (ie_excluir_p = 'S') then
			delete from convenio_cobertura
			where	cd_convenio = cd_convenio_dest_w;
		end if;

		insert into convenio_cobertura(
			nr_sequencia,
			cd_convenio,
			dt_atualizacao,
			nm_usuario,
			dt_atualizacao_nrec,
			nm_usuario_nrec,
			ds_cobertura,
			ie_situacao,
			cd_estabelecimento)
		SELECT	nextval('convenio_cobertura_seq'),
			cd_convenio_dest_w,
			clock_timestamp(),
			nm_usuario,
			clock_timestamp(),
			nm_usuario_nrec,
			ds_cobertura,
			ie_situacao,
			cd_estabelecimento
		from	convenio_cobertura
		where	cd_convenio = cd_convenio_orig_p;

	elsif (nm_tabela_p = 'TISS_REGRA_CAMPO_ESP') then

		if (ie_excluir_p = 'S') then
			delete	from tiss_regra_campo_esp
			where	cd_convenio = cd_convenio_dest_w;

		end if;

		open C041;
		loop
		fetch C041 into
			nr_seq_tiss_regra_campo_esp_w;
		EXIT WHEN NOT FOUND; /* apply on C041 */

			select	nextval('tiss_regra_campo_esp_seq')
			into STRICT	nr_seq_regra_campo_esp_w
			;

			insert	into tiss_regra_campo_esp(nr_sequencia,cd_estabelecimento,dt_atualizacao,nm_usuario,dt_atualizacao_nrec,nm_usuario_nrec,
				cd_convenio,ds_campo,cd_procedimento,ie_origem_proced,cd_area_procedimento,cd_especialidade,
				cd_grupo_proc,ie_guia,ie_tipo_guia,ie_tipo_atendimento,cd_cgc_prestador,ie_responsavel_credito,
				cd_medico_executor, cd_setor_atendimento)
			SELECT	nr_seq_regra_campo_esp_w,cd_estabelecimento,clock_timestamp(),nm_usuario_p,clock_timestamp(),nm_usuario_p,
				cd_convenio_dest_w,ds_campo,cd_procedimento,ie_origem_proced,cd_area_procedimento,cd_especialidade,
				cd_grupo_proc,ie_guia,ie_tipo_guia,ie_tipo_atendimento,cd_cgc_prestador,ie_responsavel_credito,cd_medico_executor, cd_setor_atendimento
			from	tiss_regra_campo_esp
			where	nr_sequencia	= nr_seq_tiss_regra_campo_esp_w;

			open C042;
			loop
			fetch C042 into
				nr_seq_tiss_campo_esp_compl_w;
			EXIT WHEN NOT FOUND; /* apply on C042 */

				select	nextval('tiss_campo_esp_compl_seq')
				into STRICT	nr_seq_campo_esp_compl_w
				;

				insert into tiss_campo_esp_compl(nr_sequencia,dt_atualizacao,nm_usuario,dt_atualizacao_nrec,nm_usuario_nrec,nr_seq_regra,
					ds_campo,ds_anterior,ds_posterior,nr_seq_apresentacao,vl_padrao)
				SELECT	nr_seq_campo_esp_compl_w,clock_timestamp(),nm_usuario_p,clock_timestamp(),nm_usuario_p,nr_seq_regra_campo_esp_w,
					ds_campo,ds_anterior,ds_posterior,nr_seq_apresentacao,vl_padrao
				from	tiss_campo_esp_compl
				where	nr_sequencia	= nr_seq_tiss_campo_esp_compl_w;


			end loop;
			close C042;

			open C043;
			loop
			fetch C043 into
				nr_seq_tiss_campo_esp_conv_w;
			EXIT WHEN NOT FOUND; /* apply on C043 */

				select	nextval('tiss_campo_esp_conv_seq')
				into STRICT	nr_seq_campo_esp_conv_w
				;

				insert	into tiss_campo_esp_conv(nr_sequencia,dt_atualizacao,nm_usuario,dt_atualizacao_nrec,
					nm_usuario_nrec,nr_seq_regra,ds_campo,vl_origem,vl_conversao)
				SELECT	nr_seq_campo_esp_conv_w,clock_timestamp(),nm_usuario_p,clock_timestamp(),
					nm_usuario_p,nr_seq_regra_campo_esp_w,ds_campo,vl_origem,vl_conversao
				from	tiss_campo_esp_conv
				where	nr_sequencia	= nr_seq_tiss_campo_esp_conv_w;

			end loop;
			close C043;

		end loop;
		close C041;
	elsif (nm_tabela_p = 'TISS_REGRA_PREST_EQUIPE') then

		if (ie_excluir_p = 'S') then

			delete 	from TISS_REGRA_PREST_EQUIPE
			where	cd_convenio = cd_convenio_dest_w;

		end if;

		insert	into tiss_regra_prest_equipe(
			cd_cgc_prestador,
			cd_convenio,
			cd_estabelecimento,
			cd_setor_atendimento,
			dt_atualizacao,
			dt_atualizacao_nrec,
			ie_grau_partic,
			ie_responsavel_credito,
			ie_tiss_tipo_guia,
			nm_usuario,
			nm_usuario_nrec,
			nr_conselho,
			nr_sequencia,
			sg_conselho,
			uf_conselho)
		SELECT	cd_cgc_prestador,
			cd_convenio_dest_w,
			cd_estabelecimento,
			cd_setor_atendimento,
			clock_timestamp(),
			clock_timestamp(),
			ie_grau_partic,
			ie_responsavel_credito,
			ie_tiss_tipo_guia,
			nm_usuario_p,
			nm_usuario_p,
			nr_conselho,
			nextval('tiss_regra_prest_equipe_seq'),
			sg_conselho,
			uf_conselho
		from	tiss_regra_prest_equipe
		where	cd_convenio		= cd_convenio_orig_p;

	elsif (nm_tabela_p = 'TISS_REGRA_PARTIC_ADIC') then

		if (ie_excluir_p = 'S') then
			delete from TISS_REGRA_PARTIC_ADIC
			where	cd_convenio = cd_convenio_dest_w;
		end if;

		open C044;
		loop
		fetch C044 into
			nr_seq_w;
		EXIT WHEN NOT FOUND; /* apply on C044 */
			begin

			select	nextval('tiss_regra_partic_adic_seq')
			into STRICT	nr_sequencia_w
			;

			insert into tiss_regra_partic_adic(
				cd_area_procedimento,
				cd_convenio,
				cd_especialidade,
				cd_estabelecimento,
				cd_grupo_proc,
				cd_procedimento,
				dt_atualizacao,
				dt_atualizacao_nrec,
				ie_origem_proced,
				ie_responsavel_credito,
				ie_tiss_tipo_guia,
				nm_usuario,
				nm_usuario_nrec,
				nr_sequencia)
			SELECT	cd_area_procedimento,
				cd_convenio_dest_w,
				cd_especialidade,
				cd_estabelecimento,
				cd_grupo_proc,
				cd_procedimento,
				clock_timestamp(),
				clock_timestamp(),
				ie_origem_proced,
				ie_responsavel_credito,
				ie_tiss_tipo_guia,
				nm_usuario_p,
				nm_usuario_p,
				nr_sequencia_w
			from	tiss_regra_partic_adic
			where	nr_sequencia = nr_seq_w;


			insert into	tiss_partic_adic(
				cd_cbos,
				cd_interno,
				dt_atualizacao,
				dt_atualizacao_nrec,
				ie_funcao,
				ie_medico_atend,
				nm_participante,
				nm_usuario,
				nm_usuario_nrec,
				nr_cpf,
				nr_crm,
				nr_seq_regra,
				nr_sequencia,
				sg_conselho,
				uf_crm)
			SELECT	cd_cbos,
				cd_interno,
				dt_atualizacao,
				dt_atualizacao_nrec,
				ie_funcao,
				ie_medico_atend,
				nm_participante,
				nm_usuario_p,
				nm_usuario_p,
				nr_cpf,
				nr_crm,
				nr_sequencia_w,
				nextval('tiss_partic_adic_seq'),
				sg_conselho,
				uf_crm
			from	tiss_partic_adic
			where	nr_seq_regra = nr_seq_w;

			end;
		end loop;
		close C044;
	elsif (nm_tabela_p = 'TISS_REGRA_ARQUIVO_ADIC') then

		if (ie_excluir_p = 'S') then
			delete from TISS_REGRA_ARQUIVO_ADIC
			where	cd_convenio = cd_convenio_dest_w;
		end if;

		open C045;
		loop
		fetch C045 into
			nr_seq_w;
		EXIT WHEN NOT FOUND; /* apply on C045 */
			begin

			select	nextval('tiss_regra_arquivo_adic_seq')
			into STRICT	nr_sequencia_w
			;

			insert into tiss_regra_arquivo_adic(
				cd_cgc,
				cd_convenio,
				cd_estabelecimento,
				cd_interno,
				dt_atualizacao,
				dt_atualizacao_nrec,
				ie_tiss_tipo_guia,
				nm_usuario,
				nm_usuario_nrec,
				nr_sequencia)
			SELECT	cd_cgc,
				cd_convenio_dest_w,
				cd_estabelecimento,
				cd_interno,
				clock_timestamp(),
				clock_timestamp(),
				ie_tiss_tipo_guia,
				nm_usuario_p,
				nm_usuario_p,
				nr_sequencia_w
			from	tiss_regra_arquivo_adic
			where	nr_sequencia = nr_seq_w;


			insert 	into tiss_regra_arq_adic_crit(
				cd_cgc,
				cd_cgc_compl,
				cd_interno,
				cd_interno_compl,
				cd_interno_honor,
				dt_atualizacao,
				dt_atualizacao_nrec,
				nm_usuario,
				nm_usuario_nrec,
				nr_cpf_honor,
				nr_seq_regra,
				nr_sequencia)
			SELECT	cd_cgc,
				cd_cgc_compl,
				cd_interno,
				cd_interno_compl,
				cd_interno_honor,
				clock_timestamp(),
				clock_timestamp(),
				nm_usuario_p,
				nm_usuario_p,
				nr_cpf_honor,
				nr_sequencia_w,
				nextval('tiss_regra_arq_adic_crit_seq')
			from	tiss_regra_arq_adic_crit
			where	nr_seq_regra =  nr_seq_w;

			end;
		end loop;
		close C045;
	elsif (nm_tabela_p = 'TISS_REGRA_AGRUP') then

		if (ie_excluir_p = 'S') then
			delete from TISS_REGRA_AGRUP
			where cd_convenio = cd_convenio_dest_w;
		end if;

		insert into  tiss_regra_agrup(
			cd_area_procedimento,
			cd_convenio,
			cd_especialidade,
			cd_estabelecimento,
			cd_grupo_proc,
			cd_procedimento,
			dt_atualizacao,
			dt_atualizacao_nrec,
			ie_agrupar,
			ie_origem_proced,
			nm_usuario,
			nm_usuario_nrec,
			nr_sequencia)
		SELECT	cd_area_procedimento,
			cd_convenio_dest_w,
			cd_especialidade,
			cd_estabelecimento,
			cd_grupo_proc,
			cd_procedimento,
			clock_timestamp(),
			clock_timestamp(),
			ie_agrupar,
			ie_origem_proced ,
			nm_usuario_p,
			nm_usuario_p,
			nextval('tiss_regra_agrup_seq')
		from	tiss_regra_agrup
		where	cd_convenio		= cd_convenio_orig_p;


	elsif (nm_tabela_p = 'TISS_REGRA_PROC_XML') then

		if (ie_excluir_p = 'S') then

			delete from TISS_REGRA_PROC_XML
			where	cd_convenio = cd_convenio_dest_w;

		end if;

		insert into tiss_regra_proc_xml(
			cd_area_procedimento,
			cd_convenio,
			cd_especialidade,
			cd_estabelecimento,
			cd_grupo_proc,
			cd_procedimento,
			dt_atualizacao,
			dt_atualizacao_nrec,
			ie_enviar_xml,
			ie_origem_proced,
			ie_responsavel_credito,
			ie_tiss_tipo_guia,
			nm_usuario,
			nm_usuario_nrec,
			nr_sequencia)
		SELECT	cd_area_procedimento,
			cd_convenio_dest_w,
			cd_especialidade,
			cd_estabelecimento,
			cd_grupo_proc,
			cd_procedimento,
			clock_timestamp(),
			clock_timestamp(),
			ie_enviar_xml,
			ie_origem_proced,
			ie_responsavel_credito,
			ie_tiss_tipo_guia,
			nm_usuario_p,
			nm_usuario_p,
			nextval('tiss_regra_proc_xml_seq')
		from	tiss_regra_proc_xml
		where	cd_convenio		= cd_convenio_orig_p;

	elsif (nm_tabela_p = 'CONV_REGRA_CALCULO_CONTA') then

		if (ie_excluir_p = 'S') then
			delete from CONV_REGRA_CALCULO_CONTA
			where	cd_convenio = cd_convenio_dest_w;
		end if;

		insert into conv_regra_calculo_conta(
			nr_sequencia,
			cd_estabelecimento,
			cd_convenio,
			dt_atualizacao,
			nm_usuario,
			dt_atualizacao_nrec,
			nm_usuario_nrec,
			cd_proc_coseg_honor,
			ie_orig_coseg_honor,
			cd_proc_coseg_hosp,
			ie_orig_coseg_hosp,
			cd_proc_deduzido,
			ie_orig_proc_deduzido,
			dt_inicio_vigencia,
			dt_final_vigencia,
			ie_imposto_total_conta,
			ie_imposto_deduzido,
			ie_considera_valor_bruto,
			vl_desconto_deduzido,
			cd_tributo,
			ie_situacao,
			cd_proc_calculo,
			ie_orig_proc_calculo,
			ds_calculo,
			ie_tipo_calculo,
			nm_regra,
			ds_regra,
			pr_imposto)
		SELECT	nextval('conv_regra_calculo_conta_seq'),
			cd_estabelecimento,
			cd_convenio_dest_w,
			clock_timestamp(),
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			cd_proc_coseg_honor,
			ie_orig_coseg_honor,
			cd_proc_coseg_hosp,
			ie_orig_coseg_hosp,
			cd_proc_deduzido,
			ie_orig_proc_deduzido,
			dt_inicio_vigencia,
			dt_final_vigencia,
			ie_imposto_total_conta,
			ie_imposto_deduzido,
			ie_considera_valor_bruto,
			vl_desconto_deduzido,
			cd_tributo,
			ie_situacao,
			cd_proc_calculo,
			ie_orig_proc_calculo,
			ds_calculo,
			ie_tipo_calculo,
			nm_regra,
			ds_regra,
			pr_imposto
		from	conv_regra_calculo_conta
		where	cd_convenio = cd_convenio_orig_p;
		
	elsif (nm_tabela_p = 'AGENDA_REGRA') then
		if (ie_excluir_p = 'S') then
			delete	from agenda_regra
			where	cd_convenio		= cd_convenio_dest_w
			and	cd_estabelecimento	= cd_estabelecimento_p;
		end if;

		open c047;
		loop
		fetch c047 into
			nr_seq_agenda_regra_w;
		EXIT WHEN NOT FOUND; /* apply on c047 */

			select	nextval('agenda_regra_seq')
			into STRICT	nr_seq_next_agenda_regra_w
			;

			insert into agenda_regra(
				nr_sequencia,
				cd_estabelecimento, 
				cd_agenda, 
				dt_atualizacao, 
				nm_usuario, 
				ie_permite, 
				cd_convenio, 
				cd_area_proc, 
				cd_especialidade, 
				cd_grupo_proc, 
				cd_procedimento, 
				ie_origem_proced, 
				cd_medico, 
				dt_atualizacao_nrec, 
				nm_usuario_nrec, 
				nr_seq_proc_interno, 
				nr_seq_regra, 
				nr_seq_grupo, 
				nr_seq_subgrupo, 
				nr_seq_forma_org, 
				cd_plano_convenio,
				ie_agenda)
			SELECT	nr_seq_next_agenda_regra_w, 
				cd_estabelecimento_p, 
				cd_agenda, 
				dt_atualizacao, 
				nm_usuario_p, 
				ie_permite, 
				cd_convenio_dest_w, 
				cd_area_proc, 
				cd_especialidade, 
				cd_grupo_proc, 
				cd_procedimento, 
				ie_origem_proced, 
				cd_medico, 
				dt_atualizacao_nrec, 
				nm_usuario_nrec, 
				nr_seq_proc_interno, 
				nr_seq_regra, 
				nr_seq_grupo, 
				nr_seq_subgrupo, 
				nr_seq_forma_org, 
				cd_plano_convenio, 
				ie_agenda
			from	agenda_regra
			where	nr_sequencia	= nr_seq_agenda_regra_w;
			
			if (nr_seq_agenda_regra_w IS NOT NULL AND nr_seq_agenda_regra_w::text <> '') and (nr_seq_next_agenda_regra_w IS NOT NULL AND nr_seq_next_agenda_regra_w::text <> '') then
				CALL ageint_gerar_info_tabela('AGENDA_REGRA_PROC', nr_seq_agenda_regra_w, nr_seq_next_agenda_regra_w);
			end if;
		end loop;
		close c047;	
	end if;

	end if;
	end;
end loop;
close c000;
commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE copia_parametro_convenio ( cd_convenio_orig_p bigint, cd_convenio_dest_p text, ie_tipo_acao_p text, nm_tabela_p text, nm_usuario_p text, ie_excluir_p text, cd_estabelecimento_p bigint) FROM PUBLIC;

