-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE recalcular_esforco_gap ( nr_seq_gap_p bigint) AS $body$
DECLARE



vl_base_w				bigint;
qt_result_horas_w		latam_gap_regra_esf.qt_horas_regra%type;


BEGIN

vl_base_w := latam_obter_dados_gap(nr_seq_gap_p, 'TG');

select	sum(qt_horas_regra)
into STRICT	qt_result_horas_w
from 	latam_gap_regra_esf
where	nr_seq_gap = nr_seq_gap_p;

update	latam_gap
set	qt_horas_total = qt_result_horas_w + vl_base_w
where	nr_sequencia = nr_seq_gap_p;

commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE recalcular_esforco_gap ( nr_seq_gap_p bigint) FROM PUBLIC;

