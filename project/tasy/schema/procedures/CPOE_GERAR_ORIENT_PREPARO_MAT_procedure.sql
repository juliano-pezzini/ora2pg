-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE cpoe_gerar_orient_preparo_mat (nr_sequencia_cpoe_p bigint, ds_orientacao_preparo_out_p INOUT text, qt_vel_infusao_out_p INOUT bigint, ie_tipo_dosagem_out_p INOUT cpoe_material.ie_tipo_dosagem%type, qt_min_aplic_med_out_p INOUT text) AS $body$
DECLARE



c01 CURSOR FOR
SELECT 	a.*
from	cpoe_material a
where	nr_sequencia = nr_sequencia_cpoe_p;

BEGIN

if (nr_sequencia_cpoe_p IS NOT NULL AND nr_sequencia_cpoe_p::text <> '') then
	for mat in c01 loop
		
		SELECT * FROM cpoe_gerar_orientacao_preparo(mat.nr_atendimento, mat.cd_pessoa_fisica, mat.nm_usuario, mat.ie_controle_tempo, mat.ie_via_aplicacao, mat.cd_intervalo, mat.nr_etapas, mat.ie_administracao, /*(P,N,C)(Conforme 1 Horario,Se necessario,A criterio medico)*/
			mat.hr_prim_horario, mat.ds_horarios, /*Medicamento*/

			mat.qt_solucao, mat.qt_solucao_total, mat.hr_min_aplicacao, /*Solucao*/

			mat.ie_tipo_solucao, mat.qt_tempo_aplicacao, mat.ie_bomba_infusao, mat.ie_ref_calculo, mat.ie_fator_correcao, mat.qt_dosagem, mat.qt_dosagem_diferenciada, mat.qt_hora_fase, mat.qt_hora_fase_diferenciada, upper(mat.ie_tipo_dosagem), mat.qt_volume, mat.ds_volume_diferenciado, mat.cd_material, mat.qt_dose, mat.ds_dose_diferenciada, mat.cd_unidade_medida, mat.nr_seq_mat_reconst, mat.cd_mat_recons, mat.qt_dose_recons, mat.ds_dose_diferenciada_rec, mat.cd_unid_med_dose_recons, mat.nr_seq_mat_diluicao, mat.cd_mat_dil, mat.qt_dose_dil, mat.qt_solucao_dil, mat.ds_dose_diferenciada_dil, mat.cd_unid_med_dose_dil, mat.nr_seq_mat_rediluicao, mat.cd_mat_red, mat.qt_dose_red, mat.ds_dose_diferenciada_red, mat.cd_unid_med_dose_red, mat.qt_solucao_red, mat.cd_mat_comp1, mat.qt_dose_comp1, mat.ds_dose_diferenciada_comp1, mat.cd_unid_med_dose_comp1, mat.cd_mat_comp2, mat.qt_dose_comp2, mat.ds_dose_diferenciada_comp2, mat.cd_unid_med_dose_comp2, mat.cd_mat_comp3, mat.qt_dose_comp3, mat.ds_dose_diferenciada_comp3, mat.cd_unid_med_dose_comp3, mat.cd_mat_comp4, mat.qt_dose_comp4, mat.ds_dose_diferenciada_comp4, mat.cd_unid_med_dose_comp4, mat.cd_mat_comp5, mat.qt_dose_comp5, mat.ds_dose_diferenciada_comp5, mat.cd_unid_med_dose_comp5, mat.cd_mat_comp6, mat.qt_dose_comp6, mat.ds_dose_diferenciada_comp6, mat.cd_unid_med_dose_comp6, mat.cd_mat_comp7, mat.qt_dose_comp7, mat.ds_dose_diferenciada_comp7, mat.cd_unid_med_dose_comp7, mat.qt_vel_inf_glicose, null) INTO STRICT ds_orientacao_preparo_out_p, qt_vel_infusao_out_p, ie_tipo_dosagem_out_p, qt_min_aplic_med_out_p;
			
	end loop;
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE cpoe_gerar_orient_preparo_mat (nr_sequencia_cpoe_p bigint, ds_orientacao_preparo_out_p INOUT text, qt_vel_infusao_out_p INOUT bigint, ie_tipo_dosagem_out_p INOUT cpoe_material.ie_tipo_dosagem%type, qt_min_aplic_med_out_p INOUT text) FROM PUBLIC;

