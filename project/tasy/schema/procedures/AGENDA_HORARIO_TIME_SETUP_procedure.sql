-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE agenda_horario_time_setup () AS $body$
DECLARE

    dt_final_w     timestamp;
    dt_initial_w   timestamp;
    c01 CURSOR FOR
    SELECT
        *
    from
        agenda_horario
    where
        hr_inicial > hr_final;
BEGIN
    for r_c01 in c01 loop begin
        dt_final_w := to_date(to_char(clock_timestamp(), 'dd/mm/yyyy')
                              || ' '
                              || to_char(r_c01.hr_final, 'hh24:mi:ss'), 'dd/mm/yyyy hh24:mi:ss');

        dt_initial_w := to_date(to_char(clock_timestamp(), 'dd/mm/yyyy')
                                || ' '
                                || to_char(r_c01.hr_inicial, 'hh24:mi:ss'), 'dd/mm/yyyy hh24:mi:ss');

        update agenda_horario
        set
            hr_final = dt_final_w,
            hr_inicial = dt_initial_w
        where
            nr_sequencia = r_c01.nr_sequencia;

    end;
    end loop;

    commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE agenda_horario_time_setup () FROM PUBLIC;

