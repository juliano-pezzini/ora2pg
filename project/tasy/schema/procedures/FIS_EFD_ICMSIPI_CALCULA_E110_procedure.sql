-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE fis_efd_icmsipi_calcula_e110 (vl_tot_debitos_p bigint, vl_aj_debitos_p bigint, vl_tot_aj_debitos_p bigint, vl_estornos_cred_p bigint, vl_tot_creditos_p bigint, vl_aj_creditos_p bigint, vl_tot_aj_creditos_p bigint, vl_estornos_deb_p bigint, vl_sld_credor_ant_p bigint, vl_sld_apurado_p INOUT bigint, vl_sld_credor_transportar_p INOUT bigint, vl_icms_recolher_p INOUT bigint) AS $body$
DECLARE

  vl_sld_apurado_w            double precision := 0;
  vl_sld_credor_transportar_w double precision := 0;
  vl_icms_recolher_w          double precision := 0;

BEGIN

  --Saldo apurado
  vl_sld_apurado_w := coalesce((vl_tot_debitos_p +
                      (vl_aj_debitos_p + vl_tot_aj_debitos_p +
                      vl_estornos_cred_p)) -
                      (vl_tot_creditos_p +
                      (vl_aj_creditos_p + vl_tot_aj_creditos_p) +
                      vl_estornos_deb_p + vl_sld_credor_ant_p),0);

  if (vl_sld_apurado_w >= 0) then
    vl_sld_credor_transportar_w := 0;
  else
    vl_sld_credor_transportar_w := abs(vl_sld_apurado_w);
	vl_sld_apurado_w			:= 0;
  end if;

  /*vl_icms_recolher_w*/

  vl_icms_recolher_w := vl_sld_apurado_w - vl_tot_debitos_p;
  if (vl_icms_recolher_w < 0) then
    vl_icms_recolher_w          := 0;
    vl_sld_credor_transportar_w := abs(vl_sld_credor_transportar_w);
  end if;

  /**/

  vl_sld_apurado_p            := coalesce(vl_sld_apurado_w,0);
  vl_sld_credor_transportar_p := coalesce(vl_sld_credor_transportar_w,0);
  vl_icms_recolher_p          := coalesce(vl_icms_recolher_w,0);

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE fis_efd_icmsipi_calcula_e110 (vl_tot_debitos_p bigint, vl_aj_debitos_p bigint, vl_tot_aj_debitos_p bigint, vl_estornos_cred_p bigint, vl_tot_creditos_p bigint, vl_aj_creditos_p bigint, vl_tot_aj_creditos_p bigint, vl_estornos_deb_p bigint, vl_sld_credor_ant_p bigint, vl_sld_apurado_p INOUT bigint, vl_sld_credor_transportar_p INOUT bigint, vl_icms_recolher_p INOUT bigint) FROM PUBLIC;

