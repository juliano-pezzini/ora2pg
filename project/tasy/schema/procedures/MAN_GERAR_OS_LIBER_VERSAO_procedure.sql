-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE man_gerar_os_liber_versao (nr_sequencia_p INOUT bigint, nm_usuario_p text) AS $body$
DECLARE

 
ds_dano_w			varchar(4000);
ds_dano_breve_w			varchar(80);
cd_pessoa_solicitante_w		varchar(10);


BEGIN 
 
select	nextval('man_ordem_servico_seq'), 
	substr(obter_pessoa_fisica_usuario(nm_usuario_p,'C'),1,10) 
into STRICT	nr_sequencia_p, 
	cd_pessoa_solicitante_w
;
 
ds_dano_breve_w	:=	'Liberação de versão extra';
 
ds_dano_w	:= 	obter_desc_expressao(781052);/*'Solicito a liberação de uma versão extra à gerencia de suporte da Philips Clinical Informatics.' || chr(13) || chr(10) || 
				'Me comprometo em atualizar apenas a base de testes para validação de alterações solicitadas por mim no sistema.' || chr(13) || chr(10) || 
				'Estou ciente dos riscos que colocarei a aplicação caso a versão seja atualizada em base de produção por se tratar de uma versão não homologada pela Philips Clinical Informatics.';*/
 
insert	into man_ordem_servico( 
	nr_sequencia, 
	cd_pessoa_solicitante, 
	dt_ordem_servico, 
	ie_prioridade, 
	ie_parado, 
	ds_dano_breve, 
	dt_atualizacao, 
	nm_usuario, 
	dt_inicio_desejado, 
	dt_conclusao_desejada, 
	ds_dano, 
	dt_inicio_previsto, 
	dt_fim_previsto, 
	dt_inicio_real, 
	dt_fim_real, 
	ie_tipo_ordem, 
	ie_status_ordem, 
	nm_usuario_exec, 
	cd_funcao, 
	ie_forma_receb, 
	nm_usuario_nrec, 
	ie_origem_os, 
	ie_classificacao) 
values(	nr_sequencia_p,				-- nr_sequencia, 
	cd_pessoa_solicitante_w,		-- cd_pessoa_solicitante, 
	clock_timestamp(),				-- dt_ordem_servico, 
	'M',					-- ie_prioridade, 
	'N',					-- ie_parado, 
	substr(ds_dano_breve_w,1,80),		-- ds_dano_breve, 
	clock_timestamp(),				-- dt_atualizacao, 
	nm_usuario_p,				-- nm_usuario, 
	clock_timestamp(),				-- dt_inicio_desejado, 
	(clock_timestamp() + interval '15 days'),				-- dt_conclusao_desejada, 
	ds_dano_w,				-- ds_dano, 
	clock_timestamp(),				-- dt_inicio_previsto, 
	(clock_timestamp() + interval '15 days'),				-- dt_fim_previsto, 
	clock_timestamp(),				-- dt_inicio_real, 
	null,					-- dt_fim_real, 
	'10',					-- ie_tipo_ordem, 
	'1',					-- ie_status_ordem, 
	nm_usuario_p, 				-- nm_usuario_exec, 
	6001,					-- cd_funcao, 
	'W',					-- ie_forma_receb, 
	nm_usuario_p,				-- nm_usuario_nrec, 
	'1', 
	'S');
 
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE man_gerar_os_liber_versao (nr_sequencia_p INOUT bigint, nm_usuario_p text) FROM PUBLIC;

