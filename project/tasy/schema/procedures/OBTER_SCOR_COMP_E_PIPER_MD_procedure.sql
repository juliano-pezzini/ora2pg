-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_scor_comp_e_piper_md (qt_estresse_fadiga_P bigint, qt_fadiga_intef_capacidade_P bigint, qt_fadiga_intef_habilidade_P bigint, qt_fadiga_intef_hab_sexo_P bigint, qt_fadiga_cap_ativ_P bigint, qt_intensidade_P bigint, QT_SCORE_COMPORTAMENTAL_P INOUT bigint, qt_reg_comport_p INOUT bigint, qt_result_comport_p INOUT bigint ) AS $body$
DECLARE


	qt_reg_comport_w		  integer    := 0;
	qt_percent_subgrupo_w	  integer    := 0;
	qt_result_comport_w	      double precision := 0;

BEGIN
	--- Inicio MD1
	if (qt_estresse_fadiga_P IS NOT NULL AND qt_estresse_fadiga_P::text <> '') then
		qt_reg_comport_w	:= 	qt_reg_comport_w + 1;
		qt_result_comport_w	:= 	qt_result_comport_w + coalesce(qt_estresse_fadiga_P,0);
	end if;
	if (qt_fadiga_intef_capacidade_P IS NOT NULL AND qt_fadiga_intef_capacidade_P::text <> '') then
		qt_reg_comport_w	:= 	qt_reg_comport_w + 1;
		qt_result_comport_w	:= 	qt_result_comport_w + coalesce(qt_fadiga_intef_capacidade_P,0);
	end if;
	if (qt_fadiga_intef_habilidade_P IS NOT NULL AND qt_fadiga_intef_habilidade_P::text <> '') then
		qt_reg_comport_w	:= 	qt_reg_comport_w + 1;
		qt_result_comport_w	:= 	qt_result_comport_w + coalesce(qt_fadiga_intef_habilidade_P,0);
	end if;
	if (qt_fadiga_intef_hab_sexo_P IS NOT NULL AND qt_fadiga_intef_hab_sexo_P::text <> '') then
		qt_reg_comport_w	:= 	qt_reg_comport_w + 1;
		qt_result_comport_w	:= 	qt_result_comport_w + coalesce(qt_fadiga_intef_hab_sexo_P,0);
	end if;
	if (qt_fadiga_cap_ativ_P IS NOT NULL AND qt_fadiga_cap_ativ_P::text <> '') then
		qt_reg_comport_w	:= 	qt_reg_comport_w + 1;
		qt_result_comport_w	:= 	qt_result_comport_w + coalesce(qt_fadiga_cap_ativ_P,0);
	end if;
	if (qt_intensidade_P IS NOT NULL AND qt_intensidade_P::text <> '') then
		qt_reg_comport_w	:= 	qt_reg_comport_w + 1;
		qt_result_comport_w	:= 	qt_result_comport_w + coalesce(qt_intensidade_P,0);
	end if;
	
	if (qt_reg_comport_w >= 5) then
		qt_percent_subgrupo_w	   := qt_percent_subgrupo_w + 1;
		QT_SCORE_COMPORTAMENTAL_P  := dividir_md(qt_result_comport_w,qt_reg_comport_w);
	end if;
	--- Fim MD1
    qt_reg_comport_p    := qt_reg_comport_w;
	qt_result_comport_p := qt_result_comport_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_scor_comp_e_piper_md (qt_estresse_fadiga_P bigint, qt_fadiga_intef_capacidade_P bigint, qt_fadiga_intef_habilidade_P bigint, qt_fadiga_intef_hab_sexo_P bigint, qt_fadiga_cap_ativ_P bigint, qt_intensidade_P bigint, QT_SCORE_COMPORTAMENTAL_P INOUT bigint, qt_reg_comport_p INOUT bigint, qt_result_comport_p INOUT bigint ) FROM PUBLIC;

