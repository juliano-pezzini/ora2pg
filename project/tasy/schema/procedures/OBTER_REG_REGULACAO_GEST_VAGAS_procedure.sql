-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_reg_regulacao_gest_vagas (cd_solicitacao_p text, cd_tipo_vaga_p text, cd_especialidade_p INOUT text, cd_cid_p INOUT text) AS $body$
BEGIN

	select coalesce(cd_especialidade, 'N'),
		coalesce(cd_cid, 'N')
	into STRICT cd_especialidade_p,
		cd_cid_p
	from (
	  SELECT MAX(rri.ie_especialidade) cd_especialidade,
		MAX(rri.ie_cid) cd_cid
	  from regra_regulacao rr, regra_regulacao_itens rri
	  where rr.ie_tipo = 'SV'
		and rr.nr_sequencia = rri.nr_seq_regra_reg
		and rri.IE_SITUACAO = 'A'
		and coalesce(rr.ie_solicitacao, cd_solicitacao_p) = cd_solicitacao_p
		and coalesce(rr.ie_tipo_vaga, cd_tipo_vaga_p) = cd_tipo_vaga_p
	  order by rr.dt_atualizacao desc
	) alias6 LIMIT 1;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_reg_regulacao_gest_vagas (cd_solicitacao_p text, cd_tipo_vaga_p text, cd_especialidade_p INOUT text, cd_cid_p INOUT text) FROM PUBLIC;

