-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE tiss_gerar_autor_anexo_diag (nr_sequencia_autor_p bigint, nr_seq_anexo_guia_p bigint, nm_usuario_p text) AS $body$
DECLARE

							
ds_justificativa_w	tiss_anexo_guia.ds_justificativa%type;
ds_especific_mat_w	tiss_anexo_guia.ds_especific_mat%type;
ds_observacao_w		tiss_anexo_guia.ds_observacao%type;		
				

BEGIN

select	ds_justificativa,
	ds_especific_mat,
	ds_observacao
into STRICT	ds_justificativa_w,
	ds_especific_mat_w,
	ds_observacao_w
from	tiss_anexo_guia
where	nr_sequencia	= nr_seq_anexo_guia_p;

insert	into tiss_autor_anexo_diag(nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nm_usuario_lib,
	dt_liberacao,
	nr_sequencia_autor,
	nr_seq_anexo_guia,
	dt_diagnostico,
	cd_cid,
	cd_cid_2,
	ds_plano_terapeutico,
	cd_estadiamento_tumor,
	cd_tipo_quimio,
	cd_finalidade_trat,
	cd_ecog,
	ds_histopatologico,
	ds_info_relevante,
	ds_obs_jutificativa,
	ds_justificativa_tec,
	ds_especific_mat,
	cd_tumor,
	cd_nodulo,
	cd_metastase,
	cd_diagnostico_imagem)
SELECT	nextval('tiss_autor_anexo_diag_seq'),
	clock_timestamp(),
	nm_usuario_p,
	clock_timestamp(),
	nm_usuario_p,
	null,
	null,
	nr_sequencia_autor_p,
	nr_seq_anexo_guia_p,
	dt_diagnostico,
	replace(cd_cid,'.',''),
	replace(cd_cid_2,'.',''),
	ds_plano_terapeutico,
	cd_estadiamento_tumor,
	cd_tipo_quimio,
	cd_finalidade_tratamento,
	cd_ecog,
	ds_diag_histopatologico,
	ds_info_relevantes,
	ds_observacao_w,
	ds_justificativa_w,
	ds_especific_mat_w,
	cd_tumor,
	cd_nodulo,
	cd_metastase,
	cd_diagnostico_imagem
from	tiss_anexo_guia_diag
where	nr_seq_guia	= nr_seq_anexo_guia_p;	

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE tiss_gerar_autor_anexo_diag (nr_sequencia_autor_p bigint, nr_seq_anexo_guia_p bigint, nm_usuario_p text) FROM PUBLIC;

