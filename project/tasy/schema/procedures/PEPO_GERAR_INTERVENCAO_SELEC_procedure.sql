-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pepo_gerar_intervencao_selec ( nr_sequencia_p bigint, ie_excluir_p text, nm_usuario_p text, cd_estabelecimento_p bigint, ds_lista_nr_seq_proc_p text) AS $body$
DECLARE

 
ds_lista_w 		varchar(10000) := '';
posicao_virgula_w 	integer := 0;
nr_max_loop_w 		integer := 10000;
nr_seq_proc_w 		bigint := 0;
tamanho_lista_w		bigint;

			 

BEGIN 
ds_lista_w := ds_lista_nr_seq_proc_p;
 
while 	(ds_lista_w IS NOT NULL AND ds_lista_w::text <> '') and 
	nr_max_loop_w > 0 loop 
	begin 
	tamanho_lista_w := length(ds_lista_w);
	posicao_virgula_w := position(',' in ds_lista_w);
	 
	if (posicao_virgula_w > 1) and ((substr(ds_lista_w, 1, posicao_virgula_w - 1) IS NOT NULL AND (substr(ds_lista_w, 1, posicao_virgula_w - 1))::text <> '')) then 
		begin 
		nr_seq_proc_w := (substr(ds_lista_w, 1, posicao_virgula_w -1))::numeric;
		ds_lista_w := substr(ds_lista_w, (posicao_virgula_w +1), tamanho_lista_w);
		end;
	elsif (ds_lista_w IS NOT NULL AND ds_lista_w::text <> '') then 
		nr_seq_proc_w := (replace(ds_lista_w, ',', ''))::numeric;
		ds_lista_w := '';
	end if;
	 
	if (nr_seq_proc_w IS NOT NULL AND nr_seq_proc_w::text <> '') and (nr_seq_proc_w > 0) then 
		begin 
		CALL gerar_intervencao_selecao( 
				nr_sequencia_p, 
				ie_excluir_p, 
				nr_seq_proc_w, 
				nm_usuario_p, 
				cd_estabelecimento_p);
		end;
	end if;
	nr_max_loop_w := nr_max_loop_w -1;
	end;
end loop;
 
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pepo_gerar_intervencao_selec ( nr_sequencia_p bigint, ie_excluir_p text, nm_usuario_p text, cd_estabelecimento_p bigint, ds_lista_nr_seq_proc_p text) FROM PUBLIC;

