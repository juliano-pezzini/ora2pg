-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_interf_mamo_sismama ( nr_seq_protocolo_p bigint, nm_usuario_p text) AS $body$
DECLARE


c_cnes_w 			varchar(7);
c_exame_w			varchar(14);
c_id_nome_w			varchar(70);
c_id_nomemae_w			varchar(70);
c_id_apel_w			varchar(30);
d_id_dtnasc_w 			varchar(8);
c_id_ident_w			varchar(12);
c_id_emis_w			varchar(5);
c_id_ufide_w			varchar(2);
c_id_cic_w			varchar(11);
c_id_esco_w			varchar(1);
c_id_endereco_w			varchar(35);
c_id_numero_w			varchar(6);
c_id_complem_w			varchar(15);
c_id_bairro_w			varchar(15);
c_id_uf_w			varchar(2);
c_ibge_w				varchar(7);
c_id_cep_w			varchar(8);
c_id_refe_w			varchar(35);
c_id_fone_w			varchar(11);
c_id_sus_w			varchar(15);
c_us_uf_w			varchar(2);
c_us_ibge_w			varchar(7);
c_us_cnes_w			varchar(7);
c_us_nome_w			varchar(40);
c_pron_w				varchar(12);
c_anm_nod_w			varchar(1);
c_anm_nod_md_w			varchar(1);
c_anm_nod_me_w			varchar(1);
c_anm_parente_cancer_w		varchar(1);
c_anm_exa_prof_w			varchar(1);
c_anm_mamograf_w		varchar(1);
c_anm_mamo_ano_w		varchar(4);
c_cli_diag_w			varchar(1);
c_cli_les_palpa_w			varchar(1);
c_cli_papil_dir_w			varchar(1);
c_cli_desc_dir_w			varchar(1);
c_cli_nod_qse_dir_w		varchar(1);
c_cli_nod_qie_dir_w		varchar(1);
c_cli_nod_qsi_dir_w		varchar(1);
c_cli_nod_qii_dir_w			varchar(1);
c_cli_nod_uqext_dir_w		varchar(1);
c_cli_nod_uqsup_dir_w		varchar(1);
c_cli_nod_uqint_dir_w		varchar(1);
c_cli_nod_uqinf_dir_w		varchar(1);
c_cli_nod_rra_dir_w			varchar(1);
c_cli_nod_pa_dir_w			varchar(1);
c_cli_esp_qse_dir_w		varchar(1);
c_cli_esp_qie_dir_w		varchar(1);
c_cli_esp_qsi_dir_w			varchar(1);
c_cli_esp_qii_dir_w			varchar(1);
c_cli_esp_uqext_dir_w		varchar(1);
c_cli_esp_uqsup_dir_w		varchar(1);
c_cli_esp_uqint_dir_w		varchar(1);
c_cli_esp_uqinf_dir_w		varchar(1);
c_cli_esp_rra_dir_w			varchar(1);
c_cli_esp_pa_dir_w			varchar(1);
c_cli_linf_ax_dir_w			varchar(1);
c_cli_linf_supra_dir_w		varchar(1);
c_cli_papil_esq_w			varchar(1);
c_cli_desc_esq_w			varchar(1);
c_cli_nod_qse_esq_w		varchar(1);
c_cli_nod_qie_esq_w		varchar(1);
c_cli_nod_qsi_esq_w		varchar(1);
c_cli_nod_qii_esq_w		varchar(1);
c_cli_nod_uqext_esq_w		varchar(1);
c_cli_nod_uqsup_esq_w		varchar(1);
c_cli_nod_uqint_esq_w		varchar(1);
c_cli_nod_uqinf_esq_w		varchar(1);
c_cli_nod_rra_esq_w		varchar(1);
c_cli_nod_pa_esq_w		varchar(1);
c_cli_esp_qse_esq_w		varchar(1);
c_cli_esp_qie_esq_w		varchar(1);
c_cli_esp_qsi_esq_w		varchar(1);
c_cli_esp_qii_esq_w		varchar(1);
c_cli_esp_uqext_esq_w		varchar(1);
c_cli_esp_uqsup_esq_w		varchar(1);
c_cli_esp_uqint_esq_w		varchar(1);
c_cli_esp_uqinf_esq_w		varchar(1);
c_cli_esp_rra_esq_w		varchar(1);
c_cli_esp_pa_esq_w		varchar(1);
c_cli_linf_ax_esq_w			varchar(1);
c_cli_linf_supra_esq_w		varchar(1);
c_controle_radiol_w			varchar(1);
c_rad_nodulo_dir_w		varchar(1);
c_rad_microcal_dir_w		varchar(1);
c_rad_assim_foc_dir_w		varchar(1);
c_rad_assim_dif_dir_w		varchar(1);
c_rad_area_dens_dir_w		varchar(1);
c_rad_dist_arq_dir_w		varchar(1);
c_rad_nodulo_esq_w		varchar(1);
c_rad_microcal_esq_w		varchar(1);
c_rad_assim_foc_esq_w		varchar(1);
c_rad_assim_dif_esq_w		varchar(1);
c_rad_area_dens_esq_w		varchar(1);
c_rad_dist_arq_esq_w		varchar(1);
c_lesao_diag_w			varchar(1);
c_diag_nodulo_dir_w		varchar(1);
c_diag_microcal_dir_w		varchar(1);
c_diag_assim_foc_dir_w		varchar(1);
c_diag_assim_dif_dir_w		varchar(1);
c_diag_area_dens_dir_w		varchar(1);
c_diag_dist_arq_dir_w		varchar(1);
c_diag_nodulo_esq_w		varchar(1);
c_diag_microcal_esq_w		varchar(1);
c_diag_assim_foc_esq_w		varchar(1);
c_diag_assim_dif_esq_w		varchar(1);
c_diag_area_dens_esq_w		varchar(1);
c_diag_dist_arq_esq_w		varchar(1);
c_avaliacao_adj_w			varchar(1);
c_mamo_rastr_w			varchar(1);
d_ana_mestruac_w 		varchar(8);
c_ana_mest_nlemb_w		varchar(1);
c_ana_menop_idade_w		varchar(2);
c_ana_menop_nlemb_w		varchar(1);
c_ana_nuncamest_w		varchar(1);
c_ana_usahormonio_w		varchar(1);
c_ana_gravida_w			varchar(1);
c_ana_radio_w			varchar(1);
c_ana_radio_mdir_w		varchar(1);
c_ana_ano_direita_w		varchar(4);
c_ana_radio_mesq_w		varchar(1);
c_ana_ano_esquerda_w		varchar(4);
c_ana_ano_tumor_d_w		varchar(4);
c_ana_ano_tumor_e_w		varchar(4);
c_ana_ano_segmen_d_w		varchar(4);
c_ana_ano_segmen_e_w		varchar(4);
c_ana_ano_dutect_d_w		varchar(4);
c_ana_ano_dutect_e_w		varchar(4);
c_ana_ano_mastec_d_w		varchar(4);
c_ana_ano_mastec_e_w		varchar(4);
c_ana_ano_m_pele_d_w		varchar(4);
c_ana_ano_m_pele_e_w		varchar(4);
c_ana_ano_esvazia_d_w		varchar(4);
c_ana_ano_esvazia_e_w		varchar(4);
c_ana_ano_biopsia_d_w		varchar(4);
c_ana_ano_biopsia_e_w		varchar(4);
c_ana_ano_recon_d_w		varchar(4);
c_ana_ano_recon_e_w		varchar(4);
c_ana_ano_plast_red_d_w		varchar(4);
c_ana_ano_plast_red_e_w		varchar(4);
c_ana_ano_plast_imp_d_w		varchar(4);
c_ana_ano_plast_imp_e_w		varchar(4);
c_ana_naofezcirur_w		varchar(1);
c_rad_num_film_d_w		varchar(2);
c_rad_pele_d_w			varchar(1);
c_rad_composic_d_w		varchar(1);
c_nod_sim_01d_w 			varchar(1);
c_nod_loc_01d_w 			varchar(2);
c_nod_tam_01d_w 			varchar(1);
c_nod_cont_01d_w			varchar(1);
c_nod_lim_01d_w 			varchar(1);
c_nod_sim_02d_w 			varchar(1);
c_nod_loc_02d_w 			varchar(2);
c_nod_tam_02d_w 			varchar(1);
c_nod_cont_02d_w 		varchar(1);
c_nod_lim_02d_w 			varchar(1);
c_nod_sim_03d_w 			varchar(1);
c_nod_loc_03d_w 			varchar(2);
c_nod_tam_03d_w 			varchar(1);
c_nod_cont_03d_w 		varchar(1);
c_nod_lim_03d_w	 		varchar(1);
c_micro_sim_01d_w 		varchar(1);
c_micro_loc_01d_w 		varchar(2);
c_micro_form_01d_w 		varchar(1);
c_micro_distr_01d_w 		varchar(1);
c_micro_sim_02d_w 		varchar(1);
c_micro_loc_02d_w 		varchar(2);
c_micro_form_02d_w 		varchar(1);
c_micro_distr_02d_w 		varchar(1);
c_micro_sim_03d_w 		varchar(1);
c_micro_loc_03d_w 		varchar(2);
c_micro_form_03d_w 		varchar(1);
c_micro_distr_03d_w 		varchar(1);
c_assi_foc_sim01d_w 		varchar(1);
c_assi_foc_loc01d_w 		varchar(2);
c_assi_foc_sim02d_w 		varchar(1);
c_assi_foc_loc02d_w 		varchar(2);
c_assi_dif_sim01d_w 		varchar(1);
c_assi_difu_loc01d_w 		varchar(2);
c_assi_dif_sim02d_w 		varchar(1);
c_assi_difu_loc02d_w 		varchar(2);
c_dis_foc_sim01d_w 		varchar(1);
c_dis_foc_loc01d_w 		varchar(2);
c_dis_foc_sim02d_w 		varchar(1);
c_dis_foc_loc02d_w 		varchar(2);
c_ar_dens_sim01d_w 		varchar(1);
c_ar_dens_loc01d_w 		varchar(2);
c_ar_dens_sim02d_w 		varchar(1);
c_ar_dens_loc02d_w 		varchar(2);
c_linf_aux_d_w 			varchar(1);
c_linf_aux_aum_d_w 		varchar(1);
c_linf_aux_denso_d_w 		varchar(1);
c_linf_aux_conf_d_w 		varchar(1);
c_dilat_duc_d_w 			varchar(1);
c_nod_den_d_w 			varchar(1);
c_nod_cal_d_w 			varchar(1);
c_nod_den_het_d_w 		varchar(1);
c_calc_vasc_d_w 			varchar(1);
c_calc_asp_ben_d_w 		varchar(1);
c_linf_intram_d_w 			varchar(1);
c_dis_arq_cir_d_w 			varchar(1);
c_imp_integ_d_w 			varchar(1);
c_imp_sin_rup_d_w 		varchar(1);
c_rad_num_film_e_w 		varchar(2);
c_rad_pele_e_w 			varchar(1);
c_rad_composic_e_w 		varchar(1);
c_nod_sim_01e_w 			varchar(1);
c_nod_loc_01e_w 			varchar(2);
c_nod_tam_01e_w 			varchar(1);
c_nod_cont_01e_w 		varchar(1);
c_nod_lim_01e_w 			varchar(1);
c_nod_sim_02e_w	 		varchar(1);
c_nod_loc_02e_w 			varchar(2);
c_nod_tam_02e_w	 		varchar(1);
c_nod_cont_02e_w 		varchar(1);
c_nod_lim_02e_w	 		varchar(1);
c_nod_sim_03e_w 			varchar(1);
c_nod_loc_03e_w 			varchar(2);
c_nod_tam_03e_w 			varchar(1);
c_nod_cont_03e_w 		varchar(1);
c_nod_lim_03e_w 			varchar(1);
c_micro_sim_01e_w 		varchar(1);
c_micro_loc_01e_w 		varchar(2);
c_micro_form_01e_w 		varchar(1);
c_micro_distr_01e_w		varchar(1);
c_micro_sim_02e_w 		varchar(1);
c_micro_loc_02e_w 		varchar(2);
c_micro_form_02e_w 		varchar(1);
c_micro_distr_02e_w 		varchar(1);
c_micro_sim_03e_w 		varchar(1);
c_micro_loc_03e_w 		varchar(2);
c_micro_form_03e_w 		varchar(1);
c_micro_distr_03e_w 		varchar(1);
c_assi_foc_sim01e_w 		varchar(1);
c_assi_foc_loc01e_w 		varchar(2);
c_assi_foc_sim02e_w 		varchar(1);
c_assi_foc_loc02e_w 		varchar(2);
c_assi_dif_sim01e_w 		varchar(1);
c_assi_difu_loc01e_w 		varchar(2);
c_assi_dif_sim02e_w 		varchar(1);
c_assi_difu_loc02e_w 		varchar(2);
c_dis_foc_sim01e_w 		varchar(1);
c_dis_foc_loc01e_w 		varchar(2);
c_dis_foc_sim02e_w 		varchar(1);
c_dis_foc_loc02e_w 		varchar(2);
c_ar_dens_sim01e_w 		varchar(1);
c_ar_dens_loc01e_w 		varchar(2);
c_ar_dens_sim02e_w 		varchar(1);
c_ar_dens_loc02e_w 		varchar(2);
c_linf_aux_e_w 			varchar(1);
c_linf_aux_aum_e_w 		varchar(1);
c_linf_aux_denso_e_w 		varchar(1);
c_linf_aux_conf_e_w 		varchar(1);
c_dilat_duc_e_w 			varchar(1);
c_nod_den_e_w 			varchar(1);
c_nod_cal_e_w 			varchar(1);
c_nod_den_het_e_w 		varchar(1);
c_calc_vasc_e_w 			varchar(1);
c_calc_asp_bem_e_w 		varchar(1);
c_linf_intram_e_w 			varchar(1);
c_dis_arq_cir_e_w 			varchar(1);
c_imp_integ_e_w 			varchar(1);
c_imp_sin_rup_e_w 		varchar(1);
c_con_dia_cat_d_w 		varchar(1);
c_con_dia_cat_e_w 		varchar(1);
c_con_recom_d_w 			varchar(1);
c_con_recom_e_w 			varchar(1);
c_obs_gerais_w 			varchar(150);
d_recebe_w 			varchar(8);
d_exame_w 			varchar(8);
d_libera_w 			varchar(8);
c_pat_cns_w 			varchar(15);
c_pat_cic_w 			varchar(11);
c_id_sexo_w 			varchar(1);
c_id_racacor_w 			varchar(2);
c_mama_dir_nao_rad_w		varchar(1);
c_mama_esq_nao_rad_w		varchar(1);

nr_seq_sisma_w			bigint;
cd_cgc_unidade_saude_w		varchar(14);
cd_estabelecimento_w		smallint;
cd_pf_resp_emissao_filme_w		varchar(10);
cd_profissional_w			varchar(10);
dt_emissao_w			varchar(8);
dt_liberacao_w			varchar(8);
nr_seq_unidade_saude_w		bigint;

nr_atendimento_w			bigint;
nr_interno_conta_w			bigint;
cd_pessoa_fisica_w		varchar(10);
ie_considera_data_diag_w		varchar(15) := 'N';
nr_seq_rad_w			bigint;

amarela_c               constant cor_pele.ds_cor_pele%type := trim(both wheb_mensagem_pck.get_texto(1187339));
branca_c                constant cor_pele.ds_cor_pele%type := trim(both wheb_mensagem_pck.get_texto(1187340));
indio_c                 constant cor_pele.ds_cor_pele%type := trim(both wheb_mensagem_pck.get_texto(1187345));
negra_c                 constant cor_pele.ds_cor_pele%type := trim(both wheb_mensagem_pck.get_texto(1187344));
parda_c                 constant cor_pele.ds_cor_pele%type := trim(both wheb_mensagem_pck.get_texto(1187342));
semInformacao_c         constant cor_pele.ds_cor_pele%type := trim(both wheb_mensagem_pck.get_texto(1187321));
C_ANA_MENOP_NLEMB_C     constant varchar(1) := '0';
nr_sequencia_04_c       constant varchar(2) := '04';
nr_sequencia_01_c       constant varchar(2) := '01';
nr_sequencia_05_c       constant varchar(2) := '05';
nr_sequencia_02_c       constant varchar(2) := '02';
nr_sequencia_03_c       constant varchar(2) := '03';
nr_sequencia_99_c       constant varchar(2) := '99';
IE_OPCAO_CP_C           constant varchar(2) := 'CP';
NR_SEQ_SISMAMA_C        constant varchar(15) := 'NR_SEQ_SISMAMA=';

C01 CURSOR FOR
	SELECT	a.nr_sequencia,
		substr(a.cd_cgc_unidade_saude,1,14),
		a.cd_estabelecimento,
		substr(a.cd_pf_resp_emissao_filme,1,10),
		substr(a.cd_profissional,1,10),
		to_char(a.dt_emissao,'ddmmyyyy'),
		to_char(a.dt_liberacao,'ddmmyyyy'),
		a.nr_seq_unidade_saude,
		a.nr_atendimento,
		b.nr_interno_conta
	from	protocolo_convenio c,
		conta_paciente b,
		sismama_atendimento a
	where	a.nr_atendimento = b.nr_atendimento
	and	sus_obter_tp_laudo_sismama(a.nr_sequencia,1) = '1'
	and (ie_considera_data_diag_w = 'N')
	and	a.dt_liberacao   = (	SELECT 	max(x.dt_liberacao)
					from	sismama_atendimento x
					where	x.nr_atendimento = a.nr_atendimento)
	and	b.nr_seq_protocolo = nr_seq_protocolo_p
	and	b.nr_seq_protocolo = c.nr_seq_protocolo
	
union

	select	a.nr_sequencia,
		substr(a.cd_cgc_unidade_saude,1,14),
		a.cd_estabelecimento,
		substr(a.cd_pf_resp_emissao_filme,1,10),
		substr(a.cd_profissional,1,10),
		to_char(a.dt_emissao,'ddmmyyyy'),
		to_char(a.dt_liberacao,'ddmmyyyy'),
		a.nr_seq_unidade_saude,
		a.nr_atendimento,
		b.nr_interno_conta
	from	protocolo_convenio c,
		conta_paciente b,
		sismama_atendimento a
	where	a.nr_atendimento = b.nr_atendimento
	and	sus_obter_tp_laudo_sismama(a.nr_sequencia,1) = '1'
	and (ie_considera_data_diag_w = 'S')
	and	exists (	select 	1
			from	sismama_mam_conclusao y
			where	y.nr_seq_sismama = a.nr_sequencia
			and	y.dt_liberacao between trunc(c.dt_mesano_referencia,'mm') and last_day(fim_dia(c.dt_mesano_referencia)))
	and	b.nr_seq_protocolo = nr_seq_protocolo_p
	and	b.nr_seq_protocolo = c.nr_seq_protocolo
	
union

	select	a.nr_sequencia,
		substr(a.cd_cgc_unidade_saude,1,14),
		a.cd_estabelecimento,
		substr(a.cd_pf_resp_emissao_filme,1,10),
		substr(a.cd_profissional,1,10),
		to_char(a.dt_emissao,'ddmmyyyy'),
		to_char(a.dt_liberacao,'ddmmyyyy'),
		a.nr_seq_unidade_saude,
		a.nr_atendimento,
		b.nr_interno_conta
	from	protocolo_convenio c,
		conta_paciente b,
		sismama_atendimento a
	where	a.nr_atendimento = b.nr_atendimento
	and	sus_obter_tp_laudo_sismama(a.nr_sequencia,1) = '1'
	and (ie_considera_data_diag_w = 'P') 
	and	exists (	select 	1
			from	sismama_mam_conclusao y
			where	y.nr_seq_sismama = a.nr_sequencia
			and	y.dt_liberacao between trunc(c.dt_mesano_referencia,'mm') and last_day(fim_dia(c.dt_mesano_referencia)) or
				y.dt_liberacao < trunc(c.dt_mesano_referencia,'mm'))
	and	b.nr_seq_protocolo = nr_seq_protocolo_p
	and	b.nr_seq_protocolo = c.nr_seq_protocolo
	order by nr_sequencia;


BEGIN

ie_considera_data_diag_w		:= coalesce(obter_valor_param_usuario(1125,102,obter_perfil_ativo,nm_usuario_p,cd_estabelecimento_w),'N');

delete 	from w_sismama_interf_mamo
where	nr_seq_protocolo = nr_seq_protocolo_p;

delete	from  w_sismama_interf_mrad
where	nr_seq_protocolo = nr_seq_protocolo_p;

open C01;
loop
fetch C01 into
	nr_seq_sisma_w,
	cd_cgc_unidade_saude_w,
	cd_estabelecimento_w,
	cd_pf_resp_emissao_filme_w,
	cd_profissional_w,
	dt_emissao_w,
	dt_liberacao_w,
	nr_seq_unidade_saude_w,
	nr_atendimento_w,
	nr_interno_conta_w;
EXIT WHEN NOT FOUND; /* apply on C01 */
	begin

	select	lpad(max(substr(sus_Obter_cnes_estab_unif(a.cd_estabelecimento,'B'),1,7)),7,'0') c_cnes,
	        max(a.nr_sequencia) c_exame,
	        max(upper(substr(obter_nome_pf(c.cd_pessoa_fisica),1,70))) c_id_nome,
	        max(upper(substr(obter_compl_pf(c.cd_pessoa_fisica,5,'N'),1,60))) c_id_nomemae,
	        ' ' c_id_apel,
	        max(to_char(to_date(obter_dados_pf(c.cd_pessoa_fisica,'DN'),'dd/mm/yyyy'),'yyyymmdd')) d_id_dtnasc,
	        max(substr(obter_dados_pf(c.cd_pessoa_fisica,'RG'),1,12)) c_id_ident,
	        max(substr(obter_dados_pf(c.cd_pessoa_fisica,'O'),1,5)) c_id_emis,
	        max(CASE WHEN obter_dados_pf(c.cd_pessoa_fisica,'RG')='' THEN ''  ELSE upper(substr(SUS_obter_codigo_UF(obter_compl_pf(c.cd_pessoa_fisica,1,'UF')),1,2)) END ) c_id_ufide,
	        max(substr(obter_dados_pf(c.cd_pessoa_fisica,'CPF'),1,11)) c_id_cic,
	        max(CASE WHEN obter_dados_pf(c.cd_pessoa_fisica,'GI')='Analfabeto' THEN '1' WHEN obter_dados_pf(c.cd_pessoa_fisica,'GI')='Primeiro  Grau  Incompleto' THEN '2' WHEN obter_dados_pf(c.cd_pessoa_fisica,'GI')='Primeiro Grau' THEN '3' WHEN obter_dados_pf(c.cd_pessoa_fisica,'GI')='Segundo Grau' THEN '4' WHEN obter_dados_pf(c.cd_pessoa_fisica,'GI')='Superior' THEN '5'  ELSE '0' END ) c_id_esco,
	        max(upper(substr(elimina_caractere_especial(obter_compl_pf(c.cd_pessoa_fisica,1,'EN')),1,35))) c_id_endereco,
	        max(substr(elimina_caractere_especial(obter_compl_pf(c.cd_pessoa_fisica,1,'NR')),1,6)) c_id_numero,
	        max(upper(substr(elimina_caractere_especial(obter_compl_pf(c.cd_pessoa_fisica,1,'CO')),1,15))) c_id_complem,
	        max(upper(substr(obter_compl_pf(c.cd_pessoa_fisica,1,'B'),1,15))) c_id_bairro,
	        max(upper(substr(SUS_obter_codigo_UF(obter_compl_pf(c.cd_pessoa_fisica,1,'UF')),1,2))) c_id_uf,
	        max(substr(obter_compl_pf(c.cd_pessoa_fisica,1,'CDM')||Calcula_Digito('MODULO10',obter_compl_pf(c.cd_pessoa_fisica,1,'CDM')),1,7)) c_ibge,
	        max(substr(obter_compl_pf(c.cd_pessoa_fisica,1,'CEP'),1,8)) c_id_cep,
	        ' ' c_id_refe,
	        max(substr(obter_compl_pf(c.cd_pessoa_fisica,1,'T'),1,11)) c_id_fone,
	        max(substr(obter_dados_pf(c.cd_pessoa_fisica,'CNS'),1,15)) c_id_sus,
		max(substr(SUS_obter_codigo_UF(obter_dados_unid_saude_atend(a.nr_sequencia,'UF')),1,2)) c_us_uf,
	        max(substr(obter_dados_unid_saude_atend(a.nr_sequencia,'CDM'),1,7)) c_us_ibge,
	        lpad(max(substr(obter_dados_unid_saude_atend(a.nr_sequencia,'CNES'),1,7)),7,'0') c_us_cnes,
	        max(substr(obter_dados_unid_saude_atend(a.nr_sequencia,'NM'),1,40)) c_us_nome,
	        max(obter_prontuario_paciente(c.cd_pessoa_fisica)) c_pron,
		max(c.cd_pessoa_fisica),
	        max(CASE WHEN Obter_Sexo_PF(c.cd_pessoa_fisica,'C')='F' THEN '2' WHEN Obter_Sexo_PF(c.cd_pessoa_fisica,'C')='M' THEN '1'  ELSE '0' END ) c_id_sexo,
	        max(coalesce(case obter_dados_pf(c.cd_pessoa_fisica,IE_OPCAO_CP_C)   when amarela_c then nr_sequencia_04_c
                                                                                when branca_c then nr_sequencia_01_c
                                                                                when indio_c then nr_sequencia_05_c
                                                                                when negra_c then nr_sequencia_02_c
                                                                                when parda_c then nr_sequencia_03_c
                                                                                when semInformacao_c then nr_sequencia_99_c
                                                                                else nr_sequencia_99_c end
                                                                                ,nr_sequencia_99_c)) c_id_racacor
	into STRICT	c_cnes_w,
		c_exame_w,
		c_id_nome_w,
		c_id_nomemae_w,
		c_id_apel_w,
		d_id_dtnasc_w,
		c_id_ident_w,
		c_id_emis_w,
		c_id_ufide_w,
		c_id_cic_w,
		c_id_esco_w,
		c_id_endereco_w,
		c_id_numero_w,
		c_id_complem_w,
		c_id_bairro_w,
		c_id_uf_w,
		c_ibge_w,
		c_id_cep_w,
		c_id_refe_w,
		c_id_fone_w,
		c_id_sus_w,
		c_us_uf_w,
		c_us_ibge_w,
		c_us_cnes_w,
		c_us_nome_w,
		c_pron_w,
		cd_pessoa_fisica_w,
		c_id_sexo_w,
		c_id_racacor_w
	from	atendimento_paciente c,
		conta_paciente b,
		sismama_atendimento a
	where	a.nr_atendimento = b.nr_atendimento
	and	b.nr_atendimento = c.nr_atendimento
	and	a.nr_sequencia   = nr_seq_sisma_w;

	select	max(coalesce(CASE WHEN d.ie_nodulo_caroco='N' THEN '3' END ,'0')) c_anm_nod,
		max(coalesce(CASE WHEN d.ie_nodulo_caroco='D' THEN '3' WHEN d.ie_nodulo_caroco='A' THEN '3' END ,'0')) c_anm_nod_md,
		max(coalesce(CASE WHEN d.ie_nodulo_caroco='E' THEN '3' WHEN d.ie_nodulo_caroco='A' THEN '3' END ,'0')) c_anm_nod_me,
		max(CASE WHEN d.ie_risco_elevado='S' THEN '3' WHEN d.ie_risco_elevado='X' THEN '2' WHEN d.ie_risco_elevado='N' THEN '1' END ) c_anm_parente_cancer,
		max(coalesce(CASE WHEN d.ie_mama_exam_prof='S' THEN '3' WHEN d.ie_mama_exam_prof='N' THEN '2' END ,'0')) c_anm_exa_prof,
		max(coalesce(CASE WHEN d.ie_ultima_mamografia='S' THEN '3' WHEN d.ie_ultima_mamografia='X' THEN '2' WHEN d.ie_ultima_mamografia='N' THEN '1' END ,'0')) c_anm_mamograf,
		max(substr(d.dt_ultima_mamografia,1,4)) c_anm_mamo_ano
	into STRICT	c_anm_nod_w,
		c_anm_nod_md_w,
		c_anm_nod_me_w,
		c_anm_parente_cancer_w,
		c_anm_exa_prof_w,
		c_anm_mamograf_w,
		c_anm_mamo_ano_w
	from	sismama_mam_anamnese d
	where	d.nr_seq_sismama = nr_seq_sisma_w;

	select	max(coalesce(CASE WHEN e.ie_mamografia_diag='D' THEN '1' WHEN e.ie_mamografia_diag='E' THEN '2' WHEN e.ie_mamografia_diag='A' THEN '3' END ,'0')) c_cli_diag,
	        max(CASE WHEN e.ie_achado_exame_clin='S' THEN '3'  ELSE '0' END ) c_cli_les_palpa,
	        max(CASE WHEN e.ie_lesao_pap_dir='S' THEN '3'  ELSE '0' END ) c_cli_papil_dir,
	        max(coalesce(CASE WHEN e.ie_descarga_pap_dir='C' THEN '1' WHEN e.ie_descarga_pap_dir='H' THEN '2' END ,'0')) c_cli_desc_dir,
	        max(CASE WHEN e.ie_nod_qsm_dir='S' THEN '3'  ELSE '0' END ) c_cli_nod_qse_dir,
	        max(CASE WHEN e.ie_nod_qim_dir='S' THEN '3'  ELSE '0' END ) c_cli_nod_qie_dir,
	        max(CASE WHEN e.ie_nod_qsl_dir='S' THEN '3'  ELSE '0' END ) c_cli_nod_qsi_dir,
	        max(CASE WHEN e.ie_nod_qil_dir='S' THEN '3'  ELSE '0' END ) c_cli_nod_qii_dir,
	        max(CASE WHEN e.ie_nod_uqlat_dir='S' THEN '3'  ELSE '0' END ) c_cli_nod_uqext_dir,
	        max(CASE WHEN e.ie_nod_uqsup_dir='S' THEN '3'  ELSE '0' END ) c_cli_nod_uqsup_dir,
	        max(CASE WHEN e.ie_nod_uqmed_dir='S' THEN '3'  ELSE '0' END ) c_cli_nod_uqint_dir,
	        max(CASE WHEN e.ie_nod_uqinf_dir='S' THEN '3'  ELSE '0' END ) c_cli_nod_uqinf_dir,
	        max(CASE WHEN e.ie_nod_rra_dir='S' THEN '3'  ELSE '0' END ) c_cli_nod_rra_dir,
	        max(CASE WHEN e.ie_nod_pa_dir='S' THEN '3'  ELSE '0' END ) c_cli_nod_pa_dir,
	        max(CASE WHEN e.ie_esp_qsm_dir='S' THEN '3'  ELSE '0' END ) c_cli_esp_qse_dir,
	        max(CASE WHEN e.ie_esp_qim_dir='S' THEN '3'  ELSE '0' END ) c_cli_esp_qie_dir,
	        max(CASE WHEN e.ie_esp_qsl_dir='S' THEN '3'  ELSE '0' END ) c_cli_esp_qsi_dir,
	        max(CASE WHEN e.ie_esp_qil_dir='S' THEN '3'  ELSE '0' END ) c_cli_esp_qii_dir,
	        max(CASE WHEN e.ie_esp_uqlat_dir='S' THEN '3'  ELSE '0' END ) c_cli_esp_uqext_dir,
	        max(CASE WHEN e.ie_esp_uqsup_dir='S' THEN '3'  ELSE '0' END ) c_cli_esp_uqsup_dir,
	        max(CASE WHEN e.ie_esp_uqmed_dir='S' THEN '3'  ELSE '0' END ) c_cli_esp_uqint_dir,
	        max(CASE WHEN e.ie_esp_uqinf_dir='S' THEN '3'  ELSE '0' END ) c_cli_esp_uqinf_dir,
	        max(CASE WHEN e.ie_esp_rra_dir='S' THEN '3'  ELSE '0' END ) c_cli_esp_rra_dir,
	        max(CASE WHEN e.ie_esp_pa_dir='S' THEN '3'  ELSE '0' END ) c_cli_esp_pa_dir,
	        max(CASE WHEN e.ie_linf_axilar_dir='S' THEN '3'  ELSE '0' END ) c_cli_linf_ax_dir,
	        max(CASE WHEN e.ie_linf_supraclavic_dir='S' THEN '3'  ELSE '0' END ) c_cli_linf_supra_dir,
	        max(CASE WHEN e.ie_lesao_pap_esq='S' THEN '3'  ELSE '0' END ) c_cli_papil_esq,
	        max(coalesce(CASE WHEN e.ie_descarga_pap_esq='C' THEN '1' WHEN e.ie_descarga_pap_esq='H' THEN '2' END ,'0')) c_cli_desc_esq,
	        max(CASE WHEN e.ie_nod_qsm_esq='S' THEN '3'  ELSE '0' END ) c_cli_nod_qse_esq,
	        max(CASE WHEN e.ie_nod_qim_esq='S' THEN '3'  ELSE '0' END ) c_cli_nod_qie_esq,
	        max(CASE WHEN e.ie_nod_qsl_esq='S' THEN '3'  ELSE '0' END ) c_cli_nod_qsi_esq,
	        max(CASE WHEN e.ie_nod_qil_esq='S' THEN '3'  ELSE '0' END ) c_cli_nod_qii_esq,
	        max(CASE WHEN e.ie_nod_uqlat_esq='S' THEN '3'  ELSE '0' END ) c_cli_nod_uqext_esq,
	        max(CASE WHEN e.ie_nod_uqsup_esq='S' THEN '3'  ELSE '0' END ) c_cli_nod_uqsup_esq,
	        max(CASE WHEN e.ie_nod_uqmed_esq='S' THEN '3'  ELSE '0' END ) c_cli_nod_uqint_esq,
	        max(CASE WHEN e.ie_nod_uqinf_esq='S' THEN '3'  ELSE '0' END ) c_cli_nod_uqinf_esq,
	        max(CASE WHEN e.ie_nod_rra_esq='S' THEN '3'  ELSE '0' END ) c_cli_nod_rra_esq,
	        max(CASE WHEN e.ie_nod_pa_esq='S' THEN '3'  ELSE '0' END ) c_cli_nod_pa_esq,
	        max(CASE WHEN e.ie_esp_qsm_esq='S' THEN '3'  ELSE '0' END ) c_cli_esp_qse_esq,
	        max(CASE WHEN e.ie_esp_qim_esq='S' THEN '3'  ELSE '0' END ) c_cli_esp_qie_esq,
	        max(CASE WHEN e.ie_esp_qsl_esq='S' THEN '3'  ELSE '0' END ) c_cli_esp_qsi_esq,
	        max(CASE WHEN e.ie_esp_qil_esq='S' THEN '3'  ELSE '0' END ) c_cli_esp_qii_esq,
	        max(CASE WHEN e.ie_esp_uqlat_esq='S' THEN '3'  ELSE '0' END ) c_cli_esp_uqext_esq,
	        max(CASE WHEN e.ie_esp_uqsup_esq='S' THEN '3'  ELSE '0' END ) c_cli_esp_uqsup_esq,
	        max(CASE WHEN e.ie_esp_uqmed_esq='S' THEN '3'  ELSE '0' END ) c_cli_esp_uqint_esq,
	        max(CASE WHEN e.ie_esp_uqinf_esq='S' THEN '3'  ELSE '0' END ) c_cli_esp_uqinf_esq,
	        max(CASE WHEN e.ie_esp_rra_esq='S' THEN '3'  ELSE '0' END ) c_cli_esp_rra_esq,
	        max(CASE WHEN e.ie_esp_pa_esq='S' THEN '3'  ELSE '0' END ) c_cli_esp_pa_esq,
	        max(CASE WHEN e.ie_linf_axilar_esq='S' THEN '3'  ELSE '0' END ) c_cli_linf_ax_esq,
	        max(CASE WHEN e.ie_linf_supraclavic_esq='S' THEN '3'  ELSE '0' END ) c_cli_linf_supra_esq,
	        max(CASE WHEN e.ie_controle_rad='S' THEN '3'  ELSE '0' END ) c_controle_radiol,
	        max(CASE WHEN e.ie_rad_nodulo_dir='S' THEN '3'  ELSE '0' END ) c_rad_nodulo_dir,
	        max(CASE WHEN e.ie_rad_microcalcif_dir='S' THEN '3'  ELSE '0' END ) c_rad_microcal_dir,
	        max(CASE WHEN e.ie_rad_assim_focal_dir='S' THEN '3'  ELSE '0' END ) c_rad_assim_foc_dir,
	        max(CASE WHEN e.ie_rad_assim_difusa_dir='S' THEN '3'  ELSE '0' END ) c_rad_assim_dif_dir,
	        max(CASE WHEN e.ie_rad_area_densa_dir='S' THEN '3'  ELSE '0' END ) c_rad_area_dens_dir,
	        max(CASE WHEN e.ie_rad_distorcao_focal_dir='S' THEN '3'  ELSE '0' END ) c_rad_dist_arq_dir,
	        max(CASE WHEN e.ie_rad_nodulo_esq='S' THEN '3'  ELSE '0' END ) c_rad_nodulo_esq,
	        max(CASE WHEN e.ie_rad_microcalcif_esq='S' THEN '3'  ELSE '0' END ) c_rad_microcal_esq,
	        max(CASE WHEN e.ie_rad_assim_focal_esq='S' THEN '3'  ELSE '0' END ) c_rad_assim_foc_esq,
	        max(CASE WHEN e.ie_rad_assim_difusa_esq='S' THEN '3'  ELSE '0' END ) c_rad_assim_dif_esq,
	        max(CASE WHEN e.ie_rad_area_densa_esq='S' THEN '3'  ELSE '0' END ) c_rad_area_dens_esq,
	        max(CASE WHEN e.ie_rad_distorcao_focal_esq='S' THEN '3'  ELSE '0' END ) c_rad_dist_arq_esq,
	        max(CASE WHEN e.ie_lesao_diag_cancer='S' THEN '3'  ELSE '0' END ) c_lesao_diag,
	        max(CASE WHEN e.ie_diag_nodulo_dir='S' THEN '3'  ELSE '0' END ) c_diag_nodulo_dir,
	        max(CASE WHEN e.ie_diag_microcalcif_dir='S' THEN '3'  ELSE '0' END ) c_diag_microcal_dir,
	        max(CASE WHEN e.ie_diag_assim_focal_dir='S' THEN '3'  ELSE '0' END ) c_diag_assim_foc_dir,
	        max(CASE WHEN e.ie_diag_assim_difusa_dir='S' THEN '3'  ELSE '0' END ) c_diag_assim_dif_dir,
	        max(CASE WHEN e.ie_diag_area_densa_dir='S' THEN '3'  ELSE '0' END ) c_diag_area_dens_dir,
	        max(CASE WHEN e.ie_diag_distorcao_focal_dir='S' THEN '3'  ELSE '0' END ) c_diag_dist_arq_dir,
	        max(CASE WHEN e.ie_diag_nodulo_esq='S' THEN '3'  ELSE '0' END ) c_diag_nodulo_esq,
	        max(CASE WHEN e.ie_diag_microcalcif_esq='S' THEN '3'  ELSE '0' END ) c_diag_microcal_esq,
	        max(CASE WHEN e.ie_diag_assim_focal_esq='S' THEN '3'  ELSE '0' END ) c_diag_assim_foc_esq,
	        max(CASE WHEN e.ie_diag_assim_difusa_esq='S' THEN '3'  ELSE '0' END ) c_diag_assim_dif_esq,
	        max(CASE WHEN e.ie_diag_area_densa_esq='S' THEN '3'  ELSE '0' END ) c_diag_area_dens_esq,
	        max(CASE WHEN e.ie_diag_distorcao_focal_esq='S' THEN '3'  ELSE '0' END ) c_diag_dist_arq_esq,
	        max(CASE WHEN e.ie_aval_qt_neo_adjuvante='S' THEN '3'  ELSE '0' END ) c_avaliacao_adj,
	        max(CASE WHEN e.ie_mam_rastreamento='S' THEN '3'  ELSE '0' END ) c_mamo_rastr,
		max(to_char(e.dt_exame,'yyyymmdd')) d_exame
	into STRICT	c_cli_diag_w,
		c_cli_les_palpa_w,
		c_cli_papil_dir_w,
		c_cli_desc_dir_w,
		c_cli_nod_qse_dir_w,
		c_cli_nod_qie_dir_w,
		c_cli_nod_qsi_dir_w,
		c_cli_nod_qii_dir_w,
		c_cli_nod_uqext_dir_w,
		c_cli_nod_uqsup_dir_w,
		c_cli_nod_uqint_dir_w,
		c_cli_nod_uqinf_dir_w,
		c_cli_nod_rra_dir_w,
		c_cli_nod_pa_dir_w,
		c_cli_esp_qse_dir_w,
		c_cli_esp_qie_dir_w,
		c_cli_esp_qsi_dir_w,
		c_cli_esp_qii_dir_w,
		c_cli_esp_uqext_dir_w,
		c_cli_esp_uqsup_dir_w,
		c_cli_esp_uqint_dir_w,
		c_cli_esp_uqinf_dir_w,
		c_cli_esp_rra_dir_w,
		c_cli_esp_pa_dir_w,
		c_cli_linf_ax_dir_w,
		c_cli_linf_supra_dir_w,
		c_cli_papil_esq_w,
		c_cli_desc_esq_w,
		c_cli_nod_qse_esq_w,
		c_cli_nod_qie_esq_w,
		c_cli_nod_qsi_esq_w,
		c_cli_nod_qii_esq_w,
		c_cli_nod_uqext_esq_w,
		c_cli_nod_uqsup_esq_w,
		c_cli_nod_uqint_esq_w,
		c_cli_nod_uqinf_esq_w,
		c_cli_nod_rra_esq_w,
		c_cli_nod_pa_esq_w,
		c_cli_esp_qse_esq_w,
		c_cli_esp_qie_esq_w,
		c_cli_esp_qsi_esq_w,
		c_cli_esp_qii_esq_w,
		c_cli_esp_uqext_esq_w,
		c_cli_esp_uqsup_esq_w,
		c_cli_esp_uqint_esq_w,
		c_cli_esp_uqinf_esq_w,
		c_cli_esp_rra_esq_w,
		c_cli_esp_pa_esq_w,
		c_cli_linf_ax_esq_w,
		c_cli_linf_supra_esq_w,
		c_controle_radiol_w,
		c_rad_nodulo_dir_w,
		c_rad_microcal_dir_w,
		c_rad_assim_foc_dir_w,
		c_rad_assim_dif_dir_w,
		c_rad_area_dens_dir_w,
		c_rad_dist_arq_dir_w,
		c_rad_nodulo_esq_w,
		c_rad_microcal_esq_w,
		c_rad_assim_foc_esq_w,
		c_rad_assim_dif_esq_w,
		c_rad_area_dens_esq_w,
		c_rad_dist_arq_esq_w,
		c_lesao_diag_w,
		c_diag_nodulo_dir_w,
		c_diag_microcal_dir_w,
		c_diag_assim_foc_dir_w,
		c_diag_assim_dif_dir_w,
		c_diag_area_dens_dir_w,
		c_diag_dist_arq_dir_w,
		c_diag_nodulo_esq_w,
		c_diag_microcal_esq_w,
		c_diag_assim_foc_esq_w,
		c_diag_assim_dif_esq_w,
		c_diag_area_dens_esq_w,
		c_diag_dist_arq_esq_w,
		c_avaliacao_adj_w,
		c_mamo_rastr_w,
		d_exame_w
	from	sismama_mam_ind_clinica e
	where	e.nr_seq_sismama = nr_seq_sisma_w;
	
	select	max(nr_sequencia)
	into STRICT	nr_seq_rad_w
	from	sismama_anamnese_rad f
	where	f.nr_seq_sismama = nr_seq_sisma_w;
	
	select	max(to_char(f.dt_ult_mestruacao,'yyyymmdd')) d_ana_mestruac,
	        max(coalesce(CASE WHEN f.ie_nao_lembra_ult_menstr='S' THEN '3' END ,'0')) c_ana_mest_nlemb,
	        coalesce(max(to_char(substr(f.nr_idade_menopausa,1,2))),'0') c_ana_menop_idade,
	        max(CASE WHEN f.ie_nao_lembra_menopausa='S' THEN '3'  ELSE '0' END ) c_ana_menop_nlemb,
	        max(CASE WHEN f.ie_nunca_menstruou='S' THEN '3'  ELSE '0' END ) c_ana_nuncamest,
	        max(coalesce(CASE WHEN f.ie_remedio_menopausa='S' THEN '3' WHEN f.ie_remedio_menopausa='X' THEN '2' WHEN f.ie_remedio_menopausa='N' THEN '1' END ,'0')) c_ana_usahormonio,
	        max(coalesce(CASE WHEN Obter_Sexo_PF(cd_pessoa_fisica_w,'C')='M' THEN '0'  ELSE CASE WHEN f.ie_gravida='S' THEN '3' WHEN f.ie_gravida='X' THEN '2' WHEN f.ie_gravida='N' THEN '1' END  END ,'0')) c_ana_gravida,
	        max(CASE WHEN f.ie_radioterapia='S' THEN '3' WHEN f.ie_radioterapia='X' THEN '2' WHEN f.ie_radioterapia='N' THEN '1' END ) c_ana_radio,
	        max(CASE WHEN f.dt_radioterapia_dir='' THEN '0'  ELSE '3' END ) c_ana_radio_mdir,
	        max(substr(f.dt_radioterapia_dir,1,4)) c_ana_ano_direita,
	        max(CASE WHEN f.dt_radioterapia_esq='' THEN '0'  ELSE '3' END ) c_ana_radio_mesq,
	        max(substr(f.dt_radioterapia_esq,1,4)) c_ana_ano_esquerda,
	        max(substr(f.dt_tumorectomia_dir,1,4)) c_ana_ano_tumor_d,
	        max(substr(f.dt_tumorectomia_esq,1,4)) c_ana_ano_tumor_e,
	        max(substr(f.dt_segmentectomia_dir,1,4)) c_ana_ano_segmen_d,
	        max(substr(f.dt_segmentectomia_esq,1,4)) c_ana_ano_segmen_e,
	        max(substr(f.dt_dutectomia_dir,1,4)) c_ana_ano_dutect_d,
	        max(substr(f.dt_dutectomia_esq,1,4)) c_ana_ano_dutect_e,
	        max(substr(f.dt_mastectomia_dir,1,4)) c_ana_ano_mastec_d,
	        max(substr(f.dt_mastectomia_esq,1,4)) c_ana_ano_mastec_e,
	        max(substr(f.dt_mastectomia_pele_dir,1,4)) c_ana_ano_m_pele_d,
	        max(substr(f.dt_mastectomia_pele_esq,1,4)) c_ana_ano_m_pele_e,
	        max(substr(f.dt_esvaziamento_dir,1,4)) c_ana_ano_esvazia_d,
	        max(substr(f.dt_esvaziamento_esq,1,4)) c_ana_ano_esvazia_e,
	        max(substr(f.dt_biopsia_linf_sent_dir,1,4)) c_ana_ano_biopsia_d,
	        max(substr(f.dt_biopsia_linf_sent_esq,1,4)) c_ana_ano_biopsia_e,
	        max(substr(f.dt_reconstrucao_dir,1,4)) c_ana_ano_recon_d,
	        max(substr(f.dt_reconstrucao_esq,1,4)) c_ana_ano_recon_e,
	        max(substr(f.dt_plastic_redutora_dir,1,4)) c_ana_ano_plast_red_d,
	        max(substr(f.dt_plastic_redutora_esq,1,4)) c_ana_ano_plast_red_e,
	        max(substr(f.dt_plastic_implante_dir,1,4)) c_ana_ano_plast_imp_d,
	        max(substr(f.dt_plastic_implante_esq,1,4)) c_ana_ano_plast_imp_e,
	        max(CASE WHEN f.ie_nao_fez_cirurgia='S' THEN '3'  ELSE '0' END ) c_ana_naofezcirur,
		max(to_char(f.dt_recebimento,'yyyymmdd')) d_recebe
	into STRICT	d_ana_mestruac_w,
		c_ana_mest_nlemb_w,
		c_ana_menop_idade_w,
		c_ana_menop_nlemb_w,
		c_ana_nuncamest_w,
		c_ana_usahormonio_w,
		c_ana_gravida_w	,
		c_ana_radio_w	,
		c_ana_radio_mdir_w,
		c_ana_ano_direita_w,
		c_ana_radio_mesq_w,
		c_ana_ano_esquerda_w,
		c_ana_ano_tumor_d_w,
		c_ana_ano_tumor_e_w,
		c_ana_ano_segmen_d_w,
		c_ana_ano_segmen_e_w,
		c_ana_ano_dutect_d_w,
		c_ana_ano_dutect_e_w,
		c_ana_ano_mastec_d_w,
		c_ana_ano_mastec_e_w,
		c_ana_ano_m_pele_d_w,
		c_ana_ano_m_pele_e_w,
		c_ana_ano_esvazia_d_w,
		c_ana_ano_esvazia_e_w,
		c_ana_ano_biopsia_d_w,
		c_ana_ano_biopsia_e_w,
		c_ana_ano_recon_d_w,
		c_ana_ano_recon_e_w,
		c_ana_ano_plast_red_d_w,
		c_ana_ano_plast_red_e_w,
		c_ana_ano_plast_imp_d_w,
		c_ana_ano_plast_imp_e_w,
		c_ana_naofezcirur_w,
		d_recebe_w
	from	sismama_anamnese_rad f
	where	f.nr_seq_sismama = nr_seq_sisma_w
	and	f.nr_sequencia = nr_seq_rad_w;

	if (c_ana_menop_idade_w = '0') then
		begin
		c_ana_menop_nlemb_w := C_ANA_MENOP_NLEMB_C;--Alterado de 3 para 0 para a versao 12 do SISMAMA OS 313990 27/04/2011 Geliard.
		end;
	end if;

	select	max(substr(to_char(g.nr_filmes),1,2)) c_rad_num_film_d,
	        max(CASE WHEN g.ie_pele='N' THEN '1' WHEN g.ie_pele='E' THEN '2'  ELSE '3' END ) c_rad_pele_d,
	        max(CASE WHEN g.ie_composicao_mama='D' THEN '1' WHEN g.ie_composicao_mama='A' THEN '2' WHEN g.ie_composicao_mama='PD' THEN '3'  ELSE '4' END ) c_rad_composic_d,
	        max(coalesce(CASE WHEN g.ie_nodulo1='S' THEN '3' END ,'0')) c_nod_sim_01d,
	        max(coalesce(CASE WHEN g.ie_nod_localizacao1='1' THEN '01' WHEN g.ie_nod_localizacao1='5' THEN '02' WHEN g.ie_nod_localizacao1='2' THEN '03' WHEN g.ie_nod_localizacao1='6' THEN '04' WHEN g.ie_nod_localizacao1='3' THEN '05' WHEN g.ie_nod_localizacao1='7' THEN '06' WHEN g.ie_nod_localizacao1='10' THEN '07' WHEN g.ie_nod_localizacao1='8' THEN '08' WHEN g.ie_nod_localizacao1='4' THEN '09' WHEN g.ie_nod_localizacao1='11' THEN '10' WHEN g.ie_nod_localizacao1='9' THEN '11' END ,'00')) c_nod_loc_01d,
	        max(coalesce(g.ie_nod_tamanho1,'0')) c_nod_tam_01d,
	        max(coalesce(CASE WHEN g.ie_nod_contorno1='E' THEN '4' WHEN g.ie_nod_contorno1='I' THEN '3' WHEN g.ie_nod_contorno1='L' THEN '2' WHEN g.ie_nod_contorno1='R' THEN '1' END ,'0')) c_nod_cont_01d,
	        max(coalesce(CASE WHEN g.ie_nod_limite1='C' THEN '3' WHEN g.ie_nod_limite1='D' THEN '1' WHEN g.ie_nod_limite1='P' THEN '2' END ,'0')) c_nod_lim_01d,
	        max(coalesce(CASE WHEN g.ie_nodulo2='S' THEN '3' END ,'0')) c_nod_sim_02d,
	        max(coalesce(CASE WHEN g.ie_nod_localizacao2='1' THEN '01' WHEN g.ie_nod_localizacao2='5' THEN '02' WHEN g.ie_nod_localizacao2='2' THEN '03' WHEN g.ie_nod_localizacao2='6' THEN '04' WHEN g.ie_nod_localizacao2='3' THEN '05' WHEN g.ie_nod_localizacao2='7' THEN '06' WHEN g.ie_nod_localizacao2='10' THEN '07' WHEN g.ie_nod_localizacao2='8' THEN '08' WHEN g.ie_nod_localizacao2='4' THEN '09' WHEN g.ie_nod_localizacao2='11' THEN '10' WHEN g.ie_nod_localizacao2='9' THEN '11' END ,'00')) c_nod_loc_02d,
	        max(coalesce(g.ie_nod_tamanho2,'0')) c_nod_tam_02d,
	        max(coalesce(CASE WHEN g.ie_nod_contorno2='E' THEN '4' WHEN g.ie_nod_contorno2='I' THEN '3' WHEN g.ie_nod_contorno2='L' THEN '2' WHEN g.ie_nod_contorno2='R' THEN '1' END ,'0')) c_nod_cont_02d,
	        max(coalesce(CASE WHEN g.ie_nod_limite2='C' THEN '3' WHEN g.ie_nod_limite2='D' THEN '1' WHEN g.ie_nod_limite2='P' THEN '2' END ,'0')) c_nod_lim_02d,
	        max(coalesce(CASE WHEN g.ie_nodulo3='S' THEN '3' END ,'0')) c_nod_sim_03d,
	        max(coalesce(CASE WHEN g.ie_nod_localizacao3='1' THEN '01' WHEN g.ie_nod_localizacao3='5' THEN '02' WHEN g.ie_nod_localizacao3='2' THEN '03' WHEN g.ie_nod_localizacao3='6' THEN '04' WHEN g.ie_nod_localizacao3='3' THEN '05' WHEN g.ie_nod_localizacao3='7' THEN '06' WHEN g.ie_nod_localizacao3='10' THEN '07' WHEN g.ie_nod_localizacao3='8' THEN '08' WHEN g.ie_nod_localizacao3='4' THEN '09' WHEN g.ie_nod_localizacao3='11' THEN '10' WHEN g.ie_nod_localizacao3='9' THEN '11' END ,'00')) c_nod_loc_03d,
	        max(coalesce(g.ie_nod_tamanho3,'0')) c_nod_tam_03d,
	        max(coalesce(CASE WHEN g.ie_nod_contorno3='E' THEN '4' WHEN g.ie_nod_contorno3='I' THEN '3' WHEN g.ie_nod_contorno3='L' THEN '2' WHEN g.ie_nod_contorno3='R' THEN '1' END ,'0')) c_nod_cont_03d,
	        max(coalesce(CASE WHEN g.ie_nod_limite3='C' THEN '3' WHEN g.ie_nod_limite3='D' THEN '1' WHEN g.ie_nod_limite3='P' THEN '2' END ,'0')) c_nod_lim_03d,
	        max(coalesce(CASE WHEN g.ie_microcalcificacao1='S' THEN '3' END ,'0')) c_micro_sim_01d,
	        max(coalesce(CASE WHEN g.ie_micr_localizacao1='1' THEN '01' WHEN g.ie_micr_localizacao1='5' THEN '02' WHEN g.ie_micr_localizacao1='2' THEN '03' WHEN g.ie_micr_localizacao1='6' THEN '04' WHEN g.ie_micr_localizacao1='3' THEN '05' WHEN g.ie_micr_localizacao1='7' THEN '06' WHEN g.ie_micr_localizacao1='10' THEN '07' WHEN g.ie_micr_localizacao1='8' THEN '08' WHEN g.ie_micr_localizacao1='4' THEN '09' WHEN g.ie_micr_localizacao1='11' THEN '10' WHEN g.ie_micr_localizacao1='9' THEN '11' END ,'00')) c_micro_loc_01d,
	        max(coalesce(CASE WHEN g.ie_micr_forma1='A' THEN '1' WHEN g.ie_micr_forma1='I' THEN '3' WHEN g.ie_micr_forma1='P' THEN '2' WHEN g.ie_micr_forma1='R' THEN '4' END ,'0')) c_micro_form_01d,
	        max(coalesce(CASE WHEN g.ie_micr_distrib1='A' THEN '1' WHEN g.ie_micr_distrib1='S' THEN '2' WHEN g.ie_micr_distrib1='T' THEN '3' END ,'0')) c_micro_distr_01d,
	        max(coalesce(CASE WHEN g.ie_microcalcificacao2='S' THEN '3' END ,'0')) c_micro_sim_02d,
	        max(coalesce(CASE WHEN g.ie_micr_localizacao2='1' THEN '01' WHEN g.ie_micr_localizacao2='5' THEN '02' WHEN g.ie_micr_localizacao2='2' THEN '03' WHEN g.ie_micr_localizacao2='6' THEN '04' WHEN g.ie_micr_localizacao2='3' THEN '05' WHEN g.ie_micr_localizacao2='7' THEN '06' WHEN g.ie_micr_localizacao2='10' THEN '07' WHEN g.ie_micr_localizacao2='8' THEN '08' WHEN g.ie_micr_localizacao2='4' THEN '09' WHEN g.ie_micr_localizacao2='11' THEN '10' WHEN g.ie_micr_localizacao2='9' THEN '11' END ,'00')) c_micro_loc_02d,
	        max(coalesce(CASE WHEN g.ie_micr_forma2='A' THEN '1' WHEN g.ie_micr_forma2='I' THEN '3' WHEN g.ie_micr_forma2='P' THEN '2' WHEN g.ie_micr_forma2='R' THEN '4' END ,'0')) c_micro_form_02d,
	        max(coalesce(CASE WHEN g.ie_micr_distrib2='A' THEN '1' WHEN g.ie_micr_distrib2='S' THEN '2' WHEN g.ie_micr_distrib2='T' THEN '3' END ,'0')) c_micro_distr_02d,
	        max(coalesce(CASE WHEN g.ie_microcalcificacao3='S' THEN '3' END ,'0')) c_micro_sim_03d,
	        max(coalesce(CASE WHEN g.ie_micr_localizacao3='1' THEN '01' WHEN g.ie_micr_localizacao3='5' THEN '02' WHEN g.ie_micr_localizacao3='2' THEN '03' WHEN g.ie_micr_localizacao3='6' THEN '04' WHEN g.ie_micr_localizacao3='3' THEN '05' WHEN g.ie_micr_localizacao3='7' THEN '06' WHEN g.ie_micr_localizacao3='10' THEN '07' WHEN g.ie_micr_localizacao3='8' THEN '08' WHEN g.ie_micr_localizacao3='4' THEN '09' WHEN g.ie_micr_localizacao3='11' THEN '10' WHEN g.ie_micr_localizacao3='9' THEN '11' END ,'00')) c_micro_loc_03d,
	        max(coalesce(CASE WHEN g.ie_micr_forma3='A' THEN '1' WHEN g.ie_micr_forma3='I' THEN '3' WHEN g.ie_micr_forma3='P' THEN '2' WHEN g.ie_micr_forma3='R' THEN '4' END ,'0')) c_micro_form_03d,
	        max(coalesce(CASE WHEN g.ie_micr_distrib3='A' THEN '1' WHEN g.ie_micr_distrib3='S' THEN '2' WHEN g.ie_micr_distrib3='T' THEN '3' END ,'0')) c_micro_distr_03d,
	        max(coalesce(CASE WHEN g.ie_assim_focal1='S' THEN '3' END ,'0')) c_assi_foc_sim01d,
	        max(coalesce(CASE WHEN g.ie_assim_focal_loc1='1' THEN '01' WHEN g.ie_assim_focal_loc1='5' THEN '02' WHEN g.ie_assim_focal_loc1='2' THEN '03' WHEN g.ie_assim_focal_loc1='6' THEN '04' WHEN g.ie_assim_focal_loc1='3' THEN '05' WHEN g.ie_assim_focal_loc1='7' THEN '06' WHEN g.ie_assim_focal_loc1='10' THEN '07' WHEN g.ie_assim_focal_loc1='8' THEN '08' WHEN g.ie_assim_focal_loc1='4' THEN '09' WHEN g.ie_assim_focal_loc1='11' THEN '10' WHEN g.ie_assim_focal_loc1='9' THEN '11' END ,'00')) c_assi_foc_loc01d,
	        max(coalesce(CASE WHEN g.ie_assim_focal2='S' THEN '3' END ,'0')) c_assi_foc_sim02d,
	        max(coalesce(CASE WHEN g.ie_assim_focal_loc2='1' THEN '01' WHEN g.ie_assim_focal_loc2='5' THEN '02' WHEN g.ie_assim_focal_loc2='2' THEN '03' WHEN g.ie_assim_focal_loc2='6' THEN '04' WHEN g.ie_assim_focal_loc2='3' THEN '05' WHEN g.ie_assim_focal_loc2='7' THEN '06' WHEN g.ie_assim_focal_loc2='10' THEN '07' WHEN g.ie_assim_focal_loc2='8' THEN '08' WHEN g.ie_assim_focal_loc2='4' THEN '09' WHEN g.ie_assim_focal_loc2='11' THEN '10' WHEN g.ie_assim_focal_loc2='9' THEN '11' END ,'00')) c_assi_foc_loc02d,
	        max(coalesce(CASE WHEN g.ie_assim_difusa1='S' THEN '3' END ,'0')) c_assi_dif_sim01d,
	        max(coalesce(CASE WHEN g.ie_assim_difusa_loc1='1' THEN '01' WHEN g.ie_assim_difusa_loc1='5' THEN '02' WHEN g.ie_assim_difusa_loc1='2' THEN '03' WHEN g.ie_assim_difusa_loc1='6' THEN '04' WHEN g.ie_assim_difusa_loc1='3' THEN '05' WHEN g.ie_assim_difusa_loc1='7' THEN '06' WHEN g.ie_assim_difusa_loc1='10' THEN '07' WHEN g.ie_assim_difusa_loc1='8' THEN '08' WHEN g.ie_assim_difusa_loc1='4' THEN '09' WHEN g.ie_assim_difusa_loc1='11' THEN '10' WHEN g.ie_assim_difusa_loc1='9' THEN '11' END ,'00')) c_assi_difu_loc01d,
	        max(coalesce(CASE WHEN g.ie_assim_difusa2='S' THEN '3' END ,'0')) c_assi_dif_sim02d,
	        max(coalesce(CASE WHEN g.ie_assim_difusa_loc2='1' THEN '01' WHEN g.ie_assim_difusa_loc2='5' THEN '02' WHEN g.ie_assim_difusa_loc2='2' THEN '03' WHEN g.ie_assim_difusa_loc2='6' THEN '04' WHEN g.ie_assim_difusa_loc2='3' THEN '05' WHEN g.ie_assim_difusa_loc2='7' THEN '06' WHEN g.ie_assim_difusa_loc2='10' THEN '07' WHEN g.ie_assim_difusa_loc2='8' THEN '08' WHEN g.ie_assim_difusa_loc2='4' THEN '09' WHEN g.ie_assim_difusa_loc2='11' THEN '10' WHEN g.ie_assim_difusa_loc2='9' THEN '11' END ,'00')) c_assi_difu_loc02d,
	        max(coalesce(CASE WHEN g.ie_distor_focal1='S' THEN '3' END ,'0')) C_DIS_FOC_SIM01D,
	        max(coalesce(CASE WHEN g.ie_distor_foc_loc1='1' THEN '01' WHEN g.ie_distor_foc_loc1='5' THEN '02' WHEN g.ie_distor_foc_loc1='2' THEN '03' WHEN g.ie_distor_foc_loc1='6' THEN '04' WHEN g.ie_distor_foc_loc1='3' THEN '05' WHEN g.ie_distor_foc_loc1='7' THEN '06' WHEN g.ie_distor_foc_loc1='10' THEN '07' WHEN g.ie_distor_foc_loc1='8' THEN '08' WHEN g.ie_distor_foc_loc1='4' THEN '09' WHEN g.ie_distor_foc_loc1='11' THEN '10' WHEN g.ie_distor_foc_loc1='9' THEN '11' END ,'00')) C_DIS_FOC_LOC01D,
	        max(coalesce(CASE WHEN g.ie_distor_focal2='S' THEN '3' END ,'0')) C_DIS_FOC_SIM02D,
	        max(coalesce(CASE WHEN g.ie_distor_foc_loc2='1' THEN '01' WHEN g.ie_distor_foc_loc2='5' THEN '02' WHEN g.ie_distor_foc_loc2='2' THEN '03' WHEN g.ie_distor_foc_loc2='6' THEN '04' WHEN g.ie_distor_foc_loc2='3' THEN '05' WHEN g.ie_distor_foc_loc2='7' THEN '06' WHEN g.ie_distor_foc_loc2='10' THEN '07' WHEN g.ie_distor_foc_loc2='8' THEN '08' WHEN g.ie_distor_foc_loc2='4' THEN '09' WHEN g.ie_distor_foc_loc2='11' THEN '10' WHEN g.ie_distor_foc_loc2='9' THEN '11' END ,'00')) C_DIS_FOC_LOC02D,
	        max(coalesce(CASE WHEN g.ie_area_densa1='S' THEN '3' END ,'0')) c_ar_dens_sim01d,
	        max(coalesce(CASE WHEN g.ie_area_densa_loc1='1' THEN '01' WHEN g.ie_area_densa_loc1='5' THEN '02' WHEN g.ie_area_densa_loc1='2' THEN '03' WHEN g.ie_area_densa_loc1='6' THEN '04' WHEN g.ie_area_densa_loc1='3' THEN '05' WHEN g.ie_area_densa_loc1='7' THEN '06' WHEN g.ie_area_densa_loc1='10' THEN '07' WHEN g.ie_area_densa_loc1='8' THEN '08' WHEN g.ie_area_densa_loc1='4' THEN '09' WHEN g.ie_area_densa_loc1='11' THEN '10' WHEN g.ie_area_densa_loc1='9' THEN '11' END ,'00')) c_ar_dens_loc01d,
	        max(coalesce(CASE WHEN g.ie_area_densa2='S' THEN '3' END ,'0')) c_ar_dens_sim02d,
	        max(coalesce(CASE WHEN g.ie_area_densa_loc2='1' THEN '01' WHEN g.ie_area_densa_loc2='5' THEN '02' WHEN g.ie_area_densa_loc2='2' THEN '03' WHEN g.ie_area_densa_loc2='6' THEN '04' WHEN g.ie_area_densa_loc2='3' THEN '05' WHEN g.ie_area_densa_loc2='7' THEN '06' WHEN g.ie_area_densa_loc2='10' THEN '07' WHEN g.ie_area_densa_loc2='8' THEN '08' WHEN g.ie_area_densa_loc2='4' THEN '09' WHEN g.ie_area_densa_loc2='11' THEN '10' WHEN g.ie_area_densa_loc2='9' THEN '11' END ,'00')) c_ar_dens_loc02d,
	        max(coalesce(CASE WHEN g.ie_linf_visibilizado='N' THEN '1' WHEN g.ie_linf_visibilizado='V' THEN '5' END ,'0')) c_linf_aux_d,
	        max(coalesce(CASE WHEN g.ie_inf_aumentados='S' THEN '3' END ,'0')) c_linf_aux_aum_d,
	        max(coalesce(CASE WHEN g.ie_linf_densos='S' THEN '3' END ,'0')) c_linf_aux_denso_d,
	        max(coalesce(CASE WHEN g.ie_linf_confluentes='S' THEN '3' END ,'0')) c_linf_aux_conf_d,
	        max(coalesce(CASE WHEN g.ie_dilatacao_ductal='S' THEN '3'  ELSE '0' END ,'0'))	c_dilat_duc_d,
	        max(coalesce(CASE WHEN g.ie_nod_dens_gordura='S' THEN '3'  ELSE '0' END ,'0')) c_nod_den_d,
	        max(coalesce(CASE WHEN g.ie_nod_calcificado='S' THEN '3'  ELSE '0' END ,'0')) c_nod_cal_d,
	        max(coalesce(CASE WHEN g.ie_nod_dens_het='S' THEN '3'  ELSE '0' END ,'0')) c_nod_den_het_d,
	        max(coalesce(CASE WHEN g.ie_calcificacao_vasc='S' THEN '3'  ELSE '0' END ,'0')) c_calc_vasc_d,
	        max(coalesce(CASE WHEN g.ie_outra_calcif='S' THEN '3'  ELSE '0' END ,'0')) c_calc_asp_ben_d,
	        max(coalesce(CASE WHEN g.ie_linf_intramamario='S' THEN '3'  ELSE '0' END ,'0')) c_linf_intram_d,
	        max(coalesce(CASE WHEN g.ie_dist_arq_cirurg='S' THEN '3'  ELSE '0' END ,'0')) c_dis_arq_cir_d,
	        max(coalesce(CASE WHEN g.ie_implante_integro='S' THEN '3'  ELSE '0' END ,'0')) c_imp_integ_d,
	        max(coalesce(CASE WHEN g.ie_implante_ruptura='S' THEN '3'  ELSE '0' END ,'0')) c_imp_sin_rup_d,
		max(coalesce(CASE WHEN g.ie_mama_nao_radiog='S' THEN '3'  ELSE '0' END ,'0')) c_mama_dir_nao_rad
	into STRICT	c_rad_num_film_d_w,
		c_rad_pele_d_w	,
		c_rad_composic_d_w,
		c_nod_sim_01d_w ,
		c_nod_loc_01d_w ,
		c_nod_tam_01d_w ,
		c_nod_cont_01d_w,
		c_nod_lim_01d_w ,
		c_nod_sim_02d_w ,
		c_nod_loc_02d_w ,
		c_nod_tam_02d_w ,
		c_nod_cont_02d_w ,
		c_nod_lim_02d_w ,
		c_nod_sim_03d_w ,
		c_nod_loc_03d_w ,
		c_nod_tam_03d_w ,
		c_nod_cont_03d_w ,
		c_nod_lim_03d_w ,
		c_micro_sim_01d_w ,
		c_micro_loc_01d_w ,
		c_micro_form_01d_w ,
		c_micro_distr_01d_w ,
		c_micro_sim_02d_w ,
		c_micro_loc_02d_w ,
		c_micro_form_02d_w ,
		c_micro_distr_02d_w ,
		c_micro_sim_03d_w ,
		c_micro_loc_03d_w ,
		c_micro_form_03d_w ,
		c_micro_distr_03d_w ,
		c_assi_foc_sim01d_w ,
		c_assi_foc_loc01d_w ,
		c_assi_foc_sim02d_w ,
		c_assi_foc_loc02d_w ,
		c_assi_dif_sim01d_w ,
		c_assi_difu_loc01d_w ,
		c_assi_dif_sim02d_w ,
		c_assi_difu_loc02d_w ,
		c_dis_foc_sim01d_w ,
		c_dis_foc_loc01d_w ,
		c_dis_foc_sim02d_w ,
		c_dis_foc_loc02d_w ,
		c_ar_dens_sim01d_w ,
		c_ar_dens_loc01d_w ,
		c_ar_dens_sim02d_w ,
		c_ar_dens_loc02d_w ,
		c_linf_aux_d_w 	,
		c_linf_aux_aum_d_w ,
		c_linf_aux_denso_d_w ,
		c_linf_aux_conf_d_w ,
		c_dilat_duc_d_w ,
		c_nod_den_d_w 	,
		c_nod_cal_d_w 	,
		c_nod_den_het_d_w ,
		c_calc_vasc_d_w ,
		c_calc_asp_ben_d_w ,
		c_linf_intram_d_w ,
		c_dis_arq_cir_d_w ,
		c_imp_integ_d_w ,
		c_imp_sin_rup_d_w,
		c_mama_dir_nao_rad_w
	from	sismama_achado_rad g
	where	g.nr_seq_sismama = nr_seq_sisma_w
	and	g.ie_lado = 'D';

	begin
	select	max(substr(to_char(g.nr_filmes),1,2)) c_rad_num_film_e,
	        	max(CASE WHEN g.ie_pele='N' THEN '1' WHEN g.ie_pele='E' THEN '2'  ELSE '3' END ) c_rad_pele_e,
	        	max(CASE WHEN g.ie_composicao_mama='D' THEN '1' WHEN g.ie_composicao_mama='A' THEN '2' WHEN g.ie_composicao_mama='PD' THEN '3'  ELSE '4' END ) c_rad_composic_e,
	        	max(coalesce(CASE WHEN g.ie_nodulo1='S' THEN '3' END ,'0')) c_nod_sim_01e,
	        	max(coalesce(CASE WHEN g.ie_nod_localizacao1='1' THEN '01' WHEN g.ie_nod_localizacao1='5' THEN '02' WHEN g.ie_nod_localizacao1='2' THEN '03' WHEN g.ie_nod_localizacao1='6' THEN '04' WHEN g.ie_nod_localizacao1='3' THEN '05' WHEN g.ie_nod_localizacao1='7' THEN '06' WHEN g.ie_nod_localizacao1='10' THEN '07' WHEN g.ie_nod_localizacao1='8' THEN '08' WHEN g.ie_nod_localizacao1='4' THEN '09' WHEN g.ie_nod_localizacao1='11' THEN '10' WHEN g.ie_nod_localizacao1='9' THEN '11' END ,'00')) c_nod_loc_01e,
	        	max(coalesce(g.ie_nod_tamanho1,'0')) c_nod_tam_01e,
	        	max(coalesce(CASE WHEN g.ie_nod_contorno1='E' THEN '4' WHEN g.ie_nod_contorno1='I' THEN '3' WHEN g.ie_nod_contorno1='L' THEN '2' WHEN g.ie_nod_contorno1='R' THEN '1' END ,'0')) c_nod_cont_01e,
	        	max(coalesce(CASE WHEN g.ie_nod_limite1='C' THEN '3' WHEN g.ie_nod_limite1='D' THEN '1' WHEN g.ie_nod_limite1='P' THEN '2' END ,'0')) c_nod_lim_01e,
	        	max(coalesce(CASE WHEN g.ie_nodulo2='S' THEN '3' END ,'0')) c_nod_sim_02e,
	        	max(coalesce(CASE WHEN g.ie_nod_localizacao2='1' THEN '01' WHEN g.ie_nod_localizacao2='5' THEN '02' WHEN g.ie_nod_localizacao2='2' THEN '03' WHEN g.ie_nod_localizacao2='6' THEN '04' WHEN g.ie_nod_localizacao2='3' THEN '05' WHEN g.ie_nod_localizacao2='7' THEN '06' WHEN g.ie_nod_localizacao2='10' THEN '07' WHEN g.ie_nod_localizacao2='8' THEN '08' WHEN g.ie_nod_localizacao2='4' THEN '09' WHEN g.ie_nod_localizacao2='11' THEN '10' WHEN g.ie_nod_localizacao2='9' THEN '11' END ,'00')) c_nod_loc_02e,
	        	max(coalesce(g.ie_nod_tamanho2,'0')) c_nod_tam_02e,
	        	max(coalesce(CASE WHEN g.ie_nod_contorno2='E' THEN '4' WHEN g.ie_nod_contorno2='I' THEN '3' WHEN g.ie_nod_contorno2='L' THEN '2' WHEN g.ie_nod_contorno2='R' THEN '1' END ,'0')) c_nod_cont_02e,
	        	max(coalesce(CASE WHEN g.ie_nod_limite2='C' THEN '3' WHEN g.ie_nod_limite2='D' THEN '1' WHEN g.ie_nod_limite2='P' THEN '2' END ,'0')) c_nod_lim_02e,
	        	max(coalesce(CASE WHEN g.ie_nodulo3='S' THEN '3' END ,'0')) c_nod_sim_03e,
	        	max(coalesce(CASE WHEN g.ie_nod_localizacao3='1' THEN '01' WHEN g.ie_nod_localizacao3='5' THEN '02' WHEN g.ie_nod_localizacao3='2' THEN '03' WHEN g.ie_nod_localizacao3='6' THEN '04' WHEN g.ie_nod_localizacao3='3' THEN '05' WHEN g.ie_nod_localizacao3='7' THEN '06' WHEN g.ie_nod_localizacao3='10' THEN '07' WHEN g.ie_nod_localizacao3='8' THEN '08' WHEN g.ie_nod_localizacao3='4' THEN '09' WHEN g.ie_nod_localizacao3='11' THEN '10' WHEN g.ie_nod_localizacao3='9' THEN '11' END ,'00')) c_nod_loc_03e,
	        	max(coalesce(g.ie_nod_tamanho3,'0')) c_nod_tam_03e,
	        	max(coalesce(CASE WHEN g.ie_nod_contorno3='E' THEN '4' WHEN g.ie_nod_contorno3='I' THEN '3' WHEN g.ie_nod_contorno3='L' THEN '2' WHEN g.ie_nod_contorno3='R' THEN '1' END ,'0')) c_nod_cont_03e,
	        	max(coalesce(CASE WHEN g.ie_nod_limite3='C' THEN '3' WHEN g.ie_nod_limite3='D' THEN '1' WHEN g.ie_nod_limite3='P' THEN '2' END ,'0')) c_nod_lim_03e,
	        	max(coalesce(CASE WHEN g.ie_microcalcificacao1='S' THEN '3' END ,'0')) c_micro_sim_01e,
	        	max(coalesce(CASE WHEN g.ie_micr_localizacao1='1' THEN '01' WHEN g.ie_micr_localizacao1='5' THEN '02' WHEN g.ie_micr_localizacao1='2' THEN '03' WHEN g.ie_micr_localizacao1='6' THEN '04' WHEN g.ie_micr_localizacao1='3' THEN '05' WHEN g.ie_micr_localizacao1='7' THEN '06' WHEN g.ie_micr_localizacao1='10' THEN '07' WHEN g.ie_micr_localizacao1='8' THEN '08' WHEN g.ie_micr_localizacao1='4' THEN '09' WHEN g.ie_micr_localizacao1='11' THEN '10' WHEN g.ie_micr_localizacao1='9' THEN '11' END ,'00')) c_micro_loc_01e,
	        	max(coalesce(CASE WHEN g.ie_micr_forma1='A' THEN '1' WHEN g.ie_micr_forma1='I' THEN '3' WHEN g.ie_micr_forma1='P' THEN '2' WHEN g.ie_micr_forma1='R' THEN '4' END ,'0')) c_micro_form_01e,
	        	max(coalesce(CASE WHEN g.ie_micr_distrib1='A' THEN '1' WHEN g.ie_micr_distrib1='S' THEN '2' WHEN g.ie_micr_distrib1='T' THEN '3' END ,'0')) c_micro_distr_01e,
	        	max(coalesce(CASE WHEN g.ie_microcalcificacao2='S' THEN '3' END ,'0')) c_micro_sim_02e,
	        	max(coalesce(CASE WHEN g.ie_micr_localizacao2='1' THEN '01' WHEN g.ie_micr_localizacao2='5' THEN '02' WHEN g.ie_micr_localizacao2='2' THEN '03' WHEN g.ie_micr_localizacao2='6' THEN '04' WHEN g.ie_micr_localizacao2='3' THEN '05' WHEN g.ie_micr_localizacao2='7' THEN '06' WHEN g.ie_micr_localizacao2='10' THEN '07' WHEN g.ie_micr_localizacao2='8' THEN '08' WHEN g.ie_micr_localizacao2='4' THEN '09' WHEN g.ie_micr_localizacao2='11' THEN '10' WHEN g.ie_micr_localizacao2='9' THEN '11' END ,'00')) c_micro_loc_02e,
	        	max(coalesce(CASE WHEN g.ie_micr_forma2='A' THEN '1' WHEN g.ie_micr_forma2='I' THEN '3' WHEN g.ie_micr_forma2='P' THEN '2' WHEN g.ie_micr_forma2='R' THEN '4' END ,'0')) c_micro_form_02e,
	        	max(coalesce(CASE WHEN g.ie_micr_distrib2='A' THEN '1' WHEN g.ie_micr_distrib2='S' THEN '2' WHEN g.ie_micr_distrib2='T' THEN '3' END ,'0')) c_micro_distr_02e,
	        	max(coalesce(CASE WHEN g.ie_microcalcificacao3='S' THEN '3' END ,'0')) c_micro_sim_03e,
	        	max(coalesce(CASE WHEN g.ie_micr_localizacao3='1' THEN '01' WHEN g.ie_micr_localizacao3='5' THEN '02' WHEN g.ie_micr_localizacao3='2' THEN '03' WHEN g.ie_micr_localizacao3='6' THEN '04' WHEN g.ie_micr_localizacao3='3' THEN '05' WHEN g.ie_micr_localizacao3='7' THEN '06' WHEN g.ie_micr_localizacao3='10' THEN '07' WHEN g.ie_micr_localizacao3='8' THEN '08' WHEN g.ie_micr_localizacao3='4' THEN '09' WHEN g.ie_micr_localizacao3='11' THEN '10' WHEN g.ie_micr_localizacao3='9' THEN '11' END ,'00')) c_micro_loc_03e,
	        	max(coalesce(CASE WHEN g.ie_micr_forma3='A' THEN '1' WHEN g.ie_micr_forma3='I' THEN '3' WHEN g.ie_micr_forma3='P' THEN '2' WHEN g.ie_micr_forma3='R' THEN '4' END ,'0')) c_micro_form_03e,
	        	max(coalesce(CASE WHEN g.ie_micr_distrib3='A' THEN '1' WHEN g.ie_micr_distrib3='S' THEN '2' WHEN g.ie_micr_distrib3='T' THEN '3' END ,'0')) c_micro_distr_03e,
	        	max(coalesce(CASE WHEN g.ie_assim_focal1='S' THEN '3' END ,'0')) c_assi_foc_sim01e,
	        	max(coalesce(CASE WHEN g.ie_assim_focal_loc1='1' THEN '01' WHEN g.ie_assim_focal_loc1='5' THEN '02' WHEN g.ie_assim_focal_loc1='2' THEN '03' WHEN g.ie_assim_focal_loc1='6' THEN '04' WHEN g.ie_assim_focal_loc1='3' THEN '05' WHEN g.ie_assim_focal_loc1='7' THEN '06' WHEN g.ie_assim_focal_loc1='10' THEN '07' WHEN g.ie_assim_focal_loc1='8' THEN '08' WHEN g.ie_assim_focal_loc1='4' THEN '09' WHEN g.ie_assim_focal_loc1='11' THEN '10' WHEN g.ie_assim_focal_loc1='9' THEN '11' END ,'00')) c_assi_foc_loc01e,
	        	max(coalesce(CASE WHEN g.ie_assim_focal2='S' THEN '3' END ,'0')) c_assi_foc_sim02e,
	        	max(coalesce(CASE WHEN g.ie_assim_focal_loc2='1' THEN '01' WHEN g.ie_assim_focal_loc2='5' THEN '02' WHEN g.ie_assim_focal_loc2='2' THEN '03' WHEN g.ie_assim_focal_loc2='6' THEN '04' WHEN g.ie_assim_focal_loc2='3' THEN '05' WHEN g.ie_assim_focal_loc2='7' THEN '06' WHEN g.ie_assim_focal_loc2='10' THEN '07' WHEN g.ie_assim_focal_loc2='8' THEN '08' WHEN g.ie_assim_focal_loc2='4' THEN '09' WHEN g.ie_assim_focal_loc2='11' THEN '10' WHEN g.ie_assim_focal_loc2='9' THEN '11' END ,'00')) c_assi_foc_loc02e,
	        	max(coalesce(CASE WHEN g.ie_assim_difusa1='S' THEN '3' END ,'0')) C_ASSI_DIF_SIM01e,
	        	max(coalesce(CASE WHEN g.ie_assim_difusa_loc1='1' THEN '01' WHEN g.ie_assim_difusa_loc1='5' THEN '02' WHEN g.ie_assim_difusa_loc1='2' THEN '03' WHEN g.ie_assim_difusa_loc1='6' THEN '04' WHEN g.ie_assim_difusa_loc1='3' THEN '05' WHEN g.ie_assim_difusa_loc1='7' THEN '06' WHEN g.ie_assim_difusa_loc1='10' THEN '07' WHEN g.ie_assim_difusa_loc1='8' THEN '08' WHEN g.ie_assim_difusa_loc1='4' THEN '09' WHEN g.ie_assim_difusa_loc1='11' THEN '10' WHEN g.ie_assim_difusa_loc1='9' THEN '11' END ,'00')) C_ASSI_DIFU_LOC01e,
	        	max(coalesce(CASE WHEN g.ie_assim_difusa2='S' THEN '3' END ,'0')) C_ASSI_DIF_SIM02e,
	        	max(coalesce(CASE WHEN g.ie_assim_difusa_loc2='1' THEN '01' WHEN g.ie_assim_difusa_loc2='5' THEN '02' WHEN g.ie_assim_difusa_loc2='2' THEN '03' WHEN g.ie_assim_difusa_loc2='6' THEN '04' WHEN g.ie_assim_difusa_loc2='3' THEN '05' WHEN g.ie_assim_difusa_loc2='7' THEN '06' WHEN g.ie_assim_difusa_loc2='10' THEN '07' WHEN g.ie_assim_difusa_loc2='8' THEN '08' WHEN g.ie_assim_difusa_loc2='4' THEN '09' WHEN g.ie_assim_difusa_loc2='11' THEN '10' WHEN g.ie_assim_difusa_loc2='9' THEN '11' END ,'00')) C_ASSI_DIFU_LOC02e,
	        	max(coalesce(CASE WHEN g.ie_distor_focal1='S' THEN '3' END ,'0')) C_DIS_FOC_SIM01e,
	        	max(coalesce(CASE WHEN g.ie_distor_foc_loc1='1' THEN '01' WHEN g.ie_distor_foc_loc1='5' THEN '02' WHEN g.ie_distor_foc_loc1='2' THEN '03' WHEN g.ie_distor_foc_loc1='6' THEN '04' WHEN g.ie_distor_foc_loc1='3' THEN '05' WHEN g.ie_distor_foc_loc1='7' THEN '06' WHEN g.ie_distor_foc_loc1='10' THEN '07' WHEN g.ie_distor_foc_loc1='8' THEN '08' WHEN g.ie_distor_foc_loc1='4' THEN '09' WHEN g.ie_distor_foc_loc1='11' THEN '10' WHEN g.ie_distor_foc_loc1='9' THEN '11' END ,'00')) C_DIS_FOC_LOC01e,
	        	max(coalesce(CASE WHEN g.ie_distor_focal2='S' THEN '3' END ,'0')) C_DIS_FOC_SIM02e,
	        	max(coalesce(CASE WHEN g.ie_distor_foc_loc2='1' THEN '01' WHEN g.ie_distor_foc_loc2='5' THEN '02' WHEN g.ie_distor_foc_loc2='2' THEN '03' WHEN g.ie_distor_foc_loc2='6' THEN '04' WHEN g.ie_distor_foc_loc2='3' THEN '05' WHEN g.ie_distor_foc_loc2='7' THEN '06' WHEN g.ie_distor_foc_loc2='10' THEN '07' WHEN g.ie_distor_foc_loc2='8' THEN '08' WHEN g.ie_distor_foc_loc2='4' THEN '09' WHEN g.ie_distor_foc_loc2='11' THEN '10' WHEN g.ie_distor_foc_loc2='9' THEN '11' END ,'00')) C_DIS_FOC_LOC02e,
	        	max(coalesce(CASE WHEN g.ie_area_densa1='S' THEN '3' END ,'0')) c_ar_dens_sim01e,
	        	max(coalesce(CASE WHEN g.ie_area_densa_loc1='1' THEN '01' WHEN g.ie_area_densa_loc1='5' THEN '02' WHEN g.ie_area_densa_loc1='2' THEN '03' WHEN g.ie_area_densa_loc1='6' THEN '04' WHEN g.ie_area_densa_loc1='3' THEN '05' WHEN g.ie_area_densa_loc1='7' THEN '06' WHEN g.ie_area_densa_loc1='10' THEN '07' WHEN g.ie_area_densa_loc1='8' THEN '08' WHEN g.ie_area_densa_loc1='4' THEN '09' WHEN g.ie_area_densa_loc1='11' THEN '10' WHEN g.ie_area_densa_loc1='9' THEN '11' END ,'00')) c_ar_dens_loc01e,
	        	max(coalesce(CASE WHEN g.ie_area_densa2='S' THEN '3' END ,'0')) c_ar_dens_sim02e,
	        	max(coalesce(CASE WHEN g.ie_area_densa_loc2='1' THEN '01' WHEN g.ie_area_densa_loc2='5' THEN '02' WHEN g.ie_area_densa_loc2='2' THEN '03' WHEN g.ie_area_densa_loc2='6' THEN '04' WHEN g.ie_area_densa_loc2='3' THEN '05' WHEN g.ie_area_densa_loc2='7' THEN '06' WHEN g.ie_area_densa_loc2='10' THEN '07' WHEN g.ie_area_densa_loc2='8' THEN '08' WHEN g.ie_area_densa_loc2='4' THEN '09' WHEN g.ie_area_densa_loc2='11' THEN '10' WHEN g.ie_area_densa_loc2='9' THEN '11' END ,'00')) c_ar_dens_loc02e,
	        	max(coalesce(CASE WHEN g.ie_linf_visibilizado='N' THEN '1' WHEN g.ie_linf_visibilizado='V' THEN '5' END ,'0')) c_linf_aux_e,
	        	max(coalesce(CASE WHEN g.ie_inf_aumentados='S' THEN '3' END ,'0')) c_linf_aux_aum_e,
	        	max(coalesce(CASE WHEN g.ie_linf_densos='S' THEN '3' END ,'0')) c_linf_aux_denso_e,
	        	max(coalesce(CASE WHEN g.ie_linf_confluentes='S' THEN '3' END ,'0')) c_linf_aux_conf_e,
	        	max(coalesce(CASE WHEN g.ie_dilatacao_ductal='S' THEN '3'  ELSE '0' END ,'0'))	c_dilat_duc_e,
	        	max(coalesce(CASE WHEN g.ie_nod_dens_gordura='S' THEN '3'  ELSE '0' END ,'0')) c_nod_den_e,
	        	max(coalesce(CASE WHEN g.ie_nod_calcificado='S' THEN '3'  ELSE '0' END ,'0')) c_nod_cal_e,
	        	max(coalesce(CASE WHEN g.ie_nod_dens_het='S' THEN '3'  ELSE '0' END ,'0')) c_nod_den_het_e,
	        	max(coalesce(CASE WHEN g.ie_calcificacao_vasc='S' THEN '3'  ELSE '0' END ,'0')) c_calc_vasc_e,
	        	max(coalesce(CASE WHEN g.ie_outra_calcif='S' THEN '3'  ELSE '0' END ,'0')) C_CALC_ASP_BEM_E,
	        	max(coalesce(CASE WHEN g.ie_linf_intramamario='S' THEN '3'  ELSE '0' END ,'0')) c_linf_intram_e,
	        	max(coalesce(CASE WHEN g.ie_dist_arq_cirurg='S' THEN '3'  ELSE '0' END ,'0')) c_dis_arq_cir_e,
	        	max(coalesce(CASE WHEN g.ie_implante_integro='S' THEN '3'  ELSE '0' END ,'0')) c_imp_integ_e,
	        	max(coalesce(CASE WHEN g.ie_implante_ruptura='S' THEN '3'  ELSE '0' END ,'0')) c_imp_sin_rup_e,
			max(coalesce(CASE WHEN g.ie_mama_nao_radiog='S' THEN '3'  ELSE '0' END ,'0')) c_mama_esq_nao_rad
	into STRICT	c_rad_num_film_e_w,
		c_rad_pele_e_w,
		c_rad_composic_e_w,
		c_nod_sim_01e_w,
		c_nod_loc_01e_w,
		c_nod_tam_01e_w,
		c_nod_cont_01e_w,
		c_nod_lim_01e_w,
		c_nod_sim_02e_w,
		c_nod_loc_02e_w,
		c_nod_tam_02e_w,
		c_nod_cont_02e_w,
		c_nod_lim_02e_w,
		c_nod_sim_03e_w,
		c_nod_loc_03e_w,
		c_nod_tam_03e_w,
		c_nod_cont_03e_w,
		c_nod_lim_03e_w,
		c_micro_sim_01e_w,
		c_micro_loc_01e_w,
		c_micro_form_01e_w,
		c_micro_distr_01e_w,
		c_micro_sim_02e_w,
		c_micro_loc_02e_w,
		c_micro_form_02e_w,
		c_micro_distr_02e_w,
		c_micro_sim_03e_w,
		c_micro_loc_03e_w,
		c_micro_form_03e_w,
		c_micro_distr_03e_w,
		c_assi_foc_sim01e_w,
		c_assi_foc_loc01e_w,
		c_assi_foc_sim02e_w,
		c_assi_foc_loc02e_w,
		c_assi_dif_sim01e_w,
		c_assi_difu_loc01e_w,
		c_assi_dif_sim02e_w,
		c_assi_difu_loc02e_w,
		c_dis_foc_sim01e_w,
		c_dis_foc_loc01e_w,
		c_dis_foc_sim02e_w,
		c_dis_foc_loc02e_w,
		c_ar_dens_sim01e_w,
		c_ar_dens_loc01e_w,
		c_ar_dens_sim02e_w,
		c_ar_dens_loc02e_w,
		c_linf_aux_e_w ,
		c_linf_aux_aum_e_w,
		c_linf_aux_denso_e_w,
		c_linf_aux_conf_e_w,
		c_dilat_duc_e_w,
		c_nod_den_e_w,
		c_nod_cal_e_w,
		c_nod_den_het_e_w,
		c_calc_vasc_e_w,
		c_calc_asp_bem_e_w,
		c_linf_intram_e_w,
		c_dis_arq_cir_e_w,
		c_imp_integ_e_w,
		c_imp_sin_rup_e_w,
		c_mama_esq_nao_rad_w
	from	sismama_achado_rad g
	where	g.nr_seq_sismama = nr_seq_sisma_w
	and	g.ie_lado = 'E';
	exception
		when others then
		CALL wheb_mensagem_pck.exibir_mensagem_abort(201200,'NR_SEQ_SISMAMA='||nr_seq_sisma_w);
		/*Problemas ao obter as informacoes do achado radiologico esquerdo do laudo*/

		end;

	begin
	select	ie_categoria_dir c_con_dia_cat_d,
		ie_categoria_esq c_con_dia_cat_e,
		ie_recomendacao_dir c_con_recom_d,
		ie_recomendacao_esq c_con_recom_e,
		substr(obter_dados_pf(h.CD_RESPONSAVEL,'CNS'),1,15) c_pat_cns,
		substr(obter_dados_pf(h.CD_RESPONSAVEL,'CPF'),1,11) c_pat_cic,
		substr(h.ds_observacao,1,150) c_obs_gerais,
		to_char(h.dt_liberacao,'yyyymmdd') d_libera
	into STRICT	c_con_dia_cat_d_w,
		c_con_dia_cat_e_w,
		c_con_recom_d_w,
		c_con_recom_e_w,
		c_pat_cns_w,
		c_pat_cic_w,
		c_obs_gerais_w,
		d_libera_w
	from	sismama_mam_conclusao h
	where	h.nr_seq_sismama = nr_seq_sisma_w;
	exception
                when no_data_found then
                CALL wheb_mensagem_pck.exibir_mensagem_abort(nr_seq_mensagem_p=>201201,vl_macros_p=>NR_SEQ_SISMAMA_C||nr_seq_sisma_w);
		end;

	insert into w_sismama_interf_mamo(
		nr_sequencia,
		c_cnes,
		c_exame,
		c_id_nome,
		c_id_nomemae,
		c_id_apel,
		d_id_dtnasc,
		c_id_ident,
		c_id_emis,
		c_id_ufide,
		c_id_cic,
		c_id_esco,
		c_id_endereco,
		c_id_numero,
		c_id_complem,
		c_id_bairro,
		c_id_uf,
		c_ibge,
		c_id_cep,
		c_id_refe,
		c_id_fone,
		c_id_sus,
		c_us_uf,
		c_us_ibge,
		c_us_cnes,
		c_us_nome,
		c_pron,
		c_anm_nod,
		c_anm_nod_md,
		c_anm_nod_me,
		c_anm_parente_cancer,
		c_anm_exa_prof,
		c_anm_mamograf,
		c_anm_mamo_ano,
		c_cli_diag,
		c_cli_les_palpa,
		c_cli_papil_dir,
		c_cli_desc_dir,
		c_cli_nod_qse_dir,
		c_cli_nod_qie_dir,
		c_cli_nod_qsi_dir,
		c_cli_nod_qii_dir,
		c_cli_nod_uqext_dir,
		c_cli_nod_uqsup_dir,
		c_cli_nod_uqint_dir,
		c_cli_nod_uqinf_dir,
		c_cli_nod_rra_dir,
		c_cli_nod_pa_dir,
		c_cli_esp_qse_dir,
		c_cli_esp_qie_dir,
		c_cli_esp_qsi_dir,
		c_cli_esp_qii_dir,
		c_cli_esp_uqext_dir,
		c_cli_esp_uqsup_dir,
		c_cli_esp_uqint_dir,
		c_cli_esp_uqinf_dir,
		c_cli_esp_rra_dir,
		c_cli_esp_pa_dir,
		c_cli_linf_ax_dir,
		c_cli_linf_supra_dir,
		c_cli_papil_esq,
		c_cli_desc_esq,
		c_cli_nod_qse_esq,
		c_cli_nod_qie_esq,
		c_cli_nod_qsi_esq,
		c_cli_nod_qii_esq,
		c_cli_nod_uqext_esq,
		c_cli_nod_uqsup_esq,
		c_cli_nod_uqint_esq,
		c_cli_nod_uqinf_esq,
		c_cli_nod_rra_esq,
		c_cli_nod_pa_esq,
		c_cli_esp_qse_esq,
		c_cli_esp_qie_esq,
		c_cli_esp_qsi_esq,
		c_cli_esp_qii_esq,
		c_cli_esp_uqext_esq,
		c_cli_esp_uqsup_esq,
		c_cli_esp_uqint_esq,
		c_cli_esp_uqinf_esq,
		c_cli_esp_rra_esq,
		c_cli_esp_pa_esq,
		c_cli_linf_ax_esq,
		c_cli_linf_supra_esq,
		c_controle_radiol,
		c_rad_nodulo_dir,
		c_rad_microcal_dir,
		c_rad_assim_foc_dir,
		c_rad_assim_dif_dir,
		c_rad_area_dens_dir,
		c_rad_dist_arq_dir,
		c_rad_nodulo_esq,
		c_rad_microcal_esq,
		c_rad_assim_foc_esq,
		c_rad_assim_dif_esq,
		c_rad_area_dens_esq,
		c_rad_dist_arq_esq,
		c_lesao_diag,
		c_diag_nodulo_dir,
		c_diag_microcal_dir,
		c_diag_assim_foc_dir,
		c_diag_assim_dif_dir,
		c_diag_area_dens_dir,
		c_diag_dist_arq_dir,
		c_diag_nodulo_esq,
		c_diag_microcal_esq,
		c_diag_assim_foc_esq,
		c_diag_assim_dif_esq,
		c_diag_area_dens_esq,
		c_diag_dist_arq_esq,
		c_avaliacao_adj,
		c_mamo_rastr,
		d_ana_mestruac,
		c_ana_mest_nlemb,
		c_ana_menop_idade,
		c_ana_menop_nlemb,
		c_ana_nuncamest,
		c_ana_usahormonio,
		c_ana_gravida,
		c_ana_radio,
		c_ana_radio_mdir,
		c_ana_ano_direita,
		c_ana_radio_mesq,
		c_ana_ano_esquerda,
		c_ana_ano_tumor_d,
		c_ana_ano_tumor_e,
		c_ana_ano_segmen_d,
		c_ana_ano_segmen_e,
		c_ana_ano_dutect_d,
		c_ana_ano_dutect_e,
		c_ana_ano_mastec_d,
		c_ana_ano_mastec_e,
		c_ana_ano_m_pele_d,
		c_ana_ano_m_pele_e,
		c_ana_ano_esvazia_d,
		c_ana_ano_esvazia_e,
		c_ana_ano_biopsia_d,
		c_ana_ano_biopsia_e,
		c_ana_ano_recon_d,
		c_ana_ano_recon_e,
		c_ana_ano_plast_red_d,
		c_ana_ano_plast_red_e,
		c_ana_ano_plast_imp_d,
		c_ana_ano_plast_imp_e,
		c_ana_naofezcirur,
		c_con_dia_cat_d,
		c_con_dia_cat_e,
		c_con_recom_d,
		c_con_recom_e,
		c_obs_gerais,
		d_recebe,
		d_exame,
		d_libera,
		c_pat_cns,
		c_pat_cic,
		c_id_sexo,
		c_id_racacor,
		nr_seq_sismama,
		cd_cnpj_unidade_saude,
		cd_estabelecimento,
		cd_pf_resp_emissao_filme,
		cd_profissional,
		dt_emissao,
		dt_liberacao,
		nr_seq_unidade_saude,
		nr_atendimento,
		nr_interno_conta,
		cd_pessoa_fisica,
		nr_seq_protocolo,
		dt_atualizacao,
		nm_usuario,
		dt_atualizacao_nrec,
		nm_usuario_nrec)
	values (	nextval('w_sismama_interf_mamo_seq'),
		c_cnes_w,
		c_exame_w,
		c_id_nome_w,
		c_id_nomemae_w,
		c_id_apel_w,
		d_id_dtnasc_w,
		c_id_ident_w,
		c_id_emis_w,
		c_id_ufide_w,
		c_id_cic_w,
		c_id_esco_w,
		c_id_endereco_w,
		c_id_numero_w,
		c_id_complem_w,
		c_id_bairro_w,
		c_id_uf_w,
		c_ibge_w,
		c_id_cep_w,
		c_id_refe_w,
		c_id_fone_w,
		c_id_sus_w,
		c_us_uf_w,
		c_us_ibge_w,
		c_us_cnes_w,
		c_us_nome_w,
		c_pron_w,
		c_anm_nod_w,
		coalesce(c_anm_nod_md_w,'0'),
		coalesce(c_anm_nod_me_w,'0'),
		coalesce(c_anm_parente_cancer_w,'1'),
		coalesce(c_anm_exa_prof_w,'0'),
		coalesce(c_anm_mamograf_w,'0'),
		c_anm_mamo_ano_w,
		coalesce(c_cli_diag_w,'0'),
		coalesce(c_cli_les_palpa_w,'0'),
		coalesce(c_cli_papil_dir_w,'0'),
		coalesce(c_cli_desc_dir_w,'0'),
		coalesce(c_cli_nod_qse_dir_w,'0'),
		coalesce(c_cli_nod_qie_dir_w,'0'),
		coalesce(c_cli_nod_qsi_dir_w,'0'),
		coalesce(c_cli_nod_qii_dir_w,'0'),
		coalesce(c_cli_nod_uqext_dir_w,'0'),
		coalesce(c_cli_nod_uqsup_dir_w,'0'),
		coalesce(c_cli_nod_uqint_dir_w,'0'),
		coalesce(c_cli_nod_uqinf_dir_w,'0'),
		coalesce(c_cli_nod_rra_dir_w,'0'),
		coalesce(c_cli_nod_pa_dir_w,'0'),
		coalesce(c_cli_esp_qse_dir_w,'0'),
		coalesce(c_cli_esp_qie_dir_w,'0'),
		coalesce(c_cli_esp_qsi_dir_w,'0'),
		coalesce(c_cli_esp_qii_dir_w,'0'),
		coalesce(c_cli_esp_uqext_dir_w,'0'),
		coalesce(c_cli_esp_uqsup_dir_w,'0'),
		coalesce(c_cli_esp_uqint_dir_w,'0'),
		coalesce(c_cli_esp_uqinf_dir_w,'0'),
		coalesce(c_cli_esp_rra_dir_w,'0'),
		coalesce(c_cli_esp_pa_dir_w,'0'),
		coalesce(c_cli_linf_ax_dir_w,'0'),
		coalesce(c_cli_linf_supra_dir_w,'0'),
		coalesce(c_cli_papil_esq_w,'0'),
		coalesce(c_cli_desc_esq_w,'0'),
		coalesce(c_cli_nod_qse_esq_w,'0'),
		coalesce(c_cli_nod_qie_esq_w,'0'),
		coalesce(c_cli_nod_qsi_esq_w,'0'),
		coalesce(c_cli_nod_qii_esq_w,'0'),
		coalesce(c_cli_nod_uqext_esq_w,'0'),
		coalesce(c_cli_nod_uqsup_esq_w,'0'),
		coalesce(c_cli_nod_uqint_esq_w,'0'),
		coalesce(c_cli_nod_uqinf_esq_w,'0'),
		coalesce(c_cli_nod_rra_esq_w,'0'),
		coalesce(c_cli_nod_pa_esq_w,'0'),
		coalesce(c_cli_esp_qse_esq_w,'0'),
		coalesce(c_cli_esp_qie_esq_w,'0'),
		coalesce(c_cli_esp_qsi_esq_w,'0'),
		coalesce(c_cli_esp_qii_esq_w,'0'),
		coalesce(c_cli_esp_uqext_esq_w,'0'),
		coalesce(c_cli_esp_uqsup_esq_w,'0'),
		coalesce(c_cli_esp_uqint_esq_w,'0'),
		coalesce(c_cli_esp_uqinf_esq_w,'0'),
		coalesce(c_cli_esp_rra_esq_w,'0'),
		coalesce(c_cli_esp_pa_esq_w,'0'),
		coalesce(c_cli_linf_ax_esq_w,'0'),
		coalesce(c_cli_linf_supra_esq_w,'0'),
		coalesce(c_controle_radiol_w,'0'),
		coalesce(c_rad_nodulo_dir_w,'0'),
		coalesce(c_rad_microcal_dir_w,'0'),
		coalesce(c_rad_assim_foc_dir_w,'0'),
		coalesce(c_rad_assim_dif_dir_w,'0'),
		coalesce(c_rad_area_dens_dir_w,'0'),
		coalesce(c_rad_dist_arq_dir_w,'0'),
		coalesce(c_rad_nodulo_esq_w,'0'),
		coalesce(c_rad_microcal_esq_w,'0'),
		coalesce(c_rad_assim_foc_esq_w,'0'),
		coalesce(c_rad_assim_dif_esq_w,'0'),
		coalesce(c_rad_area_dens_esq_w,'0'),
		coalesce(c_rad_dist_arq_esq_w,'0'),
		coalesce(c_lesao_diag_w,'0'),
		coalesce(c_diag_nodulo_dir_w,'0'),
		coalesce(c_diag_microcal_dir_w,'0'),
		coalesce(c_diag_assim_foc_dir_w,'0'),
		coalesce(c_diag_assim_dif_dir_w,'0'),
		coalesce(c_diag_area_dens_dir_w,'0'),
		coalesce(c_diag_dist_arq_dir_w,'0'),
		coalesce(c_diag_nodulo_esq_w,'0'),
		coalesce(c_diag_microcal_esq_w,'0'),
		coalesce(c_diag_assim_foc_esq_w,'0'),
		coalesce(c_diag_assim_dif_esq_w,'0'),
		coalesce(c_diag_area_dens_esq_w,'0'),
		coalesce(c_diag_dist_arq_esq_w,'0'),
		coalesce(c_avaliacao_adj_w,'0'),
		coalesce(c_mamo_rastr_w,'0'),
		d_ana_mestruac_w,
		coalesce(c_ana_mest_nlemb_w,'0'),
		c_ana_menop_idade_w,
		coalesce(c_ana_menop_nlemb_w,'0'),
		coalesce(c_ana_nuncamest_w,'0'),
		coalesce(c_ana_usahormonio_w,'0'),
		coalesce(c_ana_gravida_w,'0'),
		coalesce(c_ana_radio_w,'0'),
		coalesce(c_ana_radio_mdir_w,'0'),
		c_ana_ano_direita_w,
		coalesce(c_ana_radio_mesq_w,'0'),
		c_ana_ano_esquerda_w,
		c_ana_ano_tumor_d_w,
		c_ana_ano_tumor_e_w,
		c_ana_ano_segmen_d_w,
		c_ana_ano_segmen_e_w,
		c_ana_ano_dutect_d_w,
		c_ana_ano_dutect_e_w,
		c_ana_ano_mastec_d_w,
		c_ana_ano_mastec_e_w,
		c_ana_ano_m_pele_d_w,
		c_ana_ano_m_pele_e_w,
		c_ana_ano_esvazia_d_w,
		c_ana_ano_esvazia_e_w,
		c_ana_ano_biopsia_d_w,
		c_ana_ano_biopsia_e_w,
		c_ana_ano_recon_d_w,
		c_ana_ano_recon_e_w,
		c_ana_ano_plast_red_d_w,
		c_ana_ano_plast_red_e_w,
		c_ana_ano_plast_imp_d_w,
		c_ana_ano_plast_imp_e_w,
		coalesce(c_ana_naofezcirur_w,'0'),
		coalesce(c_con_dia_cat_d_w,'0'),
		coalesce(c_con_dia_cat_e_w,'0'),
		coalesce(c_con_recom_d_w,'0'),
		coalesce(c_con_recom_e_w,'0'),
		c_obs_gerais_w,
		d_recebe_w,
		d_exame_w,
		d_libera_w,
		c_pat_cns_w,
		c_pat_cic_w,
		c_id_sexo_w,
		c_id_racacor_w,
		nr_seq_sisma_w,
		cd_cgc_unidade_saude_w,
		cd_estabelecimento_w,
		cd_pf_resp_emissao_filme_w,
		cd_profissional_w,
		dt_emissao_w,
		dt_liberacao_w,
		nr_seq_unidade_saude_w,
		nr_atendimento_w,
		nr_interno_conta_w,
		cd_pessoa_fisica_w,
		nr_seq_protocolo_p,
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		nm_usuario_p);

	insert into w_sismama_interf_mrad(
		nr_sequencia,
		c_mama_dir_nao_rad,
		c_rad_num_film_d,
		c_rad_pele_d,
		c_rad_composic_d,
		c_nod_sim_01d,
		c_nod_loc_01d,
		c_nod_tam_01d,
		c_nod_cont_01d,
		c_nod_lim_01d,
		c_nod_sim_02d,
		c_nod_loc_02d,
		c_nod_tam_02d,
		c_nod_cont_02d,
		c_nod_lim_02d,
		c_nod_sim_03d,
		c_nod_loc_03d,
		c_nod_tam_03d,
		c_nod_cont_03d,
		c_nod_lim_03d,
		c_micro_sim_01d,
		c_micro_loc_01d,
		c_micro_form_01d,
		c_micro_distr_01d,
		c_micro_sim_02d,
		c_micro_loc_02d,
		c_micro_form_02d,
		c_micro_distr_02d,
		c_micro_sim_03d,
		c_micro_loc_03d,
		c_micro_form_03d,
		c_micro_distr_03d,
		c_assi_foc_sim01d,
		c_assi_foc_loc01d,
		c_assi_foc_sim02d,
		c_assi_foc_loc02d,
		c_assi_dif_sim01d,
		c_assi_difu_loc01d,
		c_assi_dif_sim02d,
		c_assi_difu_loc02d,
		c_dis_foc_sim01d,
		c_dis_foc_loc01d,
		c_dis_foc_sim02d,
		c_dis_foc_loc02d,
		c_ar_dens_sim01d,
		c_ar_dens_loc01d,
		c_ar_dens_sim02d,
		c_ar_dens_loc02d,
		c_linf_aux_d,
		c_linf_aux_aum_d,
		c_linf_aux_denso_d,
		c_linf_aux_conf_d,
		c_dilat_duc_d,
		c_nod_den_d,
		c_nod_cal_d,
		c_nod_den_het_d,
		c_calc_vasc_d,
		c_calc_asp_ben_d,
		c_linf_intram_d,
		c_dis_arq_cir_d,
		c_imp_integ_d,
		c_imp_sin_rup_d,
		c_mama_esq_nao_rad,
		c_rad_num_film_e,
		c_rad_pele_e,
		c_rad_composic_e,
		c_nod_sim_01e,
		c_nod_loc_01e,
		c_nod_tam_01e,
		c_nod_cont_01e,
		c_nod_lim_01e,
		c_nod_sim_02e,
		c_nod_loc_02e,
		c_nod_tam_02e,
		c_nod_cont_02e,
		c_nod_lim_02e,
		c_nod_sim_03e,
		c_nod_loc_03e,
		c_nod_tam_03e,
		c_nod_cont_03e,
		c_nod_lim_03e,
		c_micro_sim_01e,
		c_micro_loc_01e,
		c_micro_form_01e,
		c_micro_distr_01e,
		c_micro_sim_02e,
		c_micro_loc_02e,
		c_micro_form_02e,
		c_micro_distr_02e,
		c_micro_sim_03e,
		c_micro_loc_03e,
		c_micro_form_03e,
		c_micro_distr_03e,
		c_assi_foc_sim01e,
		c_assi_foc_loc01e,
		c_assi_foc_sim02e,
		c_assi_foc_loc02e,
		c_assi_dif_sim01e,
		c_assi_difu_loc01e,
		c_assi_dif_sim02e,
		c_assi_difu_loc02e,
		c_dis_foc_sim01e,
		c_dis_foc_loc01e,
		c_dis_foc_sim02e,
		c_dis_foc_loc02e,
		c_ar_dens_sim01e,
		c_ar_dens_loc01e,
		c_ar_dens_sim02e,
		c_ar_dens_loc02e,
		c_linf_aux_e,
		c_linf_aux_aum_e,
		c_linf_aux_denso_e,
		c_linf_aux_conf_e,
		c_dilat_duc_e,
		c_nod_den_e,
		c_nod_cal_e,
		c_nod_den_het_e,
		c_calc_vasc_e,
		c_calc_asp_bem_e,
		c_linf_intram_e,
		c_dis_arq_cir_e,
		c_imp_integ_e,
		c_imp_sin_rup_e,
		nr_seq_sismama,
		nr_atendimento,
		nr_interno_conta,
		cd_pessoa_fisica,
		nr_seq_protocolo,
		dt_atualizacao,
		nm_usuario,
		dt_atualizacao_nrec,
		nm_usuario_nrec)
	values (	nextval('w_sismama_interf_mrad_seq'),
		coalesce(c_mama_dir_nao_rad_w,'0'),
		to_char(coalesce(c_rad_num_film_d_w,0) + coalesce(c_rad_num_film_e_w,0)),
		coalesce(c_rad_pele_d_w,'0'),
		coalesce(c_rad_composic_d_w,'0'),
		coalesce(c_nod_sim_01d_w,'0'),
		coalesce(c_nod_loc_01d_w,'00'),
		coalesce(c_nod_tam_01d_w,'0'),
		coalesce(c_nod_cont_01d_w,'0'),
		coalesce(c_nod_lim_01d_w,'0'),
		coalesce(c_nod_sim_02d_w,'0'),
		coalesce(c_nod_loc_02d_w,'00'),
		coalesce(c_nod_tam_02d_w,'0'),
		coalesce(c_nod_cont_02d_w,'0'),
		coalesce(c_nod_lim_02d_w,'0'),
		coalesce(c_nod_sim_03d_w,'0'),
		coalesce(c_nod_loc_03d_w,'00'),
		coalesce(c_nod_tam_03d_w,'0'),
		coalesce(c_nod_cont_03d_w,'0'),
		coalesce(c_nod_lim_03d_w,'0'),
		coalesce(c_micro_sim_01d_w,'0'),
		coalesce(c_micro_loc_01d_w,'00'),
		coalesce(c_micro_form_01d_w,'0'),
		coalesce(c_micro_distr_01d_w,'0'),
		coalesce(c_micro_sim_02d_w,'0'),
		coalesce(c_micro_loc_02d_w,'00'),
		coalesce(c_micro_form_02d_w,'0'),
		coalesce(c_micro_distr_02d_w,'0'),
		coalesce(c_micro_sim_03d_w,'0'),
		coalesce(c_micro_loc_03d_w,'00'),
		coalesce(c_micro_form_03d_w,'0'),
		coalesce(c_micro_distr_03d_w,'0'),
		coalesce(c_assi_foc_sim01d_w,'0'),
		coalesce(c_assi_foc_loc01d_w,'00'),
		coalesce(c_assi_foc_sim02d_w,'0'),
		coalesce(c_assi_foc_loc02d_w,'00'),
		coalesce(c_assi_dif_sim01d_w,'0'),
		coalesce(c_assi_difu_loc01d_w,'00'),
		coalesce(c_assi_dif_sim02d_w,'0'),
		coalesce(c_assi_difu_loc02d_w,'00'),
		coalesce(c_dis_foc_sim01d_w,'0'),
		coalesce(c_dis_foc_loc01d_w,'00'),
		coalesce(c_dis_foc_sim02d_w,'0'),
		coalesce(c_dis_foc_loc02d_w,'00'),
		coalesce(c_ar_dens_sim01d_w,'0'),
		coalesce(c_ar_dens_loc01d_w,'00'),
		coalesce(c_ar_dens_sim02d_w,'0'),
		coalesce(c_ar_dens_loc02d_w,'00'),
		coalesce(c_linf_aux_d_w,'0'),
		coalesce(c_linf_aux_aum_d_w,'0'),
		coalesce(c_linf_aux_denso_d_w,'0'),
		coalesce(c_linf_aux_conf_d_w,'0'),
		coalesce(c_dilat_duc_d_w,'0'),
		coalesce(c_nod_den_d_w,'0'),
		coalesce(c_nod_cal_d_w,'0'),
		coalesce(c_nod_den_het_d_w,'0'),
		coalesce(c_calc_vasc_d_w,'0'),
		coalesce(c_calc_asp_ben_d_w,'0'),
		coalesce(c_linf_intram_d_w,'0'),
		coalesce(c_dis_arq_cir_d_w,'0'),
		coalesce(c_imp_integ_d_w,'0'),
		coalesce(c_imp_sin_rup_d_w,'0'),
		coalesce(c_mama_esq_nao_rad_w,'0'),
		' ',
		coalesce(c_rad_pele_e_w,'0'),
		coalesce(c_rad_composic_e_w,'0'),
		coalesce(c_nod_sim_01e_w,'0'),
		coalesce(c_nod_loc_01e_w,'00'),
		coalesce(c_nod_tam_01e_w,'0'),
		coalesce(c_nod_cont_01e_w,'0'),
		coalesce(c_nod_lim_01e_w,'0'),
		coalesce(c_nod_sim_02e_w,'0'),
		coalesce(c_nod_loc_02e_w,'00'),
		coalesce(c_nod_tam_02e_w,'0'),
		coalesce(c_nod_cont_02e_w,'0'),
		coalesce(c_nod_lim_02e_w,'0'),
		coalesce(c_nod_sim_03e_w,'0'),
		coalesce(c_nod_loc_03e_w,'00'),
		coalesce(c_nod_tam_03e_w,'0'),
		coalesce(c_nod_cont_03e_w,'0'),
		coalesce(c_nod_lim_03e_w,'0'),
		coalesce(c_micro_sim_01e_w,'0'),
		coalesce(c_micro_loc_01e_w,'00'),
		coalesce(c_micro_form_01e_w,'0'),
		coalesce(c_micro_distr_01e_w,'0'),
		coalesce(c_micro_sim_02e_w,'0'),
		coalesce(c_micro_loc_02e_w,'00'),
		coalesce(c_micro_form_02e_w,'0'),
		coalesce(c_micro_distr_02e_w,'0'),
		coalesce(c_micro_sim_03e_w,'0'),
		coalesce(c_micro_loc_03e_w,'00'),
		coalesce(c_micro_form_03e_w,'0'),
		coalesce(c_micro_distr_03e_w,'0'),
		coalesce(c_assi_foc_sim01e_w,'0'),
		coalesce(c_assi_foc_loc01e_w,'00'),
		coalesce(c_assi_foc_sim02e_w,'0'),
		coalesce(c_assi_foc_loc02e_w,'00'),
		coalesce(c_assi_dif_sim01e_w,'0'),
		coalesce(c_assi_difu_loc01e_w,'00'),
		coalesce(c_assi_dif_sim02e_w,'0'),
		coalesce(c_assi_difu_loc02e_w,'00'),
		coalesce(c_dis_foc_sim01e_w,'0'),
		coalesce(c_dis_foc_loc01e_w,'00'),
		coalesce(c_dis_foc_sim02e_w,'0'),
		coalesce(c_dis_foc_loc02e_w,'00'),
		coalesce(c_ar_dens_sim01e_w,'0'),
		coalesce(c_ar_dens_loc01e_w,'00'),
		coalesce(c_ar_dens_sim02e_w,'0'),
		coalesce(c_ar_dens_loc02e_w,'00'),
		coalesce(c_linf_aux_e_w,'0'),
		coalesce(c_linf_aux_aum_e_w,'0'),
		coalesce(c_linf_aux_denso_e_w,'0'),
		coalesce(c_linf_aux_conf_e_w,'0'),
		coalesce(c_dilat_duc_e_w,'0'),
		coalesce(c_nod_den_e_w,'0'),
		coalesce(c_nod_cal_e_w,'0'),
		coalesce(c_nod_den_het_e_w,'0'),
		coalesce(c_calc_vasc_e_w,'0'),
		coalesce(c_calc_asp_bem_e_w,'0'),
		coalesce(c_linf_intram_e_w,'0'),
		coalesce(c_dis_arq_cir_e_w,'0'),
		coalesce(c_imp_integ_e_w,'0'),
		coalesce(c_imp_sin_rup_e_w,'0'),
		nr_seq_sisma_w,
		nr_atendimento_w,
		nr_interno_conta_w,
		cd_pessoa_fisica_w,
		nr_seq_protocolo_p,
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		nm_usuario_p);

	end;
end loop;
close C01;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_interf_mamo_sismama ( nr_seq_protocolo_p bigint, nm_usuario_p text) FROM PUBLIC;

