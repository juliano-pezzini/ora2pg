-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE generate_cnes_log_integra_prof ( cd_pessoa_fisica_p text, ds_detalhe_log_p text, nm_usuario_p text, nm_usuario_nrec_p text, nr_seq_cnes_identificacao_p bigint, nr_seq_tipo_vinculo_p bigint, nr_seq_vinculo_p bigint, ie_opcao_p text, cd_cpf_profissional_p text, nm_profissional_p text) AS $body$
BEGIN

if (ie_opcao_p = 'I') then
        begin
        insert into cnes_log_integra_prof(      cd_pessoa_fisica,
                                                ds_detalhe_log,
                                                dt_atualizacao,
                                                dt_atualizacao_nrec,
                                                nm_usuario,
                                                nm_usuario_nrec,
                                                nr_seq_cnes_identificacao,
                                                nr_seq_tipo_vinculo,
                                                nr_sequencia,
                                                nr_seq_vinculo,
                                                cd_cpf_profissional,
                                                nm_profissional)
                                        values ( cd_pessoa_fisica_p,
                                                ds_detalhe_log_p,
                                                clock_timestamp(),
                                                clock_timestamp(),
                                                nm_usuario_p,
                                                nm_usuario_nrec_p,
                                                nr_seq_cnes_identificacao_p,
                                                nr_seq_tipo_vinculo_p,
                                                nextval('cnes_log_integra_prof_seq'),
                                                nr_seq_vinculo_p,
                                                cd_cpf_profissional_p,
                                                nm_profissional_p);
        commit;
        end;
elsif (ie_opcao_p = 'D') then
        begin
        delete from cnes_log_integra_prof
        where   nm_usuario = nm_usuario_p
        or      nm_usuario_nrec = nm_usuario_nrec_p;
        commit;
        end;
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE generate_cnes_log_integra_prof ( cd_pessoa_fisica_p text, ds_detalhe_log_p text, nm_usuario_p text, nm_usuario_nrec_p text, nr_seq_cnes_identificacao_p bigint, nr_seq_tipo_vinculo_p bigint, nr_seq_vinculo_p bigint, ie_opcao_p text, cd_cpf_profissional_p text, nm_profissional_p text) FROM PUBLIC;

