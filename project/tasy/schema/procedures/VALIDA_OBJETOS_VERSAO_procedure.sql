-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE valida_objetos_versao () AS $body$
DECLARE


nm_objeto_w		varchar(50);
ie_tipo_objeto_w	varchar(15);
qt_processo_w		smallint	:= 0;
ds_comando_w		varchar(255);

c01 CURSOR FOR
	SELECT	object_name,
		object_type
	from	user_objects
	where	status = 'INVALID'
	and	object_name in (
		'GERAR_OBJETO_APLICACAO',
		'TASY_PREPARAR_BASE',
		'TASY_ATUALIZAR_BASE_VERSAO',
		'TASY_SINCRONIZAR_BASE',
		'TASY_ATUALIZAR_BASE',
		'VALIDA_OBJETOS_SISTEMA');

BEGIN

CALL gravar_processo_longo('','VALIDA_OBJETOS_VERSAO',null);

OPEN C01;
LOOP
     FETCH C01 INTO
	nm_objeto_w,
	ie_tipo_objeto_w;
     EXIT WHEN NOT FOUND; /* apply on C01 */
	ds_comando_w	:= 'ALTER PROCEDURE ' || nm_objeto_w || ' COMPILE';
	CALL gravar_processo_longo(ds_comando_w , 'VALIDA_OBJETOS_VERSAO', qt_processo_w);
	if (ie_tipo_objeto_w = 'PROCEDURE') then
		CALL exec_sql_dinamico('Tasy', ds_comando_w);
	elsif (ie_tipo_objeto_w = 'FUNCTION') then
		CALL exec_sql_dinamico('Tasy', ds_comando_w);
	end	if;
END LOOP;
CLOSE C01;

CALL gravar_processo_longo('','',0);

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE valida_objetos_versao () FROM PUBLIC;

