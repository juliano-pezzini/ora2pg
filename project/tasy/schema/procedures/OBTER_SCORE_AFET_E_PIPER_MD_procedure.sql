-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_score_afet_e_piper_md (qt_fadiga_agora_agradavel_P bigint, qt_fadiga_agora_aceitavel_P bigint, qt_fadiga_agora_protetora_P bigint, qt_fadiga_agora_positiva_P bigint, qt_fadiga_agora_normal_P bigint, QT_SCORE_AFETIVO_P INOUT bigint, qt_reg_significado_p INOUT bigint, qt_result_significado_p INOUT bigint ) AS $body$
DECLARE


	qt_reg_significado_w	integer := 0;
	qt_percent_subgrupo_w	integer := 0;
	qt_result_significado_w	double precision := 0;

BEGIN
	if (qt_fadiga_agora_agradavel_P IS NOT NULL AND qt_fadiga_agora_agradavel_P::text <> '') then
		qt_reg_significado_w	:= 	qt_reg_significado_w + 1;
		qt_result_significado_w := 	qt_result_significado_w +  coalesce(qt_fadiga_agora_agradavel_P,0);
	end if;
	if (qt_fadiga_agora_aceitavel_P IS NOT NULL AND qt_fadiga_agora_aceitavel_P::text <> '') then
		qt_reg_significado_w	:= 	qt_reg_significado_w + 1;
		qt_result_significado_w := 	qt_result_significado_w +  coalesce(qt_fadiga_agora_aceitavel_P,0);
	end if;
	if (qt_fadiga_agora_protetora_P IS NOT NULL AND qt_fadiga_agora_protetora_P::text <> '') then
		qt_reg_significado_w	:= 	qt_reg_significado_w + 1;
		qt_result_significado_w := 	qt_result_significado_w +  coalesce(qt_fadiga_agora_protetora_P,0);
	end if;
	if (qt_fadiga_agora_positiva_P IS NOT NULL AND qt_fadiga_agora_positiva_P::text <> '') then
		qt_reg_significado_w	:= 	qt_reg_significado_w + 1;
		qt_result_significado_w := 	qt_result_significado_w +  coalesce(qt_fadiga_agora_positiva_P,0);
	end if;
	if (qt_fadiga_agora_normal_P IS NOT NULL AND qt_fadiga_agora_normal_P::text <> '') then
		qt_reg_significado_w	:= 	qt_reg_significado_w + 1;
		qt_result_significado_w := 	qt_result_significado_w +  coalesce(qt_fadiga_agora_normal_P,0);
	end if;
	
	if (qt_reg_significado_w >= 4) then
		qt_percent_subgrupo_w	:= 	qt_percent_subgrupo_w + 1;
		QT_SCORE_AFETIVO_P	:= 	dividir_md(qt_result_significado_w,qt_reg_significado_w);
	end if;
	--- Fim MD2
  qt_reg_significado_p    := qt_reg_significado_w;
	qt_result_significado_p := qt_result_significado_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_score_afet_e_piper_md (qt_fadiga_agora_agradavel_P bigint, qt_fadiga_agora_aceitavel_P bigint, qt_fadiga_agora_protetora_P bigint, qt_fadiga_agora_positiva_P bigint, qt_fadiga_agora_normal_P bigint, QT_SCORE_AFETIVO_P INOUT bigint, qt_reg_significado_p INOUT bigint, qt_result_significado_p INOUT bigint ) FROM PUBLIC;

