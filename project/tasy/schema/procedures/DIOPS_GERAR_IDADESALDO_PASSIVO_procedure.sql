-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE diops_gerar_idadesaldo_passivo ( nr_seq_operadora_p bigint, nr_seq_transacao_p bigint, nr_seq_periodo_p bigint, nm_usuario_p text) AS $body$
DECLARE

				
cd_conta_contabil_w		varchar(20);
cd_conta_deb_w			varchar(20);
ie_tipo_vencimento_w		varchar(5);
vl_item_w			double precision;
vl_evento_liquidar_w		double precision;
vl_debito_operadora_w		double precision;
vl_comercializacao_w		double precision;
vl_debito_oper_w		double precision;
vl_prest_serv_as_w		double precision;
vl_outros_deb_pagar_w		double precision;
vl_deb_ben_con_seg_rec_w	double precision;
vl_dep_aquis_carre_w		double precision;
vl_restricao_w			double precision;
vl_eventos_sus_w		double precision;
vl_titulos_encargos_w		double precision;
ie_ordem_w			bigint	:= null;
nr_titulo_w			bigint;
nr_seq_cheque_cp_w		bigint;
nr_seq_movto_banco_pend_w	bigint;
qt_dias_vencidos_w		integer	:= 0;
cd_estabelecimento_w		estabelecimento.cd_estabelecimento%type;
cd_estab_periodo_w		estabelecimento.cd_estabelecimento%type;
cd_empresa_w			empresa.cd_empresa%type;
ie_idade_saldo_passivo_w	smallint;
dt_periodo_inicial_w		timestamp;
dt_periodo_final_w		timestamp;
dt_vencimento_w			timestamp;

C01 CURSOR FOR
	SELECT	a.ie_idade_saldo_passivo,
		b.cd_conta_contabil	
	from	diops_conta_idade_saldo	b,
		diops_idade_saldo	a
	where	a.nr_sequencia		= b.nr_seq_idade_saldo
	and	a.nr_seq_transacao	= nr_seq_transacao_p
	and	(a.ie_idade_saldo_passivo IS NOT NULL AND a.ie_idade_saldo_passivo::text <> '')
	order by a.ie_idade_saldo_passivo;

C02 CURSOR FOR
	SELECT	t.dt_vencimento_atual,
		b.cd_conta_contabil,
		dividir_sem_round((b.vl_titulo * obter_saldo_titulo_pagar(t.nr_titulo,dt_periodo_final_w)), t.vl_titulo) vl_titulo,
		t.nr_titulo,
		null nr_seq_cheque_cp,
		null nr_seq_movto_banco_pend,
		dividir_sem_round((b.vl_titulo * obter_saldo_titulo_pagar(t.nr_titulo,dt_periodo_final_w)), t.vl_titulo) vl_restricao,
		1 ie_ordem
	from	titulo_pagar_classif		b,
		titulo_pagar		   	t
	where	t.nr_titulo		   	= b.nr_titulo
	and	t.dt_emissao	  		< fim_dia(dt_periodo_final_w)
	and	b.cd_conta_contabil  		= cd_conta_contabil_w
	and	((coalesce(t.dt_liquidacao::text, '') = '') or (t.dt_liquidacao > last_day(dt_periodo_final_w)))
	--and	obter_saldo_titulo_pagar(t.nr_titulo,dt_periodo_final_w) > 0
	and	((coalesce(t.nr_seq_tributo::text, '') = '') or (ie_idade_saldo_passivo_w = '10'))
	and	t.ie_situacao			<> 'C'
	and	t.cd_estabelecimento		in (    SELECT  x.cd_estabelecimento
							from	empresa z,
								estabelecimento y,
								diops_estab_adicional x
							where	x.cd_estabelecimento = y.cd_estabelecimento
							and	y.cd_empresa = z.cd_empresa
							and	z.cd_empresa = cd_empresa_w
							
union

							select	cd_estab_periodo_w
							)
	
union all

	select	a.dt_vencimento,
		a.cd_conta_contabil,
		a.vl_titulo,
		a.nr_titulo,
		null nr_seq_cheque_cp,
		null nr_seq_movto_banco_pend,
		0 vl_restricao,
		2 ie_ordem
	from	(/* Títulos pendentes sem antecipação */
		select	t.dt_vencimento dt_vencimento,
			b.cd_conta_contabil cd_conta_contabil,
			obter_valor_classif_tit_rec(	t.nr_titulo,
							b.nr_sequencia,
							Obter_Saldo_Titulo_Receber(t.nr_titulo,dt_periodo_final_w)) vl_titulo,
			b.nr_titulo nr_titulo
		from	titulo_receber_classif		b,
			titulo_receber		   	t
		where	t.nr_titulo		   	= b.nr_titulo
		and	t.dt_emissao	  		< fim_dia(dt_periodo_final_w)
		and	b.cd_conta_contabil  		= cd_conta_contabil_w
		and	((coalesce(t.dt_liquidacao::text, '') = '') or (t.dt_liquidacao > dt_periodo_final_w))
		and	t.ie_situacao not in ('3')
		and	t.cd_estabelecimento		in (    select  x.cd_estabelecimento
								from	empresa z,
									estabelecimento y,
									diops_estab_adicional x
								where	x.cd_estabelecimento = y.cd_estabelecimento
								and	y.cd_empresa = z.cd_empresa
								and	z.cd_empresa = cd_empresa_w
								
union

								select	cd_estab_periodo_w
								)
		
union all

		/* Títulos pró-rata do último mês */

		select	t.dt_vencimento dt_vencimento,
			b.cd_conta_rec_pls cd_conta_contabil,
			sum(b.vl_antecipacao_mens) vl_titulo,
			t.nr_titulo nr_titulo
		from	pls_mensalidade		c,
			titulo_receber		t,
			titulo_rec_liq_cc	b,
			titulo_receber_liq	a
		where	b.nr_titulo		= a.nr_titulo
		and	a.nr_titulo		= t.nr_titulo
		and	b.nr_seq_baixa		= a.nr_sequencia
		and	c.nr_sequencia		= t.nr_seq_mensalidade
		and	b.cd_conta_rec_pls	= cd_conta_contabil_w
		and	b.vl_antecipacao_mens <> 0
		and	(b.nr_seq_mens_seg_item IS NOT NULL AND b.nr_seq_mens_seg_item::text <> '')
		and	a.dt_recebimento < fim_dia(last_day(dt_periodo_final_w))--28/03/2012 fim_dia
		and	c.dt_referencia between trunc(dt_periodo_final_w,'month') and fim_dia(last_day(dt_periodo_final_w))
		and	t.ie_situacao not in ('3')
		and	t.cd_estabelecimento	in (    select  x.cd_estabelecimento
							from	empresa z,
								estabelecimento y,
								diops_estab_adicional x
							where	x.cd_estabelecimento = y.cd_estabelecimento
							and	y.cd_empresa = z.cd_empresa
							and	z.cd_empresa = cd_empresa_w
							
union

							select	cd_estab_periodo_w
							)
		group by t.dt_vencimento,
			b.cd_conta_rec_pls,
			t.nr_titulo
		
union all

		/* Títulos com antecipação do mês seguinte */

		select	t.dt_vencimento dt_vencimento,
			b.cd_conta_rec_pls cd_conta_contabil,
			sum(b.vl_recebido) vl_titulo,
			t.nr_titulo nr_titulo
		from	pls_mensalidade		c,
			titulo_receber		t,
			titulo_rec_liq_cc	b,
			titulo_receber_liq	a
		where	b.nr_titulo		= a.nr_titulo
		and	a.nr_titulo		= t.nr_titulo
		and	b.nr_seq_baixa		= a.nr_sequencia
		and	c.nr_sequencia		= t.nr_seq_mensalidade
		and	b.cd_conta_rec_pls	= cd_conta_contabil_w
		and	a.dt_recebimento < fim_dia(last_day(dt_periodo_final_w))
		and	c.dt_referencia > fim_dia(last_day(dt_periodo_final_w))
		and	t.ie_situacao not in ('3')
		and	coalesce(b.ie_lote_pro_rata::text, '') = ''
		and	t.cd_estabelecimento	in (    select  x.cd_estabelecimento
							from	empresa z,
								estabelecimento y,
								diops_estab_adicional x
							where	x.cd_estabelecimento = y.cd_estabelecimento
							and	y.cd_empresa = z.cd_empresa
							and	z.cd_empresa = cd_empresa_w
							
union

							select	cd_estab_periodo_w
							)
		group by t.dt_vencimento,
			b.cd_conta_rec_pls,
			t.nr_titulo
		
union all

		/* Títulos com antecipação do mês seguinte  - nova contabilizacao*/

		select	t.dt_vencimento dt_vencimento,
			b.cd_conta_deb_pls cd_conta_contabil,
			sum(b.vl_contab_pro_rata) vl_titulo,
			t.nr_titulo nr_titulo
		from	pls_mensalidade		c,
			titulo_receber		t,
			titulo_rec_liq_cc	b,
			titulo_receber_liq	a
		where	b.nr_titulo		= a.nr_titulo
		and	a.nr_titulo		= t.nr_titulo
		and	b.nr_seq_baixa		= a.nr_sequencia
		and	c.nr_sequencia		= t.nr_seq_mensalidade
		and	b.cd_conta_deb_pls	= cd_conta_contabil_w

		and	a.dt_recebimento < fim_dia(last_day(dt_periodo_final_w))
		and	c.dt_referencia > fim_dia(last_day(dt_periodo_final_w))
		and	t.ie_situacao not in ('3')
		and	(b.ie_lote_pro_rata IS NOT NULL AND b.ie_lote_pro_rata::text <> '')
		and	t.cd_estabelecimento	in (    select  x.cd_estabelecimento
							from	empresa z,
								estabelecimento y,
								diops_estab_adicional x
							where	x.cd_estabelecimento = y.cd_estabelecimento
							and	y.cd_empresa = z.cd_empresa
							and	z.cd_empresa = cd_empresa_w
							
union

							select	cd_estab_periodo_w
							)
		group by t.dt_vencimento,
			b.cd_conta_deb_pls,
			t.nr_titulo) a
	where	ie_idade_saldo_passivo_w	= 7
	/* OS 219963 - 15/06/2010 13:50:07 - Segundo Claudinei do Itamed para o item 7, deve somar valor dos títulos a recever */

	
union all

	select	b.dt_transacao,
		c.cd_conta_contabil,
		sum(a.vl_saldo),
		null nr_titulo,
		null nr_seq_cheque_cp,
		a.nr_sequencia nr_seq_movto_banco_pend,
		0 vl_restricao,
		3 ie_ordem
	from	trans_financ_contab	c,
		movto_trans_financ	b,
		movto_banco_pend	a
	where	a.nr_seq_movto_trans_fin	= b.nr_sequencia
	and	b.nr_seq_trans_financ		= c.nr_seq_trans_financ
	and	a.dt_credito	< fim_dia(last_day(dt_periodo_final_w))
	and	((coalesce(a.dt_liquidacao::text, '') = '') or (a.dt_liquidacao > fim_dia(last_day(dt_periodo_final_w))))
	and	c.cd_conta_contabil	= cd_conta_contabil_w
	and	a.cd_estabelecimento	in (    select  x.cd_estabelecimento
						from	empresa z,
							estabelecimento y,
							diops_estab_adicional x
						where	x.cd_estabelecimento = y.cd_estabelecimento
						and	y.cd_empresa = z.cd_empresa
						and	z.cd_empresa = cd_empresa_w
						
union

						select	cd_estab_periodo_w
						)
	and 	1 = 2
	group by
		b.dt_transacao,
		c.cd_conta_contabil,
		a.nr_sequencia
	
union all

	select	a.dt_emissao,
		b.cd_conta_contabil,
		sum(a.vl_cheque),
		null nr_titulo,
		null nr_seq_movto_banco_pend,
		a.nr_sequencia nr_seq_cheque_cp,
		0 vl_restricao,
		4 ie_ordem
	from	trans_financ_contab	b,
		cheque			a
	where	a.nr_seq_trans_fin_emissao	= b.nr_seq_trans_financ
	and	a.dt_emissao	< fim_dia(last_day(dt_periodo_final_w))
	and	((coalesce(a.dt_compensacao::text, '') = '') or (a.dt_compensacao > fim_dia(last_day(dt_periodo_final_w))))
	and	b.cd_conta_contabil	= cd_conta_contabil_w
	and	a.cd_estabelecimento	in (    select  x.cd_estabelecimento
						from	empresa z,
							estabelecimento y,
							diops_estab_adicional x
						where	x.cd_estabelecimento = y.cd_estabelecimento
						and	y.cd_empresa = z.cd_empresa
						and	z.cd_empresa = cd_empresa_w
						
union

						select	cd_estab_periodo_w
						)
	group by
		a.dt_emissao,
		b.cd_conta_contabil,
		a.nr_sequencia;
	
	
C10 CURSOR FOR
	SELECT	vl_dominio
	from	valor_dominio_v
	where	cd_dominio	= 2742
	and	vl_dominio <> '365'
	and	vl_dominio not in (	SELECT	ie_tipo_vencimento
					from 	w_diops_fin_idadesaldo_pas
					where 	nr_seq_periodo	= nr_seq_periodo_p
					group by ie_tipo_vencimento);

C11 CURSOR FOR
	SELECT	ie_tipo_vencimento,
		coalesce(sum(vl_evento_liquidar),0),
		coalesce(sum(vl_debito_operadora),0), 
		coalesce(sum(vl_comercializacao),0),
		coalesce(sum(vl_debito_oper),0),
		coalesce(sum(vl_prest_serv_as),0),
		coalesce(sum(vl_outros_deb_pagar),0), 
		coalesce(sum(vl_deb_ben_con_seg_rec),0),
		coalesce(sum(vl_dep_aquis_carre),0),
		coalesce(sum(vl_eventos_sus),0),
		coalesce(sum(vl_titulos_encargos),0)
	from  	w_diops_fin_idadesaldo_pas
	where	nr_seq_periodo	= nr_seq_periodo_p
	group by ie_tipo_vencimento;
	

BEGIN
begin /* Obter o período trimestral do DIOPS */
select	coalesce(dt_periodo_inicial,''),
	coalesce(dt_periodo_final, ''),
	cd_estabelecimento
into STRICT	dt_periodo_inicial_w,
	dt_periodo_final_w,
	cd_estab_periodo_w
from	diops_periodo
where	nr_sequencia	= nr_seq_periodo_p;
exception
	when others then
	CALL wheb_mensagem_pck.exibir_mensagem_abort(183308,'NR_SEQ_OPERADORA='|| nr_seq_operadora_p || ';' || 'NR_SEQ_PERIODO=' || nr_seq_periodo_p);
end;	


begin
select	b.cd_empresa
into STRICT	cd_empresa_w
from	empresa b,
	estabelecimento a
where	b.cd_empresa = a.cd_empresa
and	a.cd_estabelecimento = cd_estab_periodo_w;
exception
when others then
	CALL wheb_mensagem_pck.exibir_mensagem_abort(183309,'NR_SEQ_OPERADORA='|| nr_seq_operadora_p);
end;

begin /* Obter o estabelecimento da operadora */
select	cd_estabelecimento
into STRICT	cd_estabelecimento_w
from	pls_outorgante
where	nr_sequencia	= nr_seq_operadora_p;
exception
	when others then
	CALL wheb_mensagem_pck.exibir_mensagem_abort(183309,'NR_SEQ_OPERADORA='|| nr_seq_operadora_p);
end;	

open C01;
loop
fetch C01 into
	ie_idade_saldo_passivo_w,
	cd_conta_contabil_w;
EXIT WHEN NOT FOUND; /* apply on C01 */
	begin
	open C02;
	loop
	fetch C02 into	
		dt_vencimento_w,
		cd_conta_deb_w,
		vl_item_w,
		nr_titulo_w,
		nr_seq_cheque_cp_w,
		nr_seq_movto_banco_pend_w,
		vl_restricao_w,
		ie_ordem_w;
	EXIT WHEN NOT FOUND; /* apply on C02 */
		begin
		if (ie_ordem_w = 1) then
			if (vl_restricao_w < 0) then
				goto final;
			end if;
		end if;
		
		if (dt_vencimento_w	> dt_periodo_final_w) then
			qt_dias_vencidos_w	:= 0;
		else
			qt_dias_vencidos_w	:= (dt_periodo_final_w - dt_vencimento_w);
			if (qt_dias_vencidos_w	< 0) then
				qt_dias_vencidos_w	:= 0;
			end if;
		end if;
		
		if (qt_dias_vencidos_w	= 0) then
			ie_tipo_vencimento_w	:= '00';
		elsif (qt_dias_vencidos_w	< 31) then
			ie_tipo_vencimento_w	:= '30';
		elsif (qt_dias_vencidos_w	< 61) then
			ie_tipo_vencimento_w	:= '60';
		elsif (qt_dias_vencidos_w	< 91) then
			ie_tipo_vencimento_w	:= '90';
		elsif (qt_dias_vencidos_w	< 121) then
			ie_tipo_vencimento_w	:= '120';
		/*elsif	(qt_dias_vencidos_w	< 366) then
			ie_tipo_vencimento_w	:= '365';*/
		else
			ie_tipo_vencimento_w	:= '999';
		end if;
		
		vl_evento_liquidar_w		:= 0;
		vl_debito_operadora_w		:= 0;
		vl_comercializacao_w		:= 0;
		vl_debito_oper_w		:= 0;
		vl_prest_serv_as_w		:= 0;
		vl_outros_deb_pagar_w		:= 0;
		vl_deb_ben_con_seg_rec_w	:= 0;
		vl_dep_aquis_carre_w		:= 0;
		vl_eventos_sus_w		:= 0;
		vl_titulos_encargos_w		:= 0;
		
		if (ie_idade_saldo_passivo_w = 1) then /* Eventos/Sinistros a liquidar */
			vl_evento_liquidar_w		:= vl_item_w;
		elsif (ie_idade_saldo_passivo_w = 2) then /* Débitos com operadoras */
			vl_debito_operadora_w		:= vl_item_w;
		elsif (ie_idade_saldo_passivo_w = 3) then /* Comercialização sobre operações */
			vl_comercializacao_w		:= vl_item_w;	
		elsif (ie_idade_saldo_passivo_w = 4) then /* Outros débitos de operações com planos */
			vl_debito_oper_w		:= vl_item_w;	
		elsif (ie_idade_saldo_passivo_w = 5) then /* Prestadores de serv. de assistência a sáude */
			vl_prest_serv_as_w		:= vl_item_w;	
		elsif (ie_idade_saldo_passivo_w = 6) then /* Outros débitos a pagar */
			vl_outros_deb_pagar_w		:= vl_item_w;	
		elsif (ie_idade_saldo_passivo_w = 7) then /* Depósitos de Beneficiários - Contraprest/ Seguros Recebidos */
			vl_deb_ben_con_seg_rec_w	:= vl_item_w;	
		elsif (ie_idade_saldo_passivo_w = 8) then /* Débitos com Aquisição de Carteira */
			vl_dep_aquis_carre_w		:= vl_item_w;
		elsif (ie_idade_saldo_passivo_w = 9) then /* SUS */
			vl_eventos_sus_w		:= vl_item_w;
		elsif (ie_idade_saldo_passivo_w = 10) then /* Tributos e Encargos a Recolher */
			vl_titulos_encargos_w		:= vl_item_w;
		end if;
		
		insert into w_diops_fin_idadesaldo_pas(nr_sequencia,
			nr_seq_operadora,
			nr_seq_transacao,
			nr_seq_periodo,
			ie_tipo_vencimento,
			vl_evento_liquidar,
			vl_debito_operadora,
			vl_comercializacao,
			vl_debito_oper,
			dt_atualizacao,
			nm_usuario,
			vl_prest_serv_as,
			vl_outros_deb_pagar,
			ie_idade_saldo_passivo,
			cd_conta_contabil,
			nr_titulo,
			vl_deb_ben_con_seg_rec,
			vl_dep_aquis_carre,
			nr_seq_cheque_cp,
			nr_seq_movto_banco_pend,
			vl_eventos_sus,
			vl_titulos_encargos)
		values (nextval('w_diops_fin_idadesaldo_pas_seq'),
			nr_seq_operadora_p,
			nr_seq_transacao_p,
			nr_seq_periodo_p,
			ie_tipo_vencimento_w,
			vl_evento_liquidar_w,
			vl_debito_operadora_w,
			vl_comercializacao_w,
			vl_debito_oper_w,
			clock_timestamp(),
			nm_usuario_p,
			vl_prest_serv_as_w,
			vl_outros_deb_pagar_w,
			ie_idade_saldo_passivo_w,
			cd_conta_deb_w,
			nr_titulo_w,
			vl_deb_ben_con_seg_rec_w,
			vl_dep_aquis_carre_w,
			nr_seq_cheque_cp_w,
			nr_seq_movto_banco_pend_w,
			vl_eventos_sus_w,
			vl_titulos_encargos_w);
			
		insert into diops_idadesaldo_contab(nr_sequencia,
			cd_estabelecimento,
			nr_seq_periodo,
			nr_seq_operadora,
			cd_conta_contabil,
			dt_atualizacao, 
			nm_usuario,
			dt_atualizacao_nrec,
			nm_usuario_nrec,
			ie_tipo_idade_saldo,
			ie_idade_saldo_passivo,
			vl_contabil, 
			nr_titulo)
		values (	nextval('diops_idadesaldo_contab_seq'),
			cd_estabelecimento_w,
			nr_seq_periodo_p, 
			nr_seq_operadora_p,
			cd_conta_deb_w,
			clock_timestamp(), 
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			'P',
			ie_idade_saldo_passivo_w,
			vl_item_w, 
			nr_titulo_w);
		
		<<final>>
		ie_ordem_w	:= ie_ordem_w;
		end;
	end loop;
	close C02;
	end;
end loop;
close C01;

open C10;
loop
fetch C10 into	
	ie_tipo_vencimento_w;
EXIT WHEN NOT FOUND; /* apply on C10 */
	begin
	insert into w_diops_fin_idadesaldo_pas(nr_sequencia,
		nr_seq_operadora,
		nr_seq_transacao,
		nr_seq_periodo,
		ie_tipo_vencimento,
		vl_evento_liquidar,
		vl_debito_operadora,
		vl_comercializacao,
		vl_debito_oper,
		dt_atualizacao,
		nm_usuario,
		vl_prest_serv_as,
		vl_outros_deb_pagar,
		ie_idade_saldo_passivo,
		cd_conta_contabil,
		nr_titulo,
		vl_deb_ben_con_seg_rec,
		vl_dep_aquis_carre,
		vl_eventos_sus,
		vl_titulos_encargos)
	values (nextval('w_diops_fin_idadesaldo_pas_seq'),
		nr_seq_operadora_p,
		nr_seq_transacao_p,
		nr_seq_periodo_p,
		ie_tipo_vencimento_w,
		0,
		0,
		0,
		0,
		clock_timestamp(),
		nm_usuario_p,
		0,
		0,
		null,
		'',
		nr_titulo_w,
		0,
		0,
		0,
		0);
	end;
end loop;
close C10;

open C11;
loop
fetch C11 into	
	ie_tipo_vencimento_w,
	vl_evento_liquidar_w,
	vl_debito_operadora_w,
	vl_comercializacao_w,
	vl_debito_oper_w,
	vl_prest_serv_as_w,
	vl_outros_deb_pagar_w,
	vl_deb_ben_con_seg_rec_w,
	vl_dep_aquis_carre_w,
	vl_eventos_sus_w,
	vl_titulos_encargos_w;
EXIT WHEN NOT FOUND; /* apply on C11 */
	begin
	insert into diops_fin_idadesaldo_pas(nr_sequencia,
		cd_estabelecimento,
		nr_seq_periodo,
		dt_atualizacao,
		nm_usuario,
		dt_atualizacao_nrec,
		nm_usuario_nrec,
		ie_tipo_vencimento,
		vl_evento_liquidar,
		vl_debito_operadora,
		vl_comercializacao,
		vl_debito_oper,
		nr_seq_operadora,
		vl_prest_serv_as,
		vl_outros_deb_pagar,
		vl_deb_ben_con_seg_rec,
		vl_dep_aquis_carre,
		vl_eventos_sus,
		vl_titulos_encargos)
	values (nextval('diops_fin_idadesaldo_pas_seq'),
		cd_estabelecimento_w,
		nr_seq_periodo_p,
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		nm_usuario_p,
		ie_tipo_vencimento_w,
		vl_evento_liquidar_w,
		vl_debito_operadora_w,
		vl_comercializacao_w,
		vl_debito_oper_w,
		nr_seq_operadora_p,
		vl_prest_serv_as_w,
		vl_outros_deb_pagar_w,
		vl_deb_ben_con_seg_rec_w,
		vl_dep_aquis_carre_w,
		vl_eventos_sus_w,
		vl_titulos_encargos_w);
	end;
end loop;
close C11;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE diops_gerar_idadesaldo_passivo ( nr_seq_operadora_p bigint, nr_seq_transacao_p bigint, nr_seq_periodo_p bigint, nm_usuario_p text) FROM PUBLIC;

