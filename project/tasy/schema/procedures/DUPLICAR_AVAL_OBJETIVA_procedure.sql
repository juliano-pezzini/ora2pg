-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE duplicar_aval_objetiva (nr_sequencia_p bigint, nm_usuario_p text ) AS $body$
DECLARE

    c01 CURSOR FOR
    SELECT a.*, u.cd_pessoa_fisica cd_pesfis
    from aval_nutricao a,usuario u
    where a.nr_sequencia = nr_sequencia_p
      and u.nm_usuario = nm_usuario_p;

    c01_w c01%rowtype;

BEGIN
    open c01;
    loop
        fetch c01 into c01_w;
        EXIT WHEN NOT FOUND; /* apply on c01 */
        begin
            insert into aval_nutricao(
                nr_sequencia,
                dt_atualizacao,
                nm_usuario,
                dt_atualizacao_nrec,
                nm_usuario_nrec,
                qt_perda,
                qt_peso_habit,
                qt_peso_atual,
                pr_perda,
                nr_atendimento,
                cd_profissional,
                dt_avaliacao,
                qt_altura,
                qt_idade,
                qt_imc,
                qt_tempo_perda,
                qt_altura_joelho,
                qt_altura_estimada,
                qt_circ_panturrilha,
                qt_circ_braco,
                qt_perc_circ_braco,
                pr_circ_braco,
                qt_prega_cut_tricip,
                qt_perc_prega_cut_tricip,
                pr_prega_cut_tricip,
                qt_circ_musc_braco,
                pr_circ_musc_braco,
                qt_gasto_ener_repouso,
                qt_fator_atividade,
                qt_fator_estresse,
                qt_gasto_ener_total,
                qt_perc_circ_musc_braco,
                ie_origem_peso,
                ie_origem_altura,
                nr_seq_fator_ativ,
                nr_seq_fator_stress,
                dt_liberacao,
                ie_situacao,
                dt_inativacao,
                nm_usuario_inativacao,
                ds_justificativa,
                ie_tempo_perda,
                ie_aval_nut,
                ds_observacao,
                qt_prega_cut_subesc,
                qt_prega_cut_suprailiaca,
                qt_circ_abdomen,
                qt_prega_cut_bicipal,
                qt_circ_quadril,
                qt_circ_cintura,
                qt_idade_mes,
                qt_idade_dias,
                qt_circ_pulso,
                qt_kcal_recomendado,
                ie_formula_bolso,
                qt_prega_adut_polegar,
                ie_queimadura,
                qt_gasto_geb_mifflin,
                qt_gast_ener_total_ireton,
                ie_respiracao,
                ie_trauma,
                qt_razao_cintura_quadril,
                qt_ig_semana,
                ie_tipo,
                qt_gasto_geb_mifflin_kj,
                qt_nec_calorica_kj,
                qt_caloria_kj,
                qt_gasto_ener_total_kj,
                qt_gast_ener_total_ireton_kj,
                qt_gasto_ener_repouso_kj,
                cd_setor_atendimento,
                ie_status,
                nr_seq_aval_nutricao,
                ie_revisado,
                dt_criacao,
                dt_hospitalizacao,
                cd_departamento,
                ds_other,
                ie_perda,
                ie_ferimentos,
                ie_dentadura,
                ie_prob_cavidade_oral,
                ie_receb_quimio,
                ie_restricao_religiao,
                ie_intencao_fam_pacient,
                cd_doenca_cid,
                ds_doenca_cid,
                ie_obesidade,
                ie_diabete,
                ie_hiperlipidemia,
                ie_hipertensao,
                ds_other_2,
                ds_other_3,
                ds_proibicao,
                ds_adicao,
                ds_other_4,
                ie_orientacao_nutri,
                ie_dieta_disfagia,
                ds_other_5,
                ds_req_nutri,
                ie_apetite,
                qt_alb,
                dt_alb,
                dt_wbc,
                qt_wbc,
                ds_notas,
                qt_agua,
                qt_sitting_height,
                qt_head_circumference,
                qt_body_surface,
                cd_enfermeira,
                cd_nutricionista,
                ie_ingestao,
                ie_adl,
                ie_avaliacao_nutri,
                ie_gestao_nutri,
                ie_sodio_reduzido,
                ie_metodo,
                ie_codigo_classif,
                ie_hora_reavaliacao,
                ie_aval_alta,
                ie_list_trat_medico,
                cd_dieta,
                ie_soft_meal,
                ie_chopped,
                ie_bite_sized,
                qt_thoracic_per,
                qt_obesity_index,
                ie_nursing_profile,
                cd_pessoa_fisica,
                ie_sodio_restrito,
                cd_unidade_basica,
                cd_unidade_compl,
                ie_alerta,
                ie_bedsore,
                ie_bite_problem,
                ie_difficult_swallow,
                ie_use_mouth,
                ie_fat_in_blood,
                ie_nivel_atencao,
                qt_peso_ajustado,
                pr_gordura,
                qt_proteina,
                qt_nec_proteica,
                qt_nec_calorica,
                qt_caloria,
                qt_prega_cut_abd,
                pr_perda_peso,
				ds_others_6
            ) values (
                nextval('aval_nutricao_seq'),
                clock_timestamp(),
                nm_usuario_p,
                clock_timestamp(),
                nm_usuario_p,
                c01_w.qt_perda,
                c01_w.qt_peso_habit,
                c01_w.qt_peso_atual,
                c01_w.pr_perda,
                CASE WHEN pkg_i18n.get_user_locale='ja_JP' THEN  obter_ultimo_atendimento(obter_pessoa_atendimento(c01_w.nr_atendimento,'C'))  ELSE c01_w.nr_atendimento END ,
                CASE WHEN pkg_i18n.get_user_locale='ja_JP' THEN  Obter_Dados_Atendimento(c01_w.nr_atendimento,'MR')  ELSE c01_w.cd_pesfis END ,
                clock_timestamp(),
                c01_w.qt_altura,
                c01_w.qt_idade,
                c01_w.qt_imc,
                c01_w.qt_tempo_perda,
                c01_w.qt_altura_joelho,
                c01_w.qt_altura_estimada,
                c01_w.qt_circ_panturrilha,
                c01_w.qt_circ_braco,
                c01_w.qt_perc_circ_braco,
                c01_w.pr_circ_braco,
                c01_w.qt_prega_cut_tricip,
                c01_w.qt_perc_prega_cut_tricip,
                c01_w.pr_prega_cut_tricip,
                c01_w.qt_circ_musc_braco,
                c01_w.pr_circ_musc_braco,
                c01_w.qt_gasto_ener_repouso,
                c01_w.qt_fator_atividade,
                c01_w.qt_fator_estresse,
                c01_w.qt_gasto_ener_total,
                c01_w.qt_perc_circ_musc_braco,
                c01_w.ie_origem_peso,
                c01_w.ie_origem_altura,
                c01_w.nr_seq_fator_ativ,
                c01_w.nr_seq_fator_stress,
                null,
                'A',
                null,
                null,
                null,
                c01_w.ie_tempo_perda,
                c01_w.ie_aval_nut,
                c01_w.ds_observacao,
                c01_w.qt_prega_cut_subesc,
                c01_w.qt_prega_cut_suprailiaca,
                c01_w.qt_circ_abdomen,
                c01_w.qt_prega_cut_bicipal,
                c01_w.qt_circ_quadril,
                c01_w.qt_circ_cintura,
                c01_w.qt_idade_mes,
                c01_w.qt_idade_dias,
                c01_w.qt_circ_pulso,
                c01_w.qt_kcal_recomendado,
                c01_w.ie_formula_bolso,
                c01_w.qt_prega_adut_polegar,
                c01_w.ie_queimadura,
                c01_w.qt_gasto_geb_mifflin,
                c01_w.qt_gast_ener_total_ireton,
                c01_w.ie_respiracao,
                c01_w.ie_trauma,
                c01_w.qt_razao_cintura_quadril,
                c01_w.qt_ig_semana,
                c01_w.ie_tipo,
                c01_w.qt_gasto_geb_mifflin_kj,
                c01_w.qt_nec_calorica_kj,
                c01_w.qt_caloria_kj,
                c01_w.qt_gasto_ener_total_kj,
                c01_w.qt_gast_ener_total_ireton_kj,
                c01_w.qt_gasto_ener_repouso_kj,
                c01_w.cd_setor_atendimento,
                'TS',
                null,
                'N',
                c01_w.dt_criacao,
                obter_data_entrada(c01_w.nr_atendimento),
                c01_w.cd_departamento,
                c01_w.ds_other,
                c01_w.ie_perda,
                c01_w.ie_ferimentos,
                c01_w.ie_dentadura,
                c01_w.ie_prob_cavidade_oral,
                c01_w.ie_receb_quimio,
                c01_w.ie_restricao_religiao,
                c01_w.ie_intencao_fam_pacient,
                c01_w.cd_doenca_cid,
                c01_w.ds_doenca_cid,
                c01_w.ie_obesidade,
                c01_w.ie_diabete,
                c01_w.ie_hiperlipidemia,
                c01_w.ie_hipertensao,
                c01_w.ds_other_2,
                c01_w.ds_other_3,
                c01_w.ds_proibicao,
                c01_w.ds_adicao,
                c01_w.ds_other_4,
                c01_w.ie_orientacao_nutri,
                c01_w.ie_dieta_disfagia,
                c01_w.ds_other_5,
                c01_w.ds_req_nutri,
                c01_w.ie_apetite,
                c01_w.qt_alb,
                c01_w.dt_alb,
                c01_w.dt_wbc,
                c01_w.qt_wbc,
                c01_w.ds_notas,
                c01_w.qt_agua,
                c01_w.qt_sitting_height,
                c01_w.qt_head_circumference,
                c01_w.qt_body_surface,
                c01_w.cd_enfermeira,
                c01_w.cd_nutricionista,
                c01_w.ie_ingestao,
                c01_w.ie_adl,
                c01_w.ie_avaliacao_nutri,
                c01_w.ie_gestao_nutri,
                c01_w.ie_sodio_reduzido,
                c01_w.ie_metodo,
                c01_w.ie_codigo_classif,
                c01_w.ie_hora_reavaliacao,
                c01_w.ie_aval_alta,
                c01_w.ie_list_trat_medico,
                c01_w.cd_dieta,
                c01_w.ie_soft_meal,
                c01_w.ie_chopped,
                c01_w.ie_bite_sized,
                c01_w.qt_thoracic_per,
                c01_w.qt_obesity_index,
                c01_w.ie_nursing_profile,
                c01_w.cd_pessoa_fisica,
                c01_w.ie_sodio_restrito,
                c01_w.cd_unidade_basica,
                c01_w.cd_unidade_compl,
                c01_w.ie_alerta,
                c01_w.ie_bedsore,
                c01_w.ie_bite_problem,
                c01_w.ie_difficult_swallow,
                c01_w.ie_use_mouth,
                c01_w.ie_fat_in_blood,
                c01_w.ie_nivel_atencao,
                c01_w.qt_peso_ajustado,
                c01_w.pr_gordura,
                c01_w.qt_proteina,
                c01_w.qt_nec_proteica,
                c01_w.qt_nec_calorica,
                c01_w.qt_caloria,
                c01_w.qt_prega_cut_abd,
                c01_w.pr_perda_peso,
		c01_w.ds_others_6
            );

        end;

    end loop;

    close c01;
    commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE duplicar_aval_objetiva (nr_sequencia_p bigint, nm_usuario_p text ) FROM PUBLIC;

