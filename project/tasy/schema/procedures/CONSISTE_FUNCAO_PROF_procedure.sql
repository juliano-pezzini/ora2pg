-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE consiste_funcao_prof ( nm_usuario_p usuario.nm_usuario%type, ds_profissional_p INOUT text, ie_consiste_p INOUT text ) AS $body$
DECLARE


cd_funcao_w usuario.ie_profissional%type;
ie_consiste_w varchar(1);


BEGIN

select  coalesce(max('S'), 'N')
into STRICT    ie_consiste_w
from    regra_perm_dupla_checagem LIMIT 1;

if ((nm_usuario_p IS NOT NULL AND nm_usuario_p::text <> '') and ie_consiste_w = 'S') then
    cd_funcao_w := obter_profissional_usuario(nm_usuario_p, 'C');
    if (cd_funcao_w IS NOT NULL AND cd_funcao_w::text <> '') then
        ds_profissional_p := obter_profissional_usuario(nm_usuario_p, null);
        select  coalesce(max('N'), 'S')
        into STRICT    ie_consiste_w
        from    regra_perm_dupla_checagem
        where   ie_profissional = cd_funcao_w;
    else
        ie_consiste_w := 'S';
    end if;
end if;

ie_consiste_p := ie_consiste_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE consiste_funcao_prof ( nm_usuario_p usuario.nm_usuario%type, ds_profissional_p INOUT text, ie_consiste_p INOUT text ) FROM PUBLIC;

