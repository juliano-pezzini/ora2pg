-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE insert_tasy_client_notify ( DS_TITUTO_P TASY_CLIENT_NOTIFICATION.DS_TITULO%type, DS_MENSAGEM_P TASY_CLIENT_NOTIFICATION.DS_MENSAGEM%type, IE_TIPO_P TASY_CLIENT_NOTIFICATION.IE_TIPO%type DEFAULT null) AS $body$
DECLARE


NR_SEQ_W TASY_CLIENT_NOTIFICATION.NR_SEQUENCIA%type;
DT_INICIO_W TASY_CLIENT_NOTIFICATION.DT_INICIO%type;
DT_FIM_W TASY_CLIENT_NOTIFICATION.DT_FIM%type;
IE_TIPO_W TASY_CLIENT_NOTIFICATION.IE_TIPO%type := 'I';


BEGIN
	select nextval('tasy_client_notification_seq') into STRICT NR_SEQ_W;
    DT_INICIO_W := clock_timestamp();
	DT_FIM_W := DT_INICIO_W + 30;
	
	if (ie_tipo_p IS NOT NULL AND ie_tipo_p::text <> '') then
		IE_TIPO_W := ie_tipo_p;
	end if;
	
	insert into TASY_CLIENT_NOTIFICATION(
	NR_SEQUENCIA,
	CD_NOTIFICATION,
	DT_ATUALIZACAO,
	DT_INICIO,
	DT_FIM,
	DS_TITULO,
	DS_MENSAGEM,
	IE_STATUS,
	IE_TIPO,
	IE_LIDO)
	values (
	NR_SEQ_W,
	NR_SEQ_W,
	clock_timestamp(),
	DT_INICIO_W,
	DT_FIM_W,
	DS_TITUTO_P,
	DS_MENSAGEM_P,
	'A',
	IE_TIPO_W,
	'N');
	Commit;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE insert_tasy_client_notify ( DS_TITUTO_P TASY_CLIENT_NOTIFICATION.DS_TITULO%type, DS_MENSAGEM_P TASY_CLIENT_NOTIFICATION.DS_MENSAGEM%type, IE_TIPO_P TASY_CLIENT_NOTIFICATION.IE_TIPO%type DEFAULT null) FROM PUBLIC;

