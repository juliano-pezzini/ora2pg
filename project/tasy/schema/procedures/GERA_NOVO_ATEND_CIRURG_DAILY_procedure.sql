-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gera_novo_atend_cirurg_daily ( nr_atendimento_p bigint, nm_usuario_p text, nr_seq_admissao_p bigint, nr_seq_classificacao_p bigint, nr_seq_queixa_p bigint, cd_medico_resp_p bigint, cd_departamento_p bigint, nr_seq_agenda_p bigint) AS $body$
DECLARE

  nr_atendimento_new_w    bigint;
  cd_departamento_w bigint;
  nr_dias_w         bigint;
  nr_seq_agepaci_w  agenda_consulta.nr_seq_agepaci%type;
  dt_agenda_paci_w  timestamp;
  qtd_dias_w        bigint;
  nr_atendimento_w  bigint;
  nr_seq_atend_cat_conv_new_w  bigint;

  C01 CURSOR FOR
    SELECT cd_departamento, 
      nr_dias 
    FROM departamento_atendimento;


BEGIN
  SELECT max(nr_seq_agepaci)
  INTO STRICT nr_seq_agepaci_w
  FROM agenda_consulta
  WHERE nr_sequencia   = nr_seq_agenda_p;

  IF (nr_seq_agepaci_w IS NOT NULL AND nr_seq_agepaci_w::text <> '') THEN
  
    qtd_dias_w        := 0;

    SELECT DT_AGENDA,
      nr_atendimento
    INTO STRICT dt_agenda_paci_w,
      nr_atendimento_w
    FROM agenda_paciente    
    WHERE nr_sequencia    = nr_seq_agepaci_w;

    IF (coalesce(nr_atendimento_w::text, '') = '') THEN     
      
      OPEN C01;
      LOOP
        FETCH C01 INTO cd_departamento_w, nr_dias_w;
        EXIT WHEN NOT FOUND; /* apply on C01 */
        BEGIN

          IF (cd_departamento_w = cd_departamento_p) THEN
            qtd_dias_w         := nr_dias_w;
          END IF;

        END;
      END LOOP;
      CLOSE C01;

      SELECT nextval('atendimento_paciente_seq') INTO STRICT nr_atendimento_new_w;

      INSERT
      INTO ATENDIMENTO_PACIENTE(
          NR_ATENDIMENTO,
          CD_PESSOA_FISICA,
          CD_ESTABELECIMENTO,
          CD_PROCEDENCIA,
          DT_ENTRADA,
          IE_TIPO_ATENDIMENTO,
          DT_ATUALIZACAO,
          NM_USUARIO,
          CD_MEDICO_RESP,
          CD_MOTIVO_ALTA,
          DS_SINTOMA_PACIENTE,
          DS_OBSERVACAO,
          DT_ALTA,
          IE_CLINICA,
          NM_USUARIO_ATEND,
          IE_RESPONSAVEL,
          DT_FIM_CONTA,
          IE_FIM_CONTA,
          NR_CAT,
          DS_CAUSA_EXTERNA,
          CD_CGC_SEGURADORA,
          NR_BILHETE,
          NR_SERIE_BILHETE,
          IE_CARATER_INTER_SUS,
          IE_VINCULO_SUS,
          IE_TIPO_CONVENIO,
          IE_TIPO_ATEND_BPA,
          IE_GRUPO_ATEND_BPA,
          CD_MEDICO_ATENDIMENTO,
          DT_ALTA_INTERNO,
          NR_SEQ_UNID_ATUAL,
          NR_SEQ_UNID_INT,
          NR_ATEND_ORIGINAL,
          QT_DIA_LONGA_PERM,
          DT_INICIO_ATENDIMENTO,
          IE_PERMITE_VISITA,
          IE_STATUS_ATENDIMENTO,
          DT_PREVISTO_ALTA,
          NM_USUARIO_ALTA,
          CD_PESSOA_RESPONSAVEL,
          DT_ATEND_MEDICO,
          DT_SAIDA_REAL,
          IE_CLINICA_ALTA,
          DT_FIM_CONSULTA,
          DT_MEDICACAO,
          DT_LIB_MEDICO,
          NR_SEQ_REGRA_FUNCAO,
          NR_SEQ_LOCAL_PA,
          NR_SEQ_TIPO_ACIDENTE,
          DT_OCORRENCIA,
          DS_PEND_AUTORIZACAO,
          NR_SEQ_CHECK_LIST,
          DT_FIM_TRIAGEM,
          NR_RESERVA_LEITO,
          IE_PACIENTE_ISOLADO,
          IE_PERMITE_VISITA_REL,
          DS_SENHA,
          IE_PROBABILIDADE_ALTA,
          NR_SEQ_FORMA_CHEGADA,
          NR_SEQ_INDICACAO,
          DS_OBS_ALTA,
          CD_PESSOA_INDIC,
          NM_MEDICO_EXTERNO,
          NR_GESTANTE_PRE_NATAL,
          NR_SEQ_FORMA_LAUDO,
          DT_ALTA_MEDICO,
          CD_MOTIVO_ALTA_MEDICA,
          NR_SEQ_PQ_PROTOCOLO,
          CD_PSICOLOGO,
          NR_SEQ_CLASSIFICACAO,
          DS_SENHA_QMATIC,
          NR_SEQ_QUEIXA,
          IE_EXTRA_TETO,
          CD_MEDICO_REFERIDO,
          IE_NECROPSIA,
          NR_SEQ_TRIAGEM,
          IE_TIPO_CONSULTA,
          IE_TIPO_SAIDA_CONSULTA,
          NR_SEQ_CLASSIF_MEDICO,
          IE_TIPO_ATEND_TISS,
          DT_IMPRESSAO,
          CD_PESSOA_JURIDICA_INDIC,
          NR_ATENDIMENTO_MAE,
          IE_TRAT_CONTA_RN,
          QT_DIAS_PREV_INTER,
          NR_SEQ_GRAU_PARENTESCO,
          IE_BOLETIM_INFORM,
          DT_CHAMADA_PACIENTE,
          IE_CHAMADO,
          DS_OBS_PREV_ALTA,
          IE_AVISAR_MEDICO_REFERIDO,
          CD_MEDICO_CHAMADO,
          NR_ATEND_ALTA,
          DT_SAIDA_PREV_LOC_PA,
          IE_STATUS_PA,
          DT_LIBERACAO_ENFERMAGEM,
          DT_REAVALIACAO_MEDICA,
          DS_JUSTIF_SAIDA_REAL,
          NM_USUARIO_TRIAGEM,
          NR_SEQ_FICHA,
          DT_RECEBIMENTO_SENHA,
          IE_PRM,
          DT_VER_PREV_ALTA,
          NR_SEQ_CAT,
          DT_ATEND_ORIGINAL,
          DT_CHAMADA_ENFERMAGEM,
          NR_SEQ_LOCAL_DESTINO,
          IE_DIVULGAR_OBITO,
          NR_SEQ_TOPOGRAFIA,
          --NR_TIPO_LESAO,
          NR_SEQ_TIPO_LESAO,
          IE_CLINICA_ANT,
          CD_PERFIL_ATIVO,
          NM_USUARIO_INTERN,
          DS_OBS_ALTA_MEDIC,
          IE_MODO_INTERNACAO,
          CD_MUNICIPIO_OCORRENCIA,
          DT_USUARIO_INTERN,
          DT_CHAMADA_REAVALIACAO,
          DT_INICIO_REAVALIACAO,
          NR_VINCULO_CENSO,
          DT_CHEGADA_PACIENTE,
          DS_VINCULO_CENSO,
          NR_SEQ_TRIAGEM_PRIORIDADE,
          NM_USUARIO_SAIDA,
          NR_SEQ_TRIAGEM_OLD,
          DT_FIM_REAVALIACAO,
          NM_USUARIO_ALTA_MEDICA,
          CD_SETOR_OBITO,
          CRM_MEDICO_EXTERNO,
          NR_SEQ_SEGURADO,
          DT_ALTA_TESOURARIA,
          NR_ATEND_ORIGEM_PA,
          CD_CGC_INDICACAO,
          DT_INICIO_OBSERVACAO,
          DT_FIM_OBSERVACAO,
          NR_SEQ_PAC_SENHA_FILA,
          DT_CANCELAMENTO,
          NM_USUARIO_CANCELAMENTO,
          NM_USUARIO_PROB_ALTA,
          IE_PERMITE_ACOMP,
          NR_SEQ_INFORMACAO,
          DS_INFORMACAO,
          NR_SEQ_TIPO_MIDIA,
          NM_INICIO_ATENDIMENTO,
          NM_FIM_TRIAGEM,
          NR_DIAS_PREV_ALTA,
          DT_CHAMADA_MEDIC,
          DT_CHEGADA_MEDIC,
          NR_SEQ_ATEND_PLS,
          NR_SEQ_EVENTO_ATEND,
          IE_DECLARACAO_OBITO,
          DT_DESCOLONIZAR_PACIENTE,
          NM_DESCOLONIZAR_PACIENTE,
          DT_CHECAGEM_ADEP,
          DT_IMPRESSAO_ALTA,
          IE_LAUDO_PREENCHIDO,
          NR_SEQ_CLASSIF_ESP,
          CD_MEDICO_PREFERENCIA,
          DS_OBS_PRIOR,
          VL_CONSULTA,
          DT_INICIO_ESP_EXAME,
          DT_FIM_ESP_EXAME,
          DS_OBS_PA,
          NR_SEQ_PA_STATUS,
          NR_CONV_INTERNO,
          NR_SEQ_REGISTRO,
          DT_INICIO_PRESCR_PA,
          DT_FIM_PRESCR_PA,
          IE_ASSINOU_TERMO_BIOBANCO,
          DS_OBSERVACAO_BIOBANCO,
          NR_SEQ_MOTIVO_BIOBANCO,
          NM_USUARIO_BIOBANCO,
          DT_ATUALIZACAO_BIOBANCO,
          NR_SEQ_FICHA_LOTE,
          IE_TIPO_ENDERECO_ENTREGA,
          DT_LIBERACAO_FINANCEIRO,
          CD_FUNCAO_ALTA_MEDICA,
          CD_SETOR_USUARIO_ATEND,
          DT_ULTIMA_MENSTRUACAO,
          QT_IG_SEMANA,
          QT_IG_DIA,
          NR_SUBMOTIVO_ALTA,
          NR_INT_CROSS,
          IE_CLASSIF_LOTE_ENT,
          DT_CLASSIF_RISCO,
          NR_SEQ_FICHA_LOTE_ANT,
          CD_MEDICO_INFECT,
          IE_TIPO_STATUS_ALTA,
          IE_TIPO_ALTA,
          IE_TIPO_VAGA,
          CD_SETOR_DESEJADO,
          CD_TIPO_ACOMOD_DESEJ,
          NR_SEQ_TIPO_OBS_ALTA,
          NR_ATEND_ORIGEM_BPA,
          IE_LIBERADO_CHECKOUT,
          NR_SEQ_OFTALMO,
          DS_SENHA_INTERNET,
          --ID_LEITO_TEMP_CROSS,
          DT_ATUALIZACAO_NREC,
          NM_USUARIO_NREC,
          IE_NIVEL_ATENCAO,
          IE_PACIENTE_GRAVIDA,
          DS_UTC,
          IE_HORARIO_VERAO,
          DS_UTC_ATUALIZACAO,
          NR_SEQ_EPISODIO,
          CD_LUGAR_ACC,
          IE_TIPO_SERV_MX,
          CD_SERV_TER_MX,
          CD_SERV_ENTRADA_MX,
          CD_SERV_SEC_MX,
          CD_SERV_ALTA_MX,
          --IE_TIPO_UNI_PSIQ,

          --IE_SERV_PSIQ_CONT,

          -- IE_SERV_PSIQ_PAR,
          NR_SEQ_TIPO_ADMISSAO_FAT
        )
      SELECT nr_atendimento_new_w,
        CD_PESSOA_FISICA,
        CD_ESTABELECIMENTO,
        CD_PROCEDENCIA,
        (dt_agenda_paci_w - qtd_dias_w),
        IE_TIPO_ATENDIMENTO,
        DT_ATUALIZACAO,
        NM_USUARIO,
        cd_medico_resp_p,
        CD_MOTIVO_ALTA,
        DS_SINTOMA_PACIENTE,
        DS_OBSERVACAO,
        DT_ALTA,
        IE_CLINICA,
        NM_USUARIO_ATEND,
        IE_RESPONSAVEL,
        DT_FIM_CONTA,
        IE_FIM_CONTA,
        NR_CAT,
        DS_CAUSA_EXTERNA,
        CD_CGC_SEGURADORA,
        NR_BILHETE,
        NR_SERIE_BILHETE,
        IE_CARATER_INTER_SUS,
        IE_VINCULO_SUS,
        IE_TIPO_CONVENIO,
        IE_TIPO_ATEND_BPA,
        IE_GRUPO_ATEND_BPA,
        CD_MEDICO_ATENDIMENTO,
        DT_ALTA_INTERNO,
        NR_SEQ_UNID_ATUAL,
        NR_SEQ_UNID_INT,
        NR_ATEND_ORIGINAL,
        QT_DIA_LONGA_PERM,
        DT_INICIO_ATENDIMENTO,
        IE_PERMITE_VISITA,
        IE_STATUS_ATENDIMENTO,
        DT_PREVISTO_ALTA,
        NM_USUARIO_ALTA,
        CD_PESSOA_RESPONSAVEL,
        DT_ATEND_MEDICO,
        DT_SAIDA_REAL,
        IE_CLINICA_ALTA,
        DT_FIM_CONSULTA,
        DT_MEDICACAO,
        DT_LIB_MEDICO,
        NR_SEQ_REGRA_FUNCAO,
        NR_SEQ_LOCAL_PA,
        NR_SEQ_TIPO_ACIDENTE,
        DT_OCORRENCIA,
        DS_PEND_AUTORIZACAO,
        NR_SEQ_CHECK_LIST,
        DT_FIM_TRIAGEM,
        NR_RESERVA_LEITO,
        IE_PACIENTE_ISOLADO,
        IE_PERMITE_VISITA_REL,
        DS_SENHA,
        IE_PROBABILIDADE_ALTA,
        NR_SEQ_FORMA_CHEGADA,
        NR_SEQ_INDICACAO,
        DS_OBS_ALTA,
        CD_PESSOA_INDIC,
        NM_MEDICO_EXTERNO,
        NR_GESTANTE_PRE_NATAL,
        NR_SEQ_FORMA_LAUDO,
        DT_ALTA_MEDICO,
        CD_MOTIVO_ALTA_MEDICA,
        NR_SEQ_PQ_PROTOCOLO,
        CD_PSICOLOGO,
        nr_seq_classificacao_p,
        DS_SENHA_QMATIC,
        nr_seq_queixa_p,
        IE_EXTRA_TETO,
        CD_MEDICO_REFERIDO,
        IE_NECROPSIA,
        NR_SEQ_TRIAGEM,
        IE_TIPO_CONSULTA,
        IE_TIPO_SAIDA_CONSULTA,
        NR_SEQ_CLASSIF_MEDICO,
        IE_TIPO_ATEND_TISS,
        DT_IMPRESSAO,
        CD_PESSOA_JURIDICA_INDIC,
        NR_ATENDIMENTO_MAE,
        IE_TRAT_CONTA_RN,
        QT_DIAS_PREV_INTER,
        NR_SEQ_GRAU_PARENTESCO,
        IE_BOLETIM_INFORM,
        DT_CHAMADA_PACIENTE,
        IE_CHAMADO,
        DS_OBS_PREV_ALTA,
        IE_AVISAR_MEDICO_REFERIDO,
        CD_MEDICO_CHAMADO,
        NR_ATEND_ALTA,
        DT_SAIDA_PREV_LOC_PA,
        IE_STATUS_PA,
        DT_LIBERACAO_ENFERMAGEM,
        DT_REAVALIACAO_MEDICA,
        DS_JUSTIF_SAIDA_REAL,
        NM_USUARIO_TRIAGEM,
        NR_SEQ_FICHA,
        DT_RECEBIMENTO_SENHA,
        IE_PRM,
        DT_VER_PREV_ALTA,
        NR_SEQ_CAT,
        DT_ATEND_ORIGINAL,
        DT_CHAMADA_ENFERMAGEM,
        NR_SEQ_LOCAL_DESTINO,
        IE_DIVULGAR_OBITO,
        NR_SEQ_TOPOGRAFIA,
        --NR_TIPO_LESAO,
        NR_SEQ_TIPO_LESAO,
        IE_CLINICA_ANT,
        CD_PERFIL_ATIVO,
        NM_USUARIO_INTERN,
        DS_OBS_ALTA_MEDIC,
        IE_MODO_INTERNACAO,
        CD_MUNICIPIO_OCORRENCIA,
        DT_USUARIO_INTERN,
        DT_CHAMADA_REAVALIACAO,
        DT_INICIO_REAVALIACAO,
        NR_VINCULO_CENSO,
        DT_CHEGADA_PACIENTE,
        DS_VINCULO_CENSO,
        NR_SEQ_TRIAGEM_PRIORIDADE,
        NM_USUARIO_SAIDA,
        NR_SEQ_TRIAGEM_OLD,
        DT_FIM_REAVALIACAO,
        NM_USUARIO_ALTA_MEDICA,
        CD_SETOR_OBITO,
        CRM_MEDICO_EXTERNO,
        NR_SEQ_SEGURADO,
        DT_ALTA_TESOURARIA,
        NR_ATEND_ORIGEM_PA,
        CD_CGC_INDICACAO,
        DT_INICIO_OBSERVACAO,
        DT_FIM_OBSERVACAO,
        NR_SEQ_PAC_SENHA_FILA,
        DT_CANCELAMENTO,
        NM_USUARIO_CANCELAMENTO,
        NM_USUARIO_PROB_ALTA,
        IE_PERMITE_ACOMP,
        NR_SEQ_INFORMACAO,
        DS_INFORMACAO,
        NR_SEQ_TIPO_MIDIA,
        NM_INICIO_ATENDIMENTO,
        NM_FIM_TRIAGEM,
        NR_DIAS_PREV_ALTA,
        DT_CHAMADA_MEDIC,
        DT_CHEGADA_MEDIC,
        NR_SEQ_ATEND_PLS,
        NR_SEQ_EVENTO_ATEND,
        IE_DECLARACAO_OBITO,
        DT_DESCOLONIZAR_PACIENTE,
        NM_DESCOLONIZAR_PACIENTE,
        DT_CHECAGEM_ADEP,
        DT_IMPRESSAO_ALTA,
        IE_LAUDO_PREENCHIDO,
        NR_SEQ_CLASSIF_ESP,
        CD_MEDICO_PREFERENCIA,
        DS_OBS_PRIOR,
        VL_CONSULTA,
        DT_INICIO_ESP_EXAME,
        DT_FIM_ESP_EXAME,
        DS_OBS_PA,
        NR_SEQ_PA_STATUS,
        NR_CONV_INTERNO,
        NR_SEQ_REGISTRO,
        DT_INICIO_PRESCR_PA,
        DT_FIM_PRESCR_PA,
        IE_ASSINOU_TERMO_BIOBANCO,
        DS_OBSERVACAO_BIOBANCO,
        NR_SEQ_MOTIVO_BIOBANCO,
        NM_USUARIO_BIOBANCO,
        DT_ATUALIZACAO_BIOBANCO,
        NR_SEQ_FICHA_LOTE,
        IE_TIPO_ENDERECO_ENTREGA,
        DT_LIBERACAO_FINANCEIRO,
        CD_FUNCAO_ALTA_MEDICA,
        CD_SETOR_USUARIO_ATEND,
        DT_ULTIMA_MENSTRUACAO,
        QT_IG_SEMANA,
        QT_IG_DIA,
        NR_SUBMOTIVO_ALTA,
        NR_INT_CROSS,
        IE_CLASSIF_LOTE_ENT,
        DT_CLASSIF_RISCO,
        NR_SEQ_FICHA_LOTE_ANT,
        CD_MEDICO_INFECT,
        IE_TIPO_STATUS_ALTA,
        IE_TIPO_ALTA,
        IE_TIPO_VAGA,
        CD_SETOR_DESEJADO,
        CD_TIPO_ACOMOD_DESEJ,
        NR_SEQ_TIPO_OBS_ALTA,
        NR_ATEND_ORIGEM_BPA,
        IE_LIBERADO_CHECKOUT,
        NR_SEQ_OFTALMO,
        DS_SENHA_INTERNET,
        --ID_LEITO_TEMP_CROSS,
        DT_ATUALIZACAO_NREC,
        nm_usuario_p,
        IE_NIVEL_ATENCAO,
        IE_PACIENTE_GRAVIDA,
        DS_UTC,
        IE_HORARIO_VERAO,
        DS_UTC_ATUALIZACAO,
        NR_SEQ_EPISODIO,
        CD_LUGAR_ACC,
        IE_TIPO_SERV_MX,
        CD_SERV_TER_MX,
        CD_SERV_ENTRADA_MX,
        CD_SERV_SEC_MX,
        CD_SERV_ALTA_MX,
        -- IE_TIPO_UNI_PSIQ,

        -- IE_SERV_PSIQ_CONT,

        -- IE_SERV_PSIQ_PAR,
        nr_seq_admissao_p
      FROM atendimento_paciente
      WHERE nr_atendimento = nr_atendimento_p;

      SELECT nextval('atend_categoria_convenio_seq') INTO STRICT nr_seq_atend_cat_conv_new_w;

      INSERT
      INTO ATEND_CATEGORIA_CONVENIO(
          NR_SEQ_INTERNO,
          NR_ATENDIMENTO,
          CD_CONVENIO,
          CD_CATEGORIA,
          DT_INICIO_VIGENCIA,
          DT_FINAL_VIGENCIA,
          DT_ATUALIZACAO,
          CD_USUARIO_CONVENIO,
          CD_EMPRESA,
          NM_USUARIO,
          NR_DOC_CONVENIO,
          CD_TIPO_ACOMODACAO,
          CD_MUNICIPIO_CONVENIO,
          CD_CONVENIO_GLOSA,
          CD_CATEGORIA_GLOSA,
          DT_VALIDADE_CARTEIRA,
          NR_ACOMPANHANTE,
          CD_PLANO_CONVENIO,
          CD_DEPENDENTE,
          NR_SEQ_ORIGEM,
          CD_SENHA,
          IE_TIPO_GUIA,
          DS_OBSERVACAO,
          QT_DIA_INTERNACAO,
          DT_ULTIMO_PAGTO,
          CD_COMPLEMENTO,
          DT_ACEITE_DIF_ACOMOD,
          NM_USUARIO_ACEITE,
          DS_OBSERVACAO_ACEITE,
          QT_DIETA_ACOMP,
          IE_LIB_DIETA,
          NR_DOC_CONV_PRINCIPAL,
          IE_REGIME_INTERNACAO,
          CD_USUARIO_CONV_GLOSA,
          CD_COMPLEMENTO_GLOSA,
          DT_VALIDADE_CART_GLOSA,
          NM_USUARIO_ORIGINAL,
          NR_SEQ_LIB_DIETA_CONV,
          NR_SEQ_TIPO_LIB_GUIA,
          NR_SEQ_COBERTURA,
          NR_SEQ_ABRANGENCIA,
          CD_SENHA_PROVISORIA,
          CD_PLANO_GLOSA,
          NR_SEQ_REGRA_ACOMP,
          DS_TARJA_CARTAO,
          DS_JUST_ALTERACAO,
          IE_COD_USUARIO_MAE_RESP,
          NR_BIOMETRIA_CONV,
          NR_SEQ_JUST_BIOMETRIA_CONV,
          IE_TIPO_CONVENIADO
        )
      SELECT nr_seq_atend_cat_conv_new_w,
        nr_atendimento_new_w,
        CD_CONVENIO,
        CD_CATEGORIA,
        DT_INICIO_VIGENCIA,
        DT_FINAL_VIGENCIA,
        DT_ATUALIZACAO,
        CD_USUARIO_CONVENIO,
        CD_EMPRESA,
        NM_USUARIO,
        NR_DOC_CONVENIO,
        CD_TIPO_ACOMODACAO,
        CD_MUNICIPIO_CONVENIO,
        CD_CONVENIO_GLOSA,
        CD_CATEGORIA_GLOSA,
        DT_VALIDADE_CARTEIRA,
        NR_ACOMPANHANTE,
        CD_PLANO_CONVENIO,
        CD_DEPENDENTE,
        NR_SEQ_ORIGEM,
        CD_SENHA,
        IE_TIPO_GUIA,
        DS_OBSERVACAO,
        QT_DIA_INTERNACAO,
        DT_ULTIMO_PAGTO,
        CD_COMPLEMENTO,
        DT_ACEITE_DIF_ACOMOD,
        NM_USUARIO_ACEITE,
        DS_OBSERVACAO_ACEITE,
        QT_DIETA_ACOMP,
        IE_LIB_DIETA,
        NR_DOC_CONV_PRINCIPAL,
        IE_REGIME_INTERNACAO,
        CD_USUARIO_CONV_GLOSA,
        CD_COMPLEMENTO_GLOSA,
        DT_VALIDADE_CART_GLOSA,
        NM_USUARIO_ORIGINAL,
        NR_SEQ_LIB_DIETA_CONV,
        NR_SEQ_TIPO_LIB_GUIA,
        NR_SEQ_COBERTURA,
        NR_SEQ_ABRANGENCIA,
        CD_SENHA_PROVISORIA,
        CD_PLANO_GLOSA,
        NR_SEQ_REGRA_ACOMP,
        DS_TARJA_CARTAO,
        DS_JUST_ALTERACAO,
        IE_COD_USUARIO_MAE_RESP,
        NR_BIOMETRIA_CONV,
        NR_SEQ_JUST_BIOMETRIA_CONV,
        IE_TIPO_CONVENIADO
      FROM ATEND_CATEGORIA_CONVENIO
      WHERE nr_atendimento = nr_atendimento_p;

      UPDATE agenda_paciente
      SET nr_atendimento = nr_atendimento_new_w
      WHERE nr_sequencia = nr_seq_agepaci_w;

    END IF;

  END IF;

  COMMIT;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gera_novo_atend_cirurg_daily ( nr_atendimento_p bigint, nm_usuario_p text, nr_seq_admissao_p bigint, nr_seq_classificacao_p bigint, nr_seq_queixa_p bigint, cd_medico_resp_p bigint, cd_departamento_p bigint, nr_seq_agenda_p bigint) FROM PUBLIC;

