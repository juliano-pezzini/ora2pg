-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE limpar_tabelas_temporarias () AS $body$
BEGIN

CALL CALL Limpar_tabela('W_CTB_BALANCETE', 'AND DT_ATUALIZACAO < SYSDATE - :qt_dias', 3);
CALL CALL Limpar_tabela('W_CTB_VER_SALDO', 'AND DT_ATUALIZACAO < SYSDATE - :qt_dias', 3);
CALL CALL Limpar_tabela('W_CTB_RAZAO_CONSOL', 'AND DT_ATUALIZACAO < SYSDATE - :qt_dias', 3);
CALL CALL Limpar_tabela('USUARIO_MENSAGEM', 'AND DT_LEITURA < sysdate - :qt_dias', 3);
CALL CALL Limpar_tabela('PROCESSO_ATENDIMENTO', 'AND DT_FIM_REAL < sysdate - :qt_dias', 30);
CALL CALL Limpar_tabela('LOG_USUARIO_CONECTADO', 'and dt_log < sysdate - :qt_dias', 360);
CALL CALL Limpar_tabela('AGENDA_CONTROLE_HORARIO', 'AND DT_AGENDA < sysdate - :qt_dias', 1);
CALL CALL Limpar_tabela('TASY_CONVERSAO_RTF', 'AND DT_ATUALIZACAO < sysdate - :qt_dias', 1);
CALL CALL Limpar_tabela('LOG_PRESCRICAO', 'AND DT_ATUALIZACAO < sysdate - :qt_dias', 20);
CALL CALL Limpar_tabela('LOG_GEDIPA', 'AND DT_LOG < sysdate - :qt_dias', 20);


CALL exec_sql_dinamico('Luis','truncate table W_INTERF_CONTA_AUTOR');
CALL exec_sql_dinamico('Luis','truncate table W_INTERF_CONTA_CAB');
CALL exec_sql_dinamico('Luis','truncate table W_INTERF_CONTA_HEADER');
CALL exec_sql_dinamico('Luis','truncate table W_INTERF_CONTA_ITEM');
CALL exec_sql_dinamico('Luis','truncate table w_interf_conta_item_ipe');
CALL exec_sql_dinamico('Luis','truncate table W_INTERF_CONTA_TOTAL');
CALL exec_sql_dinamico('Luis','truncate table W_INTERF_CONTA_TRAILLER');
CALL exec_sql_dinamico('Luis','truncate table W_CONTA_ABRAMGE_ITEM');
CALL exec_sql_dinamico('Luis','truncate table W_LAB_IMPRESSAO');


CALL dropar_tabela_w();
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE limpar_tabelas_temporarias () FROM PUBLIC;

