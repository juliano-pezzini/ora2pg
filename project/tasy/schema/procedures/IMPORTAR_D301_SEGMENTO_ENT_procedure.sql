-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE importar_d301_segmento_ent (nr_seq_dataset_p bigint, ds_conteudo_ent_p text, nm_usuario_p text) AS $body$
DECLARE


  ds_conteudo_w           varchar(32767);

  cd_cobranca_w           d301_segmento_ent.cd_cobranca%type;
  vl_cobranca_w           d301_segmento_ent.vl_cobranca%type;
  ds_dt_inicio_cobranca_w d301_segmento_ent.ds_dt_inicio_cobranca%type;
  ds_dt_fim_cobranca_w    d301_segmento_ent.ds_dt_fim_cobranca%type;
  qt_dias_calculo_w       d301_segmento_ent.qt_dias_calculo%type;
  qt_dias_fora_calculo_w  d301_segmento_ent.qt_dias_fora_calculo%type;
  ds_dt_cura_w            d301_segmento_ent.ds_dt_cura%type;
  qt_item_w               d301_segmento_ent.qt_item%type;


BEGIN

  ds_conteudo_w := replace(ds_conteudo_ent_p,'''','');

  if (obter_valor_separador(ds_conteudo_w,1,'+') = 'ENT') then

    cd_cobranca_w           := obter_valor_separador(ds_conteudo_w,2,'+');
    vl_cobranca_w           := obter_valor_separador(ds_conteudo_w,3,'+');
    ds_dt_inicio_cobranca_w := obter_valor_separador(ds_conteudo_w,4,'+');
    ds_dt_fim_cobranca_w    := obter_valor_separador(ds_conteudo_w,5,'+');
    qt_dias_calculo_w       := obter_valor_separador(ds_conteudo_w,6,'+');
    qt_dias_fora_calculo_w  := obter_valor_separador(ds_conteudo_w,7,'+');
    ds_dt_cura_w            := null;
    qt_item_w               := null;
    insert into d301_segmento_ent(nr_sequencia,
                                  dt_atualizacao,
                                  nm_usuario,
                                  dt_atualizacao_nrec,
                                  nm_usuario_nrec,
                                  cd_cobranca,
                                  vl_cobranca,
                                  ds_dt_inicio_cobranca,
                                  ds_dt_fim_cobranca,
                                  qt_dias_calculo,
                                  qt_dias_fora_calculo,
                                  ds_dt_cura,
                                  nr_seq_dataset,
                                  qt_item,
                                  nr_seq_dataset_ret) values (nextval('d301_segmento_ent_seq'),
                                                              clock_timestamp(),
                                                              nm_usuario_p,
                                                              clock_timestamp(),
                                                              nm_usuario_p,
                                                              cd_cobranca_w,
                                                              vl_cobranca_w,
                                                              ds_dt_inicio_cobranca_w,
                                                              ds_dt_fim_cobranca_w,
                                                              qt_dias_calculo_w,
                                                              qt_dias_fora_calculo_w,
                                                              ds_dt_cura_w,
                                                              null,
                                                              qt_item_w,
                                                              nr_seq_dataset_p);


  end if;

  commit;


end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE importar_d301_segmento_ent (nr_seq_dataset_p bigint, ds_conteudo_ent_p text, nm_usuario_p text) FROM PUBLIC;

