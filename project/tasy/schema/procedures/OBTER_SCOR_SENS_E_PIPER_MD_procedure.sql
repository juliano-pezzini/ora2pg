-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_scor_sens_e_piper_md (QT_SENTINDO_FORTE_P bigint, QT_SENTINDO_ACORDADO_P bigint, QT_SENTINDO_VIDA_P bigint, QT_SENTINDO_VIGOR_P bigint, QT_SENTINDO_ENERGIA_P bigint, QT_SCORE_SENSORIAL_p INOUT bigint, qt_reg_sensorial_P INOUT bigint, qt_result_sensorial_P INOUT bigint ) AS $body$
DECLARE


	qt_reg_sensorial_w		integer := 0;
	qt_percent_subgrupo_w	integer := 0;
	qt_result_sensorial_w double precision := 0;

BEGIN
	if (QT_SENTINDO_FORTE_P IS NOT NULL AND QT_SENTINDO_FORTE_P::text <> '') then
		qt_reg_sensorial_w	:= 	qt_reg_sensorial_w + 1;
		qt_result_sensorial_w 	:= 	qt_result_sensorial_w +  coalesce(QT_SENTINDO_FORTE_P,0);
	end if;
	if (QT_SENTINDO_ACORDADO_P IS NOT NULL AND QT_SENTINDO_ACORDADO_P::text <> '') then
		qt_reg_sensorial_w	:= 	qt_reg_sensorial_w + 1;
		qt_result_sensorial_w 	:= 	qt_result_sensorial_w +  coalesce(QT_SENTINDO_ACORDADO_P,0);
	end if;
	if (QT_SENTINDO_VIDA_P IS NOT NULL AND QT_SENTINDO_VIDA_P::text <> '') then
		qt_reg_sensorial_w	:= 	qt_reg_sensorial_w + 1;
		qt_result_sensorial_w 	:= 	qt_result_sensorial_w +  coalesce(QT_SENTINDO_VIDA_P,0);
	end if;
	if (QT_SENTINDO_VIGOR_P IS NOT NULL AND QT_SENTINDO_VIGOR_P::text <> '') then
		qt_reg_sensorial_w	:= 	qt_reg_sensorial_w + 1;
		qt_result_sensorial_w 	:= 	qt_result_sensorial_w +  coalesce(QT_SENTINDO_VIGOR_P,0);
	end if;
	if (QT_SENTINDO_ENERGIA_P IS NOT NULL AND QT_SENTINDO_ENERGIA_P::text <> '') then
		qt_reg_sensorial_w	:= 	qt_reg_sensorial_w + 1;
		qt_result_sensorial_w 	:= 	qt_result_sensorial_w +  coalesce(QT_SENTINDO_ENERGIA_P,0);
	end if;
	if (qt_reg_sensorial_w >= 4) then
		qt_percent_subgrupo_w	:=	qt_percent_subgrupo_w + 1;
		QT_SCORE_SENSORIAL_p	:= 	dividir_md(qt_result_sensorial_w,qt_reg_sensorial_w);
	end if;
	
  qt_reg_sensorial_p     := qt_reg_sensorial_w;
	qt_result_sensorial_P  := qt_result_sensorial_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_scor_sens_e_piper_md (QT_SENTINDO_FORTE_P bigint, QT_SENTINDO_ACORDADO_P bigint, QT_SENTINDO_VIDA_P bigint, QT_SENTINDO_VIGOR_P bigint, QT_SENTINDO_ENERGIA_P bigint, QT_SCORE_SENSORIAL_p INOUT bigint, qt_reg_sensorial_P INOUT bigint, qt_result_sensorial_P INOUT bigint ) FROM PUBLIC;

