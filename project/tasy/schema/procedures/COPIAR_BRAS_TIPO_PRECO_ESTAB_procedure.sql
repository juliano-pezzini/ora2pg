-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE copiar_bras_tipo_preco_estab ( cd_estab_origem_p bigint, cd_estab_destino_p bigint, nm_usuario_p text) AS $body$
DECLARE


nr_sequencia_w		bigint;
				
C01 CURSOR FOR
	SELECT	*
	from	regra_brasindice_preco
	where	cd_estabelecimento = cd_estab_origem_p;
	
c01_w	c01%rowtype;
	

BEGIN
open C01;
loop
fetch C01 into
	C01_w;
EXIT WHEN NOT FOUND; /* apply on C01 */
	begin
	
	select 	nextval('regra_brasindice_preco_seq')
	into STRICT	nr_sequencia_w
	;
	
	insert into regra_brasindice_preco(
				nr_sequencia, cd_estabelecimento, dt_atualizacao, nm_usuario,
				cd_categoria, cd_classe_material, cd_convenio, cd_grupo_material,
				dt_atualizacao_nrec, nm_usuario_nrec, cd_material, cd_subgrupo_material,
				ie_tipo_atendimento, ie_tipo_preco,	nr_seq_estrutura, dt_inicio_vigencia,
				dt_final_vigencia, nr_seq_familia)
			values (nr_sequencia_w, cd_estab_destino_p,	clock_timestamp(), nm_usuario_p,
				C01_w.cd_categoria, C01_w.cd_classe_material, C01_w.cd_convenio, C01_w.cd_grupo_material,
				clock_timestamp(), nm_usuario_p,	C01_w.cd_material, C01_w.cd_subgrupo_material,
				C01_w.ie_tipo_atendimento, C01_w.ie_tipo_preco,	C01_w.nr_seq_estrutura, C01_w.dt_inicio_vigencia,
				C01_w.dt_final_vigencia, c01_w.nr_seq_familia);
	end;
end loop;
close C01;
commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE copiar_bras_tipo_preco_estab ( cd_estab_origem_p bigint, cd_estab_destino_p bigint, nm_usuario_p text) FROM PUBLIC;

