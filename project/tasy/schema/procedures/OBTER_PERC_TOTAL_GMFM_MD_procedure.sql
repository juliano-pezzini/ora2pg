-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_perc_total_gmfm_md ( ie_meta_a_p text, ie_meta_b_p text, ie_meta_c_p text, ie_meta_d_p text, ie_meta_e_p text, pr_dimensao_a_p bigint, pr_dimensao_b_p bigint, pr_dimensao_c_p bigint, pr_dimensao_d_p bigint, pr_dimensao_e_p bigint, pr_total_meta_p INOUT bigint, pr_total_p INOUT bigint) AS $body$
DECLARE


qt_calculo_w		smallint    := 0;


BEGIN
if (ie_meta_a_p = 'S') then
	pr_total_meta_p := coalesce(pr_total_meta_p,0) + coalesce(pr_dimensao_a_p,0);
	qt_calculo_w := coalesce(qt_calculo_w,0) +1;
end if;
if (ie_meta_b_p = 'S') then
	pr_total_meta_p := coalesce(pr_total_meta_p,0) + coalesce(pr_dimensao_b_p,0);
	qt_calculo_w := coalesce(qt_calculo_w,0) +1;
end if;
if (ie_meta_c_p = 'S') then
	pr_total_meta_p := coalesce(pr_total_meta_p,0) + coalesce(pr_dimensao_c_p,0);
	qt_calculo_w := coalesce(qt_calculo_w,0) +1;
end if;
if (ie_meta_d_p = 'S') then
	pr_total_meta_p := coalesce(pr_total_meta_p,0) + coalesce(pr_dimensao_d_p,0);
	qt_calculo_w := coalesce(qt_calculo_w,0) +1;
end if;
if (ie_meta_e_p = 'S') then
	pr_total_meta_p := coalesce(pr_total_meta_p,0) + coalesce(pr_dimensao_e_p,0);
	qt_calculo_w := coalesce(qt_calculo_w,0) +1;
end if;

pr_total_meta_p		:=	dividir_md( pr_total_meta_p,qt_calculo_w);
pr_total_P		    := 	(dividir_md((coalesce(pr_dimensao_a_p,0) + coalesce(pr_dimensao_b_p,0) + coalesce(pr_dimensao_c_p,0) + coalesce(pr_dimensao_d_p,0) + coalesce(pr_dimensao_e_p,0)),5));
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_perc_total_gmfm_md ( ie_meta_a_p text, ie_meta_b_p text, ie_meta_c_p text, ie_meta_d_p text, ie_meta_e_p text, pr_dimensao_a_p bigint, pr_dimensao_b_p bigint, pr_dimensao_c_p bigint, pr_dimensao_d_p bigint, pr_dimensao_e_p bigint, pr_total_meta_p INOUT bigint, pr_total_p INOUT bigint) FROM PUBLIC;

