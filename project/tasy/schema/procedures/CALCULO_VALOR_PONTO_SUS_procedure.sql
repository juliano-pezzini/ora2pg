-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE calculo_valor_ponto_sus (NR_SEQ_PROTOCOLO_P bigint) AS $body$
DECLARE

 
/* A parte comentada foi tirada em 13/04/2000 por Elemar a pedido do Marcus, 
  a chamada da procedure "Atualiza_Valor_Ponto_Sp" passa a partir deste dia 
  a ser chamada na procedure "Recalcular_Conta_Paciente". 
 
nr_atendimento_w			number(10)		:= 0; 
nr_interno_conta_w		number(10)		:= 0; 
 
CURSOR C01 IS 
	select 	a.nr_atendimento, 
			a.nr_interno_conta 
	from		conta_paciente a 
	where		a.nr_seq_protocolo 	= nr_seq_protocolo_p; 
 
OPEN C01; 
LOOP 
FETCH C01 into 
		nr_atendimento_w, 
		nr_interno_conta_w; 
	exit when c01%notfound; 
	BEGIN 
	ATUALIZAR_VALOR_PONTO_SP(nr_atendimento_w,nr_interno_conta_w); 
	END; 
END LOOP; 
CLOSE C01; 
*/
 
 

BEGIN 
 
CALL ATUALIZAR_VALOR_PONTO_SADT(NR_SEQ_PROTOCOLO_P);
CALL VALIDA_DIARIA_UTI_SUS(NR_SEQ_PROTOCOLO_P,'Tasy');
/*Gerar_controle_proc_aih(NR_SEQ_PROTOCOLO_P,'Tasy'); Felipe - Comentei pois o processo do SUS tambem foi cancelado, 
o mesmo n√£o disponibiliza mais os arquivos .TXT no site*/
 
 
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE calculo_valor_ponto_sus (NR_SEQ_PROTOCOLO_P bigint) FROM PUBLIC;

