-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE sus_gerar_w_esus_con_alim ( nr_seq_lote_p esus_lote_envio.nr_sequencia%type, ie_tipo_lote_esus_p esus_lote_envio.ie_tipo_lote_esus%type, cd_cnes_estab_p estabelecimento.cd_cns%type, nm_usuario_p usuario.nm_usuario%type) AS $body$
DECLARE

 
cd_cns_paciente_w			w_esus_marc_cons_aliment.cd_cns_paciente%type;				
dt_nascimento_paciente_w		w_esus_marc_cons_aliment.dt_nascimento_paciente%type;					
ie_sexo_paciente_w			w_esus_marc_cons_aliment.ie_sexo_paciente%type;
cd_cns_profissional_w			w_esus_marc_cons_aliment.cd_cns_profissional%type;
nr_seq_exp_w				w_esus_marc_cons_aliment.nr_sequencia%type;
cd_uuid_original_w			w_esus_marc_cons_aliment.cd_uuid_original%type;
nm_pessoa_fisica_w			w_esus_marc_cons_aliment.nm_pessoa_fisica%type;
nr_data_atendimento_w			w_esus_marc_cons_aliment.nr_data_atendimento%type;
nr_data_nasc_paci_w			w_esus_marc_cons_aliment.nr_data_nasc_paci%type;
ie_quais_refeicoes_w			varchar(10) := 'X';
qt_idade_pf_w				bigint := 0;

nr_sequencia_w				esus_marc_cons_aliment.nr_sequencia%type;
cd_estabelecimento_w			esus_marc_cons_aliment.cd_estabelecimento%type;
dt_atualizacao_w			esus_marc_cons_aliment.dt_atualizacao%type;
nm_usuario_w				esus_marc_cons_aliment.nm_usuario%type;
dt_atualizacao_nrec_w			esus_marc_cons_aliment.dt_atualizacao_nrec%type;
nm_usuario_nrec_w			esus_marc_cons_aliment.nm_usuario_nrec%type;
cd_pessoa_fisica_w			esus_marc_cons_aliment.cd_pessoa_fisica%type;
dt_liberacao_w				esus_marc_cons_aliment.dt_liberacao%type;
nr_seq_lote_envio_w			esus_marc_cons_aliment.nr_seq_lote_envio%type;
cd_profissional_w			esus_marc_cons_aliment.cd_profissional%type;
cd_cbo_w				esus_marc_cons_aliment.cd_cbo%type;
cd_cnes_unidade_w			esus_marc_cons_aliment.cd_cnes_unidade%type;
cd_cnes_unidade_ww			esus_marc_cons_aliment.cd_cnes_unidade%type;
nr_seq_sus_equipe_w			esus_marc_cons_aliment.nr_seq_sus_equipe%type;
dt_atendimento_w			esus_marc_cons_aliment.dt_atendimento%type;
ie_local_atendimento_w			esus_marc_cons_aliment.ie_local_atendimento%type;
ie_cri_men_leit_peit_w			esus_marc_cons_aliment.ie_cri_men_leit_peit%type;
ie_crian_cons_mingau_w			esus_marc_cons_aliment.ie_crian_cons_mingau%type;
ie_cri_cons_agua_cha_w			esus_marc_cons_aliment.ie_cri_cons_agua_cha%type;
ie_cri_con_leite_vac_w			esus_marc_cons_aliment.ie_cri_con_leite_vac%type;
ie_cri_cons_form_inf_w			esus_marc_cons_aliment.ie_cri_cons_form_inf%type;
ie_cri_cons_suco_fru_w			esus_marc_cons_aliment.ie_cri_cons_suco_fru%type;
ie_crian_consu_fruta_w			esus_marc_cons_aliment.ie_crian_consu_fruta%type;
ie_cri_con_comid_sal_w			esus_marc_cons_aliment.ie_cri_con_comid_sal%type;
ie_cri_cons_out_alim_w			esus_marc_cons_aliment.ie_cri_cons_out_alim%type;
ie_crian_leite_peito_w			esus_marc_cons_aliment.ie_crian_leite_peito%type;
ie_crian_comeu_fruta_w			esus_marc_cons_aliment.ie_crian_comeu_fruta%type;
ie_vezes_comeu_fruta_w			esus_marc_cons_aliment.ie_vezes_comeu_fruta%type;
ie_crianc_comida_sal_w			esus_marc_cons_aliment.ie_crianc_comida_sal%type;
ie_vezes_comida_sal_w			esus_marc_cons_aliment.ie_vezes_comida_sal%type;
ie_form_comid_oferec_w			esus_marc_cons_aliment.ie_form_comid_oferec%type;
ie_cri_cons_out_leit_w			esus_marc_cons_aliment.ie_cri_cons_out_leit%type;
ie_cri_con_ming_leit_w			esus_marc_cons_aliment.ie_cri_con_ming_leit%type;
ie_cria_cons_iogurte_w			esus_marc_cons_aliment.ie_cria_cons_iogurte%type;
ie_cria_cons_legumes_w			esus_marc_cons_aliment.ie_cria_cons_legumes%type;
ie_cri_con_veg_alara_w			esus_marc_cons_aliment.ie_cri_con_veg_alara%type;
ie_cri_con_verd_folh_w			esus_marc_cons_aliment.ie_cri_con_verd_folh%type;
ie_crian_consu_carne_w			esus_marc_cons_aliment.ie_crian_consu_carne%type;
ie_crian_cons_figado_w			esus_marc_cons_aliment.ie_crian_cons_figado%type;
ie_crian_cons_feijao_w			esus_marc_cons_aliment.ie_crian_cons_feijao%type;
ie_cri_con_arroz_bat_w			esus_marc_cons_aliment.ie_cri_con_arroz_bat%type;
ie_cri_con_ham_embut_w			esus_marc_cons_aliment.ie_cri_con_ham_embut%type;
ie_cri_cons_beb_adoc_w			esus_marc_cons_aliment.ie_cri_cons_beb_adoc%type;
ie_cri_con_macar_ins_w			esus_marc_cons_aliment.ie_cri_con_macar_ins%type;
ie_cri_con_doce_gulo_w			esus_marc_cons_aliment.ie_cri_con_doce_gulo%type;
ie_rel_refe_tv_celul_w			esus_marc_cons_aliment.ie_rel_refe_tv_celul%type;
ie_tomou_cafe_manha_w			esus_marc_cons_aliment.ie_tomou_cafe_manha%type;
ie_fez_lanche_manha_w			esus_marc_cons_aliment.ie_fez_lanche_manha%type;
ie_refeicao_almoco_w			esus_marc_cons_aliment.ie_refeicao_almoco%type;
ie_fez_lanche_tarde_w			esus_marc_cons_aliment.ie_fez_lanche_tarde%type;
ie_refeicao_jantar_w			esus_marc_cons_aliment.ie_refeicao_jantar%type;
ie_refeicao_ceia_w			esus_marc_cons_aliment.ie_refeicao_ceia%type;
ie_consumiu_feijao_w			esus_marc_cons_aliment.ie_consumiu_feijao%type;
ie_consu_fruta_fresc_w			esus_marc_cons_aliment.ie_consu_fruta_fresc%type;
ie_cons_verdur_legum_w			esus_marc_cons_aliment.ie_cons_verdur_legum%type;
ie_cons_hambur_embut_w			esus_marc_cons_aliment.ie_cons_hambur_embut%type;
ie_cons_bebid_adocad_w			esus_marc_cons_aliment.ie_cons_bebid_adocad%type;
ie_cons_macar_instan_w			esus_marc_cons_aliment.ie_cons_macar_instan%type;
ie_cons_doce_gulosei_w 		esus_marc_cons_aliment.ie_cons_doce_gulosei%type;

cd_contra_chave_rem_w		w_esus_header_footer.cd_contra_chave_rem%type;
cd_uuid_instal_rem_w		w_esus_header_footer.cd_uuid_instal_rem%type;
cd_contra_chave_ori_w		w_esus_header_footer.cd_contra_chave_ori%type;
cd_uuid_instal_orig_w		w_esus_header_footer.cd_uuid_instal_orig%type;
cd_municipio_ibge_ww		w_esus_header_footer.cd_municipio_ibge%type;

ConAlim CURSOR FOR 
	SELECT 	nr_sequencia, 
		coalesce(cd_estabelecimento,0) cd_estabelecimento, 
		dt_atualizacao, 
		nm_usuario, 
		dt_atualizacao_nrec, 
		nm_usuario_nrec, 
		cd_pessoa_fisica, 
		dt_liberacao, 
		nr_seq_lote_envio, 
		cd_profissional, 
		cd_cbo, 
		cd_cnes_unidade, 
		nr_seq_sus_equipe, 
		dt_atendimento, 
		ie_local_atendimento, 
		ie_cri_men_leit_peit, 
		ie_crian_cons_mingau, 
		ie_cri_cons_agua_cha, 
		ie_cri_con_leite_vac, 
		ie_cri_cons_form_inf, 
		ie_cri_cons_suco_fru, 
		ie_crian_consu_fruta, 
		ie_cri_con_comid_sal, 
		ie_cri_cons_out_alim, 
		ie_crian_leite_peito, 
		ie_crian_comeu_fruta, 
		ie_vezes_comeu_fruta, 
		ie_crianc_comida_sal, 
		ie_vezes_comida_sal, 
		ie_form_comid_oferec, 
		ie_cri_cons_out_leit, 
		ie_cri_con_ming_leit, 
		ie_cria_cons_iogurte, 
		ie_cria_cons_legumes, 
		ie_cri_con_veg_alara, 
		ie_cri_con_verd_folh, 
		ie_crian_consu_carne, 
		ie_crian_cons_figado, 
		ie_crian_cons_feijao, 
		ie_cri_con_arroz_bat, 
		ie_cri_con_ham_embut, 
		ie_cri_cons_beb_adoc, 
		ie_cri_con_macar_ins, 
		ie_cri_con_doce_gulo, 
		ie_rel_refe_tv_celul, 
		ie_tomou_cafe_manha, 
		ie_fez_lanche_manha, 
		ie_refeicao_almoco, 
		ie_fez_lanche_tarde, 
		ie_refeicao_jantar, 
		ie_refeicao_ceia, 
		ie_consumiu_feijao, 
		ie_consu_fruta_fresc, 
		ie_cons_verdur_legum, 
		ie_cons_hambur_embut, 
		ie_cons_bebid_adocad, 
		ie_cons_macar_instan, 
		ie_cons_doce_gulosei, 
		cd_uuid_original 
	from	esus_marc_cons_aliment 
	where	nr_seq_lote_envio =	nr_seq_lote_p 
	order by nr_sequencia;

type 		fetch_array is table of ConAlim%rowtype;
s_array 	fetch_array;
i		integer := 1;
type vetor is table of fetch_array index by integer;
vetor_ConAlim_w			vetor;

	 
BEGIN 
 
delete 	from w_esus_marc_cons_aliment 
where	nr_seq_lote_envio = nr_seq_lote_p;
 
 
open ConAlim;
loop 
fetch ConAlim bulk collect into s_array limit 1000;
	vetor_ConAlim_w(i) := s_array;
	i := i + 1;
EXIT WHEN NOT FOUND; /* apply on ConAlim */
end loop;
close ConAlim;
 
 
for i in 1..vetor_ConAlim_w.count loop 
	begin 
	s_array := vetor_ConAlim_w(i);
	for z in 1..s_array.count loop 
		begin 
		 
		nr_sequencia_w				:= s_array[z].nr_sequencia;
		cd_estabelecimento_w			:= s_array[z].cd_estabelecimento;
		dt_atualizacao_w			:= s_array[z].dt_atualizacao;
		nm_usuario_w				:= s_array[z].nm_usuario;
		dt_atualizacao_nrec_w			:= s_array[z].dt_atualizacao_nrec;
		nm_usuario_nrec_w			:= s_array[z].nm_usuario_nrec;
		cd_pessoa_fisica_w			:= s_array[z].cd_pessoa_fisica;
		dt_liberacao_w				:= s_array[z].dt_liberacao;
		nr_seq_lote_envio_w			:= s_array[z].nr_seq_lote_envio;
		cd_profissional_w			:= s_array[z].cd_profissional;
		cd_cbo_w				:= s_array[z].cd_cbo;
		cd_cnes_unidade_w			:= s_array[z].cd_cnes_unidade;
		nr_seq_sus_equipe_w			:= s_array[z].nr_seq_sus_equipe;
		dt_atendimento_w			:= s_array[z].dt_atendimento;
		ie_local_atendimento_w			:= s_array[z].ie_local_atendimento;
		ie_cri_men_leit_peit_w			:= s_array[z].ie_cri_men_leit_peit;
		ie_crian_cons_mingau_w			:= s_array[z].ie_crian_cons_mingau;
		ie_cri_cons_agua_cha_w			:= s_array[z].ie_cri_cons_agua_cha;
		ie_cri_con_leite_vac_w			:= s_array[z].ie_cri_con_leite_vac;
		ie_cri_cons_form_inf_w			:= s_array[z].ie_cri_cons_form_inf;
		ie_cri_cons_suco_fru_w			:= s_array[z].ie_cri_cons_suco_fru;
		ie_crian_consu_fruta_w			:= s_array[z].ie_crian_consu_fruta;
		ie_cri_con_comid_sal_w			:= s_array[z].ie_cri_con_comid_sal;
		ie_cri_cons_out_alim_w			:= s_array[z].ie_cri_cons_out_alim;
		ie_crian_leite_peito_w			:= s_array[z].ie_crian_leite_peito;
		ie_crian_comeu_fruta_w			:= s_array[z].ie_crian_comeu_fruta;
		ie_vezes_comeu_fruta_w			:= s_array[z].ie_vezes_comeu_fruta;
		ie_crianc_comida_sal_w			:= s_array[z].ie_crianc_comida_sal;
		ie_vezes_comida_sal_w			:= s_array[z].ie_vezes_comida_sal;
		ie_form_comid_oferec_w			:= s_array[z].ie_form_comid_oferec;
		ie_cri_cons_out_leit_w			:= s_array[z].ie_cri_cons_out_leit;
		ie_cri_con_ming_leit_w			:= s_array[z].ie_cri_con_ming_leit;
		ie_cria_cons_iogurte_w			:= s_array[z].ie_cria_cons_iogurte;
		ie_cria_cons_legumes_w			:= s_array[z].ie_cria_cons_legumes;
		ie_cri_con_veg_alara_w			:= s_array[z].ie_cri_con_veg_alara;
		ie_cri_con_verd_folh_w			:= s_array[z].ie_cri_con_verd_folh;
		ie_crian_consu_carne_w			:= s_array[z].ie_crian_consu_carne;
		ie_crian_cons_figado_w			:= s_array[z].ie_crian_cons_figado;
		ie_crian_cons_feijao_w			:= s_array[z].ie_crian_cons_feijao;
		ie_cri_con_arroz_bat_w			:= s_array[z].ie_cri_con_arroz_bat;
		ie_cri_con_ham_embut_w			:= s_array[z].ie_cri_con_ham_embut;
		ie_cri_cons_beb_adoc_w			:= s_array[z].ie_cri_cons_beb_adoc;
		ie_cri_con_macar_ins_w			:= s_array[z].ie_cri_con_macar_ins;
		ie_cri_con_doce_gulo_w			:= s_array[z].ie_cri_con_doce_gulo;
		ie_rel_refe_tv_celul_w			:= s_array[z].ie_rel_refe_tv_celul;
		ie_tomou_cafe_manha_w			:= s_array[z].ie_tomou_cafe_manha;
		ie_fez_lanche_manha_w			:= s_array[z].ie_fez_lanche_manha;
		ie_refeicao_almoco_w			:= s_array[z].ie_refeicao_almoco;
		ie_fez_lanche_tarde_w			:= s_array[z].ie_fez_lanche_tarde;
		ie_refeicao_jantar_w			:= s_array[z].ie_refeicao_jantar;
		ie_refeicao_ceia_w			:= s_array[z].ie_refeicao_ceia;
		ie_consumiu_feijao_w			:= s_array[z].ie_consumiu_feijao;
		ie_consu_fruta_fresc_w			:= s_array[z].ie_consu_fruta_fresc;
		ie_cons_verdur_legum_w			:= s_array[z].ie_cons_verdur_legum;
		ie_cons_hambur_embut_w			:= s_array[z].ie_cons_hambur_embut;
		ie_cons_bebid_adocad_w			:= s_array[z].ie_cons_bebid_adocad;
		ie_cons_macar_instan_w			:= s_array[z].ie_cons_macar_instan;
		ie_cons_doce_gulosei_w 		:= s_array[z].ie_cons_doce_gulosei;
		cd_uuid_original_w			:= s_array[z].cd_uuid_original;
		 
		if (coalesce(cd_pessoa_fisica_w,'X') <> 'X') then 
			begin 
			nm_pessoa_fisica_w		:= substr(elimina_acentos(upper(obter_nome_pf(cd_pessoa_fisica_w)),'S'),1,70);
			cd_cns_paciente_w		:= substr(obter_dados_pf(cd_pessoa_fisica_w,'CNS'),1,20);
			dt_nascimento_paciente_w	:= to_date(substr(obter_dados_pf(cd_pessoa_fisica_w,'DN'),1,10),'dd/mm/yyyy');
			ie_sexo_paciente_w		:= substr(sus_gerar_depara_esus(obter_dados_pf(cd_pessoa_fisica_w,'SE'),'SEXO'),1,20);
			end;
		end if;		
		 
		begin 
			cd_cns_profissional_w := substr(obter_dados_pf(cd_profissional_w,'CNS'),1,20);		
		exception 
		when others then 
			cd_cns_profissional_w := '';
		end;
			 
		select	nextval('w_esus_marc_cons_aliment_seq') 
		into STRICT	nr_seq_exp_w 
		;
		 
		if	((coalesce(ie_tomou_cafe_manha_w,'X') = 'S') or (coalesce(ie_fez_lanche_manha_w,'X') = 'S') or (coalesce(ie_refeicao_almoco_w,'X') = 'S') or (coalesce(ie_fez_lanche_tarde_w,'X') = 'S') or (coalesce(ie_refeicao_jantar_w,'X') = 'S') or (coalesce(ie_refeicao_ceia_w,'X') = 'S')) then			 
			ie_quais_refeicoes_w := 'S';
		else 
			ie_quais_refeicoes_w := 'X';
		end if;
		 
		if (dt_atendimento_w IS NOT NULL AND dt_atendimento_w::text <> '') then 
			nr_data_atendimento_w := rpad(((dt_atendimento_w - to_date('01/01/1970 00:00:00','dd/mm/yyyy hh24:mi:ss')) * 86400),13,0);
		else 
			nr_data_atendimento_w := null;
		end if;
		 
		if (dt_nascimento_paciente_w IS NOT NULL AND dt_nascimento_paciente_w::text <> '') then 
			nr_data_nasc_paci_w := ((dt_nascimento_paciente_w - to_date('01/01/1970 00:00:00','dd/mm/yyyy hh24:mi:ss')) * 86400);
		else 
			nr_data_nasc_paci_w := null;
		end if;
		 
		qt_idade_pf_w := coalesce(trunc(months_between(dt_atendimento_w,dt_nascimento_paciente_w)),0);	
		 
		if (qt_idade_pf_w < 6) then 
			begin 
			ie_crian_leite_peito_w := '';
			ie_crian_comeu_fruta_w := '';
			ie_vezes_comeu_fruta_w := '';
			ie_crianc_comida_sal_w := '';
			ie_vezes_comida_sal_w := '';
			ie_form_comid_oferec_w := '';
			ie_cri_cons_out_leit_w := '';
			ie_cri_con_ming_leit_w := '';
			ie_cria_cons_iogurte_w := '';
			ie_cria_cons_legumes_w := '';
			ie_cri_con_veg_alara_w := '';
			ie_cri_con_verd_folh_w := '';
			ie_crian_consu_carne_w := '';
			ie_crian_cons_figado_w := '';
			ie_crian_cons_feijao_w := '';
			ie_cri_con_arroz_bat_w := '';
			ie_cri_con_ham_embut_w := '';
			ie_cri_cons_beb_adoc_w := '';
			ie_cri_con_macar_ins_w := '';
			ie_cri_con_doce_gulo_w := '';
			ie_rel_refe_tv_celul_w := '';
			ie_tomou_cafe_manha_w := '';
			ie_fez_lanche_manha_w := '';
			ie_refeicao_almoco_w := '';
			ie_fez_lanche_tarde_w := '';
			ie_refeicao_jantar_w := '';
			ie_refeicao_ceia_w := '';
			ie_consumiu_feijao_w := '';
			ie_consu_fruta_fresc_w := '';
			ie_cons_verdur_legum_w := '';
			ie_cons_hambur_embut_w := '';
			ie_cons_bebid_adocad_w := '';
			ie_cons_macar_instan_w := '';
			ie_cons_doce_gulosei_w := '';
			 
			if (coalesce(ie_cri_men_leit_peit_w,'X') = 'X') then 
				ie_cri_men_leit_peit_w := 'B';
			end if;
			if (coalesce(ie_crian_cons_mingau_w,'X') = 'X') then 
				ie_crian_cons_mingau_w := 'B';
			end if;
			if (coalesce(ie_cri_cons_agua_cha_w,'X') = 'X') then 
				ie_cri_cons_agua_cha_w := 'B';
			end if;
			if (coalesce(ie_cri_con_leite_vac_w,'X') = 'X') then 
				ie_cri_con_leite_vac_w := 'B';
			end if;
			if (coalesce(ie_cri_cons_form_inf_w,'X') = 'X') then 
				ie_cri_cons_form_inf_w := 'B';
			end if;
			if (coalesce(ie_cri_cons_suco_fru_w,'X') = 'X') then 
				ie_cri_cons_suco_fru_w := 'B';
			end if;
			if (coalesce(ie_crian_consu_fruta_w,'X') = 'X') then 
				ie_crian_consu_fruta_w := 'B';
			end if;
			if (coalesce(ie_cri_con_comid_sal_w,'X') = 'X') then 
				ie_cri_con_comid_sal_w := 'B';
			end if;
			if (coalesce(ie_cri_cons_out_alim_w,'X') = 'X') then 
				ie_cri_cons_out_alim_w := 'B';
			end if;
			 
			end;
		elsif (qt_idade_pf_w < 24) then 
			begin 
			ie_cri_men_leit_peit_w := '';
			ie_crian_cons_mingau_w := '';
			ie_cri_cons_agua_cha_w := '';
			ie_cri_con_leite_vac_w := '';
			ie_cri_cons_form_inf_w := '';
			ie_cri_cons_suco_fru_w := '';
			ie_crian_consu_fruta_w := '';
			ie_cri_con_comid_sal_w := '';
			ie_cri_cons_out_alim_w := '';
			ie_rel_refe_tv_celul_w := '';
			ie_tomou_cafe_manha_w := '';
			ie_fez_lanche_manha_w := '';
			ie_refeicao_almoco_w := '';
			ie_fez_lanche_tarde_w := '';
			ie_refeicao_jantar_w := '';
			ie_refeicao_ceia_w := '';
			ie_consumiu_feijao_w := '';
			ie_consu_fruta_fresc_w := '';
			ie_cons_verdur_legum_w := '';
			ie_cons_hambur_embut_w := '';
			ie_cons_bebid_adocad_w := '';
			ie_cons_macar_instan_w := '';
			ie_cons_doce_gulosei_w := '';
			 
			if (coalesce(ie_crian_leite_peito_w,'X') = 'X') then 
				ie_crian_leite_peito_w := 'B';
			end if;
			if (coalesce(ie_crian_comeu_fruta_w,'X') = 'X') then 
				ie_crian_comeu_fruta_w := 'B';
			end if;
			if (coalesce(ie_vezes_comeu_fruta_w,'X') = 'X') then 
				ie_vezes_comeu_fruta_w := 'B';
			end if;
			if (coalesce(ie_crianc_comida_sal_w,'X') = 'X') then 
				ie_crianc_comida_sal_w := 'B';
			end if;
			if (coalesce(ie_vezes_comida_sal_w,'X') = 'X') then 
				ie_vezes_comida_sal_w := 'B';
			end if;
			if (coalesce(ie_form_comid_oferec_w,'X') = 'X') then 
				ie_form_comid_oferec_w := 'B';
			end if;
			if (coalesce(ie_cri_cons_out_leit_w,'X') = 'X') then 
				ie_cri_cons_out_leit_w := 'B';
			end if;
			if (coalesce(ie_cri_con_ming_leit_w,'X') = 'X') then 
				ie_cri_con_ming_leit_w := 'B';
			end if;
			if (coalesce(ie_cria_cons_iogurte_w,'X') = 'X') then 
				ie_cria_cons_iogurte_w := 'B';
			end if;
			if (coalesce(ie_cria_cons_legumes_w,'X') = 'X') then 
				ie_cria_cons_legumes_w := 'B';
			end if;
			if (coalesce(ie_cri_con_veg_alara_w,'X') = 'X') then 
				ie_cri_con_veg_alara_w := 'B';
			end if;
			if (coalesce(ie_cri_con_verd_folh_w,'X') = 'X') then 
				ie_cri_con_verd_folh_w := 'B';
			end if;
			if (coalesce(ie_crian_consu_carne_w,'X') = 'X') then 
				ie_crian_consu_carne_w := 'B';
			end if;
			if (coalesce(ie_crian_cons_figado_w,'X') = 'X') then 
				ie_crian_cons_figado_w := 'B';
			end if;
			if (coalesce(ie_crian_cons_feijao_w,'X') = 'X') then 
				ie_crian_cons_feijao_w := 'B';
			end if;
			if (coalesce(ie_cri_con_arroz_bat_w,'X') = 'X') then 
				ie_cri_con_arroz_bat_w := 'B';
			end if;
			if (coalesce(ie_cri_con_ham_embut_w,'X') = 'X') then 
				ie_cri_con_ham_embut_w := 'B';
			end if;
			if (coalesce(ie_cri_cons_beb_adoc_w,'X') = 'X') then 
				ie_cri_cons_beb_adoc_w := 'B';
			end if;
			if (coalesce(ie_cri_con_macar_ins_w,'X') = 'X') then 
				ie_cri_con_macar_ins_w := 'B';
			end if;
			if (coalesce(ie_cri_con_doce_gulo_w,'X') = 'X') then 
				ie_cri_con_doce_gulo_w := 'B';
			end if;
			end;
		else 
			begin 
			ie_cri_men_leit_peit_w := '';
			ie_crian_cons_mingau_w := '';
			ie_cri_cons_agua_cha_w := '';
			ie_cri_con_leite_vac_w := '';
			ie_cri_cons_form_inf_w := '';
			ie_cri_cons_suco_fru_w := '';
			ie_crian_consu_fruta_w := '';
			ie_cri_con_comid_sal_w := '';
			ie_cri_cons_out_alim_w := '';
			ie_crian_leite_peito_w := '';
			ie_crian_comeu_fruta_w := '';
			ie_vezes_comeu_fruta_w := '';
			ie_crianc_comida_sal_w := '';
			ie_vezes_comida_sal_w := '';
			ie_form_comid_oferec_w := '';
			ie_cri_cons_out_leit_w := '';
			ie_cri_con_ming_leit_w := '';
			ie_cria_cons_iogurte_w := '';
			ie_cria_cons_legumes_w := '';
			ie_cri_con_veg_alara_w := '';
			ie_cri_con_verd_folh_w := '';
			ie_crian_consu_carne_w := '';
			ie_crian_cons_figado_w := '';
			ie_crian_cons_feijao_w := '';
			ie_cri_con_arroz_bat_w := '';
			ie_cri_con_ham_embut_w := '';
			ie_cri_cons_beb_adoc_w := '';
			ie_cri_con_macar_ins_w := '';
			ie_cri_con_doce_gulo_w := '';
			 
			if (coalesce(ie_rel_refe_tv_celul_w,'X') = 'X') then 
				ie_rel_refe_tv_celul_w := 'B';
			end if;
			if (coalesce(ie_tomou_cafe_manha_w,'X') = 'X') then 
				ie_tomou_cafe_manha_w := 'B';
			end if;
			if (coalesce(ie_fez_lanche_manha_w,'X') = 'X') then 
				ie_fez_lanche_manha_w := 'B';
			end if;
			if (coalesce(ie_refeicao_almoco_w,'X') = 'X') then 
				ie_refeicao_almoco_w := 'B';
			end if;
			if (coalesce(ie_fez_lanche_tarde_w,'X') = 'X') then 
				ie_fez_lanche_tarde_w := 'B';
			end if;
			if (coalesce(ie_refeicao_jantar_w,'X') = 'X') then 
				ie_refeicao_jantar_w := 'B';
			end if;
			if (coalesce(ie_refeicao_ceia_w,'X') = 'X') then 
				ie_refeicao_ceia_w := 'B';
			end if;
			if (coalesce(ie_consumiu_feijao_w,'X') = 'X') then 
				ie_consumiu_feijao_w := 'B';
			end if;
			if (coalesce(ie_consu_fruta_fresc_w,'X') = 'X') then 
				ie_consu_fruta_fresc_w := 'B';
			end if;
			if (coalesce(ie_cons_verdur_legum_w,'X') = 'X') then 
				ie_cons_verdur_legum_w := 'B';
			end if;
			if (coalesce(ie_cons_hambur_embut_w,'X') = 'X') then 
				ie_cons_hambur_embut_w := 'B';
			end if;
			if (coalesce(ie_cons_bebid_adocad_w,'X') = 'X') then 
				ie_cons_bebid_adocad_w := 'B';
			end if;
			if (coalesce(ie_cons_macar_instan_w,'X') = 'X') then 
				ie_cons_macar_instan_w := 'B';
			end if;
			if (coalesce(ie_cons_doce_gulosei_w,'X') = 'X') then 
				ie_cons_doce_gulosei_w := 'B';
			end if;
			end;
		end if;
		 
		select	coalesce(max(cd_cnes_unidade),'0') 
		into STRICT	cd_cnes_unidade_ww 
		from	w_esus_header_footer 
		where	nr_seq_lote_envio = nr_seq_lote_p;
		 
		if (cd_cnes_unidade_w <> cd_cnes_unidade_ww) then 
			begin 
			cd_contra_chave_rem_w	:= substr(sus_gerar_uuid_esus(cd_cnes_unidade_w,'C'),1,50);
			cd_uuid_instal_rem_w	:= substr(sus_gerar_uuid_esus(cd_cnes_unidade_w,'U'),1,50);
			cd_contra_chave_ori_w	:= cd_contra_chave_rem_w;
			cd_uuid_instal_orig_w	:= cd_uuid_instal_rem_w;			
			cd_municipio_ibge_ww	:= sus_obter_dados_equipe(nr_seq_sus_equipe_w,'CM');
			cd_municipio_ibge_ww	:= substr(cd_municipio_ibge_ww||Calcula_Digito('MODULO10',cd_municipio_ibge_ww),1,7);
			 
			update 	w_esus_header_footer 
			set 	cd_cnes_unidade = cd_cnes_unidade_w, 
				cd_cnes_serealizado = cd_cnes_unidade_w, 
				cd_contra_chave_rem = cd_contra_chave_rem_w, 
				cd_uuid_instal_rem = cd_uuid_instal_rem_w, 
				cd_contra_chave_ori = cd_contra_chave_ori_w, 
				cd_uuid_instal_orig = cd_uuid_instal_orig_w, 
				cd_municipio_ibge = cd_municipio_ibge_ww 
			where	nr_seq_lote_envio = nr_seq_lote_p;
			 
			end;
		end if;
		 
		if (coalesce(cd_uuid_original_w,'X') = 'X') then 
			cd_uuid_original_w := coalesce(sus_gerar_uuid_esus(cd_cnes_unidade_w,'U'),'0');
			update esus_marc_cons_aliment set cd_uuid_original = cd_uuid_original_w where nr_sequencia = nr_sequencia_w;
		end if;
		 
		insert into w_esus_marc_cons_aliment(	nr_sequencia, 
							nr_seq_ficha, 
							cd_estabelecimento, 
							dt_atualizacao, 
							nm_usuario, 
							dt_atualizacao_nrec, 
							nm_usuario_nrec, 
							cd_pessoa_fisica, 
							nr_seq_lote_envio, 
							cd_profissional, 
							cd_cbo, 
							nr_seq_sus_equipe, 
							dt_atendimento, 
							ie_local_atendimento, 
							ie_cri_men_leit_peit, 
							ie_crian_cons_mingau, 
							ie_cri_cons_agua_cha, 
							ie_cri_con_leite_vac, 
							ie_cri_cons_form_inf, 
							ie_cri_cons_suco_fru, 
							ie_crian_consu_fruta, 
							ie_cri_con_comid_sal, 
							ie_cri_cons_out_alim, 
							ie_crian_leite_peito, 
							ie_crian_comeu_fruta, 
							ie_vezes_comeu_fruta, 
							ie_crianc_comida_sal, 
							ie_vezes_comida_sal, 
							ie_form_comid_oferec, 
							ie_cri_cons_out_leit, 
							ie_cri_con_ming_leit, 
							ie_cria_cons_iogurte, 
							ie_cria_cons_legumes, 
							ie_cri_con_veg_alara, 
							ie_cri_con_verd_folh, 
							ie_crian_consu_carne, 
							ie_crian_cons_figado, 
							ie_crian_cons_feijao, 
							ie_cri_con_arroz_bat, 
							ie_cri_con_ham_embut, 
							ie_cri_cons_beb_adoc, 
							ie_cri_con_macar_ins, 
							ie_cri_con_doce_gulo, 
							ie_rel_refe_tv_celul, 
							ie_tomou_cafe_manha, 
							ie_fez_lanche_manha, 
							ie_refeicao_almoco, 
							ie_fez_lanche_tarde, 
							ie_refeicao_jantar, 
							ie_refeicao_ceia, 
							ie_consumiu_feijao, 
							ie_consu_fruta_fresc, 
							ie_cons_verdur_legum, 
							ie_cons_hambur_embut, 
							ie_cons_bebid_adocad, 
							ie_cons_macar_instan, 
							ie_cons_doce_gulosei, 
							cd_cns_paciente, 
							dt_nascimento_paciente, 
							ie_sexo_paciente, 
							cd_cns_profissional, 
							cd_uuid_original, 
							nm_pessoa_fisica, 
							nr_data_atendimento, 
							nr_data_nasc_paci, 
							ds_cri_men_leit_peit, 
							ds_crian_cons_mingau, 
							ds_cri_cons_agua_cha, 
							ds_cri_con_leite_vac, 
							ds_cri_cons_form_inf, 
							ds_cri_cons_suco_fru, 
							ds_crian_consu_fruta, 
							ds_cri_con_comid_sal, 
							ds_cri_cons_out_alim, 
							ds_crian_leite_peito, 
							ds_crian_comeu_fruta, 
							ds_vezes_comeu_fruta, 
							ds_crianc_comida_sal, 
							ds_vezes_comida_sal, 
							ds_form_comid_oferec, 
							ds_cri_cons_out_leit, 
							ds_cri_con_ming_leit, 
							ds_cria_cons_iogurte, 
							ds_cria_cons_legumes, 
							ds_cri_con_veg_alara, 
							ds_cri_con_verd_folh, 
							ds_crian_consu_carne, 
							ds_crian_cons_figado, 
							ds_crian_cons_feijao, 
							ds_cri_con_arroz_bat, 
							ds_cri_con_ham_embut, 
							ds_cri_cons_beb_adoc, 
							ds_cri_con_macar_ins, 
							ds_cri_con_doce_gulo, 
							ds_rel_refe_tv_celul, 
							ds_quais_refeicoes, 
							ds_consumiu_feijao, 
							ds_consu_fruta_fresc, 
							ds_cons_verdur_legum, 
							ds_cons_hambur_embut, 
							ds_cons_bebid_adocad, 
							ds_cons_macar_instan, 
							ds_cons_doce_gulosei 
							) 
					values (	nr_seq_exp_w, 
							nr_sequencia_w, 
							cd_estabelecimento_w, 
							dt_atualizacao_w, 
							nm_usuario_w, 
							dt_atualizacao_nrec_w, 
							nm_usuario_nrec_w, 
							cd_pessoa_fisica_w, 
							nr_seq_lote_envio_w, 
							cd_profissional_w, 
							cd_cbo_w, 
							nr_seq_sus_equipe_w, 
							dt_atendimento_w, 
							ie_local_atendimento_w, 
							CASE WHEN coalesce(ie_cri_men_leit_peit_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_men_leit_peit_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_men_leit_peit_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_crian_cons_mingau_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_crian_cons_mingau_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_crian_cons_mingau_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_cons_agua_cha_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_cons_agua_cha_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_cons_agua_cha_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_con_leite_vac_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_con_leite_vac_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_con_leite_vac_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_cons_form_inf_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_cons_form_inf_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_cons_form_inf_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_cons_suco_fru_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_cons_suco_fru_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_cons_suco_fru_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_crian_consu_fruta_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_crian_consu_fruta_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_crian_consu_fruta_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_con_comid_sal_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_con_comid_sal_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_con_comid_sal_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_cons_out_alim_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_cons_out_alim_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_cons_out_alim_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_crian_leite_peito_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_crian_leite_peito_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_crian_leite_peito_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_crian_comeu_fruta_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_crian_comeu_fruta_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_crian_comeu_fruta_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_vezes_comeu_fruta_w,'X')='U' THEN 'UMA_VEZ' WHEN coalesce(ie_vezes_comeu_fruta_w,'X')='D' THEN 'DUAS_VEZES' WHEN coalesce(ie_vezes_comeu_fruta_w,'X')='T' THEN 'TRES_VEZES_OU_MAIS' WHEN coalesce(ie_vezes_comeu_fruta_w,'X')='N' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_crianc_comida_sal_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_crianc_comida_sal_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_crianc_comida_sal_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_vezes_comida_sal_w,'X')='U' THEN 'UMA_VEZ' WHEN coalesce(ie_vezes_comida_sal_w,'X')='D' THEN 'DUAS_VEZES' WHEN coalesce(ie_vezes_comida_sal_w,'X')='T' THEN 'TRES_VEZES_OU_MAIS' WHEN coalesce(ie_vezes_comida_sal_w,'X')='N' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_form_comid_oferec_w,'X')='E' THEN 'EM_PEDACOS' WHEN coalesce(ie_form_comid_oferec_w,'X')='A' THEN 'AMASSADA' WHEN coalesce(ie_form_comid_oferec_w,'X')='P' THEN 'PASSADA_NA_PENEIRA' WHEN coalesce(ie_form_comid_oferec_w,'X')='L' THEN 'LIQUIDIFICADA' WHEN coalesce(ie_form_comid_oferec_w,'X')='C' THEN 'SO_O_CALDO' WHEN coalesce(ie_form_comid_oferec_w,'X')='N' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_cons_out_leit_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_cons_out_leit_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_cons_out_leit_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_con_ming_leit_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_con_ming_leit_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_con_ming_leit_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cria_cons_iogurte_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cria_cons_iogurte_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cria_cons_iogurte_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cria_cons_legumes_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cria_cons_legumes_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cria_cons_legumes_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_con_veg_alara_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_con_veg_alara_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_con_veg_alara_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_con_verd_folh_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_con_verd_folh_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_con_verd_folh_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_crian_consu_carne_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_crian_consu_carne_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_crian_consu_carne_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_crian_cons_figado_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_crian_cons_figado_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_crian_cons_figado_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_crian_cons_feijao_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_crian_cons_feijao_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_crian_cons_feijao_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_con_arroz_bat_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_con_arroz_bat_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_con_arroz_bat_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_con_ham_embut_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_con_ham_embut_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_con_ham_embut_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_cons_beb_adoc_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_cons_beb_adoc_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_cons_beb_adoc_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_con_macar_ins_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_con_macar_ins_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_con_macar_ins_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cri_con_doce_gulo_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cri_con_doce_gulo_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cri_con_doce_gulo_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_rel_refe_tv_celul_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_rel_refe_tv_celul_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_rel_refe_tv_celul_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_tomou_cafe_manha_w,'X')='S' THEN 'CAFE_DA_MANHA'  ELSE '' END , 
							CASE WHEN coalesce(ie_fez_lanche_manha_w,'X')='S' THEN 'LANCHE_DA_MANHA'  ELSE '' END , 
							CASE WHEN coalesce(ie_refeicao_almoco_w,'X')='S' THEN 'ALMOCO'  ELSE '' END , 
							CASE WHEN coalesce(ie_fez_lanche_tarde_w,'X')='S' THEN 'LANCHE_DA_TARDE'  ELSE '' END , 
							CASE WHEN coalesce(ie_refeicao_jantar_w,'X')='S' THEN 'JANTAR'  ELSE '' END , 
							CASE WHEN coalesce(ie_refeicao_ceia_w,'X')='S' THEN 'CEIA'  ELSE '' END , 
							CASE WHEN coalesce(ie_consumiu_feijao_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_consumiu_feijao_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_consumiu_feijao_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_consu_fruta_fresc_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_consu_fruta_fresc_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_consu_fruta_fresc_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cons_verdur_legum_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cons_verdur_legum_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cons_verdur_legum_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cons_hambur_embut_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cons_hambur_embut_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cons_hambur_embut_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cons_bebid_adocad_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cons_bebid_adocad_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cons_bebid_adocad_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cons_macar_instan_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cons_macar_instan_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cons_macar_instan_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							CASE WHEN coalesce(ie_cons_doce_gulosei_w,'X')='S' THEN 'SIM' WHEN coalesce(ie_cons_doce_gulosei_w,'X')='N' THEN 'NAO' WHEN coalesce(ie_cons_doce_gulosei_w,'X')='B' THEN 'NAO_SABE'  ELSE '' END , 
							cd_cns_paciente_w, 
							dt_nascimento_paciente_w, 
							ie_sexo_paciente_w, 
							cd_cns_profissional_w, 
							cd_uuid_original_w, 
							nm_pessoa_fisica_w, 
							nr_data_atendimento_w, 
							nr_data_nasc_paci_w, 
							CASE WHEN coalesce(ie_cri_men_leit_peit_w,'X')='X' THEN ''  ELSE 'A_CRIANCA_ONTEM_TOMOU_LEITE_DO_PEITO' END , 
							CASE WHEN coalesce(ie_crian_cons_mingau_w,'X')='X' THEN ''  ELSE 'MINGAU' END , 
							CASE WHEN coalesce(ie_cri_cons_agua_cha_w,'X')='X' THEN ''  ELSE 'AGUA_CHA' END , 
							CASE WHEN coalesce(ie_cri_con_leite_vac_w,'X')='X' THEN ''  ELSE 'LEITE_VACA' END , 
							CASE WHEN coalesce(ie_cri_cons_form_inf_w,'X')='X' THEN ''  ELSE 'FORMULA_INFANTIL' END , 
							CASE WHEN coalesce(ie_cri_cons_suco_fru_w,'X')='X' THEN ''  ELSE 'SUCO_FRUTA' END , 
							CASE WHEN coalesce(ie_crian_consu_fruta_w,'X')='X' THEN ''  ELSE 'FRUTA' END , 
							CASE WHEN coalesce(ie_cri_con_comid_sal_w,'X')='X' THEN ''  ELSE 'COMIDA_DE_SAL' END , 
							CASE WHEN coalesce(ie_cri_cons_out_alim_w,'X')='X' THEN ''  ELSE 'OUTROS_ALIMENTOS_BEBIDAS' END , 
							CASE WHEN coalesce(ie_crian_leite_peito_w,'X')='X' THEN ''  ELSE 'A_CRIANCA_ONTEM_TOMOU_LEITE_PEITO' END , 
							CASE WHEN coalesce(ie_crian_comeu_fruta_w,'X')='X' THEN ''  ELSE 'ONTEM_A_CRIANCA_COMEU_FRUTA_INTEIRA_PEDACO_AMASSADO' END , 
							CASE WHEN coalesce(ie_vezes_comeu_fruta_w,'X')='X' THEN ''  ELSE 'SE_SIM_QUANTAS_VEZES' END , 
							CASE WHEN coalesce(ie_crianc_comida_sal_w,'X')='X' THEN ''  ELSE 'ONTEM_A_CRIANCA_COMEU_COMIDA_DE_SAL' END , 
							CASE WHEN coalesce(ie_vezes_comida_sal_w,'X')='X' THEN ''  ELSE 'SE_COMEU_COMIDA_DE_SAL_QUANTAS_VEZES' END , 
							CASE WHEN coalesce(ie_form_comid_oferec_w,'X')='X' THEN ''  ELSE 'SE_SIM_ESSA_COMIDA_FOI_OFERECIDA' END , 
							CASE WHEN coalesce(ie_cri_cons_out_leit_w,'X')='X' THEN ''  ELSE 'OUTRO_LEITE_QUE_NAO_LEITE_DO_PEITO' END , 
							CASE WHEN coalesce(ie_cri_con_ming_leit_w,'X')='X' THEN ''  ELSE 'MINGAU_COM_LEITE' END , 
							CASE WHEN coalesce(ie_cria_cons_iogurte_w,'X')='X' THEN ''  ELSE 'IOGURTE' END , 
							CASE WHEN coalesce(ie_cria_cons_legumes_w,'X')='X' THEN ''  ELSE 'LEGUMES' END , 
							CASE WHEN coalesce(ie_cri_con_veg_alara_w,'X')='X' THEN ''  ELSE 'VEGETAL_OU_FRUTAS_COR_ALARANJADA_OU_FOLHAS_ESCURAS' END , 
							CASE WHEN coalesce(ie_cri_con_verd_folh_w,'X')='X' THEN ''  ELSE 'VERDURA_DE_FOLHA' END , 
							CASE WHEN coalesce(ie_crian_consu_carne_w,'X')='X' THEN ''  ELSE 'CARNE' END , 
							CASE WHEN coalesce(ie_crian_cons_figado_w,'X')='X' THEN ''  ELSE 'FIGADO' END , 
							CASE WHEN coalesce(ie_crian_cons_feijao_w,'X')='X' THEN ''  ELSE 'FEIJAO' END , 
							CASE WHEN coalesce(ie_cri_con_arroz_bat_w,'X')='X' THEN ''  ELSE 'ARROZ_BATATA_INHAME_MANDIOCA_FARINHA_MACARRAO' END , 
							CASE WHEN coalesce(ie_cri_con_ham_embut_w,'X')='X' THEN ''  ELSE 'HAMBURGUER_E_OU_EMBUTIDOS' END , 
							CASE WHEN coalesce(ie_cri_cons_beb_adoc_w,'X')='X' THEN ''  ELSE 'BEBIDAS_ADOCADAS' END , 
							CASE WHEN coalesce(ie_cri_con_macar_ins_w,'X')='X' THEN ''  ELSE 'MACARRAO_INSTANTANEO_SALGADINHOS_BISCOITOS' END , 
							CASE WHEN coalesce(ie_cri_con_doce_gulo_w,'X')='X' THEN ''  ELSE 'BISCOITO_RECHEADO_DOCES_OU_GULOSEIMAS' END , 
							CASE WHEN coalesce(ie_rel_refe_tv_celul_w,'X')='X' THEN ''  ELSE 'VOCE_TEM_COSTUME_DE_REALIZAR_AS_REFEICOES_ASSISTINDO_TV_MEXENDO_NO_COMPUTADOR_E_OU_CELULAR' END , 
							CASE WHEN coalesce(ie_quais_refeicoes_w,'X')='X' THEN ''  ELSE 'QUAIS_REFEICOES_VOCE_FAZ_AO_LONGO_DO_DIA' END , 
							CASE WHEN coalesce(ie_consumiu_feijao_w,'X')='X' THEN ''  ELSE 'FEIJAO' END , 
							CASE WHEN coalesce(ie_consu_fruta_fresc_w,'X')='X' THEN ''  ELSE 'FRUTAS_FRESCAS' END , 
							CASE WHEN coalesce(ie_cons_verdur_legum_w,'X')='X' THEN ''  ELSE 'VERDURAS_E_OU_LEGUMES' END , 
							CASE WHEN coalesce(ie_cons_hambur_embut_w,'X')='X' THEN ''  ELSE 'HAMBURGUER_E_OU_EMBUTIDOS' END , 
							CASE WHEN coalesce(ie_cons_bebid_adocad_w,'X')='X' THEN ''  ELSE 'BEBIDAS_ADOCADAS' END , 
							CASE WHEN coalesce(ie_cons_macar_instan_w,'X')='X' THEN ''  ELSE 'MACARRAO_INSTANTANEO_SALGADINHOS_BISCOITOS' END , 
							CASE WHEN coalesce(ie_cons_doce_gulosei_w,'X')='X' THEN ''  ELSE 'BISCOITO_RECHEADO_DOCES_OU_GULOSEIMAS' END  
							);
		end;
	end loop;
	end;
end loop;
 
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE sus_gerar_w_esus_con_alim ( nr_seq_lote_p esus_lote_envio.nr_sequencia%type, ie_tipo_lote_esus_p esus_lote_envio.ie_tipo_lote_esus%type, cd_cnes_estab_p estabelecimento.cd_cns%type, nm_usuario_p usuario.nm_usuario%type) FROM PUBLIC;

