-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE review_document (NR_SEQUENCIA_P bigint) AS $body$
DECLARE


variable_lsit       	QUA_DOCUMENTO%ROWTYPE;
nm_user_w		varchar(100);


BEGIN
	nm_user_w := wheb_usuario_pck.get_nm_usuario;

	update	QUA_DOCUMENTO
	set	IE_SITUACAO='I',
		DT_INATIVACAO = clock_timestamp(),
		NM_USUARIO_INATIVACAO = nm_user_w
	where	NR_SEQUENCIA = NR_SEQUENCIA_P;
	
	SELECT *
	into STRICT
		variable_lsit
	 FROM 
		QUA_DOCUMENTO where NR_SEQUENCIA = NR_SEQUENCIA_P  LIMIT 1;

	Insert into QUA_DOCUMENTO(NR_SEQUENCIA,
		CD_ESTABELECIMENTO,
		NR_SEQ_TIPO,
		DT_ATUALIZACAO,
		NM_USUARIO,
		CD_DOCUMENTO,
		NM_DOCUMENTO,
		CD_SETOR_ATENDIMENTO,
		DT_APROVACAO,
		DT_EMISSAO,
		NM_USUARIO_APROV,
		CD_PESSOA_APROV,
		DS_ARQUIVO,
		DS_PALAVRA_CHAVE,
		NR_SEQ_LOC,
		CD_PESSOA_ELABORACAO,
		DT_ELABORACAO,
		IE_SITUACAO,
		IE_STATUS,
		DT_ATUALIZACAO_NREC,
		NM_USUARIO_NREC,
		IE_FORMA_ARMAZENAMENTO,
		DS_FORMA_RECUPERACAO,
		IE_FORMA_DESCARTE,
		IE_TEMPO_RETENCAO,
		QT_TEMPO_RETENCAO,
		CD_PESSOA_VALIDACAO,
		DT_VALIDACAO,
		DS_FORMA_PROTECAO,
		QT_DIAS_REVISAO,
		IE_PERMITE_EMAIL,
		NR_SEQ_TIPO_REF_DOC,
		DT_REVALIDACAO,
		NM_USUARIO_REVALIDACAO,
		CD_DOCUMENTO_EXT,
		IE_EXTERNO,
		DS_IMPACTO,
		NR_SEQ_MOTIVO_INATIVACAO,
		QT_DIAS_VALIDACAO,
		QT_DIAS_APROVACAO,
		IE_PERMITE_SALVAR,
		IE_PERMITE_IMPRIMIR,
		IE_PERMANENTE,
		NM_USUARIO_SOLIC_TREIN,
		DT_SOLIC_TREINAMENTO,
		DT_REPROVACAO,
		IE_DOC_RESP,
		IE_PERGUNTA,
		IE_ARMAZENA_ARQ_MORTO,
		IE_FORMA_DESCARTE_ARQ_MORTO,
		QT_TEMPO_RETENCAO_ARQ_MORTO,
		IE_TEMPO_RETENCAO_ARQ_MORTO,
		NR_SEQ_SUPERIOR,
		NR_SEQ_IDIOMA,
		CD_EXP_DOCUMENTO,
		NR_SEQ_ORDEM_TREIN,
		NR_SEQ_CLASSIF,
		NR_SEQ_DOC_REF)
	VALUES (nextval('qua_documento_seq')   ,              
		variable_lsit.CD_ESTABELECIMENTO,
		variable_lsit.NR_SEQ_TIPO,
		clock_timestamp(),
		nm_user_w,
		variable_lsit.CD_DOCUMENTO,
		variable_lsit.NM_DOCUMENTO,
		variable_lsit.CD_SETOR_ATENDIMENTO,
		variable_lsit.DT_APROVACAO,
		variable_lsit.DT_EMISSAO,
		variable_lsit.NM_USUARIO_APROV,
		variable_lsit.CD_PESSOA_APROV,
		variable_lsit.DS_ARQUIVO,
		variable_lsit.DS_PALAVRA_CHAVE,
		variable_lsit.NR_SEQ_LOC,
		variable_lsit.CD_PESSOA_ELABORACAO,
		variable_lsit.DT_ELABORACAO,
		'A',
		variable_lsit.IE_STATUS,
		clock_timestamp(),
		nm_user_w,
		variable_lsit.IE_FORMA_ARMAZENAMENTO,
		variable_lsit.DS_FORMA_RECUPERACAO,
		variable_lsit.IE_FORMA_DESCARTE,
		variable_lsit.IE_TEMPO_RETENCAO,
		variable_lsit.QT_TEMPO_RETENCAO,
		variable_lsit.CD_PESSOA_VALIDACAO,
		variable_lsit.DT_VALIDACAO,
		variable_lsit.DS_FORMA_PROTECAO,
		variable_lsit.QT_DIAS_REVISAO,
		variable_lsit.IE_PERMITE_EMAIL,
		variable_lsit.NR_SEQ_TIPO_REF_DOC,
		variable_lsit.DT_REVALIDACAO,
		variable_lsit.NM_USUARIO_REVALIDACAO,
		variable_lsit.CD_DOCUMENTO_EXT,
		variable_lsit.IE_EXTERNO,
		variable_lsit.DS_IMPACTO,
		variable_lsit.NR_SEQ_MOTIVO_INATIVACAO,
		variable_lsit.QT_DIAS_VALIDACAO,
		variable_lsit.QT_DIAS_APROVACAO,
		variable_lsit.IE_PERMITE_SALVAR,
		variable_lsit.IE_PERMITE_IMPRIMIR,
		variable_lsit.IE_PERMANENTE,
		variable_lsit.NM_USUARIO_SOLIC_TREIN,
		variable_lsit.DT_SOLIC_TREINAMENTO,
		variable_lsit.DT_REPROVACAO,
		variable_lsit.IE_DOC_RESP,
		variable_lsit.IE_PERGUNTA,
		variable_lsit.IE_ARMAZENA_ARQ_MORTO,
		variable_lsit.IE_FORMA_DESCARTE_ARQ_MORTO,
		variable_lsit.QT_TEMPO_RETENCAO_ARQ_MORTO,
		variable_lsit.IE_TEMPO_RETENCAO_ARQ_MORTO,
		variable_lsit.NR_SEQ_SUPERIOR,
		variable_lsit.NR_SEQ_IDIOMA,
		variable_lsit.CD_EXP_DOCUMENTO,
		variable_lsit.NR_SEQ_ORDEM_TREIN,
		variable_lsit.NR_SEQ_CLASSIF,
		NR_SEQUENCIA_P);
		
	commit;
end	;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE review_document (NR_SEQUENCIA_P bigint) FROM PUBLIC;

