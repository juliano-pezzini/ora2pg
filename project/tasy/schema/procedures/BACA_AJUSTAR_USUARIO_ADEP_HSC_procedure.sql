-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE baca_ajustar_usuario_adep_hsc () AS $body$
DECLARE


nm_usuario_w	varchar(255);
nr_seq_w	bigint;
cont_w		bigint;

c01 CURSOR FOR
SELECT	nm_usuario
from	usuario
where	ie_situacao	<> 'I';


BEGIN

open C01;
loop
fetch C01 into
	nm_usuario_w;
EXIT WHEN NOT FOUND; /* apply on C01 */

	select	count(*)
	into STRICT	cont_w
	from	USUARIO_ADEP_GESTAO
	where	nm_usuario	= nm_usuario_w;

	if (cont_w	= 0) then

		select	nextval('usuario_adep_gestao_seq')
		into STRICT	nr_seq_w
		;

		insert into USUARIO_ADEP_GESTAO(nr_sequencia,
			dt_atualizacao_nrec,
			nm_usuario_nrec,
			dt_atualizacao,
			nm_usuario,
			ie_legenda,
			ie_hor_adm,
			ie_hor_susp,
			ie_hor_grid)
		values (nr_seq_w,
			clock_timestamp(),
			'OS153532',
			clock_timestamp(),
			nm_usuario_w,
			'S',
			'S',
			'S',
			'I');

		commit;
	end if;

end loop;
close C01;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE baca_ajustar_usuario_adep_hsc () FROM PUBLIC;

