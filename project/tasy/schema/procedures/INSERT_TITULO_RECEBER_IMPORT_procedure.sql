-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE insert_titulo_receber_import ( NM_USUARIO_P text, DS_STRING_P text, IE_EXCLUI_P text) AS $body$
BEGIN

    if coalesce(IE_EXCLUI_P, 'N') = 'S' then
        delete 
        from  w_retorno_banco 
        where nm_usuario  = NM_USUARIO_P 
            and (ie_importacao_tit_rec IS NOT NULL AND ie_importacao_tit_rec::text <> '');
    else
        insert
        into w_retorno_banco(
            nr_sequencia,
            dt_atualizacao,
            nm_usuario,
            ds_string,
            ie_importacao_tit_rec
        ) values (
            nextval('w_retorno_banco_seq'),
            clock_timestamp(),
            NM_USUARIO_P,
            DS_STRING_P,
            'S'
        );
    end if;

    commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE insert_titulo_receber_import ( NM_USUARIO_P text, DS_STRING_P text, IE_EXCLUI_P text) FROM PUBLIC;

