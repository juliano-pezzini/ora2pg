-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE consistir_se_primeira_escolha ( nr_sequencia_lista_p text, nm_usuario_p text, ds_erro_p INOUT text ) AS $body$
DECLARE


ie_primeira_escolha_w	varchar(5);
ds_erro_w		varchar(255);

C01 CURSOR FOR
	SELECT	verifica_se_primeira_escolha(a.nr_seq_resultado, a.nr_seq_result_item, a.cd_microorganismo)
	from	exame_lab_result_antib a
	where	substr(obter_se_contido(a.nr_sequencia, nr_sequencia_lista_p),1,1)	= 'S';


BEGIN

ds_erro_p	:= null;
ds_erro_w	:= substr(obter_texto_tasy(68987,wheb_usuario_pck.get_nr_seq_idioma),1,255);

open C01;
loop
fetch C01 into
	ie_primeira_escolha_w;
EXIT WHEN NOT FOUND; /* apply on C01 */
	begin

	if (ie_primeira_escolha_w = 'N') then
		ds_erro_p	:= ds_erro_w;
	end if;

	end;
end loop;
close C01;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE consistir_se_primeira_escolha ( nr_sequencia_lista_p text, nm_usuario_p text, ds_erro_p INOUT text ) FROM PUBLIC;

