-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pls_realocar_valores_mat () AS $body$
DECLARE


C01 CURSOR FOR
SELECT	a.vl_material vl_material,
	a.cd_moeda cd_moeda,
	a.dt_inicio_vigencia dt_inicio_vigencia,
	a.nr_sequencia nr_seq_preco_item
from	pls_material_preco_item a
where	(a.dt_inicio_vigencia IS NOT NULL AND a.dt_inicio_vigencia::text <> '')
and	(a.vl_material IS NOT NULL AND a.vl_material::text <> '')
and	not exists (	select	1
				from	pls_material_valor_item x
				where	x.nr_seq_preco_item = a.nr_sequencia);

ds_erro_w	varchar(2000);

BEGIN

for	r_C01_w in C01 loop
	begin
		insert into	pls_material_valor_item(nr_sequencia, dt_inicio_vigencia,
							vl_material, cd_moeda, nr_seq_preco_item,
							nm_usuario, dt_atualizacao)
		values (nextval('pls_material_valor_item_seq'),r_C01_w.dt_inicio_vigencia,
							r_C01_w.vl_material,r_C01_w.cd_moeda,r_C01_w.nr_seq_preco_item,
							'Tasy - Vers√£o',clock_timestamp());
	exception
	when others then
	begin
		null;
	end;
	end;
end loop;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_realocar_valores_mat () FROM PUBLIC;

