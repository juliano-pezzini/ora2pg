-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE alterar_analista_rn ( nr_sequencia_p LATAM_REQUISITO_HISTORICO.NR_SEQUENCIA%type, ie_liberar_desenv_p LATAM_REQUISITO_HISTORICO.IE_LIBERAR_DESENV%type, ds_historico_p LATAM_REQUISITO_HISTORICO.DS_HISTORICO%type, ie_situacao_p LATAM_REQUISITO_HISTORICO.IE_SITUACAO%type default null, cd_responsavel_p LATAM_REQUISITO.CD_RESPONSAVEL%type  DEFAULT NULL) AS $body$
DECLARE


nm_usuario_s            CONSTANT LATAM_REQUISITO_HISTORICO.NM_USUARIO%type    := WHEB_USUARIO_PCK.GET_NM_USUARIO;
dt_atual_s              CONSTANT LATAM_REQUISITO_HISTORICO.DT_LIBERACAO%type  := clock_timestamp();
nr_alterar_analista_s   CONSTANT LATAM_REQUISITO_HISTORICO.IE_TIPO_HIST%type  := 4;


BEGIN

INSERT into LATAM_REQUISITO_HISTORICO(
	NR_SEQUENCIA,
	DT_ATUALIZACAO,
	NM_USUARIO,
	DT_ATUALIZACAO_NREC,
	NM_USUARIO_NREC,
	DT_LIBERACAO,
	IE_LIBERAR_DESENV,
	DS_HISTORICO,
	NR_SEQ_REQUISITO,
	IE_SITUACAO,
	IE_TIPO_HIST
) VALUES (
	nextval('latam_requisito_historico_seq'),
	dt_atual_s,
	nm_usuario_s,
	dt_atual_s,
	nm_usuario_s,
	dt_atual_s,
	ie_liberar_desenv_p,
	ds_historico_p,
	nr_sequencia_p,
	ie_situacao_p,
	nr_alterar_analista_s
);

UPDATE  LATAM_REQUISITO
SET     CD_RESPONSAVEL = cd_responsavel_p
WHERE   NR_SEQUENCIA   = nr_sequencia_p;

COMMIT;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE alterar_analista_rn ( nr_sequencia_p LATAM_REQUISITO_HISTORICO.NR_SEQUENCIA%type, ie_liberar_desenv_p LATAM_REQUISITO_HISTORICO.IE_LIBERAR_DESENV%type, ds_historico_p LATAM_REQUISITO_HISTORICO.DS_HISTORICO%type, ie_situacao_p LATAM_REQUISITO_HISTORICO.IE_SITUACAO%type default null, cd_responsavel_p LATAM_REQUISITO.CD_RESPONSAVEL%type  DEFAULT NULL) FROM PUBLIC;

