-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE insert_records_chart_report ( nr_cirurgia_p bigint, nr_seq_pepo_p bigint, nm_usuario_p text, ie_sv_anestesista_p text) AS $body$
DECLARE



contador_w				bigint 	:= 0;
nr_sequencia_ww 		bigint	:= 1;
dt_registro_w			timestamp;
cd_estabelecimento_w	smallint;
ie_desc_comercial_w	varchar(15);
cd_perfil_w				integer;
vl_coluna_17_w			varchar(255) := NULL;
point_17_w				varchar(255) := NULL;
ie_possui_w 			varchar(1)	  := 'N';
ds_code_w				w_chart_pepo_report.code%type;
dt_registro_old_w		timestamp;
ds_code_old_w			w_chart_pepo_report.code%type;
ds_sinais_vitais_w		varchar(255) := substr(wheb_mensagem_pck.get_texto(1028076),1,255);
nm_usuario_anestesista_w	usuario.nm_usuario%type;

vital_signs CURSOR FOR
	SELECT 	DISTINCT name || CASE WHEN coalesce(description::text, '') = '' THEN NULL  ELSE ' ('||description||')' END  descricao,
				c.ie_sinal_vital,
				seq_apresentacao ordem
	FROM		surgery_groups_chart_v b,
				TABLE(search_chart_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p,b.code)) c,
				TABLE(search_chart_values_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p, c.ie_sinal_vital, NULL)) d
	WHERE		b.code 							= c.code_group
	AND		d.code_group 					= c.code_group
	AND (d.nr_seq_superior			= c.nr_seq_superior OR coalesce(c.nr_seq_superior::text, '') = '')
	AND (c.nm_usuario = nm_usuario_p OR coalesce(c.nm_usuario::text, '') = '')
	and		((ie_sv_anestesista_p = 'N') or (ie_sv_anestesista_p = 'S' AND d.nm_usuario = nm_usuario_anestesista_w))
	ORDER BY seq_apresentacao,descricao;

date_vital_signs CURSOR FOR
	SELECT 	DISTINCT d.dt_registro
	FROM	surgery_groups_chart_v b,
			TABLE(search_chart_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p,b.code)) c,
			TABLE(search_chart_values_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p, c.ie_sinal_vital, NULL)) d
	WHERE	b.code 				= c.code_group
	AND		d.code_group 		= c.code_group
	AND (d.nr_seq_superior	= c.nr_seq_superior OR coalesce(c.nr_seq_superior::text, '') = '')
	AND (c.nm_usuario = nm_usuario_p OR coalesce(c.nm_usuario::text, '') = '')
	and		((ie_sv_anestesista_p = 'N') or (ie_sv_anestesista_p = 'S' AND d.nm_usuario = nm_usuario_anestesista_w))
	
UNION

	SELECT	distinct e.dt_registro
	FROM	TABLE(search_values_chart(nr_cirurgia_p,nr_seq_pepo_p, NULL, 'EVENTO_CIRURGIA_PACIENTE')) e
	WHERE 	e.code_group 	= 'NAV'
	AND		e.nm_tabela 	= 'EVENTO_CIRURGIA_PACIENTE'
	AND		e.nm_atributo 	IN ('DS_PACIENTE','DS_ANESTESIA','DS_PROCEDIMENTO')
	AND		coalesce(e.nr_seq_superior, -1) = -1
	ORDER BY dt_registro;

values_vital_signs CURSOR FOR
	SELECT 	c.ie_sinal_vital,
				d.qt_valor
	FROM		surgery_groups_chart_v b,
				TABLE(search_chart_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p,b.code)) c,
				TABLE(search_chart_values_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p, c.ie_sinal_vital, NULL)) d
	WHERE		b.code 							= c.code_group
	AND		d.code_group 					= c.code_group
	AND (d.nr_seq_superior			= c.nr_seq_superior OR coalesce(c.nr_seq_superior::text, '') = '')
	AND (c.nm_usuario = nm_usuario_p OR coalesce(c.nm_usuario::text, '') = '')
	and		((ie_sv_anestesista_p = 'N') or (ie_sv_anestesista_p = 'S' AND d.nm_usuario = nm_usuario_anestesista_w))
	AND		d.dt_registro					= dt_registro_w;
	
	procedure insere_registro_descricao(nr_sequencia_p bigint,
										ds_descricao_p	text,
										ds_code_p		text) is
	;
BEGIN
		INSERT		INTO w_chart_pepo_report( 	nr_sequencia,
												nm_usuario,
												ie_tipo_coluna,
												ds_descricao,
												code)
		VALUES (	nr_sequencia_p,
												nm_usuario_p,
												'V',
												ds_descricao_p,
												ds_code_p);
		COMMIT;
	end;
	
	/*function obter_ds_valor_coluna_eventos () return varchar2 is
		select decode (count(1), 0, 'I','F')
		into	ie_ultimo_w
		from	w_chart_pepo_report
		where	code = ds_code_p
		and		ie_tipo_coluna = 'V'
		and		(vl_coluna_1 is not null or
				vl_coluna_2 is not null or
				vl_coluna_3 is not null or
				vl_coluna_4 is not null or
				vl_coluna_5 is not null or
				vl_coluna_6 is not null or
				vl_coluna_7 is not null or
				vl_coluna_8 is not null or
				vl_coluna_9 is not null or
				vl_coluna_10 is not null or
				vl_coluna_11 is not null or
				vl_coluna_12 is not null or
				vl_coluna_13 is not null or
				vl_coluna_14 is not null or
				vl_coluna_15 is not null or
				vl_coluna_16 is not null or
				vl_coluna_17 is not null or
				vl_coluna_18 is not null or
				vl_coluna_19 is not null or
				vl_coluna_20 is not null);
	end obter_ds_valor_coluna_eventos;*/
	
	function obter_ds_valor_coluna_eventos(cd_coluna_p 	number,
											ds_code_p		varchar2, 
											nr_sequencia_p	number) return;
	qt_coluna_fim_w		Number(10);
	qt_coluna_inicio_w	Number(10);
	ds_comando_w		varchar2(2000);
	ds_inicio_w			varchar2(200) := substr(wheb_mensagem_pck.get_texto(1028065),1,255); /*'Inicio'*/
	ds_fim_w			varchar2(200) := substr(wheb_mensagem_pck.get_texto(1028066),1,255); /*'Fim'*/

	/* 
	I = Inicio evento
	F = Fim evento
	*/
	begin
		if (coalesce(cd_coluna_p, 0) = 0) and (coalesce(nr_sequencia_p, 0) = 1) then
			ds_retorno_w := 'I';
		elsif (coalesce(cd_coluna_p, 0) > 0)  then
			ds_comando_w := 'select 	count(1) '
							|| ' from 	w_chart_pepo_report '
							|| ' where 	code = '''|| ds_code_p || ''' '
							|| ' and 	upper(vl_coluna_' || cd_coluna_p || ') = upper(''' || ds_inicio_w || ''')'
							|| ' and 	ie_tipo_coluna = ''V'' ';
			qt_coluna_inicio_w := obter_valor_dinamico(ds_comando_w, qt_coluna_inicio_w);

			if (coalesce(qt_coluna_inicio_w, 0) > 0) then
				ds_comando_w := 'select 	count(1) '
							|| ' from 	w_chart_pepo_report '
							|| ' where 	code = '''|| ds_code_p || ''' '
							|| ' and 	upper(vl_coluna_' || cd_coluna_p || ') = upper(''' || ds_fim_w || ''')'
							|| ' and 	ie_tipo_coluna = ''V'' ';
				qt_coluna_fim_w := obter_valor_dinamico(ds_comando_w, qt_coluna_fim_w);
								
				if ((coalesce(qt_coluna_inicio_w, 0) - coalesce(qt_coluna_fim_w, 0)) = 0) then
					ds_retorno_w := 'I';
				else
					ds_retorno_w := 'F';
				end if;
			else
				ds_retorno_w := obter_ds_valor_coluna_eventos(cd_coluna_p-1, ds_code_p, nr_sequencia_p);
			end if;
		else
			if (coalesce(nr_sequencia_p, 0) > 1) then
				ds_retorno_w := obter_ds_valor_coluna_eventos(20, ds_code_p, nr_sequencia_p-1);
			else
				ds_retorno_w := 'I';
			end if;
		end if;
		return;
	end;
	
	procedure insere_cabecalho_evento(nr_sequencia_p	number,
									ds_sufixo_p			varchar2) is 
	ds_descricao_w		w_chart_pepo_report.ds_descricao%type;
	ds_Paciente_w		varchar2(200) := substr(wheb_mensagem_pck.get_texto(1028069),1,200); /*'Paciente'*/
	ds_Anestesia_w		varchar2(200) := substr(wheb_mensagem_pck.get_texto(1028070),1,200); /*'Anestesia'*/
	ds_Procedimento_w	varchar2(200) := substr(wheb_mensagem_pck.get_texto(1028071),1,200); /*'Procedimento'*/
	begin
		SELECT	substr(coalesce(max(description), ds_Paciente_w),1,255)
		into STRICT	ds_descricao_w
		FROM	TABLE(search_chart(nr_cirurgia_p,nr_seq_pepo_p,'NAV'))
		WHERE (nm_usuario = nm_usuario_p OR coalesce(nm_usuario::text, '') = '')
		and		nm_tabela =	'EVENTO_CIRURGIA_PACIENTE'
		and		nm_atributo = 'DS_PACIENTE';
		
		CALL insere_registro_descricao(nr_sequencia_p, ds_descricao_w, 'PA' || ds_sufixo_p);
		
		SELECT	substr(coalesce(max(description), ds_Anestesia_w),1,255)
		into STRICT	ds_descricao_w
		FROM	TABLE(search_chart(nr_cirurgia_p,nr_seq_pepo_p,'NAV'))
		WHERE (nm_usuario = nm_usuario_p OR coalesce(nm_usuario::text, '') = '')
		and		nm_tabela =	'EVENTO_CIRURGIA_PACIENTE'
		and		nm_atributo = 'DS_ANESTESIA';
		
		CALL insere_registro_descricao(nr_sequencia_p, ds_descricao_w, 'AN' || ds_sufixo_p);
		
		SELECT	substr(coalesce(max(description), ds_Procedimento_w),1,255)
		into STRICT	ds_descricao_w
		FROM	TABLE(search_chart(nr_cirurgia_p,nr_seq_pepo_p,'NAV'))
		WHERE (nm_usuario = nm_usuario_p OR coalesce(nm_usuario::text, '') = '')
		and		nm_tabela =	'EVENTO_CIRURGIA_PACIENTE'
		and		nm_atributo = 'DS_PROCEDIMENTO';
		
		CALL insere_registro_descricao(nr_sequencia_p, ds_descricao_w, 'PR' || ds_sufixo_p);
		
	end;
	
	procedure	insere_horario_evento(dt_registro_p				date,
										cd_estabelecimento_p	number, 
										nr_sequencia_p			number, 
										contador_p				number,
										ds_code_p				varchar2,
										ie_label_p				varchar2) is
	ds_comando_w		varchar2(2000);
	ds_label_w			varchar2(200);
	ds_inicio_w			varchar2(200) := substr(wheb_mensagem_pck.get_texto(1028065),1,200); /*'Inicio'*/
	ds_fim_w			varchar2(200) := substr(wheb_mensagem_pck.get_texto(1028066),1,200); /*'Fim'*/
	ie_proximo_w		varchar2(200);
	ie_insere_w			varchar2(2);
	qt_coluna_valor_w	number(10);
	
	begin
	begin
		ie_proximo_w := ie_label_p; --nvl(ie_label_p, obter_ds_valor_coluna_eventos(contador_p, ds_code_p, nr_sequencia_p));
		if (coalesce(ie_proximo_w,'XPTO') = 'I') then
			ds_label_w := ds_inicio_w;
			--ie_insere_w := obter_insere_coluna_eventos(contador_p-1, ds_code_p, nr_sequencia_p, 'I');
		else
			ds_label_w := ds_fim_w;
			--ie_insere_w := obter_insere_coluna_eventos(contador_p-1, ds_code_p, nr_sequencia_p, 'F');
		end if;
		
		ds_comando_w :=	'UPDATE w_chart_pepo_report'
						||	' SET	vl_coluna_' || contador_p || '= '''|| ds_label_w || ''' ' --''X'' '--pkg_date_formaters.to_varchar(dt_registro_p,'shortTime',cd_estabelecimento_p,nm_usuario_p) || ''' '
						||	' WHERE	code	= '''|| ds_code_p || ''' '
						||	' and	nr_sequencia = ' ||nr_sequencia_p
						||	' AND	ie_tipo_coluna = ''V'' ';
		
		exec_sql_dinamico('relatorio_grafico_cirurgia-'|| nm_usuario_p, ds_comando_w);
		commit;	
	/*exception when others then
		null;*/
	end;		
	end insere_horario_evento;
		
	function obter_se_dose_ataque_continuo(nr_seq_anest_ocor_p	number,
											qt_dose_ataque_p	number, 
											dt_registro_p		date) return varchar2 is
	ie_dose_ataque_w varchar(2) := 'N';
	begin
	
		SELECT	decode(count(1),0,'N','S')
		INTO	ie_dose_ataque_w
		FROM	cirurgia_agente_anest_ocor a,
				cirurgia_agente_anestesico b
		WHERE	a.nr_seq_cirur_agente = b.nr_sequencia
		and		a.qt_dose_ataque = qt_dose_ataque_p
		and		a.dt_inicio_adm	= dt_registro_p
		AND		b.nr_sequencia 	= nr_seq_anest_ocor_p;
		
		return ie_dose_ataque_w;
	end obter_se_dose_ataque_continuo;
		
		
	procedure	atualiza_horario_evento(dt_registro_p			date, 
										cd_estabelecimento_p	number, 
										nr_sequencia_p			number, 
										nr_contador_p			number,
										ds_sufixo_p				varchar2) is

	CURSOR	C01 IS
	SELECT	ds_code, 
		dt_registro, 
		ie_label
	from (SELECT ds_code, 
				dt_registro, 
				DECODE(MOD(ROWNUM,2), 0, 'F', 'I') ie_label
		FROM (SELECT distinct 'PA' ds_code, /*SELECT	DECODE (a.nm_atributo, 'DS_PACIENTE', 'PA', 'DS_ANESTESIA', 'AN', 'DS_PROCEDIMENTO', 'PR', 'XPTO') ds_code,*/
					a.dt_registro
			FROM	TABLE(search_values_chart(nr_cirurgia_p, nr_seq_pepo_p, NULL, 'EVENTO_CIRURGIA_PACIENTE')) a
			WHERE	a.code_group 	= 'NAV'
			AND		a.nm_tabela 	= 'EVENTO_CIRURGIA_PACIENTE'
			AND		a.nm_atributo 	='DS_PACIENTE'
			AND		NVL(a.nr_seq_superior, -1) = -1
			ORDER BY dt_registro)
		UNION
		SELECT	ds_code, 
				dt_registro,
				DECODE(MOD(ROWNUM,2), 0, 'F', 'I') ie_label
		FROM (SELECT	distinct 'AN' ds_code,
					a.dt_registro
			FROM	TABLE(search_values_chart(nr_cirurgia_p, nr_seq_pepo_p, NULL, 'EVENTO_CIRURGIA_PACIENTE')) a
			WHERE	a.code_group 	= 'NAV'
			AND		a.nm_tabela 	= 'EVENTO_CIRURGIA_PACIENTE'
			AND		a.nm_atributo 	= 'DS_ANESTESIA'
			AND		NVL(a.nr_seq_superior, -1) = -1
			ORDER BY dt_registro)
		UNION
		SELECT	ds_code, 
				dt_registro, 
				DECODE(MOD(ROWNUM,2), 0, 'F', 'I') ie_label
		FROM (SELECT	distinct 'PR' ds_code,
					a.dt_registro
			FROM	TABLE(search_values_chart(nr_cirurgia_p, nr_seq_pepo_p, NULL, 'EVENTO_CIRURGIA_PACIENTE')) a
			WHERE	a.code_group 	= 'NAV'
			AND		a.nm_tabela 	= 'EVENTO_CIRURGIA_PACIENTE'
			AND		a.nm_atributo 	= 'DS_PROCEDIMENTO'
			AND		NVL(a.nr_seq_superior, -1) = -1
			ORDER BY dt_registro)
	ORDER BY dt_registro);
	
	begin
	--begin 
		FOR r_horarios_evento IN C01 LOOP
			if ((to_char(dt_registro_p, 'dd/mm/rrrr hh24:mi') = to_char(r_horarios_evento.dt_registro, 'dd/mm/rrrr hh24:mi')) and
				((to_char(nvl(dt_registro_old_w, dt_registro_p+1), 'dd/mm/rrrr hh24:mi') <> to_char(dt_registro_p, 'dd/mm/rrrr hh24:mi')) or
				nvl(ds_code_old_w, 'XPTO') <> r_horarios_evento.ds_code || ds_sufixo_p) and
				nvl(r_horarios_evento.ds_code, 'XPTO') <> 'XPTO') then
				begin
				insere_horario_evento(dt_registro_p, cd_estabelecimento_p, nr_sequencia_p, nr_contador_p, r_horarios_evento.ds_code || ds_sufixo_p, r_horarios_evento.ie_label);
				dt_registro_old_w := dt_registro_p;
				ds_code_old_w := r_horarios_evento.ds_code || ds_sufixo_p;
				end;
			elsif (to_char(dt_registro_p, 'dd/mm/rrrr hh24:mi') < to_char(r_horarios_evento.dt_registro, 'dd/mm/rrrr hh24:mi')) then
				exit;
			end if;
		end loop;
	/*exception when others then
		null;
	end;*/
	end atualiza_horario_evento;
	
	Procedure gera_agentes(ds_code_p		varchar2, 
							ds_descricao_p	varchar2) is
	ie_dose_ataque_cont_w varchar2(2);
	
	CURSOR	anesthesic_agents	IS
		SELECT 	DISTINCT SUBSTR(DECODE(ie_medic_nao_inform,'N', DECODE(ie_desc_comercial_w,'N',name, comercial_name),NVL(comercial_name,name)),1,60) || DECODE(description,NULL,NULL,' ('||description||')') descricao,
					seq_apresentacao ordem,
					c.nr_seq_superior nr_seq_cirur_agente
		FROM		surgery_groups_chart_v b,
					TABLE(search_chart_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p,b.code)) c,
					TABLE(search_chart_values_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p, NULL, c.nm_tabela)) d
		WHERE		b.code 						= c.code_group
		AND		d.code_group 				= c.code_group
		AND		d.nr_seq_superior			= c.nr_seq_superior
		AND		c.code_group = ds_code_p
		AND		(c.nm_usuario = nm_usuario_p OR c.nm_usuario IS NULL)
		ORDER BY ordem,descricao;

	CURSOR	date_anesthesic_agents IS
		SELECT 	DISTINCT d.dt_registro,
					ie_bolus
		FROM		surgery_groups_chart_v b,
					TABLE(search_chart_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p,b.code)) c,
					TABLE(search_chart_values_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p, NULL, c.nm_tabela)) d
		WHERE		b.code 						= c.code_group
		AND		d.code_group 				= c.code_group
		AND		d.nr_seq_superior			= c.nr_seq_superior
		AND		c.code_group = ds_code_p
		UNION
		SELECT	distinct e.dt_registro, NULL ie_bolus
		FROM	TABLE(search_values_chart(nr_cirurgia_p,nr_seq_pepo_p, NULL, 'EVENTO_CIRURGIA_PACIENTE')) e
		WHERE 	e.code_group 	= 'NAV'
		AND		e.nm_tabela 	= 'EVENTO_CIRURGIA_PACIENTE'
		AND		e.nm_atributo 	IN ('DS_PACIENTE','DS_ANESTESIA','DS_PROCEDIMENTO')
		AND		NVL(e.nr_seq_superior, -1) = -1
		Union 
		SELECT 	DISTINCT d.dt_registro, NULL ie_bolus /*Solicitacao da Dr Dafne*/
		FROM		surgery_groups_chart_v b,
					TABLE(search_chart_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p,b.code)) c,
					TABLE(search_chart_values_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p, c.ie_sinal_vital, NULL)) d
		WHERE		b.code 							= c.code_group
		AND		d.code_group 					= c.code_group
		AND		(d.nr_seq_superior			= c.nr_seq_superior OR c.nr_seq_superior IS NULL)
		AND		(c.nm_usuario = nm_usuario_p OR c.nm_usuario IS NULL)
		ORDER BY dt_registro;

	CURSOR	values_anesthesic_agents IS
		SELECT 	d.qt_valor,
					d.nr_seq_superior nr_seq_cirur_agente,
					d.point
		FROM		surgery_groups_chart_v b,
					TABLE(search_chart_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p,b.code)) c,
					TABLE(search_chart_values_ehro_pck.get_data(nr_cirurgia_p,nr_seq_pepo_p, NULL, c.nm_tabela)) d
		WHERE		b.code 							= c.code_group
		AND		d.code_group 					= c.code_group
		AND		d.nr_seq_superior			= c.nr_seq_superior
		AND		(c.nm_usuario = nm_usuario_p OR c.nm_usuario IS NULL)
		AND		d.dt_registro					= dt_registro_w;

	CURSOR	teste IS /*Agentes anestesicos continuos*/
		SELECT *
		FROM   w_chart_pepo_report
		WHERE  ie_tipo_coluna = 'V'
		AND    code = ds_code_p
		AND	 nm_usuario	= nm_usuario_p
		ORDER BY NR_SEQUENCIA,NR_SEQ_CIRUR_AGENTE;
	begin
	ie_possui_w := 'N';
	FOR r_c05 IN anesthesic_agents LOOP
		BEGIN
		ie_possui_w := 'S';
		INSERT		INTO w_chart_pepo_report(	nr_sequencia,
															nm_usuario,
															ie_tipo_coluna,
															ds_descricao,
															nr_seq_cirur_agente,
															code)
		VALUES										(	nr_sequencia_ww,
															nm_usuario_p,
															'V',
															r_c05.descricao,
															r_c05.nr_seq_cirur_agente,
															ds_code_p);
		END;
	END LOOP;

	IF	(ie_possui_w = 'S') THEN
		INSERT		INTO w_chart_pepo_report( 	nr_sequencia,
															nm_usuario,
															ie_tipo_coluna,
															ds_descricao,
															code)
		VALUES										(	nr_sequencia_ww,
															nm_usuario_p,
															'L',
															ds_descricao_p,
															ds_code_p);
		COMMIT;
		
		insere_cabecalho_evento(nr_sequencia_ww, ds_code_p);
		
	END IF;


	FOR r_c06 IN date_anesthesic_agents LOOP
		BEGIN
		dt_registro_w	:= r_c06.dt_registro;
		contador_w 		:= contador_w+1;
		IF	(contador_w = 18) THEN
			contador_w 		:= 1;
			nr_sequencia_ww:= nr_sequencia_ww + 1;
			INSERT		INTO w_chart_pepo_report( 	nr_sequencia,
																nm_usuario,
																ie_tipo_coluna,
																ds_descricao,
																code)
			VALUES										(	nr_sequencia_ww,
																nm_usuario_p,
																'L',
																ds_descricao_p,
																ds_code_p);

			insere_cabecalho_evento(nr_sequencia_ww, ds_code_p);
		
			FOR r_c05 IN anesthesic_agents LOOP
				BEGIN
				INSERT		INTO w_chart_pepo_report( 	nr_sequencia,
																	nm_usuario,
																	ie_tipo_coluna,
																	ds_descricao,
																	nr_seq_cirur_agente,
																	code)
				VALUES										(	nr_sequencia_ww,
																	nm_usuario_p,
																	'V',
																	r_c05.descricao,
																	r_c05.nr_seq_cirur_agente,
																	ds_code_p);

				END;
			END LOOP;
		END IF;

		atualiza_horario_evento(dt_registro_w, cd_estabelecimento_w, nr_sequencia_ww, contador_w, ds_code_p);

		CASE contador_w
			WHEN 1 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_1 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_1				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),
									point_1					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 2 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_2 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_2				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_2 = r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_2					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 3 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_3 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_3				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_3 = r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_3					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 4 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_4 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_4				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_4 = r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_4					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 5 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_5 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_5				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_5 = r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_5					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 6 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_6 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_6				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_6 = r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_6					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 7 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_7 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_7				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_7 = r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_7					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 8 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_8 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_8				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_8 = r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_8					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 9 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_9 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_9				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_9 = r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_9					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 10 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_10 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_10				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_10			= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_10					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 11 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_11 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_11				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B', decode(ie_dose_ataque_cont_w,'N','B','C')),--SET		vl_coluna_11			= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_11					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 12 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_12 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_12				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_12			= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_12					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 13 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_13 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_13				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_13			= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_13					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 14 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_14 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_14				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_14			= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_14					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 15 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_15 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_15				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_15			= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_15					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 16 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_16 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_16				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_16			= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_16					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			WHEN 17 THEN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_17 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
					WHERE		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'L';

					FOR r_c07 IN values_anesthesic_agents LOOP
						BEGIN
						ie_dose_ataque_cont_w := obter_se_dose_ataque_continuo(r_c07.nr_seq_cirur_agente, r_c07.qt_valor, r_c06.dt_registro);
						UPDATE	w_chart_pepo_report
						SET		vl_coluna_17				= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B',decode(ie_dose_ataque_cont_w,'S','B*','C')),--SET		vl_coluna_17			= r_c07.qt_valor ||' - '||DECODE(r_c06.ie_bolus,'S','B','C'),
									point_17					= r_c07.point
						WHERE		nr_seq_cirur_agente 	= r_c07.nr_seq_cirur_agente
						AND		nr_sequencia 			= nr_sequencia_ww
						AND		ie_tipo_coluna 		= 'V';
						END;
					END LOOP;
			END CASE;
		END;
	END LOOP;
	COMMIT;

	FOR r_c09 IN teste LOOP
		BEGIN

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_2 = vl_coluna_1,
					point_2		= 'START'
		WHERE		point_1		= 'START'
		AND		vl_coluna_2 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_3 = vl_coluna_2,
					point_3		= 'START'
		WHERE		point_2		= 'START'
		AND		vl_coluna_3 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_4 = vl_coluna_3,
					point_4		= 'START'
		WHERE		point_3		= 'START'
		AND		vl_coluna_4 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_5 = vl_coluna_4,
					point_5		= 'START'
		WHERE		point_4		= 'START'
		AND		vl_coluna_5 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_6 = vl_coluna_5,
					point_6		= 'START'
		WHERE		point_5		= 'START'
		AND		vl_coluna_6 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_7 = vl_coluna_6,
					point_7		= 'START'
		WHERE		point_6		= 'START'
		AND		vl_coluna_7 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_8 = vl_coluna_7,
					point_8		= 'START'
		WHERE		point_7		= 'START'
		AND		vl_coluna_8 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_9 = vl_coluna_8,
					point_9		= 'START'
		WHERE		point_8		= 'START'
		AND		vl_coluna_9 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_10 = vl_coluna_9,
					point_10		= 'START'
		WHERE		point_9		= 'START'
		AND		vl_coluna_10 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_11 = vl_coluna_10,
					point_11		= 'START'
		WHERE		point_10		= 'START'
		AND		vl_coluna_11 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_12 = vl_coluna_11,
					point_12		= 'START'
		WHERE		point_11		= 'START'
		AND		vl_coluna_12 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_13 = vl_coluna_12,
					point_13		= 'START'
		WHERE		point_12		= 'START'
		AND		vl_coluna_13 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_14 = vl_coluna_13,
					point_14		= 'START'
		WHERE		point_13		= 'START'
		AND		vl_coluna_14 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_15 = vl_coluna_14,
					point_15		= 'START'
		WHERE		point_14		= 'START'
		AND		vl_coluna_15 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_16 = vl_coluna_15,
					point_16		= 'START'
		WHERE		point_15		= 'START'
		AND		vl_coluna_16 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

		UPDATE	w_chart_pepo_report
		SET		vl_coluna_17 = vl_coluna_16,
					point_17		= 'START'
		WHERE		point_16		= 'START'
		AND		vl_coluna_17 IS NULL
		AND		ie_tipo_coluna = 'V'
		AND    	code = ds_code_p
		AND		nr_sequencia = r_c09.nr_sequencia
		AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;


		IF	SQL%FOUND THEN
			SELECT	MAX(vl_coluna_17),
						MAX(point_17)
			INTO		vl_coluna_17_w,
						point_17_w
			FROM		w_chart_pepo_report
			WHERE		ie_tipo_coluna = 'V'
			AND    	code = ds_code_p
			AND		nr_sequencia = r_c09.nr_sequencia
			AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;

			IF	(vl_coluna_17_w IS NOT NULL) AND (point_17_w = 'START') THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_1  = vl_coluna_17_w,
							point_1		 = 'START'
				WHERE		ie_tipo_coluna = 'V'
				AND    	code = ds_code_p
				AND		vl_coluna_1 IS NULL
				AND		nr_sequencia = r_c09.nr_sequencia + 1
				AND		nr_seq_cirur_agente = r_c09.nr_seq_cirur_agente;
			END IF;
		END IF;
		END;
	END LOOP;

	COMMIT;	
	end gera_agentes;
	
BEGIN
cd_estabelecimento_w	:= wheb_usuario_pck.get_cd_estabelecimento;
cd_perfil_w				:= wheb_usuario_pck.get_cd_perfil;

Obter_Param_Usuario(872, 224, cd_perfil_w, nm_usuario_p, cd_estabelecimento_w, ie_desc_comercial_w);

		--dt_inicio_w	:= get_start_end_surgery_graph(nr_cirurgia_w,nr_seq_pepo_w,'START',60,20);

	--dt_fim_w		:= get_start_end_surgery_graph(nr_cirurgia_w,nr_seq_pepo_w,'END',60,20);



	--Apaga os registros por usuario
	

if	(nvl(nr_cirurgia_p,0) > 0) then
	select	max(obter_usuario_pf(cd_medico_anestesista))
	into		nm_usuario_anestesista_w
	from		cirurgia
	where		nr_cirurgia = nr_cirurgia_p;
else
	select	max(obter_usuario_pf(cd_medico_anestesista))
	into		nm_usuario_anestesista_w
	from		pepo_cirurgia
	where		nr_sequencia = nr_seq_pepo_p;
end if;	
		
DELETE w_chart_pepo_report
WHERE nm_usuario = nm_usuario_p
OR nm_usuario IS NULL;
COMMIT;

FOR r_c01 IN vital_signs LOOP
	BEGIN
	ie_possui_w := 'S';
	INSERT		INTO w_chart_pepo_report(	nr_sequencia,
														nm_usuario,
														ie_tipo_coluna,
														ds_descricao,
														ie_sinal_vital,
														code)
	VALUES										(	nr_sequencia_ww,
														nm_usuario_p,
														'V',
														r_c01.descricao,
														r_c01.ie_sinal_vital,
														'SV');
	END;
END LOOP;

IF	(ie_possui_w = 'S') THEN
	INSERT		INTO w_chart_pepo_report( 	nr_sequencia,
														nm_usuario,
														ie_tipo_coluna,
														ds_descricao,

														code)
	VALUES										(	nr_sequencia_ww,
														nm_usuario_p,
														'L',
														ds_sinais_vitais_w, /*'Sinais vitais'*/
														'SV');
	insere_cabecalho_evento(nr_sequencia_ww, 'SV');
	
END IF;
ie_possui_w := 'N';

FOR r_c02 IN date_vital_signs LOOP
	BEGIN
	dt_registro_w	:= r_c02.dt_registro;
	IF	(contador_w = 20) THEN
		contador_w 		:= 0;
		nr_sequencia_ww:= nr_sequencia_ww + 1;
		INSERT		INTO w_chart_pepo_report( 	nr_sequencia,
												nm_usuario,
												ie_tipo_coluna,
												ds_descricao,
												code)
		VALUES								(nr_sequencia_ww,
												 nm_usuario_p,
												 'L',
												 ds_sinais_vitais_w, /*'Sinais vitais'*/
												 'SV');
												 
		insere_cabecalho_evento(nr_sequencia_ww, 'SV');
	
		FOR r_c03 IN vital_signs LOOP
			BEGIN
			INSERT		INTO w_chart_pepo_report( 	nr_sequencia,
																nm_usuario,
																ie_tipo_coluna,
																ds_descricao,
																ie_sinal_vital,
																code)
			VALUES										(	nr_sequencia_ww,
																nm_usuario_p,
																'V',
																r_c03.descricao,
																r_c03.ie_sinal_vital,
																'SV');

			END;
		END LOOP;
	END IF;

	contador_w := contador_w+1;

	atualiza_horario_evento(dt_registro_w, cd_estabelecimento_w, nr_sequencia_ww, contador_w, 'SV');

	CASE contador_w
		WHEN 1 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_1 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_1		= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 2 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_2 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_2		= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 3 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_3 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_3		= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 4 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_4 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_4		= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 5 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_5 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_5		= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 6 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_6 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_6		= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 7 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_7 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_7		= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 8 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_8 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_8		= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 9 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_9 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_9		= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 10 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_10 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_10	= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 11 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_11 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_11		= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 12 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_12 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_12	= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 13 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_13 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_13	= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 14 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_14 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_14	= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 15 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_15 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_15	= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 16 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_16 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_16	= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 17 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_17 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_17		= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 18 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_18 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_18	= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 19 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_19 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_19	= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		WHEN 20 THEN
				UPDATE	w_chart_pepo_report
				SET		vl_coluna_20 	= to_Char(dt_registro_w, 'hh24:mi:ss') --pkg_date_formaters.to_varchar(dt_registro_w,'shortTime',cd_estabelecimento_w,nm_usuario_p)
				WHERE		nr_sequencia 	= nr_sequencia_ww
				AND		ie_tipo_coluna = 'L';

				FOR r_c04 IN values_vital_signs LOOP
					BEGIN
					UPDATE	w_chart_pepo_report
					SET		vl_coluna_20	= r_c04.qt_valor
					WHERE		ie_sinal_vital = r_c04.ie_sinal_vital
					AND		nr_sequencia 	= nr_sequencia_ww
					AND		ie_tipo_coluna = 'V';
					END;
				END LOOP;
		END CASE;
	END;
END LOOP;
COMMIT;

/*Agentes / Medicamentos / Solucoes*/

contador_w 			:= 0;
nr_sequencia_ww	:= nr_sequencia_ww + 1;

ds_code_w := 'AG';
gera_agentes(ds_code_w, substr(wheb_mensagem_pck.get_texto(1028063),1,255)); /*'Agentes / Medicamentos / Solucoes'); */


/*Hemoderivados*/

contador_w 			:= 0;
nr_sequencia_ww	:= nr_sequencia_ww + 1;

ds_code_w := 'SH';
gera_agentes(ds_code_w, substr(wheb_mensagem_pck.get_texto(1028064),1,255)); /*'Hemoderivados'); */
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE insert_records_chart_report ( nr_cirurgia_p bigint, nr_seq_pepo_p bigint, nm_usuario_p text, ie_sv_anestesista_p text) FROM PUBLIC;

