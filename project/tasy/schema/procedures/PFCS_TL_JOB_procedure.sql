-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pfcs_tl_job () AS $body$
DECLARE


  nr_seq_indicator_p40 bigint := 40;
  nr_seq_indicator_p41 bigint := 41;
  nr_seq_indicator_p44 bigint := 44;
  nr_seq_indicator_p45 bigint := 45;
  nr_seq_indicator_p46 bigint := 46;
  nr_seq_indicator_p47 bigint := 47;
  nr_seq_indicator_p48 bigint := 48;
  nr_seq_indicator_p49 bigint := 49;
  nr_seq_indicator_p50 bigint := 50;
  nr_seq_indicator_p51 bigint := 51;
  nr_seq_indicator_p52 bigint := 52;
  cd_estabelecimento_p varchar(200);
  nm_usuario_p varchar(200);

  cur_cd_establishment CURSOR FOR
  SELECT cd_establishment establishment, nm_usuario username
  from pfcs_operational_level;
BEGIN
  for r_c01 in cur_cd_establishment
 loop
   CALL pfcs_calc_recommend_stats_tele(
    nr_seq_indicator_p => nr_seq_indicator_p40,
    cd_estabelecimento_p => r_c01.establishment,
    nm_usuario_p => r_c01.username
  );

    CALL pfcs_calc_avg_tim_tele_req(
    nr_seq_indicator_p => nr_seq_indicator_p41,
     cd_estabelecimento_p => r_c01.establishment,
    nm_usuario_p => r_c01.username
  );

    CALL pfcs_detailed_tele_requests(
    nr_seq_indicator_p => nr_seq_indicator_p44,
     cd_estabelecimento_p => r_c01.establishment,
    nm_usuario_p => r_c01.username
  );

    CALL pfcs_calc_device_capacity(
    nr_seq_indicator_p => nr_seq_indicator_p45,
    cd_estabelecimento_p => r_c01.establishment,
    nm_usuario_p => r_c01.username
  );

    CALL pfcs_calculate_device_in_use(
    nr_seq_indicator_p => nr_seq_indicator_p46,
    cd_estabelecimento_p => r_c01.establishment,
    nm_usuario_p => r_c01.username
  );

    CALL pfcs_calculate_total_device(
    nr_seq_indicator_p => nr_seq_indicator_p47,
    cd_estabelecimento_p => r_c01.establishment,
    nm_usuario_p => r_c01.username
  );

    CALL pfcs_calc_available_device(
    nr_seq_indicator_p => nr_seq_indicator_p48,
    cd_estabelecimento_p => r_c01.establishment,
    nm_usuario_p => r_c01.username
  );

    CALL pfcs_detailed_battery_status(
    nr_seq_indicator_p => nr_seq_indicator_p49,
     cd_estabelecimento_p => r_c01.establishment,
    nm_usuario_p => r_c01.username
  );

    CALL pfcs_calculate_discharge_count(
    nr_seq_indicator_p => nr_seq_indicator_p50,
    cd_estabelecimento_p => r_c01.establishment,
    nm_usuario_p => r_c01.username
  );

    CALL pfcs_calculate_patients_review(
    nr_seq_indicator_p => nr_seq_indicator_p51,
    cd_estabelecimento_p => r_c01.establishment,
    nm_usuario_p => r_c01.username
  );

    CALL pfcs_detailed_tele_status(
    nr_seq_indicator_p => nr_seq_indicator_p52,
    cd_estabelecimento_p => r_c01.establishment,
    nm_usuario_p => r_c01.username
  );

 end loop;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pfcs_tl_job () FROM PUBLIC;

