-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_compl_permitido_eup_js ( nm_usuario_p text, ds_msg_impede_compl_p INOUT text, ie_compl_residencial_p INOUT text, ie_compl_comercial_p INOUT text, ie_compl_responsavel_p INOUT text, ie_compl_pai_p INOUT text, ie_compl_mae_p INOUT text, ie_compl_conjuge_p INOUT text, ie_compl_hospedagem_p INOUT text, ie_compl_adicional_p INOUT text) AS $body$
DECLARE

cd_estabelecimento_w	bigint;
ie_comple_w		varchar(255);
ds_texto_aborta_w	varchar(4000) := '';
ie_tipo_complemento_w	bigint := 0;

ie_compl_residencial_w	varchar(1) := 'S';
ie_compl_comercial_w	varchar(1) := 'S';
ie_compl_responsavel_w	varchar(1) := 'S';
ie_compl_pai_w		varchar(1) := 'S';
ie_compl_mae_w		varchar(1) := 'S';
ie_compl_conjuge_w	varchar(1) := 'S';
ie_compl_hospedagem_w	varchar(1) := 'S';
ie_compl_adicional_w	varchar(1) := 'S';


BEGIN

cd_estabelecimento_w := wheb_usuario_pck.get_cd_estabelecimento;

ie_comple_w := Obter_param_Usuario(916, 920, obter_perfil_ativo, nm_usuario_p, cd_estabelecimento_w, ie_comple_w);

if (ie_comple_w IS NOT NULL AND ie_comple_w::text <> '') then

	while(ie_tipo_complemento_w < 8) loop
		begin

		if (ie_tipo_complemento_w = 0) then

			ie_compl_residencial_w := Obter_Se_Contido(ie_tipo_complemento_w,ie_comple_w);
			if (ie_compl_residencial_w = 'N') then

				ds_texto_aborta_w := substr(obter_texto_dic_objeto(288242, wheb_usuario_pck.get_nr_seq_idioma, 'TIPO_COMPLEMENTO=' || lower(wheb_mensagem_pck.get_texto(802676))),1,4000) || chr(10);
			end if;
		end if;

		if (ie_tipo_complemento_w = 1) then

			ie_compl_comercial_w := Obter_Se_Contido(ie_tipo_complemento_w,ie_comple_w);
			if (ie_compl_comercial_w = 'N') then

				ds_texto_aborta_w := substr(ds_texto_aborta_w || obter_texto_dic_objeto(288242, wheb_usuario_pck.get_nr_seq_idioma, 'TIPO_COMPLEMENTO=' || lower(wheb_mensagem_pck.get_texto(802677))),1,4000) || chr(10);

			end if;
		end if;

		if (ie_tipo_complemento_w = 2) then

			ie_compl_responsavel_w := Obter_Se_Contido(ie_tipo_complemento_w,ie_comple_w);
			if (ie_compl_responsavel_w = 'N') then

				ds_texto_aborta_w := substr(ds_texto_aborta_w || obter_texto_dic_objeto(288242, wheb_usuario_pck.get_nr_seq_idioma, 'TIPO_COMPLEMENTO=' || lower(wheb_mensagem_pck.get_texto(802678))),1,4000) || chr(10);

			end if;
		end if;

		if (ie_tipo_complemento_w = 3) then

			ie_compl_pai_w := Obter_Se_Contido(ie_tipo_complemento_w,ie_comple_w);
			if (ie_compl_pai_w = 'N') then

				ds_texto_aborta_w := substr(ds_texto_aborta_w || obter_texto_dic_objeto(288242, wheb_usuario_pck.get_nr_seq_idioma, 'TIPO_COMPLEMENTO=' || lower(wheb_mensagem_pck.get_texto(802679))),1,4000) || chr(10);

			end if;
		end if;

		if (ie_tipo_complemento_w = 4) then

			ie_compl_mae_w := Obter_Se_Contido(ie_tipo_complemento_w,ie_comple_w);
			if (ie_compl_mae_w = 'N') then

				ds_texto_aborta_w := substr(ds_texto_aborta_w || obter_texto_dic_objeto(288242, wheb_usuario_pck.get_nr_seq_idioma, 'TIPO_COMPLEMENTO=' || lower(wheb_mensagem_pck.get_texto(802680))),1,4000) || chr(10);

			end if;
		end if;

		if (ie_tipo_complemento_w = 5) then

			ie_compl_conjuge_w := Obter_Se_Contido(ie_tipo_complemento_w,ie_comple_w);
			if (ie_compl_conjuge_w = 'N') then

				ds_texto_aborta_w := substr(ds_texto_aborta_w || obter_texto_dic_objeto(288242, wheb_usuario_pck.get_nr_seq_idioma, 'TIPO_COMPLEMENTO=' || lower(wheb_mensagem_pck.get_texto(802681))),1,4000) || chr(10);

			end if;
		end if;
		if (ie_tipo_complemento_w = 6) then

			ie_compl_hospedagem_w := Obter_Se_Contido(ie_tipo_complemento_w,ie_comple_w);
			if (ie_compl_hospedagem_w = 'N') then

				ds_texto_aborta_w := substr(ds_texto_aborta_w || obter_texto_dic_objeto(288242, wheb_usuario_pck.get_nr_seq_idioma, 'TIPO_COMPLEMENTO=' || lower(wheb_mensagem_pck.get_texto(802682))),1,4000) || chr(10);

			end if;
		end if;

		if (ie_tipo_complemento_w = 7) then

			ie_compl_adicional_w := Obter_Se_Contido(ie_tipo_complemento_w,ie_comple_w);
			if (ie_compl_adicional_w = 'N') then

				ds_texto_aborta_w := substr(ds_texto_aborta_w || obter_texto_dic_objeto(288242, wheb_usuario_pck.get_nr_seq_idioma, 'TIPO_COMPLEMENTO=' || lower(wheb_mensagem_pck.get_texto(802683))),1,4000) || chr(10);

			end if;
		end if;

		ie_tipo_complemento_w := ie_tipo_complemento_w + 1;
		end;
	end loop;
	if (ds_texto_aborta_w IS NOT NULL AND ds_texto_aborta_w::text <> '') then
		ds_texto_aborta_w := substr(ds_texto_aborta_w || obter_texto_tasy(288245, wheb_usuario_pck.get_nr_seq_idioma),1,4000);
	end if;
end if;

ie_compl_residencial_p	:= ie_compl_residencial_w;
ie_compl_comercial_p	:= ie_compl_comercial_w;
ie_compl_responsavel_p	:= ie_compl_responsavel_w;
ie_compl_pai_p		:= ie_compl_pai_w;
ie_compl_mae_p		:= ie_compl_mae_w;
ie_compl_conjuge_p	:= ie_compl_conjuge_w;
ie_compl_hospedagem_p	:= ie_compl_hospedagem_w;
ie_compl_adicional_p	:= ie_compl_adicional_w;
ds_msg_impede_compl_p   := ds_texto_aborta_w;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_compl_permitido_eup_js ( nm_usuario_p text, ds_msg_impede_compl_p INOUT text, ie_compl_residencial_p INOUT text, ie_compl_comercial_p INOUT text, ie_compl_responsavel_p INOUT text, ie_compl_pai_p INOUT text, ie_compl_mae_p INOUT text, ie_compl_conjuge_p INOUT text, ie_compl_hospedagem_p INOUT text, ie_compl_adicional_p INOUT text) FROM PUBLIC;

