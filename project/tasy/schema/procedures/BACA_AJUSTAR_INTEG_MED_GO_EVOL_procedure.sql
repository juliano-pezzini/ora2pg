-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE baca_ajustar_integ_med_go_evol () AS $body$
DECLARE


nr_seq_integridade_w	bigint;
nr_seq_evolucao_w	bigint;

c01 CURSOR FOR
SELECT	a.nr_sequencia,
	a.nr_seq_evolucao
from	med_pac_ginecologia a
where	(a.nr_seq_evolucao IS NOT NULL AND a.nr_seq_evolucao::text <> '')
and	not exists (
		SELECT	1
		from	med_evolucao x
		where	x.nr_sequencia		= a.nr_seq_evolucao
		and	x.nr_seq_pac_ginec	= a.nr_sequencia);

c02 CURSOR FOR
SELECT	a.nr_sequencia,
	a.nr_seq_evolucao
from	med_pac_pre_natal a
where	(a.nr_seq_evolucao IS NOT NULL AND a.nr_seq_evolucao::text <> '')
and	not exists (
		SELECT	1
		from	med_evolucao x
		where	x.nr_sequencia		= a.nr_seq_evolucao
		and	x.nr_seq_pac_pre_natal	= a.nr_sequencia);

c03 CURSOR FOR
SELECT	a.nr_sequencia,
	a.nr_seq_evolucao
from	med_pac_pre_natal_evol a
where	(a.nr_seq_evolucao IS NOT NULL AND a.nr_seq_evolucao::text <> '')
and	not exists (
		SELECT	1
		from	med_evolucao x
		where	x.nr_sequencia			= a.nr_seq_evolucao
		and	x.nr_seq_pac_pre_natal_evol	= a.nr_sequencia);


BEGIN
open c01;
loop
fetch c01 into	nr_seq_integridade_w,
		nr_seq_evolucao_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
	begin
	update	med_evolucao
	set	nr_seq_pac_ginec	= nr_seq_integridade_w
	where	nr_sequencia		= nr_seq_evolucao_w;
	end;
end loop;
close c01;

open c02;
loop
fetch c02 into	nr_seq_integridade_w,
		nr_seq_evolucao_w;
EXIT WHEN NOT FOUND; /* apply on c02 */
	begin
	update	med_evolucao
	set	nr_seq_pac_pre_natal	= nr_seq_integridade_w
	where	nr_sequencia		= nr_seq_evolucao_w;
	end;
end loop;
close c02;

open c03;
loop
fetch c03 into	nr_seq_integridade_w,
		nr_seq_evolucao_w;
EXIT WHEN NOT FOUND; /* apply on c03 */
	begin
	update	med_evolucao
	set	nr_seq_pac_pre_natal_evol	= nr_seq_integridade_w
	where	nr_sequencia			= nr_seq_evolucao_w;
	end;
end loop;
close c03;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE baca_ajustar_integ_med_go_evol () FROM PUBLIC;

