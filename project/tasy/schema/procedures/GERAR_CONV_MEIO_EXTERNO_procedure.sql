-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_conv_meio_externo ( cd_cgc_p text, nm_tabela_p text, nm_atributo_p text, cd_interno_p text, cd_externo_p text, ie_sistema_externo_p text, nr_seq_regra_p bigint, ie_envio_receb_p text, nm_usuario_p text) AS $body$
DECLARE


conversao_meio_externo_w	conversao_meio_externo%rowtype;

BEGIN

begin
select	*
into STRICT	conversao_meio_externo_w
from	conversao_meio_externo
where	nm_tabela = nm_tabela_p
and	nm_atributo = nm_atributo_p
and	nr_seq_regra = nr_seq_regra_p
and	ie_envio_receb = ie_envio_receb_p
and	cd_interno = cd_interno_p  LIMIT 1;
exception
when others then
	conversao_meio_externo_w.nr_sequencia	:=	null;
end;

conversao_meio_externo_w.cd_cgc			:=	cd_cgc_p;
conversao_meio_externo_w.nm_tabela			:=	nm_tabela_p;
conversao_meio_externo_w.nm_atributo			:=	nm_atributo_p;
conversao_meio_externo_w.cd_interno			:=	cd_interno_p;
conversao_meio_externo_w.cd_externo			:=	cd_externo_p;
conversao_meio_externo_w.dt_atualizacao		:=	clock_timestamp();
conversao_meio_externo_w.nm_usuario			:=	nm_usuario_p;
conversao_meio_externo_w.ie_sistema_externo		:=	ie_sistema_externo_p;
conversao_meio_externo_w.nr_seq_regra		:=	nr_seq_regra_p;
conversao_meio_externo_w.ie_envio_receb		:=	ie_envio_receb_p;
conversao_meio_externo_w.nm_apresentacao_ext	:=	null;
conversao_meio_externo_w.cd_dominio			:=	null;

if (conversao_meio_externo_w.nr_sequencia IS NOT NULL AND conversao_meio_externo_w.nr_sequencia::text <> '') then
	update	conversao_meio_externo
	set	row = conversao_meio_externo_w
	where	nr_sequencia = conversao_meio_externo_w.nr_sequencia;
else
	begin
	select	nextval('conversao_meio_externo_seq')
	into STRICT	conversao_meio_externo_w.nr_sequencia
	;

	insert into conversao_meio_externo values (conversao_meio_externo_w.*);
	end;
end if;

/*n√£o pode ter commit*/

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_conv_meio_externo ( cd_cgc_p text, nm_tabela_p text, nm_atributo_p text, cd_interno_p text, cd_externo_p text, ie_sistema_externo_p text, nr_seq_regra_p bigint, ie_envio_receb_p text, nm_usuario_p text) FROM PUBLIC;

