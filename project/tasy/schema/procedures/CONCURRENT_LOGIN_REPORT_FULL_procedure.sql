-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE concurrent_login_report_full ( dt_fromdate_p timestamp, dt_todate_p timestamp, qt_time bigint) AS $body$
DECLARE


qt_reg_w			integer;


BEGIN

CALL pkg_login_report.do_login_report_full_html5(dt_fromdate_p, dt_todate_p, qt_time);

select	count(1)
into STRICT	qt_reg_w
from	user_tables
where	table_name = 'W_CONCURRENT_USERS_T';

if (qt_reg_w = 1) then
	EXECUTE 'drop table w_concurrent_users_t';
end if;

EXECUTE 'create table w_concurrent_users_t as (select dt_when, nr_count, ''H'' ie_platform from concurrent_users_t)';

CALL pkg_login_report.do_login_report_full(dt_fromdate_p, dt_todate_p);

EXECUTE 'insert into w_concurrent_users_t select dt_when, nr_count, ''J'' from concurrent_users_t';

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE concurrent_login_report_full ( dt_fromdate_p timestamp, dt_todate_p timestamp, qt_time bigint) FROM PUBLIC;

