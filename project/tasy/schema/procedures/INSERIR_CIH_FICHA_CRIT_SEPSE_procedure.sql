-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE inserir_cih_ficha_crit_sepse (nr_ficha_ocorrencia_p cih_ficha_crit_sepse.nr_ficha_ocorrencia%type, nr_seq_crit_sepse_p cih_ficha_crit_sepse.nr_seq_crit_sepse%type, nm_usuario_p cih_ficha_crit_sepse.nm_usuario%type) AS $body$
DECLARE

    nr_sequencia_w cih_ficha_crit_sepse.nr_sequencia%type;
    qt_reg_w integer;

BEGIN

    select count(*)
    into STRICT   qt_reg_w
    from   cih_ficha_crit_sepse
    where  nr_ficha_ocorrencia = nr_ficha_ocorrencia_p
    and    nr_seq_crit_sepse   = nr_seq_crit_sepse_p;

    if (qt_reg_w = 0) then

        select nextval('cih_ficha_crit_sepse_seq')
        into STRICT   nr_sequencia_w
;

        insert into cih_ficha_crit_sepse(nr_sequencia,
               nr_ficha_ocorrencia,
               nr_seq_crit_sepse,
               dt_atualizacao,
               nm_usuario,
               dt_atualizacao_nrec,
               nm_usuario_nrec)
        values (nr_sequencia_w,
               nr_ficha_ocorrencia_p,
               nr_seq_crit_sepse_p,
               clock_timestamp(),
               nm_usuario_p,
               clock_timestamp(),
               nm_usuario_p);

        commit;

    end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE inserir_cih_ficha_crit_sepse (nr_ficha_ocorrencia_p cih_ficha_crit_sepse.nr_ficha_ocorrencia%type, nr_seq_crit_sepse_p cih_ficha_crit_sepse.nr_seq_crit_sepse%type, nm_usuario_p cih_ficha_crit_sepse.nm_usuario%type) FROM PUBLIC;

