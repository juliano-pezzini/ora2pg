-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE plt_copia_leite_deriv ( nr_prescricao_p bigint, nr_prescricao_orig_p bigint, nr_seq_item_p bigint, nr_seq_leite_deriv_p bigint, nr_seq_regra_p bigint, ie_modificar_p text, nm_usuario_p text, cd_perfil_p bigint, cd_estabelecimento_p bigint, ie_estende_inc_p text) AS $body$
DECLARE


nr_sequencia_w			integer;
ie_origem_inf_w			varchar(1);
cd_unidade_medida_w		varchar(30);
qt_dose_w			double precision;
qt_unitaria_w			double precision;
qt_material_w			double precision;
cont_w				double precision;
cd_intervalo_w			varchar(7);
ds_horarios_w			varchar(2000);
ie_via_aplicacao_w		varchar(15);
nr_seq_disp_succao_w		bigint;
cd_unidade_medida_dose_w	varchar(30);
hr_prim_horario_w		varchar(5);
ie_se_necessario_w		varchar(1);
dt_inicio_prescr_w		timestamp;
dt_validade_prescr_w		timestamp;
nr_prescricao_original_w	bigint;
nr_seq_anterior_w		integer;
nr_seq_leite_deriv_w		bigint;
nr_seq_dil_w			bigint;
nr_seq_leite_deriv_ww		bigint;
cd_material_dil_w		integer;
cd_intervalo_dil_w		varchar(7);
ie_se_necessario_dil_w		varchar(1);
qt_porcentagem_w		prescr_material.qt_porcentagem%type;
qt_inconsistencia_w		bigint;
nr_intervalo_w			bigint;
ds_horarios2_w			ds_horarios_w%type;
ds_horarios_ww			varchar(2000);
ds_horarios_www			varchar(2000);
dt_primeiro_horario_w		timestamp;
nr_horas_validade_w		bigint;
nr_agrupamento_w		bigint;
dt_ultimo_horario_w		timestamp;
dt_prim_hor_leite_w		timestamp;
ie_manter_intervalo_w		rep_regra_copia_crit.ie_manter_intervalo%type;
ie_regra_geral_w		rep_regra_copia_crit.ie_manter_intervalo%type;
dt_inicio_item_w		timestamp;
nr_ocorrencia_w			bigint;
ie_operacao_w			intervalo_prescricao.ie_operacao%type;
qt_operacao_w			intervalo_prescricao.qt_operacao%type;
hr_prim_horario_ant_w		prescr_leite_deriv.hr_prim_horario%type;
dt_prim_horario_ant_w	timestamp;

C01 CURSOR FOR
SELECT	cd_material,
	cd_unidade_medida_dose,
	cd_unidade_medida,
	ie_origem_inf,
	qt_material,
	qt_unitaria,
	cd_intervalo,
	ds_horarios,
	ie_se_necessario,
	qt_dose,
	qt_porcentagem
from	prescr_material
where	nr_prescricao	= nr_prescricao_orig_p
and	nr_sequencia_diluicao = nr_seq_item_p
and	ie_agrupador 	= 17;


BEGIN

select	max(dt_inicio_prescr),
		max(dt_validade_prescr),
		max(dt_primeiro_horario),
		max(nr_horas_validade)
into STRICT	dt_inicio_prescr_w,
		dt_validade_prescr_w,
		dt_primeiro_horario_w,
		nr_horas_validade_w
from	prescr_medica
where	nr_prescricao = nr_prescricao_p  LIMIT 1;

CALL PLT_consiste_extensao_item(dt_inicio_prescr_w, dt_validade_prescr_w, nr_prescricao_orig_p, nr_seq_item_p, 'LD', nr_seq_regra_p, nm_usuario_p, cd_perfil_p, cd_estabelecimento_p);

select	count(nr_sequencia)
into STRICT	qt_inconsistencia_w
from	w_copia_plano
where	nr_prescricao	= nr_prescricao_orig_p
and		nr_seq_item	= nr_seq_item_p
and		ie_tipo_item	= 'LD'
and		nm_usuario	= nm_usuario_p
and		((ie_permite	= 'N') or (ie_estende_inc_p = 'N'))  LIMIT 1;

if	((qt_inconsistencia_w	= 0) or (ie_modificar_p 	= 'S')) then

	select	coalesce(max(b.nr_sequencia),0)
	into STRICT	nr_seq_leite_deriv_w
	from	prescr_leite_deriv a,
			prescr_leite_deriv b
	where	a.nr_prescricao	= nr_prescricao_orig_p
	and		a.nr_sequencia	= nr_seq_leite_deriv_p
	and		b.nr_prescricao	= nr_prescricao_p
	and		a.cd_intervalo	= b.cd_intervalo
	and		a.ie_se_necessario = b.ie_se_necessario
	and		a.ie_via_aplicacao = b.ie_via_aplicacao
	and		a.nr_seq_disp_succao = b.nr_seq_disp_succao
	and		a.qt_volume_total = b.qt_volume_total
	and		a.hr_prim_horario = b.hr_prim_horario  LIMIT 1;

	if (nr_seq_leite_deriv_w = 0) then

		select	nextval('prescr_leite_deriv_seq')
		into STRICT	nr_seq_leite_deriv_w
		;

		select	max(cd_intervalo),
			max(hr_prim_horario),
			max(ds_horarios)
		into STRICT	cd_intervalo_w,
			hr_prim_horario_ant_w,
			ds_horarios_w
		from	prescr_leite_deriv
		where	nr_prescricao	= nr_prescricao_orig_p
		and		nr_sequencia	= nr_seq_leite_deriv_p  LIMIT 1;

		select 	coalesce(max(ie_se_necessario),'N')
		into STRICT 	ie_se_necessario_w
		from	prescr_material
		where	nr_prescricao	= nr_prescricao_orig_p
		and		nr_sequencia = nr_seq_item_p;

		select	coalesce(max(ie_manter_intervalo),'N'),
				coalesce(max(ie_regra_geral),'I')
		into STRICT	ie_manter_intervalo_w,
				ie_regra_geral_w
		from	rep_regra_copia_crit
		where	ie_tipo_item = 'LD'
		and		nr_seq_regra = nr_seq_regra_p;
		
		if (ie_manter_intervalo_w = 'S') and (ie_regra_geral_w = 'I') and (hr_prim_horario_ant_w IS NOT NULL AND hr_prim_horario_ant_w::text <> '') then
			hr_prim_horario_w := hr_prim_horario_ant_w;			
			dt_prim_horario_ant_w := converte_char_data(to_char(dt_inicio_prescr_w,'dd/mm/yyyy'),hr_prim_horario_ant_w||':00',null);
		end if;

		dt_ultimo_horario_w	:= PLT_obter_ultimo_horario(nr_prescricao_orig_p, nr_seq_item_p, 'LD', nm_usuario_p);

		if (ie_modificar_p = 'N') and (dt_ultimo_horario_w IS NOT NULL AND dt_ultimo_horario_w::text <> '') and
			(dt_ultimo_horario_w > (clock_timestamp() - interval '1 days')) then

			hr_prim_horario_w	:= to_char(dt_ultimo_horario_w + /*nvl(*/
Obter_ocorrencia_intervalo(cd_intervalo_w,coalesce(nr_horas_validade_w,24),'H')/ 24,'hh24:mi');
			dt_prim_hor_leite_w	:= converte_char_data(to_char(dt_inicio_prescr_w,'dd/mm/yyyy'),hr_prim_horario_w||':00',null);
		end if;
		
		select	max(ie_operacao)
		into STRICT	ie_operacao_w
		from	intervalo_prescricao
		where	cd_intervalo	= cd_intervalo_w;

		if	(((coalesce(dt_prim_hor_leite_w::text, '') = '') and (coalesce(hr_prim_horario_w::text, '') = '')) or
			 ((dt_prim_hor_leite_w IS NOT NULL AND dt_prim_hor_leite_w::text <> '') and (not(dt_prim_hor_leite_w between dt_inicio_prescr_w and dt_validade_prescr_w))) or (ie_operacao_w in ('F', 'V'))) then
			hr_prim_horario_w	:= obter_primeiro_horario(cd_intervalo_w, nr_prescricao_p, 0, null);
		end if;

		if (hr_prim_horario_w	= '24:00') then
			hr_prim_horario_w	:= '00:00';		
		end if;

		if (ie_regra_geral_w = 'I') and (ie_manter_intervalo_w = 'N') then
			ds_horarios_w := reordenar_horarios(dt_inicio_prescr_w, ds_horarios_w);
			ds_horarios_w := Eliminar_horarios_vigencia(ds_horarios_w, cd_intervalo_w, dt_inicio_prescr_w, dt_inicio_prescr_w, 0, 0, nr_prescricao_p);

			hr_prim_horario_w	:= coalesce(Obter_prim_DsHorarios(ds_horarios_w),to_char(dt_inicio_prescr_w,'hh24:mi'));
		elsif (ie_se_necessario_w = 'S') then
			hr_prim_horario_w := null;			
			ds_horarios_w := 'SN';
		elsif (ie_regra_geral_w = 'H') and (ie_manter_intervalo_w = 'S') and (cd_intervalo_w IS NOT NULL AND cd_intervalo_w::text <> '') then

			select	max(ie_operacao),
					max(qt_operacao)
			into STRICT	ie_operacao_w,
					qt_operacao_w
			from	intervalo_prescricao
			where	cd_intervalo	= cd_intervalo_w;

			qt_operacao_w		:= obter_ocorrencia_intervalo(cd_intervalo_w, 24, 'H');
			dt_inicio_item_w	:= dt_inicio_prescr_w - qt_operacao_w / 24;

			select	coalesce(max(c.dt_horario), dt_inicio_prescr_w)
			into STRICT	dt_inicio_item_w
			from	prescr_mat_hor c,
					prescr_material d,
					prescr_leite_deriv b,
					prescr_medica a
			where	coalesce(c.ie_situacao,'A')	= 'A'
			and		c.nr_prescricao		= b.nr_prescricao
			--and 	nvl(c.ie_horario_especial,'N') <> 'S'
			and		d.nr_sequencia = c.nr_seq_material
			and		d.nr_prescricao = c.nr_prescricao
			and		d.ie_agrupador	= 16
			and		b.nr_sequencia	= d.nr_seq_leite_deriv
			and		b.nr_prescricao	= d.nr_prescricao
			and		b.cd_intervalo		= cd_intervalo_w
			and		b.nr_sequencia		= nr_seq_leite_deriv_p
			and		b.nr_prescricao		= a.nr_prescricao
			and		(coalesce(a.dt_liberacao_medico, a.dt_liberacao) IS NOT NULL AND (coalesce(a.dt_liberacao_medico, a.dt_liberacao))::text <> '')
			and		coalesce(a.dt_suspensao::text, '') = ''
			--and	Obter_se_horario_liberado(c.dt_lib_horario, c.dt_horario) = 'S'
			and		a.nr_prescricao	= nr_prescricao_orig_p;

			hr_prim_horario_w	:= trim(both coalesce(hr_prim_horario_w, obter_Prim_dshorarios(ds_horarios_w)));			

			if (coalesce(dt_inicio_item_w::text, '') = '') or (ie_operacao_w in ('F', 'V')) then
				if (length(hr_prim_horario_w) = 5) then
					if (dt_inicio_prescr_w > to_date(to_char(dt_inicio_prescr_w, 'dd/mm/yyyy ') || hr_prim_horario_w, 'dd/mm/yyyy hh24:mi')) then
						dt_inicio_item_w	:= to_date(to_char(dt_inicio_prescr_w, 'dd/mm/yyyy ') || hr_prim_horario_w, 'dd/mm/yyyy hh24:mi');
					else
						dt_inicio_item_w	:= to_date(to_char(dt_inicio_prescr_w+1, 'dd/mm/yyyy ') || hr_prim_horario_w, 'dd/mm/yyyy hh24:mi');
					end if;
				else
					hr_prim_horario_w	:= null;					
				end if;
			end if;

			if (dt_inicio_item_w IS NOT NULL AND dt_inicio_item_w::text <> '') and (ie_operacao_w not in ('F', 'V')) then
				dt_inicio_item_w	:= dt_inicio_item_w + qt_operacao_w / 24;
			end if;

			dt_inicio_item_w	:= coalesce(dt_inicio_item_w, dt_inicio_prescr_w);

			if (coalesce(qt_operacao_w,0) > 0) and (ie_operacao_w in ('H')) and (dt_inicio_item_w IS NOT NULL AND dt_inicio_item_w::text <> '') then

				if (ie_operacao_w in ('H')) and (dt_inicio_item_w not between dt_inicio_prescr_w and (dt_inicio_item_w + qt_operacao_w)) then

					while(dt_inicio_item_w not between dt_inicio_prescr_w and (dt_inicio_item_w + qt_operacao_w)) loop
						dt_inicio_item_w	:= dt_inicio_item_w + qt_operacao_w/24;
					end loop;
				end if;

				hr_prim_horario_w	:= to_char(dt_inicio_item_w, 'hh24:mi');				
			end if;

			nr_ocorrencia_w	:= 0;
			SELECT * FROM Calcular_Horario_Prescricao(nr_prescricao_p, cd_intervalo_w, dt_inicio_prescr_w, dt_inicio_item_w, nr_horas_validade_w, null, 0, 0, nr_ocorrencia_w, ds_horarios_w, ds_horarios2_w, 'N', null) INTO STRICT nr_ocorrencia_w, ds_horarios_w, ds_horarios2_w;



			ds_horarios_w	:= eliminar_horarios_vigencia(ds_horarios_w || ds_horarios2_w, cd_intervalo_w, dt_inicio_item_w, dt_inicio_prescr_w, 0, 0, nr_prescricao_p);


		elsif (hr_prim_horario_w <> '  :  ') and (hr_prim_horario_w IS NOT NULL AND hr_prim_horario_w::text <> '') then
				
				ds_horarios_w	:= '';
				if (coalesce(dt_prim_horario_ant_w::text, '') = '') then
					dt_prim_horario_ant_w	:= dt_inicio_prescr_w;
				else
					hr_prim_horario_w := to_char(dt_prim_horario_ant_w, 'hh24:mi');
				end if;
				
				SELECT * FROM Calcular_Horario_Prescricao(nr_prescricao_p, cd_intervalo_w, PKG_DATE_UTILS.get_Time(dt_inicio_prescr_w, hr_prim_horario_w), PKG_DATE_UTILS.get_Time(dt_inicio_prescr_w, hr_prim_horario_w), nr_horas_validade_w, null, 0, 0, nr_intervalo_w, ds_horarios_ww, ds_horarios_www, 'N', null) INTO STRICT nr_intervalo_w, ds_horarios_ww, ds_horarios_www;
				ds_horarios_w := ds_horarios_ww||ds_horarios_www;
		else
			ds_horarios_w	:= '';
		end if;

		nr_seq_leite_deriv_ww	:= nr_seq_leite_deriv_p;
		if (nr_seq_leite_deriv_ww = 0) then
			nr_seq_leite_deriv_ww	:= null;
		end if;

		insert	into prescr_leite_deriv(cd_intervalo,
			dt_atualizacao_nrec,
			dt_atualizacao,
			nm_usuario,
			nr_prescricao,
			nr_sequencia,
			qt_volume_oral,
			qt_volume_sonda,
			qt_volume_total,
			ie_se_necessario,
			ie_via_aplicacao,
			nm_usuario_nrec,
			nr_seq_disp_succao,
			ds_horarios,
			hr_prim_horario)
		SELECT	cd_intervalo,
			clock_timestamp(),
			clock_timestamp(),
			nm_usuario_p,
			nr_prescricao_p,
			nr_seq_leite_deriv_w,
			qt_volume_oral,
			qt_volume_sonda,
			qt_volume_total,
			ie_se_necessario,
			ie_via_aplicacao,
			nm_usuario_p,
			nr_seq_disp_succao,
			ds_horarios_w,
			hr_prim_horario_w
		from	prescr_leite_deriv
		where	nr_prescricao	= nr_prescricao_orig_p
		and	nr_sequencia	= coalesce(nr_seq_leite_deriv_ww,nr_sequencia);

	end if;

	select	coalesce(max(nr_sequencia),0) + 1
	into STRICT	nr_sequencia_w
	from	prescr_material
	where	nr_prescricao = nr_prescricao_p;

	select	coalesce(max(nr_agrupamento),0) + 1
	into STRICT	nr_agrupamento_w
	from	prescr_material
	where	nr_prescricao 		= nr_prescricao_p
	and		nr_seq_leite_deriv	= nr_seq_leite_deriv_w
	and		ie_agrupador		= 16;

	select	count(*)
	into STRICT	cont_w
	from	prescr_leite_deriv
	where	nr_sequencia	= nr_seq_leite_deriv_w  LIMIT 1;

	if (cont_w > 0) then
		insert  into prescr_material(
				nr_prescricao,
				nr_sequencia,
				nr_seq_leite_deriv,
				ie_origem_inf,
				cd_material,
				cd_unidade_medida,
				qt_dose,
				qt_unitaria,
				qt_material,
				dt_atualizacao,
				nm_usuario,
				cd_intervalo,
				ds_horarios,
				ds_observacao,
				ds_observacao_enf,
				ie_via_aplicacao,
				ie_cobra_paciente,
				cd_motivo_baixa,
				dt_baixa,
				ie_utiliza_kit,
				cd_unidade_medida_dose,
				qt_conversao_dose,
				ie_urgencia,
				nr_ocorrencia,
				qt_total_dispensar,
				cd_fornec_consignado,
				hr_dose_especial,
				qt_dose_especial,
				ds_dose_diferenciada,
				ie_medicacao_paciente,
				hr_prim_horario,
				ie_agrupador,
				nr_dia_util,
				ie_suspenso,
				ie_se_necessario,
				qt_min_aplicacao,
				ie_bomba_infusao,
				ie_aplic_bolus,
				ie_aplic_lenta,
				ie_acm,
				ie_objetivo,
				cd_topografia_cih,
				ie_origem_infeccao,
				cd_amostra_cih,
				cd_microorganismo_cih,
				ie_uso_antimicrobiano,
				cd_protocolo,
				nr_seq_protocolo,
				nr_seq_mat_protocolo,
				qt_hora_aplicacao,
				ie_recons_diluente_fixo,
				qt_vel_infusao,
				ds_justificativa,
				ie_sem_aprazamento,
				ie_indicacao,
				dt_proxima_dose,
				qt_total_dias_lib,
				nr_seq_substituto,
				ie_lado,
				dt_inicio_medic,
				qt_dia_prim_hor,
				ie_regra_disp,
				qt_vol_adic_reconst,
				qt_hora_intervalo,
				qt_min_intervalo,
				dt_suspensao_progr,
				nr_prescricao_original,
				nr_seq_anterior,
				nr_agrupamento,
				ie_regra_volume_leite)
		SELECT  nr_prescricao_p,
			nr_sequencia_w,
			nr_seq_leite_deriv_w,
			a.ie_origem_inf,
			a.cd_material,
			a.cd_unidade_medida,
			a.qt_dose,
			a.qt_unitaria,
			a.qt_material,
			clock_timestamp(),
			nm_usuario_p,
			a.cd_intervalo,
			a.ds_horarios,
			a.ds_observacao,
			a.ds_observacao_enf,
			a.ie_via_aplicacao,
			coalesce(a.ie_cobra_paciente,'S'),
			CASE WHEN coalesce(a.ie_regra_disp,'X')='D' THEN  a.cd_motivo_baixa  ELSE CASE WHEN coalesce(a.ie_cobra_paciente,'S')='S' THEN  0  ELSE a.cd_motivo_baixa END  END  cd_motivo_baixa,
			CASE WHEN coalesce(a.ie_regra_disp,'X')='D' THEN  clock_timestamp()  ELSE CASE WHEN coalesce(a.ie_cobra_paciente,'S')='S' THEN  null  ELSE clock_timestamp() END  END  dt_baixa,
			a.ie_utiliza_kit,
			a.cd_unidade_medida_dose,
			a.qt_conversao_dose,
			'N' ie_urgencia,
			a.nr_ocorrencia,
			a.qt_total_dispensar,
			a.cd_fornec_consignado,
			null hr_dose_especial,
			null qt_dose_especial,
			a.ds_dose_diferenciada,
			a.ie_medicacao_paciente,
			CASE WHEN a.ie_se_necessario='S' THEN  null  ELSE hr_prim_horario_w END  hr_prim_horario,
			a.ie_agrupador,
			a.nr_dia_util,
			CASE WHEN b.ie_situacao='A' THEN  'N'  ELSE 'S' END   ie_suspenso,
			a.ie_se_necessario,
			a.qt_min_aplicacao,
			a.ie_bomba_infusao,
			coalesce(a.ie_aplic_bolus,'N') ie_aplic_bolus,
			coalesce(a.ie_aplic_lenta,'N') ie_aplic_lenta,
			coalesce(a.ie_acm,'N') ie_acm,
			a.ie_objetivo,
			a.cd_topografia_cih,
			a.ie_origem_infeccao,
			a.cd_amostra_cih,
			a.cd_microorganismo_cih,
			coalesce(a.ie_uso_antimicrobiano,'N') ie_uso_antimicrobiano,
			a.cd_protocolo,
			a.nr_seq_protocolo,
			a.nr_seq_mat_protocolo,
			a.qt_hora_aplicacao,
			'N' ie_recons_diluente_fixo,
			a.qt_vel_infusao,
			a.ds_justificativa,
			a.ie_sem_aprazamento,
			a.ie_indicacao,
			a.dt_proxima_dose,
			a.qt_total_dias_lib,
			a.nr_seq_substituto,
			a.ie_lado,
			a.dt_inicio_medic,
			a.qt_dia_prim_hor,
			CASE WHEN coalesce(a.ie_regra_disp,'X')='D' THEN  a.ie_regra_disp  ELSE null END  ie_regra_disp,
			a.qt_vol_adic_reconst,
			a.qt_hora_intervalo,
			a.qt_min_intervalo,
			a.dt_suspensao_progr,
			coalesce(a.nr_prescricao_original,a.nr_prescricao),
			coalesce(a.nr_seq_anterior,a.nr_sequencia),
			nr_agrupamento_w,
			a.ie_regra_volume_leite
		From	Material b,
			Prescr_Material a
		where	a.nr_prescricao = nr_prescricao_orig_p
		and	a.nr_sequencia	= nr_seq_item_p
		and	a.cd_material 	= b.cd_material;

		open C01; --DILUENTES
		loop
		fetch C01 into
			cd_material_dil_w,
			cd_unidade_medida_dose_w,
			cd_unidade_medida_w,
			ie_origem_inf_w,
			qt_material_w,
			qt_unitaria_w,
			cd_intervalo_dil_w,
			ds_horarios_w,
			ie_se_necessario_dil_w,
			qt_dose_w,
			qt_porcentagem_w;
		EXIT WHEN NOT FOUND; /* apply on C01 */
			begin

			select	coalesce(max(nr_sequencia),0) + 1
			into STRICT	nr_seq_dil_w
			from	prescr_material
			where	nr_prescricao	= nr_prescricao_p;

			insert	into prescr_material(nr_sequencia,
							nr_prescricao,
							cd_material,
							cd_unidade_medida_dose,
							cd_unidade_medida,
							dt_atualizacao,
							ie_origem_inf,
							nm_usuario,
							ie_agrupador,
							qt_material,
							qt_unitaria,
							cd_intervalo,
							nr_sequencia_diluicao,
							ds_horarios,
							ie_se_necessario,
							hr_prim_horario,
							qt_dose,
							qt_porcentagem,
							nr_agrupamento)
					values (nr_seq_dil_w,
							nr_prescricao_p,
							cd_material_dil_w,
							cd_unidade_medida_dose_w,
							cd_unidade_medida_w,
							clock_timestamp(),
							ie_origem_inf_w,
							nm_usuario_p,
							17,
							qt_material_w,
							qt_unitaria_w,
							cd_intervalo_dil_w,
							nr_sequencia_w,
							ds_horarios_w,
							ie_se_necessario_dil_w,
							hr_prim_horario_w,
							qt_dose_w,
							qt_porcentagem_w,
							nr_agrupamento_w);

			end;
		end loop;
		close C01;
	end if;
end if;

if (nr_seq_leite_deriv_w > 0) then
	CALL atualiza_produto_lactario(nr_seq_leite_deriv_w, nm_usuario_p, cd_perfil_p);
end if;

if (coalesce(wheb_usuario_pck.get_ie_commit, 'S') = 'S') then commit; end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE plt_copia_leite_deriv ( nr_prescricao_p bigint, nr_prescricao_orig_p bigint, nr_seq_item_p bigint, nr_seq_leite_deriv_p bigint, nr_seq_regra_p bigint, ie_modificar_p text, nm_usuario_p text, cd_perfil_p bigint, cd_estabelecimento_p bigint, ie_estende_inc_p text) FROM PUBLIC;

