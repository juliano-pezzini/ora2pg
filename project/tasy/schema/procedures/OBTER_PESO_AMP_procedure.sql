-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_peso_amp (soma_valores_p bigint, nr_sequencia_p bigint) AS $body$
DECLARE


soma_valores_w	double precision;
qt_peso_corrigido_amp_w	double precision;
qt_peso_ajustado_amp_w	double precision;
qt_peso_habit_w double precision;
qt_peso_ajustado_w double precision;


BEGIN

soma_valores_w := soma_valores_p;

select qt_peso_habit,
	   qt_peso_ajustado
into STRICT   qt_peso_habit_w,
	   qt_peso_ajustado_w
from aval_nutricao_ped
where nr_sequencia = nr_sequencia_p;

qt_peso_corrigido_amp_w := (qt_peso_habit_w * (100 - soma_valores_w))/100;
qt_peso_ajustado_amp_w := ((qt_peso_ajustado_w * 100)/100 - soma_valores_w);

if (qt_peso_corrigido_amp_w IS NOT NULL AND qt_peso_corrigido_amp_w::text <> '' AND qt_peso_ajustado_amp_w IS NOT NULL AND qt_peso_ajustado_amp_w::text <> '') then
	update aval_nutricao_ped
	set qt_peso_habit = qt_peso_habit_w,
		qt_peso_ajustado = qt_peso_ajustado_w
	where nr_sequencia = nr_sequencia_p;
end if;
commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_peso_amp (soma_valores_p bigint, nr_sequencia_p bigint) FROM PUBLIC;

