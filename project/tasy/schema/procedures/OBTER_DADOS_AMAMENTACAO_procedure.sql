-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_dados_amamentacao (nr_atendimento_p bigint, ie_amam_contato_pele_p INOUT text, ie_amam_colostro_p INOUT text, ie_amam_tempo_succao_p INOUT text, ie_primeira_mamada_p INOUT text, ie_momento_mamada_p INOUT text) AS $body$
BEGIN

ie_amam_contato_pele_p	:= '';
ie_amam_colostro_p	:= '';
ie_amam_tempo_succao_p	:= '';
ie_primeira_mamada_p	:= '';
ie_momento_mamada_p	:= '';

SELECT	MAX(SUBSTR(obter_valor_dominio(2947,A.IE_AMAM_CONTATO_PELE),1,255)) ie_amam_contato_pele,
		MAX(SUBSTR(obter_valor_dominio(2948,A.IE_AMAM_COLOSTRO),1,255)) ie_amam_colostro,
		MAX(SUBSTR(obter_valor_dominio(2949,A.IE_AMAM_TEMPO_SUCCAO),1,255)) IE_AMAM_TEMPO_SUCCAO,
		MAX(SUBSTR(obter_valor_dominio(4184,A.IE_PRIMEIRA_MAMADA),1,255)) IE_PRIMEIRA_MAMADA,
		MAX(SUBSTR(obter_valor_dominio(5929,A.IE_MOMENTO_MAMADA),1,255)) IE_MOMENTO_MAMADA
INTO STRICT	ie_amam_contato_pele_p,
		ie_amam_colostro_p,
		ie_amam_tempo_succao_p,
		ie_primeira_mamada_p,
		ie_momento_mamada_p
FROM	nascimento_amamentacao a
WHERE	a.nr_Sequencia = (SELECT 	MAX(b.nr_Sequencia)
			FROM	nascimento_amamentacao b
			WHERE	b.nr_Atendimento = nr_atendimento_p
			AND	coalesce(a.IE_SITUACAO,'A') = 'A');

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_dados_amamentacao (nr_atendimento_p bigint, ie_amam_contato_pele_p INOUT text, ie_amam_colostro_p INOUT text, ie_amam_tempo_succao_p INOUT text, ie_primeira_mamada_p INOUT text, ie_momento_mamada_p INOUT text) FROM PUBLIC;

