-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE ptu_baca_excluir_510_interc () AS $body$
BEGIN

begin -- LOG
delete	FROM ptu_log_fat_baixa_ws		a
where	a.nr_seq_fat_baixa_interc	in (SELECT	c.nr_sequencia
						from	ptu_fatura 		b,
							ptu_fat_baixa_interc	c
						where	b.nr_sequencia	= c.nr_seq_ptu_fatura
						and	coalesce(b.nr_seq_pls_fatura::text, '') = '');
exception
when others then
	null;
end;

begin -- STATUS DO RETORNO
delete	FROM ptu_fat_ret_baixa_status	a
where	a.nr_seq_fat_ret_baixa_dados	in (SELECT	e.nr_sequencia
						from	ptu_fatura 		b,
							ptu_fat_baixa_interc	c,
							ptu_fat_ret_baixa_interc d,
							ptu_fat_ret_baixa_dados	e
						where	b.nr_sequencia	= c.nr_seq_ptu_fatura
						and	c.nr_sequencia	= d.nr_seq_fat_baixa_interc
						and	d.nr_sequencia	= e.nr_seq_fat_ret_baixa
						and	coalesce(b.nr_seq_pls_fatura::text, '') = '');
exception
when others then
	null;
end;

begin -- DADOS RETORNO
delete	FROM ptu_fat_ret_baixa_dados 	a
where	a.nr_seq_fat_ret_baixa	in (SELECT	d.nr_sequencia
					from	ptu_fatura 		b,
						ptu_fat_baixa_interc	c,
						ptu_fat_ret_baixa_interc d
					where	b.nr_sequencia	= c.nr_seq_ptu_fatura
					and	c.nr_sequencia	= d.nr_seq_fat_baixa_interc
					and	coalesce(b.nr_seq_pls_fatura::text, '') = '');
exception
when others then
	null;
end;

begin -- RETORNO
delete	FROM ptu_fat_ret_baixa_interc	a
where	a.nr_seq_fat_baixa_interc	in (SELECT	c.nr_sequencia
						from	ptu_fatura 		b,
							ptu_fat_baixa_interc	c
						where	b.nr_sequencia	= c.nr_seq_ptu_fatura
						and	coalesce(b.nr_seq_pls_fatura::text, '') = '');
exception
when others then
	null;
end;

begin -- DADOS COBRANCA
delete	FROM ptu_fat_baixa_dados	a
where	a.nr_seq_fat_baixa_interc	in (SELECT	c.nr_sequencia
						from	ptu_fatura 		b,
							ptu_fat_baixa_interc	c
						where	b.nr_sequencia	= c.nr_seq_ptu_fatura
						and	coalesce(b.nr_seq_pls_fatura::text, '') = '');
exception
when others then
	null;
end;

begin -- COBRANCA
delete	FROM ptu_fat_baixa_interc	a
where	a.nr_seq_ptu_fatura	in (SELECT	b.nr_sequencia
					from	ptu_fatura b
					where	coalesce(b.nr_seq_pls_fatura::text, '') = '');
exception
when others then
	null;
end;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ptu_baca_excluir_510_interc () FROM PUBLIC;

