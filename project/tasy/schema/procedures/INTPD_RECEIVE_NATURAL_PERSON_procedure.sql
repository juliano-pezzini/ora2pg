-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE intpd_receive_natural_person ( nr_sequencia_p bigint, xml_p xml) AS $body$
DECLARE


_ora2pg_r RECORD;
ie_conversao_w			intpd_eventos_sistema.ie_conversao%type;
nr_seq_projeto_xml_w		intpd_eventos_sistema.nr_seq_projeto_xml%type;
nr_seq_sistema_w		intpd_eventos_sistema.nr_seq_sistema%type;
ie_sistema_externo_w		varchar(15);
reg_integracao_w		gerar_int_padrao.reg_integracao_conv;
nr_seq_regra_w			conversao_meio_externo.nr_seq_regra%type;
ds_erro_w			varchar(4000);
i				integer;

pessoa_fisica_w			pessoa_fisica%rowtype;
compl_pessoa_fisica_w		compl_pessoa_fisica%rowtype;
qt_ant_w			bigint;
ie_atualizou_w			varchar(1) := 'N';

cd_pk_w				pessoa_fisica.cd_sistema_ant%type;

c01 CURSOR FOR
SELECT	*
from	xmltable('/STRUCTURE/PHYSICALPERSON' passing xml_p columns
	ie_action			varchar(15)		path		'IE_ACTION',
	cd_barras_pessoa		varchar(40)		path		'barcode',
	cd_cargo			bigint		path		'position',
	cd_cbo_sus			integer		path		'cbosus',
	cd_cnes				varchar(20)		path		'cnes',
	cd_curp				varchar(18)		path		'curp',
	cd_declaracao_nasc_vivo		varchar(30)		path		'bornalive',
	cd_familia			bigint		path		'family',
	cd_funcionario			varchar(15)		path		'employeecode',
	cd_medico			varchar(10)		path		'medical',
	cd_municipio_ibge		varchar(6)		path		'municipality',
	cd_nacionalidade		varchar(8)		path		'nacionality',
	cd_pessoa_fisica		varchar(10)		path		'code',
	cd_pessoa_mae			varchar(10)		path		'mothercode',
	cd_puericultura			integer		path		'childcare',
	cd_religiao			integer		path		'religion',
	cd_rfc				varchar(13)		path		'rfc',
	cd_sistema_ant			varchar(20)		path		'oldsystem',
	ds_apelido			varchar(60)		path		'nickname',
	ds_categoria_cnh		varchar(30)		path		'cnhcategory',
	ds_codigo_prof			varchar(15)		path		'profissionalcode',
	ds_historico			varchar(4000)		path		'historic',
	ds_municipio_nasc_estrangeiro	varchar(255)		path		'foreignmunicipality',
	ds_observacao			varchar(2000)		path		'observation',
	ds_orgao_emissor_ci		varchar(40)		path		'idissuer',
	ds_profissao			varchar(255)		path		'profession',
	ds_senha			varchar(20)		path		'password',
	dt_admissao_hosp		timestamp			path		'admissiondate',
	dt_adocao			timestamp			path		'adoptiondate',
	dt_chegada_brasil		timestamp			path		'arrivaldate',
	dt_emissao_cert_casamento	timestamp			path		'mariagedate',
	dt_emissao_cert_divorcio	timestamp			path		'divorcedate',
	dt_emissao_cert_nasc		timestamp			path		'borncertifdate',
	dt_emissao_ci			timestamp			path		'idemissiondate',
	dt_emissao_ctps			timestamp			path		'ctpsemissiondate',
	dt_nascimento			timestamp			path		'borndate',
	dt_naturalizacao_pf		timestamp			path		'naturalizationdate',
	dt_obito			timestamp			path		'obitdate',
	dt_primeira_admissao		timestamp			path		'fisrtadmissiondate',
	dt_revisao			timestamp			path		'revisiondate',
	dt_transplante			timestamp			path		'transplantdate',
	dt_validade_rg			timestamp			path		'regvaliditydate',
	dt_vencimento_cnh		timestamp			path		'cnhvaliditydate',
	ie_conselheiro			varchar(15)		path		'adviser',
	ie_dependente			varchar(1)		path		'dependent',
	ie_doador			varchar(15)		path		'donator',
	ie_emancipado			varchar(1)		path		'emancipated',
	ie_estado_civil			varchar(2)		path		'martialstatus',
	ie_fator_rh			varchar(1)		path		'factor',
	ie_fluencia_portugues		varchar(5)		path		'portuguesefluency',
	ie_fornecedor			varchar(1)		path		'supplier',
	ie_frequenta_escola		varchar(1)		path		'schoolfrequency',
	ie_fumante			varchar(1)		path		'smoke',
	ie_funcionario			varchar(1)		path		'employee',
	ie_gemelar			varchar(1)		path		'twin',
	ie_grau_instrucao		smallint		path		'instruction',
	ie_sexo				varchar(1)		path		'sex',
	ie_subtipo_sanguineo		bigint		path		'bloodsubtype',
	ie_tipo_pessoa			smallint		path		'persontype',
	ie_tipo_prontuario		smallint		path		'pronttype',
	ie_tipo_sangue			varchar(2)		path		'bloodtype',
	ie_vegetariano			varchar(15)		path		'vegetarian',
	ie_vinculo_profissional		smallint		path		'professionalcode',
	nm_pessoa_fisica		varchar(60)		path		'name',
	nm_primeiro_nome		varchar(60)		path		'firstname',
	nm_sobrenome_mae		varchar(60)		path		'mothername',
	nm_sobrenome_pai		varchar(60)		path		'fathername',
	nr_cartao_estrangeiro		varchar(30)		path		'foreigncard',
	nr_cartao_nac_sus		varchar(20)		path		'suscard',
	nr_ccm				bigint		path		'ccm',
	nr_cert_casamento		varchar(255)		path		'marriagecert',
	nr_cert_divorcio		varchar(20)		path		'divorcecert',
	nr_certidao_obito		varchar(255)		path		'obitcert',
	nr_cert_militar			varchar(255)		path		'militarcert',
	nr_cert_nasc			varchar(255)		path		'borncert',
	nr_cnh				varchar(255)		path		'cnh',
	nr_cpf				varchar(11)		path		'cpf',
	nr_ctps				bigint		path		'ctps',
	nr_ddd_celular			varchar(3)		path		'cellphoneddd',
	nr_ddi_celular			varchar(3)		path		'cellphoneddi',
	nr_identidade			varchar(15)		path		'id',
	nr_inss				varchar(20)		path		'inss',
	nr_passaporte			varchar(255)		path		'passport',
	nr_pis_pasep			varchar(11)		path		'pispasep',
	nr_prontuario			bigint		path		'handbook',
	nr_reg_geral_estrang		varchar(30)		path		'foreignregistration',
	nr_same				bigint		path		'same',
	nr_secao			varchar(15)		path		'sections',
	nr_seq_cbo_saude		bigint		path		'cbo',
	nr_seq_pais			bigint		path		'country',
	nr_serie_ctps			varchar(10)		path		'ctpsseries',
	nr_telefone_celular		varchar(40)		path		'cellphone',
	nr_titulo_eleitor		varchar(20)		path		'electoralcard',
	nr_transplante			bigint		path		'transplantnumber',
	nr_zona				varchar(5)		path		'electoralward',
	qt_altura_cm			real		path		'height',
	qt_dependente			smallint		path		'dependents',
	qt_peso				real		path		'weight',
	sg_emissora_ci			varchar(2)		path		'idissuerstate',
	uf_emissora_ctps		varchar(15)		path		'ctpsissuerstate',
	xml_complements			xml			path		'Complements');

c01_w	c01%rowtype;

c02 CURSOR FOR
SELECT	*
from	xmltable('/Complements/Complement' passing c01_w.xml_complements columns
	ie_action		varchar(15)		path		'IE_ACTION',
	cd_cep			varchar(15)		path		'zipcod',
	cd_pessoa_fisica	varchar(10)		path		'code',
	ds_bairro		varchar(80)		path		'neighborhood',
	ds_complemento		varchar(40)		path		'complement',
	ds_email		varchar(255)		path		'email',
	ds_endereco		varchar(100)		path		'address',
	ds_fone_adic		varchar(80)		path		'aditionalphone',
	ds_municipio		varchar(40)		path		'municipality',
	ds_observacao		varchar(2000)		path		'observation',
	ds_website		varchar(255)		path		'website',
	ie_tipo_complemento	smallint		path		'complementtype',
	nm_contato		varchar(60)		path		'contact',
	nr_ddd_celular		varchar(3)		path		'cellphoneddd',
	nr_ddd_fax		varchar(3)		path		'faxddd',
	nr_ddd_fone_adic	varchar(3)		path		'aditionalphoneddd',
	nr_ddd_telefone		varchar(3)		path		'phoneddd',
	nr_ddi_celular		varchar(3)		path		'cellphoneddi',
	nr_ddi_fax		varchar(3)		path		'faxddi',
	nr_ddi_fone_adic	varchar(3)		path		'aditionalphoneddi',
	nr_ddi_telefone		varchar(3)		path		'phoneddi',
	nr_endereco		integer		path		'addressnumber',
	nr_ramal		integer		path		'branch',
	nr_seq_pais		bigint		path		'country',
	nr_telefone		varchar(15)		path		'phonenumber',
	nr_telefone_celular	varchar(40)		path		'cellphonenumber',
	sg_estado		varchar(15)		path		'states');

c02_w	c02%rowtype;


BEGIN
update	intpd_fila_transmissao
set	ie_status = 'R'
where	nr_sequencia = nr_sequencia_p;

commit;

begin
select	coalesce(b.ie_conversao,'I'),
	nr_seq_sistema,
	nr_seq_projeto_xml,
	nr_seq_regra_conv
into STRICT	ie_conversao_w,
	nr_seq_sistema_w,
	nr_seq_projeto_xml_w,
	nr_seq_regra_w
from	intpd_fila_transmissao a,
	intpd_eventos_sistema b
where	a.nr_seq_evento_sistema = b.nr_sequencia
and	a.nr_sequencia = nr_sequencia_p;

ie_sistema_externo_w	:=	nr_seq_sistema_w;

reg_integracao_w.nr_seq_fila_transmissao	:=	nr_sequencia_p;
reg_integracao_w.ie_envio_recebe		:=	'R';
reg_integracao_w.ie_sistema_externo		:=	ie_sistema_externo_w;
reg_integracao_w.ie_conversao			:=	ie_conversao_w;
reg_integracao_w.nr_seq_projeto_xml		:=	nr_seq_projeto_xml_w;
reg_integracao_w.nr_seq_regra_conversao		:=	nr_seq_regra_w;
reg_integracao_w.intpd_log_receb.delete;
reg_integracao_w.qt_reg_log			:=	0;

open c01;
loop
fetch c01 into
	c01_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
	begin
	reg_integracao_w.nm_tabela		:=	'PESSOA_FISICA';
	reg_integracao_w.nm_elemento		:=	'PHYSICALPERSON';
	reg_integracao_w.nr_seq_visao		:=	0;

	if (coalesce(c01_w.ie_action,'INSERT') <> 'DELETE') THEN
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_BARRAS_PESSOA', c01_w.cd_barras_pessoa, 'N', pessoa_fisica_w.cd_barras_pessoa) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.cd_barras_pessoa := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CARGO', c01_w.CD_CARGO, 'S', pessoa_fisica_w.CD_CARGO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_CARGO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CBO_SUS', c01_w.CD_CBO_SUS, 'S', pessoa_fisica_w.CD_CBO_SUS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_CBO_SUS := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CNES', c01_w.CD_CNES, 'N', pessoa_fisica_w.CD_CNES) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_CNES := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CURP', c01_w.CD_CURP, 'N', pessoa_fisica_w.CD_CURP) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_CURP := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_DECLARACAO_NASC_VIVO', c01_w.CD_DECLARACAO_NASC_VIVO, 'N', pessoa_fisica_w.CD_DECLARACAO_NASC_VIVO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_DECLARACAO_NASC_VIVO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_FAMILIA', c01_w.CD_FAMILIA, 'N', pessoa_fisica_w.CD_FAMILIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_FAMILIA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_FUNCIONARIO', c01_w.CD_FUNCIONARIO, 'N', pessoa_fisica_w.CD_FUNCIONARIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_FUNCIONARIO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_MEDICO', c01_w.CD_MEDICO, 'S', pessoa_fisica_w.CD_MEDICO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_MEDICO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_MUNICIPIO_IBGE', c01_w.CD_MUNICIPIO_IBGE, 'S', pessoa_fisica_w.CD_MUNICIPIO_IBGE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_MUNICIPIO_IBGE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_NACIONALIDADE', c01_w.CD_NACIONALIDADE, 'S', pessoa_fisica_w.CD_NACIONALIDADE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_NACIONALIDADE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PESSOA_MAE', c01_w.CD_PESSOA_MAE, 'S', pessoa_fisica_w.CD_PESSOA_MAE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_PESSOA_MAE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PUERICULTURA,', c01_w.CD_PUERICULTURA, 'N', pessoa_fisica_w.CD_PUERICULTURA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_PUERICULTURA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_RELIGIAO', c01_w.CD_RELIGIAO, 'N', pessoa_fisica_w.CD_RELIGIAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_RELIGIAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_RFC', c01_w.CD_RFC, 'N', pessoa_fisica_w.CD_RFC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_RFC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_SISTEMA_ANT', c01_w.CD_SISTEMA_ANT, 'N', pessoa_fisica_w.CD_SISTEMA_ANT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.CD_SISTEMA_ANT := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_APELIDO', c01_w.DS_APELIDO, 'N', pessoa_fisica_w.DS_APELIDO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DS_APELIDO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_CATEGORIA_CNH', c01_w.DS_CATEGORIA_CNH, 'N', pessoa_fisica_w.DS_CATEGORIA_CNH) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DS_CATEGORIA_CNH := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_CODIGO_PROF', c01_w.DS_CODIGO_PROF, 'N', pessoa_fisica_w.DS_CODIGO_PROF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DS_CODIGO_PROF := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_HISTORICO', c01_w.DS_HISTORICO, 'N', pessoa_fisica_w.DS_HISTORICO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DS_HISTORICO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_MUNICIPIO_NASC_ESTRANGEIRO', c01_w.DS_MUNICIPIO_NASC_ESTRANGEIRO, 'N', pessoa_fisica_w.DS_MUNICIPIO_NASC_ESTRANGEIRO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DS_MUNICIPIO_NASC_ESTRANGEIRO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_OBSERVACAO', c01_w.DS_OBSERVACAO, 'N', pessoa_fisica_w.DS_OBSERVACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DS_OBSERVACAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_ORGAO_EMISSOR_CI', c01_w.DS_ORGAO_EMISSOR_CI, 'N', pessoa_fisica_w.DS_ORGAO_EMISSOR_CI) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DS_ORGAO_EMISSOR_CI := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_PROFISSAO', c01_w.DS_PROFISSAO, 'N', pessoa_fisica_w.DS_PROFISSAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DS_PROFISSAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_SENHA', c01_w.DS_SENHA, 'N', pessoa_fisica_w.DS_SENHA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DS_SENHA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_ADMISSAO_HOSP', c01_w.DT_ADMISSAO_HOSP, 'N', pessoa_fisica_w.DT_ADMISSAO_HOSP) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_ADMISSAO_HOSP := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_ADOCAO', c01_w.DT_ADOCAO, 'N', pessoa_fisica_w.DT_ADOCAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_ADOCAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_CHEGADA_BRASIL', c01_w.DT_CHEGADA_BRASIL, 'N', pessoa_fisica_w.DT_CHEGADA_BRASIL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_CHEGADA_BRASIL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_EMISSAO_CERT_CASAMENTO', c01_w.DT_EMISSAO_CERT_CASAMENTO, 'N', pessoa_fisica_w.DT_EMISSAO_CERT_CASAMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_EMISSAO_CERT_CASAMENTO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_EMISSAO_CERT_DIVORCIO', c01_w.DT_EMISSAO_CERT_DIVORCIO, 'N', pessoa_fisica_w.DT_EMISSAO_CERT_DIVORCIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_EMISSAO_CERT_DIVORCIO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_EMISSAO_CERT_NASC', c01_w.DT_EMISSAO_CERT_NASC, 'N', pessoa_fisica_w.DT_EMISSAO_CERT_NASC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_EMISSAO_CERT_NASC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_EMISSAO_CI', c01_w.DT_EMISSAO_CI, 'N', pessoa_fisica_w.DT_EMISSAO_CI) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_EMISSAO_CI := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_EMISSAO_CTPS', c01_w.DT_EMISSAO_CTPS, 'N', pessoa_fisica_w.DT_EMISSAO_CTPS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_EMISSAO_CTPS := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_NASCIMENTO', c01_w.DT_NASCIMENTO, 'N', pessoa_fisica_w.DT_NASCIMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_NASCIMENTO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_NATURALIZACAO_PF', c01_w.DT_NATURALIZACAO_PF, 'N', pessoa_fisica_w.DT_NATURALIZACAO_PF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_NATURALIZACAO_PF := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_OBITO', c01_w.DT_OBITO, 'N', pessoa_fisica_w.DT_OBITO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_OBITO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_PRIMEIRA_ADMISSAO', c01_w.DT_PRIMEIRA_ADMISSAO, 'N', pessoa_fisica_w.DT_PRIMEIRA_ADMISSAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_PRIMEIRA_ADMISSAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_REVISAO', c01_w.DT_REVISAO, 'N', pessoa_fisica_w.DT_REVISAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_REVISAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_TRANSPLANTE', c01_w.DT_TRANSPLANTE, 'N', pessoa_fisica_w.DT_TRANSPLANTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_TRANSPLANTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_VALIDADE_RG', c01_w.DT_VALIDADE_RG, 'N', pessoa_fisica_w.DT_VALIDADE_RG) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_VALIDADE_RG := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_VENCIMENTO_CNH', c01_w.DT_VENCIMENTO_CNH, 'N', pessoa_fisica_w.DT_VENCIMENTO_CNH) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.DT_VENCIMENTO_CNH := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_CONSELHEIRO', c01_w.IE_CONSELHEIRO, 'N', pessoa_fisica_w.IE_CONSELHEIRO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_CONSELHEIRO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_DEPENDENTE', c01_w.IE_DEPENDENTE, 'N', pessoa_fisica_w.IE_DEPENDENTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_DEPENDENTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_DOADOR', c01_w.IE_DOADOR, 'N', pessoa_fisica_w.IE_DOADOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_DOADOR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_EMANCIPADO', c01_w.IE_EMANCIPADO, 'N', pessoa_fisica_w.IE_EMANCIPADO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_EMANCIPADO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_ESTADO_CIVIL', c01_w.IE_ESTADO_CIVIL, 'N', pessoa_fisica_w.IE_ESTADO_CIVIL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_ESTADO_CIVIL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_FATOR_RH', c01_w.IE_FATOR_RH, 'N', pessoa_fisica_w.IE_FATOR_RH) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_FATOR_RH := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_FLUENCIA_PORTUGUES', c01_w.IE_FLUENCIA_PORTUGUES, 'N', pessoa_fisica_w.IE_FLUENCIA_PORTUGUES) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_FLUENCIA_PORTUGUES := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_FORNECEDOR', c01_w.IE_FORNECEDOR, 'N', pessoa_fisica_w.IE_FORNECEDOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_FORNECEDOR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_FREQUENTA_ESCOLA', c01_w.IE_FREQUENTA_ESCOLA, 'N', pessoa_fisica_w.IE_FREQUENTA_ESCOLA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_FREQUENTA_ESCOLA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_FUMANTE', c01_w.IE_FUMANTE, 'N', pessoa_fisica_w.IE_FUMANTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_FUMANTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_FUNCIONARIO', c01_w.IE_FUNCIONARIO, 'N', pessoa_fisica_w.IE_FUNCIONARIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_FUNCIONARIO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_GEMELAR', c01_w.IE_GEMELAR, 'N', pessoa_fisica_w.IE_GEMELAR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_GEMELAR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_GRAU_INSTRUCAO', c01_w.IE_GRAU_INSTRUCAO, 'N', pessoa_fisica_w.IE_GRAU_INSTRUCAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_GRAU_INSTRUCAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_SEXO', c01_w.IE_SEXO, 'N', pessoa_fisica_w.IE_SEXO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_SEXO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_SUBTIPO_SANGUINEO', c01_w.IE_SUBTIPO_SANGUINEO, 'S', pessoa_fisica_w.IE_SUBTIPO_SANGUINEO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_SUBTIPO_SANGUINEO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TIPO_PESSOA', c01_w.IE_TIPO_PESSOA, 'N', pessoa_fisica_w.IE_TIPO_PESSOA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_TIPO_PESSOA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TIPO_PRONTUARIO', c01_w.IE_TIPO_PRONTUARIO, 'N', pessoa_fisica_w.IE_TIPO_PRONTUARIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_TIPO_PRONTUARIO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TIPO_SANGUE', c01_w.IE_TIPO_SANGUE, 'N', pessoa_fisica_w.IE_TIPO_SANGUE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_TIPO_SANGUE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_VEGETARIANO', c01_w.IE_VEGETARIANO, 'N', pessoa_fisica_w.IE_VEGETARIANO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_VEGETARIANO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_VINCULO_PROFISSIONAL', c01_w.IE_VINCULO_PROFISSIONAL, 'N', pessoa_fisica_w.IE_VINCULO_PROFISSIONAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.IE_VINCULO_PROFISSIONAL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_PESSOA_FISICA', c01_w.NM_PESSOA_FISICA, 'N', pessoa_fisica_w.NM_PESSOA_FISICA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NM_PESSOA_FISICA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_PRIMEIRO_NOME', c01_w.NM_PRIMEIRO_NOME, 'N', pessoa_fisica_w.NM_PRIMEIRO_NOME) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NM_PRIMEIRO_NOME := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_SOBRENOME_MAE', c01_w.NM_SOBRENOME_MAE, 'N', pessoa_fisica_w.NM_SOBRENOME_MAE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NM_SOBRENOME_MAE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_SOBRENOME_PAI', c01_w.NM_SOBRENOME_PAI, 'N', pessoa_fisica_w.NM_SOBRENOME_PAI) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NM_SOBRENOME_PAI := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CARTAO_ESTRANGEIRO', c01_w.NR_CARTAO_ESTRANGEIRO, 'N', pessoa_fisica_w.NR_CARTAO_ESTRANGEIRO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_CARTAO_ESTRANGEIRO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CARTAO_NAC_SUS', c01_w.NR_CARTAO_NAC_SUS, 'N', pessoa_fisica_w.NR_CARTAO_NAC_SUS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_CARTAO_NAC_SUS := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CCM', c01_w.NR_CCM, 'N', pessoa_fisica_w.NR_CCM) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_CCM := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CERT_CASAMENTO', c01_w.NR_CERT_CASAMENTO, 'N', pessoa_fisica_w.NR_CERT_CASAMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_CERT_CASAMENTO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CERT_DIVORCIO', c01_w.NR_CERT_DIVORCIO, 'N', pessoa_fisica_w.NR_CERT_DIVORCIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_CERT_DIVORCIO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CERTIDAO_OBITO', c01_w.NR_CERTIDAO_OBITO, 'N', pessoa_fisica_w.NR_CERTIDAO_OBITO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_CERTIDAO_OBITO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CERT_MILITAR', c01_w.NR_CERT_MILITAR, 'N', pessoa_fisica_w.NR_CERT_MILITAR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_CERT_MILITAR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CERT_NASC', c01_w.NR_CERT_NASC, 'N', pessoa_fisica_w.NR_CERT_NASC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_CERT_NASC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CNH', c01_w.NR_CNH, 'N', pessoa_fisica_w.NR_CNH) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_CNH := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CPF', c01_w.NR_CPF, 'N', pessoa_fisica_w.NR_CPF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_CPF := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CTPS', c01_w.NR_CTPS, 'N', pessoa_fisica_w.NR_CTPS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_CTPS := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDD_CELULAR', c01_w.NR_DDD_CELULAR, 'N', pessoa_fisica_w.NR_DDD_CELULAR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_DDD_CELULAR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDI_CELULAR', c01_w.NR_DDI_CELULAR, 'N', pessoa_fisica_w.NR_DDI_CELULAR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_DDI_CELULAR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_IDENTIDADE', c01_w.NR_IDENTIDADE, 'N', pessoa_fisica_w.NR_IDENTIDADE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_IDENTIDADE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_INSS', c01_w.NR_INSS, 'N', pessoa_fisica_w.NR_INSS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_INSS := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_PASSAPORTE', c01_w.NR_PASSAPORTE, 'N', pessoa_fisica_w.NR_PASSAPORTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_PASSAPORTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_PIS_PASEP', c01_w.NR_PIS_PASEP, 'N', pessoa_fisica_w.NR_PIS_PASEP) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_PIS_PASEP := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_PRONTUARIO', c01_w.NR_PRONTUARIO, 'N', pessoa_fisica_w.NR_PRONTUARIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_PRONTUARIO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_REG_GERAL_ESTRANG', c01_w.NR_REG_GERAL_ESTRANG, 'N', pessoa_fisica_w.NR_REG_GERAL_ESTRANG) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_REG_GERAL_ESTRANG := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SAME', c01_w.NR_SAME, 'N', pessoa_fisica_w.NR_SAME) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_SAME := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SECAO', c01_w.NR_SECAO, 'N', pessoa_fisica_w.NR_SECAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_SECAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CBO_SAUDE', c01_w.NR_SEQ_CBO_SAUDE, 'S', pessoa_fisica_w.NR_SEQ_CBO_SAUDE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_SEQ_CBO_SAUDE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_PAIS', c01_w.NR_SEQ_PAIS, 'S', pessoa_fisica_w.NR_SEQ_PAIS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_SEQ_PAIS := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SERIE_CTPS', c01_w.NR_SERIE_CTPS, 'N', pessoa_fisica_w.NR_SERIE_CTPS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_SERIE_CTPS := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_TELEFONE_CELULAR', c01_w.NR_TELEFONE_CELULAR, 'N', pessoa_fisica_w.NR_TELEFONE_CELULAR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_TELEFONE_CELULAR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_TITULO_ELEITOR', c01_w.NR_TITULO_ELEITOR, 'N', pessoa_fisica_w.NR_TITULO_ELEITOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_TITULO_ELEITOR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_TRANSPLANTE', c01_w.NR_TRANSPLANTE, 'N', pessoa_fisica_w.NR_TRANSPLANTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_TRANSPLANTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_ZONA', c01_w.NR_ZONA, 'N', pessoa_fisica_w.NR_ZONA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.NR_ZONA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_ALTURA_CM', c01_w.QT_ALTURA_CM, 'N', pessoa_fisica_w.QT_ALTURA_CM) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.QT_ALTURA_CM := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_DEPENDENTE', c01_w.QT_DEPENDENTE, 'N', pessoa_fisica_w.QT_DEPENDENTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.QT_DEPENDENTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_PESO', c01_w.QT_PESO, 'N', pessoa_fisica_w.QT_PESO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.QT_PESO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'SG_EMISSORA_CI', c01_w.SG_EMISSORA_CI, 'N', pessoa_fisica_w.SG_EMISSORA_CI) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.SG_EMISSORA_CI := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'UF_EMISSORA_CTPS', c01_w.UF_EMISSORA_CTPS, 'N', pessoa_fisica_w.UF_EMISSORA_CTPS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.UF_EMISSORA_CTPS := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'UF_EMISSORA_CTPS', c01_w.UF_EMISSORA_CTPS, 'N', pessoa_fisica_w.UF_EMISSORA_CTPS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_fisica_w.UF_EMISSORA_CTPS := _ora2pg_r.ds_valor_retorno_p;
		pessoa_fisica_w.nm_usuario	:= 'TASY';
		pessoa_fisica_w.dt_atualizacao	:= clock_timestamp();

		if (coalesce(pessoa_fisica_w.IE_TIPO_PESSOA::text, '') = '') then
			pessoa_fisica_w.IE_TIPO_PESSOA	:= 1;
		end if;

		if (reg_integracao_w.qt_reg_log = 0) then
			select	coalesce(max(cd_pessoa_fisica),0)
			into STRICT	pessoa_fisica_w.cd_pessoa_fisica
			from	pessoa_fisica
			where	cd_sistema_ant	= pessoa_fisica_w.cd_sistema_ant  LIMIT 1;

			if (pessoa_fisica_w.cd_pessoa_fisica > 0) then
				update	pessoa_fisica
				set	row = pessoa_fisica_w
				where	cd_pessoa_fisica = pessoa_fisica_w.cd_pessoa_fisica;
			else
				select	nextval('pessoa_fisica_seq')
				into STRICT	pessoa_fisica_w.cd_pessoa_fisica
				;

				insert into pessoa_fisica values (pessoa_fisica_w.*);

				/*'Registra a conversão que poderá ser utilizada em outros pontos de integração e para somente atualizar (update) num recebimento futuro do mesmo registro.'*/

				CALL gerar_conv_meio_externo(null, 'PESSOA_FISICA', 'CD_PESSOA_FISICA', pessoa_fisica_w.cd_pessoa_fisica, c01_w.cd_pessoa_fisica, null, nr_seq_regra_w, 'A', pessoa_fisica_w.nm_usuario);
			end if;

			ie_atualizou_w	:= 'S';
		end if;
	else
		select	coalesce(max(cd_pessoa_fisica),0)
		into STRICT	pessoa_fisica_w.cd_pessoa_fisica
		from	pessoa_fisica
		where	cd_sistema_ant	= pessoa_fisica_w.cd_sistema_ant  LIMIT 1;

		delete	FROM pessoa_fisica
		where	cd_pessoa_fisica = pessoa_fisica_w.cd_pessoa_fisica;

		ie_atualizou_w	:= 'S';
	end if;

	if (ie_atualizou_w = 'S')	then
		update	intpd_fila_transmissao
		set	ie_status		= 'S',
			nr_seq_documento	= pessoa_fisica_w.cd_pessoa_fisica
		where	nr_sequencia		= nr_sequencia_p;
	end if;

	open c02;
	loop
	fetch c02 into
		c02_w;
	EXIT WHEN NOT FOUND; /* apply on c02 */
		begin
		reg_integracao_w.nm_tabela		:=	'COMPL_PESSOA_FISICA';
		reg_integracao_w.nm_elemento		:=	'COMPLEMENTS';
		reg_integracao_w.nr_seq_visao		:=	0;

		compl_pessoa_fisica_w.cd_pessoa_fisica	:= pessoa_fisica_w.cd_pessoa_fisica;

		if (coalesce(c02_w.ie_action,'INSERT') <> 'DELETE') THEN
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CEP', c02_w.CD_CEP, 'S', compl_pessoa_fisica_w.CD_CEP) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.CD_CEP := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_BAIRRO', c02_w.DS_BAIRRO, 'S', compl_pessoa_fisica_w.DS_BAIRRO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.DS_BAIRRO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_COMPLEMENTO', c02_w.DS_COMPLEMENTO, 'S', compl_pessoa_fisica_w.DS_COMPLEMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.DS_COMPLEMENTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_EMAIL', c02_w.DS_EMAIL, 'S', compl_pessoa_fisica_w.DS_EMAIL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.DS_EMAIL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_ENDERECO', c02_w.DS_ENDERECO, 'S', compl_pessoa_fisica_w.DS_ENDERECO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.DS_ENDERECO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_FONE_ADIC', c02_w.DS_FONE_ADIC, 'S', compl_pessoa_fisica_w.DS_FONE_ADIC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.DS_FONE_ADIC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_MUNICIPIO', c02_w.DS_MUNICIPIO, 'S', compl_pessoa_fisica_w.DS_MUNICIPIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.DS_MUNICIPIO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_OBSERVACAO', c02_w.DS_OBSERVACAO, 'S', compl_pessoa_fisica_w.DS_OBSERVACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.DS_OBSERVACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_WEBSITE', c02_w.DS_WEBSITE, 'S', compl_pessoa_fisica_w.DS_WEBSITE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.DS_WEBSITE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TIPO_COMPLEMENTO', c02_w.IE_TIPO_COMPLEMENTO, 'S', compl_pessoa_fisica_w.IE_TIPO_COMPLEMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.IE_TIPO_COMPLEMENTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_CONTATO', c02_w.NM_CONTATO, 'S', compl_pessoa_fisica_w.NM_CONTATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NM_CONTATO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDD_CELULAR', c02_w.NR_DDD_CELULAR, 'S', compl_pessoa_fisica_w.NR_DDD_CELULAR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NR_DDD_CELULAR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDD_FAX', c02_w.NR_DDD_FAX, 'S', compl_pessoa_fisica_w.NR_DDD_FAX) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NR_DDD_FAX := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDD_FONE_ADIC', c02_w.NR_DDD_FONE_ADIC, 'S', compl_pessoa_fisica_w.NR_DDD_FONE_ADIC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NR_DDD_FONE_ADIC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDD_TELEFONE', c02_w.NR_DDD_TELEFONE, 'S', compl_pessoa_fisica_w.NR_DDD_TELEFONE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NR_DDD_TELEFONE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDI_CELULAR', c02_w.NR_DDI_CELULAR, 'S', compl_pessoa_fisica_w.NR_DDI_CELULAR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NR_DDI_CELULAR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDI_FAX', c02_w.NR_DDI_FAX, 'S', compl_pessoa_fisica_w.NR_DDI_FAX) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NR_DDI_FAX := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDI_FONE_ADIC', c02_w.NR_DDI_FONE_ADIC, 'S', compl_pessoa_fisica_w.NR_DDI_FONE_ADIC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NR_DDI_FONE_ADIC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDI_TELEFONE', c02_w.NR_DDI_TELEFONE, 'S', compl_pessoa_fisica_w.NR_DDI_TELEFONE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NR_DDI_TELEFONE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_ENDERECO', c02_w.NR_ENDERECO, 'S', compl_pessoa_fisica_w.NR_ENDERECO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NR_ENDERECO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_RAMAL', c02_w.NR_RAMAL, 'S', compl_pessoa_fisica_w.NR_RAMAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NR_RAMAL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_PAIS', c02_w.NR_SEQ_PAIS, 'S', compl_pessoa_fisica_w.NR_SEQ_PAIS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NR_SEQ_PAIS := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_TELEFONE', c02_w.NR_TELEFONE, 'S', compl_pessoa_fisica_w.NR_TELEFONE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NR_TELEFONE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_TELEFONE_CELULAR', c02_w.NR_TELEFONE_CELULAR, 'S', compl_pessoa_fisica_w.NR_TELEFONE_CELULAR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.NR_TELEFONE_CELULAR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'SG_ESTADO', c02_w.SG_ESTADO, 'S', compl_pessoa_fisica_w.SG_ESTADO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; compl_pessoa_fisica_w.SG_ESTADO := _ora2pg_r.ds_valor_retorno_p;
			compl_pessoa_fisica_w.nm_usuario	:= 'TASY';
			compl_pessoa_fisica_w.dt_atualizacao	:= clock_timestamp();

			select	coalesce(max(nr_sequencia),0)
			into STRICT	qt_ant_w
			from	compl_pessoa_fisica
			where	ie_tipo_complemento	= compl_pessoa_fisica_w.IE_TIPO_COMPLEMENTO
			and	cd_pessoa_fisica	= compl_pessoa_fisica_w.cd_pessoa_fisica  LIMIT 1;

			if (qt_ant_w > 0) then
				compl_pessoa_fisica_w.nr_sequencia := qt_ant_w;

				update	compl_pessoa_fisica
				set	row = compl_pessoa_fisica_w
				where	ie_tipo_complemento	= compl_pessoa_fisica_w.IE_TIPO_COMPLEMENTO
				and	cd_pessoa_fisica	= compl_pessoa_fisica_w.cd_pessoa_fisica;
			else
				select	coalesce(max(nr_sequencia),0) + 1
				into STRICT	compl_pessoa_fisica_w.nr_sequencia
				from	compl_pessoa_fisica
				where	ie_tipo_complemento	= compl_pessoa_fisica_w.IE_TIPO_COMPLEMENTO
				and	cd_pessoa_fisica	= compl_pessoa_fisica_w.cd_pessoa_fisica;

				insert into compl_pessoa_fisica values (compl_pessoa_fisica_w.*);
			end if;
		else
			delete	FROM compl_pessoa_fisica
			where	ie_tipo_complemento	= compl_pessoa_fisica_w.IE_TIPO_COMPLEMENTO
			and	cd_pessoa_fisica	= compl_pessoa_fisica_w.cd_pessoa_fisica;
		end if;
		end;
	end loop;
	close c02;
	end;
end loop;
close c01;
exception
when others then
	begin
	ds_erro_w	:=	substr(sqlerrm,1,4000);
	rollback;
	update	intpd_fila_transmissao
	set	ie_status = 'E',
		ds_log = ds_erro_w
	where	nr_sequencia = nr_sequencia_p;
	end;
end;

if (reg_integracao_w.qt_reg_log > 0) then
	begin
	rollback;

	update	intpd_fila_transmissao
	set	ie_status = 'E',
		ds_log = ds_erro_w
	where	nr_sequencia = nr_sequencia_p;

	for i in 0..reg_integracao_w.qt_reg_log-1 loop
		intpd_gravar_log_recebimento(nr_sequencia_p,reg_integracao_w.intpd_log_receb[i].ds_log,'INTPDTASY');
	end loop;
	end;
end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE intpd_receive_natural_person ( nr_sequencia_p bigint, xml_p xml) FROM PUBLIC;

