-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE duplicar_tratamento_radio (nr_seq_tratamento_p bigint) AS $body$
DECLARE


nr_seq_volume_trat_w    rxt_volume_tratamento.nr_sequencia%type;
nr_seq_fase_trat_w      rxt_fase_tratamento.nr_sequencia%type;
nr_seq_campo_w          rxt_campo.nr_sequencia%type;
nr_seq_acess_pac_w      rxt_acessorio_pac.nr_sequencia%type;
nr_seq_braq_aplic_w     rxt_braq_aplic_trat.nr_sequencia%type;
nr_seq_braq_campo_w     rxt_braq_campo_aplic_trat.nr_sequencia%type;
nr_seq_campo_roent_w    rxt_campo_trat_roentgen.nr_sequencia%type;
nr_seq_aplic_roent_w    rxt_aplic_trat_roentgen.nr_sequencia%type;

nr_seq_volume_trat_copia_w    rxt_volume_tratamento.nr_sequencia%type;
nr_seq_tratamento_copia_w     rxt_tratamento.nr_sequencia%type;
nr_seq_fase_trat_copia_w      rxt_fase_tratamento.nr_sequencia%type;
nr_seq_campo_copia_w          rxt_campo.nr_sequencia%type;
nr_seq_acess_pac_copia_w      rxt_acessorio.nr_sequencia%type;
nr_seq_medida_pac_copia_w     rxt_medida_acessorio.nr_sequencia%type;
nr_seq_braq_aplic_copia_w     rxt_braq_aplic_trat.nr_sequencia%type;
nr_seq_trat_oar_copia_w       rxt_tratamento_oar.nr_sequencia%type;
nr_seq_tecnica_copia_w        rxt_tecnica.nr_sequencia%type;
nr_seq_planej_braq_copia_w    rxt_plan_braqui_fisico.nr_sequencia%type;
nr_seq_campo_roent_copia_w    rxt_campo_trat_roentgen.nr_sequencia%type;
nr_seq_planej_fisico_copia_w  rxt_planejamento_fisico.nr_sequencia%type;

volume_tratamento CURSOR FOR
SELECT nr_sequencia
from rxt_volume_tratamento
where nr_seq_tratamento = nr_seq_tratamento_p;

campo_trat_roentgen CURSOR FOR
SELECT nr_sequencia
from rxt_campo_trat_roentgen
where nr_seq_tratamento = nr_seq_volume_trat_w;

aplic_trat_roentgen CURSOR FOR
SELECT nr_sequencia
from rxt_aplic_trat_roentgen
where nr_seq_campo_trat = nr_seq_campo_roent_w;

fase_tratamento CURSOR FOR
SELECT nr_sequencia
from rxt_fase_tratamento
where nr_seq_volume_tratamento = nr_seq_volume_trat_w;

planejamento_fisico CURSOR FOR
SELECT nr_sequencia
from rxt_planejamento_fisico
where nr_seq_fase = nr_seq_fase_trat_w;

campo CURSOR FOR
SELECT nr_sequencia
from rxt_campo
where nr_seq_fase = nr_seq_fase_trat_w;

acessorio_pac CURSOR FOR
SELECT nr_sequencia
from rxt_acessorio_pac
where nr_seq_campo = nr_seq_campo_w;

medida_acessorio_pac CURSOR FOR
SELECT nr_sequencia
from rxt_medida_acessorio_pac
where nr_seq_acessorio = nr_seq_acess_pac_w;

braq_aplic_trat CURSOR FOR
SELECT nr_sequencia
from rxt_braq_aplic_trat
where nr_seq_tratamento = nr_seq_tratamento_p;

braq_campo_aplic_trat CURSOR FOR
SELECT nr_sequencia
from rxt_braq_campo_aplic_trat
where nr_seq_aplic_trat = nr_seq_braq_aplic_w;

plan_braqui_fisico CURSOR FOR
SELECT nr_sequencia
from rxt_plan_braqui_fisico
where nr_seq_braq_aplic_trat = nr_seq_braq_aplic_w;

tratamento_oar CURSOR FOR
SELECT nr_sequencia
from rxt_tratamento_oar
where nr_seq_tratamento = nr_seq_tratamento_p;

tecnica CURSOR FOR
SELECT nr_sequencia
from rxt_tecnica
where nr_seq_tratamento = nr_seq_tratamento_p;

acessorio_pac_manual CURSOR FOR
SELECT nr_sequencia
from rxt_acessorio_pac
where nr_seq_tratamento = nr_seq_tratamento_p
and coalesce(nr_seq_campo::text, '') = '';

fase_tratamento_manual CURSOR FOR
SELECT nr_sequencia
from rxt_fase_tratamento
where nr_seq_tratamento = nr_seq_tratamento_p
and coalesce(nr_seq_volume_tratamento::text, '') = '';

campo_trat_roentgen_manual CURSOR FOR
SELECT nr_sequencia
from rxt_campo_trat_roentgen
where nr_seq_tratamento = nr_seq_tratamento_p;

procedure tratamento_insert(nr_seq_tratamento_copia_int_p    bigint,
                                nr_seq_tratamento_int_p      bigint) is;
BEGIN
   insert into rxt_tratamento(
        nr_sequencia,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        dt_atualizacao,
        nm_usuario,
        nr_seq_tumor,
        dt_inicio_trat,
        qt_duracao_trat,
        qt_dose_total,
        qt_dose_fracao,
        qt_ptv,
        qt_gtv,
        qt_ctv,
        nr_insercoes,
        nr_seq_protocolo,
        nm_usuario_cancelamento,
        dt_cancelamento,
        nr_seq_motivo_canc,
        ds_just_cancelamento,
        qt_check_film,
        ds_observacao,
        nr_seq_motivo,
        nr_seq_controle_interno,
        nr_seq_modalidade,
        dt_avaliacao,
        dt_braquiterapia,
        dt_reabertura,
        nm_usuario_reab,
        dt_suspensao,
        nm_usuario_susp,
        ds_just_suspensao,
        nr_seq_motivo_susp,
        dt_liberacao,
        nm_usuario_lib,
        ie_altera_duracao,
        nm_usuario_desf_lib,
        dt_desf_lib,
        ie_horario_dif,
        nr_seq_equipamento,
        ie_replanejamento,
        nr_seq_atend_cons_pepa,
        ie_checkfilm_done,
        ie_necessita_bloco,
        ie_necessita_qa,
        ie_qa_registrado,
        ie_ficha_realizada,
        ie_bloco_concluido)
        SELECT	
        nr_seq_tratamento_copia_int_p,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        nr_seq_tumor,
        dt_inicio_trat,
        qt_duracao_trat,
        qt_dose_total,
        qt_dose_fracao,
        qt_ptv,
        qt_gtv,
        qt_ctv,
        nr_insercoes,
        nr_seq_protocolo,
        nm_usuario_cancelamento,
        dt_cancelamento,
        nr_seq_motivo_canc,
        ds_just_cancelamento,
        qt_check_film,
        ds_observacao,
        nr_seq_motivo,
        nr_seq_controle_interno,
        nr_seq_modalidade,
        dt_avaliacao,
        dt_braquiterapia,
        dt_reabertura,
        nm_usuario_reab,
        dt_suspensao,
        nm_usuario_susp,
        ds_just_suspensao,
        nr_seq_motivo_susp,
        dt_liberacao,
        nm_usuario_lib,
        ie_altera_duracao,
        nm_usuario_desf_lib,
        dt_desf_lib,
        ie_horario_dif,
        nr_seq_equipamento,
        ie_replanejamento,
        nr_seq_atend_cons_pepa,
        ie_checkfilm_done,
        ie_necessita_bloco,
        ie_necessita_qa,
        ie_qa_registrado,
        ie_ficha_realizada,
        ie_bloco_concluido
    from	rxt_tratamento
    where	nr_sequencia = nr_seq_tratamento_int_p;

end;

procedure volume_tratamento_insert(nr_seq_volume_trat_copia_int_p   in number,
                                    nr_seq_volume_trat_int_p        in number,
                                    nr_seq_tratamento_copia_int_p   in number) is
begin
   insert into rxt_volume_tratamento(
        nr_sequencia,
        dt_atualizacao,
        nm_usuario,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        nr_seq_tratamento,
        nr_seq_volume_protocolo,
        nr_seq_volume,
        ds_volume,
        qt_duracao_trat,
        qt_dose_total,
        qt_dose_fase,
        qt_ptv,
        qt_gtv,
        qt_ctv,
        nr_seq_atend_cons_pepa,
        dt_liberacao)
        SELECT	
        nr_seq_volume_trat_copia_int_p,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        nr_seq_tratamento_copia_int_p,
        nr_seq_volume_protocolo,
        nr_seq_volume,
        ds_volume,
        qt_duracao_trat,
        qt_dose_total,
        qt_dose_fase,
        qt_ptv,
        qt_gtv,
        qt_ctv,
        nr_seq_atend_cons_pepa,
        dt_liberacao
    from	rxt_volume_tratamento
    where	nr_sequencia = nr_seq_volume_trat_int_p;

end;

procedure campo_trat_roentgen_insert(nr_seq_campo_roent_copia_int_p     in number,
                                        nr_seq_campo_roent_int_p        in number,
                                        nr_seq_trat_copia_int_p         in number,
                                        nr_seq_volume_copia_int_p       in number) is
begin
   insert into rxt_campo_trat_roentgen(
        nr_sequencia,
        qt_dose_dia,
        dt_atualizacao,
        nm_usuario,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        nr_seq_tratamento,
        nr_seq_volume_tratamento,
        nr_seq_campo_prot,
        nm_campo,
        qt_dia_trat,
        qt_dose_campo)
        SELECT	
        nr_seq_campo_roent_copia_int_p,
        qt_dose_dia,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        nr_seq_trat_copia_int_p,
        nr_seq_volume_copia_int_p,
        nr_seq_campo_prot,
        nm_campo,
        qt_dia_trat,
        qt_dose_campo
    from	rxt_campo_trat_roentgen
    where nr_sequencia = nr_seq_campo_roent_int_p;

end;

procedure aplic_trat_roentgen_insert(nr_seq_aplic_roent_copia_int_p     in number,
                                        nr_seq_aplic_roent_int_p        in number,
                                        nr_seq_campo_roent_copia_int_p  in number) is
begin
   insert into rxt_aplic_trat_roentgen(
        nr_sequencia,
        dt_atualizacao,
        nm_usuario,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        nr_seq_kvp,
        nr_seq_ma,
        nr_seq_aplicador,
        qt_tamanho_x,
        qt_tamanho_y,
        nr_minuto_duracao,
        nr_seq_campo_trat,
        nr_segundo_duracao)
        SELECT	
        nr_seq_aplic_roent_copia_int_p,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        nr_seq_kvp,
        nr_seq_ma,
        nr_seq_aplicador,
        qt_tamanho_x,
        qt_tamanho_y,
        nr_minuto_duracao,
        nr_seq_campo_roent_copia_int_p,
        nr_segundo_duracao  
    from	rxt_aplic_trat_roentgen
    where	nr_sequencia = nr_seq_aplic_roent_int_p;

end;

procedure fase_tratamento_insert(nr_seq_fase_trat_copia_int_p          in number,
                                    nr_seq_fase_trat_int_p             in number,
                                    nr_seq_tratamento_copia_int_p      in number,
                                    nr_seq_volume_trat_copia_int_p     in number) is
begin
   insert into rxt_fase_tratamento(nr_sequencia,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        dt_atualizacao,
        nm_usuario,
        nr_seq_tratamento,
        nm_fase,
        qt_duracao_trat,
        qt_dose_total,
        qt_dose_fase,
        ie_final_semana,
        nr_seq_decubito,
        nr_seq_fase_prot,
        nr_seq_volume_tratamento,
        qt_intervalo,
        qt_isodose_prescr,
        dt_reprovacao_seg_fisico,
        dt_lib_prim_fisico,
        dt_lib_seg_fisico,
        nm_usuario_prim_fisico,
        nm_usuario_reprovacao,
        nm_usuario_seg_fisico,
        nm_medico_aprovacao,
        dt_aprovacao_medico,
        nr_seq_atend_cons_pepa)
        SELECT	
        nr_seq_fase_trat_copia_int_p,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        nr_seq_tratamento_copia_int_p,
        nm_fase,
        qt_duracao_trat,
        qt_dose_total,
        qt_dose_fase,
        ie_final_semana,
        nr_seq_decubito,
        nr_seq_fase_prot,
        nr_seq_volume_trat_copia_int_p,
        qt_intervalo,
        qt_isodose_prescr,
        dt_reprovacao_seg_fisico,
        dt_lib_prim_fisico,
        dt_lib_seg_fisico,
        nm_usuario_prim_fisico,
        nm_usuario_reprovacao,
        nm_usuario_seg_fisico,
        nm_medico_aprovacao,
        dt_aprovacao_medico,
        nr_seq_atend_cons_pepa
    from	rxt_fase_tratamento
    where nr_sequencia = nr_seq_fase_trat_int_p;

end;

procedure planejamento_fisico_insert(nr_seq_planej_fis_copia_int_p  in number,
                                        nr_seq_planej_fis_int_p     in number,
                                        nr_seq_fase_trat_copia_int_p   in number) is
begin

    insert into rxt_planejamento_fisico(
        nr_sequencia,
        cd_estabelecimento,
        dt_atualizacao,
        nm_usuario,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        nr_seq_fase,
        qt_x1,
        qt_x2,
        qt_y1,
        qt_y2,
        qt_angulo_gantry,
        qt_angulo_colimador,
        qt_angulo_mesa_x,
        qt_angulo_mesa_y,
        qt_angulo_mesa_z,
        ds_tamanho_campo,
        qt_campo_equivalente,
        qt_distancia_isocentro,
        qt_dose_tumor_real,
        qt_dose_tumor_diaria,
        qt_numero_aplicacoes,
        qt_profundidade,
        qt_percent_dose_profunda,
        qt_tmr,
        qt_rendimento_final,
        qt_abertura_colimador,
        qt_fator_retroespalhamento,
        qt_fator_filtro,
        qt_fator_distancia,
        qt_diametro_antero_post,
        qt_latero_lateral,
        qt_distancia_mesa_centro,
        qt_unidade_monitor,
        nr_seq_campo,
        qt_fator_bandeja,
        qt_tam_x,
        qt_tam_y,
        ie_tipo_x,
        ie_tipo_y,
        ds_campo_tratamento,
        qt_ssd,
        qt_angulo_mesa,
        nr_seq_energia_rad,
        nr_seq_ene_fotons,
        qt_angulo_gantry_final,
        qt_ang_colimador_final,
        ie_situacao,
        dt_liberacao,
        nm_usuario_lib,
        dt_inativacao,
        nm_usuario_inativacao,
        nr_seq_rxt_campo,
        ds_observacao_fisico,
        nr_seq_planejamento_inativacao)
        SELECT
        nr_seq_planej_fis_copia_int_p,
        cd_estabelecimento,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        nr_seq_fase_trat_copia_int_p,
        qt_x1,
        qt_x2,
        qt_y1,
        qt_y2,
        qt_angulo_gantry,
        qt_angulo_colimador,
        qt_angulo_mesa_x,
        qt_angulo_mesa_y,
        qt_angulo_mesa_z,
        ds_tamanho_campo,
        qt_campo_equivalente,
        qt_distancia_isocentro,
        qt_dose_tumor_real,
        qt_dose_tumor_diaria,
        qt_numero_aplicacoes,
        qt_profundidade,
        qt_percent_dose_profunda,
        qt_tmr,
        qt_rendimento_final,
        qt_abertura_colimador,
        qt_fator_retroespalhamento,
        qt_fator_filtro,
        qt_fator_distancia,
        qt_diametro_antero_post,
        qt_latero_lateral,
        qt_distancia_mesa_centro,
        qt_unidade_monitor,
        nr_seq_campo,
        qt_fator_bandeja,
        qt_tam_x,
        qt_tam_y,
        ie_tipo_x,
        ie_tipo_y,
        ds_campo_tratamento,
        qt_ssd,
        qt_angulo_mesa,
        nr_seq_energia_rad,
        nr_seq_ene_fotons,
        qt_angulo_gantry_final,
        qt_ang_colimador_final,
        ie_situacao,
        dt_liberacao,
        nm_usuario_lib,
        dt_inativacao,
        nm_usuario_inativacao,
        nr_seq_rxt_campo,
        ds_observacao_fisico,
        nr_seq_planejamento_inativacao
    from	rxt_planejamento_fisico
    where nr_sequencia = nr_seq_planej_fis_int_p;

end;

procedure campo_insert(nr_seq_campo_copia_int_p        in number,
                        nr_seq_campo_int_p             in number,
                        nr_seq_fase_trat_copia_int_p   in number) is
begin
   insert into rxt_campo(nr_sequencia,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        dt_atualizacao,
        nm_usuario,
        nr_aplicacoes,
        nr_seq_fase,
        nr_seq_campo,
        qt_dose_total,
        qt_dose_diaria,
        qt_tam_x,
        qt_tam_y,
        qt_dose_monitor,
        qt_x1,
        qt_x2,
        qt_y1,
        qt_ssd,
        qt_y2,
        qt_angulo_gantry,
        qt_angulo_colimador,
        qt_angulo_mesa,
        ds_observacao,
        nr_seq_posicao,
        ie_tipo_x,
        ie_tipo_y,
        nr_seq_energia_rad,
        ds_campo,
        nr_seq_ene_fotons,
        qt_angulo_gantry_final,
        qt_ang_colimador_final,
        ie_situacao,
        dt_liberacao,
        nm_usuario_lib,
        dt_inativacao,
        nm_usuario_inativacao,
        dt_envio_fisico,
        ds_observacao_medico,
        nr_seq_campo_inativacao,
        dt_lib_fisico,
        nr_seq_atend_cons_pepa)
        SELECT	
        nr_seq_campo_copia_int_p,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        nr_aplicacoes,
        nr_seq_fase_trat_copia_int_p,
        nr_seq_campo,
        qt_dose_total,
        qt_dose_diaria,
        qt_tam_x,
        qt_tam_y,
        qt_dose_monitor,
        qt_x1,
        qt_x2,
        qt_y1,
        qt_ssd,
        qt_y2,
        qt_angulo_gantry,
        qt_angulo_colimador,
        qt_angulo_mesa,
        ds_observacao,
        nr_seq_posicao,
        ie_tipo_x,
        ie_tipo_y,
        nr_seq_energia_rad,
        ds_campo,
        nr_seq_ene_fotons,
        qt_angulo_gantry_final,
        qt_ang_colimador_final,
        ie_situacao,
        dt_liberacao,
        nm_usuario_lib,
        dt_inativacao,
        nm_usuario_inativacao,
        dt_envio_fisico,
        ds_observacao_medico,
        nr_seq_campo_inativacao,
        dt_lib_fisico,
        nr_seq_atend_cons_pepa
    from	rxt_campo
    where	nr_sequencia = nr_seq_campo_int_p;

end;

procedure acessorio_pac_insert(nr_seq_acess_pac_copia_int_p     in number,
                                nr_seq_acess_pac_int_p          in number,
                                nr_seq_tratamento_copia_int_p   in number,
                                nr_seq_campo_copia_int_p        in number) is
begin
    insert into rxt_acessorio_pac(nr_sequencia,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        dt_atualizacao,
        nm_usuario,
        nr_seq_tratamento,
        nr_seq_acessorio,
        nr_seq_classif,
        nr_seq_campo,
        qt_medida,
        ds_observacao)
        SELECT	
        nr_seq_acess_pac_copia_int_p,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        nr_seq_tratamento_copia_int_p,
        nr_seq_acessorio,
        nr_seq_classif,
        nr_seq_campo_copia_int_p,
        qt_medida,
        ds_observacao
    from	rxt_acessorio_pac
    where	nr_sequencia = nr_seq_acess_pac_int_p;

end;

procedure medida_acess_pac_insert(nr_seq_medida_pac_copia_int_p    in number,
                                    nr_seq_medida_pac_int_p        in number,
                                    nr_seq_acess_pac_copia_int_p   in number) is
begin
   insert into rxt_medida_acessorio_pac(
        nr_sequencia,
        cd_estabelecimento,
        dt_atualizacao,
        nm_usuario,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        nr_seq_medida,
        nr_seq_acessorio,
        ds_valor_medida)
        SELECT	
        nr_seq_medida_pac_copia_int_p,
        cd_estabelecimento,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        nr_seq_medida,
        nr_seq_acess_pac_copia_int_p,
        ds_valor_medida
    from	rxt_medida_acessorio_pac
    where	nr_sequencia = nr_seq_medida_pac_int_p;

end;

procedure braq_aplic_trat_insert(nr_seq_braq_aplic_copia_int_p      in number,
                                    nr_seq_braq_aplic_int_p         in number,
                                    nr_seq_tratamento_copia_int_p   in number) is
begin
    insert into rxt_braq_aplic_trat(
            nr_sequencia,
            cd_estabelecimento,
            dt_atualizacao,
            nm_usuario,
            dt_atualizacao_nrec,
            nm_usuario_nrec,
            nr_seq_tratamento,
            nr_insercao,
            qt_dose_total,
            qt_dose_insercao,
            qt_insercao_semana,
            ie_situacao,
            nr_seq_aplicador,
            qt_intervalo_insercoes,
            nr_ordem_execucao_aplic,
            dt_lib_prim_fisico,
            dt_lib_seg_fisico,
            dt_reprovacao_seg_fisico,
            nm_usuario_prim_fisico,
            nm_usuario_reprovacao,
            nm_usuario_seg_fisico,
            nm_medico_aprovacao,
            dt_aprovacao_medico,
            nr_seq_atend_cons_pepa)
            SELECT	
            nr_seq_braq_aplic_copia_int_p,
            cd_estabelecimento,
            clock_timestamp(),
            wheb_usuario_pck.get_nm_usuario,
            clock_timestamp(),
            wheb_usuario_pck.get_nm_usuario,
            nr_seq_tratamento_copia_int_p,
            nr_insercao,
            qt_dose_total,
            qt_dose_insercao,
            qt_insercao_semana,
            ie_situacao,
            nr_seq_aplicador,
            qt_intervalo_insercoes,
            nr_ordem_execucao_aplic,
            dt_lib_prim_fisico,
            dt_lib_seg_fisico,
            dt_reprovacao_seg_fisico,
            nm_usuario_prim_fisico,
            nm_usuario_reprovacao,
            nm_usuario_seg_fisico,
            nm_medico_aprovacao,
            dt_aprovacao_medico,
            nr_seq_atend_cons_pepa
        from	rxt_braq_aplic_trat
        where nr_sequencia = nr_seq_braq_aplic_int_p;

end;

procedure braq_campo_trat_insert(nr_seq_braq_campo_copia_int_p      in number,
                                    nr_seq_braq_campo_int_p         in number,
                                    nr_seq_braq_aplic_copia_int_p   in number) is
begin
     insert into rxt_braq_campo_aplic_trat(
        nr_sequencia,
        cd_estabelecimento,
        dt_atualizacao,
        nm_usuario,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        nr_seq_aplic_trat,
        qt_resultado,
        ds_resultado,
        nr_seq_resultado,
        nr_insercao,
        nr_seq_campo,
        ie_situacao,
        qt_atividade_ci,
        qt_tempo,
        qt_angulacao,
        nr_seq_agenda,
        dt_liberacao,
        nm_usuario_lib,
        dt_inativacao,
        nm_usuario_inativacao,
        dt_envio_fisico,
        ds_observacao_medico,
        nr_seq_campo_inativacao,
        dt_lib_fisico,
        nr_seq_atend_cons_pepa)
        SELECT	
        nr_seq_braq_campo_copia_int_p,
        cd_estabelecimento,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        nr_seq_braq_aplic_copia_int_p,
        qt_resultado,
        ds_resultado,
        nr_seq_resultado,
        nr_insercao,
        nr_seq_campo,
        ie_situacao,
        qt_atividade_ci,
        qt_tempo,
        qt_angulacao,
        nr_seq_agenda,
        dt_liberacao,
        nm_usuario_lib,
        dt_inativacao,
        nm_usuario_inativacao,
        dt_envio_fisico,
        ds_observacao_medico,
        nr_seq_campo_inativacao,
        dt_lib_fisico,
        nr_seq_atend_cons_pepa
    from	rxt_braq_campo_aplic_trat
    where	nr_sequencia = nr_seq_braq_campo_int_p;

end;

procedure plan_braqui_fisico_insert(nr_seq_planej_braq_copia_int_p      in number,
                                        nr_seq_planej_braq_int_p        in number,
                                        nr_seq_braq_aplic_copia_int_p   in number) is
begin
    insert into rxt_plan_braqui_fisico(
        nr_sequencia,
        dt_atualizacao,
        nm_usuario,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        dt_liberacao,
        nm_usuario_lib,
        dt_inativacao,
        nm_usuario_inativacao,
        nr_seq_aplic,
        qt_dose_reto,
        qt_dose_bexiga,
        qt_dose_clip,
        qt_v100,
        qt_v150,
        qt_v150_100,
        ds_resultado,
        nr_insercao,
        nr_seq_campo,
        qt_atividade_ci,
        qt_tempo,
        qt_angulacao,
        ie_ponto_avaliacao_dose,
        qt_dose_ponto_avaliacao,
        ie_volume,
        qt_dose_volume,
        nr_seq_braq_aplic_trat,
        ie_situacao,
        ds_observacao_fisico,
        nr_seq_planejamento_inativacao)
        SELECT
        nr_seq_planej_braq_copia_int_p,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        dt_liberacao,
        nm_usuario_lib,
        dt_inativacao,
        nm_usuario_inativacao,
        nr_seq_aplic,
        qt_dose_reto,
        qt_dose_bexiga,
        qt_dose_clip,
        qt_v100,
        qt_v150,
        qt_v150_100,
        ds_resultado,
        nr_insercao,
        nr_seq_campo,
        qt_atividade_ci,
        qt_tempo,
        qt_angulacao,
        ie_ponto_avaliacao_dose,
        qt_dose_ponto_avaliacao,
        ie_volume,
        qt_dose_volume,
        nr_seq_braq_aplic_copia_int_p,
        ie_situacao,
        ds_observacao_fisico,
        nr_seq_planejamento_inativacao
    from	rxt_plan_braqui_fisico
    where nr_sequencia = nr_seq_planej_braq_int_p;

end;

procedure tratamento_oar_insert(nr_seq_trat_oar_copia_int_p        in number,
                                    nr_seq_trat_oar_int_p          in number,
                                    nr_seq_tratamento_copia_int_p  in number) is
begin
insert into rxt_tratamento_oar(
        nr_sequencia,
        nr_seq_tratamento,
        dt_atualizacao,
        nm_usuario,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        nr_seq_orgao)
        SELECT	
        nr_seq_trat_oar_copia_int_p,
        nr_seq_tratamento_copia_int_p,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        nr_seq_orgao
    from	rxt_tratamento_oar
    where nr_sequencia = nr_seq_trat_oar_int_p;

end;

procedure tecnica_insert(nr_seq_tecnica_copia_int_p        in number,
                            nr_seq_tecnica_int_p           in number,
                            nr_seq_tratamento_copia_int_p  in number) is
begin
    insert into rxt_tecnica(
        nr_sequencia,
        dt_atualizacao,
        nm_usuario,
        dt_atualizacao_nrec,
        nm_usuario_nrec,
        nr_seq_tratamento,
        nr_seq_tecnica,
        nr_seq_atend_cons_pepa,
        dt_liberacao)
        SELECT
        nr_seq_tecnica_copia_int_p,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        clock_timestamp(),
        wheb_usuario_pck.get_nm_usuario,
        nr_seq_tratamento_copia_int_p,
        nr_seq_tecnica,
        nr_seq_atend_cons_pepa,
        dt_liberacao
    from	rxt_tecnica
    where nr_sequencia = nr_seq_tecnica_int_p;

end;

begin

if (nr_seq_tratamento_p IS NOT NULL AND nr_seq_tratamento_p::text <> '') then

    select nextval('rxt_tratamento_seq')
    into STRICT nr_seq_tratamento_copia_w
;

    tratamento_insert(nr_seq_tratamento_copia_w, nr_seq_tratamento_p);

    for volume_item in volume_tratamento loop
     
        select nextval('rxt_volume_tratamento_seq')
        into STRICT nr_seq_volume_trat_copia_w
;

        volume_tratamento_insert(nr_seq_volume_trat_copia_w, volume_item.nr_sequencia, nr_seq_tratamento_copia_w);
        nr_seq_volume_trat_w := volume_item.nr_sequencia;

        for campo_trat in campo_trat_roentgen loop
                
                select nextval('rxt_campo_trat_roentgen_seq')
                into STRICT nr_seq_campo_roent_copia_w
;

                campo_trat_roentgen_insert(nr_seq_campo_roent_copia_w, campo_trat.nr_sequencia, nr_seq_tratamento_copia_w, nr_seq_volume_trat_copia_w);
                nr_seq_campo_roent_w := campo_trat.nr_sequencia;

                for aplic_trat in aplic_trat_roentgen loop
                        
                    select nextval('rxt_aplic_trat_roentgen_seq')
                    into STRICT nr_seq_aplic_roent_w
;

                    aplic_trat_roentgen_insert(nr_seq_aplic_roent_w, aplic_trat.nr_sequencia, nr_seq_campo_roent_copia_w);

                 end loop;
         end loop;

         for fase in fase_tratamento loop
         
            select nextval('rxt_fase_tratamento_seq')
            into STRICT nr_seq_fase_trat_copia_w
;

            fase_tratamento_insert(nr_seq_fase_trat_copia_w, fase.nr_sequencia, nr_seq_tratamento_copia_w, nr_seq_volume_trat_copia_w);
            nr_seq_fase_trat_w := fase.nr_sequencia;

            for planejamento in planejamento_fisico loop
            
                select nextval('rxt_planejamento_fisico_seq')
                into STRICT nr_seq_planej_fisico_copia_w
;

                planejamento_fisico_insert(nr_seq_planej_fisico_copia_w, planejamento.nr_sequencia, nr_seq_fase_trat_copia_w);

            end loop;

            for campo_item in campo loop
            
                select nextval('rxt_campo_seq')
                into STRICT nr_seq_campo_copia_w
;

                campo_insert(nr_seq_campo_copia_w, campo_item.nr_sequencia, nr_seq_fase_trat_copia_w);
                nr_seq_campo_w := campo_item.nr_sequencia;

                for acessorio in acessorio_pac loop
                    select nextval('rxt_acessorio_pac_seq')
                    into STRICT nr_seq_acess_pac_copia_w
;

                    acessorio_pac_insert(nr_seq_acess_pac_copia_w, acessorio.nr_sequencia, nr_seq_tratamento_copia_w, nr_seq_campo_copia_w);
                    nr_seq_acess_pac_w := acessorio.nr_sequencia;

                    for medida in medida_acessorio_pac loop
                     
                        select nextval('rxt_medida_acessorio_pac_seq')
                        into STRICT nr_seq_medida_pac_copia_w
;

                        medida_acess_pac_insert(nr_seq_medida_pac_copia_w, medida.nr_sequencia, nr_seq_acess_pac_copia_w);

                    end loop;
                end loop;
            end loop;
         end loop;
    end loop;

    for braq_aplic in braq_aplic_trat loop
    
        select nextval('rxt_braq_aplic_trat_seq')
        into STRICT nr_seq_braq_aplic_copia_w
;

        braq_aplic_trat_insert(nr_seq_braq_aplic_copia_w, braq_aplic.nr_sequencia, nr_seq_tratamento_copia_w);
        nr_seq_braq_aplic_w := braq_aplic.nr_sequencia;

        for braq_trat in braq_campo_aplic_trat loop
            
            select nextval('rxt_braq_campo_aplic_trat_seq')
            into STRICT nr_seq_braq_campo_w
;

            braq_campo_trat_insert(nr_seq_braq_campo_w, braq_trat.nr_sequencia, nr_seq_braq_aplic_copia_w);

        end loop;

        for plan_fisico in plan_braqui_fisico loop
        
            select nextval('rxt_plan_braqui_fisico_seq')
            into STRICT nr_seq_planej_braq_copia_w
;

            plan_braqui_fisico_insert(nr_seq_planej_braq_copia_w, plan_fisico.nr_sequencia, nr_seq_braq_aplic_copia_w);

        end loop;
    end loop;

    for tratamento in tratamento_oar loop
     
        select nextval('rxt_tratamento_oar_seq')
        into STRICT nr_seq_trat_oar_copia_w
;

        tratamento_oar_insert(nr_seq_trat_oar_copia_w, tratamento.nr_sequencia, nr_seq_tratamento_copia_w);

    end loop;

    for tecnica_item in tecnica loop
     
        select nextval('rxt_tecnica_seq')
        into STRICT nr_seq_tecnica_copia_w
;

        tecnica_insert(nr_seq_tecnica_copia_w, tecnica_item.nr_sequencia, nr_seq_tratamento_copia_w);

    end loop;

    for acessorio in acessorio_pac_manual loop
     
        select nextval('rxt_acessorio_pac_seq')
        into STRICT nr_seq_acess_pac_copia_w
;

        acessorio_pac_insert(nr_seq_acess_pac_copia_w, acessorio.nr_sequencia, nr_seq_tratamento_copia_w, null);

    end loop;

    for fase_tratamento in fase_tratamento_manual loop
     
        select nextval('rxt_fase_tratamento_seq')
        into STRICT nr_seq_fase_trat_copia_w
;

        fase_tratamento_insert(nr_seq_fase_trat_copia_w, fase_tratamento.nr_sequencia, nr_seq_tratamento_copia_w, null);

        for planejamento in planejamento_fisico loop
            
                select nextval('rxt_planejamento_fisico_seq')
                into STRICT nr_seq_planej_fisico_copia_w
;

                planejamento_fisico_insert(nr_seq_planej_fisico_copia_w, planejamento.nr_sequencia, nr_seq_fase_trat_copia_w);

        end loop;
    end loop;

    for campo_trat in campo_trat_roentgen_manual loop
     
        select nextval('rxt_campo_trat_roentgen_seq')
        into STRICT nr_seq_campo_roent_copia_w
;

        campo_trat_roentgen_insert(nr_seq_campo_roent_copia_w, campo_trat.nr_sequencia, nr_seq_tratamento_copia_w, null);
        nr_seq_campo_roent_w := campo_trat.nr_sequencia;

        for aplic_trat in aplic_trat_roentgen loop
                
            select nextval('rxt_aplic_trat_roentgen_seq')
            into STRICT nr_seq_aplic_roent_w
;

            aplic_trat_roentgen_insert(nr_seq_aplic_roent_w, aplic_trat.nr_sequencia, nr_seq_campo_roent_copia_w);

        end loop;
    end loop;

    commit;
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE duplicar_tratamento_radio (nr_seq_tratamento_p bigint) FROM PUBLIC;

