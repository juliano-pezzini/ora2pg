-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_acesso_tomcat () AS $body$
DECLARE


ds_erro_w	varchar(1000);
nr			bigint;

BEGIN

CALL gravar_processo_longo('','GERAR_ACESSO_TOMCAT',NULL);

begin
	SELECT	'A procedure GERAR_ACESSO_TOMCAT já está em execução!!'
 || chr(10) ||
			obter_desc_expressao(648224)/*'Programa: '*/
 || program || chr(10) ||
			obter_desc_expressao(618748)/*'Sid/Serial :'*/
 || sid     || ',' || serial# || chr(10) ||
			obter_desc_expressao(328225)/*'Usuário :'*/
 || osuser  || CHR(10) ||
			obter_desc_expressao(289514)/*'Estação: '*/
	||': ' || machine
	INTO STRICT	ds_erro_w
	FROM 	v$session
	WHERE	audsid <> (SELECT userenv('sessionid') )
	AND		username = (select username from v$session where audsid = (select userenv('sessionid') ))
	AND		action like 'GERAR_ACESSO_TOMCAT%';
exception
when others then
	ds_erro_w := '';
end;

if (ds_erro_w IS NOT NULL AND ds_erro_w::text <> '') then
	 CALL gravar_processo_longo('','',null);
	 CALL Wheb_mensagem_pck.exibir_mensagem_abort(279619, 'DS_ERRO_P=' || ds_erro_w);
end if;

for i in 1..1000 loop
	begin

	select count(*) into STRICT nr;

	end;
end loop;

CALL gravar_processo_longo('','',0);

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_acesso_tomcat () FROM PUBLIC;

