-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE duplicate_registro_cancer ( NR_SEQ_ORIGEM_P bigint, NR_ATEND_DESTINO_P bigint, NM_USUARIO_P text, NR_SEQUENCIA_P INOUT bigint) AS $body$
DECLARE

NR_SEQ_NEW_RAZAO_W  REGISTRO_CANCER_RAZAO.NR_SEQUENCIA%TYPE;
REGISTRO_CANCER_w   REGISTRO_CANCER%rowtype;
REGISTRO_CANCER_RAZAO_w REGISTRO_CANCER_RAZAO%rowtype;
C01 CURSOR FOR
SELECT  *
from    REGISTRO_CANCER_RAZAO
where   NR_SEQ_REGISTRO = NR_SEQ_ORIGEM_P;
c01_w   c01%rowtype;

BEGIN
begin
select  *
into STRICT    REGISTRO_CANCER_w
from    REGISTRO_CANCER
where   nr_sequencia = NR_SEQ_ORIGEM_P;
exception
when others then
    REGISTRO_CANCER_w   :=  null;
end;
if (REGISTRO_CANCER_w.nr_sequencia IS NOT NULL AND REGISTRO_CANCER_w.nr_sequencia::text <> '') then
    SELECT  nextval('registro_cancer_seq')
    INTO STRICT    REGISTRO_CANCER_w.nr_sequencia
;
    REGISTRO_CANCER_w.NM_USUARIO        :=  NM_USUARIO_P;
    REGISTRO_CANCER_w.NM_USUARIO_nrec       :=  NM_USUARIO_P;
    REGISTRO_CANCER_w.DT_ATUALIZACAO        :=  clock_timestamp();
    REGISTRO_CANCER_w.DT_ATUALIZACAO_NREC       :=  clock_timestamp();
    REGISTRO_CANCER_w.NR_ATENDIMENTO        :=  NR_ATEND_DESTINO_P;
    INSERT INTO REGISTRO_CANCER values (REGISTRO_CANCER_w.*);
    open C01;
    loop
    fetch C01 into
        c01_w;
    EXIT WHEN NOT FOUND; /* apply on C01 */
        begin
        select  *
        into STRICT    REGISTRO_CANCER_RAZAO_w
        from    REGISTRO_CANCER_RAZAO
        where   nr_sequencia = c01_w.nr_sequencia;

        
        SELECT  nextval('registro_cancer_razao_seq')
        INTO STRICT    REGISTRO_CANCER_RAZAO_w.NR_SEQUENCIA
;

        REGISTRO_CANCER_RAZAO_w.NM_USUARIO      :=  NM_USUARIO_P;
        REGISTRO_CANCER_RAZAO_w.DT_ATUALIZACAO      :=  clock_timestamp();
        REGISTRO_CANCER_RAZAO_w.NR_SEQ_REGISTRO     :=  REGISTRO_CANCER_w.NR_SEQUENCIA;

        INSERT INTO REGISTRO_CANCER_RAZAO VALUES (REGISTRO_CANCER_RAZAO_w.*);
        end;
    end loop;
    close C01;
    COMMIT;
end if;
NR_SEQUENCIA_P  :=  REGISTRO_CANCER_w.nr_sequencia;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE duplicate_registro_cancer ( NR_SEQ_ORIGEM_P bigint, NR_ATEND_DESTINO_P bigint, NM_USUARIO_P text, NR_SEQUENCIA_P INOUT bigint) FROM PUBLIC;

