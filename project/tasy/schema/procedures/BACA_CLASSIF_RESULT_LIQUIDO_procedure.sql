-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE baca_classif_result_liquido () AS $body$
DECLARE


cd_empresa_w		smallint;
cd_classificacao_w	smallint;
/* OS 59719 Matheus em 13/06/2007
Identificar se a classificação é resultado líquido
Para ser utilizado no grid de resultado da Apuração de Custo substituindo
a restrição de classificação 900, utilizada como default para a classificação final */
BEGIN

select	max(cd_empresa)
into STRICT	cd_empresa_w
from	classif_result
where	cd_classificacao	= 900;

if (cd_empresa_w IS NOT NULL AND cd_empresa_w::text <> '') then
	update	classif_result
	set	ie_resultado_liquido = 'S',
		nm_usuario		= 'BacaClassif',
		dt_atualizacao	= clock_timestamp()
	where	cd_classificacao	= 900
	and	cd_empresa		= cd_empresa_w;
end if;

commit;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE baca_classif_result_liquido () FROM PUBLIC;

