-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE cus_gerar_consulta_orc_real ( cd_empresa_p bigint, cd_estab_param_p bigint, nr_tabela_real_p bigint, nr_tabela_orc_p bigint, nr_seq_unid_neg_p bigint, ie_tipo_centro_controle_p bigint, ie_centro_resultado_p text, nm_usuario_p text) AS $body$
DECLARE


ie_regra_lib_w			varchar(2);
cd_empresa_w			bigint;
cd_estab_tabela_real_w		bigint;
qt_ind_orc_w			bigint;
qt_ind_real_w			bigint;
vl_ind_orc_w			double precision;
vl_ind_real_w			double precision;
dt_inicio_real_w		timestamp;
dt_fim_real_w			timestamp;
dt_inicio_orc_w			timestamp;
dt_fim_orc_w			timestamp;
qt_periodo_real_w		bigint;
qt_periodo_orc_w		bigint;
ie_tipo_centro_controle_w	centro_controle.ie_tipo_centro_controle%type;
ie_centro_resultado_w		centro_controle.ie_centro_resultado%type;
ie_tipo_tabela_real_w		tabela_custo.ie_orcado_real%type;
ie_tipo_tabela_orc_w		tabela_custo.ie_orcado_real%type;

/* INDICADOR REAL X ORCADO */

c02 CURSOR FOR
	SELECT	'R' ie_valor,
		a.nr_seq_indicador nr_seq_indicador,
		a.qt_indicador qt_indicador,
		b.ie_forma_obtencao ie_forma_obtencao,
		b.ie_rotina_obtencao ie_rotina_obtencao,
		coalesce(b.ie_calcula_total,'N') ie_calcula_total,
		a.vl_indicador,
		a.cd_centro_controle,
		a.cd_estabelecimento
	from 	resultado_indicador b,
		resultado_ind_cen_cont a
	where	a.nr_seq_indicador	= b.nr_sequencia
	and	((coalesce(cd_estab_param_p,0) = 0) or (a.cd_estabelecimento	= cd_estab_param_p))
	and	((coalesce(nr_seq_unid_neg_p,0) = 0) or (cus_obter_se_centro_unid_neg(a.cd_estabelecimento, a.cd_centro_controle, coalesce(nr_seq_unid_neg_p,0)) = 'S'))
	and	a.nr_seq_tabela		= nr_tabela_real_p
	
union all

	SELECT	'O' ie_valor,
		a.nr_seq_indicador nr_seq_indicador,
		a.qt_indicador qt_indicador,
		b.ie_forma_obtencao ie_forma_obtencao,
		b.ie_rotina_obtencao ie_rotina_obtencao,
		coalesce(b.ie_calcula_total,'N') ie_calcula_total,
		a.vl_indicador,
		a.cd_centro_controle,
		a.cd_estabelecimento
	from 	resultado_indicador b,
		resultado_ind_cen_cont a
	where	a.nr_seq_indicador	= b.nr_sequencia
	and	((coalesce(cd_estab_param_p,0) = 0) or (a.cd_estabelecimento	= cd_estab_param_p))
	and	((coalesce(nr_seq_unid_neg_p,0) = 0) or (cus_obter_se_centro_unid_neg(a.cd_estabelecimento, a.cd_centro_controle, coalesce(nr_seq_unid_neg_p,0)) = 'S'))
	and	a.nr_seq_tabela		= nr_tabela_orc_p;

c02_w	c02%rowtype;

/* ACUMULADO REAL E ORCADO DOS INDICADORES */

c04 CURSOR FOR
	SELECT	'R' ie_valor,
		a.nr_seq_indicador nr_seq_indicador,
		sum(a.vl_indicador) vl_indicador,
		sum(a.qt_indicador) qt_indicador,
		sum(a.vl_custo_total) vl_custo_total,
		a.cd_centro_controle,
		a.cd_estabelecimento,
		b.ie_valor ie_tipo
	from 	resultado_indicador	b,
		resultado_ind_cen_cont	a,
		tabela_custo		c
	where	b.nr_sequencia	= a.nr_seq_indicador
	and	c.nr_sequencia	= a.nr_seq_tabela
	and	c.dt_mes_referencia between dt_inicio_real_w and dt_fim_real_w
	and	((coalesce(cd_estab_param_p,0) = 0) or (a.cd_estabelecimento	= cd_estab_param_p))
	and	((coalesce(nr_seq_unid_neg_p,0) = 0) or (cus_obter_se_centro_unid_neg(a.cd_estabelecimento, a.cd_centro_controle, coalesce(nr_seq_unid_neg_p,0)) = 'S'))
	and	c.ie_orcado_real = ie_tipo_tabela_real_w
	group by
		a.nr_seq_indicador,
		a.cd_centro_controle,
		a.cd_estabelecimento,
		b.ie_valor
	
union all

	SELECT	'O' ie_valor,
		a.nr_seq_indicador nr_seq_indicador,
		sum(a.vl_indicador) vl_indicador,
		sum(a.qt_indicador) qt_indicador,
		sum(a.vl_custo_total) vl_custo_total,
		a.cd_centro_controle,
		a.cd_estabelecimento,
		b.ie_valor ie_tipo
	from 	resultado_indicador	b,
		resultado_ind_cen_cont	a,
		tabela_custo		c
	where	b.nr_sequencia	= a.nr_seq_indicador
	and	c.nr_sequencia	= a.nr_seq_tabela
	and	c.dt_mes_referencia between dt_inicio_orc_w and dt_fim_orc_w
	and	((coalesce(cd_estab_param_p,0) = 0) or (a.cd_estabelecimento	= cd_estab_param_p))
	and	((coalesce(nr_seq_unid_neg_p,0) = 0) or (cus_obter_se_centro_unid_neg(a.cd_estabelecimento, a.cd_centro_controle, coalesce(nr_seq_unid_neg_p,0)) = 'S'))
	and	c.ie_orcado_real = ie_tipo_tabela_orc_w
	group by
		a.nr_seq_indicador,
		a.cd_centro_controle,
		a.cd_estabelecimento,
		b.ie_valor;

c04_w	c04%rowtype;


BEGIN

ie_tipo_centro_controle_w	:= coalesce(ie_tipo_centro_controle_p,0);
ie_centro_resultado_w		:= coalesce(ie_centro_resultado_p, 'N');

/* *************************************************************************************************************************************************************
                                                                                                                   LIMPAR INFORMACOES DAS TABELAS

************************************************************************************************************************************************************** */
delete from w_result_orc_real;
commit;

delete from w_result_ind_orc_real;
commit;

/* *************************************************************************************************************************************************************
                                                                                                                               BUSCAR PARAMETROS
************************************************************************************************************************************************************** */
ie_regra_lib_w := substr(coalesce(obter_valor_param_usuario(927,3,obter_perfil_ativo,nm_usuario_p, wheb_usuario_pck.get_cd_estabelecimento),'S'),1,1);

/* *************************************************************************************************************************************************************
                                                                                                                  BUSCA O PERIODO DA TABELA ORCADA

************************************************************************************************************************************************************** */
select  a.dt_mes_referencia,
	a.ie_orcado_real
into STRICT    dt_fim_orc_w,
	ie_tipo_tabela_orc_w
from	tabela_custo a
where	a.nr_sequencia = nr_tabela_orc_p;

/* *************************************************************************************************************************************************************
                                                                                     BUSCA O EMPRESA, ESTABELECIMENTO E PERIODO DA TABELA REALIZADA
************************************************************************************************************************************************************** */
select	cd_empresa,
	cd_estabelecimento,
	a.dt_mes_referencia,
	a.ie_orcado_real
into STRICT	cd_empresa_w,
	cd_estab_tabela_real_w,
	dt_fim_real_w,
	ie_tipo_tabela_real_w
from	tabela_custo a
where	a.nr_sequencia	= nr_tabela_real_p;

dt_inicio_real_w		:= trunc(dt_fim_real_w,'year');
dt_inicio_orc_w			:= trunc(dt_fim_orc_w,'year');

/* *************************************************************************************************************************************************************
                                                                                                          INSERIR INFORMACOES DO REALIZADO DO MES
                                                                                                                        INSERIR VALOR ORCADO DO MES


                                                                                                                              INSERIR ACUMULADO REAL
                                                                                                                           INSERIR ACUMULADO ORCADO

************************************************************************************************************************************************************* */
insert into w_result_orc_real(
		nr_sequencia,
		dt_atualizacao,
		nm_usuario,
		cd_centro_controle,
		cd_estabelecimento,
		ie_classif_conta,
		ds_classificacao,
		nr_seq_ng,
		ds_natureza_gasto,
		vl_mes,
		vl_mes_orcado,
		vl_acumulado_real,
		vl_acumulado_orc,
		vl_acum_real_classif,
		vl_acum_orc_classif,
		vl_diferenca
		)
SELECT	nextval('w_result_orc_real_seq') seq,
	clock_timestamp(),
	nm_usuario_p,
	cd_centro_controle,
	cd_estabelecimento,
	ie_classif_conta,
	ds_classificacao,
	nr_seq_ng,
	ds_natureza_gasto,
	vl_realizado,
	vl_orcado,
	vl_acum_realizado,
	vl_acum_orcado,
	vl_acum_realizado,
	vl_acum_orcado,
	vl_diferenca
from (	SELECT	cd_centro_controle,
		cd_estabelecimento,
		ie_classif_conta,
		ds_classificacao,
		nr_seq_ng,
		ds_natureza_gasto,
		sum(vl_realizado) vl_realizado,
		sum(vl_orcado) vl_orcado,
		sum(vl_acum_realizado) vl_acum_realizado,
		sum(vl_acum_orcado) vl_acum_orcado,
		(sum(vl_realizado) - sum(vl_orcado)) vl_diferenca
	from (	select	a.cd_centro_controle,
			a.cd_estabelecimento,
			a.ie_classif_conta,
			c.ds_classificacao,
			a.nr_seq_ng,
			d.ds_natureza_gasto,
			a.vl_mes vl_realizado, /* Gerar o valor REALIZADO */
			0 vl_orcado,
			0 vl_acum_realizado,
			0 vl_acum_orcado
		FROM centro_controle e, classif_result c, tabela_custo b, resultado_centro_controle a
LEFT OUTER JOIN natureza_gasto d ON (a.nr_seq_ng = d.nr_sequencia)
WHERE a.nr_seq_tabela	= b.nr_sequencia and e.cd_centro_controle = a.cd_centro_controle and e.cd_estabelecimento = a.cd_estabelecimento and a.ie_classif_conta = c.cd_classificacao and b.cd_empresa = c.cd_empresa  and a.nr_seq_tabela	= nr_tabela_real_p /* REALIZADO */
  and b.cd_empresa = cd_empresa_w and (e.ie_tipo_centro_controle	= ie_tipo_centro_controle_w or ie_tipo_centro_controle_w = 0) and (e.ie_centro_resultado	= ie_centro_resultado_w or ie_centro_resultado_w = 'N') and ((ie_regra_lib_w = 'N') or (substr(cus_obter_se_centro_usuario(a.cd_estabelecimento, a.cd_centro_controle, nm_usuario_p), 1, 1) = 'S')) and a.cd_estabelecimento in (
						select	a.cd_estabelecimento
						
						where	coalesce(cd_estab_param_p,0) = 0
						
union all

						select	coalesce(cd_estab_param_p,0)
						
						) and exists (
			select	1
			from	centro_controle_unid_neg x
			where	x.cd_estabelecimento	= a.cd_estabelecimento
			and	x.cd_centro_controle	= a.cd_centro_controle
			and	x.nr_seq_unid_neg	= coalesce(nr_seq_unid_neg_p,0)
			
union all

			select	1
			
			where	coalesce(nr_seq_unid_neg_p,0) = 0)
		
union all

		select	a.cd_centro_controle,
			a.cd_estabelecimento,
			a.ie_classif_conta,
			c.ds_classificacao,
			a.nr_seq_ng,
			d.ds_natureza_gasto,
			0 vl_realizado,
			a.vl_mes vl_orcado, /* Gerar o valor ORCADO */
			0 vl_acum_realizado,
			0 vl_acum_orcado
		FROM centro_controle e, classif_result c, tabela_custo b, resultado_centro_controle a
LEFT OUTER JOIN natureza_gasto d ON (a.nr_seq_ng = d.nr_sequencia)
WHERE a.nr_seq_tabela	= b.nr_sequencia and e.cd_centro_controle = a.cd_centro_controle and e.cd_estabelecimento = a.cd_estabelecimento and a.ie_classif_conta = c.cd_classificacao and b.cd_empresa = c.cd_empresa  and a.nr_seq_tabela	= nr_tabela_orc_p /* ORCADO */
  and b.cd_empresa = cd_empresa_w and (e.ie_tipo_centro_controle	= ie_tipo_centro_controle_w or ie_tipo_centro_controle_w = 0) and (e.ie_centro_resultado	= ie_centro_resultado_w or ie_centro_resultado_w = 'N') and ((ie_regra_lib_w = 'N') or (substr(cus_obter_se_centro_usuario(a.cd_estabelecimento, a.cd_centro_controle, nm_usuario_p), 1, 1) = 'S')) and a.cd_estabelecimento in (
						select	a.cd_estabelecimento
						
						where	coalesce(cd_estab_param_p,0) = 0
						
union all

						select	coalesce(cd_estab_param_p,0)
						
						) and exists (
			select	1
			from	centro_controle_unid_neg x
			where	x.cd_estabelecimento	= a.cd_estabelecimento
			and	x.cd_centro_controle	= a.cd_centro_controle
			and	x.nr_seq_unid_neg	= coalesce(nr_seq_unid_neg_p,0)
			
union all

			select	1
			
			where	coalesce(nr_seq_unid_neg_p,0) = 0)
		 
union all

		select	a.cd_centro_controle,
			a.cd_estabelecimento,
			a.ie_classif_conta,
			c.ds_classificacao,
			a.nr_seq_ng,
			d.ds_natureza_gasto,
			0 vl_realizado,
			0 vl_orcado,
			a.vl_mes vl_acum_realizado, /* Gerar o valor REALIZADO ACUMULADO */
			0 vl_acum_orcado
		FROM centro_controle e, classif_result c, tabela_custo b, resultado_centro_controle a
LEFT OUTER JOIN natureza_gasto d ON (a.nr_seq_ng = d.nr_sequencia)
WHERE b.nr_sequencia = a.nr_seq_tabela and e.cd_centro_controle = a.cd_centro_controle and e.cd_estabelecimento = a.cd_estabelecimento and a.ie_classif_conta = c.cd_classificacao and b.cd_empresa = c.cd_empresa  and b.dt_mes_referencia between dt_inicio_real_w and dt_fim_real_w and b.ie_orcado_real = ie_tipo_tabela_real_w /* REALIZADO */
  and b.cd_tipo_tabela_custo = 11 and b.cd_empresa = cd_empresa_w and (e.ie_tipo_centro_controle	= ie_tipo_centro_controle_w or ie_tipo_centro_controle_w = 0) and (e.ie_centro_resultado	= ie_centro_resultado_w or ie_centro_resultado_w = 'N') and ((ie_regra_lib_w = 'N') or (substr(cus_obter_se_centro_usuario(a.cd_estabelecimento, a.cd_centro_controle, nm_usuario_p), 1, 1) = 'S')) and a.cd_estabelecimento in (
						select	a.cd_estabelecimento
						
						where	coalesce(cd_estab_param_p,0) = 0
						
union all

						select	coalesce(cd_estab_param_p,0)
						
						) and exists (
			select	1
			from	centro_controle_unid_neg x
			where	x.cd_estabelecimento	= a.cd_estabelecimento
			and	x.cd_centro_controle	= a.cd_centro_controle
			and	x.nr_seq_unid_neg	= coalesce(nr_seq_unid_neg_p,0)
			
union all

			select	1
			
			where	coalesce(nr_seq_unid_neg_p,0) = 0)
		 
union all

		select	a.cd_centro_controle,
			a.cd_estabelecimento,
			a.ie_classif_conta,
			c.ds_classificacao,
			a.nr_seq_ng,
			d.ds_natureza_gasto,
			0 vl_realizado,
			0 vl_orcado,
			0 vl_acum_realizado,
			a.vl_mes vl_acum_orcado /* Gerar o valor ORCADO ACUMULADO */
		FROM centro_controle e, classif_result c, tabela_custo b, resultado_centro_controle a
LEFT OUTER JOIN natureza_gasto d ON (a.nr_seq_ng = d.nr_sequencia)
WHERE b.nr_sequencia = a.nr_seq_tabela and e.cd_centro_controle = a.cd_centro_controle and e.cd_estabelecimento = a.cd_estabelecimento and a.ie_classif_conta = c.cd_classificacao and b.cd_empresa = c.cd_empresa  and b.dt_mes_referencia between dt_inicio_orc_w and dt_fim_orc_w and b.ie_orcado_real = ie_tipo_tabela_orc_w /* ORCADO */
  and b.cd_tipo_tabela_custo = 11 and b.cd_empresa = cd_empresa_w and (e.ie_tipo_centro_controle	= ie_tipo_centro_controle_w or ie_tipo_centro_controle_w = 0) and (e.ie_centro_resultado	= ie_centro_resultado_w or ie_centro_resultado_w = 'N') and ((ie_regra_lib_w = 'N') or (substr(cus_obter_se_centro_usuario(a.cd_estabelecimento, a.cd_centro_controle, nm_usuario_p), 1, 1) = 'S')) and a.cd_estabelecimento in (
						select	a.cd_estabelecimento
						
						where	coalesce(cd_estab_param_p,0) = 0
						
union all

						select	coalesce(cd_estab_param_p,0)
						
						) and exists (
			select	1
			from	centro_controle_unid_neg x
			where	x.cd_estabelecimento	= a.cd_estabelecimento
			and	x.cd_centro_controle	= a.cd_centro_controle
			and	x.nr_seq_unid_neg	= coalesce(nr_seq_unid_neg_p,0)
			
union all

			select	1
			
			where	coalesce(nr_seq_unid_neg_p,0) = 0)
		 ) alias62
	group by
		cd_centro_controle,
		cd_estabelecimento,
		ie_classif_conta,
		ds_classificacao,
		nr_seq_ng,
		ds_natureza_gasto
	) alias63;

/* *************************************************************************************************************************************************************
                                                                                                                            INSERIR VALORES DO INDICADOR
************************************************************************************************************************************************************** */

/*
Criar os indicadores com valor zero, baseado no cadastro
*/
insert into w_result_ind_orc_real(cd_estabelecimento,
	cd_centro_controle,
	nr_seq_indicador,
	nm_usuario,
	dt_atualizacao,
	qt_indicador_orc,
	vl_indicador_orc,
	qt_indicador_real,
	vl_indicador_real,
	nr_seq_tabela,
	nr_seq_tabela_orc,
	vl_indicador_orc_acum,
	vl_indicador_real_acum)
SELECT	a.cd_estabelecimento,
	a.cd_centro_controle,
	a.nr_seq_indicador,
	nm_usuario_p,
	clock_timestamp(),
	0,
	0,
	0,
	0,
	nr_tabela_real_p,
	nr_tabela_orc_p,
	0,
	0
from	estabelecimento c,
	centro_controle b,
	centro_controle_indicador a
where	a.cd_centro_controle	= b.cd_centro_controle
and	a.cd_estabelecimento	= b.cd_estabelecimento
and	a.cd_estabelecimento	= b.cd_estabelecimento
and	c.cd_estabelecimento	= b.cd_estabelecimento
and	c.cd_empresa		= cd_empresa_w
and (b.ie_tipo_centro_controle	= ie_tipo_centro_controle_w or ie_tipo_centro_controle_w = 0)
and (b.ie_centro_resultado	= ie_centro_resultado_w or ie_centro_resultado_w = 'N')
and	c.cd_estabelecimento	= coalesce(cd_estab_tabela_real_w, c.cd_estabelecimento)
and	not exists (SELECT	1
	from	w_result_ind_orc_real y
	where	a.cd_estabelecimento	= y.cd_estabelecimento
	and	a.cd_centro_controle	= y.cd_centro_controle
	and	y.nr_seq_tabela		= nr_tabela_real_p
	and	a.nr_seq_indicador	= y.nr_seq_indicador);

update	w_result_ind_orc_real a
set	vl_indicador_orc	= 0,
	vl_indicador_real	= 0
where	nr_seq_tabela		= nr_tabela_real_p;

update	w_result_ind_orc_real a
set	vl_indicador_orc	= 0,
	vl_indicador_real	= 0
where	nr_seq_tabela_orc	= nr_tabela_orc_p;

/* *************************************************************************************************************************************************************
                                                                                               GERA AS INFORMACOES DOS INDICADOR REAL X ORCADO

************************************************************************************************************************************************************** */
open C02;
loop
fetch C02 into
	c02_w;
EXIT WHEN NOT FOUND; /* apply on C02 */
	begin
	if (c02_w.ie_valor = 'R') then
		begin
		update	w_result_ind_orc_real
		set	vl_indicador_real	= c02_w.vl_indicador,
			qt_indicador_real	= c02_w.qt_indicador
		where	cd_estabelecimento	= c02_w.cd_estabelecimento
		and	nr_seq_tabela		= nr_tabela_real_p
		and	cd_centro_controle	= c02_w.cd_centro_controle
		and	nr_seq_indicador	= c02_w.nr_seq_indicador;
		commit;
		end;
	end if;

	if (c02_w.ie_valor = 'O') then
		begin
		update	w_result_ind_orc_real
		set	vl_indicador_orc		= c02_w.vl_indicador,
			qt_indicador_orc		= c02_w.qt_indicador
		where	cd_estabelecimento		= c02_w.cd_estabelecimento
		and	nr_seq_tabela_orc		= nr_tabela_orc_p
		and	cd_centro_controle		= c02_w.cd_centro_controle
		and	nr_seq_indicador		= c02_w.nr_seq_indicador;
		commit;
		end;
	end if;
	end;
end loop;
close C02;

/* *************************************************************************************************************************************************************
                                                                                             INSERIR ACUMULADO REAL E ORCADO DOS INDICADORES

************************************************************************************************************************************************************* */
qt_periodo_real_w	:= pls_obter_meses_entre_datas(dt_inicio_real_w,dt_fim_real_w)+1;
qt_periodo_orc_w	:= pls_obter_meses_entre_datas(dt_inicio_orc_w,dt_fim_orc_w)+1;

open C04;
loop
fetch C04 into
	c04_w;
EXIT WHEN NOT FOUND; /* apply on C04 */
	begin
	if (c04_w.ie_tipo = 'N') then
		begin
		vl_ind_real_w	:= 0;
		vl_ind_orc_w	:= 0;
		end;
	else
		begin
		if (c04_w.ie_tipo = 'S') then
			begin
			vl_ind_real_w	  := c04_w.vl_indicador;
			vl_ind_orc_w	:= c04_w.vl_indicador;
			end;
		elsif (c04_w.ie_tipo = 'A') then
			begin
			vl_ind_orc_w	:= dividir(c04_w.vl_custo_total,c04_w.qt_indicador);
			vl_ind_real_w	:= dividir(c04_w.vl_custo_total,c04_w.qt_indicador);
			end;
		elsif (c04_w.ie_valor = 'R') then
			begin
			vl_ind_real_w	  := c04_w.vl_indicador / qt_periodo_real_w;
			end;
		elsif (c04_w.ie_valor = 'O') then
			begin
			vl_ind_orc_w	:= c04_w.vl_indicador / qt_periodo_orc_w;
			end;
		end if;
		end;
	end if;

	if (c04_w.ie_valor = 'R') then
		begin
		update	w_result_ind_orc_real
		set	vl_indicador_real_acum	= vl_ind_real_w
		where	cd_estabelecimento	= c04_w.cd_estabelecimento
		and	cd_centro_controle	= c04_w.cd_centro_controle
		and	nr_seq_tabela		= nr_tabela_real_p
		and	nr_seq_indicador	= c04_w.nr_seq_indicador;
		commit;
		end;
	end if;

	if (c04_w.ie_valor = 'O') then
		begin
		update	w_result_ind_orc_real
		set	vl_indicador_orc_acum	= vl_ind_orc_w
		where	cd_estabelecimento	= c04_w.cd_estabelecimento
		and	cd_centro_controle	= c04_w.cd_centro_controle
		and	nr_seq_tabela_orc	= nr_tabela_orc_p
		and	nr_seq_indicador	= c04_w.nr_seq_indicador;
		commit;
		end;
	end if;
	end;
end loop;
close C04;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE cus_gerar_consulta_orc_real ( cd_empresa_p bigint, cd_estab_param_p bigint, nr_tabela_real_p bigint, nr_tabela_orc_p bigint, nr_seq_unid_neg_p bigint, ie_tipo_centro_controle_p bigint, ie_centro_resultado_p text, nm_usuario_p text) FROM PUBLIC;

