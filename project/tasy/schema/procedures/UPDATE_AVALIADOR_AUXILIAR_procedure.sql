-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE update_avaliador_auxiliar (nr_sequencia_p bigint, cd_pessoa_fisica_p text, nm_tabela_p text, nm_usuario_p text, cd_avaliador_aux_p text) AS $body$
DECLARE


ds_comando_update_w varchar(2000);									
ds_sep_bv_w			varchar(50);
		

BEGIN

ds_sep_bv_w	:= obter_separador_bv;

ds_comando_update_w := 'update ' || nm_tabela_p || ' set cd_avaliador_aux = :cd_avaliador_aux_p,  ';

if (nm_tabela_p in ('ATESTADO_PACIENTE', 'MED_AVALIACAO_PACIENTE', 'EVOLUCAO_PACIENTE')) then
	ds_comando_update_w := ds_comando_update_w || ' CD_MEDICO = :cd_pessoa_fisica_p ';
elsif (nm_tabela_p = 'CIRURGIA_DESCRICAO') then
	ds_comando_update_w := ds_comando_update_w || ' CD_RESPONSAVEL = :cd_pessoa_fisica_p ';
elsif (nm_tabela_p = 'PE_PRESCRICAO') then
	ds_comando_update_w := ds_comando_update_w || ' CD_PRESCRITOR = :cd_pessoa_fisica_p ';
else
	ds_comando_update_w := ds_comando_update_w || ' CD_PROFISSIONAL = :cd_pessoa_fisica_p ';
end if;

if (nm_tabela_p = 'EVOLUCAO_PACIENTE') then
	ds_comando_update_w := ds_comando_update_w || 'where cd_evolucao = :nr_sequencia_p';
else
	ds_comando_update_w := ds_comando_update_w || 'where nr_sequencia = :nr_sequencia_p';
end if;

CALL exec_sql_dinamico_bv(nm_usuario_p, ds_comando_update_w, 'cd_avaliador_aux_p='|| cd_avaliador_aux_p || ds_sep_bv_w ||
                                                        'cd_pessoa_fisica_p=' || cd_pessoa_fisica_p || ds_sep_bv_w ||
                                                        'nr_sequencia_p='||nr_sequencia_p);

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE update_avaliador_auxiliar (nr_sequencia_p bigint, cd_pessoa_fisica_p text, nm_tabela_p text, nm_usuario_p text, cd_avaliador_aux_p text) FROM PUBLIC;

