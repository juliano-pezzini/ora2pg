-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE update_ageint_dt_lib_check_js ( ie_tipo_check_list_p text, nr_seq_ageint_p bigint, nr_sequencia_p bigint, nr_sequencia_ageint_p bigint, qt_ageint_check_p INOUT bigint, ds_texto_p INOUT text, nm_usuario_p text) AS $body$
DECLARE


ie_bloq_check_list_w	varchar(1);

BEGIN
	if (ie_tipo_check_list_p = 'A') then
		begin
		ie_bloq_check_list_w	:= ageint_obter_bloq_checklist(nr_seq_ageint_p);
		update	agenda_integrada
		set	ie_bloqueio_checklist	= ie_bloq_check_list_w,
			nm_usuario		= nm_usuario_p
		where	nr_sequencia 		= nr_seq_ageint_p;
		end;
	end if;

	update	ageint_check_list_paciente
	set	dt_liberacao 	= clock_timestamp(),
		nm_usuario	= nm_usuario_p
	where	nr_sequencia 	= nr_sequencia_p;

	select	count(*)
	into STRICT 	qt_ageint_check_p
	from	ageint_check_list_paciente
	where	coalesce(dt_liberacao::text, '') = ''
	and	nr_seq_ageint = nr_sequencia_ageint_p;

	ds_texto_p := obter_texto_tasy(80872, wheb_usuario_pck.get_nr_seq_idioma);

commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE update_ageint_dt_lib_check_js ( ie_tipo_check_list_p text, nr_seq_ageint_p bigint, nr_sequencia_p bigint, nr_sequencia_ageint_p bigint, qt_ageint_check_p INOUT bigint, ds_texto_p INOUT text, nm_usuario_p text) FROM PUBLIC;

