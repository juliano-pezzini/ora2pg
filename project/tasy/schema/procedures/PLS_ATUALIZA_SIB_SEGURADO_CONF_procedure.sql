-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pls_atualiza_sib_segurado_conf ( nr_seq_conferencia_p pls_sib_conferencia_lote.nr_sequencia%type, nr_seq_conf_segurado_p pls_sib_conferencia.nr_sequencia%type, nm_usuario_p usuario.nm_usuario%type) AS $body$
DECLARE


pls_sib_segurado_w		pls_sib_segurado%rowtype;
qt_sib_segurado_w		integer;

nr_indice_w			integer;
tb_cd_beneficiario_w		pls_util_cta_pck.t_varchar2_table_50;
tb_cd_caepf_w			pls_util_cta_pck.t_varchar2_table_15;
tb_cd_cep_w			pls_util_cta_pck.t_varchar2_table_10;
tb_cd_motivo_cancelamento_w	pls_util_cta_pck.t_varchar2_table_3;
tb_cd_municipio_ibge_w		pls_util_cta_pck.t_varchar2_table_10;
tb_cd_municipio_ibge_resid_w	pls_util_cta_pck.t_varchar2_table_10;
tb_cd_relacao_dependencia_w	pls_util_cta_pck.t_number_table;
tb_cd_sexo_w			pls_util_cta_pck.t_varchar2_table_1;
tb_ds_bairro_w			pls_util_cta_pck.t_varchar2_table_60;
tb_ds_complemento_w		pls_util_cta_pck.t_varchar2_table_60;
tb_ds_logradouro_w		pls_util_cta_pck.t_varchar2_table_255;
tb_dt_contratacao_w		pls_util_cta_pck.t_date_table;
tb_dt_cancelamento_w		pls_util_cta_pck.t_date_table;
tb_dt_nascimento_w		pls_util_cta_pck.t_date_table;
tb_dt_reativacao_w		pls_util_cta_pck.t_date_table;
tb_ie_itens_exclu_cobertura_w	pls_util_cta_pck.t_number_table;
tb_ie_reside_exterior_w		pls_util_cta_pck.t_number_table;
tb_ie_tipo_endereco_w		pls_util_cta_pck.t_varchar2_table_2;
tb_nm_beneficiario_w		pls_util_cta_pck.t_varchar2_table_255;
tb_nm_mae_w			pls_util_cta_pck.t_varchar2_table_255;
tb_nr_cei_w			pls_util_cta_pck.t_varchar2_table_50;
tb_nr_cnpj_w			pls_util_cta_pck.t_varchar2_table_15;
tb_nr_cpf_w			pls_util_cta_pck.t_varchar2_table_15;
tb_nr_dn_w			pls_util_cta_pck.t_varchar2_table_15;
tb_nr_logradouro_w		pls_util_cta_pck.t_varchar2_table_5;
tb_nr_pis_pasep_w		pls_util_cta_pck.t_varchar2_table_15;
tb_nr_plano_ans_w		pls_util_cta_pck.t_varchar2_table_20;
tb_nr_plano_operadora_w		pls_util_cta_pck.t_varchar2_table_20;
tb_nr_plano_portabilidade_w	pls_util_cta_pck.t_varchar2_table_20;
tb_nr_cns_w			pls_util_cta_pck.t_varchar2_table_15;
tb_nr_seq_sib_segurado_w	pls_util_cta_pck.t_number_table;

ie_att_cd_benef_w		pls_util_cta_pck.t_varchar2_table_1;
ie_att_caepf_w			pls_util_cta_pck.t_varchar2_table_1;
ie_att_cep_w			pls_util_cta_pck.t_varchar2_table_1;
ie_att_cd_mot_cancelamento_w	pls_util_cta_pck.t_varchar2_table_1;
ie_att_cd_municipio_ibge_w	pls_util_cta_pck.t_varchar2_table_1;
ie_att_cd_municip_ibge_resid_w	pls_util_cta_pck.t_varchar2_table_1;
ie_att_cd_relacao_depend_w	pls_util_cta_pck.t_varchar2_table_1;
ie_att_cd_sexo_w		pls_util_cta_pck.t_varchar2_table_1;
ie_att_ds_bairro_w		pls_util_cta_pck.t_varchar2_table_1;
ie_att_ds_complemento_w		pls_util_cta_pck.t_varchar2_table_1;
ie_att_ds_logradouro_w		pls_util_cta_pck.t_varchar2_table_1;
ie_att_dt_contratacao_w		pls_util_cta_pck.t_varchar2_table_1;
ie_att_dt_nascimento_w		pls_util_cta_pck.t_varchar2_table_1;
ie_att_dt_reativacao_w		pls_util_cta_pck.t_varchar2_table_1;
ie_att_dt_cancelamento_w	pls_util_cta_pck.t_varchar2_table_1;
ie_att_itens_exclu_cobertura_w	pls_util_cta_pck.t_varchar2_table_1;
ie_att_reside_exterior_w	pls_util_cta_pck.t_varchar2_table_1;
ie_att_tipo_endereco_w		pls_util_cta_pck.t_varchar2_table_1;
ie_att_nm_beneficiario_w	pls_util_cta_pck.t_varchar2_table_1;
ie_att_nm_mae_w			pls_util_cta_pck.t_varchar2_table_1;
ie_att_nr_cei_w			pls_util_cta_pck.t_varchar2_table_1;
ie_att_nr_cnpj_w		pls_util_cta_pck.t_varchar2_table_1;
ie_att_nr_dn_w			pls_util_cta_pck.t_varchar2_table_1;
ie_att_nr_logradouro_w		pls_util_cta_pck.t_varchar2_table_1;
ie_att_nr_pis_pasep_w		pls_util_cta_pck.t_varchar2_table_1;
ie_att_nr_cns_w			pls_util_cta_pck.t_varchar2_table_1;
ie_att_nr_plano_ans_w		pls_util_cta_pck.t_varchar2_table_1;
ie_att_nr_plano_operadora_w	pls_util_cta_pck.t_varchar2_table_1;
ie_att_nr_plano_portab_w	pls_util_cta_pck.t_varchar2_table_1;
ie_att_nr_cpf_w			pls_util_cta_pck.t_varchar2_table_1;

c01 CURSOR FOR
	SELECT	c.nr_sequencia nr_seq_sib_segurado,
		a.nm_beneficiario,
		a.nr_cpf,
		a.cd_declaracao_nasc_vivo,
		a.nr_pis_pasep,
		to_char(a.ie_sexo) ie_sexo,
		a.dt_nascimento,
		a.nm_mae,
		a.ie_tipo_dependencia,
		a.dt_contratacao,
		a.dt_reativacao,
		a.cd_motivo_cancelamento,
		a.nr_plano_ans,
		a.ie_itens_excluidos_cobertura,
		a.nr_cnpj,
		a.nr_cei,
		a.cd_caepf,
		a.ie_reside_exterior,
		a.ie_tipo_endereco,
		a.cd_cep,
		a.ds_logradouro,
		to_char(a.nr_logradouro) nr_logradouro,
		a.ds_complemento,
		a.ds_bairro,
		a.cd_municipio_ibge,
		a.cd_municipio_ibge_resid,
		a.cd_beneficiario,
		a.nr_plano_ops,
		b.nr_sequencia nr_seq_segurado,
		d.cd_estabelecimento,
		obter_dados_pf(b.cd_pessoa_fisica, 'N') nm_pessoa_fisica,
		a.dt_cancelamento,
		a.nr_plano_portabilidade,
		a.cd_cns nr_cns
	from	pls_sib_conferencia a,
		pls_segurado b,
		pls_sib_segurado c,
		pls_sib_conferencia_lote d
	where	a.nr_seq_segurado = b.nr_sequencia
	and	b.nr_sequencia = c.nr_seq_segurado
	and	d.nr_sequencia = a.nr_seq_lote
	and	((coalesce(nr_seq_conf_segurado_p::text, '') = '') or (a.nr_sequencia = nr_seq_conf_segurado_p))
	and	d.nr_sequencia = nr_seq_conferencia_p;

procedure limpar_vetor is;
BEGIN
nr_indice_w	:= 0;
tb_cd_beneficiario_w.delete;
tb_cd_caepf_w.delete;
tb_cd_cep_w.delete;
tb_cd_motivo_cancelamento_w.delete;
tb_cd_municipio_ibge_w.delete;
tb_cd_municipio_ibge_resid_w.delete;
tb_cd_relacao_dependencia_w.delete;
tb_cd_sexo_w.delete;
tb_ds_bairro_w.delete;
tb_ds_complemento_w.delete;
tb_ds_logradouro_w.delete;
tb_dt_contratacao_w.delete;
tb_dt_cancelamento_w.delete;
tb_dt_nascimento_w.delete;
tb_dt_reativacao_w.delete;
tb_ie_itens_exclu_cobertura_w.delete;
tb_ie_reside_exterior_w.delete;
tb_ie_tipo_endereco_w.delete;
tb_nm_beneficiario_w.delete;
tb_nm_mae_w.delete;
tb_nr_cei_w.delete;
tb_nr_cnpj_w.delete;
tb_nr_cpf_w.delete;
tb_nr_dn_w.delete;
tb_nr_logradouro_w.delete;
tb_nr_pis_pasep_w.delete;
tb_nr_cns_w.delete;
tb_nr_plano_ans_w.delete;
tb_nr_plano_operadora_w.delete;
tb_nr_plano_portabilidade_w.delete;
tb_nr_seq_sib_segurado_w.delete;
ie_att_cd_benef_w.delete;
ie_att_caepf_w.delete;
ie_att_cep_w.delete;
ie_att_cd_mot_cancelamento_w.delete;
ie_att_cd_municipio_ibge_w.delete;
ie_att_cd_municip_ibge_resid_w.delete;
ie_att_cd_relacao_depend_w.delete;
ie_att_cd_sexo_w.delete;
ie_att_ds_bairro_w.delete;
ie_att_ds_complemento_w.delete;
ie_att_ds_logradouro_w.delete;
ie_att_dt_contratacao_w.delete;
ie_att_dt_nascimento_w.delete;
ie_att_dt_reativacao_w.delete;
ie_att_dt_cancelamento_w.delete;
ie_att_itens_exclu_cobertura_w.delete;
ie_att_reside_exterior_w.delete;
ie_att_tipo_endereco_w.delete;
ie_att_nm_beneficiario_w.delete;
ie_att_nm_mae_w.delete;
ie_att_nr_cei_w.delete;
ie_att_nr_cnpj_w.delete;
ie_att_nr_dn_w.delete;
ie_att_nr_logradouro_w.delete;
ie_att_nr_pis_pasep_w.delete;
ie_att_nr_cns_w.delete;
ie_att_nr_plano_ans_w.delete;
ie_att_nr_plano_operadora_w.delete;
ie_att_nr_plano_portab_w.delete;
ie_att_nr_cpf_w.delete;
end;
	
procedure alterar_situacao_variavel is
begin
tb_cd_beneficiario_w(nr_indice_w)		:= null;
tb_cd_caepf_w(nr_indice_w)			:= null;
tb_cd_cep_w(nr_indice_w)			:= null;
tb_cd_motivo_cancelamento_w(nr_indice_w)	:= null;
tb_cd_municipio_ibge_w(nr_indice_w)		:= null;
tb_cd_municipio_ibge_resid_w(nr_indice_w)	:= null;
tb_cd_relacao_dependencia_w(nr_indice_w)	:= null;
tb_cd_sexo_w(nr_indice_w)			:= null;
tb_ds_bairro_w(nr_indice_w)			:= null;
tb_ds_complemento_w(nr_indice_w)		:= null;
tb_ds_logradouro_w(nr_indice_w)			:= null;
tb_dt_cancelamento_w(nr_indice_w)		:= null;
tb_dt_contratacao_w(nr_indice_w)		:= null;
tb_dt_nascimento_w(nr_indice_w)			:= null;
tb_dt_reativacao_w(nr_indice_w)			:= null;
tb_ie_itens_exclu_cobertura_w(nr_indice_w)	:= null;
tb_ie_reside_exterior_w(nr_indice_w)		:= null;
tb_ie_tipo_endereco_w(nr_indice_w)		:= null;
tb_nm_beneficiario_w(nr_indice_w)		:= null;
tb_nm_mae_w(nr_indice_w)			:= null;
tb_nr_cei_w(nr_indice_w)			:= null;
tb_nr_cnpj_w(nr_indice_w)			:= null;
tb_nr_cpf_w(nr_indice_w)			:= null;
tb_nr_dn_w(nr_indice_w)				:= null;
tb_nr_logradouro_w(nr_indice_w)			:= null;
tb_nr_pis_pasep_w(nr_indice_w)			:= null;
tb_nr_cns_w(nr_indice_w)			:= null;
tb_nr_plano_ans_w(nr_indice_w)			:= null;
tb_nr_plano_operadora_w(nr_indice_w)		:= null;
tb_nr_plano_portabilidade_w(nr_indice_w)	:= null;
ie_att_cd_benef_w(nr_indice_w)			:= 'N';
ie_att_caepf_w(nr_indice_w)			:= 'N';
ie_att_cep_w(nr_indice_w)			:= 'N';
ie_att_cd_mot_cancelamento_w(nr_indice_w)	:= 'N';
ie_att_cd_municipio_ibge_w(nr_indice_w)		:= 'N';
ie_att_cd_municip_ibge_resid_w(nr_indice_w)	:= 'N';
ie_att_cd_relacao_depend_w(nr_indice_w)		:= 'N';
ie_att_cd_sexo_w(nr_indice_w)			:= 'N';
ie_att_ds_bairro_w(nr_indice_w)			:= 'N';
ie_att_ds_complemento_w(nr_indice_w)		:= 'N';
ie_att_ds_logradouro_w(nr_indice_w)		:= 'N';
ie_att_dt_contratacao_w(nr_indice_w)		:= 'N';
ie_att_dt_nascimento_w(nr_indice_w)		:= 'N';
ie_att_dt_reativacao_w(nr_indice_w)		:= 'N';
ie_att_dt_cancelamento_w(nr_indice_w)		:= 'N';
ie_att_itens_exclu_cobertura_w(nr_indice_w)	:= 'N';
ie_att_reside_exterior_w(nr_indice_w)		:= 'N';
ie_att_tipo_endereco_w(nr_indice_w)		:= 'N';
ie_att_nm_beneficiario_w(nr_indice_w)		:= 'N';
ie_att_nm_mae_w(nr_indice_w)			:= 'N';
ie_att_nr_cei_w(nr_indice_w)			:= 'N';
ie_att_nr_cnpj_w(nr_indice_w)			:= 'N';
ie_att_nr_dn_w(nr_indice_w)			:= 'N';
ie_att_nr_logradouro_w(nr_indice_w)		:= 'N';
ie_att_nr_pis_pasep_w(nr_indice_w)		:= 'N';
ie_att_nr_cns_w(nr_indice_w)			:= 'N';
ie_att_nr_plano_ans_w(nr_indice_w)		:= 'N';
ie_att_nr_plano_operadora_w(nr_indice_w)	:= 'N';
ie_att_nr_plano_portab_w(nr_indice_w)		:= 'N';
ie_att_nr_cpf_w(nr_indice_w)			:= 'N';
end;
	
procedure atualizar_sib_segurado is
begin

if (tb_nr_seq_sib_segurado_w.count > 0) then
	forall i in tb_nr_seq_sib_segurado_w.first..tb_nr_seq_sib_segurado_w.last
		update	pls_sib_segurado
		set	cd_beneficiario		= CASE WHEN ie_att_cd_benef_w(i)='S' THEN  tb_cd_beneficiario_w(i)  ELSE cd_beneficiario END ,
			cd_caepf		= CASE WHEN ie_att_caepf_w(i)='S' THEN  tb_cd_caepf_w(i)  ELSE cd_caepf END ,
			cd_cep			= CASE WHEN ie_att_cep_w(i)='S' THEN  tb_cd_cep_w(i)  ELSE cd_cep END ,
			cd_motivo_cancelamento	= CASE WHEN ie_att_cd_mot_cancelamento_w(i)='S' THEN  tb_cd_motivo_cancelamento_w(i)  ELSE cd_motivo_cancelamento END ,
			cd_municipio_ibge	= CASE WHEN ie_att_cd_municipio_ibge_w(i)='S' THEN  tb_cd_municipio_ibge_w(i)  ELSE cd_municipio_ibge END ,
			cd_municipio_ibge_resid	= CASE WHEN ie_att_cd_municip_ibge_resid_w(i)='S' THEN  tb_cd_municipio_ibge_resid_w(i)  ELSE cd_municipio_ibge_resid END ,
			cd_relacao_dependencia	= CASE WHEN ie_att_cd_relacao_depend_w(i)='S' THEN  tb_cd_relacao_dependencia_w(i)  ELSE cd_relacao_dependencia END ,
			cd_sexo			= CASE WHEN ie_att_cd_sexo_w(i)='S' THEN  tb_cd_sexo_w(i)  ELSE cd_sexo END ,
			ds_bairro		= CASE WHEN ie_att_ds_bairro_w(i)='S' THEN  tb_ds_bairro_w(i)  ELSE ds_bairro END ,
			ds_complemento		= CASE WHEN ie_att_ds_complemento_w(i)='S' THEN  tb_ds_complemento_w(i)  ELSE ds_complemento END ,
			ds_logradouro		= CASE WHEN ie_att_ds_logradouro_w(i)='S' THEN  tb_ds_logradouro_w(i)  ELSE ds_logradouro END ,
			dt_contratacao		= CASE WHEN ie_att_dt_contratacao_w(i)='S' THEN  tb_dt_contratacao_w(i)  ELSE dt_contratacao END ,
			dt_cancelamento		= CASE WHEN ie_att_dt_cancelamento_w(i)='S' THEN  tb_dt_cancelamento_w(i)  ELSE dt_cancelamento END ,
			dt_nascimento		= CASE WHEN ie_att_dt_nascimento_w(i)='S' THEN  tb_dt_nascimento_w(i)  ELSE dt_nascimento END ,
			dt_reativacao		= CASE WHEN ie_att_dt_reativacao_w(i)='S' THEN  tb_dt_reativacao_w(i)  ELSE dt_reativacao END ,
			ie_itens_excluidos_cobertura = CASE WHEN ie_att_itens_exclu_cobertura_w(i)='S' THEN  tb_ie_itens_exclu_cobertura_w(i)  ELSE ie_itens_excluidos_cobertura END ,
			ie_reside_exterior	= CASE WHEN ie_att_reside_exterior_w(i)='S' THEN  tb_ie_reside_exterior_w(i)  ELSE ie_reside_exterior END ,
			ie_tipo_endereco	= CASE WHEN ie_att_tipo_endereco_w(i)='S' THEN  tb_ie_tipo_endereco_w(i)  ELSE ie_tipo_endereco END ,
			nm_beneficiario		= CASE WHEN ie_att_nm_beneficiario_w(i)='S' THEN  tb_nm_beneficiario_w(i)  ELSE nm_beneficiario END ,
			nm_mae			= CASE WHEN ie_att_nm_mae_w(i)='S' THEN  tb_nm_mae_w(i)  ELSE nm_mae END ,
			nr_cei			= CASE WHEN ie_att_nr_cei_w(i)='S' THEN  tb_nr_cei_w(i)  ELSE nr_cei END ,
			nr_cnpj			= CASE WHEN ie_att_nr_cnpj_w(i)='S' THEN  tb_nr_cnpj_w(i)  ELSE nr_cnpj END ,
			nr_cpf			= CASE WHEN ie_att_nr_cpf_w(i)='S' THEN  tb_nr_cpf_w(i)  ELSE nr_cpf END ,
			nr_dn			= CASE WHEN ie_att_nr_dn_w(i)='S' THEN  tb_nr_dn_w(i)  ELSE nr_dn END ,
			nr_logradouro		= CASE WHEN ie_att_nr_logradouro_w(i)='S' THEN  tb_nr_logradouro_w(i)  ELSE nr_logradouro END ,
			nr_pis_pasep		= CASE WHEN ie_att_nr_pis_pasep_w(i)='S' THEN  tb_nr_pis_pasep_w(i)  ELSE nr_pis_pasep END ,
			nr_plano_ans		= CASE WHEN ie_att_nr_plano_ans_w(i)='S' THEN  tb_nr_plano_ans_w(i)  ELSE nr_plano_ans END ,
			nr_plano_operadora	= CASE WHEN ie_att_nr_plano_operadora_w(i)='S' THEN  tb_nr_plano_operadora_w(i)  ELSE nr_plano_operadora END ,
			nr_plano_portabilidade	= CASE WHEN ie_att_nr_plano_portab_w(i)='S' THEN  tb_nr_plano_portabilidade_w(i)  ELSE nr_plano_portabilidade END ,
			nr_cns			= CASE WHEN ie_att_nr_cns_w(i)='S' THEN  tb_nr_cns_w(i)  ELSE nr_cns END
		where	nr_sequencia		= tb_nr_seq_sib_segurado_w(i);
	commit;
end if;

CALL CALL CALL limpar_vetor();

end;

begin

CALL CALL CALL limpar_vetor();

for r_c01_w in c01 loop
	begin
	
	select	count(1)
	into STRICT	qt_sib_segurado_w
	from	pls_sib_segurado
	where	nr_seq_segurado = r_c01_w.nr_seq_segurado;
	
	if (qt_sib_segurado_w > 1) then
		CALL wheb_mensagem_pck.exibir_mensagem_abort(1128858, 'DS_BENEFICIARIO='||r_c01_w.nr_seq_segurado||' - '||r_c01_w.nm_pessoa_fisica);
	else
		select	*
		into STRICT	pls_sib_segurado_w
		from	pls_sib_segurado
		where	nr_sequencia = r_C01_w.nr_seq_sib_segurado;
		
		alterar_situacao_variavel;
		
		CALL pls_sib_dados_benef_pck.carregar_dados(r_c01_w.nr_seq_segurado, r_c01_w.cd_estabelecimento);
		
		tb_nr_seq_sib_segurado_w(nr_indice_w)		:= r_C01_w.nr_seq_sib_segurado;
		
		if	(r_c01_w.cd_beneficiario = pls_sib_dados_benef_pck.cd_beneficiario AND pls_sib_dados_benef_pck.cd_beneficiario <> pls_sib_segurado_w.cd_beneficiario) or
			((coalesce(r_c01_w.cd_beneficiario::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.cd_beneficiario::text, '') = '') and (pls_sib_segurado_w.cd_beneficiario IS NOT NULL AND pls_sib_segurado_w.cd_beneficiario::text <> '')) or
			((r_c01_w.cd_beneficiario IS NOT NULL AND r_c01_w.cd_beneficiario::text <> '') and (pls_sib_dados_benef_pck.cd_beneficiario IS NOT NULL AND pls_sib_dados_benef_pck.cd_beneficiario::text <> '') and (coalesce(pls_sib_segurado_w.cd_beneficiario::text, '') = '')) then
			tb_cd_beneficiario_w(nr_indice_w) := pls_sib_dados_benef_pck.cd_beneficiario;
			ie_att_cd_benef_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.cd_caepf = pls_sib_dados_benef_pck.cd_caepf AND pls_sib_dados_benef_pck.cd_caepf <> pls_sib_segurado_w.cd_caepf) or
			((coalesce(r_c01_w.cd_caepf::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.cd_caepf::text, '') = '') and (pls_sib_segurado_w.cd_caepf IS NOT NULL AND pls_sib_segurado_w.cd_caepf::text <> '')) or
			((r_c01_w.cd_caepf IS NOT NULL AND r_c01_w.cd_caepf::text <> '') and (pls_sib_dados_benef_pck.cd_caepf IS NOT NULL AND pls_sib_dados_benef_pck.cd_caepf::text <> '') and (coalesce(pls_sib_segurado_w.cd_caepf::text, '') = '')) then
			tb_cd_caepf_w(nr_indice_w)	:= pls_sib_dados_benef_pck.cd_caepf;
			ie_att_caepf_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.cd_cep = pls_sib_dados_benef_pck.cd_cep AND pls_sib_dados_benef_pck.cd_cep <> pls_sib_segurado_w.cd_cep) or
			((coalesce(r_c01_w.cd_cep::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.cd_cep::text, '') = '') and (pls_sib_segurado_w.cd_cep IS NOT NULL AND pls_sib_segurado_w.cd_cep::text <> '')) or
			((r_c01_w.cd_cep IS NOT NULL AND r_c01_w.cd_cep::text <> '') and (pls_sib_dados_benef_pck.cd_cep IS NOT NULL AND pls_sib_dados_benef_pck.cd_cep::text <> '') and (coalesce(pls_sib_segurado_w.cd_cep::text, '') = '')) then
			tb_cd_cep_w(nr_indice_w)	:= pls_sib_dados_benef_pck.cd_cep;
			ie_att_cep_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.cd_motivo_cancelamento = pls_sib_dados_benef_pck.cd_motivo_cancelamento AND pls_sib_dados_benef_pck.cd_motivo_cancelamento <> pls_sib_segurado_w.cd_motivo_cancelamento) or
			((coalesce(r_c01_w.cd_motivo_cancelamento::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.cd_motivo_cancelamento::text, '') = '') and (pls_sib_segurado_w.cd_motivo_cancelamento IS NOT NULL AND pls_sib_segurado_w.cd_motivo_cancelamento::text <> '')) or
			((r_c01_w.cd_motivo_cancelamento IS NOT NULL AND r_c01_w.cd_motivo_cancelamento::text <> '') and (pls_sib_dados_benef_pck.cd_motivo_cancelamento IS NOT NULL AND pls_sib_dados_benef_pck.cd_motivo_cancelamento::text <> '') and (coalesce(pls_sib_segurado_w.cd_motivo_cancelamento::text, '') = '')) then
			tb_cd_motivo_cancelamento_w(nr_indice_w)	:= pls_sib_dados_benef_pck.cd_motivo_cancelamento;
			ie_att_cd_mot_cancelamento_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.cd_municipio_ibge = pls_sib_dados_benef_pck.cd_municipio_ibge AND pls_sib_dados_benef_pck.cd_municipio_ibge <> pls_sib_segurado_w.cd_municipio_ibge) or
			((coalesce(r_c01_w.cd_municipio_ibge::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.cd_municipio_ibge::text, '') = '') and (pls_sib_segurado_w.cd_municipio_ibge IS NOT NULL AND pls_sib_segurado_w.cd_municipio_ibge::text <> '')) or
			((r_c01_w.cd_municipio_ibge IS NOT NULL AND r_c01_w.cd_municipio_ibge::text <> '') and (pls_sib_dados_benef_pck.cd_municipio_ibge IS NOT NULL AND pls_sib_dados_benef_pck.cd_municipio_ibge::text <> '') and (coalesce(pls_sib_segurado_w.cd_municipio_ibge::text, '') = '')) then
			tb_cd_municipio_ibge_w(nr_indice_w)	:= pls_sib_dados_benef_pck.cd_municipio_ibge;
			ie_att_cd_municipio_ibge_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.cd_municipio_ibge_resid = pls_sib_dados_benef_pck.cd_municipio_ibge_resid AND pls_sib_dados_benef_pck.cd_municipio_ibge_resid <> pls_sib_segurado_w.cd_municipio_ibge_resid) or
			((coalesce(r_c01_w.cd_municipio_ibge_resid::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.cd_municipio_ibge_resid::text, '') = '') and (pls_sib_segurado_w.cd_municipio_ibge_resid IS NOT NULL AND pls_sib_segurado_w.cd_municipio_ibge_resid::text <> '')) or
			((r_c01_w.cd_municipio_ibge_resid IS NOT NULL AND r_c01_w.cd_municipio_ibge_resid::text <> '') and (pls_sib_dados_benef_pck.cd_municipio_ibge_resid IS NOT NULL AND pls_sib_dados_benef_pck.cd_municipio_ibge_resid::text <> '') and (coalesce(pls_sib_segurado_w.cd_municipio_ibge_resid::text, '') = '')) then
			tb_cd_municipio_ibge_resid_w(nr_indice_w)	:= pls_sib_dados_benef_pck.cd_municipio_ibge_resid;
			ie_att_cd_municip_ibge_resid_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.ie_tipo_dependencia = pls_sib_dados_benef_pck.cd_relacao_dependencia AND pls_sib_dados_benef_pck.cd_relacao_dependencia <> pls_sib_segurado_w.cd_relacao_dependencia) or
			((coalesce(r_c01_w.ie_tipo_dependencia::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.cd_relacao_dependencia::text, '') = '') and (pls_sib_segurado_w.cd_relacao_dependencia IS NOT NULL AND pls_sib_segurado_w.cd_relacao_dependencia::text <> '')) or
			((r_c01_w.ie_tipo_dependencia IS NOT NULL AND r_c01_w.ie_tipo_dependencia::text <> '') and (pls_sib_dados_benef_pck.cd_relacao_dependencia IS NOT NULL AND pls_sib_dados_benef_pck.cd_relacao_dependencia::text <> '') and (coalesce(pls_sib_segurado_w.cd_relacao_dependencia::text, '') = '')) then
			tb_cd_relacao_dependencia_w(nr_indice_w) := pls_sib_dados_benef_pck.cd_relacao_dependencia;
			ie_att_cd_relacao_depend_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.ie_sexo = pls_sib_dados_benef_pck.ie_sexo AND pls_sib_dados_benef_pck.ie_sexo <> pls_sib_segurado_w.cd_sexo) or
			((coalesce(r_c01_w.ie_sexo::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.ie_sexo::text, '') = '') and (pls_sib_segurado_w.cd_sexo IS NOT NULL AND pls_sib_segurado_w.cd_sexo::text <> '')) or
			((r_c01_w.ie_sexo IS NOT NULL AND r_c01_w.ie_sexo::text <> '') and (pls_sib_dados_benef_pck.ie_sexo IS NOT NULL AND pls_sib_dados_benef_pck.ie_sexo::text <> '') and (coalesce(pls_sib_segurado_w.cd_sexo::text, '') = '')) then
			tb_cd_sexo_w(nr_indice_w)	:= pls_sib_dados_benef_pck.ie_sexo;
			ie_att_cd_sexo_w(nr_indice_w)	:= 'S';
		end if;
		
		if	((upper(r_c01_w.ds_bairro) = upper(pls_sib_dados_benef_pck.ds_bairro)) and (upper(pls_sib_dados_benef_pck.ds_bairro) <> upper(pls_sib_segurado_w.ds_bairro))) or
			((coalesce(r_c01_w.ds_bairro::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.ds_bairro::text, '') = '') and (pls_sib_segurado_w.ds_bairro IS NOT NULL AND pls_sib_segurado_w.ds_bairro::text <> '')) or
			((r_c01_w.ds_bairro IS NOT NULL AND r_c01_w.ds_bairro::text <> '') and (pls_sib_dados_benef_pck.ds_bairro IS NOT NULL AND pls_sib_dados_benef_pck.ds_bairro::text <> '') and (coalesce(pls_sib_segurado_w.ds_bairro::text, '') = '')) then
			tb_ds_bairro_w(nr_indice_w)	:= pls_sib_dados_benef_pck.ds_bairro;
			ie_att_ds_bairro_w(nr_indice_w)	:= 'S';
		end if;
		
		if	((upper(r_c01_w.ds_complemento) = upper(pls_sib_dados_benef_pck.ds_complemento)) and (upper(pls_sib_dados_benef_pck.ds_complemento) <> upper(pls_sib_segurado_w.ds_complemento))) or
			((coalesce(r_c01_w.ds_complemento::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.ds_complemento::text, '') = '') and (pls_sib_segurado_w.ds_complemento IS NOT NULL AND pls_sib_segurado_w.ds_complemento::text <> '')) or
			((r_c01_w.ds_complemento IS NOT NULL AND r_c01_w.ds_complemento::text <> '') and (pls_sib_dados_benef_pck.ds_complemento IS NOT NULL AND pls_sib_dados_benef_pck.ds_complemento::text <> '') and (coalesce(pls_sib_segurado_w.ds_complemento::text, '') = '')) then
			tb_ds_complemento_w(nr_indice_w)	:= pls_sib_dados_benef_pck.ds_complemento;
			ie_att_ds_complemento_w(nr_indice_w)	:= 'S';
		end if;
		
		if	((upper(r_c01_w.ds_logradouro) = upper(pls_sib_dados_benef_pck.ds_logradouro)) and (upper(pls_sib_dados_benef_pck.ds_logradouro) <> upper(pls_sib_segurado_w.ds_logradouro))) or
			((coalesce(r_c01_w.ds_logradouro::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.ds_logradouro::text, '') = '') and (pls_sib_segurado_w.ds_logradouro IS NOT NULL AND pls_sib_segurado_w.ds_logradouro::text <> '')) or
			((r_c01_w.ds_logradouro IS NOT NULL AND r_c01_w.ds_logradouro::text <> '') and (pls_sib_dados_benef_pck.ds_logradouro IS NOT NULL AND pls_sib_dados_benef_pck.ds_logradouro::text <> '') and (coalesce(pls_sib_segurado_w.ds_logradouro::text, '') = '')) then
			tb_ds_logradouro_w(nr_indice_w)		:= pls_sib_dados_benef_pck.ds_logradouro;
			ie_att_ds_logradouro_w(nr_indice_w)	:= 'S';
		end if;
		
		if	((trunc(r_c01_w.dt_contratacao,'dd') = trunc(pls_sib_dados_benef_pck.dt_contratacao,'dd')) and (trunc(pls_sib_dados_benef_pck.dt_contratacao,'dd') <> trunc(pls_sib_segurado_w.dt_contratacao,'dd'))) or
			((coalesce(r_c01_w.dt_contratacao::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.dt_contratacao::text, '') = '') and (pls_sib_segurado_w.dt_contratacao IS NOT NULL AND pls_sib_segurado_w.dt_contratacao::text <> '')) or
			((r_c01_w.dt_contratacao IS NOT NULL AND r_c01_w.dt_contratacao::text <> '') and (pls_sib_dados_benef_pck.dt_contratacao IS NOT NULL AND pls_sib_dados_benef_pck.dt_contratacao::text <> '') and (coalesce(pls_sib_segurado_w.dt_contratacao::text, '') = '')) then
			tb_dt_contratacao_w(nr_indice_w)	:= pls_sib_dados_benef_pck.dt_contratacao;
			ie_att_dt_contratacao_w(nr_indice_w)	:= 'S';
		end if;
		
		if	((trunc(r_c01_w.dt_nascimento,'dd') = trunc(pls_sib_dados_benef_pck.dt_nascimento,'dd')) and (trunc(pls_sib_dados_benef_pck.dt_nascimento,'dd') <> trunc(pls_sib_segurado_w.dt_nascimento,'dd'))) or
			((coalesce(r_c01_w.dt_nascimento::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.dt_nascimento::text, '') = '') and (pls_sib_segurado_w.dt_nascimento IS NOT NULL AND pls_sib_segurado_w.dt_nascimento::text <> '')) or
			((r_c01_w.dt_nascimento IS NOT NULL AND r_c01_w.dt_nascimento::text <> '') and (pls_sib_dados_benef_pck.dt_nascimento IS NOT NULL AND pls_sib_dados_benef_pck.dt_nascimento::text <> '') and (coalesce(pls_sib_segurado_w.dt_nascimento::text, '') = '')) then
			tb_dt_nascimento_w(nr_indice_w)		:= pls_sib_dados_benef_pck.dt_nascimento;
			ie_att_dt_nascimento_w(nr_indice_w)	:= 'S';
		end if;
		
		if	((trunc(r_c01_w.dt_reativacao,'dd') = trunc(pls_sib_dados_benef_pck.dt_reativacao,'dd')) and (trunc(pls_sib_dados_benef_pck.dt_reativacao,'dd') <> trunc(pls_sib_segurado_w.dt_reativacao,'dd'))) or
			((coalesce(r_c01_w.dt_reativacao::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.dt_reativacao::text, '') = '') and (pls_sib_segurado_w.dt_reativacao IS NOT NULL AND pls_sib_segurado_w.dt_reativacao::text <> '')) or
			((r_c01_w.dt_reativacao IS NOT NULL AND r_c01_w.dt_reativacao::text <> '') and (pls_sib_dados_benef_pck.dt_reativacao IS NOT NULL AND pls_sib_dados_benef_pck.dt_reativacao::text <> '') and (coalesce(pls_sib_segurado_w.dt_reativacao::text, '') = '')) then
			tb_dt_reativacao_w(nr_indice_w)		:= pls_sib_dados_benef_pck.dt_reativacao;
			ie_att_dt_reativacao_w(nr_indice_w)	:= 'S';
		end if;
		
		if	((trunc(r_c01_w.dt_cancelamento,'dd') = trunc(pls_sib_dados_benef_pck.dt_rescisao,'dd')) and (trunc(pls_sib_dados_benef_pck.dt_rescisao,'dd') <> trunc(pls_sib_segurado_w.dt_cancelamento,'dd'))) or
			((coalesce(r_c01_w.dt_cancelamento::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.dt_rescisao::text, '') = '') and (pls_sib_segurado_w.dt_cancelamento IS NOT NULL AND pls_sib_segurado_w.dt_cancelamento::text <> '')) or
			((r_c01_w.dt_cancelamento IS NOT NULL AND r_c01_w.dt_cancelamento::text <> '') and (pls_sib_dados_benef_pck.dt_rescisao IS NOT NULL AND pls_sib_dados_benef_pck.dt_rescisao::text <> '') and (coalesce(pls_sib_segurado_w.dt_cancelamento::text, '') = '')) then
			tb_dt_cancelamento_w(nr_indice_w)	:= pls_sib_dados_benef_pck.dt_rescisao;
			ie_att_dt_cancelamento_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.ie_itens_excluidos_cobertura = pls_sib_dados_benef_pck.ie_itens_excluidos_cobertura AND pls_sib_dados_benef_pck.ie_itens_excluidos_cobertura <> pls_sib_segurado_w.ie_itens_excluidos_cobertura) or
			((coalesce(r_c01_w.ie_itens_excluidos_cobertura::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.ie_itens_excluidos_cobertura::text, '') = '') and (pls_sib_segurado_w.ie_itens_excluidos_cobertura IS NOT NULL AND pls_sib_segurado_w.ie_itens_excluidos_cobertura::text <> '')) or
			((r_c01_w.ie_itens_excluidos_cobertura IS NOT NULL AND r_c01_w.ie_itens_excluidos_cobertura::text <> '') and (pls_sib_dados_benef_pck.ie_itens_excluidos_cobertura IS NOT NULL AND pls_sib_dados_benef_pck.ie_itens_excluidos_cobertura::text <> '') and (coalesce(pls_sib_segurado_w.ie_itens_excluidos_cobertura::text, '') = '')) then
			tb_ie_itens_exclu_cobertura_w(nr_indice_w)	:= pls_sib_dados_benef_pck.ie_itens_excluidos_cobertura;
			ie_att_itens_exclu_cobertura_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.ie_reside_exterior = pls_sib_dados_benef_pck.ie_reside_exterior AND pls_sib_dados_benef_pck.ie_reside_exterior <> pls_sib_segurado_w.ie_reside_exterior) or
			((coalesce(r_c01_w.ie_reside_exterior::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.ie_reside_exterior::text, '') = '') and (pls_sib_segurado_w.ie_reside_exterior IS NOT NULL AND pls_sib_segurado_w.ie_reside_exterior::text <> '')) or
			((r_c01_w.ie_reside_exterior IS NOT NULL AND r_c01_w.ie_reside_exterior::text <> '') and (pls_sib_dados_benef_pck.ie_reside_exterior IS NOT NULL AND pls_sib_dados_benef_pck.ie_reside_exterior::text <> '') and (coalesce(pls_sib_segurado_w.ie_reside_exterior::text, '') = '')) then
			tb_ie_reside_exterior_w(nr_indice_w)	:= pls_sib_dados_benef_pck.ie_reside_exterior;
			ie_att_reside_exterior_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.ie_tipo_endereco = pls_sib_dados_benef_pck.ie_tipo_endereco AND pls_sib_dados_benef_pck.ie_tipo_endereco <> pls_sib_segurado_w.ie_tipo_endereco) or
			((coalesce(r_c01_w.ie_tipo_endereco::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.ie_tipo_endereco::text, '') = '') and (pls_sib_segurado_w.ie_tipo_endereco IS NOT NULL AND pls_sib_segurado_w.ie_tipo_endereco::text <> '')) or
			((r_c01_w.ie_tipo_endereco IS NOT NULL AND r_c01_w.ie_tipo_endereco::text <> '') and (pls_sib_dados_benef_pck.ie_tipo_endereco IS NOT NULL AND pls_sib_dados_benef_pck.ie_tipo_endereco::text <> '') and (coalesce(pls_sib_segurado_w.ie_tipo_endereco::text, '') = '')) then
			tb_ie_tipo_endereco_w(nr_indice_w)	:= pls_sib_dados_benef_pck.ie_tipo_endereco;
			ie_att_tipo_endereco_w(nr_indice_w)	:= 'S';
		end if;
		
		if	((upper(r_c01_w.nm_beneficiario) = upper(pls_sib_dados_benef_pck.nm_beneficiario)) and (upper(pls_sib_dados_benef_pck.nm_beneficiario) <> upper(pls_sib_segurado_w.nm_beneficiario))) or
			((coalesce(r_c01_w.nm_beneficiario::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.nm_beneficiario::text, '') = '') and (pls_sib_segurado_w.nm_beneficiario IS NOT NULL AND pls_sib_segurado_w.nm_beneficiario::text <> '')) or
			((r_c01_w.nm_beneficiario IS NOT NULL AND r_c01_w.nm_beneficiario::text <> '') and (pls_sib_dados_benef_pck.nm_beneficiario IS NOT NULL AND pls_sib_dados_benef_pck.nm_beneficiario::text <> '') and (coalesce(pls_sib_segurado_w.nm_beneficiario::text, '') = '')) then
			tb_nm_beneficiario_w(nr_indice_w)	:= pls_sib_dados_benef_pck.nm_beneficiario;
			ie_att_nm_beneficiario_w(nr_indice_w)	:= 'S';
		end if;
		
		if	((upper(r_c01_w.nm_mae) = upper(pls_sib_dados_benef_pck.nm_mae)) and (upper(pls_sib_dados_benef_pck.nm_mae) <> upper(pls_sib_segurado_w.nm_mae))) or
			((coalesce(r_c01_w.nm_mae::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.nm_mae::text, '') = '') and (pls_sib_segurado_w.nm_mae IS NOT NULL AND pls_sib_segurado_w.nm_mae::text <> '')) or
			((r_c01_w.nm_mae IS NOT NULL AND r_c01_w.nm_mae::text <> '') and (pls_sib_dados_benef_pck.nm_mae IS NOT NULL AND pls_sib_dados_benef_pck.nm_mae::text <> '') and (coalesce(pls_sib_segurado_w.nm_mae::text, '') = '')) then
			tb_nm_mae_w(nr_indice_w)	:= pls_sib_dados_benef_pck.nm_mae;
			ie_att_nm_mae_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.nr_cei = pls_sib_dados_benef_pck.nr_cei AND pls_sib_dados_benef_pck.nr_cei <> pls_sib_segurado_w.nr_cei) or
			((coalesce(r_c01_w.nr_cei::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.nr_cei::text, '') = '') and (pls_sib_segurado_w.nr_cei IS NOT NULL AND pls_sib_segurado_w.nr_cei::text <> '')) or
			((r_c01_w.nr_cei IS NOT NULL AND r_c01_w.nr_cei::text <> '') and (pls_sib_dados_benef_pck.nr_cei IS NOT NULL AND pls_sib_dados_benef_pck.nr_cei::text <> '') and (coalesce(pls_sib_segurado_w.nr_cei::text, '') = '')) then
			tb_nr_cei_w(nr_indice_w)	:= pls_sib_dados_benef_pck.nr_cei;
			ie_att_nr_cei_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.nr_cnpj = pls_sib_dados_benef_pck.nr_cnpj AND pls_sib_dados_benef_pck.nr_cnpj <> pls_sib_segurado_w.nr_cnpj) or
			((coalesce(r_c01_w.nr_cnpj::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.nr_cnpj::text, '') = '') and (pls_sib_segurado_w.nr_cnpj IS NOT NULL AND pls_sib_segurado_w.nr_cnpj::text <> '')) or
			((r_c01_w.nr_cnpj IS NOT NULL AND r_c01_w.nr_cnpj::text <> '') and (pls_sib_dados_benef_pck.nr_cnpj IS NOT NULL AND pls_sib_dados_benef_pck.nr_cnpj::text <> '') and (coalesce(pls_sib_segurado_w.nr_cnpj::text, '') = '')) then
			tb_nr_cnpj_w(nr_indice_w)	:= pls_sib_dados_benef_pck.nr_cnpj;
			ie_att_nr_cnpj_w(nr_indice_w)	:= 'S';
		end if;
		
		if	((somente_numero(r_c01_w.nr_cpf) = somente_numero(pls_sib_dados_benef_pck.nr_cpf)) and (somente_numero(pls_sib_dados_benef_pck.nr_cpf) <> somente_numero(pls_sib_segurado_w.nr_cpf))) or
			((coalesce(r_c01_w.nr_cpf::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.nr_cpf::text, '') = '') and (pls_sib_segurado_w.nr_cpf IS NOT NULL AND pls_sib_segurado_w.nr_cpf::text <> '')) or
			((r_c01_w.nr_cpf IS NOT NULL AND r_c01_w.nr_cpf::text <> '') and (pls_sib_dados_benef_pck.nr_cpf IS NOT NULL AND pls_sib_dados_benef_pck.nr_cpf::text <> '') and (coalesce(pls_sib_segurado_w.nr_cpf::text, '') = '')) then
			tb_nr_cpf_w(nr_indice_w)	:= pls_sib_dados_benef_pck.nr_cpf;
			ie_att_nr_cpf_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.cd_declaracao_nasc_vivo = pls_sib_dados_benef_pck.cd_declaracao_nasc_vivo AND pls_sib_dados_benef_pck.cd_declaracao_nasc_vivo <> pls_sib_segurado_w.nr_dn) or
			((coalesce(r_c01_w.cd_declaracao_nasc_vivo::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.cd_declaracao_nasc_vivo::text, '') = '') and (pls_sib_segurado_w.nr_dn IS NOT NULL AND pls_sib_segurado_w.nr_dn::text <> '')) or
			((r_c01_w.cd_declaracao_nasc_vivo IS NOT NULL AND r_c01_w.cd_declaracao_nasc_vivo::text <> '') and (pls_sib_dados_benef_pck.cd_declaracao_nasc_vivo IS NOT NULL AND pls_sib_dados_benef_pck.cd_declaracao_nasc_vivo::text <> '') and (coalesce(pls_sib_segurado_w.nr_dn::text, '') = '')) then
			tb_nr_dn_w(nr_indice_w)		:= pls_sib_dados_benef_pck.cd_declaracao_nasc_vivo;
			ie_att_nr_dn_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.nr_logradouro = pls_sib_dados_benef_pck.nr_logradouro AND pls_sib_dados_benef_pck.nr_logradouro <> pls_sib_segurado_w.nr_logradouro) or
			((coalesce(r_c01_w.nr_logradouro::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.nr_logradouro::text, '') = '') and (pls_sib_segurado_w.nr_logradouro IS NOT NULL AND pls_sib_segurado_w.nr_logradouro::text <> '')) or
			((r_c01_w.nr_logradouro IS NOT NULL AND r_c01_w.nr_logradouro::text <> '') and (pls_sib_dados_benef_pck.nr_logradouro IS NOT NULL AND pls_sib_dados_benef_pck.nr_logradouro::text <> '') and (coalesce(pls_sib_segurado_w.nr_logradouro::text, '') = '')) then
			tb_nr_logradouro_w(nr_indice_w)		:= pls_sib_dados_benef_pck.nr_logradouro;
			ie_att_nr_logradouro_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.nr_pis_pasep = pls_sib_dados_benef_pck.cd_pis_pasep AND pls_sib_dados_benef_pck.cd_pis_pasep <> pls_sib_segurado_w.nr_pis_pasep) or
			((coalesce(r_c01_w.nr_pis_pasep::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.cd_pis_pasep::text, '') = '') and (pls_sib_segurado_w.nr_pis_pasep IS NOT NULL AND pls_sib_segurado_w.nr_pis_pasep::text <> '')) or
			((r_c01_w.nr_pis_pasep IS NOT NULL AND r_c01_w.nr_pis_pasep::text <> '') and (pls_sib_dados_benef_pck.cd_pis_pasep IS NOT NULL AND pls_sib_dados_benef_pck.cd_pis_pasep::text <> '') and (coalesce(pls_sib_segurado_w.nr_pis_pasep::text, '') = '')) then
			tb_nr_pis_pasep_w(nr_indice_w)		:= pls_sib_dados_benef_pck.cd_pis_pasep;
			ie_att_nr_pis_pasep_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.nr_cns = pls_sib_dados_benef_pck.nr_cartao_nac_sus AND pls_sib_dados_benef_pck.nr_cartao_nac_sus <> pls_sib_segurado_w.nr_cns) or
			((coalesce(r_c01_w.nr_cns::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.nr_cartao_nac_sus::text, '') = '') and (pls_sib_segurado_w.nr_cns IS NOT NULL AND pls_sib_segurado_w.nr_cns::text <> '')) or
			((r_c01_w.nr_cns IS NOT NULL AND r_c01_w.nr_cns::text <> '') and (pls_sib_dados_benef_pck.nr_cartao_nac_sus IS NOT NULL AND pls_sib_dados_benef_pck.nr_cartao_nac_sus::text <> '') and (coalesce(pls_sib_segurado_w.nr_cns::text, '') = '')) then
			tb_nr_cns_w(nr_indice_w)		:= pls_sib_dados_benef_pck.nr_cartao_nac_sus;
			ie_att_nr_cns_w(nr_indice_w)	:= 'S';
		end if;
		
		if	((upper(r_c01_w.nr_plano_ans) = upper(pls_sib_dados_benef_pck.nr_plano_ans)) and (upper(pls_sib_dados_benef_pck.nr_plano_ans) <> upper(pls_sib_segurado_w.nr_plano_ans))) or
			((coalesce(r_c01_w.nr_plano_ans::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.nr_plano_ans::text, '') = '') and (pls_sib_segurado_w.nr_plano_ans IS NOT NULL AND pls_sib_segurado_w.nr_plano_ans::text <> '')) or
			((r_c01_w.nr_plano_ans IS NOT NULL AND r_c01_w.nr_plano_ans::text <> '') and (pls_sib_dados_benef_pck.nr_plano_ans IS NOT NULL AND pls_sib_dados_benef_pck.nr_plano_ans::text <> '') and (coalesce(pls_sib_segurado_w.nr_plano_ans::text, '') = '')) then
			tb_nr_plano_ans_w(nr_indice_w)		:= pls_sib_dados_benef_pck.nr_plano_ans;
			ie_att_nr_plano_ans_w(nr_indice_w)	:= 'S';
		end if;
		
		if	((upper(r_c01_w.nr_plano_ops) = upper(pls_sib_dados_benef_pck.nr_plano_operadora)) and (upper(pls_sib_dados_benef_pck.nr_plano_operadora) <> upper(pls_sib_segurado_w.nr_plano_operadora))) or
			((coalesce(r_c01_w.nr_plano_ops::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.nr_plano_operadora::text, '') = '') and (pls_sib_segurado_w.nr_plano_operadora IS NOT NULL AND pls_sib_segurado_w.nr_plano_operadora::text <> '')) or
			((r_c01_w.nr_plano_ops IS NOT NULL AND r_c01_w.nr_plano_ops::text <> '') and (pls_sib_dados_benef_pck.nr_plano_operadora IS NOT NULL AND pls_sib_dados_benef_pck.nr_plano_operadora::text <> '') and (coalesce(pls_sib_segurado_w.nr_plano_operadora::text, '') = '')) then
			tb_nr_plano_operadora_w(nr_indice_w)		:= pls_sib_dados_benef_pck.nr_plano_operadora;
			ie_att_nr_plano_operadora_w(nr_indice_w)	:= 'S';
		end if;
		
		if	(r_c01_w.nr_plano_portabilidade = pls_sib_dados_benef_pck.nr_plano_portabilidade AND pls_sib_dados_benef_pck.nr_plano_portabilidade <> pls_sib_segurado_w.nr_plano_portabilidade) or
			((coalesce(r_c01_w.nr_plano_portabilidade::text, '') = '') and (coalesce(pls_sib_dados_benef_pck.nr_plano_portabilidade::text, '') = '') and (pls_sib_segurado_w.nr_plano_portabilidade IS NOT NULL AND pls_sib_segurado_w.nr_plano_portabilidade::text <> '')) or
			((r_c01_w.nr_plano_portabilidade IS NOT NULL AND r_c01_w.nr_plano_portabilidade::text <> '') and (pls_sib_dados_benef_pck.nr_plano_portabilidade IS NOT NULL AND pls_sib_dados_benef_pck.nr_plano_portabilidade::text <> '') and (coalesce(pls_sib_segurado_w.nr_plano_portabilidade::text, '') = '')) then
			tb_nr_plano_portabilidade_w(nr_indice_w) := pls_sib_dados_benef_pck.nr_plano_portabilidade;
			ie_att_nr_plano_portab_w(nr_indice_w)	:= 'S';
		end if;
		
		if (nr_indice_w = pls_util_pck.qt_registro_transacao_w) then
			atualizar_sib_segurado;
		else
			nr_indice_w	:= nr_indice_w + 1;
		end if;
	end if;
	end;
end loop;

pls_consistir_conferencia_pck.consistir_conferencia(nr_seq_conferencia_p, nr_seq_conf_segurado_p, nm_usuario_p);

atualizar_sib_segurado;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_atualiza_sib_segurado_conf ( nr_seq_conferencia_p pls_sib_conferencia_lote.nr_sequencia%type, nr_seq_conf_segurado_p pls_sib_conferencia.nr_sequencia%type, nm_usuario_p usuario.nm_usuario%type) FROM PUBLIC;

