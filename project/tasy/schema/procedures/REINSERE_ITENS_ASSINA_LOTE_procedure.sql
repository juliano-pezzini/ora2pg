-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE reinsere_itens_assina_lote ( nm_usuario_p text, dt_inicio_p timestamp , dt_final_p timestamp ) AS $body$
DECLARE


nm_tabela_ww            varchar(1024);
ds_projeto_ww           varchar(1024);
ie_tipo_assinatura_ww   varchar(2);
nr_seq_reg_ww           bigint;
nr_seq_visao_ww         bigint;
ie_se_assinado_w varchar(1);
ie_should_sign bigint;
qt_reg_w bigint;

c01 CURSOR FOR
  SELECT distinct nr_seq_item_pend,
        cd_pessoa_fisica,
        dt_registro,
        nr_seq_item_orig_pront,
        nm_usuario,
        nr_atendimento,
        nr_projeto
  from   pep_item_pend_assina
  where  dt_registro between dt_inicio_p and dt_final_p
  and    nm_usuario = nm_usuario_p
  and    (nr_projeto IS NOT NULL AND nr_projeto::text <> '');

c02 CURSOR FOR
  SELECT distinct nr_sequencia,
        cd_pessoa_fisica,
        dt_liberacao,
        nr_item,
        nm_usuario,
        nr_atendimento,
        nr_projeto
  from   pepo_item_pendente_pep_v
  where  (nr_projeto IS NOT NULL AND nr_projeto::text <> '')
  and    nm_usuario  = nm_usuario_p
  and    dt_liberacao between dt_inicio_p and dt_final_p
  and    (dt_liberacao IS NOT NULL AND dt_liberacao::text <> '');

cursor01_w c01%rowtype;
cursor02_w c02%rowtype;


BEGIN
open c01;
loop
fetch c01 into cursor01_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
begin
  select max(nr_sequencia)
  into STRICT nr_seq_reg_ww
  from tasy_assinatura_lote
  where nr_seq_registro = cursor01_w.nr_seq_item_pend
  and nr_proj_assinatura = cursor01_w.nr_projeto;

	select  count(ie_assinatura)
	into STRICT    ie_should_sign
	from    tasy_proj_assin_perfil
	where   nr_seq_proj = cursor01_w.nr_projeto
	and coalesce(ie_assinatura, 'N') = 'N';

  if (coalesce(nr_seq_reg_ww, 0) > 0 or ((ie_should_sign IS NOT NULL AND ie_should_sign::text <> '') and ie_should_sign > 0)) then
    goto final;
  end if;

  select  nm_tabela,
          ds_projeto
  into STRICT    nm_tabela_ww,
          ds_projeto_ww
  from    tasy_projeto_assinatura
  where   nr_sequencia = cursor01_w.nr_projeto;

  select  max(nr_sequencia)
  into STRICT    nr_seq_visao_ww
  from    tabela_visao
  where (  cursor01_w.nr_projeto = ne_seq_projeto_liberacao
          or cursor01_w.nr_projeto = ne_seq_projeto_inativacao);

  if ds_projeto_ww like '%ADI%' then
    ie_tipo_assinatura_ww := 'I';
  else
    ie_tipo_assinatura_ww := 'L';
  end if;

   select	verifica_se_assinado(nm_tabela_ww,cursor01_w.nr_projeto,cursor01_w.nr_seq_item_pend,ie_tipo_assinatura_ww) 
   into STRICT		ie_se_assinado_w 
;

   if (ie_se_assinado_w = 'S')then
	goto final;
   end if;

  if cursor01_w.nr_projeto = 51422 or cursor01_w.nr_projeto = 51423 then
    nr_seq_visao_ww := 29691;
  elsif cursor01_w.nr_projeto = 51432 or cursor01_w.nr_projeto = 51433 then
    nr_seq_visao_ww := 29698;
  elsif cursor01_w.nr_projeto = 25177 or cursor01_w.nr_projeto = 25234 then
    nr_seq_visao_ww := 29776;
  elsif cursor01_w.nr_projeto = 183 or cursor01_w.nr_projeto = 25230 then
    nr_seq_visao_ww := 29796;
  elsif cursor01_w.nr_projeto = 50336 or cursor01_w.nr_projeto = 50337 then
    nr_seq_visao_ww := 33068;
  elsif cursor01_w.nr_projeto = 50792 or cursor01_w.nr_projeto = 50793 then
    nr_seq_visao_ww := 33147;
  elsif cursor01_w.nr_projeto = 44284 or cursor01_w.nr_projeto = 44280 then
    nr_seq_visao_ww := 33148;
  elsif cursor01_w.nr_projeto = 51118 or cursor01_w.nr_projeto = 51119 then
    nr_seq_visao_ww := 33171;
  elsif cursor01_w.nr_projeto = 50334 or cursor01_w.nr_projeto = 50335 then
    nr_seq_visao_ww := 33241;
  elsif cursor01_w.nr_projeto = 184 or cursor01_w.nr_projeto = 25231 then
    nr_seq_visao_ww := 97295;
  elsif cursor01_w.nr_projeto = 25185 or cursor01_w.nr_projeto = 25239 then
    nr_seq_visao_ww := 68825;
  elsif cursor01_w.nr_projeto = 51498 then
    nr_seq_visao_ww := 70222;
  elsif cursor01_w.nr_projeto = 50452 then
    nr_seq_visao_ww := 70225;
  elsif cursor01_w.nr_projeto = 51112 or cursor01_w.nr_projeto = 51113 then
    nr_seq_visao_ww := 104704;
  elsif cursor01_w.nr_projeto = 51114 or cursor01_w.nr_projeto = 51114 then
    nr_seq_visao_ww := 104785;
  elsif cursor01_w.nr_projeto = 51346 or cursor01_w.nr_projeto = 51347 then
    nr_seq_visao_ww := 105135;
  elsif cursor01_w.nr_projeto = 53480 or cursor01_w.nr_projeto = 53481 then
    nr_seq_visao_ww := 101059;
  elsif cursor01_w.nr_projeto = 51352 or cursor01_w.nr_projeto = 51353 then
    nr_seq_visao_ww := 29603;
  elsif cursor01_w.nr_projeto = 51440 or cursor01_w.nr_projeto = 51441 then
    nr_seq_visao_ww := 29611;
  elsif cursor01_w.nr_projeto = 51337 or cursor01_w.nr_projeto = 51339 then
    nr_seq_visao_ww := 29675;
  elsif cursor01_w.nr_projeto = 51414 or cursor01_w.nr_projeto = 51415 then
    nr_seq_visao_ww := 29677;
  elsif cursor01_w.nr_projeto = 51344 or cursor01_w.nr_projeto = 51345 then
    nr_seq_visao_ww := 29678;
  elsif cursor01_w.nr_projeto = 52848 or cursor01_w.nr_projeto = 52868 then
    nr_seq_visao_ww := 29499;
  elsif cursor01_w.nr_projeto = 51438 or cursor01_w.nr_projeto = 51439 then
    nr_seq_visao_ww := 29694;
  elsif cursor01_w.nr_projeto = 53471 or cursor01_w.nr_projeto = 53472 then
    nr_seq_visao_ww := 29722;
  elsif cursor01_w.nr_projeto = 25176 or cursor01_w.nr_projeto = 25238 then
    nr_seq_visao_ww := 29779;
  elsif cursor01_w.nr_projeto = 51488 or cursor01_w.nr_projeto = 51489 then
    nr_seq_visao_ww := 29780;
  elsif cursor01_w.nr_projeto = 25181 or cursor01_w.nr_projeto = 25244 then
    nr_seq_visao_ww := 29782;
  elsif cursor01_w.nr_projeto = 51688 or cursor01_w.nr_projeto = 49782 then
    nr_seq_visao_ww := 29792;
  elsif cursor01_w.nr_projeto = 51501 or cursor01_w.nr_projeto = 51502 then
    nr_seq_visao_ww := 29793;
  elsif cursor01_w.nr_projeto = 50472 or cursor01_w.nr_projeto = 50473 then
    nr_seq_visao_ww := 29804;
  elsif cursor01_w.nr_projeto = 51092 or cursor01_w.nr_projeto = 51094 then
    nr_seq_visao_ww := 33120;
  elsif cursor01_w.nr_projeto = 50972 or cursor01_w.nr_projeto = 50973 then
    nr_seq_visao_ww := 33161;
  elsif cursor01_w.nr_projeto = 50692 or cursor01_w.nr_projeto = 50693 then
    nr_seq_visao_ww := 33191;
  elsif cursor01_w.nr_projeto = 50658 or cursor01_w.nr_projeto = 50654 then
    nr_seq_visao_ww := 33194;
  elsif cursor01_w.nr_projeto = 53468 or cursor01_w.nr_projeto = 53470 then
    nr_seq_visao_ww := 45196;
  elsif cursor01_w.nr_projeto = 51072 or cursor01_w.nr_projeto = 51073 then
    nr_seq_visao_ww := 33287;
  elsif cursor01_w.nr_projeto = 51097 or cursor01_w.nr_projeto = 51098 then
    nr_seq_visao_ww := 104788;
  elsif cursor01_w.nr_projeto = 52908 or cursor01_w.nr_projeto = 52910 then
    nr_seq_visao_ww := 29941;
  elsif cursor01_w.nr_projeto = 50713 or cursor01_w.nr_projeto = 50714 then
    nr_seq_visao_ww := 29556;
  elsif cursor01_w.nr_projeto = 51132 or cursor01_w.nr_projeto = 51133 then
    nr_seq_visao_ww := 29581;
  elsif cursor01_w.nr_projeto = 53462 or cursor01_w.nr_projeto = 53463 then
    nr_seq_visao_ww := 29668;
  elsif cursor01_w.nr_projeto = 53486 or cursor01_w.nr_projeto = 53488 then
    nr_seq_visao_ww := 10025252;
  elsif cursor01_w.nr_projeto = 50152 or cursor01_w.nr_projeto = 50153 then
    nr_seq_visao_ww := 105537;
  elsif cursor01_w.nr_projeto = 51478 or cursor01_w.nr_projeto = 51479 then
    nr_seq_visao_ww := 29683;
  elsif cursor01_w.nr_projeto = 51550 or cursor01_w.nr_projeto = 51551 then
    nr_seq_visao_ww := 29799;
  elsif cursor01_w.nr_projeto = 51335 or cursor01_w.nr_projeto = 51336 then
    nr_seq_visao_ww := 29853;
  elsif cursor01_w.nr_projeto = 53399 or cursor01_w.nr_projeto = 53400 then
    nr_seq_visao_ww := 33085;
  elsif cursor01_w.nr_projeto = 50952 or cursor01_w.nr_projeto = 50953 then
    nr_seq_visao_ww := 33140;
  elsif cursor01_w.nr_projeto = 50852 or cursor01_w.nr_projeto = 50854 then
    nr_seq_visao_ww := 33167;
  elsif cursor01_w.nr_projeto = 51101 or cursor01_w.nr_projeto = 51102 then
    nr_seq_visao_ww := 33170;
  elsif cursor01_w.nr_projeto = 50752 or cursor01_w.nr_projeto = 50753 then
    nr_seq_visao_ww := 33185;
  elsif cursor01_w.nr_projeto = 51115 then
    nr_seq_visao_ww := 33200;
  elsif cursor01_w.nr_projeto = 53573 or cursor01_w.nr_projeto = 53574 then
    nr_seq_visao_ww := 102704;
  elsif cursor01_w.nr_projeto = 51373 or cursor01_w.nr_projeto = 51374 then
    nr_seq_visao_ww := 67732;
  elsif cursor01_w.nr_projeto = 51099 or cursor01_w.nr_projeto = 51100 then
    nr_seq_visao_ww := 104784;
  elsif cursor01_w.nr_projeto = 50718 or cursor01_w.nr_projeto = 50719 then
    nr_seq_visao_ww := 30017;
  elsif cursor01_w.nr_projeto = 36671 or cursor01_w.nr_projeto = 36673 then
    nr_seq_visao_ww := 29566;
  elsif cursor01_w.nr_projeto = 51172 or cursor01_w.nr_projeto = 51173 then
    nr_seq_visao_ww := 29595;
  elsif cursor01_w.nr_projeto = 51480 or cursor01_w.nr_projeto = 51481 then
    nr_seq_visao_ww := 29612;
  elsif cursor01_w.nr_projeto = 50715 or cursor01_w.nr_projeto = 50716 then
    nr_seq_visao_ww := 29621;
  elsif cursor01_w.nr_projeto = 51484 or cursor01_w.nr_projeto = 51485 then
    nr_seq_visao_ww := 29622;
  elsif cursor01_w.nr_projeto = 53609 or cursor01_w.nr_projeto = 53608 then
    nr_seq_visao_ww := 104544;
  elsif cursor01_w.nr_projeto = 53622 or cursor01_w.nr_projeto = 53621 then
    nr_seq_visao_ww := 104573;
  elsif cursor01_w.nr_projeto = 53613 or cursor01_w.nr_projeto = 53612 then
    nr_seq_visao_ww := 104587;
  elsif cursor01_w.nr_projeto = 53616 or cursor01_w.nr_projeto = 53617 then
    nr_seq_visao_ww := 104600;
  elsif cursor01_w.nr_projeto = 53208 or cursor01_w.nr_projeto = 53209 then
    nr_seq_visao_ww := 29238;
  elsif cursor01_w.nr_projeto = 52889 or cursor01_w.nr_projeto = 52890 then
    nr_seq_visao_ww := 29263;
  elsif cursor01_w.nr_projeto = 25186 or cursor01_w.nr_projeto = 25243 then
    nr_seq_visao_ww := 29283;
  elsif cursor01_w.nr_projeto = 53450 or cursor01_w.nr_projeto = 53451 then
    nr_seq_visao_ww := 29491;
  elsif cursor01_w.nr_projeto = 51420 or cursor01_w.nr_projeto = 51421 then
    nr_seq_visao_ww := 29688;
  elsif cursor01_w.nr_projeto = 52129 or cursor01_w.nr_projeto = 52130 then
    nr_seq_visao_ww := 29719;
  elsif cursor01_w.nr_projeto = 25180 or cursor01_w.nr_projeto = 25237 then
    nr_seq_visao_ww := 29777;
  elsif cursor01_w.nr_projeto = 25178 or cursor01_w.nr_projeto = 25236 then
    nr_seq_visao_ww := 29778;
  elsif cursor01_w.nr_projeto = 51508 or cursor01_w.nr_projeto = 49779 then
    nr_seq_visao_ww := 29791;
  elsif cursor01_w.nr_projeto = 50912 or cursor01_w.nr_projeto = 50913 then
    nr_seq_visao_ww := 33159;
  elsif cursor01_w.nr_projeto = 51342 or cursor01_w.nr_projeto = 51343 then
    nr_seq_visao_ww := 42025;
  elsif cursor01_w.nr_projeto = 53666 or cursor01_w.nr_projeto = 53667 then
    nr_seq_visao_ww := 72890;
  elsif cursor01_w.nr_projeto = 51095 or cursor01_w.nr_projeto = 51096 then
    nr_seq_visao_ww := 104786;
  elsif cursor01_w.nr_projeto = 53210 or cursor01_w.nr_projeto = 53211 then
    nr_seq_visao_ww := 29937;
  elsif cursor01_w.nr_projeto = 51348 or cursor01_w.nr_projeto = 51349 then
    nr_seq_visao_ww := 29599;
  elsif cursor01_w.nr_projeto = 51482 or cursor01_w.nr_projeto = 51483 then
    nr_seq_visao_ww := 29628;
  elsif cursor01_w.nr_projeto = 51434 or cursor01_w.nr_projeto = 51435 then
    nr_seq_visao_ww := 29669;
  elsif cursor01_w.nr_projeto = 53604 or cursor01_w.nr_projeto = 53602 then
    nr_seq_visao_ww := 104495;
  elsif cursor01_w.nr_projeto = 53658 or cursor01_w.nr_projeto = 53659 then
    nr_seq_visao_ww := 29254;
  elsif cursor01_w.nr_projeto = 25175 or cursor01_w.nr_projeto = 25235 then
    nr_seq_visao_ww := 29775;
  elsif cursor01_w.nr_projeto = 25179 or cursor01_w.nr_projeto = 25247 then
    nr_seq_visao_ww := 29784;
  elsif cursor01_w.nr_projeto = 25174 or cursor01_w.nr_projeto = 25246 then
    nr_seq_visao_ww := 29785;
  elsif cursor01_w.nr_projeto = 51492 or cursor01_w.nr_projeto = 51493 then
    nr_seq_visao_ww := 29787;
  elsif cursor01_w.nr_projeto = 53675 or cursor01_w.nr_projeto = 53676 then
    nr_seq_visao_ww := 29794;
  elsif cursor01_w.nr_projeto = 50632 or cursor01_w.nr_projeto = 50633 then
    nr_seq_visao_ww := 33132;
  elsif cursor01_w.nr_projeto = 25173 or cursor01_w.nr_projeto = 25232 then
    nr_seq_visao_ww := 33141;
  elsif cursor01_w.nr_projeto = 44469 or cursor01_w.nr_projeto = 44470 then
    nr_seq_visao_ww := 33144;
  elsif cursor01_w.nr_projeto = 50872 or cursor01_w.nr_projeto = 50873 then
    nr_seq_visao_ww := 33193;
  elsif cursor01_w.nr_projeto = 50338 or cursor01_w.nr_projeto = 50339 then
    nr_seq_visao_ww := 33237;
  elsif cursor01_w.nr_projeto = 50332 or cursor01_w.nr_projeto = 50333 then
    nr_seq_visao_ww := 33243;
  elsif cursor01_w.nr_projeto = 25184 or cursor01_w.nr_projeto = 25240 then
    nr_seq_visao_ww := 33258;
  elsif cursor01_w.nr_projeto = 25187 or cursor01_w.nr_projeto = 25248 then
    nr_seq_visao_ww := 33314;
  elsif cursor01_w.nr_projeto = 51116 or cursor01_w.nr_projeto = 51117 then
    nr_seq_visao_ww := 104787;
  elsif cursor01_w.nr_projeto = 50723 or cursor01_w.nr_projeto = 50724 then
    nr_seq_visao_ww := 29550;
  elsif cursor01_w.nr_projeto = 51350 or cursor01_w.nr_projeto = 51351 then
    nr_seq_visao_ww := 29600;
  elsif cursor01_w.nr_projeto = 51436 or cursor01_w.nr_projeto = 51437 then
    nr_seq_visao_ww := 29635;
  elsif cursor01_w.nr_projeto = 51428 or cursor01_w.nr_projeto = 51429 then
    nr_seq_visao_ww := 29664;
  elsif cursor01_w.nr_projeto = 51340 or cursor01_w.nr_projeto = 51341 then
    nr_seq_visao_ww := 29672;
  elsif cursor01_w.nr_projeto = 53597 or cursor01_w.nr_projeto = 53595 then
    nr_seq_visao_ww := 104308;
  elsif cursor01_w.nr_projeto = 53605 or cursor01_w.nr_projeto = 53603 then
    nr_seq_visao_ww := 104497;
  elsif cursor01_w.nr_projeto = 53615 or cursor01_w.nr_projeto = 53614 then
    nr_seq_visao_ww := 104599;
  elsif cursor01_w.nr_projeto = 53626 or cursor01_w.nr_projeto = 53624 then
    nr_seq_visao_ww := 104653;
  elsif cursor01_w.nr_projeto = 53627 or cursor01_w.nr_projeto = 53628 then
    nr_seq_visao_ww := 104699;
  elsif cursor01_w.nr_projeto = 53662 or cursor01_w.nr_projeto = 53663 then
    nr_seq_visao_ww := 29259;
  elsif cursor01_w.nr_projeto = 51424 or cursor01_w.nr_projeto = 51425 then
    nr_seq_visao_ww := 29682;
  elsif cursor01_w.nr_projeto = 53214 or cursor01_w.nr_projeto = 53213 then
    nr_seq_visao_ww := 29701;
  elsif cursor01_w.nr_projeto = 51490 or cursor01_w.nr_projeto = 51491 then
    nr_seq_visao_ww := 29781;
  elsif cursor01_w.nr_projeto = 25182 or cursor01_w.nr_projeto = 25245 then
    nr_seq_visao_ww := 29783;
  elsif cursor01_w.nr_projeto = 51494 or cursor01_w.nr_projeto = 51495 then
    nr_seq_visao_ww := 29788;
  elsif cursor01_w.nr_projeto = 50192 or cursor01_w.nr_projeto = 50193 then
    nr_seq_visao_ww := 30085;
  elsif cursor01_w.nr_projeto = 53452 or cursor01_w.nr_projeto = 53453 then
    nr_seq_visao_ww := 31514;
  elsif cursor01_w.nr_projeto = 43057 or cursor01_w.nr_projeto = 43058 then
    nr_seq_visao_ww := 33112;
  elsif cursor01_w.nr_projeto = 50672 or cursor01_w.nr_projeto = 50673 then
    nr_seq_visao_ww := 33142;
  elsif cursor01_w.nr_projeto = 50992 or cursor01_w.nr_projeto = 50993 then
    nr_seq_visao_ww := 33162;
  elsif cursor01_w.nr_projeto = 52169 or cursor01_w.nr_projeto = 52168 then
    nr_seq_visao_ww := 33195;
  elsif cursor01_w.nr_projeto = 50733 or cursor01_w.nr_projeto = 50734 then
    nr_seq_visao_ww := 33235;
  elsif cursor01_w.nr_projeto = 25183 or cursor01_w.nr_projeto = 25241 then
    nr_seq_visao_ww := 33257;
  elsif cursor01_w.nr_projeto = 25170 or cursor01_w.nr_projeto = 25242 then
    nr_seq_visao_ww := 68824;
  elsif cursor01_w.nr_projeto = 25290 or cursor01_w.nr_projeto = 25291 then
    nr_seq_visao_ww := 29885;
  elsif cursor01_w.nr_projeto = 51748 then
    nr_seq_visao_ww := 29896;
  elsif cursor01_w.nr_projeto = 51418 or cursor01_w.nr_projeto = 51419 then
    nr_seq_visao_ww := 29639;
  elsif cursor01_w.nr_projeto = 53681 or cursor01_w.nr_projeto = 53682 then
    nr_seq_visao_ww := 29241;
  elsif cursor01_w.nr_projeto = 51333 or cursor01_w.nr_projeto = 51334 then
    nr_seq_visao_ww := 29260;
  elsif cursor01_w.nr_projeto = 51496 or cursor01_w.nr_projeto = 51497 then
    nr_seq_visao_ww := 29789;
  elsif cursor01_w.nr_projeto = 50492 or cursor01_w.nr_projeto = 50493 then
    nr_seq_visao_ww := 29805;
  elsif cursor01_w.nr_projeto = 25172 or cursor01_w.nr_projeto = 25233 then
    nr_seq_visao_ww := 31521;
  elsif cursor01_w.nr_projeto = 44466 or cursor01_w.nr_projeto = 44467 then
    nr_seq_visao_ww := 33143;
  elsif cursor01_w.nr_projeto = 50613 or cursor01_w.nr_projeto = 50615 then
    nr_seq_visao_ww := 33198;
  elsif cursor01_w.nr_projeto = 50653 or cursor01_w.nr_projeto = 50652 then
    nr_seq_visao_ww := 33199;
  elsif cursor01_w.nr_projeto = 50833 or cursor01_w.nr_projeto = 50834 then
    nr_seq_visao_ww := 33244;
  elsif cursor01_w.nr_projeto = 50721 or cursor01_w.nr_projeto = 50722 then
    nr_seq_visao_ww := 29549;
  elsif cursor01_w.nr_projeto = 51454 or cursor01_w.nr_projeto = 51455 then
    nr_seq_visao_ww := 29565;
  elsif cursor01_w.nr_projeto = 51412 or cursor01_w.nr_projeto = 51413 then
    nr_seq_visao_ww := 29637;
  elsif cursor01_w.nr_projeto = 51474 or cursor01_w.nr_projeto = 51475 then
    nr_seq_visao_ww := 29640;
  elsif cursor01_w.nr_projeto = 51430 or cursor01_w.nr_projeto = 51431 then
    nr_seq_visao_ww := 29665;
  elsif cursor01_w.nr_projeto = 53599 or cursor01_w.nr_projeto = 53598 then
    nr_seq_visao_ww := 104362;
  elsif cursor01_w.nr_projeto = 53619 or cursor01_w.nr_projeto = 53618 then
    nr_seq_visao_ww := 104613;
  elsif cursor01_w.nr_projeto = 51032 or cursor01_w.nr_projeto = 51033 then
    nr_seq_visao_ww := 29278;
  elsif cursor01_w.nr_projeto = 51416 or cursor01_w.nr_projeto = 51417 then
    nr_seq_visao_ww := 29684;
  elsif cursor01_w.nr_projeto = 51232 or cursor01_w.nr_projeto = 51233 then
    nr_seq_visao_ww := 29696;
  elsif cursor01_w.nr_projeto = 53495 or cursor01_w.nr_projeto = 53496 then
    nr_seq_visao_ww := 29786;
  elsif cursor01_w.nr_projeto = 50172 or cursor01_w.nr_projeto = 50173 then
    nr_seq_visao_ww := 29797;
  elsif cursor01_w.nr_projeto = 51053 or cursor01_w.nr_projeto = 51052 then
    nr_seq_visao_ww := 31520;
  elsif cursor01_w.nr_projeto = 52789 or cursor01_w.nr_projeto = 52790 then
    nr_seq_visao_ww := 32452;
  elsif cursor01_w.nr_projeto = 50814 or cursor01_w.nr_projeto = 50815 then
    nr_seq_visao_ww := 33122;
  elsif cursor01_w.nr_projeto = 50772 or cursor01_w.nr_projeto = 50773 then
    nr_seq_visao_ww := 33666;
  elsif cursor01_w.nr_projeto = 53169 or cursor01_w.nr_projeto = 53170 then
    nr_seq_visao_ww := 30024;
  elsif cursor01_w.nr_projeto = 53673 or cursor01_w.nr_projeto = 53674 then
    nr_seq_visao_ww := 100986;
  elsif cursor01_w.nr_projeto = 51486 or cursor01_w.nr_projeto = 51487 then
    nr_seq_visao_ww := 29616;
  elsif cursor01_w.nr_projeto = 51153 or cursor01_w.nr_projeto = 51154 then
    nr_seq_visao_ww := 29647;
  elsif cursor01_w.nr_projeto = 51193 or cursor01_w.nr_projeto = 51195 then
    nr_seq_visao_ww := 29652;
  elsif cursor01_w.nr_projeto = 53606 or cursor01_w.nr_projeto = 53607 then
    nr_seq_visao_ww := 104509;
  elsif cursor01_w.nr_projeto = 53610 or cursor01_w.nr_projeto = 53611 then
    nr_seq_visao_ww := 104578;
  elsif cursor01_w.nr_projeto = 53625 or cursor01_w.nr_projeto = 53623 then
    nr_seq_visao_ww := 104652;
  elsif cursor01_w.nr_projeto = 53425 then
    nr_seq_visao_ww := 83569;
  end if;

  if coalesce(nm_tabela_ww::text, '') = '' then
    select nm_tabela
    into STRICT nm_tabela_ww
    from tabela_visao
    where nr_sequencia = nr_seq_visao_ww;
  end if;

  insert into tasy_assinatura_lote(
    cd_funcao,
    cd_pessoa_fisica,
    dt_registro,
    ie_item_pendencia,
    ie_tipo_assinatura,
    nm_tabela,
    nm_usuario,
    nr_atendimento,
    nr_proj_assinatura,
    nr_seq_registro,
    nr_sequencia,
    nr_seq_visao
  ) values (
    281,
    cursor01_w.cd_pessoa_fisica,
    cursor01_w.dt_registro,
    cursor01_w.nr_seq_item_orig_pront,
    ie_tipo_assinatura_ww,
    nm_tabela_ww,
    cursor01_w.nm_usuario,
    cursor01_w.nr_atendimento,
    cursor01_w.nr_projeto,
    cursor01_w.nr_seq_item_pend,
    nextval('tasy_assinatura_lote_seq'),
    nr_seq_visao_ww
    );
	<<final>>
	qt_reg_w := 0;
  end;
end loop;
close c01;

open c02;
loop
fetch c02 into cursor02_w;
EXIT WHEN NOT FOUND; /* apply on c02 */
begin
  select max(nr_sequencia)
  into STRICT nr_seq_reg_ww
  from tasy_assinatura_lote
  where nr_seq_registro = cursor02_w.nr_sequencia
  and nr_proj_assinatura = cursor02_w.nr_projeto;

	select  count(ie_assinatura)
	into STRICT    ie_should_sign
	from    tasy_proj_assin_perfil
	where   nr_seq_proj = cursor01_w.nr_projeto
	and coalesce(ie_assinatura, 'N') = 'N';

  if (coalesce(nr_seq_reg_ww, 0) > 0 or ((ie_should_sign IS NOT NULL AND ie_should_sign::text <> '') and ie_should_sign > 0)) then
	goto final2;
  end if;

  select  nm_tabela,
          ds_projeto
  into STRICT    nm_tabela_ww,
          ds_projeto_ww
  from    tasy_projeto_assinatura
  where   nr_sequencia = cursor02_w.nr_projeto;

  select  max(nr_sequencia)
  into STRICT    nr_seq_visao_ww
  from      tabela_visao
  where (  cursor02_w.nr_projeto = ne_seq_projeto_liberacao
          or cursor02_w.nr_projeto = ne_seq_projeto_inativacao);

  if ds_projeto_ww like '%ADI%' then
    ie_tipo_assinatura_ww := 'I';
  else
  ie_tipo_assinatura_ww := 'L';
  end if;

   select	verifica_se_assinado(nm_tabela_ww,cursor02_w.nr_projeto,cursor02_w.nr_sequencia,ie_tipo_assinatura_ww) 
   into STRICT		ie_se_assinado_w 
;

   if (ie_se_assinado_w = 'S')then
	goto final2;
   end if;

  if cursor02_w.nr_projeto = 51422 or cursor02_w.nr_projeto = 51423 then
    nr_seq_visao_ww := 29691;
  elsif cursor02_w.nr_projeto = 51432 or cursor02_w.nr_projeto = 51433 then
    nr_seq_visao_ww := 29698;
  elsif cursor02_w.nr_projeto = 25177 or cursor02_w.nr_projeto = 25234 then
    nr_seq_visao_ww := 29776;
  elsif cursor02_w.nr_projeto = 183 or cursor02_w.nr_projeto = 25230 then
    nr_seq_visao_ww := 29796;
  elsif cursor02_w.nr_projeto = 50336 or cursor02_w.nr_projeto = 50337 then
    nr_seq_visao_ww := 33068;
  elsif cursor02_w.nr_projeto = 50792 or cursor02_w.nr_projeto = 50793 then
    nr_seq_visao_ww := 33147;
  elsif cursor02_w.nr_projeto = 44284 or cursor02_w.nr_projeto = 44280 then
    nr_seq_visao_ww := 33148;
  elsif cursor02_w.nr_projeto = 51118 or cursor02_w.nr_projeto = 51119 then
    nr_seq_visao_ww := 33171;
  elsif cursor02_w.nr_projeto = 50334 or cursor02_w.nr_projeto = 50335 then
    nr_seq_visao_ww := 33241;
  elsif cursor02_w.nr_projeto = 184 or cursor02_w.nr_projeto = 25231 then
    nr_seq_visao_ww := 97295;
  elsif cursor02_w.nr_projeto = 25185 or cursor02_w.nr_projeto = 25239 then
    nr_seq_visao_ww := 68825;
  elsif cursor02_w.nr_projeto = 51498 then
    nr_seq_visao_ww := 70222;
  elsif cursor02_w.nr_projeto = 50452 then
    nr_seq_visao_ww := 70225;
  elsif cursor02_w.nr_projeto = 51112 or cursor02_w.nr_projeto = 51113 then
    nr_seq_visao_ww := 104704;
  elsif cursor02_w.nr_projeto = 51114 or cursor02_w.nr_projeto = 51114 then
    nr_seq_visao_ww := 104785;
  elsif cursor02_w.nr_projeto = 51346 or cursor02_w.nr_projeto = 51347 then
    nr_seq_visao_ww := 105135;
  elsif cursor02_w.nr_projeto = 53480 or cursor02_w.nr_projeto = 53481 then
    nr_seq_visao_ww := 101059;
  elsif cursor02_w.nr_projeto = 51352 or cursor02_w.nr_projeto = 51353 then
    nr_seq_visao_ww := 29603;
  elsif cursor02_w.nr_projeto = 51440 or cursor02_w.nr_projeto = 51441 then
    nr_seq_visao_ww := 29611;
  elsif cursor02_w.nr_projeto = 51337 or cursor02_w.nr_projeto = 51339 then
    nr_seq_visao_ww := 29675;
  elsif cursor02_w.nr_projeto = 51414 or cursor02_w.nr_projeto = 51415 then
    nr_seq_visao_ww := 29677;
  elsif cursor02_w.nr_projeto = 51344 or cursor02_w.nr_projeto = 51345 then
    nr_seq_visao_ww := 29678;
  elsif cursor02_w.nr_projeto = 52848 or cursor02_w.nr_projeto = 52868 then
    nr_seq_visao_ww := 29499;
  elsif cursor02_w.nr_projeto = 51438 or cursor02_w.nr_projeto = 51439 then
    nr_seq_visao_ww := 29694;
  elsif cursor02_w.nr_projeto = 53471 or cursor02_w.nr_projeto = 53472 then
    nr_seq_visao_ww := 29722;
  elsif cursor02_w.nr_projeto = 25176 or cursor02_w.nr_projeto = 25238 then
    nr_seq_visao_ww := 29779;
  elsif cursor02_w.nr_projeto = 51488 or cursor02_w.nr_projeto = 51489 then
    nr_seq_visao_ww := 29780;
  elsif cursor02_w.nr_projeto = 25181 or cursor02_w.nr_projeto = 25244 then
    nr_seq_visao_ww := 29782;
  elsif cursor02_w.nr_projeto = 51688 or cursor02_w.nr_projeto = 49782 then
    nr_seq_visao_ww := 29792;
  elsif cursor02_w.nr_projeto = 51501 or cursor02_w.nr_projeto = 51502 then
    nr_seq_visao_ww := 29793;
  elsif cursor02_w.nr_projeto = 50472 or cursor02_w.nr_projeto = 50473 then
    nr_seq_visao_ww := 29804;
  elsif cursor02_w.nr_projeto = 51092 or cursor02_w.nr_projeto = 51094 then
    nr_seq_visao_ww := 33120;
  elsif cursor02_w.nr_projeto = 50972 or cursor02_w.nr_projeto = 50973 then
    nr_seq_visao_ww := 33161;
  elsif cursor02_w.nr_projeto = 50692 or cursor02_w.nr_projeto = 50693 then
    nr_seq_visao_ww := 33191;
  elsif cursor02_w.nr_projeto = 50658 or cursor02_w.nr_projeto = 50654 then
    nr_seq_visao_ww := 33194;
  elsif cursor02_w.nr_projeto = 53468 or cursor02_w.nr_projeto = 53470 then
    nr_seq_visao_ww := 45196;
  elsif cursor02_w.nr_projeto = 51072 or cursor02_w.nr_projeto = 51073 then
    nr_seq_visao_ww := 33287;
  elsif cursor02_w.nr_projeto = 51097 or cursor02_w.nr_projeto = 51098 then
    nr_seq_visao_ww := 104788;
  elsif cursor02_w.nr_projeto = 52908 or cursor02_w.nr_projeto = 52910 then
    nr_seq_visao_ww := 29941;
  elsif cursor02_w.nr_projeto = 50713 or cursor02_w.nr_projeto = 50714 then
    nr_seq_visao_ww := 29556;
  elsif cursor02_w.nr_projeto = 51132 or cursor02_w.nr_projeto = 51133 then
    nr_seq_visao_ww := 29581;
  elsif cursor02_w.nr_projeto = 53462 or cursor02_w.nr_projeto = 53463 then
    nr_seq_visao_ww := 29668;
  elsif cursor02_w.nr_projeto = 53486 or cursor02_w.nr_projeto = 53488 then
    nr_seq_visao_ww := 10025252;
  elsif cursor02_w.nr_projeto = 50152 or cursor02_w.nr_projeto = 50153 then
    nr_seq_visao_ww := 105537;
  elsif cursor02_w.nr_projeto = 51478 or cursor02_w.nr_projeto = 51479 then
    nr_seq_visao_ww := 29683;
  elsif cursor02_w.nr_projeto = 51550 or cursor02_w.nr_projeto = 51551 then
    nr_seq_visao_ww := 29799;
  elsif cursor02_w.nr_projeto = 51335 or cursor02_w.nr_projeto = 51336 then
    nr_seq_visao_ww := 29853;
  elsif cursor02_w.nr_projeto = 53399 or cursor02_w.nr_projeto = 53400 then
    nr_seq_visao_ww := 33085;
  elsif cursor02_w.nr_projeto = 50952 or cursor02_w.nr_projeto = 50953 then
    nr_seq_visao_ww := 33140;
  elsif cursor02_w.nr_projeto = 50852 or cursor02_w.nr_projeto = 50854 then
    nr_seq_visao_ww := 33167;
  elsif cursor02_w.nr_projeto = 51101 or cursor02_w.nr_projeto = 51102 then
    nr_seq_visao_ww := 33170;
  elsif cursor02_w.nr_projeto = 50752 or cursor02_w.nr_projeto = 50753 then
    nr_seq_visao_ww := 33185;
  elsif cursor02_w.nr_projeto = 51115 then
    nr_seq_visao_ww := 33200;
  elsif cursor02_w.nr_projeto = 53573 or cursor02_w.nr_projeto = 53574 then
    nr_seq_visao_ww := 102704;
  elsif cursor02_w.nr_projeto = 51373 or cursor02_w.nr_projeto = 51374 then
    nr_seq_visao_ww := 67732;
  elsif cursor02_w.nr_projeto = 51099 or cursor02_w.nr_projeto = 51100 then
    nr_seq_visao_ww := 104784;
  elsif cursor02_w.nr_projeto = 50718 or cursor02_w.nr_projeto = 50719 then
    nr_seq_visao_ww := 30017;
  elsif cursor02_w.nr_projeto = 36671 or cursor02_w.nr_projeto = 36673 then
    nr_seq_visao_ww := 29566;
  elsif cursor02_w.nr_projeto = 51172 or cursor02_w.nr_projeto = 51173 then
    nr_seq_visao_ww := 29595;
  elsif cursor02_w.nr_projeto = 51480 or cursor02_w.nr_projeto = 51481 then
    nr_seq_visao_ww := 29612;
  elsif cursor02_w.nr_projeto = 50715 or cursor02_w.nr_projeto = 50716 then
    nr_seq_visao_ww := 29621;
  elsif cursor02_w.nr_projeto = 51484 or cursor02_w.nr_projeto = 51485 then
    nr_seq_visao_ww := 29622;
  elsif cursor02_w.nr_projeto = 53609 or cursor02_w.nr_projeto = 53608 then
    nr_seq_visao_ww := 104544;
  elsif cursor02_w.nr_projeto = 53622 or cursor02_w.nr_projeto = 53621 then
    nr_seq_visao_ww := 104573;
  elsif cursor02_w.nr_projeto = 53613 or cursor02_w.nr_projeto = 53612 then
    nr_seq_visao_ww := 104587;
  elsif cursor02_w.nr_projeto = 53616 or cursor02_w.nr_projeto = 53617 then
    nr_seq_visao_ww := 104600;
  elsif cursor02_w.nr_projeto = 53208 or cursor02_w.nr_projeto = 53209 then
    nr_seq_visao_ww := 29238;
  elsif cursor02_w.nr_projeto = 52889 or cursor02_w.nr_projeto = 52890 then
    nr_seq_visao_ww := 29263;
  elsif cursor02_w.nr_projeto = 25186 or cursor02_w.nr_projeto = 25243 then
    nr_seq_visao_ww := 29283;
  elsif cursor02_w.nr_projeto = 53450 or cursor02_w.nr_projeto = 53451 then
    nr_seq_visao_ww := 29491;
  elsif cursor02_w.nr_projeto = 51420 or cursor02_w.nr_projeto = 51421 then
    nr_seq_visao_ww := 29688;
  elsif cursor02_w.nr_projeto = 52129 or cursor02_w.nr_projeto = 52130 then
    nr_seq_visao_ww := 29719;
  elsif cursor02_w.nr_projeto = 25180 or cursor02_w.nr_projeto = 25237 then
    nr_seq_visao_ww := 29777;
  elsif cursor02_w.nr_projeto = 25178 or cursor02_w.nr_projeto = 25236 then
    nr_seq_visao_ww := 29778;
  elsif cursor02_w.nr_projeto = 51508 or cursor02_w.nr_projeto = 49779 then
    nr_seq_visao_ww := 29791;
  elsif cursor02_w.nr_projeto = 50912 or cursor02_w.nr_projeto = 50913 then
    nr_seq_visao_ww := 33159;
  elsif cursor02_w.nr_projeto = 51342 or cursor02_w.nr_projeto = 51343 then
    nr_seq_visao_ww := 42025;
  elsif cursor02_w.nr_projeto = 53666 or cursor02_w.nr_projeto = 53667 then
    nr_seq_visao_ww := 72890;
  elsif cursor02_w.nr_projeto = 51095 or cursor02_w.nr_projeto = 51096 then
    nr_seq_visao_ww := 104786;
  elsif cursor02_w.nr_projeto = 53210 or cursor02_w.nr_projeto = 53211 then
    nr_seq_visao_ww := 29937;
  elsif cursor02_w.nr_projeto = 51348 or cursor02_w.nr_projeto = 51349 then
    nr_seq_visao_ww := 29599;
  elsif cursor02_w.nr_projeto = 51482 or cursor02_w.nr_projeto = 51483 then
    nr_seq_visao_ww := 29628;
  elsif cursor02_w.nr_projeto = 51434 or cursor02_w.nr_projeto = 51435 then
    nr_seq_visao_ww := 29669;
  elsif cursor02_w.nr_projeto = 53604 or cursor02_w.nr_projeto = 53602 then
    nr_seq_visao_ww := 104495;
  elsif cursor02_w.nr_projeto = 53658 or cursor02_w.nr_projeto = 53659 then
    nr_seq_visao_ww := 29254;
  elsif cursor02_w.nr_projeto = 25175 or cursor02_w.nr_projeto = 25235 then
    nr_seq_visao_ww := 29775;
  elsif cursor02_w.nr_projeto = 25179 or cursor02_w.nr_projeto = 25247 then
    nr_seq_visao_ww := 29784;
  elsif cursor02_w.nr_projeto = 25174 or cursor02_w.nr_projeto = 25246 then
    nr_seq_visao_ww := 29785;
  elsif cursor02_w.nr_projeto = 51492 or cursor02_w.nr_projeto = 51493 then
    nr_seq_visao_ww := 29787;
  elsif cursor02_w.nr_projeto = 53675 or cursor02_w.nr_projeto = 53676 then
    nr_seq_visao_ww := 29794;
  elsif cursor02_w.nr_projeto = 50632 or cursor02_w.nr_projeto = 50633 then
    nr_seq_visao_ww := 33132;
  elsif cursor02_w.nr_projeto = 25173 or cursor02_w.nr_projeto = 25232 then
    nr_seq_visao_ww := 33141;
  elsif cursor02_w.nr_projeto = 44469 or cursor02_w.nr_projeto = 44470 then
    nr_seq_visao_ww := 33144;
  elsif cursor02_w.nr_projeto = 50872 or cursor02_w.nr_projeto = 50873 then
    nr_seq_visao_ww := 33193;
  elsif cursor02_w.nr_projeto = 50338 or cursor02_w.nr_projeto = 50339 then
    nr_seq_visao_ww := 33237;
  elsif cursor02_w.nr_projeto = 50332 or cursor02_w.nr_projeto = 50333 then
    nr_seq_visao_ww := 33243;
  elsif cursor02_w.nr_projeto = 25184 or cursor02_w.nr_projeto = 25240 then
    nr_seq_visao_ww := 33258;
  elsif cursor02_w.nr_projeto = 25187 or cursor02_w.nr_projeto = 25248 then
    nr_seq_visao_ww := 33314;
  elsif cursor02_w.nr_projeto = 51116 or cursor02_w.nr_projeto = 51117 then
    nr_seq_visao_ww := 104787;
  elsif cursor02_w.nr_projeto = 50723 or cursor02_w.nr_projeto = 50724 then
    nr_seq_visao_ww := 29550;
  elsif cursor02_w.nr_projeto = 51350 or cursor02_w.nr_projeto = 51351 then
    nr_seq_visao_ww := 29600;
  elsif cursor02_w.nr_projeto = 51436 or cursor02_w.nr_projeto = 51437 then
    nr_seq_visao_ww := 29635;
  elsif cursor02_w.nr_projeto = 51428 or cursor02_w.nr_projeto = 51429 then
    nr_seq_visao_ww := 29664;
  elsif cursor02_w.nr_projeto = 51340 or cursor02_w.nr_projeto = 51341 then
    nr_seq_visao_ww := 29672;
  elsif cursor02_w.nr_projeto = 53597 or cursor02_w.nr_projeto = 53595 then
    nr_seq_visao_ww := 104308;
  elsif cursor02_w.nr_projeto = 53605 or cursor02_w.nr_projeto = 53603 then
    nr_seq_visao_ww := 104497;
  elsif cursor02_w.nr_projeto = 53615 or cursor02_w.nr_projeto = 53614 then
    nr_seq_visao_ww := 104599;
  elsif cursor02_w.nr_projeto = 53626 or cursor02_w.nr_projeto = 53624 then
    nr_seq_visao_ww := 104653;
  elsif cursor02_w.nr_projeto = 53627 or cursor02_w.nr_projeto = 53628 then
    nr_seq_visao_ww := 104699;
  elsif cursor02_w.nr_projeto = 53662 or cursor02_w.nr_projeto = 53663 then
    nr_seq_visao_ww := 29259;
  elsif cursor02_w.nr_projeto = 51424 or cursor02_w.nr_projeto = 51425 then
    nr_seq_visao_ww := 29682;
  elsif cursor02_w.nr_projeto = 53214 or cursor02_w.nr_projeto = 53213 then
    nr_seq_visao_ww := 29701;
  elsif cursor02_w.nr_projeto = 51490 or cursor02_w.nr_projeto = 51491 then
    nr_seq_visao_ww := 29781;
  elsif cursor02_w.nr_projeto = 25182 or cursor02_w.nr_projeto = 25245 then
    nr_seq_visao_ww := 29783;
  elsif cursor02_w.nr_projeto = 51494 or cursor02_w.nr_projeto = 51495 then
    nr_seq_visao_ww := 29788;
  elsif cursor02_w.nr_projeto = 50192 or cursor02_w.nr_projeto = 50193 then
    nr_seq_visao_ww := 30085;
  elsif cursor02_w.nr_projeto = 53452 or cursor02_w.nr_projeto = 53453 then
    nr_seq_visao_ww := 31514;
  elsif cursor02_w.nr_projeto = 43057 or cursor02_w.nr_projeto = 43058 then
    nr_seq_visao_ww := 33112;
  elsif cursor02_w.nr_projeto = 50672 or cursor02_w.nr_projeto = 50673 then
    nr_seq_visao_ww := 33142;
  elsif cursor02_w.nr_projeto = 50992 or cursor02_w.nr_projeto = 50993 then
    nr_seq_visao_ww := 33162;
  elsif cursor02_w.nr_projeto = 52169 or cursor02_w.nr_projeto = 52168 then
    nr_seq_visao_ww := 33195;
  elsif cursor02_w.nr_projeto = 50733 or cursor02_w.nr_projeto = 50734 then
    nr_seq_visao_ww := 33235;
  elsif cursor02_w.nr_projeto = 25183 or cursor02_w.nr_projeto = 25241 then
    nr_seq_visao_ww := 33257;
  elsif cursor02_w.nr_projeto = 25170 or cursor02_w.nr_projeto = 25242 then
    nr_seq_visao_ww := 68824;
  elsif cursor02_w.nr_projeto = 25290 or cursor02_w.nr_projeto = 25291 then
    nr_seq_visao_ww := 29885;
  elsif cursor02_w.nr_projeto = 51748 then
    nr_seq_visao_ww := 29896;
  elsif cursor02_w.nr_projeto = 51418 or cursor02_w.nr_projeto = 51419 then
    nr_seq_visao_ww := 29639;
  elsif cursor02_w.nr_projeto = 53681 or cursor02_w.nr_projeto = 53682 then
    nr_seq_visao_ww := 29241;
  elsif cursor02_w.nr_projeto = 51333 or cursor02_w.nr_projeto = 51334 then
    nr_seq_visao_ww := 29260;
  elsif cursor02_w.nr_projeto = 51496 or cursor02_w.nr_projeto = 51497 then
    nr_seq_visao_ww := 29789;
  elsif cursor02_w.nr_projeto = 50492 or cursor02_w.nr_projeto = 50493 then
    nr_seq_visao_ww := 29805;
  elsif cursor02_w.nr_projeto = 25172 or cursor02_w.nr_projeto = 25233 then
    nr_seq_visao_ww := 31521;
  elsif cursor02_w.nr_projeto = 44466 or cursor02_w.nr_projeto = 44467 then
    nr_seq_visao_ww := 33143;
  elsif cursor02_w.nr_projeto = 50613 or cursor02_w.nr_projeto = 50615 then
    nr_seq_visao_ww := 33198;
  elsif cursor02_w.nr_projeto = 50653 or cursor02_w.nr_projeto = 50652 then
    nr_seq_visao_ww := 33199;
  elsif cursor02_w.nr_projeto = 50833 or cursor02_w.nr_projeto = 50834 then
    nr_seq_visao_ww := 33244;
  elsif cursor02_w.nr_projeto = 50721 or cursor02_w.nr_projeto = 50722 then
    nr_seq_visao_ww := 29549;
  elsif cursor02_w.nr_projeto = 51454 or cursor02_w.nr_projeto = 51455 then
    nr_seq_visao_ww := 29565;
  elsif cursor02_w.nr_projeto = 51412 or cursor02_w.nr_projeto = 51413 then
    nr_seq_visao_ww := 29637;
  elsif cursor02_w.nr_projeto = 51474 or cursor02_w.nr_projeto = 51475 then
    nr_seq_visao_ww := 29640;
  elsif cursor02_w.nr_projeto = 51430 or cursor02_w.nr_projeto = 51431 then
    nr_seq_visao_ww := 29665;
  elsif cursor02_w.nr_projeto = 53599 or cursor02_w.nr_projeto = 53598 then
    nr_seq_visao_ww := 104362;
  elsif cursor02_w.nr_projeto = 53619 or cursor02_w.nr_projeto = 53618 then
    nr_seq_visao_ww := 104613;
  elsif cursor02_w.nr_projeto = 51032 or cursor02_w.nr_projeto = 51033 then
    nr_seq_visao_ww := 29278;
  elsif cursor02_w.nr_projeto = 51416 or cursor02_w.nr_projeto = 51417 then
    nr_seq_visao_ww := 29684;
  elsif cursor02_w.nr_projeto = 51232 or cursor02_w.nr_projeto = 51233 then
    nr_seq_visao_ww := 29696;
  elsif cursor02_w.nr_projeto = 53495 or cursor02_w.nr_projeto = 53496 then
    nr_seq_visao_ww := 29786;
  elsif cursor02_w.nr_projeto = 50172 or cursor02_w.nr_projeto = 50173 then
    nr_seq_visao_ww := 29797;
  elsif cursor02_w.nr_projeto = 51053 or cursor02_w.nr_projeto = 51052 then
    nr_seq_visao_ww := 31520;
  elsif cursor02_w.nr_projeto = 52789 or cursor02_w.nr_projeto = 52790 then
    nr_seq_visao_ww := 32452;
  elsif cursor02_w.nr_projeto = 50814 or cursor02_w.nr_projeto = 50815 then
    nr_seq_visao_ww := 33122;
  elsif cursor02_w.nr_projeto = 50772 or cursor02_w.nr_projeto = 50773 then
    nr_seq_visao_ww := 33666;
  elsif cursor02_w.nr_projeto = 53169 or cursor02_w.nr_projeto = 53170 then
    nr_seq_visao_ww := 30024;
  elsif cursor02_w.nr_projeto = 53673 or cursor02_w.nr_projeto = 53674 then
    nr_seq_visao_ww := 100986;
  elsif cursor02_w.nr_projeto = 51486 or cursor02_w.nr_projeto = 51487 then
    nr_seq_visao_ww := 29616;
  elsif cursor02_w.nr_projeto = 51153 or cursor02_w.nr_projeto = 51154 then
    nr_seq_visao_ww := 29647;
  elsif cursor02_w.nr_projeto = 51193 or cursor02_w.nr_projeto = 51195 then
    nr_seq_visao_ww := 29652;
  elsif cursor02_w.nr_projeto = 53606 or cursor02_w.nr_projeto = 53607 then
    nr_seq_visao_ww := 104509;
  elsif cursor02_w.nr_projeto = 53610 or cursor02_w.nr_projeto = 53611 then
    nr_seq_visao_ww := 104578;
  elsif cursor02_w.nr_projeto = 53625 or cursor02_w.nr_projeto = 53623 then
    nr_seq_visao_ww := 104652;
  elsif cursor02_w.nr_projeto = 53425 then
    nr_seq_visao_ww := 83569;
  end if;

  if coalesce(nm_tabela_ww::text, '') = '' then
    select nm_tabela
    into STRICT nm_tabela_ww
    from tabela_visao
    where nr_sequencia = nr_seq_visao_ww;
  end if;

  insert into tasy_assinatura_lote(
    cd_funcao,
    cd_pessoa_fisica,
    dt_registro,
    ie_item_pendencia,
    ie_tipo_assinatura,
    nm_tabela,
    nm_usuario,
    nr_atendimento,
    nr_proj_assinatura,
    nr_seq_registro,
    nr_sequencia,
    nr_seq_visao
  ) values (
    872,
    cursor02_w.cd_pessoa_fisica,
    cursor02_w.dt_liberacao,
    cursor02_w.nr_item,
    ie_tipo_assinatura_ww,
    nm_tabela_ww,
    cursor02_w.nm_usuario,
    cursor02_w.nr_atendimento,
    cursor02_w.nr_projeto,
    cursor02_w.nr_sequencia,
    nextval('tasy_assinatura_lote_seq'),
    nr_seq_visao_ww
  );
  <<final2>>
  qt_reg_w := 0;
  end;
end loop;
close c02;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE reinsere_itens_assina_lote ( nm_usuario_p text, dt_inicio_p timestamp , dt_final_p timestamp ) FROM PUBLIC;

