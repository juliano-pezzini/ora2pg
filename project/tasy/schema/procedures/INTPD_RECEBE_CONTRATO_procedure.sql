-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE intpd_recebe_contrato ( nr_sequencia_p bigint, xml_p xml) AS $body$
DECLARE


_ora2pg_r RECORD;
ds_id_origin_w						intpd_eventos_sistema.ds_id_origin%type;
ie_conversao_w						intpd_eventos_sistema.ie_conversao%type;
nr_seq_sistema_w					intpd_eventos_sistema.nr_seq_sistema%type;
nr_seq_projeto_xml_w				intpd_eventos_sistema.nr_seq_projeto_xml%type;
nr_seq_regra_conv_w					conversao_meio_externo.nr_seq_regra%type;
ie_sistema_externo_w				varchar(15);
reg_integracao_w					gerar_int_padrao.reg_integracao_conv;
qt_registros_w						bigint;
contrato_w							contrato%rowtype;
contrato_regra_nf_w					contrato_regra_nf%rowtype;
contrato_regra_pagto_w				contrato_regra_pagto%rowtype;

c01 CURSOR FOR
SELECT	*
from	xmltable('/STRUCTURE/CONTRATO' passing xml_p columns
	ie_action				varchar(15)							path 'IE_ACTION',
	CD_CGC_CONTRATADO       		varchar(14)  					path 'CD_CGC_CONTRATADO',
	NR_SEQ_TIPO_CONTRATO    		bigint                      path 'NR_SEQ_TIPO_CONTRATO',
	DS_OBJETO_CONTRATO      		varchar(1000)                  path 'DS_OBJETO_CONTRATO',
	IE_RENOVACAO            		varchar(1)                     path 'IE_RENOVACAO',
	NM_USUARIO              		varchar(15)                    path 'NM_USUARIO',
	IE_SITUACAO             		varchar(1)                     path 'IE_SITUACAO',
	DT_INICIO               		timestamp                            path 'DT_INICIO',
	DT_FIM                  		timestamp                            path 'DT_FIM',
	QT_DIAS_RESCISAO        		integer                       path 'QT_DIAS_RESCISAO',
	CD_CONTRATO             		varchar(20)                    path 'CD_CONTRATO',
	IE_PRAZO_CONTRATO       		varchar(1)                     path 'IE_PRAZO_CONTRATO',
	NM_CONTATO              		varchar(40)                    path 'NM_CONTATO',
	CD_PESSOA_RESP          		varchar(10)                    path 'CD_PESSOA_RESP',
	VL_TOTAL_CONTRATO       		double precision                    path 'VL_TOTAL_CONTRATO',
	DS_ATRIBUICAO           		varchar(4000)                  path 'DS_ATRIBUICAO',
	IE_PAGAR_RECEBER        		varchar(1)                     path 'IE_PAGAR_RECEBER',
	CD_PESSOA_NEGOC         		varchar(10)                    path 'CD_PESSOA_NEGOC',
	CD_PESSOA_CONTRATADA    		varchar(10)                    path 'CD_PESSOA_CONTRATADA',
	DT_REVISAO              		timestamp                            path 'DT_REVISAO',
	CD_ESTABELECIMENTO      		smallint                       path 'CD_ESTABELECIMENTO',
	IE_AVISA_VENCIMENTO     		varchar(1)                     path 'IE_AVISA_VENCIMENTO',
	QT_DIAS_AVISO_VENC      		integer                       path 'QT_DIAS_AVISO_VENC',
	CD_CARGO                		bigint                      path 'CD_CARGO',
	DS_MOTIVO_RESCISAO      		varchar(255)                   path 'DS_MOTIVO_RESCISAO',
	NR_SEQ_FORMA_RESCISAO   		bigint                      path 'NR_SEQ_FORMA_RESCISAO',
	VL_MULTA_CONTRATUAL     		double precision                    path 'VL_MULTA_CONTRATUAL',
	CD_SETOR                		integer                       path 'CD_SETOR',
	CD_CONDICAO_PAGAMENTO   		bigint                      path 'CD_CONDICAO_PAGAMENTO',
	IE_AVISA_VENC_SETOR     		varchar(1)                     path 'IE_AVISA_VENC_SETOR',
	PR_MULTA_CONTRATUAL     		double precision                    path 'PR_MULTA_CONTRATUAL',
	NR_SEQ_SUBTIPO_CONTRATO 		bigint                      path 'NR_SEQ_SUBTIPO_CONTRATO',
	IE_CLASSIFICACAO        		varchar(2)                     path 'IE_CLASSIFICACAO',
	NR_SEQ_ADITIVO          		bigint                      path 'NR_SEQ_ADITIVO',
	DT_ATUALIZACAO_ADITIVO  		timestamp                            path 'DT_ATUALIZACAO_ADITIVO',
	NR_SEQ_CONTRATO_ATUAL   		bigint                      path 'NR_SEQ_CONTRATO_ATUAL',
	QT_DIAS_INTERV_AVISO    		bigint                      path 'QT_DIAS_INTERV_AVISO',
	NR_SEQ_AREA             		bigint                      path 'NR_SEQ_AREA',
	NR_SEQ_INDICE_REAJUSTE  		bigint                      path 'NR_SEQ_INDICE_REAJUSTE',
	DT_LIBERACAO            		timestamp                            path 'DT_LIBERACAO',
	NM_USUARIO_LIB          		varchar(15)                    path 'NM_USUARIO_LIB',
	IE_AVISA_REAJUSTE       		varchar(1)                     path 'IE_AVISA_REAJUSTE',
	DT_PUBLICACAO           		timestamp                            path 'DT_PUBLICACAO',
	NR_SOLIC_COMPRA         		bigint                      path 'NR_SOLIC_COMPRA',
	CD_OPERACAO_NF          		smallint                       path 'CD_OPERACAO_NF',
	CD_NATUREZA_OPERACAO    		smallint                       path 'CD_NATUREZA_OPERACAO',
	IE_EMAIL_ORIGEM         		varchar(1)                     path 'IE_EMAIL_ORIGEM',
	DT_ASSINATURA           		timestamp                            path 'DT_ASSINATURA',
	NM_USUARIO_ASSINAT      		varchar(15)                    path 'NM_USUARIO_ASSINAT',
	QT_DIAS_REAJUSTE        		bigint                      path 'QT_DIAS_REAJUSTE',
	EMAIL_CONTATO           		varchar(150)                   path 'EMAIL_CONTATO',
	TELEFONE_CONTATO        		varchar(150)                   path 'TELEFONE_CONTATO',
	VL_CUSTAS_CONTRATO      		double precision                    path 'VL_CUSTAS_CONTRATO',
	PR_CUSTAS_CONTRATO      		double precision                    path 'PR_CUSTAS_CONTRATO',
	CD_CNPJ_CONTRATANTE     		varchar(15)                    path 'CD_CNPJ_CONTRATANTE',
	CD_PESSOA_CONTRATANTE   		varchar(10)                    path 'CD_PESSOA_CONTRATANTE',
	DS_TITULO_CONTRATO      		varchar(255)                   path 'DS_TITULO_CONTRATO',
	NR_DOCUMENTO_EXTERNO    		varchar(100)                   path 'NR_DOCUMENTO_EXTERNO',
	IE_PERIODO_NF           		varchar(15)                    path 'IE_PERIODO_NF',
	QT_MAXIMO_NF_PERIODO    		integer                       path 'QT_MAXIMO_NF_PERIODO',
	QT_DIAS_REVISAO         		bigint                      path 'QT_DIAS_REVISAO',
	NR_SEQ_CONTRATO_GESTAO  		bigint                      path 'NR_SEQ_CONTRATO_GESTAO',
	VL_NEGOCIADO            		double precision                    path 'VL_NEGOCIADO',
	NR_CPF_CONTATO          		varchar(20)                    path 'NR_CPF_CONTATO',
	QT_DIAS_PERIODO         		bigint                      path 'QT_DIAS_PERIODO',
	IE_ESTAGIO              		varchar(15)                    path 'IE_ESTAGIO',
	DT_ENCERRAMENTO         		timestamp                            path 'DT_ENCERRAMENTO',
	NM_USUARIO_ENCER        		varchar(15)                    path 'NM_USUARIO_ENCER',
	DS_OBSERVACAO           		varchar(255)                   path 'DS_OBSERVACAO',
	NR_SEQ_ERRATA           		bigint                      path 'NR_SEQ_ERRATA',
	NR_SEQ_PENDENCIA        		bigint                      path 'NR_SEQ_PENDENCIA',
	IE_FINALIZADO           		varchar(1)                     path 'IE_FINALIZADO',
	DT_FINALIZADO           		timestamp                            path 'DT_FINALIZADO',
	NM_USUARIO_FINALIZ      		varchar(15)                    path 'NM_USUARIO_FINALIZ',
	IE_SLA                  		varchar(1)                     path 'IE_SLA',
	IE_ENVIAR_EMAIL_OC      		varchar(1)                     path 'IE_ENVIAR_EMAIL_OC',
	CD_MEDICO_RESP          		varchar(10)                    path 'CD_MEDICO_RESP',
	VL_FATUR_MINIMO         		double precision                    path 'VL_FATUR_MINIMO',
	NR_SEQ_CLIENTE          		bigint                      path 'NR_SEQ_CLIENTE',
	NM_MEDICO_EXTERNO       		varchar(255)                   path 'NM_MEDICO_EXTERNO',
	IE_INDICE_REAJUSTE      		varchar(10)                    path 'IE_INDICE_REAJUSTE',
	CD_PACIENTE             		varchar(10)                    path 'CD_PACIENTE',
	CD_MOEDA_ESTRANGEIRA    		smallint                       path 'CD_MOEDA_ESTRANGEIRA',
	CD_COMPRADOR            		varchar(10)                    path 'CD_COMPRADOR',
	DT_ASSINATURA_ORIG      		timestamp                            path 'DT_ASSINATURA_ORIG',
	NM_USUARIO_ASSINAT_ORIG 		varchar(15)                    path 'NM_USUARIO_ASSINAT_ORIG',
	IE_SOMENTE_OC_PAGTO     		varchar(1)                     path 'IE_SOMENTE_OC_PAGTO',
	IE_SISTEMA_AMORT        		varchar(1)                     path 'IE_SISTEMA_AMORT',
	VL_TAXA_BANCO_CONTRAT   		double precision                    path 'VL_TAXA_BANCO_CONTRAT',
	DS_INDEXADOR            		varchar(250)                   path 'DS_INDEXADOR',
	NR_DDI_TELEFONE         		varchar(3)                     path 'NR_DDI_TELEFONE',
	xml_item						xml							path 'ITENS',
	xml_regra_pgto					xml							path 'REGRAS_PAGTO');

c01_w	c01%rowtype;

c02 CURSOR FOR
SELECT	*
from	xmltable('/ITENS/ITEM' passing c01_w.xml_item columns
	CD_MATERIAL              		integer     					path 'CD_MATERIAL',
	CD_CONTA_CONTABIL               varchar(20)                    path 'CD_CONTA_CONTABIL',
	CD_CENTRO_CUSTO                 integer                       path 'CD_CENTRO_CUSTO',
	NR_SEQ_CRIT_RATEIO              bigint                      path 'NR_SEQ_CRIT_RATEIO',
	DS_COMPLEMENTO                  varchar(255)                   path 'DS_COMPLEMENTO',
	DS_OBSERVACAO                   varchar(255)                   path 'DS_OBSERVACAO',
	NR_SEQ_CONTA_FINANC             bigint                      path 'NR_SEQ_CONTA_FINANC',
	VL_PAGTO                        double precision                    path 'VL_PAGTO',
	DT_INICIO_VIGENCIA              timestamp                            path 'DT_INICIO_VIGENCIA',
	DT_FIM_VIGENCIA                 timestamp                            path 'DT_FIM_VIGENCIA',
	PR_VARIACAO_VALOR               real                     path 'PR_VARIACAO_VALOR',
	QT_CONVERSAO_NF                 real                     path 'QT_CONVERSAO_NF',
	IE_CONVERSAO_NF                 varchar(1)                     path 'IE_CONVERSAO_NF',
	NR_SEQ_PROJ_REC                 bigint                      path 'NR_SEQ_PROJ_REC',
	NR_SEQ_EQUIPAMENTO              bigint                      path 'NR_SEQ_EQUIPAMENTO',
	CD_ESTAB_REGRA                  smallint                       path 'CD_ESTAB_REGRA',
	CD_LOCAL_ESTOQUE                smallint                       path 'CD_LOCAL_ESTOQUE',
	DT_VENC_PAGTO                   smallint                       path 'DT_VENC_PAGTO',
	QT_DIAS_ANTES_GERAR_SC          real                     path 'QT_DIAS_ANTES_GERAR_SC',
	IE_GERA_SC_AUTOMATICO           varchar(1)                     path 'IE_GERA_SC_AUTOMATICO',
	IE_TIPO_REGRA                   varchar(15)                    path 'IE_TIPO_REGRA',
	CD_PESSOA_SOLICITANTE           varchar(10)                    path 'CD_PESSOA_SOLICITANTE',
	IE_LIBERA_SOLIC                 varchar(1)                     path 'IE_LIBERA_SOLIC',
	NR_SEQ_MARCA                    bigint                      path 'NR_SEQ_MARCA',
	VL_SALDO_TOTAL                  double precision                    path 'VL_SALDO_TOTAL',
	NR_COT_COMPRA                   bigint                      path 'NR_COT_COMPRA',
	NR_ITEM_COT_COMPRA              integer                       path 'NR_ITEM_COT_COMPRA',
	CD_NATUREZA_OPERACAO            smallint                       path 'CD_NATUREZA_OPERACAO',
	CD_UNIDADE_MEDIDA_COMPRA        varchar(30)                    path 'CD_UNIDADE_MEDIDA_COMPRA',
	IE_PRECO                        varchar(1)                     path 'IE_PRECO',
	IE_QUANTIDADE                   varchar(1)                     path 'IE_QUANTIDADE',
	NR_ORDEM_COMPRA                 bigint                      path 'NR_ORDEM_COMPRA',
	NR_ITEM_OCI                     integer                       path 'NR_ITEM_OCI',
	QT_MATERIAL_FIXA                double precision                    path 'QT_MATERIAL_FIXA',
	QT_DIAS_ENTREGA                 integer                       path 'QT_DIAS_ENTREGA',
	DS_ENDERECO                     varchar(255)                   path 'DS_ENDERECO',
	DT_ENTREGA                      timestamp                            path 'DT_ENTREGA',
	IE_PERMITE_ADIANT               varchar(1)                     path 'IE_PERMITE_ADIANT',
	PR_PERMITIDO_ADIANT             double precision                    path 'PR_PERMITIDO_ADIANT',
	IE_PRECO_OC                     varchar(1)                     path 'IE_PRECO_OC',
	IE_QUANTIDADE_OC                varchar(1)                     path 'IE_QUANTIDADE_OC',
	PR_DESCONTO                     double precision                    path 'PR_DESCONTO',
	VL_DESCONTO                     double precision                    path 'VL_DESCONTO',
	NR_DOCUMENTO_EXTERNO    		varchar(100)                   path 'NR_DOCUMENTO_EXTERNO');

c02_w	c02%rowtype;

c03 CURSOR FOR
SELECT	*
from	xmltable('/REGRAS_PAGTO/REGRA_PAGTO' passing c01_w.xml_regra_pgto columns
	IE_FORMA               			varchar(1)    					path 'IE_FORMA',
	DT_PRIMEIRO_VENCTO     			timestamp                            path 'DT_PRIMEIRO_VENCTO',
	IE_TIPO_VALOR          			varchar(3)                     path 'IE_TIPO_VALOR',
	VL_PAGTO               			double precision                    path 'VL_PAGTO',
	CD_MOEDA               			smallint                       path 'CD_MOEDA',
	CD_INDICE_REAJUSTE     			smallint                       path 'CD_INDICE_REAJUSTE',
	IE_PERIODO_REAJUSTE    			varchar(3)                     path 'IE_PERIODO_REAJUSTE',
	CD_CONTA_FINANC        			bigint                      path 'CD_CONTA_FINANC',
	VL_IR                  			double precision                    path 'VL_IR',
	VL_INSS                			double precision                    path 'VL_INSS',
	VL_ISS                 			double precision                    path 'VL_ISS',
	DT_INICIO_VIGENCIA     			timestamp                            path 'DT_INICIO_VIGENCIA',
	DT_FINAL_VIGENCIA      			timestamp                            path 'DT_FINAL_VIGENCIA',
	DS_OBSERVACAO          			varchar(255)                   path 'DS_OBSERVACAO',
	QT_INDICE_REAJUSTE     			double precision                     path 'QT_INDICE_REAJUSTE',
	DS_REF_INDICE_REAJUSTE 			varchar(80)                    path 'DS_REF_INDICE_REAJUSTE',
	DS_REGRA_VENCIMENTO    			varchar(4000)                  path 'DS_REGRA_VENCIMENTO',
	NR_SEQ_TRANS_FINANC    			bigint                      path 'NR_SEQ_TRANS_FINANC',
	NR_SEQ_TRANS_FIN_BAIXA 			bigint                      path 'NR_SEQ_TRANS_FIN_BAIXA',
	IE_CENTRO_CONTRATO     			varchar(1)                     path 'IE_CENTRO_CONTRATO',
	TX_DESC_ANTECIPACAO    			double precision                     path 'TX_DESC_ANTECIPACAO',
	CD_CONTA_CONTABIL      			varchar(20)                    path 'CD_CONTA_CONTABIL',
	QT_AVISO_REAJUSTE      			integer                       path 'QT_AVISO_REAJUSTE',
	NR_SEQ_CRIT_RATEIO     			bigint                      path 'NR_SEQ_CRIT_RATEIO',
	IE_TIPO_TITULO         			varchar(2)                     path 'IE_TIPO_TITULO',
	NR_SEQ_CLASSE          			bigint                      path 'NR_SEQ_CLASSE',
	CD_TIPO_TAXA_MULTA     			bigint                      path 'CD_TIPO_TAXA_MULTA',
	CD_TIPO_TAXA_JURO      			bigint                      path 'CD_TIPO_TAXA_JURO',
	TX_JUROS               			double precision                     path 'TX_JUROS',
	TX_MULTA               			double precision                     path 'TX_MULTA',
	CD_TIPO_RECEBIMENTO    			integer                       path 'CD_TIPO_RECEBIMENTO',
	QT_PERIODO_VARIAVEL    			integer                       path 'QT_PERIODO_VARIAVEL',
	IE_PERIODO_VARIAVEL    			varchar(1)                     path 'IE_PERIODO_VARIAVEL',
	VL_CHAMADO             			double precision                    path 'VL_CHAMADO',
	DT_LIBERACAO           			timestamp                            path 'DT_LIBERACAO',
	NM_USUARIO_LIB         			varchar(15)                    path 'NM_USUARIO_LIB',
	IE_GERAR_TRIBUTO_TIT   			varchar(1)                     path 'IE_GERAR_TRIBUTO_TIT',
	NR_SEQ_CONTA_BANCO     			bigint                      path 'NR_SEQ_CONTA_BANCO',
	NR_SEQ_CLASSE_TIT_REC  			bigint                      path 'NR_SEQ_CLASSE_TIT_REC',
	NR_DOCUMENTO_EXTERNO    		varchar(100)                   path 'NR_DOCUMENTO_EXTERNO');

c03_w	c03%rowtype;

BEGIN

select	id_origin
into STRICT	ds_id_origin_w
from	xmltable('/STRUCTURE' passing xml_p
	columns id_origin	varchar2(10) path 'ID_ORIGIN');

select	coalesce(b.ie_conversao,'I'),
	nr_seq_sistema,
	nr_seq_projeto_xml,
	nr_seq_regra_conv,
	coalesce(ds_id_origin,ds_id_origin_w)
into STRICT	ie_conversao_w,
	nr_seq_sistema_w,
	nr_seq_projeto_xml_w,
	nr_seq_regra_conv_w,
	ds_id_origin_w
from	intpd_fila_transmissao a,
	intpd_eventos_sistema b
where	a.nr_seq_evento_sistema = b.nr_sequencia
and	a.nr_sequencia = nr_sequencia_p;

ie_sistema_externo_w				:=	nr_seq_sistema_w;

reg_integracao_w.nr_seq_fila_transmissao	:=	nr_sequencia_p;
reg_integracao_w.ie_envio_recebe		:=	'R';
reg_integracao_w.ie_sistema_externo		:=	ie_sistema_externo_w;
reg_integracao_w.ie_conversao			:=	ie_conversao_w;
reg_integracao_w.nr_seq_projeto_xml		:=	nr_seq_projeto_xml_w;
reg_integracao_w.nr_seq_regra_conversao		:=	nr_seq_regra_conv_w;

open c01;
loop
fetch c01 into
	c01_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
	begin
	if (c01_w.ie_action = 'DELETE') then
		update contrato set IE_SITUACAO = 'I' where nr_documento_externo = c01_w.nr_documento_externo;
	else
		reg_integracao_w.nm_tabela			:=	'CONTRATO';
		reg_integracao_w.nm_elemento		:=	'CONTRATO';
		reg_integracao_w.nr_seq_visao		:=	15158;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CGC_CONTRATADO', c01_w.CD_CGC_CONTRATADO, 'S', contrato_w.CD_CGC_CONTRATADO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_CGC_CONTRATADO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_TIPO_CONTRATO', c01_w.NR_SEQ_TIPO_CONTRATO, 'S', contrato_w.NR_SEQ_TIPO_CONTRATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_SEQ_TIPO_CONTRATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_OBJETO_CONTRATO', c01_w.DS_OBJETO_CONTRATO, 'S', contrato_w.DS_OBJETO_CONTRATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DS_OBJETO_CONTRATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_RENOVACAO', c01_w.IE_RENOVACAO, 'S', contrato_w.IE_RENOVACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_RENOVACAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_USUARIO', c01_w.NM_USUARIO, 'S', contrato_w.NM_USUARIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NM_USUARIO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_SITUACAO', c01_w.IE_SITUACAO, 'S', contrato_w.IE_SITUACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_SITUACAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_INICIO', c01_w.DT_INICIO, 'S', contrato_w.DT_INICIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DT_INICIO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_FIM', c01_w.DT_FIM, 'S', contrato_w.DT_FIM) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DT_FIM := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_DIAS_RESCISAO', c01_w.QT_DIAS_RESCISAO, 'S', contrato_w.QT_DIAS_RESCISAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.QT_DIAS_RESCISAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CONTRATO', c01_w.CD_CONTRATO, 'S', contrato_w.CD_CONTRATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_CONTRATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PRAZO_CONTRATO', c01_w.IE_PRAZO_CONTRATO, 'S', contrato_w.IE_PRAZO_CONTRATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_PRAZO_CONTRATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_CONTATO', c01_w.NM_CONTATO, 'S', contrato_w.NM_CONTATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NM_CONTATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PESSOA_RESP', c01_w.CD_PESSOA_RESP, 'S', contrato_w.CD_PESSOA_RESP) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_PESSOA_RESP := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_TOTAL_CONTRATO', c01_w.VL_TOTAL_CONTRATO, 'S', contrato_w.VL_TOTAL_CONTRATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.VL_TOTAL_CONTRATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_ATRIBUICAO', c01_w.DS_ATRIBUICAO, 'S', contrato_w.DS_ATRIBUICAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DS_ATRIBUICAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PAGAR_RECEBER', c01_w.IE_PAGAR_RECEBER, 'S', contrato_w.IE_PAGAR_RECEBER) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_PAGAR_RECEBER := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PESSOA_NEGOC', c01_w.CD_PESSOA_NEGOC, 'S', contrato_w.CD_PESSOA_NEGOC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_PESSOA_NEGOC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PESSOA_CONTRATADA', c01_w.CD_PESSOA_CONTRATADA, 'S', contrato_w.CD_PESSOA_CONTRATADA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_PESSOA_CONTRATADA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_REVISAO', c01_w.DT_REVISAO, 'S', contrato_w.DT_REVISAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DT_REVISAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_ESTABELECIMENTO', c01_w.CD_ESTABELECIMENTO, 'S', contrato_w.CD_ESTABELECIMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_ESTABELECIMENTO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_AVISA_VENCIMENTO', c01_w.IE_AVISA_VENCIMENTO, 'S', contrato_w.IE_AVISA_VENCIMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_AVISA_VENCIMENTO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_DIAS_AVISO_VENC', c01_w.QT_DIAS_AVISO_VENC, 'S', contrato_w.QT_DIAS_AVISO_VENC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.QT_DIAS_AVISO_VENC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CARGO', c01_w.CD_CARGO, 'S', contrato_w.CD_CARGO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_CARGO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_MOTIVO_RESCISAO', c01_w.DS_MOTIVO_RESCISAO, 'S', contrato_w.DS_MOTIVO_RESCISAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DS_MOTIVO_RESCISAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_FORMA_RESCISAO', c01_w.NR_SEQ_FORMA_RESCISAO, 'S', contrato_w.NR_SEQ_FORMA_RESCISAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_SEQ_FORMA_RESCISAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_MULTA_CONTRATUAL', c01_w.VL_MULTA_CONTRATUAL, 'S', contrato_w.VL_MULTA_CONTRATUAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.VL_MULTA_CONTRATUAL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_SETOR', c01_w.CD_SETOR, 'S', contrato_w.CD_SETOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_SETOR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CONDICAO_PAGAMENTO', c01_w.CD_CONDICAO_PAGAMENTO, 'S', contrato_w.CD_CONDICAO_PAGAMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_CONDICAO_PAGAMENTO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_AVISA_VENC_SETOR', c01_w.IE_AVISA_VENC_SETOR, 'S', contrato_w.IE_AVISA_VENC_SETOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_AVISA_VENC_SETOR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'PR_MULTA_CONTRATUAL', c01_w.PR_MULTA_CONTRATUAL, 'S', contrato_w.PR_MULTA_CONTRATUAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.PR_MULTA_CONTRATUAL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_SUBTIPO_CONTRATO', c01_w.NR_SEQ_SUBTIPO_CONTRATO, 'S', contrato_w.NR_SEQ_SUBTIPO_CONTRATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_SEQ_SUBTIPO_CONTRATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_CLASSIFICACAO', c01_w.IE_CLASSIFICACAO, 'S', contrato_w.IE_CLASSIFICACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_CLASSIFICACAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_ADITIVO', c01_w.NR_SEQ_ADITIVO, 'S', contrato_w.NR_SEQ_ADITIVO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_SEQ_ADITIVO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_ATUALIZACAO_ADITIVO', c01_w.DT_ATUALIZACAO_ADITIVO, 'S', contrato_w.DT_ATUALIZACAO_ADITIVO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DT_ATUALIZACAO_ADITIVO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CONTRATO_ATUAL', c01_w.NR_SEQ_CONTRATO_ATUAL, 'S', contrato_w.NR_SEQ_CONTRATO_ATUAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_SEQ_CONTRATO_ATUAL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_DIAS_INTERV_AVISO', c01_w.QT_DIAS_INTERV_AVISO, 'S', contrato_w.QT_DIAS_INTERV_AVISO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.QT_DIAS_INTERV_AVISO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_AREA', c01_w.NR_SEQ_AREA, 'S', contrato_w.NR_SEQ_AREA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_SEQ_AREA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_LIBERACAO', c01_w.DT_LIBERACAO, 'S', contrato_w.DT_LIBERACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DT_LIBERACAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_USUARIO_LIB', c01_w.NM_USUARIO_LIB, 'S', contrato_w.NM_USUARIO_LIB) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NM_USUARIO_LIB := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_INDICE_REAJUSTE', c01_w.NR_SEQ_INDICE_REAJUSTE, 'S', contrato_w.NR_SEQ_INDICE_REAJUSTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_SEQ_INDICE_REAJUSTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_AVISA_REAJUSTE', c01_w.IE_AVISA_REAJUSTE, 'S', contrato_w.IE_AVISA_REAJUSTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_AVISA_REAJUSTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_PUBLICACAO', c01_w.DT_PUBLICACAO, 'S', contrato_w.DT_PUBLICACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DT_PUBLICACAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SOLIC_COMPRA', c01_w.NR_SOLIC_COMPRA, 'S', contrato_w.NR_SOLIC_COMPRA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_SOLIC_COMPRA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_OPERACAO_NF', c01_w.CD_OPERACAO_NF, 'S', contrato_w.CD_OPERACAO_NF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_OPERACAO_NF := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_NATUREZA_OPERACAO', c01_w.CD_NATUREZA_OPERACAO, 'S', contrato_w.CD_NATUREZA_OPERACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_NATUREZA_OPERACAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_EMAIL_ORIGEM', c01_w.IE_EMAIL_ORIGEM, 'S', contrato_w.IE_EMAIL_ORIGEM) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_EMAIL_ORIGEM := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_ASSINATURA', c01_w.DT_ASSINATURA, 'S', contrato_w.DT_ASSINATURA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DT_ASSINATURA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_USUARIO_ASSINAT', c01_w.NM_USUARIO_ASSINAT, 'S', contrato_w.NM_USUARIO_ASSINAT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NM_USUARIO_ASSINAT := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_DIAS_REAJUSTE', c01_w.QT_DIAS_REAJUSTE, 'S', contrato_w.QT_DIAS_REAJUSTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.QT_DIAS_REAJUSTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'EMAIL_CONTATO', c01_w.EMAIL_CONTATO, 'S', contrato_w.EMAIL_CONTATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.EMAIL_CONTATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'TELEFONE_CONTATO', c01_w.TELEFONE_CONTATO, 'S', contrato_w.TELEFONE_CONTATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.TELEFONE_CONTATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_CUSTAS_CONTRATO', c01_w.VL_CUSTAS_CONTRATO, 'S', contrato_w.VL_CUSTAS_CONTRATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.VL_CUSTAS_CONTRATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'PR_CUSTAS_CONTRATO', c01_w.PR_CUSTAS_CONTRATO, 'S', contrato_w.PR_CUSTAS_CONTRATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.PR_CUSTAS_CONTRATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CNPJ_CONTRATANTE', c01_w.CD_CNPJ_CONTRATANTE, 'S', contrato_w.CD_CNPJ_CONTRATANTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_CNPJ_CONTRATANTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PESSOA_CONTRATANTE', c01_w.CD_PESSOA_CONTRATANTE, 'S', contrato_w.CD_PESSOA_CONTRATANTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_PESSOA_CONTRATANTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_TITULO_CONTRATO', c01_w.DS_TITULO_CONTRATO, 'S', contrato_w.DS_TITULO_CONTRATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DS_TITULO_CONTRATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DOCUMENTO_EXTERNO', c01_w.NR_DOCUMENTO_EXTERNO, 'S', contrato_w.NR_DOCUMENTO_EXTERNO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_DOCUMENTO_EXTERNO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PERIODO_NF', c01_w.IE_PERIODO_NF, 'S', contrato_w.IE_PERIODO_NF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_PERIODO_NF := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_MAXIMO_NF_PERIODO', c01_w.QT_MAXIMO_NF_PERIODO, 'S', contrato_w.QT_MAXIMO_NF_PERIODO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.QT_MAXIMO_NF_PERIODO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_DIAS_REVISAO', c01_w.QT_DIAS_REVISAO, 'S', contrato_w.QT_DIAS_REVISAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.QT_DIAS_REVISAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CONTRATO_GESTAO', c01_w.NR_SEQ_CONTRATO_GESTAO, 'S', contrato_w.NR_SEQ_CONTRATO_GESTAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_SEQ_CONTRATO_GESTAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_NEGOCIADO', c01_w.VL_NEGOCIADO, 'S', contrato_w.VL_NEGOCIADO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.VL_NEGOCIADO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CPF_CONTATO', c01_w.NR_CPF_CONTATO, 'S', contrato_w.NR_CPF_CONTATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_CPF_CONTATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_DIAS_PERIODO', c01_w.QT_DIAS_PERIODO, 'S', contrato_w.QT_DIAS_PERIODO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.QT_DIAS_PERIODO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_ESTAGIO', c01_w.IE_ESTAGIO, 'S', contrato_w.IE_ESTAGIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_ESTAGIO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_ENCERRAMENTO', c01_w.DT_ENCERRAMENTO, 'S', contrato_w.DT_ENCERRAMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DT_ENCERRAMENTO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_USUARIO_ENCER', c01_w.NM_USUARIO_ENCER, 'S', contrato_w.NM_USUARIO_ENCER) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NM_USUARIO_ENCER := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_OBSERVACAO', c01_w.DS_OBSERVACAO, 'S', contrato_w.DS_OBSERVACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DS_OBSERVACAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_ERRATA', c01_w.NR_SEQ_ERRATA, 'S', contrato_w.NR_SEQ_ERRATA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_SEQ_ERRATA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_PENDENCIA', c01_w.NR_SEQ_PENDENCIA, 'S', contrato_w.NR_SEQ_PENDENCIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_SEQ_PENDENCIA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_FINALIZADO', c01_w.IE_FINALIZADO, 'S', contrato_w.IE_FINALIZADO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_FINALIZADO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_FINALIZADO', c01_w.DT_FINALIZADO, 'S', contrato_w.DT_FINALIZADO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DT_FINALIZADO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_USUARIO_FINALIZ', c01_w.NM_USUARIO_FINALIZ, 'S', contrato_w.NM_USUARIO_FINALIZ) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NM_USUARIO_FINALIZ := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_SLA', c01_w.IE_SLA, 'S', contrato_w.IE_SLA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_SLA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_ENVIAR_EMAIL_OC', c01_w.IE_ENVIAR_EMAIL_OC, 'S', contrato_w.IE_ENVIAR_EMAIL_OC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_ENVIAR_EMAIL_OC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_MEDICO_RESP', c01_w.CD_MEDICO_RESP, 'S', contrato_w.CD_MEDICO_RESP) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_MEDICO_RESP := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_FATUR_MINIMO', c01_w.VL_FATUR_MINIMO, 'S', contrato_w.VL_FATUR_MINIMO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.VL_FATUR_MINIMO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CLIENTE', c01_w.NR_SEQ_CLIENTE, 'S', contrato_w.NR_SEQ_CLIENTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_SEQ_CLIENTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_MEDICO_EXTERNO', c01_w.NM_MEDICO_EXTERNO, 'S', contrato_w.NM_MEDICO_EXTERNO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NM_MEDICO_EXTERNO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_INDICE_REAJUSTE', c01_w.IE_INDICE_REAJUSTE, 'S', contrato_w.IE_INDICE_REAJUSTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_INDICE_REAJUSTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PACIENTE', c01_w.CD_PACIENTE, 'S', contrato_w.CD_PACIENTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_PACIENTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_MOEDA_ESTRANGEIRA', c01_w.CD_MOEDA_ESTRANGEIRA, 'S', contrato_w.CD_MOEDA_ESTRANGEIRA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_MOEDA_ESTRANGEIRA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_COMPRADOR', c01_w.CD_COMPRADOR, 'S', contrato_w.CD_COMPRADOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.CD_COMPRADOR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_ASSINATURA_ORIG', c01_w.DT_ASSINATURA_ORIG, 'S', contrato_w.DT_ASSINATURA_ORIG) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DT_ASSINATURA_ORIG := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_USUARIO_ASSINAT_ORIG', c01_w.NM_USUARIO_ASSINAT_ORIG, 'S', contrato_w.NM_USUARIO_ASSINAT_ORIG) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NM_USUARIO_ASSINAT_ORIG := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_SOMENTE_OC_PAGTO', c01_w.IE_SOMENTE_OC_PAGTO, 'S', contrato_w.IE_SOMENTE_OC_PAGTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_SOMENTE_OC_PAGTO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_SISTEMA_AMORT', c01_w.IE_SISTEMA_AMORT, 'S', contrato_w.IE_SISTEMA_AMORT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.IE_SISTEMA_AMORT := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_TAXA_BANCO_CONTRAT', c01_w.VL_TAXA_BANCO_CONTRAT, 'S', contrato_w.VL_TAXA_BANCO_CONTRAT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.VL_TAXA_BANCO_CONTRAT := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_INDEXADOR', c01_w.DS_INDEXADOR, 'S', contrato_w.DS_INDEXADOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.DS_INDEXADOR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDI_TELEFONE', c01_w.NR_DDI_TELEFONE, 'S', contrato_w.NR_DDI_TELEFONE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_w.NR_DDI_TELEFONE := _ora2pg_r.ds_valor_retorno_p;
		contrato_w.DT_ATUALIZACAO		:= clock_timestamp();
		contrato_w.DT_ATUALIZACAO_NREC	:= contrato_w.DT_ATUALIZACAO;
		contrato_w.NM_USUARIO_NREC		:= contrato_w.NM_USUARIO;

		if (reg_integracao_w.qt_reg_log = 0) then
			select	coalesce(max(nr_sequencia),0)
			into STRICT	contrato_w.NR_SEQUENCIA
			from	contrato
			where	nr_documento_externo = c01_w.nr_documento_externo;

			if (contrato_w.NR_SEQUENCIA > 0) then
				update	contrato
				set row = contrato_w
				where nr_sequencia = contrato_w.NR_SEQUENCIA;
			else
				select	nextval('contrato_seq')
				into STRICT	contrato_w.NR_SEQUENCIA
				;

				insert into contrato values (contrato_w.*);
			end if;
		end if;

		open c02;
		loop
		fetch c02 into
			c02_w;
		EXIT WHEN NOT FOUND; /* apply on c02 */
			begin
			reg_integracao_w.nm_tabela		:=	'CONTRATO_REGRA_NF';
			reg_integracao_w.nm_elemento	:=	'ITEM';
			reg_integracao_w.nr_seq_visao	:=	16248;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_MATERIAL', c02_w.CD_MATERIAL, 'S', contrato_regra_nf_w.CD_MATERIAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.CD_MATERIAL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CONTA_CONTABIL', c02_w.CD_CONTA_CONTABIL, 'S', contrato_regra_nf_w.CD_CONTA_CONTABIL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.CD_CONTA_CONTABIL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CENTRO_CUSTO', c02_w.CD_CENTRO_CUSTO, 'S', contrato_regra_nf_w.CD_CENTRO_CUSTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.CD_CENTRO_CUSTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CRIT_RATEIO', c02_w.NR_SEQ_CRIT_RATEIO, 'S', contrato_regra_nf_w.NR_SEQ_CRIT_RATEIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.NR_SEQ_CRIT_RATEIO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_COMPLEMENTO', c02_w.DS_COMPLEMENTO, 'S', contrato_regra_nf_w.DS_COMPLEMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.DS_COMPLEMENTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_OBSERVACAO', c02_w.DS_OBSERVACAO, 'S', contrato_regra_nf_w.DS_OBSERVACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.DS_OBSERVACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CONTA_FINANC', c02_w.NR_SEQ_CONTA_FINANC, 'S', contrato_regra_nf_w.NR_SEQ_CONTA_FINANC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.NR_SEQ_CONTA_FINANC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_PAGTO', c02_w.VL_PAGTO, 'S', contrato_regra_nf_w.VL_PAGTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.VL_PAGTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_INICIO_VIGENCIA', c02_w.DT_INICIO_VIGENCIA, 'S', contrato_regra_nf_w.DT_INICIO_VIGENCIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.DT_INICIO_VIGENCIA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_FIM_VIGENCIA', c02_w.DT_FIM_VIGENCIA, 'S', contrato_regra_nf_w.DT_FIM_VIGENCIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.DT_FIM_VIGENCIA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'PR_VARIACAO_VALOR', c02_w.PR_VARIACAO_VALOR, 'S', contrato_regra_nf_w.PR_VARIACAO_VALOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.PR_VARIACAO_VALOR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_CONVERSAO_NF', c02_w.QT_CONVERSAO_NF, 'S', contrato_regra_nf_w.QT_CONVERSAO_NF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.QT_CONVERSAO_NF := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_CONVERSAO_NF', c02_w.IE_CONVERSAO_NF, 'S', contrato_regra_nf_w.IE_CONVERSAO_NF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.IE_CONVERSAO_NF := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_PROJ_REC', c02_w.NR_SEQ_PROJ_REC, 'S', contrato_regra_nf_w.NR_SEQ_PROJ_REC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.NR_SEQ_PROJ_REC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_EQUIPAMENTO', c02_w.NR_SEQ_EQUIPAMENTO, 'S', contrato_regra_nf_w.NR_SEQ_EQUIPAMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.NR_SEQ_EQUIPAMENTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_ESTAB_REGRA', c02_w.CD_ESTAB_REGRA, 'S', contrato_regra_nf_w.CD_ESTAB_REGRA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.CD_ESTAB_REGRA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_LOCAL_ESTOQUE', c02_w.CD_LOCAL_ESTOQUE, 'S', contrato_regra_nf_w.CD_LOCAL_ESTOQUE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.CD_LOCAL_ESTOQUE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_VENC_PAGTO', c02_w.DT_VENC_PAGTO, 'S', contrato_regra_nf_w.DT_VENC_PAGTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.DT_VENC_PAGTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_DIAS_ANTES_GERAR_SC', c02_w.QT_DIAS_ANTES_GERAR_SC, 'S', contrato_regra_nf_w.QT_DIAS_ANTES_GERAR_SC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.QT_DIAS_ANTES_GERAR_SC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_GERA_SC_AUTOMATICO', c02_w.IE_GERA_SC_AUTOMATICO, 'S', contrato_regra_nf_w.IE_GERA_SC_AUTOMATICO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.IE_GERA_SC_AUTOMATICO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TIPO_REGRA', c02_w.IE_TIPO_REGRA, 'S', contrato_regra_nf_w.IE_TIPO_REGRA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.IE_TIPO_REGRA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PESSOA_SOLICITANTE', c02_w.CD_PESSOA_SOLICITANTE, 'S', contrato_regra_nf_w.CD_PESSOA_SOLICITANTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.CD_PESSOA_SOLICITANTE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_LIBERA_SOLIC', c02_w.IE_LIBERA_SOLIC, 'S', contrato_regra_nf_w.IE_LIBERA_SOLIC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.IE_LIBERA_SOLIC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_MARCA', c02_w.NR_SEQ_MARCA, 'S', contrato_regra_nf_w.NR_SEQ_MARCA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.NR_SEQ_MARCA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_SALDO_TOTAL', c02_w.VL_SALDO_TOTAL, 'S', contrato_regra_nf_w.VL_SALDO_TOTAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.VL_SALDO_TOTAL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_COT_COMPRA', c02_w.NR_COT_COMPRA, 'S', contrato_regra_nf_w.NR_COT_COMPRA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.NR_COT_COMPRA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_ITEM_COT_COMPRA', c02_w.NR_ITEM_COT_COMPRA, 'S', contrato_regra_nf_w.NR_ITEM_COT_COMPRA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.NR_ITEM_COT_COMPRA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_NATUREZA_OPERACAO', c02_w.CD_NATUREZA_OPERACAO, 'S', contrato_regra_nf_w.CD_NATUREZA_OPERACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.CD_NATUREZA_OPERACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_UNIDADE_MEDIDA_COMPRA', c02_w.CD_UNIDADE_MEDIDA_COMPRA, 'S', contrato_regra_nf_w.CD_UNIDADE_MEDIDA_COMPRA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.CD_UNIDADE_MEDIDA_COMPRA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PRECO', c02_w.IE_PRECO, 'S', contrato_regra_nf_w.IE_PRECO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.IE_PRECO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_QUANTIDADE', c02_w.IE_QUANTIDADE, 'S', contrato_regra_nf_w.IE_QUANTIDADE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.IE_QUANTIDADE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_ORDEM_COMPRA', c02_w.NR_ORDEM_COMPRA, 'S', contrato_regra_nf_w.NR_ORDEM_COMPRA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.NR_ORDEM_COMPRA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_ITEM_OCI', c02_w.NR_ITEM_OCI, 'S', contrato_regra_nf_w.NR_ITEM_OCI) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.NR_ITEM_OCI := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_MATERIAL_FIXA', c02_w.QT_MATERIAL_FIXA, 'S', contrato_regra_nf_w.QT_MATERIAL_FIXA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.QT_MATERIAL_FIXA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_DIAS_ENTREGA', c02_w.QT_DIAS_ENTREGA, 'S', contrato_regra_nf_w.QT_DIAS_ENTREGA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.QT_DIAS_ENTREGA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_ENDERECO', c02_w.DS_ENDERECO, 'S', contrato_regra_nf_w.DS_ENDERECO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.DS_ENDERECO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_ENTREGA', c02_w.DT_ENTREGA, 'S', contrato_regra_nf_w.DT_ENTREGA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.DT_ENTREGA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PERMITE_ADIANT', c02_w.IE_PERMITE_ADIANT, 'S', contrato_regra_nf_w.IE_PERMITE_ADIANT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.IE_PERMITE_ADIANT := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'PR_PERMITIDO_ADIANT', c02_w.PR_PERMITIDO_ADIANT, 'S', contrato_regra_nf_w.PR_PERMITIDO_ADIANT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.PR_PERMITIDO_ADIANT := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PRECO_OC', c02_w.IE_PRECO_OC, 'S', contrato_regra_nf_w.IE_PRECO_OC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.IE_PRECO_OC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_QUANTIDADE_OC', c02_w.IE_QUANTIDADE_OC, 'S', contrato_regra_nf_w.IE_QUANTIDADE_OC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.IE_QUANTIDADE_OC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'PR_DESCONTO', c02_w.PR_DESCONTO, 'S', contrato_regra_nf_w.PR_DESCONTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.PR_DESCONTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_DESCONTO', c02_w.VL_DESCONTO, 'S', contrato_regra_nf_w.VL_DESCONTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.VL_DESCONTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DOCUMENTO_EXTERNO', c02_w.NR_DOCUMENTO_EXTERNO, 'S', contrato_regra_nf_w.NR_DOCUMENTO_EXTERNO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_nf_w.NR_DOCUMENTO_EXTERNO := _ora2pg_r.ds_valor_retorno_p;
			contrato_regra_nf_w.nr_seq_contrato := contrato_w.nr_sequencia;
			contrato_regra_nf_w.dt_atualizacao := contrato_w.dt_atualizacao;
			contrato_regra_nf_w.nm_usuario := contrato_w.nm_usuario;
			contrato_regra_nf_w.dt_atualizacao_nrec := contrato_w.dt_atualizacao;
			contrato_regra_nf_w.nm_usuario_nrec := contrato_w.nm_usuario;

			if (reg_integracao_w.qt_reg_log = 0) then
				select	coalesce(max(nr_sequencia),0)
				into STRICT	contrato_regra_nf_w.nr_sequencia
				from	contrato_regra_nf
				where	nr_seq_contrato = contrato_w.nr_sequencia
				and		nr_documento_externo = contrato_regra_nf_w.nr_documento_externo;

				if (contrato_regra_nf_w.nr_sequencia > 0) then
					update	contrato_regra_nf
					set 	row = contrato_regra_nf_w
					where	nr_sequencia = contrato_regra_nf_w.nr_sequencia;
				else
					select	nextval('contrato_regra_nf_seq')
					into STRICT	contrato_regra_nf_w.nr_sequencia
					;

					insert into contrato_regra_nf values (contrato_regra_nf_w.*);
				end if;
			end if;
			end;
		end loop;
		close c02;

		open c03;
		loop
		fetch c03 into
			c03_w;
		EXIT WHEN NOT FOUND; /* apply on c03 */
			begin
			reg_integracao_w.nm_tabela		:=	'CONTRATO_REGRA_PAGTO';
			reg_integracao_w.nm_elemento	:=	'REGRA_PAGTO';
			reg_integracao_w.nr_seq_visao	:=	15173;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_FORMA', c03_w.IE_FORMA, 'S', contrato_regra_pagto_w.IE_FORMA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.IE_FORMA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_PRIMEIRO_VENCTO', c03_w.DT_PRIMEIRO_VENCTO, 'S', contrato_regra_pagto_w.DT_PRIMEIRO_VENCTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.DT_PRIMEIRO_VENCTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TIPO_VALOR', c03_w.IE_TIPO_VALOR, 'S', contrato_regra_pagto_w.IE_TIPO_VALOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.IE_TIPO_VALOR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_PAGTO', c03_w.VL_PAGTO, 'S', contrato_regra_pagto_w.VL_PAGTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.VL_PAGTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_MOEDA', c03_w.CD_MOEDA, 'S', contrato_regra_pagto_w.CD_MOEDA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.CD_MOEDA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_INDICE_REAJUSTE', c03_w.CD_INDICE_REAJUSTE, 'S', contrato_regra_pagto_w.CD_INDICE_REAJUSTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.CD_INDICE_REAJUSTE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PERIODO_REAJUSTE', c03_w.IE_PERIODO_REAJUSTE, 'S', contrato_regra_pagto_w.IE_PERIODO_REAJUSTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.IE_PERIODO_REAJUSTE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CONTA_FINANC', c03_w.CD_CONTA_FINANC, 'S', contrato_regra_pagto_w.CD_CONTA_FINANC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.CD_CONTA_FINANC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_IR', c03_w.VL_IR, 'S', contrato_regra_pagto_w.VL_IR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.VL_IR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_INSS', c03_w.VL_INSS, 'S', contrato_regra_pagto_w.VL_INSS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.VL_INSS := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_ISS', c03_w.VL_ISS, 'S', contrato_regra_pagto_w.VL_ISS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.VL_ISS := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_INICIO_VIGENCIA', c03_w.DT_INICIO_VIGENCIA, 'S', contrato_regra_pagto_w.DT_INICIO_VIGENCIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.DT_INICIO_VIGENCIA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_FINAL_VIGENCIA', c03_w.DT_FINAL_VIGENCIA, 'S', contrato_regra_pagto_w.DT_FINAL_VIGENCIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.DT_FINAL_VIGENCIA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_OBSERVACAO', c03_w.DS_OBSERVACAO, 'S', contrato_regra_pagto_w.DS_OBSERVACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.DS_OBSERVACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_INDICE_REAJUSTE', c03_w.QT_INDICE_REAJUSTE, 'S', contrato_regra_pagto_w.QT_INDICE_REAJUSTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.QT_INDICE_REAJUSTE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_REF_INDICE_REAJUSTE', c03_w.DS_REF_INDICE_REAJUSTE, 'S', contrato_regra_pagto_w.DS_REF_INDICE_REAJUSTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.DS_REF_INDICE_REAJUSTE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_REGRA_VENCIMENTO', c03_w.DS_REGRA_VENCIMENTO, 'S', contrato_regra_pagto_w.DS_REGRA_VENCIMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.DS_REGRA_VENCIMENTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_TRANS_FINANC', c03_w.NR_SEQ_TRANS_FINANC, 'S', contrato_regra_pagto_w.NR_SEQ_TRANS_FINANC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.NR_SEQ_TRANS_FINANC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_TRANS_FIN_BAIXA', c03_w.NR_SEQ_TRANS_FIN_BAIXA, 'S', contrato_regra_pagto_w.NR_SEQ_TRANS_FIN_BAIXA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.NR_SEQ_TRANS_FIN_BAIXA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_CENTRO_CONTRATO', c03_w.IE_CENTRO_CONTRATO, 'S', contrato_regra_pagto_w.IE_CENTRO_CONTRATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.IE_CENTRO_CONTRATO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'TX_DESC_ANTECIPACAO', c03_w.TX_DESC_ANTECIPACAO, 'S', contrato_regra_pagto_w.TX_DESC_ANTECIPACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.TX_DESC_ANTECIPACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CONTA_CONTABIL', c03_w.CD_CONTA_CONTABIL, 'S', contrato_regra_pagto_w.CD_CONTA_CONTABIL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.CD_CONTA_CONTABIL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_AVISO_REAJUSTE', c03_w.QT_AVISO_REAJUSTE, 'S', contrato_regra_pagto_w.QT_AVISO_REAJUSTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.QT_AVISO_REAJUSTE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CRIT_RATEIO', c03_w.NR_SEQ_CRIT_RATEIO, 'S', contrato_regra_pagto_w.NR_SEQ_CRIT_RATEIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.NR_SEQ_CRIT_RATEIO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TIPO_TITULO', c03_w.IE_TIPO_TITULO, 'S', contrato_regra_pagto_w.IE_TIPO_TITULO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.IE_TIPO_TITULO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CLASSE', c03_w.NR_SEQ_CLASSE, 'S', contrato_regra_pagto_w.NR_SEQ_CLASSE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.NR_SEQ_CLASSE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_TIPO_TAXA_MULTA', c03_w.CD_TIPO_TAXA_MULTA, 'S', contrato_regra_pagto_w.CD_TIPO_TAXA_MULTA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.CD_TIPO_TAXA_MULTA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_TIPO_TAXA_JURO', c03_w.CD_TIPO_TAXA_JURO, 'S', contrato_regra_pagto_w.CD_TIPO_TAXA_JURO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.CD_TIPO_TAXA_JURO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'TX_JUROS', c03_w.TX_JUROS, 'S', contrato_regra_pagto_w.TX_JUROS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.TX_JUROS := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'TX_MULTA', c03_w.TX_MULTA, 'S', contrato_regra_pagto_w.TX_MULTA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.TX_MULTA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_TIPO_RECEBIMENTO', c03_w.CD_TIPO_RECEBIMENTO, 'S', contrato_regra_pagto_w.CD_TIPO_RECEBIMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.CD_TIPO_RECEBIMENTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_PERIODO_VARIAVEL', c03_w.QT_PERIODO_VARIAVEL, 'S', contrato_regra_pagto_w.QT_PERIODO_VARIAVEL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.QT_PERIODO_VARIAVEL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PERIODO_VARIAVEL', c03_w.IE_PERIODO_VARIAVEL, 'S', contrato_regra_pagto_w.IE_PERIODO_VARIAVEL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.IE_PERIODO_VARIAVEL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_CHAMADO', c03_w.VL_CHAMADO, 'S', contrato_regra_pagto_w.VL_CHAMADO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.VL_CHAMADO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_LIBERACAO', c03_w.DT_LIBERACAO, 'S', contrato_regra_pagto_w.DT_LIBERACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.DT_LIBERACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_USUARIO_LIB', c03_w.NM_USUARIO_LIB, 'S', contrato_regra_pagto_w.NM_USUARIO_LIB) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.NM_USUARIO_LIB := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_GERAR_TRIBUTO_TIT', c03_w.IE_GERAR_TRIBUTO_TIT, 'S', contrato_regra_pagto_w.IE_GERAR_TRIBUTO_TIT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.IE_GERAR_TRIBUTO_TIT := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CONTA_BANCO', c03_w.NR_SEQ_CONTA_BANCO, 'S', contrato_regra_pagto_w.NR_SEQ_CONTA_BANCO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.NR_SEQ_CONTA_BANCO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CLASSE_TIT_REC', c03_w.NR_SEQ_CLASSE_TIT_REC, 'S', contrato_regra_pagto_w.NR_SEQ_CLASSE_TIT_REC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.NR_SEQ_CLASSE_TIT_REC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DOCUMENTO_EXTERNO', c03_w.NR_DOCUMENTO_EXTERNO, 'S', contrato_regra_pagto_w.NR_DOCUMENTO_EXTERNO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; contrato_regra_pagto_w.NR_DOCUMENTO_EXTERNO := _ora2pg_r.ds_valor_retorno_p;
			contrato_regra_pagto_w.nr_seq_contrato := contrato_w.nr_sequencia;
			contrato_regra_pagto_w.dt_atualizacao := contrato_w.dt_atualizacao;
			contrato_regra_pagto_w.nm_usuario := contrato_w.nm_usuario;

			if (reg_integracao_w.qt_reg_log = 0) then
				select	coalesce(max(nr_sequencia),0)
				into STRICT	contrato_regra_pagto_w.nr_sequencia
				from	contrato_regra_pagto
				where	nr_seq_contrato = contrato_w.nr_sequencia
				and		nr_documento_externo = contrato_regra_pagto_w.nr_documento_externo;

				if (contrato_regra_pagto_w.nr_sequencia > 0) then
					update	contrato_regra_pagto
					set		row = contrato_regra_pagto_w
					where	nr_sequencia = contrato_regra_pagto_w.nr_sequencia;
				else
					select	nextval('contrato_regra_pagto_seq')
					into STRICT	contrato_regra_pagto_w.nr_sequencia
					;

					insert into contrato_regra_pagto values (contrato_regra_pagto_w.*);
				end if;
			end if;
			end;
		end loop;
		close c03;
	end if;
	end;
end loop;
close C01;

if (reg_integracao_w.qt_reg_log > 0) then
	begin
	rollback;

	update	intpd_fila_transmissao
	set		ie_status = 'E',
			ie_tipo_erro = 'F'
	where	nr_sequencia = nr_sequencia_p;

	for i in 0..reg_integracao_w.qt_reg_log-1 loop
		INTPD_GRAVAR_LOG_RECEBIMENTO(nr_sequencia_p,reg_integracao_w.intpd_log_receb[i].ds_log,'INTPDTASY');
	end loop;
	end;
else
	update	intpd_fila_transmissao
	set		ie_status = 'S',
			nr_seq_documento = contrato_w.NR_SEQUENCIA,
			nr_doc_externo = c01_w.nr_documento_externo
	where	nr_sequencia = nr_sequencia_p;
end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE intpd_recebe_contrato ( nr_sequencia_p bigint, xml_p xml) FROM PUBLIC;

