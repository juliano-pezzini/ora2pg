-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE alterar_fornec_ordem_compra ( nr_ordem_compra_p bigint, cd_cnpj_p text, nm_usuario_p text) AS $body$
DECLARE

 
cd_cgc_fornecedor_w			varchar(14);
			

BEGIN 
 
select	cd_cgc_fornecedor 
into STRICT	cd_cgc_fornecedor_w 
from	ordem_compra 
where	nr_ordem_compra = nr_ordem_compra_p;
 
update	ordem_compra 
set	cd_cgc_fornecedor = cd_cnpj_p 
where	nr_ordem_compra = nr_ordem_compra_p;
	 
CALL inserir_historico_ordem_compra( 
	nr_ordem_compra_p, 
	'S', 
	WHEB_MENSAGEM_PCK.get_texto(297027), 
	WHEB_MENSAGEM_PCK.get_texto(297028,'CD_CGC_FORNECEDOR_W=' || cd_cgc_fornecedor_w || ';' || 'CD_CNPJ_P=' || cd_cnpj_p), 
	nm_usuario_p);
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE alterar_fornec_ordem_compra ( nr_ordem_compra_p bigint, cd_cnpj_p text, nm_usuario_p text) FROM PUBLIC;

