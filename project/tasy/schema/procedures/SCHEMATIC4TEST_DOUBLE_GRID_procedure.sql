-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE schematic4test_double_grid (NR_SEQUENCIA_P bigint, NM_USUARIO_P text) AS $body$
DECLARE

NM_MACHINE_W varchar(255);
DS_ADDRESS_W varchar(255);
DS_INFO_W varchar(255);
DS_RESOLUTION_W varchar(255);
IE_SHOW_W varchar(255);
IE_SITUACAO_W varchar(255);
IE_STATUS_W varchar(255);
IE_TYPE_W varchar(255);
NM_MACHINE_W2 varchar(255);
NR_QTD_W bigint;


BEGIN

  --procedure that duplicate machine
	INSERT INTO SCHEM_TEST_BEHOLDER(nr_sequencia, nm_usuario, dt_atualizacao, nm_usuario_nrec, dt_atualizacao_nrec, ds_interaction, ds_param_a)
    VALUES (nextval('schem_test_beholder_seq'), NM_USUARIO_P, clock_timestamp(), 'Robot', clock_timestamp(), 'SCHEMATIC4TEST_DOUBLE_GRID',
	'NR_SEQUENCIA_P as '||NR_SEQUENCIA_P);
	
  SELECT machine.NM_MACHINE, machine.DS_ADDRESS, machine.DS_INFO, machine.DS_RESOLUTION, machine.IE_SHOW, machine.IE_SITUACAO, machine.IE_STATUS, machine.IE_TYPE, machine.NR_QTD
     INTO STRICT NM_MACHINE_W, DS_ADDRESS_W, DS_INFO_W, DS_RESOLUTION_W, IE_SHOW_W, IE_SITUACAO_W, IE_STATUS_W, IE_TYPE_W, NR_QTD_W
  FROM SCHEM_TEST_GRID machine WHERE machine.NR_SEQUENCIA = NR_SEQUENCIA_P;

  NM_MACHINE_W2 := 'COPY OF '||NM_MACHINE_W;

  IF (NM_MACHINE_W IS NOT NULL AND NM_MACHINE_W::text <> '') THEN
    INSERT INTO SCHEM_TEST_GRID(NR_SEQUENCIA, NM_MACHINE, DS_ADDRESS, DS_INFO, DS_RESOLUTION, IE_SHOW, IE_SITUACAO, IE_STATUS, IE_TYPE, NR_QTD, NM_USUARIO, NM_USUARIO_NREC, DT_ATUALIZACAO, DT_ATUALIZACAO_NREC) 
          VALUES (nextval('schem_test_grid_seq'), NM_MACHINE_W2, DS_ADDRESS_W, DS_INFO_W, DS_RESOLUTION_W, IE_SHOW_W, IE_SITUACAO_W, IE_STATUS_W, IE_TYPE_W, NR_QTD_W, NM_USUARIO_P, NM_USUARIO_P, clock_timestamp(), clock_timestamp());
  END IF;
  COMMIT;

  EXCEPTION
  WHEN no_data_found THEN
     RAISE NOTICE 'Erro: Data not found';
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE schematic4test_double_grid (NR_SEQUENCIA_P bigint, NM_USUARIO_P text) FROM PUBLIC;

