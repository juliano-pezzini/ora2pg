-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE utilizacao_expressao (cd_expressao_p bigint, nm_usuario_p text) AS $body$
DECLARE


cd_codigo_w		bigint;
ds_local_w		varchar(255);

C01 CURSOR FOR
SELECT	0 cd_codigo,
		'Aplicação: ' || ds_aplicacao_tasy || ' - ' || cd_aplicacao_tasy ds_local
FROM	APLICACAO_TASY
WHERE	CD_EXP_APLICACAO = cd_expressao_p

UNION ALL

SELECT	NR_SEQUENCIA cd_codigo,
		'Dic Objeto' ds_local
FROM	DIC_OBJETO
WHERE   ((CD_EXP_CAMPO_TELA = cd_expressao_p) OR (CD_EXP_TEXTO = cd_expressao_p) OR (CD_EXP_INFORMACAO = cd_expressao_p))

UNION ALL

SELECT	NR_SEQUENCIA cd_codigo,
		'Dic Objeto Filtro' ds_local
FROM	DIC_OBJETO_FILTRO
WHERE   ((CD_EXP_LABEL = cd_expressao_p) OR (CD_EXP_OPCOES = cd_expressao_p))

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'EHR_ARQUETIPO' ds_local
FROM   EHR_ARQUETIPO
WHERE  cd_exp_arquetipo = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'EHR_CEFALOCAUDAL' ds_local
FROM   EHR_CEFALOCAUDAL
WHERE  CD_EXP_CEFALOCAUDAL = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'EHR_DOENCA' ds_local
FROM   EHR_DOENCA
WHERE  CD_EXP_DOENCA = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'EHR_ELEMENTO' ds_local
FROM   EHR_ELEMENTO
WHERE  ((CD_EXP_DESC_ELEMENTO = cd_expressao_p) OR (CD_EXP_ELEMENTO = cd_expressao_p) OR (CD_EXP_LABEL_GRID = cd_expressao_p) OR (CD_EXP_LABEL_TELA = cd_expressao_p) OR (CD_EXP_PALAVRA_CHAVE = cd_expressao_p))

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'EHR_ELEMENTO_VISUAL' ds_local
FROM   EHR_ELEMENTO_VISUAL
WHERE  CD_EXP_ELEMENTO = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'EHR_ENTIDADE_TASY' ds_local
FROM   EHR_ENTIDADE_TASY
WHERE  CD_EXP_ENTIDADE = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'EHR_ESPECIALIDADE' ds_local
FROM   EHR_ESPECIALIDADE
WHERE  CD_EXP_ESPECIALIDADE = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'EHR_GRUPO_ELEMENTO' ds_local
FROM   EHR_GRUPO_ELEMENTO
WHERE  CD_EXP_GRUPO = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'EHR_SUBGRUPO_ELEMENTO' ds_local
FROM   EHR_SUBGRUPO_ELEMENTO
WHERE  CD_EXP_SUBGRUPO = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'EHR_TIPO_DADO' ds_local
FROM   EHR_TIPO_DADO
WHERE  ((CD_EXP_PROPOSITO = cd_expressao_p) OR (CD_EXP_TIPO = cd_expressao_p) OR (CD_EXP_USO = cd_expressao_p))

UNION ALL

SELECT	nr_sequencia cd_codigo,
		'EHR_UNIDADE_MEDIDA' ds_local
FROM	EHR_UNIDADE_MEDIDA
WHERE	CD_EXP_UNIDADE_MEDIDA = cd_expressao_p

UNION ALL

SELECT	nr_sequencia cd_codigo,
		'Evento: ' || nm_evento
FROM	EVENTO_TASY
WHERE	CD_EXP_EVENTO = cd_expressao_p

UNION ALL

SELECT cd_funcao cd_codigo,
	   'Função: ' || ds_funcao
FROM   funcao
WHERE  cd_exp_funcao = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'Parâmetro - Função: ' || cd_funcao	ds_local
FROM   FUNCAO_PARAMETRO
WHERE  ((cd_exp_parametro = cd_expressao_p) OR (CD_EXP_OBSERVACAO = cd_expressao_p))

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'Indicador de Gestão - INDICADOR_GESTAO' ds_local
FROM   INDICADOR_GESTAO
WHERE  CD_EXP_INDICADOR = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'Indicador de Gestão Atributos - INDICADOR_GESTAO_ATRIB' ds_local
FROM   INDICADOR_GESTAO_ATRIB
WHERE  ((cd_exp_dimensao = cd_expressao_p) OR (CD_EXP_GRID = cd_expressao_p) OR (CD_EXP_DATA = cd_expressao_p) OR (CD_EXP_INFORMACAO = cd_expressao_p))

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'Módulo Implantação - ' || nm_modulo		ds_local
FROM   MODULO_IMPLANTACAO
WHERE  cd_exp_modulo = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'Módulo Tasy - ' || nm_modulo
FROM   MODULO_TASY
WHERE  cd_exp_modulo = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'SubIndicador - ' || ds_subindicador ds_local
FROM   SUBINDICADOR_GESTAO
WHERE  cd_exp_subindicador = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'SubIndicador Atrib: ' || nr_seq_subindicador  || ' - ' || nm_Atributo ds_local
FROM   SUBINDICADOR_GESTAO_ATRIB
WHERE  cd_exp_grid = cd_expressao_p

UNION ALL

SELECT 0 cd_codigo,
	   'Tabela: ' || nm_tabela || ' - Atributo: ' || nm_atributo  ds_local
FROM  TABELA_ATRIBUTO
WHERE ((CD_EXP_DESC = cd_expressao_p) OR (CD_EXP_LABEL = cd_expressao_p) OR (CD_EXP_LABEL_GRID = cd_expressao_p) OR (CD_EXP_VALORES = cd_expressao_p))

UNION ALL

SELECT 0 cd_codigo,
	   'Tabela Sistema: ' || nm_tabela ds_local
FROM  TABELA_SISTEMA
WHERE ((cd_exp_titulo = cd_expressao_p) OR (cd_exp_cadastro = cd_expressao_p))

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'Tabela Visão' ds_local
FROM   tabela_visao
WHERE  cd_exp_titulo = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'Tabela Visao Atributo: ' || nm_atributo ds_local
FROM  TABELA_VISAO_ATRIBUTO
WHERE ((cd_exp_label = cd_expressao_p) OR (CD_EXP_DESC = cd_expressao_p) OR (CD_EXP_LABEL_GRID = cd_expressao_p) OR (CD_EXP_VALORES = cd_expressao_p))

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'Legenda: ' || ds_legenda  ds_local
FROM  TASY_LEGENDA
WHERE cd_exp_legenda = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'Cor da Legenda - Legenda: ' || nr_seq_legenda ds_local
FROM  tasy_padrao_cor
WHERE cd_exp_item = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'Imagem da Legenda - Legenda: ' || nr_seq_legenda ds_local
FROM  TASY_PADRAO_IMAGEM
WHERE cd_exp_legenda = cd_expressao_p

UNION ALL

SELECT nr_sequencia cd_codigo,
	   'Atributo ' || nm_atributo ||' do Localizador número: ' || nr_seq_tipo_localizar ds_local
FROM  TIPO_LOCALIZAR_ATRIBUTO
WHERE cd_exp_item = cd_expressao_p

UNION ALL

SELECT cd_dominio cd_codigo,
	   'Valor Dominio: ' || ds_valor_dominio ds_local
FROM   valor_dominio
WHERE  cd_exp_valor_dominio = cd_expressao_p;



BEGIN

delete
from	w_local_expressao
where	nm_usuario = nm_usuario_p;

open C01;
loop
fetch C01 into
	cd_codigo_w,
	ds_local_w;
EXIT WHEN NOT FOUND; /* apply on C01 */
	begin
		insert into w_local_expressao(cd_codigo,
									   ds_local,
									   nm_usuario)
		values (cd_codigo_w,
									   ds_local_w,
									   nm_usuario_p);


	end;
end loop;
close C01;


commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE utilizacao_expressao (cd_expressao_p bigint, nm_usuario_p text) FROM PUBLIC;

