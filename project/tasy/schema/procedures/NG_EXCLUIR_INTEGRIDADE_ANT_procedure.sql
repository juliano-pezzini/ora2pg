-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE ng_excluir_integridade_ant () AS $body$
DECLARE


qt_registro_w	bigint;

BEGIN

/* ================= INICIO - Eliminar INTEGRIDADES ANTIGAS PARA SUBSTITUIR ===============*/

/*CENTRO_CONTROLE_TIPO_GASTO*/

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns a
where	a.constraint_name 	= 'CENTPGA_NATGAST_FK'
and	a.table_name		= 'CENTRO_CONTROLE_TIPO_GASTO'
and	a.column_name		= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table CENTRO_CONTROLE_TIPO_GASTO drop constraint CENTPGA_NATGAST_FK');
end if;

/* CRITERIO_DISTR_ORC*/

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns
where	table_name = 'CRITERIO_DISTR_ORC'
and	constraint_name = 'CRIDIOR_NATGAST_FK'
and	column_name	= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table CRITERIO_DISTR_ORC drop constraint CRIDIOR_NATGAST_FK');
end if;

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns
where	table_name = 'CRITERIO_DISTR_ORC'
and	constraint_name = 'CRIDIOR_NATGAST_FK3'
and	column_name	= 'NR_SEQ_NG_DEST';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table CRITERIO_DISTR_ORC drop constraint CRIDIOR_NATGAST_FK3');
end if;

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns
where	table_name = 'CRITERIO_DISTR_ORC'
and	constraint_name = 'CRIDIOR_NATGAST_FK4'
and	column_name	= 'NR_SEQ_NG_REF';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table CRITERIO_DISTR_ORC drop constraint CRIDIOR_NATGAST_FK4');
end if;


/* CRITERIO_DISTR_ORC_DEST*/

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns
where	table_name = 'CRITERIO_DISTR_ORC_DEST'
and	constraint_name = 'CRIDIOD_NATGAST_FK'
and	column_name	= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table CRITERIO_DISTR_ORC_DEST drop constraint CRIDIOD_NATGAST_FK');
end if;

/* CUS_AGRUP_CONTA */

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns
where	table_name = 'CUS_AGRUP_CONTA'
and	constraint_name = 'CUAGCON_NATGAST_FK'
and	column_name	= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table CUS_AGRUP_CONTA drop constraint CUAGCON_NATGAST_FK');
end if;

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns
where	table_name = 'CUS_AGRUP_CONTA'
and	constraint_name = 'CUAGCON_NATGAST_FK2'
and	column_name	= 'NR_SEQ_NG_ORIGEM';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table CUS_AGRUP_CONTA drop constraint CUAGCON_NATGAST_FK2');
end if;

/* CUS_AMORTIZACAO */

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns
where	table_name = 'CUS_AMORTIZACAO'
and	constraint_name = 'CUSAMOR_NATGAST_FK'
and	column_name	= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table CUS_AMORTIZACAO drop constraint CUSAMOR_NATGAST_FK');
end if;

/* CUS_CENTRO_TERC_CRIT */

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns a
where	a.constraint_name 	= 'CUSCETC_NATGAST_FK'
and	a.table_name		= 'CUS_CENTRO_TERC_CRIT'
and	a.column_name		= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table cus_centro_terc_crit drop constraint CUSCETC_NATGAST_FK');
end if;

/* CUS_REGRA_IMP_CONTAB*/

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns a
where	a.constraint_name 	= 'CUSREIC_NATGAST_FK'
and	a.table_name		= 'CUS_REGRA_IMP_CONTAB'
and	a.column_name		= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table CUS_REGRA_IMP_CONTAB drop constraint CUSREIC_NATGAST_FK');
end if;

/* CUS_RESULT_TERC */

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns a
where	a.constraint_name 	= 'CUSRETE_NATGAST_FK'
and	a.table_name		= 'CUS_RESULT_TERC'
and	a.column_name		= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table CUS_RESULT_TERC drop constraint CUSRETE_NATGAST_FK');
end if;

/* CUS_TERC_MOVTO */

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns a
where	a.constraint_name 	= 'CUSTEMO_NATGAST_FK'
and	a.table_name		= 'CUS_TERC_MOVTO'
and	a.column_name		= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table CUS_TERC_MOVTO drop constraint CUSTEMO_NATGAST_FK');
end if;

/* ORCAMENTO_CUSTO */

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns a
where	a.constraint_name 	= 'ORCCUST_NATGAST_FK'
and	a.table_name		= 'ORCAMENTO_CUSTO'
and	a.column_name		= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table ORCAMENTO_CUSTO drop constraint ORCCUST_NATGAST_FK');
end if;

/* ORCAMENTO_CUSTO_IMPORT */

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns a
where	a.constraint_name 	= 'ORCUIMP_NATGAST_FK'
and	a.table_name		= 'ORCAMENTO_CUSTO_IMPORT'
and	a.column_name		= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table ORCAMENTO_CUSTO_IMPORT drop constraint ORCUIMP_NATGAST_FK');
end if;

/*REGRA_CALC_ORC_CUSTO*/

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns
where	table_name = 'REGRA_CALC_ORC_CUSTO'
and	constraint_name = 'REGCAOC_NATGAST_FK'
and	column_name	= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table REGRA_CALC_ORC_CUSTO drop constraint REGCAOC_NATGAST_FK');
end if;


select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns
where	table_name = 'REGRA_CALC_ORC_CUSTO'
and	constraint_name = 'REGCAOC_NATGAST_FK2'
and	column_name	= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table REGRA_CALC_ORC_CUSTO drop constraint REGCAOC_NATGAST_FK2');
end if;

/* RESULTADO_CENTRO_CONTROLE*/

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns
where	table_name = 'RESULTADO_CENTRO_CONTROLE'
and	constraint_name = 'RESCECO_NATGAST_FK'
and	column_name	= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table RESULTADO_CENTRO_CONTROLE drop constraint RESCECO_NATGAST_FK');
end if;

/* TAXA_CUSTO_NAT */

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns
where	table_name = 'TAXA_CUSTO_NAT'
and	constraint_name = 'TAXCUNA_NATGAST_FK'
and	column_name	= 'NR_SEQ_NG';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table TAXA_CUSTO_NAT drop constraint TAXCUNA_NATGAST_FK');
end if;
/* ========================= FIM Exclusão Integridades ====================================== */

/* =================== Exclusão CHAVE Primária da NATUREZA_GASTO (CD_ESTABELECIMENTO, CD_NATUREZA_GASTO) === */

select	count(*)
into STRICT	qt_registro_w
from	user_cons_columns
where	table_name	= 'NATUREZA_GASTO'
and	constraint_name	= 'NATGAST_PK'
and	column_name	= 'NR_SEQUENCIA';

if (qt_registro_w = 0) then
	CALL exec_sql_dinamico('BACA_NG_PK','alter table NATUREZA_GASTO drop constraint NATGAST_PK');
	CALL exec_sql_dinamico('BACA_NG_PK','drop index NATGAST_PK');
end if;

/*====================== FIM EXCLUSÂO CHAVE PRIMARIA GNG ===================================*/

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ng_excluir_integridade_ant () FROM PUBLIC;

