-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE inserir_ordem_telefonica ( nr_prescricao_p bigint, cd_medico_ordem_tel_p text, ds_observacao_p text, nm_usuario_p text, ds_erro_p INOUT text) AS $body$
DECLARE


qt_medico_w		bigint;


BEGIN

SELECT COUNT(*)
INTO STRICT qt_medico_w
FROM medico
WHERE cd_pessoa_fisica = cd_medico_ordem_tel_p;

IF (qt_medico_w > 0) THEN
	INSERT INTO nut_contato_medico(	nr_sequencia,
				cd_medico,
				ds_observacao,
				nm_usuario_registro,
				dt_registro,
				nr_prescricao,
				dt_atualizacao,
				dt_atualizacao_nrec,
				nm_usuario,
				nm_usuario_nrec)
	VALUES (nextval('nut_contato_medico_seq'),
				cd_medico_ordem_tel_p,
				ds_observacao_p,
				nm_usuario_p,
				clock_timestamp(),
				nr_prescricao_p,
				clock_timestamp(),
				clock_timestamp(),
				nm_usuario_p,
				nm_usuario_p);
ELSE
	ds_erro_p := obter_texto_tasy(349085, wheb_usuario_pck.get_nr_seq_idioma);
END IF;

COMMIT;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE inserir_ordem_telefonica ( nr_prescricao_p bigint, cd_medico_ordem_tel_p text, ds_observacao_p text, nm_usuario_p text, ds_erro_p INOUT text) FROM PUBLIC;

