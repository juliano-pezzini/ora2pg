-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE prescr_sol_bco_san_newrecord ( nr_atendimento_p bigint, cd_pessoa_fisica_p text, ds_diagnostico_p INOUT text, qt_transfusao_p INOUT bigint, qt_peso_p INOUT bigint, qt_altura_p INOUT bigint, qt_imc_p INOUT bigint, qt_gestacoes_p INOUT bigint, qt_abortos_p INOUT bigint, qt_freq_cardiaca_p INOUT bigint, qt_pa_diastolica_p INOUT bigint, qt_pa_sistolica_p INOUT bigint, qt_temp_p INOUT bigint, qt_reacao_transf_p INOUT text, nm_usuario_p text) AS $body$
DECLARE

			 
ds_diagnostico_w		varchar(240);
qt_transfusao_w		bigint;
qt_peso_w		double precision;
qt_altura_w		double precision;
qt_imc_w			double precision;
qt_gestacoes_w		smallint;
qt_abortos_w		smallint;
qt_reacao_transf_w		varchar(100);
qt_freq_cardiaca_w		atendimento_sinal_vital.qt_freq_cardiaca%type;
qt_pa_diastolica_w		atendimento_sinal_vital.qt_pa_diastolica%type;
qt_pa_sistolica_w		atendimento_sinal_vital.qt_pa_sistolica%type;
qt_temp_w		atendimento_sinal_vital.qt_temp%type;				
 

BEGIN 
 
ds_diagnostico_w 	 := Obter_Diagnostico_Atendimento(nr_atendimento_p);
qt_transfusao_w	 := Obter_qt_tansfusao_hosp(cd_pessoa_fisica_p);
qt_peso_w	 := obter_sinal_vital(nr_atendimento_p,'Peso');
qt_altura_w	 := obter_sinal_vital(nr_atendimento_p,'Altura');
qt_imc_w		 := obter_sinal_vital(nr_atendimento_p,'IMC');
qt_freq_cardiaca_w	 := obter_sinal_vital(nr_atendimento_p,'FC');
qt_pa_diastolica_w	 := obter_sinal_vital(nr_atendimento_p,'PAMIN');
qt_pa_sistolica_w	 := obter_sinal_vital(nr_atendimento_p,'PAMAX');
qt_temp_w	:= obter_sinal_vital(nr_atendimento_p,'Temp');
 
select	max(qt_gestacoes) 
into STRICT	qt_gestacoes_w 
from 	parto 
where 	nr_atendimento = nr_atendimento_p;
 
select	max(qt_abortos) 
into STRICT	qt_abortos_w 
from 	parto 
where 	nr_atendimento = nr_atendimento_p;
 
qt_reacao_transf_w := obter_reacao_transfuncional(cd_pessoa_fisica_p,'DPF');
 
ds_diagnostico_p	:= ds_diagnostico_w;
qt_transfusao_p	:= qt_transfusao_w;
qt_peso_p	:= qt_peso_w;
qt_altura_p	:= qt_altura_w;
qt_imc_p		:= qt_imc_w;
qt_gestacoes_p	:= qt_gestacoes_w;
qt_abortos_p	:= qt_abortos_w;	
qt_reacao_transf_p	:= qt_reacao_transf_w;
qt_freq_cardiaca_p := qt_freq_cardiaca_w;
qt_pa_diastolica_p	:= qt_pa_diastolica_w;
qt_pa_sistolica_p	:= qt_pa_sistolica_w;
qt_temp_p	:= qt_temp_w;
 
 
 
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE prescr_sol_bco_san_newrecord ( nr_atendimento_p bigint, cd_pessoa_fisica_p text, ds_diagnostico_p INOUT text, qt_transfusao_p INOUT bigint, qt_peso_p INOUT bigint, qt_altura_p INOUT bigint, qt_imc_p INOUT bigint, qt_gestacoes_p INOUT bigint, qt_abortos_p INOUT bigint, qt_freq_cardiaca_p INOUT bigint, qt_pa_diastolica_p INOUT bigint, qt_pa_sistolica_p INOUT bigint, qt_temp_p INOUT bigint, qt_reacao_transf_p INOUT text, nm_usuario_p text) FROM PUBLIC;

