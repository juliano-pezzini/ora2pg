-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gravar_log_acesso_os ( nm_usuario_p text, ie_informacao_p text, nr_ordem_servico_p bigint, nr_seq_informacao_p bigint) AS $body$
DECLARE


/*    ie_informacao_p
H - Histórico
-- Grava no aftersroll do grid
D - Detalhamento
-- Grava ao acessar a OS, após ativar o wdbpanel da MAN_ORDEM_SERVICO
A - Anexo
-- Grava ao realizar o clique, duplo clique para abrir o arquivo, fazer o download  ou visualizar,
*/
/*    nr_seq_informacao_p
Grava  a sequencia /PK  visualizada da tabela
*/
BEGIN

begin
insert into log_acesso_os(
							nr_sequencia,
							nm_usuario_acesso,
							dt_acesso,
							ie_tipo_informacao,
							nr_ordem_servico,
							nr_seq_informacao,
							cd_funcao,
							cd_perfil)
					values (
							nextval('log_acesso_os_seq'),
							nm_usuario_p,
							clock_timestamp(),
							ie_informacao_p,
							nr_ordem_servico_p,
							nr_seq_informacao_p,
							wheb_usuario_pck.get_cd_funcao,
							wheb_usuario_pck.get_cd_perfil);
exception
when others then
	null;
end;


commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gravar_log_acesso_os ( nm_usuario_p text, ie_informacao_p text, nr_ordem_servico_p bigint, nr_seq_informacao_p bigint) FROM PUBLIC;

