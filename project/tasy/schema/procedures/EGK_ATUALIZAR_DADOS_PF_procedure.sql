-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE egk_atualizar_dados_pf ( ds_nome_p text, ds_sobrenome_p text, ie_sexo_p text, dt_nascimento_p timestamp, ds_endereco_p text, ds_municipio_p text, cd_cep_p text, nr_endereco_p text, cd_pessoa_fisica_p text ) AS $body$
DECLARE


nr_seq_person_name_w	pessoa_fisica.nr_seq_person_name%type;


BEGIN

select	max(nr_seq_person_name)
into STRICT	nr_seq_person_name_w
from	pessoa_fisica
where	cd_pessoa_fisica = cd_pessoa_fisica_p;


update	person_name
set	ds_given_name = ds_nome_p,
	ds_family_name = ds_sobrenome_p,
    ds_component_name_1  = NULL,
    ds_component_name_2  = NULL,
    ds_component_name_3  = NULL
where	nr_sequencia = nr_seq_person_name_w;

update	pessoa_fisica
set	nm_pessoa_fisica = ds_nome_p || ' ' || ds_sobrenome_p,
	ie_sexo = ie_sexo_p,
	dt_nascimento = dt_nascimento_p
where	cd_pessoa_fisica = cd_pessoa_fisica_p;

update	compl_pessoa_fisica
set	ds_endereco = ds_endereco_p,
	ds_municipio = ds_municipio_p,
	cd_cep = cd_cep_p,
	ds_compl_end = nr_endereco_p
where	cd_pessoa_fisica = cd_pessoa_fisica_p
and	ie_tipo_complemento = 1;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE egk_atualizar_dados_pf ( ds_nome_p text, ds_sobrenome_p text, ie_sexo_p text, dt_nascimento_p timestamp, ds_endereco_p text, ds_municipio_p text, cd_cep_p text, nr_endereco_p text, cd_pessoa_fisica_p text ) FROM PUBLIC;

