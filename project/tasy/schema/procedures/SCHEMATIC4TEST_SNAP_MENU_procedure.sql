-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE schematic4test_snap_menu (nr_seq_snap_p bigint, ie_tipo text, nm_usuario_p text) AS $body$
BEGIN
	--procedure set status to database
	INSERT INTO SCHEM_TEST_BEHOLDER(nr_sequencia, nm_usuario, dt_atualizacao, nm_usuario_nrec, dt_atualizacao_nrec, ds_interaction, ds_param_a, ds_param_b)
		VALUES (nextval('schem_test_beholder_seq'), NM_USUARIO_P, clock_timestamp(), 'Robot', clock_timestamp(), 'SCHEMATIC4TEST_SNAP_MENU',
		'nr_seq_snap_p as '||nr_seq_snap_p, 
		'ie_tipo as '||ie_tipo);

	if (ie_tipo = '1') then
		UPDATE SCHEM_TEST_SNAPSHOT SET IE_STATUS = '1', NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = nr_seq_snap_p;
		UPDATE SCHEM_TEST_URL SET IE_STATUS = '0', NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = (SELECT NR_SEQ_URL FROM SCHEM_TEST_SNAPSHOT WHERE NR_SEQUENCIA = nr_seq_snap_p);
	end if;

	if (ie_tipo = '2') then
		UPDATE SCHEM_TEST_SNAPSHOT SET IE_STATUS = '0', NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = nr_seq_snap_p;
		UPDATE SCHEM_TEST_URL SET IE_STATUS = '1', NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = (SELECT NR_SEQ_URL FROM SCHEM_TEST_SNAPSHOT WHERE NR_SEQUENCIA = nr_seq_snap_p);
	end if;

	if (ie_tipo = '3') then
		UPDATE SCHEM_TEST_SNAPSHOT SET IE_STATUS = '2', IE_JOBS = '1', NM_SNAPSHOT = nm_usuario_p, NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = nr_seq_snap_p;
	end if;

	if (ie_tipo = '4') then
		UPDATE SCHEM_TEST_SNAPSHOT SET IE_STATUS = '3', IE_JOBS = '2', NM_RESTORE = nm_usuario_p, NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = nr_seq_snap_p;
	end if;

	if (ie_tipo = '5') then
		UPDATE SCHEM_TEST_SNAPSHOT SET IE_STATUS = '7', IE_JOBS = '3', NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = nr_seq_snap_p;
	end if;
	
	if (ie_tipo = '6') then
		UPDATE SCHEM_TEST_SNAPSHOT SET IE_STATUS = '10', IE_JOBS = '4', NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = nr_seq_snap_p;
	end if;
	
	if (ie_tipo = '7') then
		UPDATE SCHEM_TEST_SNAPSHOT SET IE_STATUS = '11', IE_JOBS = '5', NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = nr_seq_snap_p;
	end if;
	
	if (ie_tipo = '8') then
		UPDATE SCHEM_TEST_SNAPSHOT SET IE_STATUS = '12', IE_JOBS = '6', NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = nr_seq_snap_p;				
		UPDATE SCHEM_TEST_SNAPSHOT SET IE_JOBS = '10', NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = nr_seq_snap_p;
	end if;
	
	if (ie_tipo = '9') then
		UPDATE SCHEM_TEST_SNAP_RESTORE SET IE_SWITCH = 'S', NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = nr_seq_snap_p;
	end if;
	
	if (ie_tipo = '10') then
		UPDATE SCHEM_TEST_SNAPSHOT SET IE_STATUS = '17', IE_JOBS = '7', NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = nr_seq_snap_p;
	end if;

  if (ie_tipo = '11') then
		UPDATE SCHEM_TEST_SNAPSHOT SET IE_JOBS = '8', NM_USUARIO = nm_usuario_p, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = nr_seq_snap_p;
	end if;
	
    commit;
EXCEPTION
WHEN no_data_found THEN
  RAISE NOTICE 'Erro: Data not found';
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE schematic4test_snap_menu (nr_seq_snap_p bigint, ie_tipo text, nm_usuario_p text) FROM PUBLIC;

