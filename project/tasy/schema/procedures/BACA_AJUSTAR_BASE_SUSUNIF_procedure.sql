-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE baca_ajustar_base_susunif (nm_usuario_p text) AS $body$
DECLARE

 
 
qt_registro_w		bigint;
dt_competencia_sus_w	timestamp;
data_type_w		varchar(106);
nr_sequencia_w		bigint;
nr_aih_w		bigint;
nr_atendimento_w	bigint;
nr_seq_grupo_w		bigint;
cd_estabelecimento_w	smallint;
dt_versao_atual_cli_w	timestamp;

C01 CURSOR FOR 
	SELECT	nr_aih, 
		nr_sequencia 
	from	sus_registro_civil 
	where	coalesce(nr_atendimento::text, '') = '';
	
C02 CURSOR FOR 
	SELECT	cd_estabelecimento 
	from	estabelecimento 
	order by cd_estabelecimento;


BEGIN 
 
select 	coalesce(TO_DATE(TO_CHAR(obter_data_geracao_versao-1,'dd/mm/yyyy') ||' 23:59:59','dd/mm/yyyy hh24:mi:ss'),clock_timestamp() - interval '90 days') 
into STRICT	dt_versao_atual_cli_w
;
 
/* Felipe 08/01/2008 - Ajustar as inconsistências */
 
CALL Baca_Ajustar_Inco_SusUnif(nm_usuario_p);
 
/* Felipe 27/01/2008 - Ajustar a interface */
 
CALL Baca_Ajustar_Interf_SusUnif(nm_usuario_p);
 
/* Felipe 12/09/2007 - Excluir o campo IE_MOD_ATENDIMENTO da SUS_AIH_UNIF */
 
if (dt_versao_atual_cli_w < to_date('10/01/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_tab_columns 
	where	table_name	= 'SUS_AIH_UNIF' 
	and	COLUMN_NAME	= 'IE_MOD_ATENDIMENTO';
	if (qt_registro_w > 0) then 
		CALL Exec_sql_Dinamico('Felipe', 'alter table SUS_AIH_UNIF drop column IE_MOD_ATENDIMENTO ');	
	end if;
end if;
 
/* Felipe 15/09/2007 - Excluir o campo IE_CARATER_INTER_SUS da SUS_AIH_UNIF */
 
if (dt_versao_atual_cli_w < to_date('10/01/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_tab_columns 
	where	table_name	= 'SUS_AIH_UNIF' 
	and	COLUMN_NAME	= 'IE_CARATER_INTER_SUS';
	if (qt_registro_w > 0) then 
		CALL Exec_sql_Dinamico('Felipe', 'alter table SUS_AIH_UNIF drop column IE_CARATER_INTER_SUS ');	
	end if;
end if;
 
/* Felipe 15/09/2007 - Excluir o campo IE_ESPECIALIDADE_AIH da SUS_AIH_UNIF */
 
if (dt_versao_atual_cli_w < to_date('10/01/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_tab_columns 
	where	table_name	= 'SUS_AIH_UNIF' 
	and	COLUMN_NAME	= 'IE_ESPECIALIDADE_AIH';
	if (qt_registro_w > 0) then 
		CALL Exec_sql_Dinamico('Felipe', 'alter table SUS_AIH_UNIF drop column IE_ESPECIALIDADE_AIH ');	
	end if;
end if;
 
/* Felipe 02/10/2007 - Excluir o campo IE_MOD_ATENDIMENTO da W_SUSAIH_INTERF_CONTA */
 
if (dt_versao_atual_cli_w < to_date('10/01/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_tab_columns 
	where	table_name	= 'W_SUSAIH_INTERF_CONTA' 
	and	COLUMN_NAME	= 'IE_MOD_ATENDIMENTO';
	if (qt_registro_w > 0) then 
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CONTA drop column IE_MOD_ATENDIMENTO ');	
	end if;
end if;
 
/* Felipe 29/10/2007 - Dropar as integridades da SUS_AIH_UNIF com a CID_DOENCA */
 
if (dt_versao_atual_cli_w < to_date('04/01/2008','dd/mm/yyyy')) then 
	/* CD_CID_PRINCIPAL */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSAIUN_CIDDOEN_FK' 
	and	column_name	= 'CD_CID_PRINCIPAL';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_aih_unif drop constraint SUSAIUN_CIDDOEN_FK'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSAIUN_CIDDOEN_FK_I'); /* índice */
		end;
	end if;
 
	/* CD_CID_SECUNDARIO */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSAIUN_CIDDOEN_FK2' 
	and	column_name	= 'CD_CID_SECUNDARIO';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_aih_unif drop constraint SUSAIUN_CIDDOEN_FK2'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSAIUN_CIDDOEN_FK2_I'); /* índice */
		end;
	end if;
 
	/* CD_CID_CAUSA_COMPL */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSAIUN_CIDDOEN_FK3' 
	and	column_name	= 'CD_CID_CAUSA_COMPL';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_aih_unif drop constraint SUSAIUN_CIDDOEN_FK3'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSAIUN_CIDDOEN_FK3_I'); /* índice */
		end;
	end if;
 
	/* CD_CID_CAUSA_MORTE */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSAIUN_CIDDOEN_FK4' 
	and	column_name	= 'CD_CID_CAUSA_MORTE';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_aih_unif drop constraint SUSAIUN_CIDDOEN_FK4'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSAIUN_CIDDOEN_FK4_I'); /* índice */
		end;
	end if;
end if;
 
/* Felipe 22/11/2007 - Ajustar as tabelas SUS_GRUPO, SUS_SUBGRUPO, SUS_FORMA_ORGANIZACAO, SUS_PROCEDIMENTO e SUS_TIPO_PRESTADOR */
 
if (dt_versao_atual_cli_w < to_date('10/01/2008','dd/mm/yyyy')) then 
	/* dropar a UK SUSSUBG_UK da SUS_SUBGRUPO */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where  constraint_name = 'SUSSUBG_UK' 
	and   ((column_name  = 'CD_SUBGRUPO') 
	or (column_name  = 'CD_GRUPO'));
 
	if (qt_registro_w > 1) then /* Tem que ser maior do que 1 pois antigamente existiam 2 campos na UK e agora é somente 1 */
 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_subgrupo drop constraint SUSSUBG_UK'); /* UK */
		end;
	end if;
 
	/* dropar a UK SUSFORG_UK da SUS_FORMA_ORGANIZACAO */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where  constraint_name = 'SUSFORG_UK' 
	and   ((column_name  = 'CD_FORMA_ORGANIZACAO') 
	or (column_name  = 'CD_SUBGRUPO') 
	or (column_name  = 'CD_GRUPO'));
 
	if (qt_registro_w > 1) then /* Tem que ser maior do que 1 pois antigamente existiam 3 campos na UK e agora é somente 1 */
 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_forma_organizacao drop constraint SUSFORG_UK'); /* UK */
		end;
	end if;
 
	/* dropar a integridade da SUS_PROCEDIMENTO com a SUS_GRUPO */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSPROC_SUSGRUP_FK' 
	and	column_name	= 'NR_SEQ_GRUPO';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_procedimento drop constraint SUSPROC_SUSGRUP_FK'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSPROC_SUSGRUP_FK_I'); /* índice */
		end;
	end if;
 
	/* dropar a integridade da SUS_PROCEDIMENTO com a SUS_SUBGRUPO */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSPROC_SUSSUBG_FK' 
	and	column_name	= 'NR_SEQ_GRUPO';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_procedimento drop constraint SUSPROC_SUSSUBG_FK'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSPROC_SUSSUBG_FK'); /* índice */
		end;
	end if;
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_tab_columns 
	where	table_name	= 'SUS_SUBGRUPO' 
	and	COLUMN_NAME	= 'CD_GRUPO';
	if (qt_registro_w > 0) then 
		CALL Exec_sql_Dinamico('Felipe', 'alter table SUS_SUBGRUPO drop column CD_GRUPO ');	
	end if;
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_tab_columns 
	where	table_name	= 'SUS_FORMA_ORGANIZACAO' 
	and	COLUMN_NAME	= 'CD_GRUPO';
	if (qt_registro_w > 0) then 
		CALL Exec_sql_Dinamico('Felipe', 'alter table SUS_FORMA_ORGANIZACAO drop column CD_GRUPO ');	
	end if;
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_tab_columns 
	where	table_name	= 'SUS_FORMA_ORGANIZACAO' 
	and	COLUMN_NAME	= 'CD_SUBGRUPO';
	if (qt_registro_w > 0) then 
		CALL Exec_sql_Dinamico('Felipe', 'alter table SUS_FORMA_ORGANIZACAO drop column CD_SUBGRUPO ');	
	end if;
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_tab_columns 
	where	table_name	= 'SUS_TIPO_PRESTADOR' 
	and	COLUMN_NAME	= 'NR_SEQUENCIA';
	if (qt_registro_w > 0) then 
		CALL Exec_sql_Dinamico('Felipe', 'alter table SUS_TIPO_PRESTADOR drop column NR_SEQUENCIA ');	
	end if;
end if;
 
 
/* Felipe 28/11/2007 - Dropar as integridades da SUS_ACIDENTE_TRABALHO com a ATIVIDADE_CNAER */
 
if (dt_versao_atual_cli_w < to_date('10/01/2008','dd/mm/yyyy')) then 
	/* CD_ATIVIDADE_CNAER */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSATRA_ATCNAER_FK';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_acidente_trabalho drop constraint SUSATRA_ATCNAER_FK'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSATRA_ATCNAER_FK_I'); /* índice */
		end;
	end if;
end if;
 
/* Felipe 01/12/2007 - Excluir o campo IE_CARATER_INTER_SUS da W_SUSAIH_INTERF_CONTA */
 
if (dt_versao_atual_cli_w < to_date('10/01/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into STRICT	qt_registro_w 
	from 	user_tab_columns 
	where 	table_name 	= 'W_SUSAIH_INTERF_CONTA' 
	and 	column_name	= 'IE_CARATER_INTER_SUS' 
	and	data_type 	= 'NUMBER';
	if (qt_registro_w > 0) then 
		CALL Exec_sql_Dinamico('Felipe', 'alter table W_SUSAIH_INTERF_CONTA drop column IE_CARATER_INTER_SUS ');
	end if;
end if;
 
/* Felipe 01/12/2007 - dropar as function sus_obter_cod_carater_int e sus_obter_seq_carater_int */
 
if (dt_versao_atual_cli_w < to_date('10/01/2008','dd/mm/yyyy')) then 
	CALL Exec_sql_Dinamico('Felipe', 'drop function sus_obter_cod_carater_int '
);
	CALL Exec_sql_Dinamico('Felipe', 'drop function sus_obter_seq_carater_int '
);
end if;
 
/* Felipe 12/12/2007 - Dropar as integridades da SUS_LAQUEADURA_VASECTOMIA com a CID_DOENCA */
 
if (dt_versao_atual_cli_w < to_date('04/01/2008','dd/mm/yyyy')) then 
	/* CD_CID_INDICACAO */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSLAVA_CIDDOEN_FK' 
	and	column_name	= 'CD_CID_INDICACAO';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_laqueadura_vasectomia drop constraint SUSLAVA_CIDDOEN_FK'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSLAVA_CIDDOEN_FK_I'); /* índice */
		end;
	end if;
 
	/* CD_CID_ASSOCIADO */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSLAVA_CIDDOEN_FK2' 
	and	column_name	= 'CD_CID_ASSOCIADO';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_laqueadura_vasectomia drop constraint SUSLAVA_CIDDOEN_FK2'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSLAVA_CIDDOEN_FK2_I'); /* índice */
		end;
	end if;
end if;
 
/* Felipe 04/01/2008 - Dropar as integridades da SUS_AIH_UNIF com a SUS_CID */
 
if (dt_versao_atual_cli_w < to_date('10/05/2008','dd/mm/yyyy')) then 
	/* CD_CID_PRINCIPAL */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSAIUN_SUSCIDD_FK' 
	and	column_name	= 'CD_CID_PRINCIPAL';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_aih_unif drop constraint SUSAIUN_SUSCIDD_FK'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSAIUN_SUSCIDD_FK_I'); /* índice */
		end;
	end if;
 
	/* CD_CID_SECUNDARIO */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSAIUN_SUSCIDD_FK2' 
	and	column_name	= 'CD_CID_SECUNDARIO';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_aih_unif drop constraint SUSAIUN_SUSCIDD_FK2'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSAIUN_SUSCIDD_FK2_I'); /* índice */
		end;
	end if;
 
	/* CD_CID_CAUSA_COMPL */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSAIUN_SUSCIDD_FK3' 
	and	column_name	= 'CD_CID_CAUSA_COMPL';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_aih_unif drop constraint SUSAIUN_SUSCIDD_FK3'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSAIUN_SUSCIDD_FK3_I'); /* índice */
		end;
	end if;
 
	/* CD_CID_CAUSA_MORTE */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSAIUN_SUSCIDD_FK4' 
	and	column_name	= 'CD_CID_CAUSA_MORTE';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_aih_unif drop constraint SUSAIUN_SUSCIDD_FK4'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSAIUN_SUSCIDD_FK4_I'); /* índice */
		end;
	end if;
end if;
 
/* Felipe 04/01/2008 - Dropar as integridades da SUS_LAQUEADURA_VASECTOMIA com a SUS_CID */
 
if (dt_versao_atual_cli_w < to_date('10/05/2008','dd/mm/yyyy')) then 
	/* CD_CID_INDICACAO */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSLAVA_SUSCIDD_FK' 
	and	column_name	= 'CD_CID_INDICACAO';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_laqueadura_vasectomia drop constraint SUSLAVA_SUSCIDD_FK'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSLAVA_SUSCIDD_FK_I'); /* índice */
		end;
	end if;
 
	/* CD_CID_ASSOCIADO */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSLAVA_SUSCIDD_FK2' 
	and	column_name	= 'CD_CID_ASSOCIADO';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_laqueadura_vasectomia drop constraint SUSLAVA_SUSCIDD_FK2'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSLAVA_SUSCIDD_FK2_I'); /* índice */
		end;
	end if;
end if;
 
/* Felipe 04/01/2008 - Dropar as integridades da SUS_APAC_UNIF com a SUS_CID */
 
if (dt_versao_atual_cli_w < to_date('10/05/2008','dd/mm/yyyy')) then 
	/* CD_CID_PRINCIPAL */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSAPAU_SUSCIDD_FK' 
	and	column_name	= 'CD_CID_PRINCIPAL';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_apac_unif drop constraint SUSAPAU_SUSCIDD_FK'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSAPAU_SUSCIDD_FK_I'); /* índice */
		end;
	end if;
 
	/* CD_CID_SECUNDARIO */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSAPAU_SUSATRA_FK2' 
	and	column_name	= 'CD_CID_SECUNDARIO';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_apac_unif drop constraint SUSAPAU_SUSATRA_FK2'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSAPAU_SUSATRA_FK2_I'); /* índice */
		end;
	end if;
 
	/* CD_CID_CAUSA_ASSOC */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSAPAU_SUSCIDD_FK3' 
	and	column_name	= 'CD_CID_CAUSA_ASSOC';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_apac_unif drop constraint SUSAPAU_SUSCIDD_FK3'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSAPAU_SUSCIDD_FK3_I'); /* índice */
		end;
	end if;
end if;
 
/* Felipe 04/01/2008 - Dropar a integridade da PROCEDIMENTO_PACIENTE com a SUS_CID */
 
if (dt_versao_atual_cli_w < to_date('10/05/2008','dd/mm/yyyy')) then 
	/* CD_DOENCA_CID */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'PROPACI_SUSCIDD_FK' 
	and	column_name	= 'CD_DOENCA_CID';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table procedimento_paciente drop constraint PROPACI_SUSCIDD_FK'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index PROPACI_SUSCIDD_FK_I'); /* índice */
		end;
	end if;
end if;
 
/* Felipe 04/01/2008 - Dropar a integridade da SUS_PROCEDIMENTO_CID com a SUS_CID */
 
if (dt_versao_atual_cli_w < to_date('10/05/2008','dd/mm/yyyy')) then 
	/* CD_DOENCA_CID */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSPCID_SUSCIDD_FK' 
	and	column_name	= 'CD_DOENCA_CID';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_procedimento_cid drop constraint SUSPCID_SUSCIDD_FK'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSPCID_SUSCIDD_FK_I'); /* índice */
		end;
	end if;
end if;
 
/* Felipe 07/01/2008 - Alteração Layout SUS AIH 2008 ajustar o campo TP_LOGRADOURO */
 
if (dt_versao_atual_cli_w < to_date('10/05/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	interface 
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then 
		update 	interface_atributo 
		set	ds_regra_validacao	= 'ZerosEsq' 
		where 	cd_interface		= 1321 
		and 	upper(nm_atributo)	= 'TP_LOGRADOURO' 
		and	nr_seq_atributo		= 49;
		commit;
	end if;
end if;
 
/* André 09/01/2008 - Alterado nome das interfaces AIH e BPA */
 
if (dt_versao_atual_cli_w < to_date('10/05/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	interface 
	where	cd_interface	= 1321;	
	 
	if (qt_registro_w > 0) then 
		update	interface 
		set	ds_interface	= 'SUS-AIH 2008' 
		where	cd_interface	= 1321;
	end if;
	 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	interface 
	where	cd_interface	= 1336;	
	 
	if (qt_registro_w > 0) then 
		update	interface 
		set	ds_interface	= 'SUS-BPA 2008' 
		where	cd_interface	= 1336;	
	end if;
end if;
 
/* Felipe 10/01/2008 baca para tratar os carater de internacao */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	CALL Baca_Atend_Pac_Carat_Int();
end if;
 
/* Andre 12/01/2008 - Dropar a integridade da SUS_PROCEDIMENTO_OPM com a SUS_OPM */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	/* CD_OPM*/
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSPOPM_SUSOPMU_FK' 
	and	column_name	= 'CD_OPM';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Andre', 'alter table sus_procedimento_opm drop constraint SUSPOPM_SUSOPMU_FK'); /* integridade */
		CALL exec_sql_dinamico('Andre', 'drop index SUSPOPM_SUSOPMU_FK_I'); /* índice */
		end;
	end if;
end if;
 
/* Felipe 12/01/2008 atualizar o DT_COMPETENCIA_SUS da PARAMETROS_FATURAMENTO caso ainda não exista valor */
 
if (dt_versao_atual_cli_w < to_date('10/05/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_tab_columns 
	where	table_name	= 'PARAMETRO_FATURAMENTO' 
	and	column_name	= 'DT_COMPETENCIA_SUS';
	 
	if (qt_registro_w	> 0) then 
		select	coalesce(max(dt_competencia),clock_timestamp()) 
		into STRICT	dt_competencia_sus_w 
		from	sus_preco;
 
		update	parametro_faturamento 
		set	dt_competencia_sus	= dt_competencia_sus_w 
		where	coalesce(dt_competencia_sus::text, '') = '';
		 
		commit;
	end if;
end if;
 
/* Felipe 16/01/2008 - Alteração Layout SUS AIH 2008, colocar ValorPadrao no campo IE_DATASUS_AIH91 */
 
if (dt_versao_atual_cli_w < to_date('10/05/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	interface 
	where	cd_interface = 1321;
	if (qt_registro_w > 0) then 
		update 	interface_atributo 
		set	ds_regra_validacao	= 'ValorPadrão' 
		where 	cd_interface		= 1321 
		and 	upper(nm_atributo)	= 'IE_DATASUS_AIH91' 
		and	nr_seq_atributo		= 83 
		and	coalesce(ds_regra_validacao::text, '') = '';
		commit;
	end if;
end if;
 
/* Felipe 16/01/2008 alterar para VARCHAR2 o campo CD_CBO (PK) da SUS_CBO */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	/* obter tipo atributo */
 
	select	upper(coalesce(max(data_type),'VARCHAR2')) 
	into STRICT	data_type_w 
	from	user_tab_columns 
	where	table_name 	= 'SUS_CBO' 
	and	column_name	= 'CD_CBO';
 
	if (data_type_w <> 'VARCHAR2') then 
		CALL exec_sql_dinamico('Tasy',' alter table sus_cbo add cd_cbo_var Varchar2(6)');
		CALL exec_sql_dinamico('Tasy',' update sus_cbo set cd_cbo_var = cd_cbo ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_cbo_pessoa_fisica drop constraint SUCBOPF_SUSCBOU_FK'); /* SUS_CBO_PESSOA_FISICA */
		CALL exec_sql_dinamico('Tasy',' alter table sus_procedimento_cbo drop constraint SUSPCBO_SUSCBOU_FK'); /* SUS_PROCEDIMENTO_CBO */
		CALL exec_sql_dinamico('Tasy',' alter table sus_cbo drop constraint SUSCBOU_PK');
		CALL exec_sql_dinamico('Tasy',' alter table sus_cbo drop column cd_cbo ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_cbo rename column cd_cbo_var to cd_cbo ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_cbo add(CONSTRAINT SUSCBOU_PK Primary Key (CD_CBO) USING INDEX  Tablespace TASY_INDEX)');
		CALL exec_sql_dinamico('Tasy',' alter table sus_cbo_pessoa_fisica add(CONSTRAINT SUCBOPF_SUSCBOU_FK FOREIGN KEY (CD_CBO) REFERENCES SUS_CBO (CD_CBO))');
		CALL exec_sql_dinamico('Tasy',' alter table sus_procedimento_cbo add(CONSTRAINT SUSPCBO_SUSCBOU_FK FOREIGN KEY (CD_CBO) REFERENCES SUS_CBO (CD_CBO))');
	end if;
end if;
 
/* Felipe 16/01/2008 alterar para VARCHAR2 o campo CD_CBO da SUS_CBO_PESSOA_FISICA */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	/* obter tipo atributo */
 
	select	upper(coalesce(max(data_type),'VARCHAR2')) 
	into STRICT	data_type_w 
	from	user_tab_columns 
	where	table_name 	= 'SUS_CBO_PESSOA_FISICA' 
	and	column_name	= 'CD_CBO';
 
	if (data_type_w <> 'VARCHAR2') then 
		CALL exec_sql_dinamico('Tasy',' alter table sus_cbo_pessoa_fisica add cd_cbo_var Varchar2(6)');
		CALL exec_sql_dinamico('Tasy',' update sus_cbo_pessoa_fisica set cd_cbo_var = cd_cbo ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_cbo_pessoa_fisica drop column cd_cbo ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_cbo_pessoa_fisica rename column cd_cbo_var to cd_cbo ');
	end if;
end if;
 
/* Felipe 16/01/2008 alterar para VARCHAR2 o campo CD_CBO da SUS_PROCEDIMENTO_CBO */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	/* obter tipo atributo */
 
	select	upper(coalesce(max(data_type),'VARCHAR2')) 
	into STRICT	data_type_w 
	from	user_tab_columns 
	where	table_name 	= 'SUS_PROCEDIMENTO_CBO' 
	and	column_name	= 'CD_CBO';
 
	if (data_type_w <> 'VARCHAR2') then 
		CALL exec_sql_dinamico('Tasy',' alter table sus_procedimento_cbo add cd_cbo_var Varchar2(6)');
		CALL exec_sql_dinamico('Tasy',' update sus_procedimento_cbo set cd_cbo_var = cd_cbo ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_procedimento_cbo drop column cd_cbo ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_procedimento_cbo rename column cd_cbo_var to cd_cbo ');
	end if;
end if;
 
/* Felipe 16/01/2008 alterar para VARCHAR2 o campo NR_REG_ANVISA da SUS_AIH_OPM */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	/* obter tipo atributo */
 
	select	upper(coalesce(max(data_type),'VARCHAR2')) 
	into STRICT	data_type_w 
	from	user_tab_columns 
	where	table_name 	= 'SUS_AIH_OPM' 
	and	column_name	= 'NR_REG_ANVISA';
 
	if (data_type_w <> 'VARCHAR2') then 
		CALL exec_sql_dinamico('Tasy',' alter table sus_aih_opm add nr_reg_anvisa_var Varchar2(20)');
		CALL exec_sql_dinamico('Tasy',' update sus_aih_opm set nr_reg_anvisa_var = nr_reg_anvisa ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_aih_opm drop column nr_reg_anvisa ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_aih_opm rename column nr_reg_anvisa_var to nr_reg_anvisa ');
	end if;
end if;
 
/* Felipe 16/01/2008 alterar para VARCHAR2 o campo NR_SERIE da SUS_AIH_OPM */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	/* obter tipo atributo */
 
	select	upper(coalesce(max(data_type),'VARCHAR2')) 
	into STRICT	data_type_w 
	from	user_tab_columns 
	where	table_name 	= 'SUS_AIH_OPM' 
	and	column_name	= 'NR_SERIE';
 
	if (data_type_w <> 'VARCHAR2') then 
		CALL exec_sql_dinamico('Tasy',' alter table sus_aih_opm add nr_serie_var Varchar2(20)');
		CALL exec_sql_dinamico('Tasy',' update sus_aih_opm set nr_serie_var = nr_serie ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_aih_opm drop column nr_serie ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_aih_opm rename column nr_serie_var to nr_serie ');
	end if;
end if;
 
/* Felipe 16/01/2008 alterar para VARCHAR2 o campo NR_LOTE da SUS_AIH_OPM */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	/* obter tipo atributo */
 
	select	upper(coalesce(max(data_type),'VARCHAR2')) 
	into STRICT	data_type_w 
	from	user_tab_columns 
	where	table_name 	= 'SUS_AIH_OPM' 
	and	column_name	= 'NR_LOTE';
 
	if (data_type_w <> 'VARCHAR2') then 
		CALL exec_sql_dinamico('Tasy',' alter table sus_aih_opm add nr_lote_var Varchar2(20)');
		CALL exec_sql_dinamico('Tasy',' update sus_aih_opm set nr_lote_var = nr_lote ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_aih_opm drop column nr_lote ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_aih_opm rename column nr_lote_var to nr_lote ');
	end if;
end if;
 
/* Felipe 06/02/2008 acrescentar o item 5 - Quantidade máxima no domínio 1940 - SUS - Solicitação liberação de crítica */
 
/*if	(dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into	qt_registro_w 
	from	valor_dominio 
	where	cd_dominio	= 1940; 
	if	(qt_registro_w	<> 5) then 
		insert into valor_dominio values( 
			1940, '5', 'Quantidade máxima', sysdate, 'Felipe', 'A',null); 
	end if; 
end if;*/
 
 
/* Felipe 06/02/2008 acrescentar o item 6 - CNES Terc. no domínio 2044 - SUS - Indicador documento do executor */
 
/*if	(dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into	qt_registro_w 
	from	valor_dominio 
	where	cd_dominio	= 2044; 
	if	(qt_registro_w	<> 4) then 
		insert into valor_dominio values( 
			2044, '6', 'CNES Terc.', sysdate, 'Felipe', 'A',null); 
	end if; 
end if;*/
 
 
/* Felipe 08/02/2008 - Dropar a integridade da SUS_PROCEDIMENTO_CID_SEC com a SUS_CID */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	/* CD_DOENCA_CID_SEC */
 
	select	count(*) 
	into STRICT	qt_registro_w 
	from	user_cons_columns 
	where	constraint_name = 'SUSPCIS_SUSCIDD_FK' 
	and	column_name	= 'CD_DOENCA_CID_SEC';
 
	if (qt_registro_w > 0) then 
		begin 
		CALL exec_sql_dinamico('Felipe', 'alter table sus_procedimento_cid_sec drop constraint SUSPCIS_SUSCIDD_FK'); /* integridade */
		CALL exec_sql_dinamico('Felipe', 'drop index SUSPCIS_SUSCIDD_FK_I'); /* índice */
		end;
	end if;
end if;
 
/* Felipe 15/02/2008 - Ajustar select para tabela SUS_MEDICO_CREDENCIAMENTO */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into STRICT	qt_registro_w 
	from 	tabela_atributo 
	where 	nm_tabela 	= 'SUS_AIH_UNIF' 
	and 	nm_atributo	= 'CD_MEDICO_AUTORIZADOR' 
	and 	ds_valores like '%sus_medico_credenciamento%';
	 
	if (qt_registro_w	= 0) then 
		update	tabela_atributo 
		set	ds_valores = 'select distinct(cd_medico) cd, substr(obter_nome_pf(cd_medico),1,60) ds ' || 
					'from sus_medico_credenciamento where ie_auditor = ' || chr(39) || 'S' || chr(39) || ' order by 2' 
		where	nm_tabela	= 'SUS_AIH_UNIF' 
		and	nm_atributo	= 'CD_MEDICO_AUTORIZADOR';
	end if;
end if;
 
/* Felipe 15/02/2008 - Ajustar select para tabela SUS_MEDICO_CREDENCIAMENTO */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into STRICT	qt_registro_w 
	from 	tabela_atributo 
	where 	nm_tabela 	= 'SUS_PARAMETROS_AIH' 
	and 	nm_atributo	= 'CD_MEDICO_AUTORIZADOR' 
	and 	ds_valores like '%sus_medico_credenciamento%';
	 
	if (qt_registro_w	= 0) then 
		update	tabela_atributo 
		set	ds_valores = 'select distinct(cd_medico) cd, substr(obter_nome_pf(cd_medico),1,60) ds ' || 
					'from sus_medico_credenciamento where ie_auditor = ' || chr(39) || 'S' || chr(39) || ' order by 2' 
		where	nm_tabela	= 'SUS_PARAMETROS_AIH' 
		and	nm_atributo	= 'CD_MEDICO_AUTORIZADOR';
	end if;
end if;
 
/* Felipe 15/02/2008 - Ajustar select para tabela SUS_MEDICO_CREDENCIAMENTO */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into STRICT	qt_registro_w 
	from 	tabela_atributo 
	where 	nm_tabela 	= 'SUS_LAUDO_PACIENTE' 
	and 	nm_atributo	= 'CD_MEDICO_RESPONSAVEL' 
	and 	ds_valores like '%sus_medico_credenciamento%';
	 
	if (qt_registro_w	= 0) then 
		update	tabela_atributo 
		set	ds_valores = 'select distinct(cd_medico) cd, substr(obter_nome_pf(cd_medico),1,60) ds ' || 
					'from sus_medico_credenciamento where ie_auditor = ' || chr(39) || 'S' || chr(39) || ' order by 2' 
		where	nm_tabela	= 'SUS_LAUDO_PACIENTE' 
		and	nm_atributo	= 'CD_MEDICO_RESPONSAVEL';
	end if;
end if;
 
/* Felipe 15/02/2008 - Ajustar select para tabela SUS_MEDICO_CREDENCIAMENTO */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	select	count(*) 
	into STRICT	qt_registro_w 
	from 	tabela_atributo 
	where 	nm_tabela 	= 'SUS_MUNICIPIO' 
	and 	nm_atributo	= 'CD_MEDICO_AUTORIZADOR' 
	and 	ds_valores like '%sus_medico_credenciamento%';
	 
	if (qt_registro_w	= 0) then 
		update	tabela_atributo 
		set	ds_valores = 'select distinct(cd_medico) cd, substr(obter_nome_pf(cd_medico),1,60) ds ' || 
					'from sus_medico_credenciamento where ie_auditor = ' || chr(39) || 'S' || chr(39) || ' order by 2', 
			ie_componente	= 'lcb' 
		where	nm_tabela	= 'SUS_MUNICIPIO' 
		and	nm_atributo	= 'CD_MEDICO_AUTORIZADOR';
	end if;
end if;
 
/* André 19/02/2008 - Ajustar o tabela SUS_REGISTRO_CIVIL campo NR_ATENDIMENTO*/
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	open C01;
	loop 
	fetch C01 into	 
		nr_aih_w, 
		nr_sequencia_w;
	EXIT WHEN NOT FOUND; /* apply on C01 */
		begin 
		select	coalesce(max(nr_atendimento),0) 
		into STRICT	nr_atendimento_w 
		from	sus_aih_unif 
		where	nr_aih	= nr_aih_w;
		 
		update	sus_registro_civil 
		set	nr_atendimento	= nr_atendimento_w 
		where	nr_sequencia	= nr_sequencia_w 
		and	coalesce(nr_atendimento::text, '') = '';
		end;
	end loop;
	close C01;
end if;
 
/* Felipe 28/02/2008 alterar para VARCHAR2 o campo NR_BPA da SUS_BPA_UNIF */
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	/* obter tipo atributo */
 
	select	upper(coalesce(max(data_type),'VARCHAR2')) 
	into STRICT	data_type_w 
	from	user_tab_columns 
	where	table_name 	= 'SUS_BPA_UNIF' 
	and	column_name	= 'NR_BPA';
 
	if (data_type_w <> 'VARCHAR2') then 
		CALL exec_sql_dinamico('Tasy',' alter table sus_bpa_unif add nr_bpa_var Varchar2(13)');
		CALL exec_sql_dinamico('Tasy',' update sus_bpa_unif set nr_bpa_var = nr_bpa ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_bpa_unif drop column nr_bpa ');
		CALL exec_sql_dinamico('Tasy',' alter table sus_bpa_unif rename column nr_bpa_var to nr_bpa ');
	end if;
end if;
 
/* Felipe 03/03/2008 ajustar as consistencias*/
 
if (dt_versao_atual_cli_w < to_date('10/06/2008','dd/mm/yyyy')) then 
	/* Sim para todos */
 
	update	sus_inconsistencia 
	set	ie_aih			= 'S', 
		ie_apac			= 'S', 
		ie_bpa_consolidado	= 'S', 
		ie_bpa_individualizado	= 'S' 
	where	cd_inconsistencia in (8,9,10,11,12,18,24,25,26,28,43) 
	and	coalesce(ie_aih::text, '') = '' 
	and	coalesce(ie_apac::text, '') = '' 
	and	coalesce(ie_bpa_consolidado::text, '') = '' 
	and	coalesce(ie_bpa_individualizado::text, '') = '';
	 
	/* AIH SIM e o restante NÃO */
 
	update	sus_inconsistencia 
	set	ie_aih			= 'S', 
		ie_apac			= 'N', 
		ie_bpa_consolidado	= 'N', 
		ie_bpa_individualizado	= 'N' 
	where	cd_inconsistencia in (3,4,5,6,7,13,15,16,17,23,27,29,30,31,32,33,35,36,37,40,45,49,50,51,52,53,63,64,65,67,68) 
	and	coalesce(ie_aih::text, '') = '' 
	and	coalesce(ie_apac::text, '') = '' 
	and	coalesce(ie_bpa_consolidado::text, '') = '' 
	and	coalesce(ie_bpa_individualizado::text, '') = '';
	 
	/* APAC SIM e o restante NÃO */
 
	update	sus_inconsistencia 
	set	ie_aih			= 'N', 
		ie_apac			= 'S', 
		ie_bpa_consolidado	= 'N', 
		ie_bpa_individualizado	= 'N' 
	where	cd_inconsistencia in (19,20,21,38,41,44,54,55,56,57,58,59,60,61,62,69,70) 
	and	coalesce(ie_aih::text, '') = '' 
	and	coalesce(ie_apac::text, '') = '' 
	and	coalesce(ie_bpa_consolidado::text, '') = '' 
	and	coalesce(ie_bpa_individualizado::text, '') = '';
	 
	/* BPA - I SIM e o restante NÃO */
 
	update	sus_inconsistencia 
	set	ie_aih			= 'N', 
		ie_apac			= 'N', 
		ie_bpa_consolidado	= 'N', 
		ie_bpa_individualizado	= 'S' 
	where	cd_inconsistencia in (22,66,71) 
	and	coalesce(ie_aih::text, '') = '' 
	and	coalesce(ie_apac::text, '') = '' 
	and	coalesce(ie_bpa_consolidado::text, '') = '' 
	and	coalesce(ie_bpa_individualizado::text, '') = '';
	 
	/* AIH e APAC SIM e o restante NÃO */
 
	update	sus_inconsistencia 
	set	ie_aih			= 'S', 
		ie_apac			= 'S', 
		ie_bpa_consolidado	= 'N', 
		ie_bpa_individualizado	= 'N' 
	where	cd_inconsistencia in (14,39,46,47,48) 
	and	coalesce(ie_aih::text, '') = '' 
	and	coalesce(ie_apac::text, '') = '' 
	and	coalesce(ie_bpa_consolidado::text, '') = '' 
	and	coalesce(ie_bpa_individualizado::text, '') = '';
	 
	/* APAC NÃO e o restante SIM */
 
	update	sus_inconsistencia 
	set	ie_aih			= 'S', 
		ie_apac			= 'N', 
		ie_bpa_consolidado	= 'S', 
		ie_bpa_individualizado	= 'S' 
	where	cd_inconsistencia in (1,2,34) 
	and	coalesce(ie_aih::text, '') = '' 
	and	coalesce(ie_apac::text, '') = '' 
	and	coalesce(ie_bpa_consolidado::text, '') = '' 
	and	coalesce(ie_bpa_individualizado::text, '') = '';
	 
	/* BPA-C NÃO e o restante SIM */
 
	update	sus_inconsistencia 
	set	ie_aih			= 'S', 
		ie_apac			= 'S', 
		ie_bpa_consolidado	= 'N', 
		ie_bpa_individualizado	= 'S' 
	where	cd_inconsistencia in (42) 
	and	coalesce(ie_aih::text, '') = '' 
	and	coalesce(ie_apac::text, '') = '' 
	and	coalesce(ie_bpa_consolidado::text, '') = '' 
	and	coalesce(ie_bpa_individualizado::text, '') = '';
end if;
	 
	 
if (dt_versao_atual_cli_w < to_date('13/03/2009','dd/mm/yyyy')) then 
	update	sus_aih_unif 
	set		dt_atualizacao	= dt_atualizacao;
end if;
 
if (dt_versao_atual_cli_w < to_date('05/05/2009','dd/mm/yyyy')) then 
	CALL exec_sql_dinamico('Martini',' DROP TABLE iep_professor_disciplina');
	CALL exec_sql_dinamico('Martini',' ALTER TABLE iep_professor drop constraint IEPPROF_PK');
	CALL exec_sql_dinamico('Martini',' DROP INDEX IEPPROF_PESFISI_FK_I');
end if;
 
 
commit;
 
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE baca_ajustar_base_susunif (nm_usuario_p text) FROM PUBLIC;

