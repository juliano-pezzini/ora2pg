-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gpt_consiste_reg_incons_farm (nr_seq_cpoe_p bigint, nm_tabela_p text, nm_usuario_p text, cd_estabelecimento_p bigint, ds_erro_p INOUT text) AS $body$
DECLARE


ds_erro_w		varchar(255):=null;

c01 CURSOR(nr_seq_cpoe_pc	bigint,
			nm_tabela_pc	text) FOR
	SELECT	a.nr_prescricao,
			a.nr_sequencia
	from	prescr_material a
	where	a.nr_seq_mat_cpoe = nr_seq_cpoe_p
	and		nm_tabela_p	 = 'CPOE_MATERIAL';

BEGIN

for r_c01 in c01(nr_seq_cpoe_p,nm_tabela_p) loop
		ds_erro_w := consiste_registro_incons_farm(r_c01.nr_prescricao, r_c01.nr_sequencia, nm_usuario_p, cd_estabelecimento_p, ds_erro_w);

		if (ds_erro_w IS NOT NULL AND ds_erro_w::text <> '') then
			exit;
		end if;
end loop;

ds_erro_p := ds_erro_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gpt_consiste_reg_incons_farm (nr_seq_cpoe_p bigint, nm_tabela_p text, nm_usuario_p text, cd_estabelecimento_p bigint, ds_erro_p INOUT text) FROM PUBLIC;

