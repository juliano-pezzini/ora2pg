-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pls_copiar_inf_financeira_pag ( nr_seq_contrato_p pls_contrato_pagador.nr_seq_contrato%type, nr_seq_pagador_ref_p pls_contrato_pagador.nr_sequencia%type, nr_seq_pagador_novo_p pls_contrato_pagador.nr_sequencia%type, cd_estabelecimento_P bigint, nm_usuario_p text) AS $body$
DECLARE


contrato_pagador_fin_w			pls_contrato_pagador_fin%rowtype;
nr_seq_pagador_fin_w			pls_contrato_pagador_fin.nr_sequencia%type;

BEGIN

if (nr_seq_pagador_ref_p IS NOT NULL AND nr_seq_pagador_ref_p::text <> '') then
	select 	max(nr_sequencia)
	into STRICT 	nr_seq_pagador_fin_w
	from	pls_contrato_pagador_fin
	where	nr_seq_pagador = nr_seq_pagador_ref_p
	and 	dt_inicio_vigencia = (SELECT	max(dt_inicio_vigencia)
					from	pls_contrato_pagador_fin
					where	nr_seq_pagador = nr_seq_pagador_ref_p);
end if;

if (nr_seq_pagador_fin_w IS NOT NULL AND nr_seq_pagador_fin_w::text <> '') then
	select	*
	into STRICT	contrato_pagador_fin_w
	from	pls_contrato_pagador_fin
	where	nr_sequencia = nr_seq_pagador_fin_w;
end if;

if (nr_seq_pagador_fin_w IS NOT NULL AND nr_seq_pagador_fin_w::text <> '') then
	insert	into	pls_contrato_pagador_fin(	nr_sequencia,dt_atualizacao,nm_usuario,dt_atualizacao_nrec,nm_usuario_nrec,
			nr_seq_pagador,dt_inicio_vigencia,cd_banco,nr_seq_conta_banco,cd_agencia_bancaria,ie_digito_agencia,cd_conta,ie_digito_conta,
			dt_dia_vencimento,nr_seq_empresa,cd_matricula,cd_condicao_pagamento,cd_profissao,nr_seq_vinculo_est,cd_tipo_portador,cd_portador,ie_portador_exclusivo,
			nr_seq_vinculo_empresa,ie_mes_vencimento,ie_geracao_nota_titulo,ie_destacar_reajuste, nr_seq_carteira_cobr, nr_seq_dia_vencimento,ie_gerar_cobr_escrit,
			nm_usuario_fim_vigencia,cd_autenticidade,ie_boleto_email,nr_pensionista,cd_tipo_portador_deb_aut,cd_portador_deb_aut,nr_seq_conta_banco_deb_aut,
			nr_seq_forma_cobranca
		)
	values (
		nextval('pls_contrato_pagador_fin_seq'),clock_timestamp(),nm_usuario_p,clock_timestamp(),nm_usuario_p,
		nr_seq_pagador_novo_p,contrato_pagador_fin_w.dt_inicio_vigencia,contrato_pagador_fin_w.cd_banco,contrato_pagador_fin_w.nr_seq_conta_banco,
		contrato_pagador_fin_w.cd_agencia_bancaria,contrato_pagador_fin_w.ie_digito_agencia,contrato_pagador_fin_w.cd_conta,contrato_pagador_fin_w.ie_digito_conta,contrato_pagador_fin_w.dt_dia_vencimento,
		contrato_pagador_fin_w.nr_seq_empresa,contrato_pagador_fin_w.cd_matricula,contrato_pagador_fin_w.cd_condicao_pagamento,contrato_pagador_fin_w.cd_profissao,
		contrato_pagador_fin_w.nr_seq_vinculo_est,contrato_pagador_fin_w.cd_tipo_portador,contrato_pagador_fin_w.cd_portador,contrato_pagador_fin_w.ie_portador_exclusivo,contrato_pagador_fin_w.nr_seq_vinculo_empresa,
		contrato_pagador_fin_w.ie_mes_vencimento,contrato_pagador_fin_w.ie_geracao_nota_titulo,contrato_pagador_fin_w.ie_destacar_reajuste,
		contrato_pagador_fin_w.nr_seq_carteira_cobr,contrato_pagador_fin_w.nr_seq_dia_vencimento,contrato_pagador_fin_w.ie_gerar_cobr_escrit,
		contrato_pagador_fin_w.nm_usuario_fim_vigencia,contrato_pagador_fin_w.cd_autenticidade,contrato_pagador_fin_w.ie_boleto_email,
		contrato_pagador_fin_w.nr_pensionista,contrato_pagador_fin_w.cd_tipo_portador_deb_aut,contrato_pagador_fin_w.cd_portador_deb_aut,
		contrato_pagador_fin_w.nr_seq_conta_banco_deb_aut,contrato_pagador_fin_w.nr_seq_forma_cobranca
	);
end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_copiar_inf_financeira_pag ( nr_seq_contrato_p pls_contrato_pagador.nr_seq_contrato%type, nr_seq_pagador_ref_p pls_contrato_pagador.nr_sequencia%type, nr_seq_pagador_novo_p pls_contrato_pagador.nr_sequencia%type, cd_estabelecimento_P bigint, nm_usuario_p text) FROM PUBLIC;

