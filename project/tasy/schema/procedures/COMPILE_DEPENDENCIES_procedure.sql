-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE compile_dependencies ( name text, owner text, cd_estabelecimento_p bigint, nm_usuario_p text) AS $body$
DECLARE


/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Finalidade:
-------------------------------------------------------------------------------------------------------------------
Locais de chamada direta:
[  ]  Objetos do dicionário [  ] Tasy (Delphi/Java) [  ] Portal [  ]  Relatórios [ ] Outros:
 ------------------------------------------------------------------------------------------------------------------
Pontos de atenção:
-------------------------------------------------------------------------------------------------------------------
Referências:
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
c_object CURSOR FOR
	SELECT	name,
		type,
		row_number() OVER () AS rownum
	from	user_dependencies	a
	where	a.referenced_name	= upper(name)
	and	a.referenced_owner	= upper(owner)
	and	exists (SELECT	1
			from	user_objects	x
			where	a.name	= x.object_name
			and	x.object_type in ('PROCEDURE', 'VIEW', 'TRIGGER', 'PACKAGE', 'FUNCTION'))
	order by
		type,
		name;

BEGIN
for object_ref in c_object
loop
	if (object_ref.type = 'PACKAGE BODY') then
		CALL exec_sql_dinamico(nm_usuario_p, ' ALTER PACKAGE' || chr(10) || object_ref.name || chr(10) || 'COMPILE BODY;' );
	else
		CALL exec_sql_dinamico(nm_usuario_p, ' ALTER' || chr(10) || object_ref.type || chr(10) || object_ref.name || chr(10) || 'COMPILE;');
	end if;
end loop;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE compile_dependencies ( name text, owner text, cd_estabelecimento_p bigint, nm_usuario_p text) FROM PUBLIC;

