-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_informacoes_checkup ( nm_usuario_p text, ds_agendamento_p INOUT text, ds_sexo_p INOUT text, ds_total_p INOUT text) AS $body$
DECLARE


qt_checkup_w	bigint := 0;
qt_checkup_cd_w	bigint := 0;
qt_agendados_w	bigint := 0;
qt_encaixe_w	bigint := 0;
qt_masculino_w	bigint := 0;
qt_feminino_w	bigint := 0;


BEGIN


select	count(*)
into STRICT	qt_checkup_w
from 	checkup
where	coalesce(dt_cancelamento::text, '') = ''
and	(cd_pessoa_fisica IS NOT NULL AND cd_pessoa_fisica::text <> '');

select	count(*)
into STRICT	qt_checkup_cd_w
from 	checkup
where	coalesce(dt_cancelamento::text, '') = ''
and	coalesce(cd_pessoa_fisica::text, '') = '';

select	count(*)
into STRICT	qt_agendados_w
from	checkup
where	coalesce(dt_cancelamento::text, '') = ''
and	(cd_pessoa_fisica IS NOT NULL AND cd_pessoa_fisica::text <> '')
and	coalesce(ie_encaixe,'N') = 'N';

select	count(*)
into STRICT	qt_encaixe_w
from	checkup
where	coalesce(dt_cancelamento::text, '') = ''
and	(cd_pessoa_fisica IS NOT NULL AND cd_pessoa_fisica::text <> '')
and	coalesce(ie_encaixe,'N') = 'S';

select	count(*)
into STRICT	qt_masculino_w
from	checkup
where	coalesce(dt_cancelamento::text, '') = ''
and	(cd_pessoa_fisica IS NOT NULL AND cd_pessoa_fisica::text <> '')
and	obter_sexo_pf(cd_pessoa_fisica,'C') = 'M';

select	count(*)
into STRICT	qt_feminino_w
from	checkup
where	coalesce(dt_cancelamento::text, '') = ''
and	(cd_pessoa_fisica IS NOT NULL AND cd_pessoa_fisica::text <> '') and Obter_Sexo_PF(cd_pessoa_fisica,'C')  = 'F';

ds_agendamento_p	:= substr(obter_texto_dic_objeto(221194,wheb_usuario_pck.get_nr_seq_idioma,'QT_AGENDADOS='|| qt_agendados_w || ';QT_ENCAIXE='|| qt_encaixe_w),1,2000);
ds_sexo_p		:= substr(obter_texto_dic_objeto(221195,wheb_usuario_pck.get_nr_seq_idioma,'QT_MASCULINO='|| qt_masculino_w || ';QT_FEMININO='|| qt_feminino_w),1,2000);
ds_total_p		:= substr(obter_texto_dic_objeto(221196,wheb_usuario_pck.get_nr_seq_idioma,'SM_TOTAL='|| (qt_agendados_w + qt_encaixe_w)),1,2000);

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_informacoes_checkup ( nm_usuario_p text, ds_agendamento_p INOUT text, ds_sexo_p INOUT text, ds_total_p INOUT text) FROM PUBLIC;

