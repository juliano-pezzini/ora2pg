-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE proj_atualizar_desc_atividade ( nr_sequencia_p bigint) AS $body$
DECLARE



cd_classificacao_w	varchar(255);
ds_atividade_w	varchar(255);
ds_atividade_ww	varchar(255);
i			bigint;
ds_espaco_w		varchar(255);



BEGIN

ds_espaco_w		:= '';

select	coalesce(max(cd_classificacao),'X'),
	coalesce(max(ds_atividade),'X')
into STRICT	cd_classificacao_w,
	ds_atividade_w
from	proj_cron_etapa
where	nr_sequencia = nr_sequencia_p;

ds_atividade_ww := ltrim(ds_atividade_ww);
ds_atividade_w  := ltrim(ds_atividade_w);

ds_atividade_ww	:= ds_atividade_w;

if (cd_classificacao_w <> 'X') then
	FOR i IN 1..Length(cd_classificacao_w) LOOP
		ds_espaco_w	:= ds_espaco_w || '  ';
	end loop;

	ds_atividade_ww	:= substr(ds_espaco_w || ds_atividade_w,1,255);
end if;

update	proj_cron_etapa
set	ds_atividade = ds_atividade_ww
where	nr_sequencia = nr_sequencia_p;
commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE proj_atualizar_desc_atividade ( nr_sequencia_p bigint) FROM PUBLIC;

