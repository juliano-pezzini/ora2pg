-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE exec_transmit_era ( dt_from_p timestamp, dt_to_p timestamp, ie_type_process_p text) AS $body$
DECLARE

  /*
  ie_type_process_p
  1 BBDVA
  2 IHC
  3 ERA
  */
  ds_param_integ_w      varchar(255);
  nr_integration_code_w smallint;

BEGIN
  if (ie_type_process_p    = 'BBDVA') then
    nr_integration_code_w := 166;
  elsif (ie_type_process_p = 'IHC') then
    nr_integration_code_w := 167;
  elsif (ie_type_process_p = 'ERA') then
    nr_integration_code_w := 6;
  end if;
  ds_param_integ_w := '{"FROM_DATE" : ' || '"' || pkg_date_formaters.to_varchar(dt_from_p,'shortDate', wheb_usuario_pck.get_cd_estabelecimento, wheb_usuario_pck.get_nm_usuario) || '"' || ' , "TO_DATE" : ' || '"' || pkg_date_formaters.to_varchar(dt_to_p,'shortDate', wheb_usuario_pck.get_cd_estabelecimento, wheb_usuario_pck.get_nm_usuario) || '"' || '}';
  CALL execute_bifrost_integration(nr_integration_code_w,ds_param_integ_w);
  commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE exec_transmit_era ( dt_from_p timestamp, dt_to_p timestamp, ie_type_process_p text) FROM PUBLIC;

