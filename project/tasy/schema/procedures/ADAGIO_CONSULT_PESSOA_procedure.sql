-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE adagio_consult_pessoa ( cd_pessoa_fisica_p pessoa_fisica.cd_pessoa_fisica%type, cd_rfc_p pessoa_fisica.cd_rfc%type, cd_nacionalidade_p INOUT pessoa_fisica.cd_nacionalidade%type, cd_curp_p INOUT pessoa_fisica.cd_curp%type, cd_sistema_ant_p INOUT pessoa_fisica.cd_sistema_ant%type, dt_nascimento_p INOUT text, ie_funcionario_p INOUT pessoa_fisica.ie_funcionario%type, ie_sexo_p INOUT pessoa_fisica.ie_sexo%type, nm_primeiro_nome_p INOUT pessoa_fisica.nm_primeiro_nome%type, nm_sobrenome_mae_p INOUT pessoa_fisica.nm_sobrenome_mae%type, nm_sobrenome_pai_p INOUT pessoa_fisica.nm_sobrenome_pai%type, nr_prontuario_p INOUT pessoa_fisica.nr_prontuario%type, nr_ddi_celular_p INOUT pessoa_fisica.nr_ddi_celular%type, nr_telefone_celular_p INOUT pessoa_fisica.nr_telefone_celular%type, cd_estabelecimento_p INOUT pessoa_fisica.cd_estabelecimento%type, ie_martial_status_p INOUT pessoa_fisica.ie_estado_civil%type, cd_out_pessoa_fisica_p INOUT pessoa_fisica.cd_pessoa_fisica%type, cd_out_rfc_p INOUT pessoa_fisica.cd_rfc%type ) AS $body$
BEGIN

    begin
        select
          cd_pessoa_fisica,
          cd_curp,
          cd_nacionalidade,
          cd_rfc,
          cd_sistema_ant,
          TO_CHAR(dt_nascimento, 'YYYYMMDD'),
          ie_funcionario,
          ie_sexo,
          nm_primeiro_nome,
          nm_sobrenome_mae,
          nm_sobrenome_pai,
          nr_prontuario,
          nr_ddi_celular,
          nr_telefone_celular,
          cd_estabelecimento,
          ie_estado_civil
        
        into STRICT  
          cd_out_pessoa_fisica_p,
          cd_curp_p,
          cd_nacionalidade_p,
          cd_out_rfc_p,
          cd_sistema_ant_p,
          dt_nascimento_p,
          ie_funcionario_p,
          ie_sexo_p,
          nm_primeiro_nome_p,
          nm_sobrenome_mae_p,
          nm_sobrenome_pai_p,
          nr_prontuario_p,
          nr_ddi_celular_p,
          nr_telefone_celular_p,
          cd_estabelecimento_p,
          ie_martial_status_p
        from  pessoa_fisica
        where cd_rfc            = cd_rfc_p  LIMIT 1;

    exception 
        when no_data_found then 
           null;
		when too_many_rows then
            RAISE EXCEPTION '%', 'more than one record' USING ERRCODE = -01422;
        when others then
            RAISE EXCEPTION '%', 'query error' USING ERRCODE = -1001;
    end;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE adagio_consult_pessoa ( cd_pessoa_fisica_p pessoa_fisica.cd_pessoa_fisica%type, cd_rfc_p pessoa_fisica.cd_rfc%type, cd_nacionalidade_p INOUT pessoa_fisica.cd_nacionalidade%type, cd_curp_p INOUT pessoa_fisica.cd_curp%type, cd_sistema_ant_p INOUT pessoa_fisica.cd_sistema_ant%type, dt_nascimento_p INOUT text, ie_funcionario_p INOUT pessoa_fisica.ie_funcionario%type, ie_sexo_p INOUT pessoa_fisica.ie_sexo%type, nm_primeiro_nome_p INOUT pessoa_fisica.nm_primeiro_nome%type, nm_sobrenome_mae_p INOUT pessoa_fisica.nm_sobrenome_mae%type, nm_sobrenome_pai_p INOUT pessoa_fisica.nm_sobrenome_pai%type, nr_prontuario_p INOUT pessoa_fisica.nr_prontuario%type, nr_ddi_celular_p INOUT pessoa_fisica.nr_ddi_celular%type, nr_telefone_celular_p INOUT pessoa_fisica.nr_telefone_celular%type, cd_estabelecimento_p INOUT pessoa_fisica.cd_estabelecimento%type, ie_martial_status_p INOUT pessoa_fisica.ie_estado_civil%type, cd_out_pessoa_fisica_p INOUT pessoa_fisica.cd_pessoa_fisica%type, cd_out_rfc_p INOUT pessoa_fisica.cd_rfc%type ) FROM PUBLIC;

