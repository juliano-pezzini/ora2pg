-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_necesidade_vaga_eup (nr_atendimento_p bigint, cd_convenio_p INOUT bigint, cd_categoria_p INOUT bigint, cd_plano_p INOUT text, qt_vagas_p INOUT bigint, ds_pergunta_p INOUT text, nm_usuario_p text) AS $body$
BEGIN
select	MAX(obter_convenio_atendimento(nr_atendimento)), 
		MAX(obter_dados_categ_conv(nr_atendimento,'CA')), 
		MAX(obter_dados_categ_conv(nr_atendimento,'P')) 
into STRICT	cd_convenio_p, 
		cd_categoria_p, 
		cd_plano_p 
from	atendimento_paciente 
where	nr_atendimento = nr_atendimento_p;
 
select 	obter_se_possui_vaga(nr_atendimento_p) 
into STRICT	qt_vagas_p
;
 
ds_pergunta_p := wheb_mensagem_pck.get_texto(120758);
 
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_necesidade_vaga_eup (nr_atendimento_p bigint, cd_convenio_p INOUT bigint, cd_categoria_p INOUT bigint, cd_plano_p INOUT text, qt_vagas_p INOUT bigint, ds_pergunta_p INOUT text, nm_usuario_p text) FROM PUBLIC;

