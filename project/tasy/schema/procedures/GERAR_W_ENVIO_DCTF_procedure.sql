-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_w_envio_dctf ( nr_seq_lote_p bigint, nm_usuario_p text) AS $body$
DECLARE

 
cd_natureza_juridica_w			varchar(4);
nr_seq_envio_dctf_w			bigint;
cd_receita_w				varchar(12);
cd_receita_darf_w			varchar(10);
ds_bairro_w				varchar(20);
ds_complemento_w			varchar(21);
ds_crc_resp_w				varchar(15);
ds_email_w				varchar(40);
ds_email_representante_w		varchar(40);
ds_email_resp_w				varchar(40);
ds_hashcode_w				varchar(10);
ds_logradouro_w				varchar(40);
ds_municipio_w				varchar(50);
ds_numero_w				varchar(6);
ds_periodicidade_w			varchar(1);
ds_uf_caixa_postal_w			varchar(1);
ds_uf_crc_resp_w			varchar(1);
dt_apuracao_diario_w			varchar(4000);
dt_apuracao_mensal_w			varchar(4000);
dt_fim_w				timestamp;
dt_inicio_w				timestamp;
dt_ocorrencia_evento_w			varchar(8);
dt_periodo_apuracao_w			timestamp;
dt_periodo_final_w			timestamp;
dt_periodo_inicial_w			timestamp;
dt_vencimento_w				timestamp;
ie_balanco_reducao_w			numeric(22);
ie_forma_tributacao_w			numeric(22);
ie_pj_balanco_w				numeric(22);
ie_pj_dctf_semestral_w			numeric(22);
ie_pj_inativa_w				numeric(22);
ie_pj_regime_especial_w			numeric(22);
ie_pj_scp_w				numeric(22);
ie_qualificacao_pj_w			numeric(22);
ie_saldo_quotas_w			numeric(22);
ie_situacao_w				varchar(1);
ie_tipo_w				varchar(3);
ie_tipo_declaracao_w			numeric(22);
ie_tipo_registro_w			numeric(22);
nm_empresarial_w			varchar(255);
nm_representante_w			varchar(60);
nm_responsavel_w			varchar(60);
nr_ano_apuracao_w			timestamp;
nr_ano_declaracao_w			timestamp;
nr_caixa_postal_w			varchar(1);
nr_cep_w				varchar(8);
nr_cep_caixa_postal_w			varchar(1);
nr_cnpj_w				varchar(14);
nr_cnpj_darf_w				varchar(14);
nr_cnpj_incorporacao_w			varchar(14);
nr_cpf_representante_w			varchar(11);
nr_cpf_resp_w				varchar(11);
nr_ddd_fax_w				varchar(3);
nr_ddd_fax_representante_w		varchar(3);
nr_ddd_fax_resp_w			varchar(3);
nr_ddd_telefone_w			varchar(3);
nr_ddd_telefone_repr_w			varchar(3);
nr_ddd_telefone_resp_w			varchar(3);
nr_declaracao_w				numeric(22);
nr_fax_w				varchar(4000);
nr_fax_representante_w			varchar(4000);
nr_fax_resp_w				varchar(4000);
nr_grupo_tributo_w			varchar(2);
nr_mes_declaracao_w			timestamp;
nr_mes_ocorrencia_w			timestamp;
nr_ordem_estab_w			varchar(6);
nr_quota_w				numeric(22);
nr_ramal_representante_w		varchar(5);
nr_ramal_resp_w				varchar(5);
nr_recibo_w				varchar(255);
nr_referencia_w				varchar(20);
nr_seq_lote_w				bigint;
nr_telefone_w				varchar(4000);
nr_telefone_representante_w		varchar(4000);
nr_telefone_resp_w			varchar(4000);
nr_trimestre_apuracao_w			numeric(22);
nr_versao_w				numeric(22);
qt_registros_w				numeric(22);
sg_uf_w					varchar(2);
vl_debito_w				numeric(22);
vl_juros_w				numeric(22);
vl_multa_w				numeric(22);
vl_pago_debito_w			varchar(40);
vl_principal_w				varchar(40);
ds_registro_w				varchar(40);

c01 CURSOR FOR 
SELECT	1						ie_tipo_registro, 
	a.nr_sequencia					nr_seq_lote, 
	'DCTFM'						ds_registro, 
	CASE WHEN a.ie_retificadora='N' THEN  0 WHEN a.ie_retificadora='S' THEN  1 END 	ie_tipo_declaracao, 
	b.cd_cgc 					nr_cnpj, 
	130 						nr_versao, 
	SUBSTR(obter_nome_empresa(b.cd_empresa),1,255) 	nm_empresarial, 
	SUBSTR(obter_uf_localidade(b.cd_localidade),1,2) sg_uf, 
	a.ie_finalidade_dctf				ie_situacao, 
	a.dt_referencia					nr_ano_declaracao, 
	a.dt_referencia		 			nr_mes_declaracao, 
	trunc(a.dt_referencia,'mm') 			dt_periodo_inicial, 
	trunc(fim_mes(a.dt_referencia),'dd')		dt_periodo_final, 
	CASE WHEN a.ie_finalidade_dctf=00 THEN '00000000'  ELSE clock_timestamp() END  dt_ocorrencia_evento, 
	' ' ie_tipo, 
	clock_timestamp() nr_mes_ocorrencia, 
	clock_timestamp() dt_inicio, 
	clock_timestamp() dt_fim, 
	0 nr_declaracao, 
	' ' nr_recibo, 
	0 ie_forma_tributacao, 
	0 ie_qualificacao_pj, 
	0 ie_pj_balanco, 
	0 ie_pj_scp, 
	0 ie_pj_inativa, 
	0 ie_pj_regime_especial, 
	0 ie_pj_dctf_semestral, 
	' ' cd_natureza_juridica, 
	' ' ds_logradouro, 
	' ' ds_numero, 
	' ' ds_complemento, 
	' ' ds_bairro, 
	' ' ds_municipio, 
	' ' nr_cep, 
	' ' nr_ddd_telefone, 
	' ' nr_telefone, 
	' ' nr_ddd_fax, 
	' ' nr_fax, 
	' ' nr_caixa_postal, 
	' ' ds_uf_caixa_postal, 
	' ' nr_cep_caixa_postal, 
	' ' ds_email, 
	' ' nm_representante, 
	' ' nr_cpf_representante, 
	' ' nr_ddd_telefone_representante, 
	' ' nr_telefone_representante, 
	' ' nr_ramal_representante, 
	' ' nr_ddd_fax_representante, 
	' ' nr_fax_representante, 
	' ' ds_email_representante, 
	' ' nm_responsavel, 
	' ' nr_cpf_resp, 
	' ' ds_crc_resp, 
	' ' ds_uf_crc_resp, 
	' ' nr_ddd_telefone_resp, 
	' ' nr_telefone_resp, 
	' ' nr_ramal_resp, 
	' ' nr_ddd_fax_resp, 
	' ' nr_fax_resp, 
	' ' ds_email_resp, 
	' ' nr_grupo_tributo, 
	'0' cd_receita, 
	' ' ds_periodicidade, 
	clock_timestamp() nr_ano_apuracao, 
	' ' dt_apuracao_mensal, 
	' ' dt_apuracao_diario, 
	' ' nr_ordem_estab, 
	' ' nr_cnpj_incorporacao, 
	0 vl_debito, 
	0 ie_balanco_reducao, 
	0 ie_saldo_quotas, 
	clock_timestamp() dt_periodo_apuracao, 
	' ' nr_cnpj_darf, 
	'0' cd_receita_darf, 
	clock_timestamp() dt_vencimento, 
	' ' nr_referencia, 
	'0' vl_principal, 
	0 vl_multa, 
	0 vl_juros, 
	'0' vl_pago_debito, 
	0 nr_trimestre_apuracao, 
	0 nr_quota, 
	0 qt_registros, 
	' ' ds_hashcode 
from	dctf_lote a, 
	estabelecimento b 
where	a.cd_estabelecimento	= b.cd_estabelecimento 
and	a.nr_sequencia		= nr_seq_lote_p 

union all
 
SELECT	2						ie_tipo_registro, 
	a.nr_sequencia					nr_seq_lote, 
	' ' ds_registro, 
	0 ie_tipo_declaracao, 
	b.cd_cgc					nr_cnpj, 
	0 nr_versao, 
	' ' nm_empresarial, 
	' ' sg_uf, 
	a.ie_finalidade_dctf				ie_situacao, 
	clock_timestamp() nr_ano_declaracao, 
	clock_timestamp() nr_mes_declaracao, 
	TRUNC(a.dt_referencia,'mm') 			dt_periodo_inicial, 
	trunc(fim_mes(a.dt_referencia),'dd')		dt_periodo_final, 
	CASE WHEN a.ie_finalidade_dctf=00 THEN '00000000'  ELSE clock_timestamp() END  dt_ocorrencia_evento, 
	'R01'						ie_tipo, 
	trunc(a.dt_referencia,'mm')			nr_mes_ocorrencia, 
	clock_timestamp() dt_inicio, 
	clock_timestamp() dt_fim, 
	CASE WHEN a.ie_retificadora='N' THEN 0 WHEN a.ie_retificadora='S' THEN 1 END 		nr_declaracao, 
	a.nr_recibo_retificada				nr_recibo, 
	c.ie_forma_tributacao				ie_forma_tributacao, 
	c.ie_qualificacao_pj				ie_qualificacao_pj, 
	CASE WHEN c.ie_balancete='N' THEN 0 WHEN c.ie_balancete='S' THEN 1 END 		ie_pj_balanco, 
	CASE WHEN c.ie_debito_scp='N' THEN 0 WHEN c.ie_debito_scp='S' THEN 1 END 		ie_pj_scp, 
	CASE WHEN c.ie_estab_inativo='N' THEN 0 WHEN c.ie_estab_inativo='S' THEN 1 END 		ie_pj_inativa, 
	CASE WHEN c.ie_debito_regime_esp='N' THEN 0 WHEN c.ie_debito_regime_esp='S' THEN 1 END 	ie_pj_regime_especial, 
	CASE WHEN c.ie_dctf_ano_anterior='N' THEN 0 WHEN c.ie_dctf_ano_anterior='S' THEN 1 END 	ie_pj_dctf_semestral, 
	' ' cd_natureza_juridica, 
	' ' ds_logradouro, 
	' ' ds_numero, 
	' ' ds_complemento, 
	' ' ds_bairro, 
	' ' ds_municipio, 
	' ' nr_cep, 
	' ' nr_ddd_telefone, 
	' ' nr_telefone, 
	' ' nr_ddd_fax, 
	' ' nr_fax, 
	' ' nr_caixa_postal, 
	' ' ds_uf_caixa_postal, 
	' ' nr_cep_caixa_postal, 
	' ' ds_email, 
	' ' nm_representante, 
	' ' nr_cpf_representante, 
	' ' nr_ddd_telefone_representante, 
	' ' nr_telefone_representante, 
	' ' nr_ramal_representante, 
	' ' nr_ddd_fax_representante, 
	' ' nr_fax_representante, 
	' ' ds_email_representante, 
	' ' nm_responsavel, 
	' ' nr_cpf_resp, 
	' ' ds_crc_resp, 
	' ' ds_uf_crc_resp, 
	' ' nr_ddd_telefone_resp, 
	' ' nr_telefone_resp, 
	' ' nr_ramal_resp, 
	' ' nr_ddd_fax_resp, 
	' ' nr_fax_resp, 
	' ' ds_email_resp, 
	' ' nr_grupo_tributo, 
	'0' cd_receita, 
	' ' ds_periodicidade, 
	clock_timestamp() nr_ano_apuracao, 
	' ' dt_apuracao_mensal, 
	' ' dt_apuracao_diario, 
	' ' nr_ordem_estab, 
	' ' nr_cnpj_incorporacao, 
	0 vl_debito, 
	0 ie_balanco_reducao, 
	0 ie_saldo_quotas, 
	clock_timestamp() dt_periodo_apuracao, 
	' ' nr_cnpj_darf, 
	'0' cd_receita_darf, 
	clock_timestamp() dt_vencimento, 
	' ' nr_referencia, 
	'0' vl_principal, 
	0 vl_multa, 
	0 vl_juros, 
	'0' vl_pago_debito, 
	0 nr_trimestre_apuracao, 
	0 nr_quota, 
	0 qt_registros, 
	' ' ds_hashcode 
from	dctf_lote a, 
	estabelecimento b, 
	estab_dctf c 
where	a.cd_estabelecimento	= b.cd_estabelecimento 
and	b.cd_estabelecimento	= c.cd_estabelecimento 
and	c.nr_sequencia		= (select	max(x.nr_sequencia) 
				  from		estab_dctf x 
				  where	trunc(x.dt_inicio_vigencia,'dd') <= trunc(clock_timestamp(),'dd') 
				  and		x.cd_estabelecimento	= b.cd_estabelecimento) 
and	a.nr_sequencia		= nr_seq_lote_p 

union all
 
select	3							ie_tipo_registro, 
	a.nr_sequencia						nr_seq_lote, 
	' ' ds_registro, 
	0 ie_tipo_declaracao, 
	b.cd_cgc						nr_cnpj, 
	0 nr_versao, 
	SUBSTR(obter_nome_empresa(b.cd_empresa),1,255)		nm_empresarial, 
	SUBSTR(obter_uf_localidade(b.cd_localidade),1,2)	sg_uf, 
	a.ie_finalidade_dctf					ie_situacao, 
	clock_timestamp() nr_ano_declaracao, 
	clock_timestamp() nr_mes_declaracao, 
	TRUNC(a.dt_referencia,'mm')				dt_periodo_inicial, 
	trunc(fim_mes(a.dt_referencia),'dd')			dt_periodo_final, 
	CASE WHEN a.ie_finalidade_dctf=00 THEN '00000000'  ELSE clock_timestamp() END 	dt_ocorrencia_evento, 
	'R02'							ie_tipo, 
	TRUNC(a.dt_referencia,'mm')				nr_mes_ocorrencia, 
	clock_timestamp() dt_inicio, 
	clock_timestamp() dt_fim, 
	0 nr_declaracao, 
	' ' nr_recibo, 
	0 ie_forma_tributacao, 
	0 ie_qualificacao_pj, 
	0 ie_pj_balanco, 
	0 ie_pj_scp, 
	0 ie_pj_inativa, 
	0 ie_pj_regime_especial, 
	0 ie_pj_dctf_semestral, 
	c.cd_natureza_juridica					cd_natureza_juridica, 
	SUBSTR(obter_dados_pf_pj(NULL,b.cd_cgc,'R'),1,40)	ds_logradouro, 
	substr(obter_compl_pj(b.cd_cgc,1,'NR'),1,6)		ds_numero, 
	SUBSTR(obter_dados_pf_pj(NULL,b.cd_cgc,'CO'),1,21)	ds_complemento, 
	SUBSTR(obter_dados_pf_pj(NULL,b.cd_cgc,'B'),1,20)	ds_bairro, 
	SUBSTR(obter_dados_pf_pj(NULL,b.cd_cgc,'CI'),1,50)	ds_municipio, 
	SUBSTR(obter_dados_pf_pj(NULL,b.cd_cgc,'CEP'),1,8)	nr_cep, 
	lpad(obter_dados_pf_pj(NULL,b.cd_cgc,'T'),3,' ')	nr_ddd_telefone, 
	SUBSTR(obter_dados_pf_pj(NULL,b.cd_cgc,'T'),(LENGTH(obter_dados_pf_pj(NULL,b.cd_cgc,'T'))-7),(LENGTH(obter_dados_pf_pj(NULL,b.cd_cgc,'T'))))	nr_telefone, 
	lpad(obter_dados_pf_pj(NULL,b.cd_cgc,'FAX'),3,' ')	nr_ddd_fax, 
	SUBSTR(obter_dados_pf_pj(NULL,b.cd_cgc,'FAX'),(LENGTH(obter_dados_pf_pj(NULL,b.cd_cgc,'FAX'))-7),(LENGTH(obter_dados_pf_pj(NULL,b.cd_cgc,'FAX'))))	nr_fax, 
	' '							nr_caixa_postal, 
	' '							ds_uf_caixa_postal, 
	' '							nr_cep_caixa_postal, 
	SUBSTR(obter_dados_pf_pj(NULL,b.cd_cgc,'M'),1,40)	ds_email, 
	' ' nm_representante, 
	' ' nr_cpf_representante, 
	' ' nr_ddd_telefone_representante, 
	' ' nr_telefone_representante, 
	' ' nr_ramal_representante, 
	' ' nr_ddd_fax_representante, 
	' ' nr_fax_representante, 
	' ' ds_email_representante, 
	' ' nm_responsavel, 
	' ' nr_cpf_resp, 
	' ' ds_crc_resp, 
	' ' ds_uf_crc_resp, 
	' ' nr_ddd_telefone_resp, 
	' ' nr_telefone_resp, 
	' ' nr_ramal_resp, 
	' ' nr_ddd_fax_resp, 
	' ' nr_fax_resp, 
	' ' ds_email_resp, 
	' ' nr_grupo_tributo, 
	'0' cd_receita, 
	' ' ds_periodicidade, 
	clock_timestamp() nr_ano_apuracao, 
	' ' dt_apuracao_mensal, 
	' ' dt_apuracao_diario, 
	' ' nr_ordem_estab, 
	' ' nr_cnpj_incorporacao, 
	0 vl_debito, 
	0 ie_balanco_reducao, 
	0 ie_saldo_quotas, 
	clock_timestamp() dt_periodo_apuracao, 
	' ' nr_cnpj_darf, 
	'0' cd_receita_darf, 
	clock_timestamp() dt_vencimento, 
	' ' nr_referencia, 
	'0' vl_principal, 
	0 vl_multa, 
	0 vl_juros, 
	'0' vl_pago_debito, 
	0 nr_trimestre_apuracao, 
	0 nr_quota, 
	0 qt_registros, 
	' ' ds_hashcode 
from	dctf_lote a, 
	estabelecimento b, 
	estab_dctf c 
where	a.cd_estabelecimento	= b.cd_estabelecimento 
and	b.cd_estabelecimento	= c.cd_estabelecimento 
and	c.nr_sequencia		= (select	max(x.nr_sequencia) 
				  from		estab_dctf X 
				  where	trunc(x.dt_inicio_vigencia,'dd') <= trunc(clock_timestamp(),'dd') 
				  and		x.cd_estabelecimento	= b.cd_estabelecimento) 
and	a.nr_sequencia		= nr_seq_lote_p 

union all
 
select	4						ie_tipo_registro, 
	a.nr_sequencia					nr_seq_lote, 
	' ' ds_registro, 
	0 ie_tipo_declaracao, 
	b.cd_cgc					nr_cnpj, 
	0 nr_versao, 
	' ' nm_empresarial, 
	' ' sg_uf, 
	a.ie_finalidade_dctf				ie_situacao, 
	clock_timestamp() nr_ano_declaracao, 
	clock_timestamp() nr_mes_declaracao, 
	TRUNC(a.dt_referencia,'mm')			dt_periodo_inicial, 
	trunc(fim_mes(a.dt_referencia),'dd')		dt_periodo_final, 
	CASE WHEN a.ie_finalidade_dctf=00 THEN '00000000'  ELSE clock_timestamp() END  dt_ocorrencia_evento, 
	'R03'						ie_tipo, 
	TRUNC(a.dt_referencia,'mm')			nr_mes_ocorrencia, 
	clock_timestamp() dt_inicio, 
	clock_timestamp() dt_fim, 
	0 nr_declaracao, 
	' ' nr_recibo, 
	0 ie_forma_tributacao, 
	0 ie_qualificacao_pj, 
	0 ie_pj_balanco, 
	0 ie_pj_scp, 
	0 ie_pj_inativa, 
	0 ie_pj_regime_especial, 
	0 ie_pj_dctf_semestral, 
	' ' cd_natureza_juridica, 
	' ' ds_logradouro, 
	' ' ds_numero, 
	' ' ds_complemento, 
	' ' ds_bairro, 
	' ' ds_municipio, 
	' ' nr_cep, 
	' ' nr_ddd_telefone, 
	' ' nr_telefone, 
	' ' nr_ddd_fax, 
	' ' nr_fax, 
	' ' nr_caixa_postal, 
	' ' ds_uf_caixa_postal, 
	' ' nr_cep_caixa_postal, 
	' ' ds_email, 
	substr(obter_nome_pf_pj(c.cd_titular,null),1,60)		nm_representante, 
	substr(obter_dados_pf(c.cd_titular,'CPF'),1,11)			nr_cpf_representante, 
	lpad(obter_dados_pf_pj(c.cd_titular,null,'T'),3,' ')		nr_ddd_telefone_representante, 
	SUBSTR(obter_dados_pf_pj(c.cd_titular,null,'T'),(LENGTH(obter_dados_pf_pj(c.cd_titular,NULL,'T'))-7),(LENGTH(obter_dados_pf_pj(c.cd_titular,NULL,'T')))) nr_telefone_representante, 
	substr(obter_compl_pf(c.cd_titular,1,'RAM'),1,5)		nr_ramal_representante, 
	lpad(obter_dados_pf_pj(c.cd_titular,null,'FAX'),3,' ')		nr_ddd_fax_representante, 
	SUBSTR(obter_dados_pf_pj(c.cd_titular,null,'FAX'),(LENGTH(obter_dados_pf_pj(c.cd_titular,NULL,'FAX'))-7),(LENGTH(obter_dados_pf_pj(c.cd_titular,NULL,'FAX'))))		nr_fax_representante, 
	substr(obter_dados_pf_pj(c.cd_titular,null,'M'),1,40)		ds_email_representante, 
	substr(obter_nome_pf_pj(c.cd_contabilista,null),1,60)		nm_responsavel, 
	substr(obter_dados_pf(c.cd_contabilista,'CPF'),1,11)		nr_cpf_resp, 
	c.nr_crc							ds_crc_resp, 
	' ' 								ds_uf_crc_resp, 
	lpad(obter_dados_pf_pj(c.cd_contabilista,null,'T'),3,' ')	nr_ddd_telefone_resp, 
	substr(obter_dados_pf_pj(c.cd_contabilista,null,'T'),(LENGTH(obter_dados_pf_pj(c.cd_contabilista,null,'T'))-7),(LENGTH(obter_dados_pf_pj(c.cd_contabilista,null,'T'))))	nr_telefone_resp, 
	substr(obter_compl_pf(c.cd_contabilista,1,'RAM'),1,5)		nr_ramal_resp, 
	lpad(obter_dados_pf_pj(c.cd_contabilista,null,'FAX'),3,' ')	nr_ddd_fax_resp, 
	substr(obter_dados_pf_pj(c.cd_contabilista,null,'FAX'),(LENGTH(obter_dados_pf_pj(c.cd_contabilista,null,'FAX'))-7),(LENGTH(obter_dados_pf_pj(c.cd_contabilista,null,'FAX'))))	nr_fax_resp, 
	substr(obter_dados_pf_pj(c.cd_contabilista,null,'M'),1,40)	ds_email_resp, 
	' ' nr_grupo_tributo, 
	'0' cd_receita, 
	' ' ds_periodicidade, 
	clock_timestamp() nr_ano_apuracao, 
	' ' dt_apuracao_mensal, 
	' ' dt_apuracao_diario, 
	' ' nr_ordem_estab, 
	' ' nr_cnpj_incorporacao, 
	0 vl_debito, 
	0 ie_balanco_reducao, 
	0 ie_saldo_quotas, 
	clock_timestamp() dt_periodo_apuracao, 
	' ' nr_cnpj_darf, 
	'0' cd_receita_darf, 
	clock_timestamp() dt_vencimento, 
	' ' nr_referencia, 
	'0' vl_principal, 
	0 vl_multa, 
	0 vl_juros, 
	'0' vl_pago_debito, 
	0 nr_trimestre_apuracao, 
	0 nr_quota, 
	0 qt_registros, 
	' ' ds_hashcode 
from	dctf_lote a, 
	estabelecimento b, 
	empresa c 
where	a.cd_estabelecimento	= b.cd_estabelecimento 
and	b.cd_empresa		= c.cd_empresa 
and	a.nr_sequencia		= nr_seq_lote_p 
order by ie_tipo_registro;

c02 CURSOR FOR 
/* R10 - Débito Apurado e Créditos Vinculados */
 
SELECT	distinct 
	5						ie_tipo_registro, 
	a.nr_sequencia					nr_seq_lote, 
	' ' ds_registro, 
	0 ie_tipo_declaracao, 
	b.cd_cgc					nr_cnpj, 
	0 nr_versao, 
	' ' nm_empresarial, 
	' ' sg_uf, 
	a.ie_finalidade_dctf				ie_situacao, 
	clock_timestamp() nr_ano_declaracao, 
	clock_timestamp() nr_mes_declaracao, 
	clock_timestamp()	dt_periodo_inicial, 
	clock_timestamp()	dt_periodo_final, 
	CASE WHEN a.ie_finalidade_dctf=00 THEN '00000000'  ELSE clock_timestamp() END  dt_ocorrencia_evento, 
	'R10'						ie_tipo, 
	TRUNC(a.dt_referencia,'mm')			nr_mes_ocorrencia, 
	clock_timestamp() dt_inicio, 
	clock_timestamp() dt_fim, 
	0 nr_declaracao, 
	' ' nr_recibo, 
	0 ie_forma_tributacao, 
	0 ie_qualificacao_pj, 
	0 ie_pj_balanco, 
	0 ie_pj_scp, 
	0 ie_pj_inativa, 
	0 ie_pj_regime_especial, 
	0 ie_pj_dctf_semestral, 
	' ' cd_natureza_juridica, 
	' ' ds_logradouro, 
	' ' ds_numero, 
	' ' ds_complemento, 
	' ' ds_bairro, 
	' ' ds_municipio, 
	' ' nr_cep, 
	' ' nr_ddd_telefone, 
	' ' nr_telefone, 
	' ' nr_ddd_fax, 
	' ' nr_fax, 
	' ' nr_caixa_postal, 
	' ' ds_uf_caixa_postal, 
	' ' nr_cep_caixa_postal, 
	' ' ds_email, 
	' ' nm_representante, 
	' ' nr_cpf_representante, 
	' ' nr_ddd_telefone_representante, 
	' ' nr_telefone_representante, 
	' ' nr_ramal_representante, 
	' ' nr_ddd_fax_representante, 
	' ' nr_fax_representante, 
	' ' ds_email_representante, 
	' ' nm_responsavel, 
	' ' nr_cpf_resp, 
	' ' ds_crc_resp, 
	' ' ds_uf_crc_resp, 
	' ' nr_ddd_telefone_resp, 
	' ' nr_telefone_resp, 
	' ' nr_ramal_resp, 
	' ' nr_ddd_fax_resp, 
	' ' nr_fax_resp, 
	' ' ds_email_resp, 
	g.ie_grupo_tributo				nr_grupo_tributo, 
	d.cd_darf||coalesce(f.cd_variacao,i.cd_variacao)	cd_receita, 
	coalesce(f.ie_periodicidade,i.ie_periodicidade)	ds_periodicidade, 
	a.dt_referencia					nr_ano_apuracao, 
	CASE WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='T' THEN  obter_periodo_data(d.dt_apuracao,'T') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='U' THEN  obter_periodo_data(d.dt_apuracao,'U') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='B' THEN  obter_periodo_data(d.dt_apuracao,'B') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='E' THEN  obter_periodo_data(d.dt_apuracao,'E') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='A' THEN '00'  ELSE obter_periodo_data(d.dt_apuracao,'M') END  dt_apuracao_mensal, 
	CASE WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='S' THEN  obter_periodo_data(d.dt_apuracao,'S') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='X' THEN  obter_periodo_data(d.dt_apuracao,'X') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='Q' THEN  obter_periodo_data(d.dt_apuracao,'Q') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='D' THEN  obter_periodo_data(d.dt_apuracao,'D')  ELSE '00' END  dt_apuracao_diario, 
	CASE WHEN g.ie_grupo_tributo='03' THEN substr(b.cd_cgc,9,6) WHEN g.ie_grupo_tributo='09' THEN substr(b.cd_cgc,9,6)  ELSE '000000' END  nr_ordem_estab, 
	CASE WHEN g.ie_grupo_tributo='10' THEN b.cd_cgc  ELSE '00000000000000' END  nr_cnpj_incorporacao, 
	sum(i.vl_titulo)				vl_debito, 
	CASE WHEN h.ie_balanco_reducao='N' THEN 0 WHEN h.ie_balanco_reducao='S' THEN 1 END 	ie_balanco_reducao, 
	0						ie_saldo_quotas, 
	clock_timestamp()	dt_periodo_apuracao, 
	' ' nr_cnpj_darf, 
	'0' cd_receita_darf, 
	clock_timestamp()	dt_vencimento, 
	' ' nr_referencia, 
	'0' vl_principal, 
	0 vl_multa, 
	0 vl_juros, 
	'0' vl_pago_debito, 
	0 nr_trimestre_apuracao, 
	0 nr_quota, 
	0 qt_registros, 
	' ' ds_hashcode 
FROM estab_dctf h, tributo g, darf_titulo_pagar e, darf d, dctf_lote_darf c, estabelecimento b, dctf_lote a, titulo_pagar i
LEFT OUTER JOIN titulo_pagar_imposto f ON (i.nr_seq_tributo = f.nr_sequencia)
WHERE a.cd_estabelecimento	= b.cd_estabelecimento and a.nr_sequencia		= c.nr_seq_lote and c.nr_seq_darf		= d.nr_sequencia and d.nr_sequencia		= e.nr_seq_darf  and (f.cd_tributo		= g.cd_tributo or i.cd_tributo = g.cd_tributo) and h.cd_estabelecimento	= b.cd_estabelecimento and e.nr_titulo		= i.nr_titulo and h.nr_sequencia		= (SELECT	max(x.nr_sequencia) 
				  from		estab_dctf x 
				  where	trunc(x.dt_inicio_vigencia,'dd') <= trunc(clock_timestamp(),'dd') 
				  and		b.cd_estabelecimento	= x.cd_estabelecimento) and a.nr_sequencia		= nr_seq_lote_p group by a.nr_sequencia, 
	a.ie_finalidade_dctf, 
	a.dt_referencia, 
	d.cd_darf, 
	coalesce(f.cd_variacao,i.cd_variacao), 
	d.dt_apuracao, 
	coalesce(f.ie_periodicidade,i.ie_periodicidade), 
	b.cd_cgc, 
	g.ie_grupo_tributo, 
	h.ie_balanco_reducao;

c03 CURSOR FOR 
/* R11 - Pagamentos com DARF */
 
SELECT	distinct 6					ie_tipo_registro, 
	a.nr_sequencia					nr_seq_lote, 
	' ' ds_registro, 
	0 ie_tipo_declaracao, 
	b.cd_cgc					nr_cnpj, 
	0 nr_versao, 
	' ' nm_empresarial, 
	' ' sg_uf, 
	a.ie_finalidade_dctf				ie_situacao, 
	clock_timestamp() nr_ano_declaracao, 
	clock_timestamp() nr_mes_declaracao, 
	TRUNC(a.dt_referencia,'mm')			dt_periodo_inicial, 
	trunc(fim_mes(a.dt_referencia),'dd')		dt_periodo_final, 
	CASE WHEN a.ie_finalidade_dctf=00 THEN '00000000'  ELSE clock_timestamp() END  dt_ocorrencia_evento, 
	'R11'						ie_tipo, 
	TRUNC(a.dt_referencia,'mm')			nr_mes_ocorrencia, 
	clock_timestamp() dt_inicio, 
	clock_timestamp() dt_fim, 
	0 nr_declaracao, 
	' ' nr_recibo, 
	0 ie_forma_tributacao, 
	0 ie_qualificacao_pj, 
	0 ie_pj_balanco, 
	0 ie_pj_scp, 
	0 ie_pj_inativa, 
	0 ie_pj_regime_especial, 
	0 ie_pj_dctf_semestral, 
	' ' cd_natureza_juridica, 
	' ' ds_logradouro, 
	' ' ds_numero, 
	' ' ds_complemento, 
	' ' ds_bairro, 
	' ' ds_municipio, 
	' ' nr_cep, 
	' ' nr_ddd_telefone, 
	' ' nr_telefone, 
	' ' nr_ddd_fax, 
	' ' nr_fax, 
	' ' nr_caixa_postal, 
	' ' ds_uf_caixa_postal, 
	' ' nr_cep_caixa_postal, 
	' ' ds_email, 
	' ' nm_representante, 
	' ' nr_cpf_representante, 
	' ' nr_ddd_telefone_representante, 
	' ' nr_telefone_representante, 
	' ' nr_ramal_representante, 
	' ' nr_ddd_fax_representante, 
	' ' nr_fax_representante, 
	' ' ds_email_representante, 
	' ' nm_responsavel, 
	' ' nr_cpf_resp, 
	' ' ds_crc_resp, 
	' ' ds_uf_crc_resp, 
	' ' nr_ddd_telefone_resp, 
	' ' nr_telefone_resp, 
	' ' nr_ramal_resp, 
	' ' nr_ddd_fax_resp, 
	' ' nr_fax_resp, 
	' ' ds_email_resp, 
	g.ie_grupo_tributo				nr_grupo_tributo, 
	d.cd_darf||coalesce(f.cd_variacao,i.cd_variacao)	cd_receita, 
	coalesce(f.ie_periodicidade,i.ie_periodicidade)	ds_periodicidade, 
	a.dt_referencia					nr_ano_apuracao, 
	CASE WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='T' THEN obter_periodo_data(d.dt_apuracao,'T') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='U' THEN obter_periodo_data(d.dt_apuracao,'U') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='B' THEN obter_periodo_data(d.dt_apuracao,'B') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='E' THEN obter_periodo_data(d.dt_apuracao,'E') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='A' THEN '00'  ELSE obter_periodo_data(d.dt_apuracao,'M') END  dt_apuracao_mensal, 
	CASE WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='S' THEN obter_periodo_data(d.dt_apuracao,'S') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='X' THEN obter_periodo_data(d.dt_apuracao,'X') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='Q' THEN obter_periodo_data(d.dt_apuracao,'Q') WHEN coalesce(f.ie_periodicidade,i.ie_periodicidade)='D' THEN obter_periodo_data(d.dt_apuracao,'D')  ELSE '00' END  dt_apuracao_diario, 
	CASE WHEN g.ie_grupo_tributo='03' THEN substr(b.cd_cgc,9,6) WHEN g.ie_grupo_tributo='09' THEN substr(b.cd_cgc,9,6)  ELSE '000000' END  nr_ordem_estab, 
	CASE WHEN g.ie_grupo_tributo='10' THEN b.cd_cgc  ELSE '00000000000000' END  nr_cnpj_incorporacao, 
	0 vl_debito, 
	0 ie_balanco_reducao, 
	0 ie_saldo_quotas, 
	d.dt_apuracao 					dt_periodo_apuracao, 
	b.cd_cgc					nr_cnpj_darf, 
	d.cd_darf					cd_receita_darf, 
	d.dt_vencimento					dt_vencimento, 
	d.nr_referencia					nr_referencia, 
	SUBSTR(obter_valor_darf(d.nr_sequencia),1,50)	vl_principal, 
	coalesce(d.vl_multa,0)		vl_multa, 
	coalesce(d.vl_juros,0)		vl_juros, 
	SUBSTR(obter_valor_darf(d.nr_sequencia),1,50)	vl_pago_debito, 
	0 nr_trimestre_apuracao, 
	0 nr_quota, 
	0 qt_registros, 
	' ' ds_hashcode 
FROM tributo g, darf_titulo_pagar e, darf d, dctf_lote_darf c, estabelecimento b, dctf_lote a, titulo_pagar i
LEFT OUTER JOIN titulo_pagar_imposto f ON (i.nr_seq_tributo = f.nr_sequencia)
WHERE a.cd_estabelecimento	= b.cd_estabelecimento and a.nr_sequencia		= c.nr_seq_lote and c.nr_seq_darf		= d.nr_sequencia and d.nr_sequencia		= e.nr_seq_darf and e.nr_titulo		= i.nr_titulo  and (f.cd_tributo		= g.cd_tributo or i.cd_tributo = g.cd_tributo) and a.nr_sequencia		= nr_seq_lote_p and d.cd_darf||coalesce(f.cd_variacao,i.cd_variacao)	= cd_receita_w;

c04 CURSOR FOR 
SELECT	9						ie_tipo_registro, 
	a.nr_sequencia					nr_seq_lote, 
	' ' ds_registro, 
	0 ie_tipo_declaracao, 
	b.cd_cgc					nr_cnpj, 
	0 nr_versao, 
	' ' nm_empresarial, 
	' ' sg_uf, 
	a.ie_finalidade_dctf				ie_situacao, 
	clock_timestamp() nr_ano_declaracao, 
	clock_timestamp() nr_mes_declaracao, 
	TRUNC(a.dt_referencia,'mm')			dt_periodo_inicial, 
	trunc(fim_mes(a.dt_referencia),'dd')		dt_periodo_final, 
	CASE WHEN a.ie_finalidade_dctf=00 THEN '00000000'  ELSE clock_timestamp() END  dt_ocorrencia_evento, 
	'T9'						ie_tipo, 
	TRUNC(a.dt_referencia,'mm')			nr_mes_ocorrencia, 
	clock_timestamp() dt_inicio, 
	clock_timestamp() dt_fim, 
	0 nr_declaracao, 
	' ' nr_recibo, 
	0 ie_forma_tributacao, 
	0 ie_qualificacao_pj, 
	0 ie_pj_balanco, 
	0 ie_pj_scp, 
	0 ie_pj_inativa, 
	0 ie_pj_regime_especial, 
	0 ie_pj_dctf_semestral, 
	' ' cd_natureza_juridica, 
	' ' ds_logradouro, 
	' ' ds_numero, 
	' ' ds_complemento, 
	' ' ds_bairro, 
	' ' ds_municipio, 
	' ' nr_cep, 
	' ' nr_ddd_telefone, 
	' ' nr_telefone, 
	' ' nr_ddd_fax, 
	' ' nr_fax, 
	' ' nr_caixa_postal, 
	' ' ds_uf_caixa_postal, 
	' ' nr_cep_caixa_postal, 
	' ' ds_email, 
	' ' nm_representante, 
	' ' nr_cpf_representante, 
	' ' nr_ddd_telefone_representante, 
	' ' nr_telefone_representante, 
	' ' nr_ramal_representante, 
	' ' nr_ddd_fax_representante, 
	' ' nr_fax_representante, 
	' ' ds_email_representante, 
	' ' nm_responsavel, 
	' ' nr_cpf_resp, 
	' ' ds_crc_resp, 
	' ' ds_uf_crc_resp, 
	' ' nr_ddd_telefone_resp, 
	' ' nr_telefone_resp, 
	' ' nr_ramal_resp, 
	' ' nr_ddd_fax_resp, 
	' ' nr_fax_resp, 
	' ' ds_email_resp, 
	' ' nr_grupo_tributo, 
	'999999' cd_receita, 
	' ' ds_periodicidade, 
	clock_timestamp() nr_ano_apuracao, 
	' ' dt_apuracao_mensal, 
	' ' dt_apuracao_diario, 
	' ' nr_ordem_estab, 
	' ' nr_cnpj_incorporacao, 
	0 vl_debito, 
	0 ie_balanco_reducao, 
	0 ie_saldo_quotas, 
	clock_timestamp() dt_periodo_apuracao, 
	' ' nr_cnpj_darf, 
	'0' cd_receita_darf, 
	clock_timestamp() dt_vencimento, 
	' ' nr_referencia, 
	'0' vl_principal, 
	0 vl_multa, 
	0 vl_juros, 
	'0' vl_pago_debito, 
	0 nr_trimestre_apuracao, 
	0 nr_quota, 
	00000 		  				qt_registros, 
	'     '					ds_hashcode 
from	dctf_lote a, 
	estabelecimento b 
where	a.cd_estabelecimento	= b.cd_estabelecimento 
and	a.nr_sequencia		= nr_seq_lote_p;


BEGIN 
 
delete	from w_envio_dctf 
where	nr_seq_lote	= nr_seq_lote_p;
 
/* header / R01 - Dados iniciais / R02 - Dados cadastrais do estabelecimento matriz / R03 - Dados dos responsáveis pela PJ */
 
open c01;
loop 
fetch c01 into	 
	ie_tipo_registro_w, 
	nr_seq_lote_w, 
	ds_registro_w, 
	ie_tipo_declaracao_w, 
	nr_cnpj_w, 
	nr_versao_w, 
	nm_empresarial_w, 
	sg_uf_w, 
	ie_situacao_w, 
	nr_ano_declaracao_w, 
	nr_mes_declaracao_w, 
	dt_periodo_inicial_w, 
	dt_periodo_final_w, 
	dt_ocorrencia_evento_w, 
	ie_tipo_w, 
	nr_mes_ocorrencia_w, 
	dt_inicio_w, 
	dt_fim_w, 
	nr_declaracao_w, 
	nr_recibo_w, 
	ie_forma_tributacao_w, 
	ie_qualificacao_pj_w, 
	ie_pj_balanco_w, 
	ie_pj_scp_w, 
	ie_pj_inativa_w, 
	ie_pj_regime_especial_w, 
	ie_pj_dctf_semestral_w, 
	cd_natureza_juridica_w, 
	ds_logradouro_w, 
	ds_numero_w, 
	ds_complemento_w, 
	ds_bairro_w, 
	ds_municipio_w, 
	nr_cep_w, 
	nr_ddd_telefone_w, 
	nr_telefone_w, 
	nr_ddd_fax_w, 
	nr_fax_w, 
	nr_caixa_postal_w, 
	ds_uf_caixa_postal_w, 
	nr_cep_caixa_postal_w, 
	ds_email_w, 
	nm_representante_w, 
	nr_cpf_representante_w, 
	nr_ddd_telefone_repr_w, 
	nr_telefone_representante_w, 
	nr_ramal_representante_w, 
	nr_ddd_fax_representante_w, 
	nr_fax_representante_w, 
	ds_email_representante_w, 
	nm_responsavel_w, 
	nr_cpf_resp_w, 
	ds_crc_resp_w, 
	ds_uf_crc_resp_w, 
	nr_ddd_telefone_resp_w, 
	nr_telefone_resp_w, 
	nr_ramal_resp_w, 
	nr_ddd_fax_resp_w, 
	nr_fax_resp_w, 
	ds_email_resp_w, 
	nr_grupo_tributo_w, 
	cd_receita_w, 
	ds_periodicidade_w, 
	nr_ano_apuracao_w, 
	dt_apuracao_mensal_w, 
	dt_apuracao_diario_w, 
	nr_ordem_estab_w, 
	nr_cnpj_incorporacao_w, 
	vl_debito_w, 
	ie_balanco_reducao_w, 
	ie_saldo_quotas_w, 
	dt_periodo_apuracao_w, 
	nr_cnpj_darf_w, 
	cd_receita_darf_w, 
	dt_vencimento_w, 
	nr_referencia_w, 
	vl_principal_w, 
	vl_multa_w, 
	vl_juros_w, 
	vl_pago_debito_w, 
	nr_trimestre_apuracao_w, 
	nr_quota_w, 
	qt_registros_w, 
	ds_hashcode_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
 
	select	nextval('w_envio_dctf_seq') 
	into STRICT	nr_seq_envio_dctf_w 
	;
 
	insert into w_envio_dctf(nr_sequencia, 
		nm_usuario, 
		dt_atualizacao, 
		ie_tipo_registro, 
		nr_seq_lote, 
		ds_registro, 
		ie_tipo_declaracao, 
		nr_cnpj,		 
		nr_versao, 
		nm_empresarial, 
		sg_uf, 
		ie_situacao, 
		nr_ano_declaracao, 
		nr_mes_declaracao, 
		dt_periodo_inicial, 
		dt_periodo_final, 
		dt_ocorrencia_evento, 
		ie_tipo, 
		nr_mes_ocorrencia, 
		dt_inicio, 
		dt_fim, 
		nr_declaracao, 
		nr_recibo, 
		ie_forma_tributacao, 
		ie_qualificacao_pj, 
		ie_pj_balanco, 
		ie_pj_scp, 
		ie_pj_inativa, 
		ie_pj_regime_especial, 
		ie_pj_dctf_semestral, 
		cd_natureza_juridica, 
		ds_logradouro, 
		ds_numero, 
		ds_complemento, 
		ds_bairro, 
		ds_municipio, 
		nr_cep, 
		nr_ddd_telefone, 
		nr_telefone, 
		nr_ddd_fax, 
		nr_fax, 
		nr_caixa_postal, 
		ds_uf_caixa_postal, 
		nr_cep_caixa_postal, 
		ds_email, 
		nm_representante, 
		nr_cpf_representante, 
		nr_ddd_telefone_representante, 
		nr_telefone_representante, 
		nr_ramal_representante, 
		nr_ddd_fax_representante, 
		nr_fax_representante, 
		ds_email_representante, 
		nm_responsavel, 
		nr_cpf_resp, 
		ds_crc_resp, 
		ds_uf_crc_resp, 
		nr_ddd_telefone_resp, 
		nr_telefone_resp, 
		nr_ramal_resp, 
		nr_ddd_fax_resp, 
		nr_fax_resp, 
		ds_email_resp, 
		nr_grupo_tributo, 
		cd_receita, 
		ds_periodicidade, 
		nr_ano_apuracao, 
		dt_apuracao_mensal, 
		dt_apuracao_diario, 
		nr_ordem_estab, 
		nr_cnpj_incorporacao, 
		vl_debito, 
		ie_balanco_reducao, 
		ie_saldo_quotas, 
		dt_periodo_apuracao, 
		nr_cnpj_darf, 
		cd_receita_darf, 
		dt_vencimento, 
		nr_referencia, 
		vl_principal, 
		vl_multa, 
		vl_juros, 
		vl_pago_debito, 
		nr_trimestre_apuracao, 
		nr_quota, 
		qt_registros, 
		ds_hashcode) 
	values (nr_seq_envio_dctf_w, 
		nm_usuario_p, 
		clock_timestamp(), 
		ie_tipo_registro_w, 
		nr_seq_lote_w, 
		ds_registro_w, 
		ie_tipo_declaracao_w, 
		nr_cnpj_w, 
		nr_versao_w, 
		nm_empresarial_w, 
		sg_uf_w, 
		ie_situacao_w, 
		nr_ano_declaracao_w, 
		nr_mes_declaracao_w, 
		dt_periodo_inicial_w, 
		dt_periodo_final_w, 
		dt_ocorrencia_evento_w, 
		ie_tipo_w, 
		nr_mes_ocorrencia_w, 
		dt_inicio_w, 
		dt_fim_w, 
		nr_declaracao_w, 
		substr(nr_recibo_w,1,50), 
		ie_forma_tributacao_w, 
		ie_qualificacao_pj_w, 
		ie_pj_balanco_w, 
		ie_pj_scp_w, 
		ie_pj_inativa_w, 
		ie_pj_regime_especial_w, 
		ie_pj_dctf_semestral_w, 
		cd_natureza_juridica_w, 
		ds_logradouro_w, 
		ds_numero_w, 
		ds_complemento_w, 
		ds_bairro_w, 
		ds_municipio_w, 
		nr_cep_w, 
		nr_ddd_telefone_w, 
		nr_telefone_w, 
		nr_ddd_fax_w, 
		nr_fax_w, 
		nr_caixa_postal_w, 
		ds_uf_caixa_postal_w, 
		nr_cep_caixa_postal_w, 
		ds_email_w, 
		nm_representante_w, 
		nr_cpf_representante_w, 
		nr_ddd_telefone_repr_w, 
		nr_telefone_representante_w, 
		nr_ramal_representante_w, 
		nr_ddd_fax_representante_w, 
		nr_fax_representante_w, 
		ds_email_representante_w, 
		nm_responsavel_w, 
		nr_cpf_resp_w, 
		ds_crc_resp_w, 
		ds_uf_crc_resp_w, 
		nr_ddd_telefone_resp_w, 
		nr_telefone_resp_w, 
		nr_ramal_resp_w, 
		nr_ddd_fax_resp_w, 
		nr_fax_resp_w, 
		ds_email_resp_w, 
		nr_grupo_tributo_w, 
		cd_receita_w, 
		ds_periodicidade_w, 
		nr_ano_apuracao_w, 
		dt_apuracao_mensal_w, 
		dt_apuracao_diario_w, 
		nr_ordem_estab_w, 
		nr_cnpj_incorporacao_w, 
		vl_debito_w, 
		ie_balanco_reducao_w, 
		ie_saldo_quotas_w, 
		dt_periodo_apuracao_w, 
		nr_cnpj_darf_w, 
		cd_receita_darf_w, 
		dt_vencimento_w, 
		nr_referencia_w, 
		vl_principal_w, 
		vl_multa_w, 
		vl_juros_w, 
		vl_pago_debito_w, 
		nr_trimestre_apuracao_w, 
		nr_quota_w, 
		qt_registros_w, 
		ds_hashcode_w);
 
end loop;
close c01;
 
open c02;
loop 
fetch c02 into 
	ie_tipo_registro_w, 
	nr_seq_lote_w, 
	ds_registro_w, 
	ie_tipo_declaracao_w, 
	nr_cnpj_w, 
	nr_versao_w, 
	nm_empresarial_w, 
	sg_uf_w, 
	ie_situacao_w, 
	nr_ano_declaracao_w, 
	nr_mes_declaracao_w, 
	dt_periodo_inicial_w, 
	dt_periodo_final_w, 
	dt_ocorrencia_evento_w, 
	ie_tipo_w, 
	nr_mes_ocorrencia_w, 
	dt_inicio_w, 
	dt_fim_w, 
	nr_declaracao_w, 
	nr_recibo_w, 
	ie_forma_tributacao_w, 
	ie_qualificacao_pj_w, 
	ie_pj_balanco_w, 
	ie_pj_scp_w, 
	ie_pj_inativa_w, 
	ie_pj_regime_especial_w, 
	ie_pj_dctf_semestral_w, 
	cd_natureza_juridica_w, 
	ds_logradouro_w, 
	ds_numero_w, 
	ds_complemento_w, 
	ds_bairro_w, 
	ds_municipio_w, 
	nr_cep_w, 
	nr_ddd_telefone_w, 
	nr_telefone_w, 
	nr_ddd_fax_w, 
	nr_fax_w, 
	nr_caixa_postal_w, 
	ds_uf_caixa_postal_w, 
	nr_cep_caixa_postal_w, 
	ds_email_w, 
	nm_representante_w, 
	nr_cpf_representante_w, 
	nr_ddd_telefone_repr_w, 
	nr_telefone_representante_w, 
	nr_ramal_representante_w, 
	nr_ddd_fax_representante_w, 
	nr_fax_representante_w, 
	ds_email_representante_w, 
	nm_responsavel_w, 
	nr_cpf_resp_w, 
	ds_crc_resp_w, 
	ds_uf_crc_resp_w, 
	nr_ddd_telefone_resp_w, 
	nr_telefone_resp_w, 
	nr_ramal_resp_w, 
	nr_ddd_fax_resp_w, 
	nr_fax_resp_w, 
	ds_email_resp_w, 
	nr_grupo_tributo_w, 
	cd_receita_w, 
	ds_periodicidade_w, 
	nr_ano_apuracao_w, 
	dt_apuracao_mensal_w, 
	dt_apuracao_diario_w, 
	nr_ordem_estab_w, 
	nr_cnpj_incorporacao_w, 
	vl_debito_w, 
	ie_balanco_reducao_w, 
	ie_saldo_quotas_w, 
	dt_periodo_apuracao_w, 
	nr_cnpj_darf_w, 
	cd_receita_darf_w, 
	dt_vencimento_w, 
	nr_referencia_w, 
	vl_principal_w, 
	vl_multa_w, 
	vl_juros_w, 
	vl_pago_debito_w, 
	nr_trimestre_apuracao_w, 
	nr_quota_w, 
	qt_registros_w, 
	ds_hashcode_w;
EXIT WHEN NOT FOUND; /* apply on c02 */
 
	select	nextval('w_envio_dctf_seq') 
	into STRICT	nr_seq_envio_dctf_w 
	;
 
	insert into w_envio_dctf(nr_sequencia, 
		nm_usuario, 
		dt_atualizacao, 
		ie_tipo_registro, 
		nr_seq_lote, 
		ds_registro, 
		ie_tipo_declaracao, 
		nr_cnpj,		 
		nr_versao, 
		nm_empresarial, 
		sg_uf, 
		ie_situacao, 
		nr_ano_declaracao, 
		nr_mes_declaracao, 
		dt_periodo_inicial, 
		dt_periodo_final, 
		dt_ocorrencia_evento, 
		ie_tipo, 
		nr_mes_ocorrencia, 
		dt_inicio, 
		dt_fim, 
		nr_declaracao, 
		nr_recibo, 
		ie_forma_tributacao, 
		ie_qualificacao_pj, 
		ie_pj_balanco, 
		ie_pj_scp, 
		ie_pj_inativa, 
		ie_pj_regime_especial, 
		ie_pj_dctf_semestral, 
		cd_natureza_juridica, 
		ds_logradouro, 
		ds_numero, 
		ds_complemento, 
		ds_bairro, 
		ds_municipio, 
		nr_cep, 
		nr_ddd_telefone, 
		nr_telefone, 
		nr_ddd_fax, 
		nr_fax, 
		nr_caixa_postal, 
		ds_uf_caixa_postal, 
		nr_cep_caixa_postal, 
		ds_email, 
		nm_representante, 
		nr_cpf_representante, 
		nr_ddd_telefone_representante, 
		nr_telefone_representante, 
		nr_ramal_representante, 
		nr_ddd_fax_representante, 
		nr_fax_representante, 
		ds_email_representante, 
		nm_responsavel, 
		nr_cpf_resp, 
		ds_crc_resp, 
		ds_uf_crc_resp, 
		nr_ddd_telefone_resp, 
		nr_telefone_resp, 
		nr_ramal_resp, 
		nr_ddd_fax_resp, 
		nr_fax_resp, 
		ds_email_resp, 
		nr_grupo_tributo, 
		cd_receita, 
		ds_periodicidade, 
		nr_ano_apuracao, 
		dt_apuracao_mensal, 
		dt_apuracao_diario, 
		nr_ordem_estab, 
		nr_cnpj_incorporacao, 
		vl_debito, 
		ie_balanco_reducao, 
		ie_saldo_quotas, 
		dt_periodo_apuracao, 
		nr_cnpj_darf, 
		cd_receita_darf, 
		dt_vencimento, 
		nr_referencia, 
		vl_principal, 
		vl_multa, 
		vl_juros, 
		vl_pago_debito, 
		nr_trimestre_apuracao, 
		nr_quota, 
		qt_registros, 
		ds_hashcode) 
	values (nr_seq_envio_dctf_w, 
		nm_usuario_p, 
		clock_timestamp(), 
		ie_tipo_registro_w, 
		nr_seq_lote_w, 
		ds_registro_w, 
		ie_tipo_declaracao_w, 
		nr_cnpj_w, 
		nr_versao_w, 
		nm_empresarial_w, 
		sg_uf_w, 
		ie_situacao_w, 
		nr_ano_declaracao_w, 
		nr_mes_declaracao_w, 
		dt_periodo_inicial_w, 
		dt_periodo_final_w, 
		dt_ocorrencia_evento_w, 
		ie_tipo_w, 
		nr_mes_ocorrencia_w, 
		dt_inicio_w, 
		dt_fim_w, 
		nr_declaracao_w, 
		nr_recibo_w, 
		ie_forma_tributacao_w, 
		ie_qualificacao_pj_w, 
		ie_pj_balanco_w, 
		ie_pj_scp_w, 
		ie_pj_inativa_w, 
		ie_pj_regime_especial_w, 
		ie_pj_dctf_semestral_w, 
		cd_natureza_juridica_w, 
		ds_logradouro_w, 
		ds_numero_w, 
		ds_complemento_w, 
		ds_bairro_w, 
		ds_municipio_w, 
		nr_cep_w, 
		nr_ddd_telefone_w, 
		nr_telefone_w, 
		nr_ddd_fax_w, 
		nr_fax_w, 
		nr_caixa_postal_w, 
		ds_uf_caixa_postal_w, 
		nr_cep_caixa_postal_w, 
		ds_email_w, 
		nm_representante_w, 
		nr_cpf_representante_w, 
		nr_ddd_telefone_repr_w, 
		nr_telefone_representante_w, 
		nr_ramal_representante_w, 
		nr_ddd_fax_representante_w, 
		nr_fax_representante_w, 
		ds_email_representante_w, 
		nm_responsavel_w, 
		nr_cpf_resp_w, 
		ds_crc_resp_w, 
		ds_uf_crc_resp_w, 
		nr_ddd_telefone_resp_w, 
		nr_telefone_resp_w, 
		nr_ramal_resp_w, 
		nr_ddd_fax_resp_w, 
		nr_fax_resp_w, 
		ds_email_resp_w, 
		nr_grupo_tributo_w, 
		cd_receita_w, 
		ds_periodicidade_w, 
		nr_ano_apuracao_w, 
		dt_apuracao_mensal_w, 
		dt_apuracao_diario_w, 
		nr_ordem_estab_w, 
		nr_cnpj_incorporacao_w, 
		vl_debito_w, 
		ie_balanco_reducao_w, 
		ie_saldo_quotas_w, 
		dt_periodo_apuracao_w, 
		nr_cnpj_darf_w, 
		cd_receita_darf_w, 
		dt_vencimento_w, 
		nr_referencia_w, 
		vl_principal_w, 
		vl_multa_w, 
		vl_juros_w, 
		vl_pago_debito_w, 
		nr_trimestre_apuracao_w, 
		nr_quota_w, 
		qt_registros_w, 
		ds_hashcode_w);
 
	open c03;
	loop 
	fetch c03 into 
		ie_tipo_registro_w, 
		nr_seq_lote_w, 
		ds_registro_w, 
		ie_tipo_declaracao_w, 
		nr_cnpj_w, 
		nr_versao_w, 
		nm_empresarial_w, 
		sg_uf_w, 
		ie_situacao_w, 
		nr_ano_declaracao_w, 
		nr_mes_declaracao_w, 
		dt_periodo_inicial_w, 
		dt_periodo_final_w, 
		dt_ocorrencia_evento_w, 
		ie_tipo_w, 
		nr_mes_ocorrencia_w, 
		dt_inicio_w, 
		dt_fim_w, 
		nr_declaracao_w, 
		nr_recibo_w, 
		ie_forma_tributacao_w, 
		ie_qualificacao_pj_w, 
		ie_pj_balanco_w, 
		ie_pj_scp_w, 
		ie_pj_inativa_w, 
		ie_pj_regime_especial_w, 
		ie_pj_dctf_semestral_w, 
		cd_natureza_juridica_w, 
		ds_logradouro_w, 
		ds_numero_w, 
		ds_complemento_w, 
		ds_bairro_w, 
		ds_municipio_w, 
		nr_cep_w, 
		nr_ddd_telefone_w, 
		nr_telefone_w, 
		nr_ddd_fax_w, 
		nr_fax_w, 
		nr_caixa_postal_w, 
		ds_uf_caixa_postal_w, 
		nr_cep_caixa_postal_w, 
		ds_email_w, 
		nm_representante_w, 
		nr_cpf_representante_w, 
		nr_ddd_telefone_repr_w, 
		nr_telefone_representante_w, 
		nr_ramal_representante_w, 
		nr_ddd_fax_representante_w, 
		nr_fax_representante_w, 
		ds_email_representante_w, 
		nm_responsavel_w, 
		nr_cpf_resp_w, 
		ds_crc_resp_w, 
		ds_uf_crc_resp_w, 
		nr_ddd_telefone_resp_w, 
		nr_telefone_resp_w, 
		nr_ramal_resp_w, 
		nr_ddd_fax_resp_w, 
		nr_fax_resp_w, 
		ds_email_resp_w, 
		nr_grupo_tributo_w, 
		cd_receita_w, 
		ds_periodicidade_w, 
		nr_ano_apuracao_w, 
		dt_apuracao_mensal_w, 
		dt_apuracao_diario_w, 
		nr_ordem_estab_w, 
		nr_cnpj_incorporacao_w, 
		vl_debito_w, 
		ie_balanco_reducao_w, 
		ie_saldo_quotas_w, 
		dt_periodo_apuracao_w, 
		nr_cnpj_darf_w, 
		cd_receita_darf_w, 
		dt_vencimento_w, 
		nr_referencia_w, 
		vl_principal_w, 
		vl_multa_w, 
		vl_juros_w, 
		vl_pago_debito_w, 
		nr_trimestre_apuracao_w, 
		nr_quota_w, 
		qt_registros_w, 
		ds_hashcode_w;
	EXIT WHEN NOT FOUND; /* apply on c03 */
 
		select	nextval('w_envio_dctf_seq') 
		into STRICT	nr_seq_envio_dctf_w 
		;
 
		insert into w_envio_dctf(nr_sequencia, 
			nm_usuario, 
			dt_atualizacao, 
			ie_tipo_registro, 
			nr_seq_lote, 
			ds_registro, 
			ie_tipo_declaracao, 
			nr_cnpj,		 
			nr_versao, 
			nm_empresarial, 
			sg_uf, 
			ie_situacao, 
			nr_ano_declaracao, 
			nr_mes_declaracao, 
			dt_periodo_inicial, 
			dt_periodo_final, 
			dt_ocorrencia_evento, 
			ie_tipo, 
			nr_mes_ocorrencia, 
			dt_inicio, 
			dt_fim, 
			nr_declaracao, 
			nr_recibo, 
			ie_forma_tributacao, 
			ie_qualificacao_pj, 
			ie_pj_balanco, 
			ie_pj_scp, 
			ie_pj_inativa, 
			ie_pj_regime_especial, 
			ie_pj_dctf_semestral, 
			cd_natureza_juridica, 
			ds_logradouro, 
			ds_numero, 
			ds_complemento, 
			ds_bairro, 
			ds_municipio, 
			nr_cep, 
			nr_ddd_telefone, 
			nr_telefone, 
			nr_ddd_fax, 
			nr_fax, 
			nr_caixa_postal, 
			ds_uf_caixa_postal, 
			nr_cep_caixa_postal, 
			ds_email, 
			nm_representante, 
			nr_cpf_representante, 
			nr_ddd_telefone_representante, 
			nr_telefone_representante, 
			nr_ramal_representante, 
			nr_ddd_fax_representante, 
			nr_fax_representante, 
			ds_email_representante, 
			nm_responsavel, 
			nr_cpf_resp, 
			ds_crc_resp, 
			ds_uf_crc_resp, 
			nr_ddd_telefone_resp, 
			nr_telefone_resp, 
			nr_ramal_resp, 
			nr_ddd_fax_resp, 
			nr_fax_resp, 
			ds_email_resp, 
			nr_grupo_tributo, 
			cd_receita, 
			ds_periodicidade, 
			nr_ano_apuracao, 
			dt_apuracao_mensal, 
			dt_apuracao_diario, 
			nr_ordem_estab, 
			nr_cnpj_incorporacao, 
			vl_debito, 
			ie_balanco_reducao, 
			ie_saldo_quotas, 
			dt_periodo_apuracao, 
			nr_cnpj_darf, 
			cd_receita_darf, 
			dt_vencimento, 
			nr_referencia, 
			vl_principal, 
			vl_multa, 
			vl_juros, 
			vl_pago_debito, 
			nr_trimestre_apuracao, 
			nr_quota, 
			qt_registros, 
			ds_hashcode) 
		values (nr_seq_envio_dctf_w, 
			nm_usuario_p, 
			clock_timestamp(), 
			ie_tipo_registro_w, 
			nr_seq_lote_w, 
			ds_registro_w, 
			ie_tipo_declaracao_w, 
			nr_cnpj_w, 
			nr_versao_w, 
			nm_empresarial_w, 
			sg_uf_w, 
			ie_situacao_w, 
			nr_ano_declaracao_w, 
			nr_mes_declaracao_w, 
			dt_periodo_inicial_w, 
			dt_periodo_final_w, 
			dt_ocorrencia_evento_w, 
			ie_tipo_w, 
			nr_mes_ocorrencia_w, 
			dt_inicio_w, 
			dt_fim_w, 
			nr_declaracao_w, 
			nr_recibo_w, 
			ie_forma_tributacao_w, 
			ie_qualificacao_pj_w, 
			ie_pj_balanco_w, 
			ie_pj_scp_w, 
			ie_pj_inativa_w, 
			ie_pj_regime_especial_w, 
			ie_pj_dctf_semestral_w, 
			cd_natureza_juridica_w, 
			ds_logradouro_w, 
			ds_numero_w, 
			ds_complemento_w, 
			ds_bairro_w, 
			ds_municipio_w, 
			nr_cep_w, 
			nr_ddd_telefone_w, 
			nr_telefone_w, 
			nr_ddd_fax_w, 
			nr_fax_w, 
			nr_caixa_postal_w, 
			ds_uf_caixa_postal_w, 
			nr_cep_caixa_postal_w, 
			ds_email_w, 
			nm_representante_w, 
			nr_cpf_representante_w, 
			nr_ddd_telefone_repr_w, 
			nr_telefone_representante_w, 
			nr_ramal_representante_w, 
			nr_ddd_fax_representante_w, 
			nr_fax_representante_w, 
			ds_email_representante_w, 
			nm_responsavel_w, 
			nr_cpf_resp_w, 
			ds_crc_resp_w, 
			ds_uf_crc_resp_w, 
			nr_ddd_telefone_resp_w, 
			nr_telefone_resp_w, 
			nr_ramal_resp_w, 
			nr_ddd_fax_resp_w, 
			nr_fax_resp_w, 
			ds_email_resp_w, 
			nr_grupo_tributo_w, 
			cd_receita_w, 
			ds_periodicidade_w, 
			nr_ano_apuracao_w, 
			dt_apuracao_mensal_w, 
			dt_apuracao_diario_w, 
			nr_ordem_estab_w, 
			nr_cnpj_incorporacao_w, 
			vl_debito_w, 
			ie_balanco_reducao_w, 
			ie_saldo_quotas_w, 
			dt_periodo_apuracao_w, 
			nr_cnpj_darf_w, 
			cd_receita_darf_w, 
			dt_vencimento_w, 
			nr_referencia_w, 
			vl_principal_w, 
			vl_multa_w, 
			vl_juros_w, 
			vl_pago_debito_w, 
			nr_trimestre_apuracao_w, 
			nr_quota_w, 
			qt_registros_w, 
			ds_hashcode_w);
 
	end loop;
	close c03;
 
end loop;
close c02;
 
/* T9 - Trailler */
 
open c04;
loop 
fetch c04 into 
	ie_tipo_registro_w, 
	nr_seq_lote_w, 
	ds_registro_w, 
	ie_tipo_declaracao_w, 
	nr_cnpj_w, 
	nr_versao_w, 
	nm_empresarial_w, 
	sg_uf_w, 
	ie_situacao_w, 
	nr_ano_declaracao_w, 
	nr_mes_declaracao_w, 
	dt_periodo_inicial_w, 
	dt_periodo_final_w, 
	dt_ocorrencia_evento_w, 
	ie_tipo_w, 
	nr_mes_ocorrencia_w, 
	dt_inicio_w, 
	dt_fim_w, 
	nr_declaracao_w, 
	nr_recibo_w, 
	ie_forma_tributacao_w, 
	ie_qualificacao_pj_w, 
	ie_pj_balanco_w, 
	ie_pj_scp_w, 
	ie_pj_inativa_w, 
	ie_pj_regime_especial_w, 
	ie_pj_dctf_semestral_w, 
	cd_natureza_juridica_w, 
	ds_logradouro_w, 
	ds_numero_w, 
	ds_complemento_w, 
	ds_bairro_w, 
	ds_municipio_w, 
	nr_cep_w, 
	nr_ddd_telefone_w, 
	nr_telefone_w, 
	nr_ddd_fax_w, 
	nr_fax_w, 
	nr_caixa_postal_w, 
	ds_uf_caixa_postal_w, 
	nr_cep_caixa_postal_w, 
	ds_email_w, 
	nm_representante_w, 
	nr_cpf_representante_w, 
	nr_ddd_telefone_repr_w, 
	nr_telefone_representante_w, 
	nr_ramal_representante_w, 
	nr_ddd_fax_representante_w, 
	nr_fax_representante_w, 
	ds_email_representante_w, 
	nm_responsavel_w, 
	nr_cpf_resp_w, 
	ds_crc_resp_w, 
	ds_uf_crc_resp_w, 
	nr_ddd_telefone_resp_w, 
	nr_telefone_resp_w, 
	nr_ramal_resp_w, 
	nr_ddd_fax_resp_w, 
	nr_fax_resp_w, 
	ds_email_resp_w, 
	nr_grupo_tributo_w, 
	cd_receita_w, 
	ds_periodicidade_w, 
	nr_ano_apuracao_w, 
	dt_apuracao_mensal_w, 
	dt_apuracao_diario_w, 
	nr_ordem_estab_w, 
	nr_cnpj_incorporacao_w, 
	vl_debito_w, 
	ie_balanco_reducao_w, 
	ie_saldo_quotas_w, 
	dt_periodo_apuracao_w, 
	nr_cnpj_darf_w, 
	cd_receita_darf_w, 
	dt_vencimento_w, 
	nr_referencia_w, 
	vl_principal_w, 
	vl_multa_w, 
	vl_juros_w, 
	vl_pago_debito_w, 
	nr_trimestre_apuracao_w, 
	nr_quota_w, 
	qt_registros_w, 
	ds_hashcode_w;
EXIT WHEN NOT FOUND; /* apply on c04 */
 
	select	nextval('w_envio_dctf_seq') 
	into STRICT	nr_seq_envio_dctf_w 
	;
 
	insert into w_envio_dctf(nr_sequencia, 
		nm_usuario, 
		dt_atualizacao, 
		ie_tipo_registro, 
		nr_seq_lote, 
		ds_registro, 
		ie_tipo_declaracao, 
		nr_cnpj,		 
		nr_versao, 
		nm_empresarial, 
		sg_uf, 
		ie_situacao, 
		nr_ano_declaracao, 
		nr_mes_declaracao, 
		dt_periodo_inicial, 
		dt_periodo_final, 
		dt_ocorrencia_evento, 
		ie_tipo, 
		nr_mes_ocorrencia, 
		dt_inicio, 
		dt_fim, 
		nr_declaracao, 
		nr_recibo, 
		ie_forma_tributacao, 
		ie_qualificacao_pj, 
		ie_pj_balanco, 
		ie_pj_scp, 
		ie_pj_inativa, 
		ie_pj_regime_especial, 
		ie_pj_dctf_semestral, 
		cd_natureza_juridica, 
		ds_logradouro, 
		ds_numero, 
		ds_complemento, 
		ds_bairro, 
		ds_municipio, 
		nr_cep, 
		nr_ddd_telefone, 
		nr_telefone, 
		nr_ddd_fax, 
		nr_fax, 
		nr_caixa_postal, 
		ds_uf_caixa_postal, 
		nr_cep_caixa_postal, 
		ds_email, 
		nm_representante, 
		nr_cpf_representante, 
		nr_ddd_telefone_representante, 
		nr_telefone_representante, 
		nr_ramal_representante, 
		nr_ddd_fax_representante, 
		nr_fax_representante, 
		ds_email_representante, 
		nm_responsavel, 
		nr_cpf_resp, 
		ds_crc_resp, 
		ds_uf_crc_resp, 
		nr_ddd_telefone_resp, 
		nr_telefone_resp, 
		nr_ramal_resp, 
		nr_ddd_fax_resp, 
		nr_fax_resp, 
		ds_email_resp, 
		nr_grupo_tributo, 
		cd_receita, 
		ds_periodicidade, 
		nr_ano_apuracao, 
		dt_apuracao_mensal, 
		dt_apuracao_diario, 
		nr_ordem_estab, 
		nr_cnpj_incorporacao, 
		vl_debito, 
		ie_balanco_reducao, 
		ie_saldo_quotas, 
		dt_periodo_apuracao, 
		nr_cnpj_darf, 
		cd_receita_darf, 
		dt_vencimento, 
		nr_referencia, 
		vl_principal, 
		vl_multa, 
		vl_juros, 
		vl_pago_debito, 
		nr_trimestre_apuracao, 
		nr_quota, 
		qt_registros, 
		ds_hashcode) 
	values (nr_seq_envio_dctf_w, 
		nm_usuario_p, 
		clock_timestamp(), 
		ie_tipo_registro_w, 
		nr_seq_lote_w, 
		ds_registro_w, 
		ie_tipo_declaracao_w, 
		nr_cnpj_w, 
		nr_versao_w, 
		nm_empresarial_w, 
		sg_uf_w, 
		ie_situacao_w, 
		nr_ano_declaracao_w, 
		nr_mes_declaracao_w, 
		dt_periodo_inicial_w, 
		dt_periodo_final_w, 
		dt_ocorrencia_evento_w, 
		ie_tipo_w, 
		nr_mes_ocorrencia_w, 
		dt_inicio_w, 
		dt_fim_w, 
		nr_declaracao_w, 
		nr_recibo_w, 
		ie_forma_tributacao_w, 
		ie_qualificacao_pj_w, 
		ie_pj_balanco_w, 
		ie_pj_scp_w, 
		ie_pj_inativa_w, 
		ie_pj_regime_especial_w, 
		ie_pj_dctf_semestral_w, 
		cd_natureza_juridica_w, 
		ds_logradouro_w, 
		ds_numero_w, 
		ds_complemento_w, 
		ds_bairro_w, 
		ds_municipio_w, 
		nr_cep_w, 
		nr_ddd_telefone_w, 
		nr_telefone_w, 
		nr_ddd_fax_w, 
		nr_fax_w, 
		nr_caixa_postal_w, 
		ds_uf_caixa_postal_w, 
		nr_cep_caixa_postal_w, 
		ds_email_w, 
		nm_representante_w, 
		nr_cpf_representante_w, 
		nr_ddd_telefone_repr_w, 
		nr_telefone_representante_w, 
		nr_ramal_representante_w, 
		nr_ddd_fax_representante_w, 
		nr_fax_representante_w, 
		ds_email_representante_w, 
		nm_responsavel_w, 
		nr_cpf_resp_w, 
		ds_crc_resp_w, 
		ds_uf_crc_resp_w, 
		nr_ddd_telefone_resp_w, 
		nr_telefone_resp_w, 
		nr_ramal_resp_w, 
		nr_ddd_fax_resp_w, 
		nr_fax_resp_w, 
		ds_email_resp_w, 
		nr_grupo_tributo_w, 
		cd_receita_w, 
		ds_periodicidade_w, 
		nr_ano_apuracao_w, 
		dt_apuracao_mensal_w, 
		dt_apuracao_diario_w, 
		nr_ordem_estab_w, 
		nr_cnpj_incorporacao_w, 
		vl_debito_w, 
		ie_balanco_reducao_w, 
		ie_saldo_quotas_w, 
		dt_periodo_apuracao_w, 
		nr_cnpj_darf_w, 
		cd_receita_darf_w, 
		dt_vencimento_w, 
		nr_referencia_w, 
		vl_principal_w, 
		vl_multa_w, 
		vl_juros_w, 
		vl_pago_debito_w, 
		nr_trimestre_apuracao_w, 
		nr_quota_w, 
		qt_registros_w, 
		ds_hashcode_w);
 
end loop;
close c04;
 
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_w_envio_dctf ( nr_seq_lote_p bigint, nm_usuario_p text) FROM PUBLIC;

