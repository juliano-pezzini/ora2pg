-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE cpoe_inserir_dieta_fav (( nr_atendimento_p cpoe_dieta.nr_atendimento%type, nr_sequencia_p cpoe_fav_dieta.nr_sequencia%type, nm_usuario_p cpoe_fav_dieta.nm_usuario%type, cd_perfil_p bigint, cd_estabelecimento_p bigint, cd_pessoa_fisica_p cpoe_dieta.cd_pessoa_fisica%type, nr_seq_item_gerado_p out bigint, nr_seq_transcricao_p bigint default null, ie_item_alta_p text default 'N', ie_prescritor_aux_p text default 'N', cd_medico_p bigint default null, ie_retrogrado_p text default 'N', dt_inicio_p timestamp default null, nr_seq_pepo_p bigint default null, nr_cirurgia_p bigint default null, nr_cirurgia_patologia_p bigint default null, nr_seq_agenda_p bigint default null, nr_seq_conclusao_apae_p bigint default null, ie_futuro_p text default 'N', nr_seq_cpoe_rp_p cpoe_rp.nr_sequencia%type default null, nr_seq_cpoe_order_unit_p cpoe_order_unit.nr_sequencia%type default null) is cd_dieta_w cpoe_dieta.cd_dieta%type) AS $body$
DECLARE

	qt_hora_retorno_w	double precision;
	
BEGIN
	if (hr_horario_p IS NOT NULL AND hr_horario_p::text <> '') and (hr_horario_p <> '__:__') then
		qt_hora_retorno_w := (substr(hr_horario_p,1,position(':' in hr_horario_p)-1))::numeric;
		qt_hora_retorno_w := qt_hora_retorno_w + (substr(hr_horario_p,position(':' in hr_horario_p)+1,2))::numeric;
	end if;
	return;
	end;

begin
ie_prescr_alta_agora_w := obter_param_usuario(924, 409, cd_perfil_p, nm_usuario_p, cd_estabelecimento_p, ie_prescr_alta_agora_w);

open c01;
loop
fetch c01 into	cd_dieta_w,
				cd_intervalo_w,
				cd_material_w,
				cd_mat_prod1_w,
				cd_mat_prod2_w,
				cd_mat_prod3_w,
				cd_mat_prod4_w,
				cd_mat_prod5_w,
				cd_mat_prod_adic1_w,
				cd_mat_prod_adic2_w,
				cd_mat_prod_adic3_w,
				cd_mat_prod_adic4_w,
				cd_mat_prod_adic5_w,
				cd_mat_prod_adic6_w,
				cd_mat_dil_w,
				cd_unidade_medida_dose_w,
				cd_unid_med_prod1_w,
				cd_unid_med_prod2_w,
				cd_unid_med_prod3_w,
				cd_unid_med_prod4_w,
				cd_unid_med_prod5_w,
				cd_unid_med_prod_adic1_w,
				cd_unid_med_prod_adic2_w,
				cd_unid_med_prod_adic3_w,
				cd_unid_med_prod_adic4_w,
				cd_unid_med_prod_adic5_w,
				cd_unid_med_prod_adic6_w,
				cd_unid_med_dose_dil_w,
				ds_dose_diferenciada_w,
				ds_evento_w,
				ie_acm_w,
				ie_administracao_w,
				ie_aplic_bolus_w,
				ie_bomba_infusao_w,
				ie_continuo_w,
				ie_dose_unica_w,
				ie_duracao_w,
				ie_evento_unico_w,
				ie_inicio_w,
				ie_jejum_w,
				ie_jejum_antes_w,
				ie_jejum_depois_w,
				ie_leite_materno_w,
				ie_opcao_antes_w,
				ie_opcao_depois_w,
				ie_referencia_w,
				ie_se_necessario_w,
				ie_tipo_dieta_w,
				ie_tipo_dosagem_w,
				ie_urgencia_w,
				ie_via_aplicacao_w,
				ie_via_leite1_w,
				ie_via_leite2_w,
				ie_via_leite3_w,
				ie_via_leite4_w,
				ie_via_leite5_w,
				nr_etapas_w,
				nr_ocorrencia_w,
				nr_seq_disp_succao_w,
				nr_seq_objetivo_w,
				nr_seq_tipo_w,
				nr_seq_via_acesso_w,
				qt_dose_w,
				qt_dose_prod1_w,
				qt_dose_prod2_w,
				qt_dose_prod3_w,
				qt_dose_prod4_w,
				qt_dose_prod5_w,
				qt_dose_prod_adic1_w,
				qt_dose_prod_adic2_w,
				qt_dose_prod_adic3_w,
				qt_dose_prod_adic4_w,
				qt_dose_prod_adic5_w,
				qt_dose_prod_adic6_w,
				qt_porcentagem_adic1_w,
				qt_porcentagem_adic2_w,
				qt_porcentagem_adic3_w,
				qt_porcentagem_adic4_w,
				qt_porcentagem_adic5_w,
				qt_porcentagem_adic6_w,
				qt_dose_dil_w,
				qt_hora_ant_w,
				qt_hora_aplicacao_w,
				qt_hora_depois_w,
				qt_min_ant_w,
				qt_min_depois_w,
				qt_parametro_w,
				qt_tempo_aplic_w,
				qt_tempo_pausa_w,
				qt_tempo_ref_w,
				qt_vel_infusao_w,
				qt_volume_w,
				qt_volume_total_w,
				qt_hora_fase_w,
				ds_orientacao_w,
				nr_seq_solubilidade_w,
				nr_seq_temperatura_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
	begin
	
	nr_ocorrencia_w 	:= 0;
	hr_prim_horario_w 	:= '';
	ds_horarios_w 		:= '';
	ds_horarios_aux_w 	:= '';
	dt_fim_w 			:= null;
	dt_evento_w			:= null;
	dt_inicio_w			:= clock_timestamp();
	
	if (coalesce(obter_se_marca_agora(cpoe_obter_setor_atend_prescr(nr_atendimento_p, cd_estabelecimento_p, cd_perfil_p, nm_usuario_p)),'N') = 'S') then
	
		if (ie_tipo_dieta_w = 'E' and ie_continuo_w = 'C') then
			cd_intervalo_agora_w := cpoe_busca_intervalo_agora(nr_atendimento_p,ie_tipo_item_w,cd_estabelecimento_p,cd_perfil_p, nm_usuario_p, 'S');
		else
			cd_intervalo_agora_w := cpoe_busca_intervalo_agora(nr_atendimento_p,ie_tipo_item_w,cd_estabelecimento_p,cd_perfil_p, nm_usuario_p);
		end if;
	
		if (cd_intervalo_agora_w IS NOT NULL AND cd_intervalo_agora_w::text <> '') then
			cd_intervalo_w := cd_intervalo_agora_w;
			ie_urgencia_w  := '0';	
		end if;
	end if;
	
	select	coalesce(max(qt_min_intervalo),0),
			coalesce(max(ie_dose_unica_cpoe), 'N')
	into STRICT	qt_min_intervalo_w,
			ie_dose_unica_cpoe_w
	from	intervalo_prescricao
	where	cd_intervalo = cd_intervalo_w;
	
	if (coalesce(ie_prescr_alta_agora_w,'N') = 'S') and (coalesce(ie_item_alta_p,'N') = 'S')	and (ie_dose_unica_cpoe_w <> 'S') then	

		ie_urgencia_w := 0;		

		SELECT * FROM cpoe_calcular_horario_prescr(nr_atendimento_p, cd_intervalo_w, cd_material_w, clock_timestamp(), 0, qt_min_intervalo_w, nr_ocorrencia_w, ds_horarios_w, ds_horarios_aux_w, nm_usuario_p, cd_estabelecimento_p, cd_perfil_p, null) INTO STRICT nr_ocorrencia_w, ds_horarios_w, ds_horarios_aux_w;

		ds_horarios_w	:= ds_horarios_w || ds_horarios_aux_w;

		hr_prim_horario_w	:= obter_prim_dshorarios(ds_horarios_w);

		dt_inicio_w	:= to_date(to_char(clock_timestamp(),'dd/mm/yyyy ') || hr_prim_horario_w, 'dd/mm/yyyy hh24:mi');

		if (dt_inicio_w < clock_timestamp()) then
			dt_inicio_w := dt_inicio_w + 1;
		end if;
		
	elsif (ie_dose_unica_cpoe_w <> 'S') then
		ie_urgencia_w := '';		
		SELECT * FROM cpoe_atualizar_periodo_vig_ant(ds_horarios_w, hr_prim_horario_w, dt_inicio_w) INTO STRICT ds_horarios_w, hr_prim_horario_w, dt_inicio_w;
	end if;
	
	if (ie_tipo_dieta_w = 'E') then
		ie_tipo_item_w	:= '8';
	elsif (ie_tipo_dieta_w = 'O') then
		ie_tipo_item_w	:= '13';
	elsif (ie_tipo_dieta_w = 'L') then
		ie_tipo_item_w	:= '16';
	end if;	
	
	if (cd_intervalo_w IS NOT NULL AND cd_intervalo_w::text <> '') and (obter_operacao_intervalo(cd_intervalo_w) = 'D') then
		dt_inicio_w := obter_proxima_dose_medic(dt_inicio_w, cd_intervalo_w, null, 'N');
	end if;
		
	if (ie_tipo_dieta_w = 'J') then
		dt_inicio_w := trunc(dt_inicio_w,'hh24') + 1/24;
	
		hr_prim_horario_w  := substr(cpoe_obter_primeiro_horario( nr_atendimento_p, cd_intervalo_w, cd_material_w, cd_estabelecimento_p, cd_perfil_p, nm_usuario_p, cd_pessoa_fisica_p),1,5);
		
		if (hr_prim_horario_w IS NOT NULL AND hr_prim_horario_w::text <> '') then
			dt_inicio_w	:= to_date(to_char(dt_inicio_w,'dd/mm/yyyy ')  || hr_prim_horario_w, 'dd/mm/yyyy hh24:mi');				
		end if;
		
	elsif (ie_tipo_dieta_w = 'E') then
		if ((coalesce(ie_administracao_w,'P') = 'P') or (cd_intervalo_agora_w IS NOT NULL AND cd_intervalo_agora_w::text <> '')) then
			
			if (ie_dose_unica_cpoe_w = 'S') then
				ie_duracao_w := 'P';
				ie_administracao_w := 'P';
				ie_evento_unico_w := 'S';
				ie_se_necessario_w := 'N';
				ie_acm_w := 'N';
				qt_tempo_aplic_w := null;
				qt_hora_fase_w := null;
			end if;
			
			if (coalesce(ie_urgencia_w::text, '') = '') then			
				dt_inicio_w := trunc(dt_inicio_w,'hh24') + 1/24;				
				
				hr_prim_horario_w  := substr(cpoe_obter_primeiro_horario( nr_atendimento_p, cd_intervalo_w, cd_material_w, cd_estabelecimento_p, cd_perfil_p, nm_usuario_p, cd_pessoa_fisica_p),1,5);
				
				if (hr_prim_horario_w IS NOT NULL AND hr_prim_horario_w::text <> '') then
					dt_inicio_w	:= to_date(to_char(dt_inicio_w,'dd/mm/yyyy ')  || hr_prim_horario_w, 'dd/mm/yyyy hh24:mi');				
				end if;	
				
			elsif (ie_urgencia_w = '0') then
				dt_inicio_w := dt_inicio_w + 1/1440;
			elsif (ie_urgencia_w = '5') then
				dt_inicio_w := dt_inicio_w + 5/1440;
			elsif (ie_urgencia_w = '10') then
				dt_inicio_w := dt_inicio_w + 10/1440;
			elsif (ie_urgencia_w = '15') then
				dt_inicio_w := dt_inicio_w + 15/1440;
			end if;
			
			if (dt_inicio_w < clock_timestamp()) then
				dt_inicio_w := dt_inicio_w + 1;
			end if;
		
			hr_prim_horario_w := to_char(dt_inicio_w,'hh24:mi');
			
			if (ie_duracao_w = 'P') then
				dt_fim_w := (dt_inicio_w + 1) - 1/1440;
			end if;
		
			nr_ocorrencia_w := 0;
			
			ie_sol_continua_w := 'N';
			if (ie_continuo_w = 'C') then
				ie_sol_continua_w := 'S';
			end if;
			
			if (qt_tempo_pausa_w = '__:__') then
				qt_tempo_pausa_w := null;
			end if;
			
			if (ie_sol_continua_w = 'S') then	
				SELECT * FROM CPOE_Calcula_horarios_enteral(nm_usuario_p, dt_inicio_w, ie_sol_continua_w, nr_ocorrencia_w, cd_intervalo_w, obter_hora_number(qt_tempo_aplic_w), obter_hora_number(qt_tempo_aplic_w), qt_tempo_pausa_w, 'N', ie_duracao_w, dt_fim_w, 'S', nr_atendimento_p, cd_estabelecimento_p, cd_perfil_p) INTO STRICT nr_ocorrencia_w, ds_horarios_w;
			else
				if (ie_duracao_w = 'P') then
					nr_horas_validade_w := Obter_Hora_Entre_datas(dt_inicio_w,dt_fim_w);
				else
					nr_horas_validade_w := 24;
				end if;
				SELECT * FROM CPOE_Calcula_horarios_enteral(nm_usuario_p, dt_inicio_w, ie_sol_continua_w, nr_ocorrencia_w, cd_intervalo_w, nr_horas_validade_w, obter_hora_number(qt_hora_fase_w), null, 'N', ie_duracao_w, dt_fim_w, 'S', nr_atendimento_p, cd_estabelecimento_p, cd_perfil_p) INTO STRICT nr_ocorrencia_w, ds_horarios_w;
			end if;
		end if;
	elsif (ie_tipo_dieta_w in ('O','L','S')) then
		if ((coalesce(ie_administracao_w,'P') = 'P') or (cd_intervalo_agora_w IS NOT NULL AND cd_intervalo_agora_w::text <> '')) then
		
			if (ie_dose_unica_cpoe_w = 'S') then
				ie_duracao_w := 'P';
				ie_administracao_w := 'P';
				ie_evento_unico_w := 'S';
				ie_se_necessario_w := 'N';
				ie_acm_w := 'N';
				qt_tempo_aplic_w := null;
				qt_hora_fase_w := null;
			end if;
		
			if (coalesce(ie_urgencia_w::text, '') = '') then
				dt_inicio_w := trunc(dt_inicio_w,'hh24') + 1/24;
				
				hr_prim_horario_w  := substr(cpoe_obter_primeiro_horario( nr_atendimento_p, cd_intervalo_w, cd_material_w, cd_estabelecimento_p, cd_perfil_p, nm_usuario_p, cd_pessoa_fisica_p),1,5);
				
				if (hr_prim_horario_w IS NOT NULL AND hr_prim_horario_w::text <> '') then
					dt_inicio_w	:= to_date(to_char(dt_inicio_w,'dd/mm/yyyy ')  || hr_prim_horario_w, 'dd/mm/yyyy hh24:mi');				
				end if;	
				
			elsif (ie_urgencia_w = '0') then
				dt_inicio_w := dt_inicio_w + 1/1440;
			elsif (ie_urgencia_w = '5') then
				dt_inicio_w := dt_inicio_w + 5/1440;
			elsif (ie_urgencia_w = '10') then
				dt_inicio_w := dt_inicio_w + 10/1440;
			elsif (ie_urgencia_w = '15') then
				dt_inicio_w := dt_inicio_w + 15/1440;
			end if;
			
			if (dt_inicio_w < clock_timestamp()) then
				dt_inicio_w := dt_inicio_w + 1;
			end if;			
			
			hr_prim_horario_w := to_char(dt_inicio_w,'hh24:mi');

			SELECT * FROM cpoe_calcular_horario_prescr(	nr_atendimento_p, cd_intervalo_w, null, dt_inicio_w, 0, qt_min_intervalo_w, nr_ocorrencia_w, ds_horarios_w, ds_horarios_aux_w, nm_usuario_p, cd_estabelecimento_p, cd_perfil_p, null) INTO STRICT nr_ocorrencia_w, ds_horarios_w, ds_horarios_aux_w;
			ds_horarios_w	:= ds_horarios_w || ds_horarios_aux_w;

			if (coalesce(ds_horarios_w::text, '') = '') then
				ds_horarios_w := hr_prim_horario_w;
			end if;
		end if;
	end if;

	if (ie_duracao_w = 'P') then
		dt_fim_w := (dt_inicio_w + 1) - 1/1440;
	end if;
	
	if (ie_retrogrado_p = 'S' or ie_futuro_p = 'S') then -- retrograde/backward item
		dt_inicio_w := dt_inicio_p;
		dt_fim_w := (dt_inicio_w + 1) - 1/1440;
		ie_duracao_w := 'P';
		ie_urgencia_w := null;
		nr_ocorrencia_w 	:= 0;
		ds_horarios_w 		:= '';
		ds_horarios_aux_w 	:= '';
		hr_prim_horario_w := to_char(dt_inicio_w,'hh24:mi');
		
		if (ie_tipo_dieta_w = 'E') then
			SELECT * FROM CPOE_Calcula_horarios_enteral(nm_usuario_p, dt_inicio_w, ie_sol_continua_w, nr_ocorrencia_w, cd_intervalo_w, nr_horas_validade_w, obter_hora_number(qt_hora_fase_w), null, 'N', ie_duracao_w, dt_fim_w, 'S', nr_atendimento_p, cd_estabelecimento_p, cd_perfil_p) INTO STRICT nr_ocorrencia_w, ds_horarios_w;
		elsif (ie_tipo_dieta_w in ('O','L','S')) then
			SELECT * FROM cpoe_calcular_horario_prescr(	nr_atendimento_p, cd_intervalo_w, null, dt_inicio_w, 0, qt_min_intervalo_w, nr_ocorrencia_w, ds_horarios_w, ds_horarios_aux_w, nm_usuario_p, cd_estabelecimento_p, cd_perfil_p, null) INTO STRICT nr_ocorrencia_w, ds_horarios_w, ds_horarios_aux_w;
			ds_horarios_w	:= ds_horarios_w || ds_horarios_aux_w;
		end if;
	end if;
	
	select	nextval('cpoe_dieta_seq')
	into STRICT	nr_sequencia_w
	;
	
	ds_horarios_w := padroniza_horario_prescr(ds_horarios_w,dt_inicio_w);

	insert into cpoe_dieta(
				nr_sequencia,
				nr_atendimento,
				nm_usuario,
				dt_atualizacao,
				nm_usuario_nrec,
				dt_atualizacao_nrec,
				dt_inicio,
				dt_evento,
				dt_fim,
				ds_horarios,
				hr_prim_horario,
				cd_dieta,
				cd_intervalo,
				cd_material,
				cd_mat_prod1,
				cd_mat_prod2,
				cd_mat_prod3,
				cd_mat_prod4,
				cd_mat_prod5,
				cd_mat_prod_adic1,
				cd_mat_prod_adic2,
				cd_mat_prod_adic3,
				cd_mat_prod_adic4,
				cd_mat_prod_adic5,
				cd_mat_prod_adic6,
				cd_mat_dil,
				cd_unidade_medida_dose,
				cd_unid_med_prod1,
				cd_unid_med_prod2,
				cd_unid_med_prod3,
				cd_unid_med_prod4,
				cd_unid_med_prod5,
				cd_unid_med_prod_adic1,
				cd_unid_med_prod_adic2,
				cd_unid_med_prod_adic3,
				cd_unid_med_prod_adic4,
				cd_unid_med_prod_adic5,
				cd_unid_med_prod_adic6,
				cd_unid_med_dose_dil,
				ds_dose_diferenciada,
				ds_evento,
				ie_acm,
				ie_administracao,
				ie_aplic_bolus,
				ie_bomba_infusao,
				ie_continuo,
				ie_dose_unica,
				ie_duracao,
				ie_evento_unico,
				ie_inicio,
				ie_jejum,
				ie_jejum_antes,
				ie_jejum_depois,
				ie_leite_materno,
				ie_opcao_antes,
				ie_opcao_depois,
				ie_referencia,
				ie_se_necessario,
				ie_tipo_dieta,
				ie_tipo_dosagem,
				ie_urgencia,
				ie_via_aplicacao,
				ie_via_leite1,
				ie_via_leite2,
				ie_via_leite3,
				ie_via_leite4,
				ie_via_leite5,
				nr_etapas,
				nr_ocorrencia,
				nr_seq_disp_succao,
				nr_seq_objetivo,
				nr_seq_tipo,
				nr_seq_via_acesso,
				qt_dose,
				qt_dose_prod1,
				qt_dose_prod2,
				qt_dose_prod3,
				qt_dose_prod4,
				qt_dose_prod5,
				qt_dose_prod_adic1,
				qt_dose_prod_adic2,
				qt_dose_prod_adic3,
				qt_dose_prod_adic4,
				qt_dose_prod_adic5,
				qt_dose_prod_adic6,
				qt_porcentagem_adic1,
				qt_porcentagem_adic2,
				qt_porcentagem_adic3,
				qt_porcentagem_adic4,
				qt_porcentagem_adic5,
				qt_porcentagem_adic6,
				qt_dose_dil,
				qt_hora_ant,
				qt_hora_aplicacao,
				qt_hora_depois,
				qt_min_ant,
				qt_min_depois,
				qt_parametro,
				qt_tempo_aplic,
				qt_tempo_pausa,
				qt_hora_fase,
				qt_tempo_ref,
				qt_vel_infusao,
				qt_volume,
				qt_volume_total,
				cd_perfil_ativo,
				ds_orientacao,
				cd_pessoa_fisica,
				cd_funcao_origem,
				nr_seq_transcricao,
				ie_item_alta,
				ie_prescritor_aux,
				cd_medico,
				ie_retrogrado,
				nr_seq_pepo,
				nr_cirurgia,
				nr_cirurgia_patologia,
				nr_seq_agenda,
				nr_seq_solubilidade,
				nr_seq_temperatura,
				nr_seq_conclusao_apae,
				ie_futuro,
				nr_seq_cpoe_order_unit)
			values (
				nr_sequencia_w,
				nr_atendimento_p,
				nm_usuario_p,
				clock_timestamp(),
				nm_usuario_p,
				clock_timestamp(),
				dt_inicio_w,
				dt_evento_w,
				dt_fim_w,
				ds_horarios_w,
				hr_prim_horario_w,
				cd_dieta_w,
				cd_intervalo_w,
				cd_material_w,
				cd_mat_prod1_w,
				cd_mat_prod2_w,
				cd_mat_prod3_w,
				cd_mat_prod4_w,
				cd_mat_prod5_w,
				cd_mat_prod_adic1_w,
				cd_mat_prod_adic2_w,
				cd_mat_prod_adic3_w,
				cd_mat_prod_adic4_w,
				cd_mat_prod_adic5_w,
				cd_mat_prod_adic6_w,
				cd_mat_dil_w,
				cd_unidade_medida_dose_w,
				cd_unid_med_prod1_w,
				cd_unid_med_prod2_w,
				cd_unid_med_prod3_w,
				cd_unid_med_prod4_w,
				cd_unid_med_prod5_w,
				cd_unid_med_prod_adic1_w,
				cd_unid_med_prod_adic2_w,
				cd_unid_med_prod_adic3_w,
				cd_unid_med_prod_adic4_w,
				cd_unid_med_prod_adic5_w,
				cd_unid_med_prod_adic6_w,
				cd_unid_med_dose_dil_w,
				ds_dose_diferenciada_w,
				ds_evento_w,
				ie_acm_w,
				ie_administracao_w,
				ie_aplic_bolus_w,
				ie_bomba_infusao_w,
				ie_continuo_w,
				ie_dose_unica_w,
				ie_duracao_w,
				ie_evento_unico_w,
				ie_inicio_w,
				ie_jejum_w,
				ie_jejum_antes_w,
				ie_jejum_depois_w,
				ie_leite_materno_w,
				ie_opcao_antes_w,
				ie_opcao_depois_w,
				ie_referencia_w,
				ie_se_necessario_w,
				ie_tipo_dieta_w,
				ie_tipo_dosagem_w,
				ie_urgencia_w,
				ie_via_aplicacao_w,
				ie_via_leite1_w,
				ie_via_leite2_w,
				ie_via_leite3_w,
				ie_via_leite4_w,
				ie_via_leite5_w,
				nr_etapas_w,
				nr_ocorrencia_w,
				nr_seq_disp_succao_w,
				nr_seq_objetivo_w,
				nr_seq_tipo_w,
				nr_seq_via_acesso_w,
				qt_dose_w,
				qt_dose_prod1_w,
				qt_dose_prod2_w,
				qt_dose_prod3_w,
				qt_dose_prod4_w,
				qt_dose_prod5_w,
				qt_dose_prod_adic1_w,
				qt_dose_prod_adic2_w,
				qt_dose_prod_adic3_w,
				qt_dose_prod_adic4_w,
				qt_dose_prod_adic5_w,
				qt_dose_prod_adic6_w,
				qt_porcentagem_adic1_w,
				qt_porcentagem_adic2_w,
				qt_porcentagem_adic3_w,
				qt_porcentagem_adic4_w,
				qt_porcentagem_adic5_w,
				qt_porcentagem_adic6_w,
				qt_dose_dil_w,
				qt_hora_ant_w,
				qt_hora_aplicacao_w,
				qt_hora_depois_w,
				qt_min_ant_w,
				qt_min_depois_w,
				qt_parametro_w,
				qt_tempo_aplic_w,
				qt_tempo_pausa_w,
				qt_hora_fase_w,
				qt_tempo_ref_w,
				qt_vel_infusao_w,
				qt_volume_w,
				qt_volume_total_w,
				cd_perfil_p,
				ds_orientacao_w,
				cd_pessoa_fisica_p,
				2314,
				nr_seq_transcricao_p,
				ie_item_alta_p,
				ie_prescritor_aux_p,
				cd_medico_p,
				ie_retrogrado_p,
				nr_seq_pepo_p,
				nr_cirurgia_p,
				nr_cirurgia_patologia_p,
				nr_seq_agenda_p,
				nr_seq_solubilidade_w,
				nr_seq_temperatura_w,
				nr_seq_conclusao_apae_p,
				ie_futuro_p,
				nr_seq_cpoe_order_unit_p);
				
	commit;
	
    nr_seq_item_gerado_p := nr_sequencia_w;

	end;
end loop;
close c01;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE cpoe_inserir_dieta_fav (( nr_atendimento_p cpoe_dieta.nr_atendimento%type, nr_sequencia_p cpoe_fav_dieta.nr_sequencia%type, nm_usuario_p cpoe_fav_dieta.nm_usuario%type, cd_perfil_p bigint, cd_estabelecimento_p bigint, cd_pessoa_fisica_p cpoe_dieta.cd_pessoa_fisica%type, nr_seq_item_gerado_p out bigint, nr_seq_transcricao_p bigint default null, ie_item_alta_p text default 'N', ie_prescritor_aux_p text default 'N', cd_medico_p bigint default null, ie_retrogrado_p text default 'N', dt_inicio_p timestamp default null, nr_seq_pepo_p bigint default null, nr_cirurgia_p bigint default null, nr_cirurgia_patologia_p bigint default null, nr_seq_agenda_p bigint default null, nr_seq_conclusao_apae_p bigint default null, ie_futuro_p text default 'N', nr_seq_cpoe_rp_p cpoe_rp.nr_sequencia%type default null, nr_seq_cpoe_order_unit_p cpoe_order_unit.nr_sequencia%type default null) is cd_dieta_w cpoe_dieta.cd_dieta%type) FROM PUBLIC;

