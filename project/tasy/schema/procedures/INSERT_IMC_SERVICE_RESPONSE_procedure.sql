-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE insert_imc_service_response ( nr_seq_transaction_p imc_response.cd_transaction%type, dt_service_p imc_service_response.dt_service%type, vl_fund_benefit_p imc_service_response.vl_fund_benefit%type, cd_item_p imc_service_response.cd_item%type, vl_med_amount_p imc_service_response.vl_med_amount%type, cd_med_exp_p imc_service_response.cd_med_exp%type, vl_schedule_fee_p imc_service_response.vl_schedule_fee%type, cd_service_fund_p imc_service_response.cd_service_fund%type, cd_service_p imc_service_response.cd_service%type, ie_service_type_p imc_service_response.ie_service_type%type, vl_charge_p imc_service_response.vl_charge%type, nm_usuario_p imc_service_response.nm_usuario%type) AS $body$
DECLARE

										
nr_seq_response_w		imc_response.nr_Sequencia%type;
nr_seq_w				imc_service_response.nr_Sequencia%type;


BEGIN


select	max(nr_Sequencia)
into STRICT 	nr_seq_response_w
from	imc_response
where	cd_transaction = nr_seq_transaction_p;


select	nextval('imc_service_response_seq')
into STRICT	nr_seq_w
;

insert into imc_service_response(
									nr_seq_response,
									nr_sequencia,
									nm_usuario,
									dt_atualizacao,
									dt_service,
									vl_fund_benefit,
									cd_item,
									vl_med_amount,
									cd_med_exp,
									vl_schedule_fee,
									cd_service_fund,
									cd_service,
									nm_usuario_nrec,
									dt_atualizacao_nrec,
									ie_service_type,
									vl_charge)
						values (							
									nr_seq_response_w,
									nr_seq_w,
									nm_usuario_p,
									clock_timestamp(),
									dt_service_p,
									vl_fund_benefit_p,
									cd_item_p,
									vl_med_amount_p,
									cd_med_exp_p,
									vl_schedule_fee_p,
									cd_service_fund_p,
									cd_service_p,
									nm_usuario_p,
									clock_timestamp(),
									ie_service_type_p,
									vl_charge_p);

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE insert_imc_service_response ( nr_seq_transaction_p imc_response.cd_transaction%type, dt_service_p imc_service_response.dt_service%type, vl_fund_benefit_p imc_service_response.vl_fund_benefit%type, cd_item_p imc_service_response.cd_item%type, vl_med_amount_p imc_service_response.vl_med_amount%type, cd_med_exp_p imc_service_response.cd_med_exp%type, vl_schedule_fee_p imc_service_response.vl_schedule_fee%type, cd_service_fund_p imc_service_response.cd_service_fund%type, cd_service_p imc_service_response.cd_service%type, ie_service_type_p imc_service_response.ie_service_type%type, vl_charge_p imc_service_response.vl_charge%type, nm_usuario_p imc_service_response.nm_usuario%type) FROM PUBLIC;

