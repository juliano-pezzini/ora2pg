-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE nicu_del_check_if_not_answer ( nm_usuario_p text) AS $body$
DECLARE


nr_seq_checklist_w	nicu_checklist.nr_sequencia%type;

BEGIN

select 	max(nr_sequencia)
into STRICT		nr_seq_checklist_w
from 	nicu_checklist a
where 	nm_usuario = nm_usuario_p
and not exists (
    SELECT b.nr_sequencia
    from nicu_checklist_answer b
    where b.nr_seq_checklist = a.nr_sequencia
);

if (coalesce(nr_seq_checklist_w, 0) <> 0) then
	begin
		
		delete from nicu_checklist
		where nr_sequencia = nr_seq_checklist_w;
		commit;
	
	end;
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE nicu_del_check_if_not_answer ( nm_usuario_p text) FROM PUBLIC;

