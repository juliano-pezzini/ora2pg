-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE excluir_relatorio_dinamico (nr_seq_relatorio_p relatorio_dinamico.nr_seq_relatorio%type) AS $body$
DECLARE


  contador_w relatorio_dinamico.nr_sequencia%type;


BEGIN
  IF (nr_seq_relatorio_p IS NOT NULL AND nr_seq_relatorio_p::text <> '') THEN
    BEGIN
      SELECT count(1)
        INTO STRICT contador_w
        FROM relatorio_dinamico a
       WHERE a.nr_seq_relatorio = nr_seq_relatorio_p
         AND a.nr_tipo_banda = 2;
    EXCEPTION WHEN no_data_found THEN
      contador_w := 0;
    END;

    IF contador_w = 0 THEN
      BEGIN
        DELETE FROM parametro_relat_dinamico p
         WHERE p.nr_seq_relatorio = nr_seq_relatorio_p;
      EXCEPTION WHEN no_data_found THEN
        NULL;
      END;
      COMMIT;
    END IF;

  END IF;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE excluir_relatorio_dinamico (nr_seq_relatorio_p relatorio_dinamico.nr_seq_relatorio%type) FROM PUBLIC;

