-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE intpd_recebe_pessoa_juridica ( nr_sequencia_p bigint, xml_p xml) AS $body$
DECLARE



_ora2pg_r RECORD;
ie_conversao_w		intpd_eventos_sistema.ie_conversao%type;
nr_seq_projeto_xml_w	intpd_eventos_sistema.nr_seq_projeto_xml%type;
nr_seq_sistema_w		intpd_eventos_sistema.nr_seq_sistema%type;
ie_sistema_externo_w	varchar(15);
reg_integracao_w		gerar_int_padrao.reg_integracao_conv;
nr_seq_regra_w		conversao_meio_externo.nr_seq_regra%type;
ds_erro_w		varchar(4000);
i			integer;
cd_pk_w			pessoa_juridica.cd_sistema_ant%type;

pessoa_juridica_w	pessoa_juridica%rowtype;
pessoa_juridica_estab_w	pessoa_juridica_estab%rowtype;
pessoa_juridica_compl_w	pessoa_juridica_compl%rowtype;
pessoa_juridica_conta_w	pessoa_juridica_conta%rowtype;
pessoa_jur_resp_w	pessoa_jur_resp%rowtype;

qt_ant_w		bigint;
ie_atualizou_w		varchar(1) := 'N';

c01 CURSOR FOR
SELECT	*
from	xmltable('/STRUCTURE/LEGALENTITY' passing xml_p columns
	ie_action			varchar(15)		path		'IE_ACTION',
	cd_ans				varchar(20)		path		'anscode',
	cd_cep				varchar(15)		path		'zipcode',
	cd_cgc				varchar(14)		path		'gtr',
	cd_cgc_mantenedora		varchar(14)		path		'maintainer',
	cd_cnes				varchar(20)		path		'cnes',
	cd_cnpj_raiz			varchar(8)		path		'gtrorigin',
	cd_cond_pagto			varchar(40)		path		'paymentcondition',
	cd_conta_contabil		varchar(20)		path		'account',
	cd_curp				varchar(18)		path		'curp',
	cd_cvm				varchar(40)		path		'cvm',
	cd_internacional		varchar(20)		path		'internationalcode',
	cd_municipio_ibge		varchar(6)		path		'ibge',
	cd_operadora_empresa		varchar(40)		path		'company',
	cd_pf_resp_tecnico		varchar(10)		path		'resptech',
	cd_portador			varchar(40)		path		'carrier',
	cd_referencia_fornec		varchar(20)		path		'supplierreference',
	cd_rfc				varchar(13)		path		'rfc',
	cd_sistema_ant			varchar(20)		path		'oldsystem',
	cd_tipo_pessoa			varchar(40)		path		'entitytype',
	cd_tipo_portador		varchar(40)		path		'carriertype',
	ds_bairro			varchar(40)		path		'neighborhood',
	ds_complemento			varchar(255)		path		'complement',
	ds_email			varchar(60)		path		'email',
	ds_endereco			varchar(40)		path		'address',
	ds_municipio			varchar(40)		path		'municipality',
	ds_nome_abrev			varchar(18)		path		'abreviation',
	ds_observacao			varchar(4000)		path		'observation',
	ds_observacao_compl		varchar(4000)		path		'complobservation',
	ds_orgao_reg_resp_tecnico	varchar(10)		path		'recordentityresp',
	ds_orientacao_cobranca		varchar(4000)		path		'chargingorientation',
	ds_razao_social			varchar(255)		path		'social',
	ds_resp_tecnico			varchar(255)		path		'resptechname',
	ds_senha			varchar(20)		path		'password',
	ds_site_internet		varchar(255)		path		'site',
	dt_criacao			varchar(40)		path		'creation',
	dt_integracao			varchar(40)		path		'integration',
	dt_integracao_externa		varchar(40)		path		'externalint',
	dt_ultima_revisao		varchar(40)		path		'lastrevision',
	dt_validade_alvara_munic	varchar(40)		path		'municipalsanitaryvalidity',
	dt_validade_alvara_sanit	varchar(40)		path		'sanitaryvalidity',
	dt_validade_autor_func		varchar(40)		path		'autorvalidity',
	dt_validade_cert_boas_prat	varchar(40)		path		'certificatevalidity',
	dt_validade_resp_tecnico	varchar(40)		path		'resptechvalidity',
	ie_alterar_senha		varchar(1)		path		'changepassword',
	ie_empreendedor_individual	varchar(15)		path		'individualentrepreneur',
	ie_forma_revisao		varchar(15)		path		'revisionmethod',
	ie_fornecedor_opme		varchar(15)		path		'opmesupplier',
	ie_prod_fabric			varchar(3)		path		'prodmanuf',
	ie_qualidade			varchar(3)		path		'quality',
	ie_situacao			varchar(1)		path		'situation',
	ie_status_envio			varchar(15)		path		'senderstarus',
	ie_status_exportar		varchar(1)		path		'expstatus',
	ie_tipo_trib_municipal		varchar(2)		path		'municipalitytasxtype',
	ie_tipo_tributacao		varchar(15)		path		'taxtype',
	ie_transporte			varchar(1)		path		'transportation',
	nm_fantasia			varchar(80)		path		'commercialname',
	nm_pessoa_contato		varchar(255)		path		'contactname',
	nm_usuario_revisao		varchar(15)		path		'revisionuser',
	nr_alvara_sanitario		varchar(20)		path		'authorization',
	nr_alvara_sanitario_munic	varchar(20)		path		'municipalityauthorization',
	nr_autor_func			varchar(30)		path		'runningauthorization',
	nr_ccm				varchar(40)		path		'ccm',
	nr_cei				varchar(50)		path		'ceo',
	nr_certificado_boas_prat	varchar(20)		path		'certgoodpractices',
	nr_ddd_fax			varchar(3)		path		'faxddd',
	nr_ddd_telefone			varchar(3)		path		'phoneddd',
	nr_ddi_fax			varchar(3)		path		'faxddi',
	nr_ddi_telefone			varchar(3)		path		'phoneddi',
	nr_endereco			varchar(10)		path		'addressnumber',
	nr_fax				varchar(15)		path		'fax',
	nr_inscricao_estadual		varchar(20)		path		'stateregistration',
	nr_inscricao_municipal		varchar(20)		path		'municipalityregistration',
	nr_matricula_cei		varchar(15)		path		'ceiregistration',
	nr_ramal_contato		integer		path		'branchnumber',
	nr_registro_pls			varchar(20)		path		'opsregistration',
	nr_registro_resp_tecnico	varchar(20)		path		'resptechregistration',
	nr_seq_idioma			varchar(15)		path		'language',
	nr_seq_pais			varchar(5)		path		'country',
	nr_telefone			varchar(15)		path		'phone',
	qt_dia_prazo_entrega		smallint		path		'paymentterm',
	sg_estado			varchar(15)		path		'state',
	vl_minimo_nf			double precision		path		'minimuminvoicevalue',
	nr_seq_tipo_logradouro		bigint		path		'seqpatio',	
	xml_establishments		xml			path		'ESTABLISHMENTS',
	xml_complements			xml			path		'COMPLEMENTS',
	xml_accounts			xml			path		'ACCOUNTS',
	xml_responsibles		xml			path		'RESPONSIBLES');
	
c01_w	c01%rowtype;
	
c02 CURSOR FOR
SELECT	*
from	xmltable('/ESTABLISHMENTS/ESTABLISHMENT' passing c01_w.xml_establishments columns
	ie_action			varchar(15)		path		'IE_ACTION',
	cd_cond_pagto			varchar(40)		path		'paymentcondition',
	cd_estabelecimento		varchar(40)		path		'establishment',
	cd_interno_lab			varchar(20)		path		'internallaboratory',
	cd_operacao_nf			varchar(40)		path		'invoiceoperation',
	cd_portador			varchar(40)		path		'carrier',
	cd_referencia_fornec		varchar(20)		path		'supplierreference',
	cd_sistema_ant			varchar(255)		path		'olsystem',
	cd_tipo_baixa			varchar(40)		path		'settlementtype',
	cd_tipo_portador		varchar(40)		path		'carriertype',
	ds_email			varchar(255)		path		'email',
	ie_baixa_abat			varchar(1)		path		'settlediscount',
	ie_consiste_nr_serie_nf		varchar(1)		path		'validateinvoice',
	ie_conta_dif_nf			varchar(1)		path		'additionalaccount',
	ie_endereco_correspondencia	smallint		path		'correspondenceaddress',
	ie_exige_anexo_nf		varchar(15)		path		'invoiceattachment',
	ie_exige_ordem_compra		varchar(1)		path		'purchaseorder',
	ie_forma_pagto			varchar(15)		path		'paymentmethod',
	ie_frete			varchar(1)		path		'freight',
	ie_moeda_estrangeira		varchar(1)		path		'foreigncurrency',
	ie_qualidade			varchar(6)		path		'quality',
	ie_rateio_adiant		varchar(2)		path		'advanceassessment',
	ie_rec_email_comercial		varchar(1)		path		'receivecommercialemail',
	ie_retem_iss			varchar(1)		path		'retainiss',
	ie_status_apenado		varchar(15)		path		'penalitystatus',
	nm_pessoa_contato		varchar(255)		path		'contactperson',
	nr_codigo_serv_prest		varchar(10)		path		'carriedservice',
	nr_ramal_contato		integer		path		'contactbranch',
	pr_desc_financeiro		double precision		path		'discountpercentage',
	qt_dia_prazo_entrega		smallint		path		'deliverytime',
	tx_desc_antecipacao		double precision		path		'anticipationdiscount',
	tx_desc_assiduidade		double precision		path		'attendancediscount',
	tx_desc_ordem			double precision		path		'orderdiscount',
	vl_minimo_nf			double precision		path		'minimumyninvoice');
	
c02_w	c02%rowtype;

c03 CURSOR FOR
SELECT	*
from	xmltable('/COMPLEMENTS/COMPLEMENT' passing c01_w.xml_complements columns
	ie_action			varchar(15)		path		'IE_ACTION',
	cd_cbo_red			varchar(40)		path		'cboposition',
	cd_cep				varchar(15)		path		'zipcode',
	cd_municipio_ibge		varchar(6)		path		'cd_municipality',
	cd_pessoa_fisica_canal		varchar(10)		path		'channelperson',
	ds_bairro			varchar(40)		path		'neighborhood',
	ds_cargo			varchar(255)		path		'role',
	ds_complemento			varchar(100)		path		'complement',
	ds_email			varchar(80)		path		'email',
	ds_endereco			varchar(60)		path		'address',
	ds_identific_complemento	varchar(255)		path		'addressidentification',
	ds_municipio			varchar(40)		path		'ds_municipality',
	ds_observacao			varchar(2000)		path		'observation',
	ds_setor_contato		varchar(255)		path		'contactsector',
	ie_contato_ref			varchar(1)		path		'referentialcontact',
	ie_gerente_canal		varchar(1)		path		'channelmanager',
	ie_participa_eventos		varchar(1)		path		'eventparticipant',
	ie_plc_customer_sponsor		varchar(1)		path		'customersponsor',
	ie_plc_plataform_manager	varchar(1)		path		'plataformmanager',
	ie_pls				varchar(1)		path		'ops',
	ie_recebe_prop			varchar(1)		path		'receivepropose',
	ie_tipo_complemento		smallint		path		'complementtype',
	nm_pessoa_contato		varchar(40)		path		'contactperson',
	nr_ddd_telefone			varchar(3)		path		'phoneddd',
	nr_endereco			varchar(10)		path		'addressnumber',
	nr_fax				varchar(15)		path		'fax',
	nr_ramal_contato		integer		path		'contactbranch',
	nr_telefone			varchar(15)		path		'phone',
	nr_telefone_celular		varchar(20)		path		'cellphone',
	sg_estado			varchar(15)		path		'state');
	
c03_w	c03%rowtype;

c04 CURSOR FOR
SELECT	*
from	xmltable('/ACCOUNTS/ACCOUNT' passing c01_w.xml_accounts columns
	ie_action			varchar(15)		path		'IE_ACTION',
	cd_agencia_bancaria		varchar(8)		path		'bankagency',
	cd_banco			varchar(40)		path		'bank',
	cd_camara_compensacao		varchar(40)		path		'compensationchamber',
	cd_codigo_identificacao		varchar(20)		path		'identifier',
	ds_observacao			varchar(255)		path		'observation',
	ie_conta_pagamento		varchar(1)		path		'paymentaccount',
	ie_conta_repasse		varchar(1)		path		'discussesaccount',
	ie_digito_agencia		varchar(2)		path		'agencydigit',
	ie_prestador_pls		varchar(1)		path		'opssupplier',
	ie_propriedade_conta		varchar(3)		path		'accountproperty',
	ie_situacao			varchar(1)		path		'situation',
	ie_tipo_conta			varchar(3)		path		'accounttype',
	nr_conta			varchar(20)		path		'accountnumber',
	nr_digito_conta			varchar(2)		path		'accountdigit');
	
c04_w	c04%rowtype;

c05 CURSOR FOR
SELECT	*
from	xmltable('/RESPONSIBLES/RESPONSIBLE' passing c01_w.xml_responsibles columns
	ie_action			varchar(15)		path		'IE_ACTION',
	cd_cargo			varchar(40)		path		'position',
	cd_pessoa_fisica		varchar(10)		path		'person',
	ie_avaliacao_fornecedor		varchar(15)		path		'supplierevaluation',
	ie_representante_legal		varchar(1)		path		'legalrepresentant',
	ie_resp_cadastro		varchar(1)		path		'resprecord');
		
c05_w	c05%rowtype;
	

BEGIN

update	intpd_fila_transmissao
set	ie_status = 'R'
where	nr_sequencia = nr_sequencia_p;

commit;

begin
select	coalesce(b.ie_conversao,'I'),
	nr_seq_sistema,
	nr_seq_projeto_xml,
	nr_seq_regra_conv
into STRICT	ie_conversao_w,
	nr_seq_sistema_w,
	nr_seq_projeto_xml_w,
	nr_seq_regra_w
from	intpd_fila_transmissao a,
	intpd_eventos_sistema b
where	a.nr_seq_evento_sistema = b.nr_sequencia
and	a.nr_sequencia = nr_sequencia_p;

ie_sistema_externo_w	:=	nr_seq_sistema_w;

reg_integracao_w.nr_seq_fila_transmissao	:=	nr_sequencia_p;
reg_integracao_w.ie_envio_recebe		:=	'R';
reg_integracao_w.ie_sistema_externo		:=	ie_sistema_externo_w;
reg_integracao_w.ie_conversao			:=	ie_conversao_w;
reg_integracao_w.nr_seq_projeto_xml		:=	nr_seq_projeto_xml_w;
reg_integracao_w.nr_seq_regra_conversao		:=	nr_seq_regra_w;
reg_integracao_w.intpd_log_receb.delete;
reg_integracao_w.qt_reg_log			:=	0;

open c01;
loop
fetch c01 into	
	c01_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
	begin	
	reg_integracao_w.nm_tabela		:=	'PESSOA_JURIDICA';
	reg_integracao_w.nm_elemento		:=	'LEGALENTITY';
	reg_integracao_w.nr_seq_visao		:=	0;
	
	if (coalesce(c01_w.ie_action,'INSERT') <> 'DELETE') THEN
		
		if (upper(coalesce(c01_w.ie_action,'INSERT')) = 'UPDATE') and (c01_w.cd_cgc IS NOT NULL AND c01_w.cd_cgc::text <> '') then
			begin
			/*'Busca o registro atual do Tasy pela PK'
			Esse tratamento foi necessario porque quando e update, o sistema externo so envia as informacoes alteradas e o restante dos campos eles mandam vazio. Entao temos que buscar a informacao que ja esta gravada na tabela.*/
			select  *
			into STRICT  pessoa_juridica_w
			from  pessoa_juridica
			where   cd_cgc = c01_w.cd_cgc;
			exception
			when others then
				null;
			end;
		end if;

		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_ANS', c01_w.CD_ANS, 'N', pessoa_juridica_w.CD_ANS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_ANS := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CEP', c01_w.CD_CEP, 'N', pessoa_juridica_w.CD_CEP) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_CEP := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CGC', c01_w.CD_CGC, 'N', pessoa_juridica_w.CD_CGC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_CGC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CGC_MANTENEDORA', c01_w.CD_CGC_MANTENEDORA, 'N', pessoa_juridica_w.CD_CGC_MANTENEDORA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_CGC_MANTENEDORA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CNES', c01_w.CD_CNES, 'N', pessoa_juridica_w.CD_CNES) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_CNES := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CNPJ_RAIZ', c01_w.CD_CNPJ_RAIZ, 'N', pessoa_juridica_w.CD_CNPJ_RAIZ) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_CNPJ_RAIZ := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_COND_PAGTO', c01_w.CD_COND_PAGTO, 'SS', pessoa_juridica_w.CD_COND_PAGTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_COND_PAGTO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CONTA_CONTABIL', c01_w.CD_CONTA_CONTABIL, 'S', pessoa_juridica_w.CD_CONTA_CONTABIL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_CONTA_CONTABIL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CURP', c01_w.CD_CURP, 'N', pessoa_juridica_w.CD_CURP) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_CURP := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CVM', c01_w.CD_CVM, 'N', pessoa_juridica_w.CD_CVM) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_CVM := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_INTERNACIONAL', c01_w.CD_INTERNACIONAL, 'N', pessoa_juridica_w.CD_INTERNACIONAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_INTERNACIONAL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_MUNICIPIO_IBGE', c01_w.CD_MUNICIPIO_IBGE, 'S', pessoa_juridica_w.CD_MUNICIPIO_IBGE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_MUNICIPIO_IBGE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_OPERADORA_EMPRESA', c01_w.CD_OPERADORA_EMPRESA, 'N', pessoa_juridica_w.CD_OPERADORA_EMPRESA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_OPERADORA_EMPRESA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PF_RESP_TECNICO', c01_w.CD_PF_RESP_TECNICO, 'S', pessoa_juridica_w.CD_PF_RESP_TECNICO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_PF_RESP_TECNICO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PORTADOR', c01_w.CD_PORTADOR, 'N', pessoa_juridica_w.CD_PORTADOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_PORTADOR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_REFERENCIA_FORNEC', c01_w.CD_REFERENCIA_FORNEC, 'N', pessoa_juridica_w.CD_REFERENCIA_FORNEC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_REFERENCIA_FORNEC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_RFC', c01_w.CD_RFC, 'N', pessoa_juridica_w.CD_RFC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_RFC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_SISTEMA_ANT', c01_w.CD_SISTEMA_ANT, 'N', pessoa_juridica_w.CD_SISTEMA_ANT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_SISTEMA_ANT := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_TIPO_PESSOA', c01_w.CD_TIPO_PESSOA, 'S', pessoa_juridica_w.CD_TIPO_PESSOA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_TIPO_PESSOA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_TIPO_PORTADOR', c01_w.CD_TIPO_PORTADOR, 'N', pessoa_juridica_w.CD_TIPO_PORTADOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.CD_TIPO_PORTADOR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_BAIRRO', c01_w.DS_BAIRRO, 'N', pessoa_juridica_w.DS_BAIRRO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_BAIRRO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_COMPLEMENTO', c01_w.DS_COMPLEMENTO, 'N', pessoa_juridica_w.DS_COMPLEMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_COMPLEMENTO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_EMAIL', c01_w.DS_EMAIL, 'N', pessoa_juridica_w.DS_EMAIL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_EMAIL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_ENDERECO', c01_w.DS_ENDERECO, 'N', pessoa_juridica_w.DS_ENDERECO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_ENDERECO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_MUNICIPIO', c01_w.DS_MUNICIPIO, 'N', pessoa_juridica_w.DS_MUNICIPIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_MUNICIPIO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_NOME_ABREV', c01_w.DS_NOME_ABREV, 'N', pessoa_juridica_w.DS_NOME_ABREV) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_NOME_ABREV := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_OBSERVACAO', c01_w.DS_OBSERVACAO, 'N', pessoa_juridica_w.DS_OBSERVACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_OBSERVACAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_OBSERVACAO_COMPL', c01_w.DS_OBSERVACAO_COMPL, 'N', pessoa_juridica_w.DS_OBSERVACAO_COMPL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_OBSERVACAO_COMPL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_ORGAO_REG_RESP_TECNICO', c01_w.DS_ORGAO_REG_RESP_TECNICO, 'N', pessoa_juridica_w.DS_ORGAO_REG_RESP_TECNICO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_ORGAO_REG_RESP_TECNICO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_ORIENTACAO_COBRANCA', c01_w.DS_ORIENTACAO_COBRANCA, 'N', pessoa_juridica_w.DS_ORIENTACAO_COBRANCA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_ORIENTACAO_COBRANCA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_RAZAO_SOCIAL', c01_w.DS_RAZAO_SOCIAL, 'N', pessoa_juridica_w.DS_RAZAO_SOCIAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_RAZAO_SOCIAL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_RESP_TECNICO', c01_w.DS_RESP_TECNICO, 'N', pessoa_juridica_w.DS_RESP_TECNICO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_RESP_TECNICO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_SENHA', c01_w.DS_SENHA, 'N', pessoa_juridica_w.DS_SENHA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_SENHA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_SITE_INTERNET', c01_w.DS_SITE_INTERNET, 'N', pessoa_juridica_w.DS_SITE_INTERNET) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DS_SITE_INTERNET := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_CRIACAO', c01_w.DT_CRIACAO, 'N', pessoa_juridica_w.DT_CRIACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DT_CRIACAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_INTEGRACAO', c01_w.DT_INTEGRACAO, 'N', pessoa_juridica_w.DT_INTEGRACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DT_INTEGRACAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_INTEGRACAO_EXTERNA', c01_w.DT_INTEGRACAO_EXTERNA, 'N', pessoa_juridica_w.DT_INTEGRACAO_EXTERNA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DT_INTEGRACAO_EXTERNA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_ULTIMA_REVISAO', c01_w.DT_ULTIMA_REVISAO, 'N', pessoa_juridica_w.DT_ULTIMA_REVISAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DT_ULTIMA_REVISAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_VALIDADE_ALVARA_MUNIC', c01_w.DT_VALIDADE_ALVARA_MUNIC, 'N', pessoa_juridica_w.DT_VALIDADE_ALVARA_MUNIC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DT_VALIDADE_ALVARA_MUNIC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_VALIDADE_ALVARA_SANIT', c01_w.DT_VALIDADE_ALVARA_SANIT, 'N', pessoa_juridica_w.DT_VALIDADE_ALVARA_SANIT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DT_VALIDADE_ALVARA_SANIT := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_VALIDADE_AUTOR_FUNC', c01_w.DT_VALIDADE_AUTOR_FUNC, 'N', pessoa_juridica_w.DT_VALIDADE_AUTOR_FUNC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DT_VALIDADE_AUTOR_FUNC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_VALIDADE_CERT_BOAS_PRAT', c01_w.DT_VALIDADE_CERT_BOAS_PRAT, 'N', pessoa_juridica_w.DT_VALIDADE_CERT_BOAS_PRAT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DT_VALIDADE_CERT_BOAS_PRAT := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_VALIDADE_RESP_TECNICO', c01_w.DT_VALIDADE_RESP_TECNICO, 'N', pessoa_juridica_w.DT_VALIDADE_RESP_TECNICO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.DT_VALIDADE_RESP_TECNICO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_ALTERAR_SENHA', c01_w.IE_ALTERAR_SENHA, 'N', pessoa_juridica_w.IE_ALTERAR_SENHA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.IE_ALTERAR_SENHA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_EMPREENDEDOR_INDIVIDUAL', c01_w.IE_EMPREENDEDOR_INDIVIDUAL, 'N', pessoa_juridica_w.IE_EMPREENDEDOR_INDIVIDUAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.IE_EMPREENDEDOR_INDIVIDUAL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_FORMA_REVISAO', c01_w.IE_FORMA_REVISAO, 'N', pessoa_juridica_w.IE_FORMA_REVISAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.IE_FORMA_REVISAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_FORNECEDOR_OPME', c01_w.IE_FORNECEDOR_OPME, 'N', pessoa_juridica_w.IE_FORNECEDOR_OPME) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.IE_FORNECEDOR_OPME := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PROD_FABRIC', c01_w.IE_PROD_FABRIC, 'N', pessoa_juridica_w.IE_PROD_FABRIC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.IE_PROD_FABRIC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_QUALIDADE', c01_w.IE_QUALIDADE, 'N', pessoa_juridica_w.IE_QUALIDADE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.IE_QUALIDADE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_SITUACAO', c01_w.IE_SITUACAO, 'N', pessoa_juridica_w.IE_SITUACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.IE_SITUACAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_STATUS_ENVIO', c01_w.IE_STATUS_ENVIO, 'N', pessoa_juridica_w.IE_STATUS_ENVIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.IE_STATUS_ENVIO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_STATUS_EXPORTAR', c01_w.IE_STATUS_EXPORTAR, 'N', pessoa_juridica_w.IE_STATUS_EXPORTAR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.IE_STATUS_EXPORTAR := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TIPO_TRIB_MUNICIPAL', c01_w.IE_TIPO_TRIB_MUNICIPAL, 'N', pessoa_juridica_w.IE_TIPO_TRIB_MUNICIPAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.IE_TIPO_TRIB_MUNICIPAL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TIPO_TRIBUTACAO', c01_w.IE_TIPO_TRIBUTACAO, 'N', pessoa_juridica_w.IE_TIPO_TRIBUTACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.IE_TIPO_TRIBUTACAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TRANSPORTE', c01_w.IE_TRANSPORTE, 'N', pessoa_juridica_w.IE_TRANSPORTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.IE_TRANSPORTE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_FANTASIA', c01_w.NM_FANTASIA, 'N', pessoa_juridica_w.NM_FANTASIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NM_FANTASIA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_PESSOA_CONTATO', c01_w.NM_PESSOA_CONTATO, 'N', pessoa_juridica_w.NM_PESSOA_CONTATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NM_PESSOA_CONTATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_USUARIO_REVISAO', c01_w.NM_USUARIO_REVISAO, 'N', pessoa_juridica_w.NM_USUARIO_REVISAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NM_USUARIO_REVISAO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_ALVARA_SANITARIO', c01_w.NR_ALVARA_SANITARIO, 'N', pessoa_juridica_w.NR_ALVARA_SANITARIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_ALVARA_SANITARIO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_ALVARA_SANITARIO_MUNIC', c01_w.NR_ALVARA_SANITARIO_MUNIC, 'N', pessoa_juridica_w.NR_ALVARA_SANITARIO_MUNIC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_ALVARA_SANITARIO_MUNIC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_AUTOR_FUNC', c01_w.NR_AUTOR_FUNC, 'N', pessoa_juridica_w.NR_AUTOR_FUNC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_AUTOR_FUNC := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CCM', c01_w.NR_CCM, 'N', pessoa_juridica_w.NR_CCM) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_CCM := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CEI', c01_w.NR_CEI, 'N', pessoa_juridica_w.NR_CEI) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_CEI := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CERTIFICADO_BOAS_PRAT', c01_w.NR_CERTIFICADO_BOAS_PRAT, 'N', pessoa_juridica_w.NR_CERTIFICADO_BOAS_PRAT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_CERTIFICADO_BOAS_PRAT := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDD_FAX', c01_w.NR_DDD_FAX, 'N', pessoa_juridica_w.NR_DDD_FAX) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_DDD_FAX := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDD_TELEFONE', c01_w.NR_DDD_TELEFONE, 'N', pessoa_juridica_w.NR_DDD_TELEFONE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_DDD_TELEFONE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDI_FAX', c01_w.NR_DDI_FAX, 'N', pessoa_juridica_w.NR_DDI_FAX) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_DDI_FAX := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDI_TELEFONE', c01_w.NR_DDI_TELEFONE, 'N', pessoa_juridica_w.NR_DDI_TELEFONE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_DDI_TELEFONE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_ENDERECO', c01_w.NR_ENDERECO, 'N', pessoa_juridica_w.NR_ENDERECO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_ENDERECO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_FAX', c01_w.NR_FAX, 'N', pessoa_juridica_w.NR_FAX) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_FAX := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_INSCRICAO_ESTADUAL', c01_w.NR_INSCRICAO_ESTADUAL, 'N', pessoa_juridica_w.NR_INSCRICAO_ESTADUAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_INSCRICAO_ESTADUAL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_INSCRICAO_MUNICIPAL', c01_w.NR_INSCRICAO_MUNICIPAL, 'N', pessoa_juridica_w.NR_INSCRICAO_MUNICIPAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_INSCRICAO_MUNICIPAL := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_MATRICULA_CEI', c01_w.NR_MATRICULA_CEI, 'N', pessoa_juridica_w.NR_MATRICULA_CEI) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_MATRICULA_CEI := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_RAMAL_CONTATO', c01_w.NR_RAMAL_CONTATO, 'N', pessoa_juridica_w.NR_RAMAL_CONTATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_RAMAL_CONTATO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_REGISTRO_PLS', c01_w.NR_REGISTRO_PLS, 'N', pessoa_juridica_w.NR_REGISTRO_PLS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_REGISTRO_PLS := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_REGISTRO_RESP_TECNICO', c01_w.NR_REGISTRO_RESP_TECNICO, 'N', pessoa_juridica_w.NR_REGISTRO_RESP_TECNICO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_REGISTRO_RESP_TECNICO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_IDIOMA', c01_w.NR_SEQ_IDIOMA, 'N', pessoa_juridica_w.NR_SEQ_IDIOMA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_SEQ_IDIOMA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_PAIS', c01_w.NR_SEQ_PAIS, 'S', pessoa_juridica_w.NR_SEQ_PAIS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_SEQ_PAIS := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_TELEFONE', c01_w.NR_TELEFONE, 'S', pessoa_juridica_w.NR_TELEFONE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_TELEFONE := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_DIA_PRAZO_ENTREGA', c01_w.QT_DIA_PRAZO_ENTREGA, 'N', pessoa_juridica_w.QT_DIA_PRAZO_ENTREGA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.QT_DIA_PRAZO_ENTREGA := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'SG_ESTADO', c01_w.SG_ESTADO, 'N', pessoa_juridica_w.SG_ESTADO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.SG_ESTADO := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_MINIMO_NF', c01_w.VL_MINIMO_NF, 'N', pessoa_juridica_w.VL_MINIMO_NF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.VL_MINIMO_NF := _ora2pg_r.ds_valor_retorno_p;
		SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_TIPO_LOGRADOURO', c01_w.NR_SEQ_TIPO_LOGRADOURO, 'N', pessoa_juridica_w.NR_SEQ_TIPO_LOGRADOURO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_w.NR_SEQ_TIPO_LOGRADOURO := _ora2pg_r.ds_valor_retorno_p;
		pessoa_juridica_w.nm_usuario		:= 'TASY';
		pessoa_juridica_w.dt_atualizacao	:= clock_timestamp();
	
		if (coalesce(pessoa_juridica_w.CD_CGC::text, '') = '') and (pessoa_juridica_w.cd_internacional IS NOT NULL AND pessoa_juridica_w.cd_internacional::text <> '') then
			begin
			
			begin
			
			select	cd_cgc
			into STRICT	pessoa_juridica_w.CD_CGC
			from	pessoa_juridica
			where	cd_internacional	= pessoa_juridica_w.cd_internacional  LIMIT 1;
			
			exception
			when others then
				pessoa_juridica_w.CD_CGC	:= null;
			end;
			
			if (coalesce(pessoa_juridica_w.CD_CGC::text, '') = '') then
				pessoa_juridica_w.cd_cgc := gerar_codigo_pj_int_br(pessoa_juridica_w.cd_cgc, 2, pessoa_juridica_w.nm_usuario);
			end if;
			end;
		end if;

		
		cd_pk_w := coalesce(pessoa_juridica_w.cd_sistema_ant, pessoa_juridica_w.cd_cgc);
		
		if (reg_integracao_w.qt_reg_log = 0) then
			select	count(1)
			into STRICT	qt_ant_w
			from	pessoa_juridica
			where	coalesce(cd_sistema_ant, cd_cgc) = cd_pk_w  LIMIT 1;
			
			if (qt_ant_w > 0) then
				update	pessoa_juridica
				set	row = pessoa_juridica_w
				where	coalesce(cd_sistema_ant, cd_cgc) = cd_pk_w;
			else		
				
				insert into pessoa_juridica values (pessoa_juridica_w.*);
				
				/*'Registra a conversao que podera ser utilizada em outros pontos de integracao e para somente atualizar (update) num recebimento futuro do mesmo registro.'*/

				CALL gerar_conv_meio_externo(null, 'PESSOA_JURIDICA', 'CD_CGC', pessoa_juridica_w.cd_cgc, c01_w.cd_cgc, null, nr_seq_regra_w, 'A', pessoa_juridica_w.nm_usuario);
			end if;
			
			ie_atualizou_w	:= 'S';
		end if;
	
	else
		delete	FROM pessoa_juridica
		where	cd_sistema_ant = pessoa_juridica_w.cd_sistema_ant;
		
		ie_atualizou_w	:= 'S';
	end if;
	
	if (ie_atualizou_w = 'S')	then
		update	intpd_fila_transmissao
		set	ie_status = 'S',
			nr_seq_documento = cd_pk_w
		where	nr_sequencia = nr_sequencia_p;
	end if;
	
	open c02;
	loop
	fetch c02 into	
		c02_w;
	EXIT WHEN NOT FOUND; /* apply on c02 */
		begin
		reg_integracao_w.nm_tabela		:=	'PESSOA_JURIDICA_ESTAB';
		reg_integracao_w.nm_elemento		:=	'ESTABLISHMENTS';
		reg_integracao_w.nr_seq_visao		:=	0;
		
		pessoa_juridica_estab_w.cd_cgc		:=	pessoa_juridica_w.cd_cgc;

		if (coalesce(c02_w.ie_action,'INSERT') <> 'DELETE') THEN
		
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_ESTABELECIMENTO', c02_w.CD_ESTABELECIMENTO, 'S', pessoa_juridica_estab_w.CD_ESTABELECIMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.CD_ESTABELECIMENTO := _ora2pg_r.ds_valor_retorno_p;

			if (upper(coalesce(c02_w.ie_action,'INSERT')) = 'UPDATE') then
				begin
				/*'Busca o registro atual do Tasy pela PK'
				Esse tratamento foi necessario porque quando e update, o sistema externo so envia as informacoes alteradas e o restante dos campos eles mandam vazio. Entao temos que buscar a informacao que ja esta gravada na tabela.*/
				select  *
				into STRICT  pessoa_juridica_estab_w
				from  pessoa_juridica_estab
				where cd_cgc      = pessoa_juridica_estab_w.cd_cgc
				and cd_estabelecimento  = pessoa_juridica_estab_w.cd_estabelecimento  LIMIT 1;
				exception
				when others then
				null;
					end;
			end if;
			
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_COND_PAGTO', c02_w.CD_COND_PAGTO, 'S', pessoa_juridica_estab_w.CD_COND_PAGTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.CD_COND_PAGTO := _ora2pg_r.ds_valor_retorno_p;			
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_INTERNO_LAB', c02_w.CD_INTERNO_LAB, 'N', pessoa_juridica_estab_w.CD_INTERNO_LAB) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.CD_INTERNO_LAB := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_OPERACAO_NF', c02_w.CD_OPERACAO_NF, 'S', pessoa_juridica_estab_w.CD_OPERACAO_NF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.CD_OPERACAO_NF := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PORTADOR', c02_w.CD_PORTADOR, 'S', pessoa_juridica_estab_w.CD_PORTADOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.CD_PORTADOR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_REFERENCIA_FORNEC', c02_w.CD_REFERENCIA_FORNEC, 'N', pessoa_juridica_estab_w.CD_REFERENCIA_FORNEC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.CD_REFERENCIA_FORNEC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_SISTEMA_ANT', c02_w.CD_SISTEMA_ANT, 'N', pessoa_juridica_estab_w.CD_SISTEMA_ANT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.CD_SISTEMA_ANT := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_TIPO_BAIXA', c02_w.CD_TIPO_BAIXA, 'S', pessoa_juridica_estab_w.CD_TIPO_BAIXA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.CD_TIPO_BAIXA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_TIPO_PORTADOR', c02_w.CD_TIPO_PORTADOR, 'N', pessoa_juridica_estab_w.CD_TIPO_PORTADOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.CD_TIPO_PORTADOR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_EMAIL', c02_w.DS_EMAIL, 'N', pessoa_juridica_estab_w.DS_EMAIL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.DS_EMAIL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_BAIXA_ABAT', c02_w.IE_BAIXA_ABAT, 'N', pessoa_juridica_estab_w.IE_BAIXA_ABAT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_BAIXA_ABAT := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_CONSISTE_NR_SERIE_NF', c02_w.IE_CONSISTE_NR_SERIE_NF, 'N', pessoa_juridica_estab_w.IE_CONSISTE_NR_SERIE_NF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_CONSISTE_NR_SERIE_NF := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_CONTA_DIF_NF', c02_w.IE_CONTA_DIF_NF, 'N', pessoa_juridica_estab_w.IE_CONTA_DIF_NF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_CONTA_DIF_NF := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_ENDERECO_CORRESPONDENCIA', c02_w.IE_ENDERECO_CORRESPONDENCIA, 'N', pessoa_juridica_estab_w.IE_ENDERECO_CORRESPONDENCIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_ENDERECO_CORRESPONDENCIA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_EXIGE_ANEXO_NF', c02_w.IE_EXIGE_ANEXO_NF, 'N', pessoa_juridica_estab_w.IE_EXIGE_ANEXO_NF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_EXIGE_ANEXO_NF := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_EXIGE_ORDEM_COMPRA', c02_w.IE_EXIGE_ORDEM_COMPRA, 'N', pessoa_juridica_estab_w.IE_EXIGE_ORDEM_COMPRA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_EXIGE_ORDEM_COMPRA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_FORMA_PAGTO', c02_w.IE_FORMA_PAGTO, 'N', pessoa_juridica_estab_w.IE_FORMA_PAGTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_FORMA_PAGTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_FRETE', c02_w.IE_FRETE, 'N', pessoa_juridica_estab_w.IE_FRETE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_FRETE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_MOEDA_ESTRANGEIRA', c02_w.IE_MOEDA_ESTRANGEIRA, 'N', pessoa_juridica_estab_w.IE_MOEDA_ESTRANGEIRA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_MOEDA_ESTRANGEIRA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_QUALIDADE', c02_w.IE_QUALIDADE, 'N', pessoa_juridica_estab_w.IE_QUALIDADE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_QUALIDADE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_RATEIO_ADIANT', c02_w.IE_RATEIO_ADIANT, 'N', pessoa_juridica_estab_w.IE_RATEIO_ADIANT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_RATEIO_ADIANT := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_REC_EMAIL_COMERCIAL', c02_w.IE_REC_EMAIL_COMERCIAL, 'N', pessoa_juridica_estab_w.IE_REC_EMAIL_COMERCIAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_REC_EMAIL_COMERCIAL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_RETEM_ISS', c02_w.IE_RETEM_ISS, 'N', pessoa_juridica_estab_w.IE_RETEM_ISS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_RETEM_ISS := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_STATUS_APENADO', c02_w.IE_STATUS_APENADO, 'N', pessoa_juridica_estab_w.IE_STATUS_APENADO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.IE_STATUS_APENADO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_PESSOA_CONTATO', c02_w.NM_PESSOA_CONTATO, 'N', pessoa_juridica_estab_w.NM_PESSOA_CONTATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.NM_PESSOA_CONTATO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CODIGO_SERV_PREST', c02_w.NR_CODIGO_SERV_PREST, 'N', pessoa_juridica_estab_w.NR_CODIGO_SERV_PREST) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.NR_CODIGO_SERV_PREST := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_RAMAL_CONTATO', c02_w.NR_RAMAL_CONTATO, 'N', pessoa_juridica_estab_w.NR_RAMAL_CONTATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.NR_RAMAL_CONTATO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'PR_DESC_FINANCEIRO', c02_w.PR_DESC_FINANCEIRO, 'N', pessoa_juridica_estab_w.PR_DESC_FINANCEIRO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.PR_DESC_FINANCEIRO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_DIA_PRAZO_ENTREGA', c02_w.QT_DIA_PRAZO_ENTREGA, 'N', pessoa_juridica_estab_w.QT_DIA_PRAZO_ENTREGA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.QT_DIA_PRAZO_ENTREGA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'TX_DESC_ANTECIPACAO', c02_w.TX_DESC_ANTECIPACAO, 'N', pessoa_juridica_estab_w.TX_DESC_ANTECIPACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.TX_DESC_ANTECIPACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'TX_DESC_ASSIDUIDADE', c02_w.TX_DESC_ASSIDUIDADE, 'N', pessoa_juridica_estab_w.TX_DESC_ASSIDUIDADE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.TX_DESC_ASSIDUIDADE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'TX_DESC_ORDEM', c02_w.TX_DESC_ORDEM, 'N', pessoa_juridica_estab_w.TX_DESC_ORDEM) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.TX_DESC_ORDEM := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_MINIMO_NF', c02_w.VL_MINIMO_NF, 'N', pessoa_juridica_estab_w.VL_MINIMO_NF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_estab_w.VL_MINIMO_NF := _ora2pg_r.ds_valor_retorno_p;
			pessoa_juridica_estab_w.nm_usuario	:= 'TASY';
			pessoa_juridica_estab_w.dt_atualizacao	:= clock_timestamp();			
			
			
			select	coalesce(max(nr_sequencia),0)
			into STRICT	qt_ant_w
			from	pessoa_juridica_estab
			where	cd_cgc			= pessoa_juridica_estab_w.cd_cgc
			and	cd_estabelecimento	= pessoa_juridica_estab_w.cd_estabelecimento  LIMIT 1;
			
			if (qt_ant_w > 0) then
			
				pessoa_juridica_estab_w.nr_sequencia := qt_ant_w;
				
				update	pessoa_juridica_estab
				set	row			= pessoa_juridica_estab_w
				where	cd_cgc			= pessoa_juridica_estab_w.cd_cgc
				and	cd_estabelecimento	= pessoa_juridica_estab_w.cd_estabelecimento;
			else
				select	nextval('pessoa_juridica_estab_seq')
				into STRICT	pessoa_juridica_estab_w.nr_sequencia
				;
			
				insert into pessoa_juridica_estab values (pessoa_juridica_estab_w.*);
			end if;
		else
			delete	FROM pessoa_juridica_estab
			where	cd_cgc			= pessoa_juridica_estab_w.cd_cgc
			and	cd_estabelecimento	= pessoa_juridica_estab_w.cd_estabelecimento;
		end if;
		end;
	end loop;
	close c02;
	
	open c03;
	loop
	fetch c03 into	
		c03_w;
	EXIT WHEN NOT FOUND; /* apply on c03 */
		begin
		reg_integracao_w.nm_tabela		:=	'PESSOA_JURIDICA_COMPL';
		reg_integracao_w.nm_elemento		:=	'COMPLEMENTS';
		reg_integracao_w.nr_seq_visao		:=	0;
		
		pessoa_juridica_compl_w.cd_cgc		:=	pessoa_juridica_w.cd_cgc;
		
		if (coalesce(c03_w.ie_action,'INSERT') <> 'DELETE') THEN
		
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TIPO_COMPLEMENTO', c03_w.IE_TIPO_COMPLEMENTO, 'N', pessoa_juridica_compl_w.IE_TIPO_COMPLEMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.IE_TIPO_COMPLEMENTO := _ora2pg_r.ds_valor_retorno_p;

			if (upper(coalesce(c03_w.ie_action,'INSERT')) = 'UPDATE') then
				begin
				/*'Busca o registro atual do Tasy pela PK'
				Esse tratamento foi necessario porque quando e update, o sistema externo so envia as informacoes alteradas e o restante dos campos eles mandam vazio. Entao temos que buscar a informacao que ja esta gravada na tabela.*/
				select  *
				into STRICT  pessoa_juridica_compl_w
				from  pessoa_juridica_compl
				where cd_cgc      = pessoa_juridica_compl_w.cd_cgc
				and ie_tipo_complemento = pessoa_juridica_compl_w.ie_tipo_complemento  LIMIT 1;
				exception
				when others then
					null;
				end;
			end if;
			
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CBO_RED', c03_w.CD_CBO_RED, 'S', pessoa_juridica_compl_w.CD_CBO_RED) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.CD_CBO_RED := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CEP', c03_w.CD_CEP, 'N', pessoa_juridica_compl_w.CD_CEP) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.CD_CEP := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_MUNICIPIO_IBGE', c03_w.CD_MUNICIPIO_IBGE, 'S', pessoa_juridica_compl_w.CD_MUNICIPIO_IBGE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.CD_MUNICIPIO_IBGE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PESSOA_FISICA_CANAL', c03_w.CD_PESSOA_FISICA_CANAL, 'S', pessoa_juridica_compl_w.CD_PESSOA_FISICA_CANAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.CD_PESSOA_FISICA_CANAL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_BAIRRO', c03_w.DS_BAIRRO, 'N', pessoa_juridica_compl_w.DS_BAIRRO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.DS_BAIRRO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_CARGO', c03_w.DS_CARGO, 'N', pessoa_juridica_compl_w.DS_CARGO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.DS_CARGO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_COMPLEMENTO', c03_w.DS_COMPLEMENTO, 'N', pessoa_juridica_compl_w.DS_COMPLEMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.DS_COMPLEMENTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_EMAIL', c03_w.DS_EMAIL, 'N', pessoa_juridica_compl_w.DS_EMAIL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.DS_EMAIL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_ENDERECO', c03_w.DS_ENDERECO, 'N', pessoa_juridica_compl_w.DS_ENDERECO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.DS_ENDERECO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_IDENTIFIC_COMPLEMENTO', c03_w.DS_IDENTIFIC_COMPLEMENTO, 'N', pessoa_juridica_compl_w.DS_IDENTIFIC_COMPLEMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.DS_IDENTIFIC_COMPLEMENTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_MUNICIPIO', c03_w.DS_MUNICIPIO, 'N', pessoa_juridica_compl_w.DS_MUNICIPIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.DS_MUNICIPIO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_OBSERVACAO', c03_w.DS_OBSERVACAO, 'N', pessoa_juridica_compl_w.DS_OBSERVACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.DS_OBSERVACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_SETOR_CONTATO', c03_w.DS_SETOR_CONTATO, 'N', pessoa_juridica_compl_w.DS_SETOR_CONTATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.DS_SETOR_CONTATO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_CONTATO_REF', c03_w.IE_CONTATO_REF, 'N', pessoa_juridica_compl_w.IE_CONTATO_REF) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.IE_CONTATO_REF := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_GERENTE_CANAL', c03_w.IE_GERENTE_CANAL, 'N', pessoa_juridica_compl_w.IE_GERENTE_CANAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.IE_GERENTE_CANAL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PARTICIPA_EVENTOS', c03_w.IE_PARTICIPA_EVENTOS, 'N', pessoa_juridica_compl_w.IE_PARTICIPA_EVENTOS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.IE_PARTICIPA_EVENTOS := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PLC_CUSTOMER_SPONSOR', c03_w.IE_PLC_CUSTOMER_SPONSOR, 'N', pessoa_juridica_compl_w.IE_PLC_CUSTOMER_SPONSOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.IE_PLC_CUSTOMER_SPONSOR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PLC_PLATAFORM_MANAGER', c03_w.IE_PLC_PLATAFORM_MANAGER, 'N', pessoa_juridica_compl_w.IE_PLC_PLATAFORM_MANAGER) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.IE_PLC_PLATAFORM_MANAGER := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PLS', c03_w.IE_PLS, 'N', pessoa_juridica_compl_w.IE_PLS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.IE_PLS := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_RECEBE_PROP', c03_w.IE_RECEBE_PROP, 'N', pessoa_juridica_compl_w.IE_RECEBE_PROP) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.IE_RECEBE_PROP := _ora2pg_r.ds_valor_retorno_p;			
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_PESSOA_CONTATO', c03_w.NM_PESSOA_CONTATO, 'N', pessoa_juridica_compl_w.NM_PESSOA_CONTATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.NM_PESSOA_CONTATO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DDD_TELEFONE', c03_w.NR_DDD_TELEFONE, 'N', pessoa_juridica_compl_w.NR_DDD_TELEFONE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.NR_DDD_TELEFONE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_ENDERECO', c03_w.NR_ENDERECO, 'N', pessoa_juridica_compl_w.NR_ENDERECO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.NR_ENDERECO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_FAX', c03_w.NR_FAX, 'N', pessoa_juridica_compl_w.NR_FAX) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.NR_FAX := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_RAMAL_CONTATO', c03_w.NR_RAMAL_CONTATO, 'N', pessoa_juridica_compl_w.NR_RAMAL_CONTATO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.NR_RAMAL_CONTATO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_TELEFONE', c03_w.NR_TELEFONE, 'N', pessoa_juridica_compl_w.NR_TELEFONE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.NR_TELEFONE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_TELEFONE_CELULAR', c03_w.NR_TELEFONE_CELULAR, 'N', pessoa_juridica_compl_w.NR_TELEFONE_CELULAR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.NR_TELEFONE_CELULAR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'SG_ESTADO', c03_w.SG_ESTADO, 'N', pessoa_juridica_compl_w.SG_ESTADO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_compl_w.SG_ESTADO := _ora2pg_r.ds_valor_retorno_p;
			pessoa_juridica_compl_w.nm_usuario	:= 'TASY';
			pessoa_juridica_compl_w.dt_atualizacao	:= clock_timestamp();			
			
			select	coalesce(max(nr_sequencia),0)
			into STRICT	qt_ant_w
			from	pessoa_juridica_compl
			where	cd_cgc			= pessoa_juridica_compl_w.cd_cgc
			and	ie_tipo_complemento	= pessoa_juridica_compl_w.ie_tipo_complemento  LIMIT 1;
			
			if (qt_ant_w > 0) then
			
				pessoa_juridica_compl_w.nr_sequencia := qt_ant_w;
			
				update	pessoa_juridica_compl
				set	row			= pessoa_juridica_compl_w
				where	cd_cgc			= pessoa_juridica_compl_w.cd_cgc
				and	ie_tipo_complemento	= pessoa_juridica_compl_w.ie_tipo_complemento;
			else
				select	nextval('pessoa_juridica_compl_seq')
				into STRICT	pessoa_juridica_compl_w.nr_sequencia
				;
				
				insert into pessoa_juridica_compl values (pessoa_juridica_compl_w.*);
			end if;
		else
			delete	FROM pessoa_juridica_compl
			where	cd_cgc			= pessoa_juridica_compl_w.cd_cgc
			and	ie_tipo_complemento	= pessoa_juridica_compl_w.ie_tipo_complemento;
		end if;
		end;
	end loop;
	close c03;	
	
	open c04;
	loop
	fetch c04 into	
		c04_w;
	EXIT WHEN NOT FOUND; /* apply on c04 */
		begin
		reg_integracao_w.nm_tabela		:=	'PESSOA_JURIDICA_CONTA';
		reg_integracao_w.nm_elemento		:=	'ACCOUNTS';
		reg_integracao_w.nr_seq_visao		:=	0;
		
		pessoa_juridica_conta_w.cd_cgc		:=	pessoa_juridica_w.cd_cgc;
		
		if (coalesce(c04_w.ie_action,'INSERT') <> 'DELETE') THEN	
			
          SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_BANCO', c04_w.CD_BANCO, 'N', pessoa_juridica_conta_w.CD_BANCO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.CD_BANCO := _ora2pg_r.ds_valor_retorno_p;
          SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_AGENCIA_BANCARIA', c04_w.CD_AGENCIA_BANCARIA, 'N', pessoa_juridica_conta_w.CD_AGENCIA_BANCARIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.CD_AGENCIA_BANCARIA := _ora2pg_r.ds_valor_retorno_p;
          SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_CONTA', c04_w.NR_CONTA, 'N', pessoa_juridica_conta_w.NR_CONTA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.NR_CONTA := _ora2pg_r.ds_valor_retorno_p;

			if (upper(coalesce(c04_w.ie_action,'INSERT')) = 'UPDATE') then
				begin
				/*'Busca o registro atual do Tasy pela PK'
				Esse tratamento foi necessario porque quando e update, o sistema externo so envia as informacoes alteradas e o restante dos campos eles mandam vazio. Entao temos que buscar a informacao que ja esta gravada na tabela.*/
				select  *
				into STRICT  pessoa_juridica_conta_w
				from  pessoa_juridica_conta
				where cd_cgc      = pessoa_juridica_conta_w.cd_cgc
				and cd_banco    = pessoa_juridica_conta_w.cd_banco
				and cd_agencia_bancaria = pessoa_juridica_conta_w.cd_agencia_bancaria
				and nr_conta    = pessoa_juridica_conta_w.nr_conta  LIMIT 1;
				exception
				when others then
					null;
				end;
			end if;
			
			
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CAMARA_COMPENSACAO', c04_w.CD_CAMARA_COMPENSACAO, 'N', pessoa_juridica_conta_w.CD_CAMARA_COMPENSACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.CD_CAMARA_COMPENSACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CODIGO_IDENTIFICACAO', c04_w.CD_CODIGO_IDENTIFICACAO, 'N', pessoa_juridica_conta_w.CD_CODIGO_IDENTIFICACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.CD_CODIGO_IDENTIFICACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_OBSERVACAO', c04_w.DS_OBSERVACAO, 'N', pessoa_juridica_conta_w.DS_OBSERVACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.DS_OBSERVACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_CONTA_PAGAMENTO', c04_w.IE_CONTA_PAGAMENTO, 'N', pessoa_juridica_conta_w.IE_CONTA_PAGAMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.IE_CONTA_PAGAMENTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_CONTA_REPASSE', c04_w.IE_CONTA_REPASSE, 'N', pessoa_juridica_conta_w.IE_CONTA_REPASSE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.IE_CONTA_REPASSE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_DIGITO_AGENCIA', c04_w.IE_DIGITO_AGENCIA, 'N', pessoa_juridica_conta_w.IE_DIGITO_AGENCIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.IE_DIGITO_AGENCIA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PRESTADOR_PLS', c04_w.IE_PRESTADOR_PLS, 'N', pessoa_juridica_conta_w.IE_PRESTADOR_PLS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.IE_PRESTADOR_PLS := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PROPRIEDADE_CONTA', c04_w.IE_PROPRIEDADE_CONTA, 'N', pessoa_juridica_conta_w.IE_PROPRIEDADE_CONTA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.IE_PROPRIEDADE_CONTA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_SITUACAO', c04_w.IE_SITUACAO, 'N', pessoa_juridica_conta_w.IE_SITUACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.IE_SITUACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TIPO_CONTA', c04_w.IE_TIPO_CONTA, 'N', pessoa_juridica_conta_w.IE_TIPO_CONTA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.IE_TIPO_CONTA := _ora2pg_r.ds_valor_retorno_p;
			
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DIGITO_CONTA', c04_w.NR_DIGITO_CONTA, 'N', pessoa_juridica_conta_w.NR_DIGITO_CONTA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_juridica_conta_w.NR_DIGITO_CONTA := _ora2pg_r.ds_valor_retorno_p;
			pessoa_juridica_conta_w.nm_usuario	:= 'TASY';
			pessoa_juridica_conta_w.dt_atualizacao	:= clock_timestamp();

			select	coalesce(max(nr_sequencia),0)
			into STRICT	qt_ant_w
			from	pessoa_juridica_conta
			where	cd_cgc			= pessoa_juridica_conta_w.cd_cgc
			and	cd_banco		= pessoa_juridica_conta_w.cd_banco
			and	cd_agencia_bancaria	= pessoa_juridica_conta_w.cd_agencia_bancaria
			and	nr_conta		= pessoa_juridica_conta_w.nr_conta  LIMIT 1;
			
			if (qt_ant_w > 0) then
			
				pessoa_juridica_conta_w.nr_sequencia := qt_ant_w;
			
				update	pessoa_juridica_conta
				set	row			= pessoa_juridica_conta_w
				where	cd_cgc			= pessoa_juridica_conta_w.cd_cgc
				and	cd_banco		= pessoa_juridica_conta_w.cd_banco
				and	cd_agencia_bancaria	= pessoa_juridica_conta_w.cd_agencia_bancaria
				and	nr_conta		= pessoa_juridica_conta_w.nr_conta;
			else
				select	nextval('pessoa_juridica_conta_seq')
				into STRICT	pessoa_juridica_conta_w.nr_sequencia
				;
				
				insert into pessoa_juridica_conta values (pessoa_juridica_conta_w.*);
			end if;
		else
			delete	FROM pessoa_juridica_conta
			where	cd_cgc			= pessoa_juridica_conta_w.cd_cgc
			and	cd_banco		= pessoa_juridica_conta_w.cd_banco
			and	cd_agencia_bancaria	= pessoa_juridica_conta_w.cd_agencia_bancaria
			and	nr_conta		= pessoa_juridica_conta_w.nr_conta;
		end if;			

		end;
	end loop;
	close c04;
	
	open c05;
	loop
	fetch c05 into	
		c05_w;
	EXIT WHEN NOT FOUND; /* apply on c05 */
		begin
		reg_integracao_w.nm_tabela		:=	'PESSOA_JUR_RESP';
		reg_integracao_w.nm_elemento		:=	'RESPONSIBLES';
		reg_integracao_w.nr_seq_visao		:=	0;
		
		pessoa_jur_resp_w.cd_cgc		:=	pessoa_juridica_w.cd_cgc;
		
		if (upper(coalesce(c05_w.ie_action,'INSERT')) <> 'DELETE') then
			begin
				SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PESSOA_FISICA', c05_w.CD_PESSOA_FISICA, 'S', pessoa_jur_resp_w.CD_PESSOA_FISICA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_jur_resp_w.CD_PESSOA_FISICA := _ora2pg_r.ds_valor_retorno_p;

				if (upper(coalesce(c05_w.ie_action,'INSERT')) = 'UPDATE') then
					begin
					/*'Busca o registro atual do Tasy pela PK'
					Esse tratamento foi necessario porque quando e update, o sistema externo so envia as informacoes alteradas e o restante dos campos eles mandam vazio. Entao temos que buscar a informacao que ja esta gravada na tabela.*/
					select  *
					into STRICT  pessoa_jur_resp_w
					from  pessoa_jur_resp
					where cd_cgc = pessoa_jur_resp_w.cd_cgc
					and cd_pessoa_fisica = pessoa_jur_resp_w.cd_pessoa_fisica  LIMIT 1;
					exception
					when others then
						null;
					end;
				end if;
				
				SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CARGO', c05_w.CD_CARGO, 'S', pessoa_jur_resp_w.CD_CARGO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_jur_resp_w.CD_CARGO := _ora2pg_r.ds_valor_retorno_p;			
				SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_AVALIACAO_FORNECEDOR', c05_w.IE_AVALIACAO_FORNECEDOR, 'N', pessoa_jur_resp_w.IE_AVALIACAO_FORNECEDOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_jur_resp_w.IE_AVALIACAO_FORNECEDOR := _ora2pg_r.ds_valor_retorno_p;
				SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_REPRESENTANTE_LEGAL', c05_w.IE_REPRESENTANTE_LEGAL, 'N', pessoa_jur_resp_w.IE_REPRESENTANTE_LEGAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_jur_resp_w.IE_REPRESENTANTE_LEGAL := _ora2pg_r.ds_valor_retorno_p;
				SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_RESP_CADASTRO', c05_w.IE_RESP_CADASTRO, 'N', pessoa_jur_resp_w.IE_RESP_CADASTRO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; pessoa_jur_resp_w.IE_RESP_CADASTRO := _ora2pg_r.ds_valor_retorno_p;
				pessoa_jur_resp_w.nm_usuario	:= 'TASY';
				pessoa_jur_resp_w.dt_atualizacao	:= clock_timestamp();
		
				select	nextval('pessoa_jur_resp_seq')
				into STRICT	pessoa_jur_resp_w.nr_sequencia
				;
		
				insert into pessoa_jur_resp values (pessoa_jur_resp_w.*);
			end;
		end if;							
		end;
	end loop;
	close c05;
	
	end;
end loop;
close c01;
exception
when others then
	begin
	ds_erro_w	:=	substr(sqlerrm,1,4000);
	rollback;
	update	intpd_fila_transmissao
	set	ie_status = 'E',
		ds_log = ds_erro_w
	where	nr_sequencia = nr_sequencia_p;
	end;
end;

if (reg_integracao_w.qt_reg_log > 0) then
	begin
	rollback;
	
	update	intpd_fila_transmissao
	set	ie_status = 'E',
		ds_log = ds_erro_w
	where	nr_sequencia = nr_sequencia_p;
	
	for i in 0..reg_integracao_w.qt_reg_log-1 loop
		intpd_gravar_log_recebimento(nr_sequencia_p,reg_integracao_w.intpd_log_receb[i].ds_log,'INTPDTASY');
	end loop;
	end;
end if;
	
commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE intpd_recebe_pessoa_juridica ( nr_sequencia_p bigint, xml_p xml) FROM PUBLIC;

