-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE com_obter_loc_demonstracao_js ( nr_seq_tipo_dem_p bigint, nr_seq_cliente_p bigint, DS_LOCAL_P INOUT text) AS $body$
DECLARE


ie_ead_w	varchar(1);
ds_local_w	varchar(255);
cd_cnpj_w	varchar(14);
ds_endereco_w	varchar(40);
nr_endereco_w	varchar(10);
ds_bairro_w	varchar(40);
ds_municipio_w	varchar(40);


BEGIN

if (coalesce(nr_seq_tipo_dem_p,0) > 0) then

	ie_ead_w := com_obter_se_dem_ead(nr_seq_tipo_dem_p);

	if (ie_ead_w = 'S') then
		ds_local_w := substr(wheb_mensagem_pck.get_texto(324838, null),1,255);
	else
		if (coalesce(nr_seq_cliente_p,0) > 0) then

			select	max(cd_cnpj)
			into STRICT	cd_cnpj_w
			from 	com_cliente
			where 	nr_sequencia = nr_seq_cliente_p;

			if (cd_cnpj_w IS NOT NULL AND cd_cnpj_w::text <> '') then

				select	ds_endereco,
					nr_endereco,
					ds_bairro,
					ds_municipio
				into STRICT	ds_endereco_w,
					nr_endereco_w,
					ds_bairro_w,
					ds_municipio_w
				from	pessoa_juridica
				where	cd_cgc = cd_cnpj_w;

				if (ds_endereco_w IS NOT NULL AND ds_endereco_w::text <> '') then
					ds_local_w:= ds_endereco_w || ', ' || nr_endereco_w || ', ' || ds_bairro_w || ', '  || ds_municipio_w;
				end if;
			end if;
		end if;

	end if;
end if;

ds_local_p := ds_local_w;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE com_obter_loc_demonstracao_js ( nr_seq_tipo_dem_p bigint, nr_seq_cliente_p bigint, DS_LOCAL_P INOUT text) FROM PUBLIC;

