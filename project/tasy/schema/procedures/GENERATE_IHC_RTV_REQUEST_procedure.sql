-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE generate_ihc_rtv_request ( nr_interno_conta_p bigint, cd_estabelecimento_p bigint, nm_usuario_p text) AS $body$
DECLARE

nr_seq_transaction_w    ihc_claim.cd_transaction%type;
request_rtv				varchar(500);


BEGIN

select max(cd_transaction)
into STRICT 	nr_seq_transaction_w
from ihc_claim
where nr_account = nr_interno_conta_p;

request_rtv := '{' || chr(10) || '"transactionId":"' || nr_seq_transaction_w || '",'
		|| chr(10) || '"userName":"' || nm_usuario_p || '",'
		|| chr(10) || '"requestContentType": "MCA/OlcHospital/InHospitalClaimRequestCH@2",'
		|| chr(10) || '"establishmentCode":"' || cd_estabelecimento_p || '"}';

CALL EXECUTE_BIFROST_INTEGRATION(191, request_rtv);

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE generate_ihc_rtv_request ( nr_interno_conta_p bigint, cd_estabelecimento_p bigint, nm_usuario_p text) FROM PUBLIC;

