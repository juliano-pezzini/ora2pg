-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE get_time_units (qt_minutes_p bigint, ds_first_time_p INOUT text, ds_second_time_p INOUT text, ds_first_unit_p INOUT text, ds_second_unit_p INOUT text) AS $body$
DECLARE


	time_masked_w	varchar(50);
	substr_1_w		varchar(50);
	substr_2_w		varchar(50);

BEGIN


	Select get_time_by_minutes(qt_minutes_p)
	into STRICT time_masked_w
	;
	
	if (coalesce(time_masked_w,'0') <> '0') then
		select substr(time_masked_w, 1, position(' ' in time_masked_w)-1) substr_1,
			   substr(time_masked_w, position(' ' in time_masked_w)+1, 8) substr_2
		into STRICT substr_1_w,
			 substr_2_w
		;

		select LTRIM(translate(substr_1_w, translate(substr_1_w, '1234567890', ' ') , ' ')) only_numbers
		into STRICT ds_first_time_p
		;
	
		select replace( translate(substr_1_w, '1234567890', ' ') , ' ', '') only_letters
		into STRICT ds_first_unit_p
		;
		
		select LTRIM(translate(substr_2_w, translate(substr_2_w, '1234567890', ' ') , ' ')) only_numbers
		into STRICT ds_second_time_p
		;
		
		select replace( translate(substr_2_w, '1234567890', ' ') , ' ', '') only_letters
		into STRICT ds_second_unit_p
		;
	else
		select coalesce(time_masked_w,'0'),
			   wheb_mensagem_pck.get_texto(1105414)
		into STRICT ds_first_time_p,
			 ds_first_unit_p
		;
	end if;	

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE get_time_units (qt_minutes_p bigint, ds_first_time_p INOUT text, ds_second_time_p INOUT text, ds_first_unit_p INOUT text, ds_second_unit_p INOUT text) FROM PUBLIC;

