-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE atualizar_atend_pre_natal ( nr_atendimento_p bigint, nm_usuario_p text) AS $body$
DECLARE

 
ie_migrar_registros_obst_w varchar(1);
nr_sequencia_pre_parto_w	bigint;
nr_registro_parto_w			bigint;
nr_atendimento_anterior_w  bigint;
nr_seq_evolucao_w			bigint;
nr_seq_med_evol_w			bigint;
qt_reg_w					bigint;
					

BEGIN 
	 
ie_migrar_registros_obst_w := obter_param_usuario(281, 1498, obter_perfil_ativo, nm_usuario_p, obter_estabelecimento_ativo, ie_migrar_registros_obst_w);
ie_migrar_registros_obst_w := 'S';
	 
if (coalesce(ie_migrar_registros_obst_w,'N') = 'S') then 
	begin 
	select coalesce(max(b.nr_atendimento),0) 
	into STRICT	nr_atendimento_anterior_w 
	from	atendimento_paciente b
	where 	b.cd_pessoa_fisica = (SELECT max(cd_pessoa_fisica) from atendimento_paciente where nr_atendimento = nr_atendimento_p) --a.nr_atendimento = b.nr_atendimento 
	and		ie_tipo_atendimento = 3;
	 
	if (nr_atendimento_anterior_w > 0) then 
		begin		 
		select	coalesce(max(nr_sequencia),0) 
		into STRICT 	nr_sequencia_pre_parto_w 
		from	pre_parto 
		where	nr_atendimento = nr_atendimento_anterior_w;	
					 
		if (nr_sequencia_pre_parto_w > 0) then 
			INSERT INTO PRE_PARTO( 
				NR_SEQUENCIA, 
				DT_ATUALIZACAO, 
				NM_USUARIO, 
				NR_ATENDIMENTO, 
				QT_SEM_IG_CRONOLOGICA, 
				QT_PA_DIASTOLICA, 
				QT_PA_SISTOLICA, 
				QT_PULSO, 
				QT_TEMPERATURA, 
				QT_BAT_CARDIO_FETAIS, 
				IE_APRESENTACAO_FETAL, 
				IE_BOLSA_AMNIOTICA, 
				DT_BOLSA_AMNIOTICA, 
				IE_BOLSA_ROTA_ALTA, 
				IE_DINAMICA_UTERINA, 
				IE_BATIM_FETAIS, 
				IE_ASPECTO_LIQUIDO, 
				QT_ALTURA_UTERINA, 
				IE_RITMO_BCF, 
				IE_MOVIMENTO_FETAL, 
				IE_GENITALIA_INTEGRA, 
				DS_GENITALIA_ALTERADA, 
				QT_DILATACAO_UTERINA, 
				QT_CONTRACOES, 
				IE_COLO_PERVEO, 
				IE_COLO_POSICAO, 
				IE_COLO_ESPESSURA, 
				IE_COLO_TEXTURA, 
				DS_OBSERVACAO, 
				DT_REGISTRO, 
				CD_PROFISSIONAL, 
				QT_IG_SEM, 
				QT_IG_DIA, 
				QT_IG_SEM_US, 
				QT_IG_DIA_US, 
				QT_PESO_MAE, 
				QT_VAR_PESO, 
				QT_ALTURA_CM, 
				QT_IMC, 
				NR_FETO, 
				DS_ABDOME, 
				DS_AUSC_CARD, 
				DS_AUSC_PULM, 
				DS_MAMAS, 
				QT_FREQ_RESP, 
				IE_INTENSIDADE_EDEMA, 
				IE_SITUACAO_FETAL) 
			SELECT 	 
				nextval('pre_parto_seq') NR_SEQUENCIA, 
				clock_timestamp(), 
				NM_USUARIO_P, 
				NR_ATENDIMENTO_P, 
				QT_SEM_IG_CRONOLOGICA, 
				QT_PA_DIASTOLICA, 
				QT_PA_SISTOLICA, 
				QT_PULSO, 
				QT_TEMPERATURA, 
				QT_BAT_CARDIO_FETAIS, 
				IE_APRESENTACAO_FETAL, 
				IE_BOLSA_AMNIOTICA, 
				DT_BOLSA_AMNIOTICA, 
				IE_BOLSA_ROTA_ALTA, 
				IE_DINAMICA_UTERINA, 
				IE_BATIM_FETAIS, 
				IE_ASPECTO_LIQUIDO, 
				QT_ALTURA_UTERINA, 
				IE_RITMO_BCF, 
				IE_MOVIMENTO_FETAL, 
				IE_GENITALIA_INTEGRA, 
				DS_GENITALIA_ALTERADA, 
				QT_DILATACAO_UTERINA, 
				QT_CONTRACOES, 
				IE_COLO_PERVEO, 
				IE_COLO_POSICAO, 
				IE_COLO_ESPESSURA, 
				IE_COLO_TEXTURA, 
				DS_OBSERVACAO, 
				DT_REGISTRO, 
				CD_PROFISSIONAL, 
				QT_IG_SEM, 
				QT_IG_DIA, 
				QT_IG_SEM_US, 
				QT_IG_DIA_US, 
				QT_PESO_MAE, 
				QT_VAR_PESO, 
				QT_ALTURA_CM, 
				QT_IMC, 
				NR_FETO, 
				DS_ABDOME, 
				DS_AUSC_CARD, 
				DS_AUSC_PULM, 
				DS_MAMAS, 
				QT_FREQ_RESP, 
				IE_INTENSIDADE_EDEMA, 
				IE_SITUACAO_FETAL 
			FROM PRE_PARTO 
			WHERE NR_SEQUENCIA = nr_sequencia_pre_parto_w;
		  
		  commit;
		end if;
 
		select	count(*), coalesce(max(a.nr_seq_evolucao),0) 
		into STRICT	qt_reg_w, nr_seq_evolucao_w 
		from	parto a 
		where 	a.nr_atendimento = nr_atendimento_anterior_w;
		 
		select count(a.nr_atendimento) 
		into STRICT	nr_registro_parto_w 
		from	parto a 
		where 	a.nr_atendimento = nr_atendimento_p;
			 
		if (qt_reg_w > 0) and (nr_registro_parto_w = 0) then 
		 
			select	count(*) 
			into STRICT	qt_reg_w 
			from	MED_EVOLUCAO 
			where 	nr_atendimento = nr_atendimento_anterior_w;
		 
			if (qt_reg_w > 0) then 
				select 	nextval('med_evolucao_seq') 
				into STRICT	nr_seq_med_evol_w 
				;
				 
				INSERT INTO MED_EVOLUCAO( 
					NR_SEQUENCIA, 
					DT_ATUALIZACAO, 
					NM_USUARIO, 
					DT_EVOLUCAO, 
					DS_EVOLUCAO, 
					NR_SEQ_CLIENTE, 
					QT_PESO, 
					QT_IMC, 
					QT_VARIACAO_PESO, 
					QT_ALTURA_CM, 
					QT_SUPERF_CORPORAL, 
					QT_PA_SISTOLICA, 
					QT_PA_DIASTOLICA, 
					QT_TEMP, 
					QT_PERIMETRO_CEFALICO, 
					QT_CA, 
					NR_SEQ_TIPO_EVOLUCAO, 
					NR_SEQ_PAC_GINEC, 
					NR_SEQ_PAC_PRE_NATAL, 
					NR_SEQ_PAC_PRE_NATAL_EVOL, 
					NR_SEQ_ORIGEM, 
					QT_FREQ_CARDIACA, 
					NM_USUARIO_EXPORTACAO, 
					IE_EXPORTADO, 
					DT_EXPORTACAO) 
				SELECT 
					nr_seq_med_evol_w NR_SEQUENCIA, 
					clock_timestamp(), 
					NM_USUARIO_P, 
					DT_EVOLUCAO, 
					' ', 
					NR_SEQ_CLIENTE, 
					QT_PESO, 
					QT_IMC, 
					QT_VARIACAO_PESO, 
					QT_ALTURA_CM, 
					QT_SUPERF_CORPORAL, 
					QT_PA_SISTOLICA, 
					QT_PA_DIASTOLICA, 
					QT_TEMP, 
					QT_PERIMETRO_CEFALICO, 
					QT_CA, 
					NR_SEQ_TIPO_EVOLUCAO, 
					NR_SEQ_PAC_GINEC, 
					NR_SEQ_PAC_PRE_NATAL, 
					NR_SEQ_PAC_PRE_NATAL_EVOL, 
					NR_SEQ_ORIGEM, 
					QT_FREQ_CARDIACA, 
					NM_USUARIO_EXPORTACAO, 
					IE_EXPORTADO, 
					DT_EXPORTACAO 
				FROM MED_EVOLUCAO 
				WHERE NR_SEQUENCIA = nr_seq_evolucao_w;
				 
				commit;
				 
				CALL copia_campo_long_de_para_novo('MED_EVOLUCAO', 
				 'DS_EVOLUCAO', 
				 'where nr_sequencia = :nr_seq_evolucao_w', 
				 'nr_seq_evolucao_w='||nr_seq_evolucao_w, 
				 'MED_EVOLUCAO', 
				 'DS_EVOLUCAO', 
				 'where NR_SEQUENCIA = :nr_seq_med_evol_w', 
				 'nr_seq_med_evol_w='||nr_seq_med_evol_w, 
				 'L');
				 
				commit;
			end if;
 
			INSERT INTO PARTO( 
			 NR_ATENDIMENTO,        
			 DT_ATUALIZACAO,        
			 NM_USUARIO,          
			 QT_GESTACOES,         
			 QT_PARTO_NORMAL,       
			 QT_FILHOS_VIVOS,       
			 QT_FILHOS_MORTOS,       
			 QT_NATIMORTOS,        
			 QT_PARTO_CESARIO,       
			 QT_ABORTOS,          
			 DS_OBSERVACAO_QTDADES,    
			 IE_TIPO_SANGUE_MAE,      
			 IE_FATOR_RH_MAE,       
			 IE_TIPO_SANGUE_PAI,      
			 IE_FATOR_RH_PAI,       
			 IE_EDEMA,           
			 IE_ECOGRAFIA_NORMAL,     
			 DT_ULT_MENSTRUACAO,      
			 DT_PROVAVEL_PARTO,      
			 QT_SEM_IG_CRONOLOGICA,    
			 QT_SEM_IG_ECOGRAFICA,     
			 DS_ANORM_ECOGRAFIA,      
			 DS_SOROLOGIAS,        
			 DS_DOENCAS_GESTACAO,     
			 DS_USO_MEDIC,         
			 DS_ANTECED_PATOLOGICO,    
			 DS_AMAMENTACAO,        
			 IE_PRE_NATAL,         
			 QT_CONSULTAS,         
			 IE_LAQUEADURA,        
			 IE_CURSO_GESTANTE,      
			 DT_ADMISSAO,         
			 DT_CONTRACAO_REGULAR,     
			 QT_PA_DIASTOLICA,       
			 QT_PA_SISTOLICA,       
			 QT_PULSO,           
			 QT_TEMPERATURA,        
			 QT_BAT_CARDIO_FETAIS,     
			 IE_APRESENTACAO_FETAL,    
			 DS_APRESENTACAO_FETAL,    
			 IE_BOLSA_AMNIOTICA_INTEGRO,  
			 HR_BOLSA_AMNIOTICA,      
			 IE_ASPECTO_LIQUIDO,      
			 IE_PARTO_NORMAL,       
			 IE_PARTO_FORCEPS,       
			 IE_PARTO_EPISIO,       
			 IE_PARTO_ANALGESIA,      
			 IE_PARTO_CESARIA,       
			 IE_PERINEO_INTEGRO,      
			 QT_GRAU_PERINEO,       
			 DS_PERINEO,          
			 CD_MEDICO,          
			 CD_ANESTESISTA,        
			 IE_AIDS,           
			 IE_COOMBS,          
			 IE_VACINA_IGD,        
			 DT_VACINA_IGD,        
			 QT_NASC_MORTOS,        
			 QT_NASC_VIVOS,        
			 IE_LOCAL_NASCIMENTO,     
			 IE_VACINA_TETANO,       
			 CD_ENFERMAGEM,        
			 IE_VACINA_RUBEOLA,      
			 QT_CONTRACOES,        
			 DT_INICIO_PARTO,       
			 IE_DEQUITACAO,        
			 IE_PATOLOGIA_FUNICULAR,    
			 CD_TIPO_ANESTESIA,      
			 DT_FIM_PARTO,         
			 IE_DIABETES,         
			 IE_NEOPLASIAS,        
			 IE_HIPERTENSAO,        
			 IE_GEMELARIDADE,       
			 IE_ANEMIA,          
			 IE_TUBERCULOSE,        
			 IE_DIABETES_FAM,       
			 IE_NEOPLASIAS_FAM,      
			 IE_HIPERTENSAO_FAM,      
			 IE_GEMELARIDADE_FAM,     
			 IE_ANEMIA_FAM,        
			 IE_TUBERCULOSE_FAM,      
			 IE_SURDEZ_FAM,        
			 IE_CARDIOPATIAS_FAM,     
			 IE_INFECCAO,         
			 IE_CARDIOPATIA,        
			 IE_ACOMPANHANTE,       
			 DS_ANTECED_FAM,        
			 DS_CIRUR_MAMA,        
			 IE_MAMILOS,          
			 IE_CIRUR_MAMA,        
			 IE_SIFILIS,          
			 IE_RUBEOLA,          
			 IE_TOXOPLASMOSE,       
			 IE_TABAGISMO,         
			 IE_DROGAS,          
			 IE_ETILISMO,         
			 DS_CIGARRO,          
			 DS_DROGAS,          
			 DS_ETILISMO,         
			 DT_COOMBS,          
			 IE_EXAME_COOMBS,       
			 QT_ABORTOS_PARTO,       
			 DS_ACOMPANHANTE,       
			 IE_AIDS_POSITIVO,       
			 IE_SIFILIS_POSITIVO,     
			 IE_RUBEOLA_POSITIVO,     
			 IE_TOXOPLASMOSE_POSITIVO,   
			 IE_ESTREPTOCOCO,       
			 IE_ESTREPTOCOCO_POSITIVO,   
			 IE_ANTIBIOTICO,        
			 DS_EDEMA,           
			 IE_ALERGIA,          
			 DS_ALERGIA,          
			 QT_DIA_IG_CRONOLOGICA,    
			 IE_GERA_EIS,         
			 QT_SEM_IG_INI_PRE_NATAL,   
			 NR_SEQ_INDIC_CESAREA,     
			 IE_CORDAO,          
			 DT_ULT_PARTO,         
			 IE_IMUN_H1N1,         
			 IE_IMUN_GRIPE,        
			 IE_IMUN_HEPATITE_B,      
			 IE_TESTE_RAPIDO_HIV,     
			 IE_INFECCAO_URINARIA,     
			 IE_DHEG,           
			 IE_TPP,            
			 IE_RUPREMA,          
			 IE_DM_GEST,          
			 IE_OUTRAS_INFEC,       
			 IE_COAGULOPATIA,       
			 DT_US,            
			 QT_IG_DIA_US,         
			 DT_PROV_PARTO_US,       
			 DS_TITULACAO_COOMBS,     
			 IE_TIPO_GEMELARIDADE,     
			 QT_FETO,           
			 IE_NAO_SABE_TIPO_SANG_PAI,  
			 IE_NAO_SABE_TIPO_SANG,    
			 IE_DST,            
			 DS_DST,            
			 IE_CIRURGIA_PREVIA,      
			 DS_CIRURGIA_PREVIA,      
			 IE_RISCO_GESTACAO,      
			 NR_SEQ_EVOLUCAO,       
			 NR_GESTANTE_PRE_NATAL,    
			 IE_INVEST_CANAL_VAGINAL,   
			 IE_INVEST_CANAL_RETAL,    
			 DS_OBSERVACAO,        
			 IE_MALFORMACAO,        
			 NR_SEQ_POSICAO_MATERNA,    
			 DS_TIPO_PROTESE,       
			 QT_ABORTOS_ESP,        
			 QT_ABORTOS_PROV,       
			 IE_ANEMIA_PAT,        
			 IE_VULVOVAGINITE,       
			 IE_HIPERTIROIDISMO,      
			 IE_HIPOTIROIDISMO,      
			 IE_INFECCAO_TRATADA,     
			 IE_CORTICOTERAPIA,      
			 QT_SEM_IG_CORTICO,      
			 QT_DIA_IG_CORTICO,      
			 QT_DOSE_MEDIC,        
			 IE_HORMONIO_TIR,       
			 IE_SULFATO_MAG,        
			 IE_DOENCA_AUTOIMUNE,     
			 IE_TIPO_CIRURGIA_MAMA,    
			 QT_IDADE_PRIM_GRAV,      
			 IE_TEMPO_ATB,         
			 DT_PRIM_PARTO,        
			 QT_IDADE_ULT_PARTO,      
			 IE_CATETERISMO,        
			 IE_IDENTIFICAR_FAMILIAR,   
			 IE_ESTREPTOCOCO_MOMENTO,   
			 DS_ESTREPTOCOCO_OBSERVACAO) 
			SELECT 
			 NR_ATENDIMENTO_P,        
			 clock_timestamp(),        
			 NM_USUARIO_P,          
			 QT_GESTACOES,         
			 QT_PARTO_NORMAL,       
			 QT_FILHOS_VIVOS,       
			 QT_FILHOS_MORTOS,       
			 QT_NATIMORTOS,        
			 QT_PARTO_CESARIO,       
			 QT_ABORTOS,          
			 DS_OBSERVACAO_QTDADES,    
			 IE_TIPO_SANGUE_MAE,      
			 IE_FATOR_RH_MAE,       
			 IE_TIPO_SANGUE_PAI,      
			 IE_FATOR_RH_PAI,       
			 IE_EDEMA,           
			 IE_ECOGRAFIA_NORMAL,     
			 DT_ULT_MENSTRUACAO,      
			 DT_PROVAVEL_PARTO,      
			 QT_SEM_IG_CRONOLOGICA,    
			 QT_SEM_IG_ECOGRAFICA,     
			 DS_ANORM_ECOGRAFIA,      
			 DS_SOROLOGIAS,        
			 DS_DOENCAS_GESTACAO,     
			 DS_USO_MEDIC,         
			 DS_ANTECED_PATOLOGICO,    
			 DS_AMAMENTACAO,        
			 IE_PRE_NATAL,         
			 QT_CONSULTAS,         
			 IE_LAQUEADURA,        
			 IE_CURSO_GESTANTE,      
			 DT_ADMISSAO,         
			 DT_CONTRACAO_REGULAR,     
			 QT_PA_DIASTOLICA,       
			 QT_PA_SISTOLICA,       
			 QT_PULSO,           
			 QT_TEMPERATURA,        
			 QT_BAT_CARDIO_FETAIS,     
			 IE_APRESENTACAO_FETAL,    
			 DS_APRESENTACAO_FETAL,    
			 IE_BOLSA_AMNIOTICA_INTEGRO,  
			 HR_BOLSA_AMNIOTICA,      
			 IE_ASPECTO_LIQUIDO,      
			 IE_PARTO_NORMAL,       
			 IE_PARTO_FORCEPS,       
			 IE_PARTO_EPISIO,       
			 IE_PARTO_ANALGESIA,      
			 IE_PARTO_CESARIA,       
			 IE_PERINEO_INTEGRO,      
			 QT_GRAU_PERINEO,       
			 DS_PERINEO,          
			 CD_MEDICO,          
			 CD_ANESTESISTA,        
			 IE_AIDS,           
			 IE_COOMBS,          
			 IE_VACINA_IGD,        
			 DT_VACINA_IGD,        
			 QT_NASC_MORTOS,        
			 QT_NASC_VIVOS,        
			 IE_LOCAL_NASCIMENTO,     
			 IE_VACINA_TETANO,       
			 CD_ENFERMAGEM,        
			 IE_VACINA_RUBEOLA,      
			 QT_CONTRACOES,        
			 DT_INICIO_PARTO,       
			 IE_DEQUITACAO,        
			 IE_PATOLOGIA_FUNICULAR,    
			 CD_TIPO_ANESTESIA,      
			 DT_FIM_PARTO,         
			 IE_DIABETES,         
			 IE_NEOPLASIAS,        
			 IE_HIPERTENSAO,        
			 IE_GEMELARIDADE,       
			 IE_ANEMIA,          
			 IE_TUBERCULOSE,        
			 IE_DIABETES_FAM,       
			 IE_NEOPLASIAS_FAM,      
			 IE_HIPERTENSAO_FAM,      
			 IE_GEMELARIDADE_FAM,     
			 IE_ANEMIA_FAM,        
			 IE_TUBERCULOSE_FAM,      
			 IE_SURDEZ_FAM,        
			 IE_CARDIOPATIAS_FAM,     
			 IE_INFECCAO,         
			 IE_CARDIOPATIA,        
			 IE_ACOMPANHANTE,       
			 DS_ANTECED_FAM,        
			 DS_CIRUR_MAMA,        
			 IE_MAMILOS,          
			 IE_CIRUR_MAMA,        
			 IE_SIFILIS,          
			 IE_RUBEOLA,          
			 IE_TOXOPLASMOSE,       
			 IE_TABAGISMO,         
			 IE_DROGAS,          
			 IE_ETILISMO,         
			 DS_CIGARRO,          
			 DS_DROGAS,          
			 DS_ETILISMO,         
			 DT_COOMBS,          
			 IE_EXAME_COOMBS,       
			 QT_ABORTOS_PARTO,       
			 DS_ACOMPANHANTE,       
			 IE_AIDS_POSITIVO,       
			 IE_SIFILIS_POSITIVO,     
			 IE_RUBEOLA_POSITIVO,     
			 IE_TOXOPLASMOSE_POSITIVO,   
			 IE_ESTREPTOCOCO,       
			 IE_ESTREPTOCOCO_POSITIVO,   
			 IE_ANTIBIOTICO,        
			 DS_EDEMA,           
			 IE_ALERGIA,          
			 DS_ALERGIA,          
			 QT_DIA_IG_CRONOLOGICA,    
			 IE_GERA_EIS,         
			 QT_SEM_IG_INI_PRE_NATAL,   
			 NR_SEQ_INDIC_CESAREA,     
			 IE_CORDAO,          
			 DT_ULT_PARTO,         
			 IE_IMUN_H1N1,         
			 IE_IMUN_GRIPE,        
			 IE_IMUN_HEPATITE_B,      
			 IE_TESTE_RAPIDO_HIV,     
			 IE_INFECCAO_URINARIA,     
			 IE_DHEG,           
			 IE_TPP,            
			 IE_RUPREMA,          
			 IE_DM_GEST,          
			 IE_OUTRAS_INFEC,       
			 IE_COAGULOPATIA,       
			 DT_US,            
			 QT_IG_DIA_US,         
			 DT_PROV_PARTO_US,       
			 DS_TITULACAO_COOMBS,     
			 IE_TIPO_GEMELARIDADE,     
			 QT_FETO,           
			 IE_NAO_SABE_TIPO_SANG_PAI,  
			 IE_NAO_SABE_TIPO_SANG,    
			 IE_DST,            
			 DS_DST,            
			 IE_CIRURGIA_PREVIA,      
			 DS_CIRURGIA_PREVIA,      
			 IE_RISCO_GESTACAO,      
			 nr_seq_med_evol_w, 
			 NR_GESTANTE_PRE_NATAL,    
			 IE_INVEST_CANAL_VAGINAL,   
			 IE_INVEST_CANAL_RETAL,    
			 DS_OBSERVACAO,        
			 IE_MALFORMACAO,        
			 NR_SEQ_POSICAO_MATERNA,    
			 DS_TIPO_PROTESE,       
			 QT_ABORTOS_ESP,        
			 QT_ABORTOS_PROV,       
			 IE_ANEMIA_PAT,        
			 IE_VULVOVAGINITE,       
			 IE_HIPERTIROIDISMO,      
			 IE_HIPOTIROIDISMO,      
			 IE_INFECCAO_TRATADA,     
			 IE_CORTICOTERAPIA,      
			 QT_SEM_IG_CORTICO,      
			 QT_DIA_IG_CORTICO,      
			 QT_DOSE_MEDIC,        
			 IE_HORMONIO_TIR,       
			 IE_SULFATO_MAG,        
			 IE_DOENCA_AUTOIMUNE,     
			 IE_TIPO_CIRURGIA_MAMA,    
			 QT_IDADE_PRIM_GRAV,      
			 IE_TEMPO_ATB,         
			 DT_PRIM_PARTO,        
			 QT_IDADE_ULT_PARTO,      
			 IE_CATETERISMO,        
			 IE_IDENTIFICAR_FAMILIAR,   
			 IE_ESTREPTOCOCO_MOMENTO,   
			 DS_ESTREPTOCOCO_OBSERVACAO  
			FROM PARTO 
			WHERE NR_ATENDIMENTO = nr_atendimento_anterior_w;
			 
			commit;
			 
			INSERT INTO MED_PAC_PRE_NATAL_FATOR( 
				NR_SEQUENCIA, 
				NR_SEQ_PRE_NATAL, 
				NR_SEQ_PARTO, 
				DT_ATUALIZACAO, 
				NM_USUARIO, 
				DT_ATUALIZACAO_NREC, 
				NM_USUARIO_NREC, 
				DS_OBSERVACAO, 
				NR_SEQ_FATOR) 
			SELECT 
				nextval('med_pac_pre_natal_fator_seq') NR_SEQUENCIA, 
				NR_SEQ_PRE_NATAL, 
				NR_ATENDIMENTO_P, 
				clock_timestamp(), 
				NM_USUARIO_P, 
				clock_timestamp(), 
				NM_USUARIO_P, 
				DS_OBSERVACAO, 
				NR_SEQ_FATOR 
			FROM MED_PAC_PRE_NATAL_FATOR 
			WHERE NR_SEQ_PARTO = nr_atendimento_anterior_w;
			 
			commit;
			 
			INSERT INTO MED_PAC_PRE_NATAL_RISCO( 
				NR_SEQUENCIA, 
				NR_SEQ_PRE_NATAL, 
				DT_ATUALIZACAO, 
				NM_USUARIO, 
				DT_ATUALIZACAO_NREC, 
				NM_USUARIO_NREC, 
				NR_SEQ_RISCO, 
				DS_OBSERVACAO, 
				NR_SEQ_PARTO) 
			SELECT 
				nextval('med_pac_pre_natal_risco_seq') NR_SEQUENCIA, 
				NR_SEQ_PRE_NATAL, 
				clock_timestamp(), 
				NM_USUARIO_P, 
				clock_timestamp(), 
				NM_USUARIO_P, 
				NR_SEQ_RISCO, 
				DS_OBSERVACAO, 
				NR_ATENDIMENTO_P 
			FROM MED_PAC_PRE_NATAL_RISCO 
			WHERE NR_SEQ_PARTO = nr_atendimento_anterior_w;
			 
			commit;
 
		end if;
		end;
	end if;
	end;
end if;
			 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE atualizar_atend_pre_natal ( nr_atendimento_p bigint, nm_usuario_p text) FROM PUBLIC;

