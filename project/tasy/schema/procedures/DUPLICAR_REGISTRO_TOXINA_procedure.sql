-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE duplicar_registro_toxina ( nr_sequencia_p bigint, nm_usuario_p text) AS $body$
DECLARE

 
nr_nova_sequencia_w bigint;				

BEGIN 
 
 
 
select	nextval('atendimento_toxina_seq') 
into STRICT 	nr_nova_sequencia_w
;
 
insert	into	atendimento_toxina( 
	nr_sequencia, 
	dt_atualizacao, 
	nm_usuario, 
	dt_atualizacao_nrec, 
	nm_usuario_nrec, 
	nr_atendimento, 
	cd_profissional, 
	dt_avaliacao, 
	ie_situacao, 
	dt_liberacao, 
	dt_inativacao, 
	nm_usuario_inativacao, 
	ds_justificativa, 
	ds_intercorrencia, 
	ds_observacao, 
	dt_aplicacao, 
	nr_aplicacao, 
	cd_pessoa_fisica, 
	dt_ult_aplicacao, 
	ie_quadro_clinico) 
SELECT	nr_nova_sequencia_w, 
	clock_timestamp(), 
	nm_usuario_p, 
	clock_timestamp(), 
	nm_usuario_p, 
	nr_atendimento, 
	(obter_pessoa_fisica_usuario(nm_usuario_p,'C'))::numeric , 
	clock_timestamp(), 
	ie_situacao, 
	null, 
	null, 
	null, 
	ds_justificativa, 
	ds_intercorrencia, 
	ds_observacao, 
	dt_aplicacao, 
	nr_aplicacao, 
	cd_pessoa_fisica, 
	dt_ult_aplicacao, 
	ie_quadro_clinico 
from	atendimento_toxina 
where 	nr_sequencia = nr_sequencia_p;
 
commit;
 
begin		 
	insert	into	atend_toxina_item( 
		nr_sequencia, 
		dt_atualizacao, 
		nm_usuario, 
		dt_atualizacao_nrec, 
		nm_usuario_nrec, 
		nr_seq_art_mov_musculo, 
		nr_seq_atendimento, 
		nr_seq_toxina, 
		qt_dose, 
		qt_dose_adm, 
		qt_dose_prescr, 
		qt_pontos_prev, 
		qt_pontos_adm, 
		dt_aplicacao, 
		cd_pessoa_aplicacao, 
		ie_lado, 
		cd_unidade_medida, 
		ds_justificativa, 
		qt_diluente, 
		ds_regra) 
	SELECT	nextval('atend_toxina_item_seq'), 
		clock_timestamp(), 
		nm_usuario_p, 
		clock_timestamp(), 
		nm_usuario_p, 
		nr_seq_art_mov_musculo, 
		nr_nova_sequencia_w, 
		nr_seq_toxina, 
		qt_dose, 
		qt_dose_adm, 
		qt_dose_prescr, 
		qt_pontos_prev, 
		qt_pontos_adm, 
		dt_aplicacao, 
		cd_pessoa_aplicacao, 
		ie_lado, 
		cd_unidade_medida, 
		ds_justificativa, 
		qt_diluente, 
		ds_regra	 
	from	atend_toxina_item 
	where	nr_seq_atendimento = nr_sequencia_p;
	 
	commit;
end;
 
 
 
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE duplicar_registro_toxina ( nr_sequencia_p bigint, nm_usuario_p text) FROM PUBLIC;

