-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pls_obter_dados_analise_req ( nr_seq_analise_p pls_auditoria.nr_sequencia%type, cd_medico_solicitante_p INOUT pls_requisicao.cd_medico_solicitante%type, nr_seq_prestador_p INOUT pls_requisicao.nr_seq_prestador%type, cd_prestador_p INOUT pls_prestador.cd_prestador%type, ie_regime_internacao_p INOUT pls_requisicao.ie_regime_internacao%type, qt_dia_solicitado_p INOUT pls_requisicao.qt_dia_solicitado%type, ie_carater_internacao_p INOUT pls_requisicao.ie_carater_atendimento%type, nr_seq_clinica_p INOUT pls_requisicao.nr_seq_clinica%type, nr_seq_prestador_exec_p INOUT pls_requisicao.nr_seq_prestador_exec%type, cd_prestador_exec_p INOUT pls_prestador.cd_prestador%type, ie_tipo_atendimento_p INOUT pls_requisicao.ie_tipo_atendimento%type, dt_validade_p INOUT pls_requisicao.dt_validade_senha%type, dt_entrada_hospital_p INOUT pls_requisicao.dt_entrada_hospital%type, ie_regime_atendimento_p INOUT pls_requisicao.ie_regime_atendimento%type, ie_saude_ocupacional_p INOUT pls_requisicao.ie_saude_ocupacional%type) AS $body$
DECLARE

					
nr_seq_requisicao_w	bigint;


BEGIN
select	max(nr_seq_requisicao)
into STRICT	nr_seq_requisicao_w
from	pls_auditoria
where	nr_sequencia = nr_seq_analise_p;

if (nr_seq_requisicao_w IS NOT NULL AND nr_seq_requisicao_w::text <> '') then
	select	max(a.cd_medico_solicitante),
		max(a.nr_seq_prestador),
		max(a.ie_regime_internacao),
		max(a.qt_dia_solicitado),
		max(a.ie_carater_atendimento),
		max(a.nr_seq_clinica),
		max(substr(pls_obter_cod_prestador(a.nr_seq_prestador, null), 1, 255)),
		max(a.nr_seq_prestador_exec),
		max(substr(pls_obter_cod_prestador(a.nr_seq_prestador_exec, null), 1, 255)),
		max(a.ie_tipo_atendimento),
		max(to_char(a.dt_validade_senha, 'dd/mm/yyyy')),
		max(to_char(a.dt_entrada_hospital, 'dd/mm/yyyy')),
		max(a.ie_regime_atendimento),
		max(a.ie_saude_ocupacional)
	into STRICT	cd_medico_solicitante_p,
		nr_seq_prestador_p,
		ie_regime_internacao_p,
		qt_dia_solicitado_p,
		ie_carater_internacao_p,
		nr_seq_clinica_p,
		cd_prestador_p,
		nr_seq_prestador_exec_p,
		cd_prestador_exec_p,
		ie_tipo_atendimento_p,
		dt_validade_p,
		dt_entrada_hospital_p,
		ie_regime_atendimento_p,
		ie_saude_ocupacional_p
	from	pls_requisicao a
	where	a.nr_sequencia = nr_seq_requisicao_w;
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_obter_dados_analise_req ( nr_seq_analise_p pls_auditoria.nr_sequencia%type, cd_medico_solicitante_p INOUT pls_requisicao.cd_medico_solicitante%type, nr_seq_prestador_p INOUT pls_requisicao.nr_seq_prestador%type, cd_prestador_p INOUT pls_prestador.cd_prestador%type, ie_regime_internacao_p INOUT pls_requisicao.ie_regime_internacao%type, qt_dia_solicitado_p INOUT pls_requisicao.qt_dia_solicitado%type, ie_carater_internacao_p INOUT pls_requisicao.ie_carater_atendimento%type, nr_seq_clinica_p INOUT pls_requisicao.nr_seq_clinica%type, nr_seq_prestador_exec_p INOUT pls_requisicao.nr_seq_prestador_exec%type, cd_prestador_exec_p INOUT pls_prestador.cd_prestador%type, ie_tipo_atendimento_p INOUT pls_requisicao.ie_tipo_atendimento%type, dt_validade_p INOUT pls_requisicao.dt_validade_senha%type, dt_entrada_hospital_p INOUT pls_requisicao.dt_entrada_hospital%type, ie_regime_atendimento_p INOUT pls_requisicao.ie_regime_atendimento%type, ie_saude_ocupacional_p INOUT pls_requisicao.ie_saude_ocupacional%type) FROM PUBLIC;

