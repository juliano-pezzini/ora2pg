-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE consistir_regra_loco_regional ( ie_perfor_staus_zubrod_p bigint, ie_karnofski_p INOUT bigint, ie_nivel_ecog_p INOUT bigint, ie_perfor_staus_zubrod_pp INOUT bigint, IE_KARNOFSKI_pp bigint) AS $body$
DECLARE


qt_reg_w		bigint;
ie_karnofski_w		bigint;
ie_nivel_ecog_w		bigint;
IE_PERFOR_STAUS_ZUBROD_w	bigint;


BEGIN

select 	count(*)
into STRICT	qt_reg_w
from	regra_escala_loco_regional;

if (qt_reg_w > 0) then


	select 	max(ie_karnofski),
	 	max(ie_nivel_ecog),
		max(IE_PERFOR_STAUS_ZUBROD)
	into STRICT	ie_karnofski_w,
		ie_nivel_ecog_w,
		IE_PERFOR_STAUS_ZUBROD_w
	from	regra_escala_loco_regional
	where	IE_KARNOFSKI = IE_KARNOFSKI_pp;
	--where	ie_perfor_staus_zubrod = ie_perfor_staus_zubrod_p;
	if 	--(ie_karnofski_w is not null) or
		(ie_nivel_ecog_w IS NOT NULL AND ie_nivel_ecog_w::text <> '') or (IE_PERFOR_STAUS_ZUBROD_w IS NOT NULL AND IE_PERFOR_STAUS_ZUBROD_w::text <> '') then

		--ie_karnofski_p := ie_karnofski_w;
		ie_perfor_staus_zubrod_pp := IE_PERFOR_STAUS_ZUBROD_w;
		ie_nivel_ecog_p := ie_nivel_ecog_w;

	end if;

end if;


commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE consistir_regra_loco_regional ( ie_perfor_staus_zubrod_p bigint, ie_karnofski_p INOUT bigint, ie_nivel_ecog_p INOUT bigint, ie_perfor_staus_zubrod_pp INOUT bigint, IE_KARNOFSKI_pp bigint) FROM PUBLIC;

