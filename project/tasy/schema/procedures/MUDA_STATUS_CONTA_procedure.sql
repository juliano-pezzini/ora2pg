-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE muda_status_conta ( ie_status_p text, nr_sequencia_p text, nm_usuario_p text) AS $body$
DECLARE



cd_estabelecimento_w		estabelecimento.cd_estabelecimento%type;
ie_ctb_online_w			ctb_param_lote_nf.ie_ctb_online%type := 'N';
cd_empresa_w            	empresa.cd_empresa%type;


BEGIN

update terceiro_conta
set ie_status_conta = ie_status_p
where nr_sequencia  = nr_sequencia_p;

commit;

begin
select	a.cd_estabelecimento
into STRICT	cd_estabelecimento_w
from	terceiro_conta a
where	a.nr_sequencia  = nr_sequencia_p;

cd_empresa_w	:= obter_empresa_estab(cd_estabelecimento_w);
ie_ctb_online_w := ctb_online_pck.get_modo_lote( 9 , cd_estabelecimento_w, cd_empresa_w);
exception when others then
	ie_ctb_online_w	:= 'N';
end;

if (ie_ctb_online_w = 'S') then
    begin
    /* Rotina de Contabilização de Controle de Terceiros */

    CALL ctb_contab_onl_controle_terc( nr_sequencia_p,
			ie_status_p,
			nm_usuario_p);
    end;
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE muda_status_conta ( ie_status_p text, nr_sequencia_p text, nm_usuario_p text) FROM PUBLIC;

