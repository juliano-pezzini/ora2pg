-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE san_solicita_token_sht (ds_bifrost_event_p text, nr_seq_lote_p bigint, nm_usuario_p text) AS $body$
DECLARE

						
	ds_param_integ_res_w 	text;
    data_auth_w             text;
	json_login_w			philips_json;
	json_request_w			philips_json;

BEGIN	
	json_login_w		:= philips_json();
	json_request_w		:= philips_json();
	
	json_login_w.put('username', '1595af6435015c77a7149e92a551338e');
	json_login_w.put('password', '86nSp64J');
    json_login_w.put('lote', nr_seq_lote_p);
    json_request_w.put('auth', json_login_w);

	dbms_lob.createtemporary(lob_loc => data_auth_w, cache => true, dur => dbms_lob.call);
    json_request_w.(data_auth_w);

	begin
		select bifrost.send_integration_content(ds_bifrost_event_p, data_auth_w, nm_usuario_p) 
        into STRICT ds_param_integ_res_w
;
	exception
		when others then
		rollback;
	end;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE san_solicita_token_sht (ds_bifrost_event_p text, nr_seq_lote_p bigint, nm_usuario_p text) FROM PUBLIC;

