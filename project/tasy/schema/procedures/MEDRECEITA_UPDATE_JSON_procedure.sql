-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE medreceita_update_json ( nr_seq_med_receita_p med_receita.nr_sequencia%type, cd_ext_idprescricao_p med_receita.cd_ext_idprescricao%type, ie_ext_especial_p med_receita.ie_ext_especial%type, ie_ext_recpapel_p med_receita.ie_ext_recpapel%type, ie_ext_assinada_p med_receita.ie_ext_assinada%type, ds_ext_urlpdf_p med_receita.ds_ext_urlpdf%type, ds_ext_recurlpdf_p med_receita.ds_ext_recurlpdf%type, ds_ext_atsurlpdf_p med_receita.ds_ext_atsurlpdf%type, ds_ext_exmurlpdf_p med_receita.ds_ext_exmurlpdf%type) AS $body$
DECLARE


ds_receita_w med_receita.ds_receita%type;


BEGIN
		
	select replace(obter_desc_expressao(1038770),'@nrreceita',nr_seq_med_receita_p)
	into STRICT ds_receita_w 
	;
	
	ds_receita_w := '<html tasy="html5">'||
			'<p style="text-align:left;">'||
			'<span style="font-size:16px;">'||
				'<a href="'||ds_ext_urlpdf_p||'">'|| ds_receita_w ||'</a>'||
			'</p></span>'||
			'</html>';

	update med_receita
	set ds_receita 	        = ds_receita_w,
	    cd_ext_idprescricao = cd_ext_idprescricao_p,
	    ie_ext_especial     = ie_ext_especial_p,
	    dt_ext_criacao      = clock_timestamp(),
	    ie_ext_recpapel     = ie_ext_recpapel_p,
	    ie_ext_assinada     = ie_ext_assinada_p,
	    ds_ext_urlpdf       = ds_ext_urlpdf_p
	where nr_sequencia = nr_seq_med_receita_p;
	
	
	commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE medreceita_update_json ( nr_seq_med_receita_p med_receita.nr_sequencia%type, cd_ext_idprescricao_p med_receita.cd_ext_idprescricao%type, ie_ext_especial_p med_receita.ie_ext_especial%type, ie_ext_recpapel_p med_receita.ie_ext_recpapel%type, ie_ext_assinada_p med_receita.ie_ext_assinada%type, ds_ext_urlpdf_p med_receita.ds_ext_urlpdf%type, ds_ext_recurlpdf_p med_receita.ds_ext_recurlpdf%type, ds_ext_atsurlpdf_p med_receita.ds_ext_atsurlpdf%type, ds_ext_exmurlpdf_p med_receita.ds_ext_exmurlpdf%type) FROM PUBLIC;

