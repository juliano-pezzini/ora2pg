-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE w_inserir_recomendacao (nr_prescricao_p bigint, cd_recomendacao_p bigint, cd_intervalo_p text, nm_usuario_p text, cd_perfil_p bigint, nr_seq_classif_p bigint) AS $body$
DECLARE


nr_sequencia_w		integer;
ie_prim_horario_w	varchar(255);
ds_recomendacao_w	varchar(2000);
dt_inicio_prescr_w	timestamp;
dt_hora_inicio_w	timestamp;
nr_horas_validade_w	integer;
ie_prescr_rec_sem_lib_w		varchar(255);


BEGIN

select	substr(ds_tipo_recomendacao,1,255)
into STRICT	ds_recomendacao_w
from	tipo_recomendacao
where	cd_tipo_recomendacao	= cd_recomendacao_p;

insert into w_prescr_recomendacao(
	nr_sequencia,
	nr_prescricao,
	nm_usuario,
	cd_recomendacao,
	cd_intervalo,
	ds_recomendacao,
	dt_atualizacao,
	nr_seq_classif)
values (	nextval('w_prescr_recomendacao_seq'),
	nr_prescricao_p,
	nm_usuario_p,
	cd_recomendacao_p,
	cd_intervalo_p,
	ds_recomendacao_w,
	clock_timestamp(),
	nr_seq_classif_p);

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE w_inserir_recomendacao (nr_prescricao_p bigint, cd_recomendacao_p bigint, cd_intervalo_p text, nm_usuario_p text, cd_perfil_p bigint, nr_seq_classif_p bigint) FROM PUBLIC;

