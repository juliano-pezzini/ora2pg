-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE hem_insere_syntax_segmento (cd_segmento_p text, ie_start_p text, nr_seq_lesao_p bigint, nm_usuario_p text) AS $body$
DECLARE

nr_seq_segmento_w	bigint;


BEGIN
if (cd_segmento_p IS NOT NULL AND cd_segmento_p::text <> '') then
	begin
	select	max(nr_sequencia)
	into STRICT	nr_seq_segmento_w
	from	HEM_SEGMENTO_SYNTAX
	where	cd_segmento = cd_segmento_p;

	if (coalesce(nr_seq_segmento_w,0) > 0) then

		insert into hem_syntax_segmento(
			nr_sequencia,
			nr_seq_segmento,
			dt_atualizacao,
			nm_usuario,
			dt_atualizacao_nrec,
			nm_usuario_nrec,
			ie_start,
			nr_seq_lesao)
		values (	nextval('hem_syntax_segmento_seq'),
			nr_seq_segmento_w,
			clock_timestamp(),
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			ie_start_p,
			nr_seq_lesao_p);
	end if;

	if (ie_start_p = 'S') then

		update	hem_syntax_lesao
		set	ie_oclusao_cronica = 'S'
		where	nr_sequencia = nr_seq_lesao_p;

	end if;

	end;
end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE hem_insere_syntax_segmento (cd_segmento_p text, ie_start_p text, nr_seq_lesao_p bigint, nm_usuario_p text) FROM PUBLIC;

