-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE proj_importar_calendario ( NR_SEQ_CALENDARIO_P bigint, NR_SEQ_CRONOGRAMA_P bigint, NM_USUARIO_P text ) AS $body$
BEGIN
	
	insert into PROJ_CRON_EXCESSAO(
		DS_EXCESSAO,
		DT_ATUALIZACAO,
		DT_ATUALIZACAO_NREC,
		DT_FINAL,
		DT_HR_FINAL,
		DT_HR_INICIO,
		DT_INICIAL,
		HR_FINAL,
		HR_INICIO,
		IE_TIPO_EXCESSAO,
		NM_USUARIO,
		NM_USUARIO_NREC,
		NR_SEQ_CRONOGRAMA,
		NR_SEQUENCIA,
		QT_MIN_INTERVALO
	) SELECT DS_EXCECAO,
		clock_timestamp(),
		clock_timestamp(),
		DT_FINAL,
		DT_HR_FINAL,
		DT_HR_INICIO,
		DT_INICIAL,
		HR_FINAL,
		HR_INICIO,
		IE_TIPO_EXCECAO,
		NM_USUARIO_P,
		NM_USUARIO_P,
		NR_SEQ_CRONOGRAMA_P,
		nextval('proj_cron_excessao_seq'),
		QT_MIN_INTERVALO
	from 	PROJ_CAL_EXCECAO_PADRAO
	where 	NR_SEQ_CALENDARIO = NR_SEQ_CALENDARIO_P
	;
	
	insert into PROJ_CRON_CALENDARIO(
		DT_ATUALIZACAO,
		DT_ATUALIZACAO_NREC,
		DT_HR_FINAL,
		DT_HR_INICIO,
		HR_FINAL,
		HR_INICIO,
		IE_DIA_SEMANA,
		NM_USUARIO,
		NM_USUARIO_NREC,
		NR_SEQ_CRONOGRAMA,
		NR_SEQUENCIA,
		QT_MIN_INTERVALO
	) SELECT clock_timestamp(),
		clock_timestamp(),
		DT_HR_FINAL,
		DT_HR_INICIO,
		HR_FINAL,
		HR_INICIO,
		IE_DIA_SEMANA,
		NM_USUARIO_P,
		NM_USUARIO_P,
		NR_SEQ_CRONOGRAMA_P,
		nextval('proj_cron_calendario_seq'),
		QT_MIN_INTERVALO
	from 	PROJ_CALENDARIO_PADRAO
	where 	NR_SEQ_CALENDARIO = NR_SEQ_CALENDARIO_P;

	commit;
	
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE proj_importar_calendario ( NR_SEQ_CALENDARIO_P bigint, NR_SEQ_CRONOGRAMA_P bigint, NM_USUARIO_P text ) FROM PUBLIC;

