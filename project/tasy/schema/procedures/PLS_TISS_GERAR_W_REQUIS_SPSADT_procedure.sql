-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pls_tiss_gerar_w_requis_spsadt ( nr_seq_requisicao_p bigint, ds_dir_padrao_p text, cd_estabelecimento_p bigint, nm_usuario_p text) AS $body$
DECLARE

 
cd_guia_w			varchar(20);
cd_guia_principal_w		varchar(20);
cd_ans_w			varchar(20);
cd_senha_w			varchar(20);
dt_autorizacao_w		timestamp;
dt_validade_senha_w		timestamp;
dt_emissao_w			timestamp;
nr_seq_plano_w			bigint;
nr_seq_segurado_w		bigint;
cd_medico_solicitante_w		varchar(10);
nr_seq_prestador_w		bigint;
cd_usuario_plano_w		varchar(30);
dt_validade_carteira_w		timestamp;
cd_pessoa_fisica_w		varchar(10);
ds_plano_w			varchar(255);
ie_carater_atendimento_w	varchar(1);
nr_seq_tiss_guia_w		bigint;
nr_cartao_nac_sus_w		varchar(60);
nm_pessoa_fisica_w		varchar(255);
sg_conselho_w			varchar(20);
cd_doenca_cid_w			varchar(10);
ds_diagnostico_w		varchar(2000);
cd_tabela_relat_w		varchar(2);
cd_porte_anestesico_w		varchar(10);
ds_retorno_w			varchar(255);
ds_indicacao_w			varchar(255);

cgc_exec_w			varchar(14);
cpf_exec_w			varchar(50);
nm_contratado_exec_w		varchar(255);
ds_logradouro_w			varchar(255);
nm_municipio_w			varchar(255);
sg_estado_w			pessoa_juridica.sg_estado%type;
cd_municipio_ibge_w		varchar(15);
cd_cep_w			varchar(50);
cd_cnes_w			varchar(20);

qt_proc_req_w 			bigint;
nr_seq_apresentacao_w		bigint;
nr_seq_req_proc_w		bigint;
cd_procedimento_w		bigint;
nr_seq_guia_principal_w		bigint;
ds_procedimento_w		varchar(255);
ie_origem_proced_w		bigint;
qt_solicitada_w			pls_requisicao_proc.qt_solicitado%type;
qt_autorizada_w			pls_requisicao_proc.qt_procedimento%type;
nr_cpf_w			varchar(11);
nr_crm_w			varchar(20);
uf_crm_w			medico.uf_crm%type;
cd_cbo_w			varchar(10);
nm_medico_solicitante_w		varchar(255);
ds_observacao_w			varchar(4000);

vl_procedimento_w		double precision;
vl_custo_oper_w			double precision;
vl_anestesista_w		double precision;
vl_medico_w			double precision;
vl_filme_w			double precision;
vl_auxiliares_w			double precision;
nr_seq_regra_w			bigint;
cd_edicao_amb_w			integer;
ie_valor_informado_w		varchar(1)	:= 'N';
nr_aux_regra_w			bigint;
nr_seq_regra_autogerado_w	bigint;
ie_tipo_compl_prest_w		varchar(4);
ds_endereco_w			varchar(255);
ds_complemento_w		varchar(255);
ds_bairro_w			varchar(255);
ds_email_w			varchar(255);
ds_website_w			varchar(255);
ds_fax_w			varchar(80);
nr_telefone_w			varchar(30);
nr_tel_simples_w		varchar(30);
ds_fone_adic_w			varchar(255);
nr_ddi_telefone_w		varchar(6);
nr_ddd_telefone_w		varchar(6);
nr_endereco_w			varchar(5);
nr_ramal_w			integer;
nr_ddd_fax_w			varchar(3);
ds_municipio_w			varchar(40);
cd_prestador_exec_w		varchar(30);
nr_seq_prestador_exec_w		bigint;
nr_seq_compl_pf_tel_adic_w	pls_prestador.nr_seq_compl_pf_tel_adic%type;
nr_seq_tipo_compl_adic_w	pls_prestador.nr_seq_tipo_compl_adic%type;

c01 CURSOR FOR 
	SELECT	nr_sequencia, 
		cd_procedimento, 
		substr(obter_descricao_procedimento(cd_procedimento,ie_origem_proced),1,255), 
		ie_origem_proced, 
		qt_solicitado, 
		qt_procedimento 
	from	pls_requisicao_proc 
	where	nr_seq_requisicao	= nr_seq_requisicao_p 
	and	ie_status		in ('S','P') 
	and	coalesce(nr_seq_motivo_exc::text, '') = '';


BEGIN 
 
delete	from w_tiss_guia 
where	nm_usuario		= nm_usuario_p;
 
delete	from w_tiss_dados_atendimento 
where	nm_usuario		= nm_usuario_p;
 
delete	from w_tiss_beneficiario 
where	nm_usuario		= nm_usuario_p;
 
delete	from w_tiss_proc_paciente 
where	nm_usuario		= nm_usuario_p;
 
delete	from w_tiss_contratado_exec 
where	nm_usuario		= nm_usuario_p;
 
delete	from w_tiss_totais 
where	nm_usuario		= nm_usuario_p;
 
delete	from w_tiss_proc_solic 
where	nm_usuario		= nm_usuario_p;
 
delete	from w_tiss_solicitacao 
where	nm_usuario		= nm_usuario_p;
 
delete	from w_tiss_contratado_solic 
where	nm_usuario		= nm_usuario_p;
 
delete	from w_tiss_relatorio 
where	nm_usuario		= nm_usuario_p;
 
delete	from w_tiss_opm 
where	nm_usuario		= nm_usuario_p;
 
delete	from w_tiss_opm_exec 
where	nm_usuario		= nm_usuario_p;
 
commit;
 
if (coalesce(nr_seq_requisicao_p,0) > 0) then 
	begin 
		select	coalesce(a.cd_senha,a.cd_senha_externa), 
			a.dt_requisicao, 
			a.dt_validade_senha, 
			a.nr_seq_plano, 
			a.nr_seq_segurado, 
			a.cd_medico_solicitante, 
			a.nr_seq_prestador, 
			a.nr_seq_prestador_exec, 
			substr(pls_obter_dados_cart_segurado(a.nr_seq_segurado,'C'),1,30), 
			to_date(pls_obter_dados_cart_segurado(a.nr_seq_segurado,'V'),'dd/mm/yyyy'), 
			b.cd_pessoa_fisica, 
			c.ds_plano, 
			a.ie_carater_atendimento, 
			a.cd_guia_principal, 
			substr(a.ds_observacao,1,255), 
			substr(a.ds_indicacao_clinica,1,255) 
		into STRICT	cd_senha_w, 
			dt_autorizacao_w, 
			dt_validade_senha_w, 
			nr_seq_plano_w, 
			nr_seq_segurado_w, 
			cd_medico_solicitante_w, 
			nr_seq_prestador_w, 
			nr_seq_prestador_exec_w, 
			cd_usuario_plano_w, 
			dt_validade_carteira_w, 
			cd_pessoa_fisica_w, 
			ds_plano_w, 
			ie_carater_atendimento_w, 
			cd_guia_principal_w, 
			ds_observacao_w, 
			ds_indicacao_w 
		from	pls_plano c, 
			pls_segurado b, 
			pls_requisicao a 
		where	a.nr_sequencia		= nr_seq_requisicao_p 
		and	a.nr_seq_segurado	= b.nr_sequencia 
		and	b.nr_seq_plano		= c.nr_sequencia;
	exception 
	when others then 
		cd_senha_w			:= '';
		dt_autorizacao_w		:= null;
		dt_validade_senha_w		:= null;
		nr_seq_plano_w			:= null;
		nr_seq_segurado_w		:= null;
		cd_medico_solicitante_w		:= null;
		nr_seq_prestador_w		:= null;
		nr_seq_prestador_exec_w		:= null;
		cd_usuario_plano_w		:= '';
		dt_validade_carteira_w		:= null;
		cd_pessoa_fisica_w		:= null;
		ds_plano_w			:= '';
		ie_carater_atendimento_w	:= '';
		cd_guia_principal_w		:= '';
		ds_observacao_w			:= '';
		ds_indicacao_w			:= '';
	end;
	 
	begin 
		select	max(cd_ans) 
		into STRICT	cd_ans_w 
		from	pls_outorgante 
		where	(cd_ans IS NOT NULL AND cd_ans::text <> '');
	exception 
	when others then 
		cd_ans_w := pls_obter_dados_outorgante(cd_estabelecimento_p, 'ANS');
	end;
	 
	insert	into w_tiss_relatorio(nr_sequencia, 
		dt_atualizacao, 
		nm_usuario, 
		dt_atualizacao_nrec, 
		nm_usuario_nrec, 
		ds_arquivo_logo) 
	values (nextval('w_tiss_relatorio_seq'), 
		clock_timestamp(), 
		nm_usuario_p, 
		clock_timestamp(), 
		nm_usuario_p, 
		ds_dir_padrao_p || '\pls_logo.jpg');
 
	qt_proc_req_w 		:= 0;
	nr_seq_apresentacao_w	:= 0;
 
	open c01;
	loop 
	fetch c01 into	nr_seq_req_proc_w, 
			cd_procedimento_w, 
			ds_procedimento_w, 
			ie_origem_proced_w, 
			qt_solicitada_w, 
			qt_autorizada_w;
	EXIT WHEN NOT FOUND; /* apply on c01 */
		begin 
		qt_proc_req_w		:= qt_proc_req_w + 1;
 
		if (qt_proc_req_w = 1) then 
			select	nextval('w_tiss_guia_seq') 
			into STRICT	nr_seq_tiss_guia_w 
			;
 
			insert	into w_tiss_guia(nr_sequencia, 
				dt_atualizacao, 
				nm_usuario, 
				cd_ans, 
				cd_autorizacao, 
				dt_autorizacao, 
				cd_senha, 
				dt_validade_senha, 
				dt_emissao_guia, 
				nr_sequencia_autor, 
				cd_autorizacao_princ, 
				ds_observacao, 
				ie_tiss_tipo_guia, 
				dt_entrada) 
			values (nr_seq_tiss_guia_w, 
				clock_timestamp(), 
				nm_usuario_p, 
				cd_ans_w, 
				cd_guia_w, 
				dt_autorizacao_w, 
				cd_senha_w, 
				dt_validade_senha_w, 
				null, 
				nr_seq_requisicao_p, 
				cd_guia_principal_w, 
				ds_observacao_w, 
				'2', 
				null);
 
			begin 
				select	nr_cartao_nac_sus, 
					substr(obter_nome_pf(cd_pessoa_fisica),1,255) 
				into STRICT	nr_cartao_nac_sus_w, 
					nm_pessoa_fisica_w 
				from	pessoa_fisica 
				where	cd_pessoa_fisica	= cd_pessoa_fisica_w;
			exception 
			when others then 
				nr_cartao_nac_sus_w	:= '';
				nm_pessoa_fisica_w	:= '';
			end;
 
			insert	into w_tiss_beneficiario(nr_sequencia, 
				dt_atualizacao, 
				nm_usuario, 
				nr_seq_guia, 
				cd_pessoa_fisica, 
				nm_pessoa_fisica, 
				nr_cartao_nac_sus, 
				ds_plano, 
				dt_validade_carteira, 
				cd_usuario_convenio) 
			values (nextval('w_tiss_beneficiario_seq'), 
				clock_timestamp(), 
				nm_usuario_p, 
				nr_seq_tiss_guia_w, 
				cd_pessoa_fisica_w, 
				nm_pessoa_fisica_w, 
				nr_cartao_nac_sus_w, 
				ds_plano_w, 
				dt_validade_carteira_w, 
				cd_usuario_plano_w);
 
			begin 
				select	b.nr_cpf, 
					substr(obter_nome_pf(a.cd_pessoa_fisica),1,255), 
					substr(obter_conselho_profissional(b.nr_seq_conselho,'S'),1,10), 
					nr_crm, 
					uf_crm, 
					substr(obter_descricao_padrao('CBO_SAUDE','CD_CBO',b.nr_seq_cbo_saude),1,10) 
				into STRICT	nr_cpf_w, 
					nm_medico_solicitante_w, 
					sg_conselho_w, 
					nr_crm_w, 
					uf_crm_w, 
					cd_cbo_w 
				from	pessoa_fisica b, 
					medico a 
				where	a.cd_pessoa_fisica	= b.cd_pessoa_fisica 
				and	a.cd_pessoa_fisica	= cd_medico_solicitante_w;
			exception 
			when others then 
				nr_cpf_w := null;
				nm_medico_solicitante_w := null;
				sg_conselho_w := null;
				nr_crm_w := null;
				uf_crm_w := null;
				cd_cbo_w := null;
			end;
			 
			insert into w_tiss_contratado_solic(nr_sequencia, 
				dt_atualizacao, 
				nm_usuario, 
				nr_seq_guia, 
				cd_cgc, 
				cd_interno, 
				nr_cpf, 
				nm_contratado, 
				nm_solicitante, 
				cd_cnes, 
				sg_conselho, 
				nr_crm, 
				uf_crm, 
				cd_cbo_saude) 
			values (nextval('w_tiss_contratado_solic_seq'), 
				clock_timestamp(), 
				nm_usuario_p, 
				nr_seq_tiss_guia_w, 
				'', 
				pls_obter_dados_prestador(nr_seq_prestador_w,'CD'), 
				obter_compl_pf(cd_medico_solicitante_w,1,'CPF'), 
				pls_obter_dados_prestador(nr_seq_prestador_w,'NF'), 
				nm_medico_solicitante_w, 
				pls_obter_dados_prestador(nr_seq_prestador_w,'CNES'), 
				sg_conselho_w, 
				nr_crm_w, 
				uf_crm_w, 
				cd_cbo_w);
 
			select	max(cd_doenca), 
				max(ds_diagnostico) 
			into STRICT	cd_doenca_cid_w, 
				ds_diagnostico_w 
			from	pls_requisicao_diagnostico 
			where	nr_seq_requisicao	= nr_seq_requisicao_p 
			and	ie_classificacao	= 'P';
			 
			insert into w_tiss_solicitacao(nr_sequencia, 
				dt_atualizacao, 
				nm_usuario, 
				nr_seq_guia, 
				dt_solicitacao, 
				ie_carater_solic, 
				cd_cid, 
				ds_indicacao) 
			values (nextval('w_tiss_solicitacao_seq'), 
				clock_timestamp(), 
				nm_usuario_p, 
				nr_seq_tiss_guia_w, 
				dt_autorizacao_w, 
				ie_carater_atendimento_w, 
				cd_doenca_cid_w, 
				ds_indicacao_w);
		end if;
		 
		nr_seq_apresentacao_w	:= nr_seq_apresentacao_w + 1;
		cd_tabela_relat_w := pls_obter_tabela_proc_guia(nr_seq_requisicao_p, cd_estabelecimento_p, nr_seq_prestador_w, cd_procedimento_w, ie_origem_proced_w, dt_autorizacao_w);
 
		insert into w_tiss_proc_solic(nr_sequencia, 
			dt_atualizacao, 
			nm_usuario, 
			nr_seq_guia, 
			cd_procedimento, 
			cd_edicao_amb, 
			ds_procedimento, 
			qt_solicitada, 
			qt_autorizada, 
			nr_seq_apresentacao) 
		values (nextval('w_tiss_proc_solic_seq'), 
			clock_timestamp(), 
			nm_usuario_p, 
			nr_seq_tiss_guia_w, 
			cd_procedimento_w, 
			cd_tabela_relat_w, 
			ds_procedimento_w, 
			qt_solicitada_w, 
			qt_autorizada_w, 
			nr_seq_apresentacao_w);
 
		if (qt_proc_req_w = 5) then 
			if (nr_seq_prestador_w IS NOT NULL AND nr_seq_prestador_w::text <> '') then 
				begin 
					select	pls_obter_dados_prestador(nr_sequencia,'CGC'), 
						pls_obter_dados_prestador(nr_sequencia,'PF'), 
						ie_tipo_endereco, 
						cd_prestador, 
						nr_seq_compl_pf_tel_adic, 
						nr_seq_tipo_compl_adic 
					into STRICT	cgc_exec_w, 
						cpf_exec_w, 
						ie_tipo_compl_prest_w, 
						cd_prestador_exec_w, 
						nr_seq_compl_pf_tel_adic_w, 
						nr_seq_tipo_compl_adic_w 
					from	pls_prestador 
					where	nr_sequencia	= nr_seq_prestador_exec_w;
				exception 
				when others then 
					cgc_exec_w		:= '';
					cpf_exec_w		:= '';
					ie_tipo_compl_prest_w	:= '';
					cd_prestador_exec_w	:= '';
				end;
 
				nm_contratado_exec_w	:= pls_obter_dados_prestador(nr_seq_prestador_exec_w,'NF');
			end if;
			if	((cpf_exec_w IS NOT NULL AND cpf_exec_w::text <> '') or (cgc_exec_w IS NOT NULL AND cgc_exec_w::text <> '')) then 
				SELECT * FROM pls_obter_dados_end_prestador(	cpf_exec_w, cgc_exec_w, ie_tipo_compl_prest_w, 'N', nr_seq_compl_pf_tel_adic_w, nr_seq_tipo_compl_adic_w, ds_endereco_w, nr_endereco_w, ds_complemento_w, ds_bairro_w, cd_cep_w, nr_telefone_w, ds_email_w, ds_website_w, nr_ddi_telefone_w, nr_ddd_telefone_w, nr_ramal_w, cd_municipio_ibge_w, sg_estado_w, ds_fax_w, nr_ddd_fax_w, ds_municipio_w, ds_fone_adic_w) INTO STRICT ds_endereco_w, nr_endereco_w, ds_complemento_w, ds_bairro_w, cd_cep_w, nr_telefone_w, ds_email_w, ds_website_w, nr_ddi_telefone_w, nr_ddd_telefone_w, nr_ramal_w, cd_municipio_ibge_w, sg_estado_w, ds_fax_w, nr_ddd_fax_w, ds_municipio_w, ds_fone_adic_w;
 
				ds_logradouro_w	:= substr(pls_obter_end_prestador(nr_seq_prestador_w,null, null),1,255);
				if (cd_municipio_ibge_w IS NOT NULL AND cd_municipio_ibge_w::text <> '') then 
					nm_municipio_w	:= substr(obter_desc_municipio_ibge(cd_municipio_ibge_w),1,255);
				end if;
				cd_cnes_w		:= obter_dados_pf_pj(cpf_exec_w,cgc_exec_w,'CNES');
			end if;
					 
			insert	into w_tiss_contratado_exec(nr_sequencia, 	dt_atualizacao, nm_usuario, 
				 nr_seq_guia, cd_cgc, cd_interno, 
				 nr_cpf, nm_contratado, ds_tipo_logradouro, 
				 ds_logradouro, nm_municipio, sg_estado, 
				 cd_municipio_ibge, cd_cep, cd_cnes) 
			values (nextval('w_tiss_contratado_exec_seq'),clock_timestamp(),nm_usuario_p, 
				 nr_seq_tiss_guia_w, cgc_exec_w, cd_prestador_exec_w, 
				 cpf_exec_w, nm_contratado_exec_w,'', 
				 substr(ds_logradouro_w,1,53), nm_municipio_w, sg_estado_w, 
				 cd_municipio_ibge_w, cd_cep_w, cd_cnes_w);
 
			insert into w_tiss_proc_paciente(nr_sequencia, 
				dt_atualizacao, 
				nm_usuario, 
				nr_seq_guia) 
			values (nextval('w_tiss_proc_paciente_seq'), 
				clock_timestamp(), 
				nm_usuario_p, 
				nr_seq_tiss_guia_w);
 
			insert	into w_tiss_totais(nr_sequencia, 
				dt_atualizacao, 
				nm_usuario, 
				nr_seq_guia) 
			values (nextval('w_tiss_totais_seq'), 
				clock_timestamp(), 
				nm_usuario_p, 
				nr_seq_tiss_guia_w);
 
			qt_proc_req_w	:= 0;
		end if;
		end;
	end loop;
	close c01;
 
	if (qt_proc_req_w > 0) and (qt_proc_req_w < 5) then 
		if (nr_seq_prestador_w IS NOT NULL AND nr_seq_prestador_w::text <> '') then 
			begin 
				select	pls_obter_dados_prestador(nr_sequencia,'CGC'), 
					pls_obter_dados_prestador(nr_sequencia,'PF'), 
					ie_tipo_endereco, 
					cd_prestador, 
					nr_seq_compl_pf_tel_adic, 
					nr_seq_tipo_compl_adic 
				into STRICT	cgc_exec_w, 
					cpf_exec_w, 
					ie_tipo_compl_prest_w, 
					cd_prestador_exec_w, 
					nr_seq_compl_pf_tel_adic_w, 
					nr_seq_tipo_compl_adic_w 
				from	pls_prestador 
				where	nr_sequencia	= nr_seq_prestador_exec_w;
			exception 
			when others then 
				cgc_exec_w		:= '';
				cpf_exec_w		:= '';
				ie_tipo_compl_prest_w	:= '';
				cd_prestador_exec_w	:= '';
			end;
 
			nm_contratado_exec_w	:= pls_obter_dados_prestador(nr_seq_prestador_exec_w,'NF');
		end if;
 
		if	((cpf_exec_w IS NOT NULL AND cpf_exec_w::text <> '') or (cgc_exec_w IS NOT NULL AND cgc_exec_w::text <> '')) then 
			SELECT * FROM pls_obter_dados_end_prestador(	cpf_exec_w, cgc_exec_w, ie_tipo_compl_prest_w, 'N', nr_seq_compl_pf_tel_adic_w, nr_seq_tipo_compl_adic_w, ds_endereco_w, nr_endereco_w, ds_complemento_w, ds_bairro_w, cd_cep_w, nr_telefone_w, ds_email_w, ds_website_w, nr_ddi_telefone_w, nr_ddd_telefone_w, nr_ramal_w, cd_municipio_ibge_w, sg_estado_w, ds_fax_w, nr_ddd_fax_w, ds_municipio_w, ds_fone_adic_w) INTO STRICT ds_endereco_w, nr_endereco_w, ds_complemento_w, ds_bairro_w, cd_cep_w, nr_telefone_w, ds_email_w, ds_website_w, nr_ddi_telefone_w, nr_ddd_telefone_w, nr_ramal_w, cd_municipio_ibge_w, sg_estado_w, ds_fax_w, nr_ddd_fax_w, ds_municipio_w, ds_fone_adic_w;
 
			ds_logradouro_w	:=	substr(pls_obter_end_prestador(nr_seq_prestador_exec_w,null, null),1,255);
			 
			if (cd_municipio_ibge_w IS NOT NULL AND cd_municipio_ibge_w::text <> '') then 
				nm_municipio_w	:= substr(obter_desc_municipio_ibge(cd_municipio_ibge_w),1,255);
			end if;
			 
			cd_cnes_w		:= obter_dados_pf_pj(cpf_exec_w,cgc_exec_w,'CNES');
		end if;
 
		insert	into w_tiss_contratado_exec(nr_sequencia, 	dt_atualizacao, nm_usuario, 
			 nr_seq_guia, cd_cgc, cd_interno, 
			 nr_cpf, nm_contratado, ds_tipo_logradouro, 
			 ds_logradouro, nm_municipio, sg_estado, 
			 cd_municipio_ibge, cd_cep, cd_cnes) 
		values (nextval('w_tiss_contratado_exec_seq'),clock_timestamp(),nm_usuario_p, 
			 nr_seq_tiss_guia_w, cgc_exec_w, cd_prestador_exec_w, 
			 cpf_exec_w, nm_contratado_exec_w,'', 
			 substr(ds_logradouro_w,1,53), nm_municipio_w, sg_estado_w, 
			 cd_municipio_ibge_w, cd_cep_w, cd_cnes_w);
 
		insert into w_tiss_proc_paciente(nr_sequencia, 
			dt_atualizacao, 
			nm_usuario, 
			nr_seq_guia) 
		values (nextval('w_tiss_proc_paciente_seq'), 
			clock_timestamp(), 
			nm_usuario_p, 
			nr_seq_tiss_guia_w);
 
		insert	into w_tiss_totais(nr_sequencia, 
			dt_atualizacao, 
			nm_usuario, 
			nr_seq_guia) 
		values (nextval('w_tiss_totais_seq'), 
			clock_timestamp(), 
			nm_usuario_p, 
			nr_seq_tiss_guia_w);
	end if;
 
	CALL pls_tiss_completar_req_guia(nr_seq_tiss_guia_w, nm_usuario_p);
end if;
 
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_tiss_gerar_w_requis_spsadt ( nr_seq_requisicao_p bigint, ds_dir_padrao_p text, cd_estabelecimento_p bigint, nm_usuario_p text) FROM PUBLIC;

