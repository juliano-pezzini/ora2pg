-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE atualizar_subsecao ( nr_seq_documento_secao_p bigint, nr_sequencia_p bigint, nr_seq_apresentacao_p bigint, ie_tipo_dosagem_p text, nr_seq_inf_adic_p bigint, ie_membro_p text, ie_aparelho_pa_p text, ie_pupila_lado_p text, ds_lista_removidos_p text) AS $body$
BEGIN
if (nr_seq_documento_secao_p IS NOT NULL AND nr_seq_documento_secao_p::text <> '') then --Pelo localizador
	CALL localizador_subsecao_pck.atualizar_subsecao( nr_seq_documento_secao_p,
												  nr_sequencia_p,
												  nr_seq_apresentacao_p,
												  ie_tipo_dosagem_p,
												  nr_seq_inf_adic_p,
												  ie_membro_p,
												  ie_aparelho_pa_p,
												  ie_pupila_lado_p,
												  ds_lista_removidos_p);
elsif (coalesce(ds_lista_removidos_p::text, '') = '') and (nr_sequencia_p IS NOT NULL AND nr_sequencia_p::text <> '') then --Pelo botao de excluir
	delete	from	documento_subsecao
	where	((nr_sequencia = nr_sequencia_p) or (nr_seq_superior = nr_sequencia_p));
	commit;
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE atualizar_subsecao ( nr_seq_documento_secao_p bigint, nr_sequencia_p bigint, nr_seq_apresentacao_p bigint, ie_tipo_dosagem_p text, nr_seq_inf_adic_p bigint, ie_membro_p text, ie_aparelho_pa_p text, ie_pupila_lado_p text, ds_lista_removidos_p text) FROM PUBLIC;

