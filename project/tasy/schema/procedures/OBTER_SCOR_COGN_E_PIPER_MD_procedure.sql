-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_scor_cogn_e_piper_md (QT_SENTINDO_PACIENTE_P bigint, QT_SENTINDO_RELAXADO_P bigint, QT_SENTINDO_FELIZ_P bigint, QT_SENTINDO_CONCENTRAR_P bigint, QT_SENTINDO_LEMBRAR_P bigint, QT_SENTINDO_PENSAR_P bigint, QT_SCORE_COGNITIVO_p INOUT bigint, qt_reg_cognitivo_p INOUT bigint, qt_result_cognitivo_p INOUT bigint ) AS $body$
DECLARE


	qt_reg_cognitivo_w		integer := 0;
	qt_percent_subgrupo_w	integer := 0;
	qt_result_cognitivo_w	double precision := 0;

BEGIN
	--- Inicio MD4
	if (QT_SENTINDO_PACIENTE_P IS NOT NULL AND QT_SENTINDO_PACIENTE_P::text <> '') then
		qt_reg_cognitivo_w	:= 	qt_reg_cognitivo_w + 1;
		qt_result_cognitivo_w 	:= 	qt_result_cognitivo_w +  coalesce(QT_SENTINDO_PACIENTE_P,0);
	end if;
	if (QT_SENTINDO_RELAXADO_P IS NOT NULL AND QT_SENTINDO_RELAXADO_P::text <> '') then
		qt_reg_cognitivo_w	:= 	qt_reg_cognitivo_w + 1;
		qt_result_cognitivo_w 	:= 	qt_result_cognitivo_w +  coalesce(QT_SENTINDO_RELAXADO_P,0);
	end if;
	if (QT_SENTINDO_FELIZ_P IS NOT NULL AND QT_SENTINDO_FELIZ_P::text <> '') then
		qt_reg_cognitivo_w	:= 	qt_reg_cognitivo_w + 1;
		qt_result_cognitivo_w 	:= 	qt_result_cognitivo_w +  coalesce(QT_SENTINDO_FELIZ_P,0);
	end if;
	if (QT_SENTINDO_CONCENTRAR_P IS NOT NULL AND QT_SENTINDO_CONCENTRAR_P::text <> '') then
		qt_reg_cognitivo_w	:= 	qt_reg_cognitivo_w + 1;
		qt_result_cognitivo_w 	:= 	qt_result_cognitivo_w +  coalesce(QT_SENTINDO_CONCENTRAR_P,0);
	end if;
	if (QT_SENTINDO_LEMBRAR_P IS NOT NULL AND QT_SENTINDO_LEMBRAR_P::text <> '') then
		qt_reg_cognitivo_w	:= 	qt_reg_cognitivo_w + 1;
		qt_result_cognitivo_w 	:= 	qt_result_cognitivo_w +  coalesce(QT_SENTINDO_LEMBRAR_P,0);
	end if;
	if (QT_SENTINDO_PENSAR_P IS NOT NULL AND QT_SENTINDO_PENSAR_P::text <> '') then
		qt_reg_cognitivo_w	:= 	qt_reg_cognitivo_w + 1;
		qt_result_cognitivo_w 	:= 	qt_result_cognitivo_w +  coalesce(QT_SENTINDO_PENSAR_P,0);
	end if;
	
	if (qt_reg_cognitivo_w >= 5) then
		qt_percent_subgrupo_w	:= 	qt_percent_subgrupo_w + 1;
		QT_SCORE_COGNITIVO_p	:= 	dividir_md(qt_result_cognitivo_w,qt_reg_cognitivo_w);
	end if;
	--- Fim MD4
  qt_reg_cognitivo_p    := qt_reg_cognitivo_w;
	qt_result_cognitivo_p := qt_result_cognitivo_w;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_scor_cogn_e_piper_md (QT_SENTINDO_PACIENTE_P bigint, QT_SENTINDO_RELAXADO_P bigint, QT_SENTINDO_FELIZ_P bigint, QT_SENTINDO_CONCENTRAR_P bigint, QT_SENTINDO_LEMBRAR_P bigint, QT_SENTINDO_PENSAR_P bigint, QT_SCORE_COGNITIVO_p INOUT bigint, qt_reg_cognitivo_p INOUT bigint, qt_result_cognitivo_p INOUT bigint ) FROM PUBLIC;

