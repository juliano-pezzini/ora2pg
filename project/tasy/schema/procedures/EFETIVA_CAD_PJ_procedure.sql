-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE efetiva_cad_pj ( nr_seq_p bigint ) AS $body$
BEGIN

  CALL wheb_usuario_pck.set_ie_executar_trigger('N');

  -- Integra o pre cadastro aprovado a tabela PESSOA_JURIDICA
  insert into pessoa_juridica(
    cd_ans
  , cd_cep
  , cd_cgc
  , cd_cgc_mantenedora
  , cd_cnes
  , cd_cnpj_raiz
  , cd_cond_pagto
  , cd_conta_contabil
  , cd_curp
  , cd_cvm
  , cd_internacional
  , cd_municipio_ibge
  , cd_operadora_empresa
  , cd_pf_resp_tecnico
  , cd_portador
  , cd_referencia_fornec
  , cd_rfc
  , cd_sistema_ant
  , cd_tipo_pessoa
  , cd_tipo_portador
  , ds_bairro
  , ds_complemento
  , ds_email
  , ds_endereco
  , ds_municipio
  , ds_nome_abrev
  , ds_observacao
  , ds_observacao_compl
  , ds_orgao_reg_resp_tecnico
  , ds_orientacao_cobranca
  , ds_razao_social
  , ds_resp_tecnico
  , ds_senha
  , ds_site_internet
  , dt_atualizacao
  , dt_atualizacao_nrec
  , dt_criacao
  , dt_integracao
  , dt_integracao_externa
  , dt_ultima_revisao
  , dt_validade_alvara_munic
  , dt_validade_alvara_sanit
  , dt_validade_autor_func
  , dt_validade_cert_boas_prat
  , dt_validade_resp_tecnico
  , ie_alterar_senha
  , ie_empreendedor_individual
  , ie_forma_revisao
  , ie_fornecedor_opme
  , ie_prod_fabric
  , ie_qualidade
  , ie_situacao
  , ie_status_envio
  , ie_status_exportar
  , ie_tipo_inst_saude
  , ie_tipo_tributacao
  , ie_tipo_trib_municipal
  , ie_transporte
  , nm_fantasia
  , nm_pessoa_contato
  , nm_usuario
  , nm_usuario_nrec
  , nm_usuario_revisao
  , nr_alvara_sanitario
  , nr_alvara_sanitario_munic
  , nr_autor_func
  , nr_autor_receb_resid
  , nr_autor_transp_resid
  , nr_ccm
  , nr_cei
  , nr_certificado_boas_prat
  , nr_ddd_fax
  , nr_ddd_telefone
  , nr_ddi_fax
  , nr_ddi_telefone
  , nr_endereco
  , nr_fax
  , nr_inscricao_estadual
  , nr_inscricao_municipal
  , nr_matricula_cei
  , nr_ramal_contato
  , nr_registro_pls
  , nr_registro_resp_tecnico
  , nr_seq_cnae
  , nr_seq_ident_cnes
  , nr_seq_idioma
  , nr_seq_nat_juridica
  , nr_seq_pais
  , nr_seq_pessoa_endereco
  , nr_seq_regiao
  , nr_seq_tipo_asen
  , nr_seq_tipo_logradouro
  , nr_telefone
  , qt_dia_prazo_entrega
  , sg_estado
  , vl_minimo_nf
  )
  SELECT cd_ans
       , cd_cep
       , cd_cgc
       , cd_cgc_mantenedora
       , cd_cnes
       , cd_cnpj_raiz
       , cd_cond_pagto
       , cd_conta_contabil
       , cd_curp
       , cd_cvm
       , cd_internacional
       , cd_municipio_ibge
       , cd_operadora_empresa
       , cd_pf_resp_tecnico
       , cd_portador
       , cd_referencia_fornec
       , cd_rfc
       , cd_sistema_ant
       , cd_tipo_pessoa
       , cd_tipo_portador
       , ds_bairro
       , ds_complemento
       , ds_email
       , ds_endereco
       , ds_municipio
       , ds_nome_abrev
       , ds_observacao
       , ds_observacao_compl
       , ds_orgao_reg_resp_tecnico
       , ds_orientacao_cobranca
       , ds_razao_social
       , ds_resp_tecnico
       , cd_pj_cod
       , ds_site_internet
       , dt_atualizacao
       , dt_atualizacao_nrec
       , dt_criacao
       , dt_integracao
       , dt_integracao_externa
       , dt_ultima_revisao
       , dt_validade_alvara_munic
       , dt_validade_alvara_sanit
       , dt_validade_autor_func
       , dt_validade_cert_boas_prat
       , dt_validade_resp_tecnico
       , ie_alterar_senha
       , ie_empreendedor_individual
       , ie_forma_revisao
       , ie_fornecedor_opme
       , ie_prod_fabric
       , ie_qualidade
       , ie_situacao
       , ie_status_envio
       , ie_status_exportar
       , ie_tipo_inst_saude
       , ie_tipo_tributacao
       , ie_tipo_trib_municipal
       , ie_transporte
       , nm_fantasia
       , nm_pessoa_contato
       , nm_usuario
       , nm_usuario_nrec
       , nm_usuario_revisao
       , nr_alvara_sanitario
       , nr_alvara_sanitario_munic
       , nr_autor_func
       , nr_autor_receb_resid
       , nr_autor_transp_resid
       , nr_ccm
       , nr_cei
       , nr_certificado_boas_prat
       , nr_ddd_fax
       , nr_ddd_telefone
       , nr_ddi_fax
       , nr_ddi_telefone
       , nr_endereco
       , nr_fax
       , nr_inscricao_estadual
       , nr_inscricao_municipal
       , nr_matricula_cei
       , nr_ramal_contato
       , nr_registro_pls
       , nr_registro_resp_tecnico
       , nr_seq_cnae
       , nr_seq_ident_cnes
       , nr_seq_idioma
       , nr_seq_nat_juridica
       , nr_seq_pais
       , nr_seq_pessoa_endereco
       , nr_seq_regiao
       , nr_seq_tipo_asen
       , nr_seq_tipo_logradouro
       , nr_telefone
       , qt_dia_prazo_entrega
       , sg_estado
       , vl_minimo_nf
    from pre_pessoa_juridica
   where nr_sequencia = nr_seq_p;

  -- Integra contas bancarias do pre cadastro aprovado a tabela PESSOA_JURIDICA_CONTA
  begin
    insert into pessoa_juridica_conta(
      cd_agencia_bancaria
    , cd_banco
    , cd_camara_compensacao
    , cd_cgc
    , cd_cnpj_agencia
    , cd_codigo_identificacao
    , ds_observacao
    , dt_atualizacao
    , ie_conta_pagamento
    , ie_conta_repasse
    , ie_digito_agencia
    , ie_prestador_pls
    , ie_propriedade_conta
    , ie_situacao
    , ie_tipo_conta
    , nm_usuario
    , nr_conta
    , nr_digito_conta
    , nr_sequencia
    )
    SELECT cd_agencia_bancaria
         , cd_banco
         , cd_camara_compensacao
         , cd_cgc
         , cd_cnpj_agencia
         , cd_codigo_identificacao
         , ds_observacao
         , dt_atualizacao
         , ie_conta_pagamento
         , ie_conta_repasse
         , ie_digito_agencia
         , ie_prestador_pls
         , ie_propriedade_conta
         , ie_situacao
         , ie_tipo_conta
         , nm_usuario
         , nr_conta
         , nr_digito_conta
         , nextval('pessoa_juridica_conta_seq')
      from pre_pessoa_juridica_conta
     where nr_seq_pre_pj = nr_seq_p;
  exception
    when no_data_found then
      null;
  end;

/**********************************************************************
  Abaixo, transferencias que podem ser ocasionadas pelas procedures:

  - INTPD_RECEIVING_LEGAL_ENTITY
  - RECEBER_FORNECEDOR_INTEGRACAO
  - INTEGRA_FORNECEDOR_PROTHEUS
  - IMPORTA_FORNECEDOR_SINTESE
  - GERAR_INT_PESSOA_JURIDICA
  - GERAR_PESSOA_JUR_INTEGRACAO

**********************************************************************/
  begin
    insert into pessoa_juridica_estab(
      cd_cgc
    , cd_cond_pagto
    , cd_estabelecimento
    , cd_interf_lab_lote_envio
    , cd_interf_lab_lote_ret
    , cd_interf_pls_mensalidade
    , cd_interno_lab
    , cd_operacao_nf
    , cd_portador
    , cd_referencia_fornec
    , cd_sistema_ant
    , cd_tipo_baixa
    , cd_tipo_portador
    , ds_email
    , ds_senha_interno_lab
    , dt_atualizacao
    , dt_atualizacao_nrec
    , ie_baixa_abat
    , ie_consiste_nr_serie_nf
    , ie_conta_dif_nf
    , ie_endereco_correspondencia
    , ie_exige_anexo_nf
    , ie_exige_ordem_compra
    , ie_forma_pagto
    , ie_frete
    , ie_moeda_estrangeira
    , ie_qualidade
    , ie_rateio_adiant
    , ie_rec_email_comercial
    , ie_retem_iss
    , ie_status_apenado
    , nm_pessoa_contato
    , nm_usuario
    , nm_usuario_nrec
    , nr_codigo_serv_prest
    , nr_ramal_contato
    , nr_sequencia
    , nr_seq_xml_lab_envio
    , nr_seq_xml_lab_ret
    , pr_desc_financeiro
    , pr_desc_financeiro_nf
    , qt_dia_prazo_entrega
    , tx_desc_antecipacao
    , tx_desc_assiduidade
    , tx_desc_ordem
    , vl_minimo_nf
    )
    SELECT cd_cgc
         , cd_cond_pagto
         , cd_estabelecimento
         , cd_interf_lab_lote_envio
         , cd_interf_lab_lote_ret
         , cd_interf_pls_mensalidade
         , cd_interno_lab
         , cd_operacao_nf
         , cd_portador
         , cd_referencia_fornec
         , cd_sistema_ant
         , cd_tipo_baixa
         , cd_tipo_portador
         , ds_email
         , ds_senha_interno_lab
         , dt_atualizacao
         , dt_atualizacao_nrec
         , ie_baixa_abat
         , ie_consiste_nr_serie_nf
         , ie_conta_dif_nf
         , ie_endereco_correspondencia
         , ie_exige_anexo_nf
         , ie_exige_ordem_compra
         , ie_forma_pagto
         , ie_frete
         , ie_moeda_estrangeira
         , ie_qualidade
         , ie_rateio_adiant
         , ie_rec_email_comercial
         , ie_retem_iss
         , ie_status_apenado
         , nm_pessoa_contato
         , nm_usuario
         , nm_usuario_nrec
         , nr_codigo_serv_prest
         , nr_ramal_contato
         , nextval('pessoa_juridica_estab_seq')
         , nr_seq_xml_lab_envio
         , nr_seq_xml_lab_ret
         , pr_desc_financeiro
         , pr_desc_financeiro_nf
         , qt_dia_prazo_entrega
         , tx_desc_antecipacao
         , tx_desc_assiduidade
         , tx_desc_ordem
         , vl_minimo_nf
      from pre_pessoa_juridica_estab
     where nr_seq_pre_pj = nr_seq_p;
  exception
    when no_data_found then
      null;
  end;

  begin
    insert into pessoa_juridica_compl(
      cd_cbo_red
    , cd_cep
    , cd_cgc
    , cd_estabelecimento
    , cd_municipio_ibge
    , cd_pessoa_fisica_canal
    , ds_bairro
    , ds_cargo
    , ds_complemento
    , ds_email
    , ds_endereco
    , ds_identific_complemento
    , ds_municipio
    , ds_observacao
    , ds_setor_contato
    , dt_atualizacao
    , dt_atualizacao_nrec
    , ie_contato_ref
    , ie_contribuinte_receita
    , ie_gerente_canal
    , ie_participa_eventos
    , ie_plc_customer_sponsor
    , ie_plc_matricula_conc
    , ie_plc_plataform_manager
    , ie_pls
    , ie_recebe_prop
    , ie_recebe_revista
    , ie_tipo_complemento
    , nm_pessoa_contato
    , nm_usuario
    , nm_usuario_nrec
    , nr_ddd_telefone
    , nr_ddi_celular
    , nr_ddi_fax
    , nr_ddi_telefone
    , nr_endereco
    , nr_fax
    , nr_ramal_contato
    , nr_sequencia
    , nr_seq_ident_cnes
    , nr_seq_pessoa_endereco
    , nr_seq_regiao
    , nr_seq_tipo_logradouro
    , nr_telefone
    , nr_telefone_celular
    , nr_total_funcionarios
    , sg_estado
    )
    SELECT cd_cbo_red
         , cd_cep
         , cd_cgc
         , cd_estabelecimento
         , cd_municipio_ibge
         , cd_pessoa_fisica_canal
         , ds_bairro
         , ds_cargo
         , ds_complemento
         , ds_email
         , ds_endereco
         , ds_identific_complemento
         , ds_municipio
         , ds_observacao
         , ds_setor_contato
         , dt_atualizacao
         , dt_atualizacao_nrec
         , ie_contato_ref
         , ie_contribuinte_receita
         , ie_gerente_canal
         , ie_participa_eventos
         , ie_plc_customer_sponsor
         , ie_plc_matricula_conc
         , ie_plc_plataform_manager
         , ie_pls
         , ie_recebe_prop
         , ie_recebe_revista
         , ie_tipo_complemento
         , nm_pessoa_contato
         , nm_usuario
         , nm_usuario_nrec
         , nr_ddd_telefone
         , nr_ddi_celular
         , nr_ddi_fax
         , nr_ddi_telefone
         , nr_endereco
         , nr_fax
         , nr_ramal_contato
         , nextval('pessoa_juridica_compl_seq')
         , nr_seq_ident_cnes
         , nr_seq_pessoa_endereco
         , nr_seq_regiao
         , nr_seq_tipo_logradouro
         , nr_telefone
         , nr_telefone_celular
         , nr_total_funcionarios
         , sg_estado
      from pre_pessoa_juridica_compl
     where nr_seq_pre_pj = nr_seq_p;
  exception
    when no_data_found then
      null;
  end;

  begin
    insert into pessoa_jur_resp(
      cd_cargo
    , cd_cgc
    , cd_pessoa_fisica
    , dt_atualizacao
    , dt_atualizacao_nrec
    , ie_avaliacao_fornecedor
    , ie_representante_legal
    , ie_resp_cadastro
    , nm_usuario
    , nm_usuario_nrec
    , nr_sequencia
    )
    SELECT cd_cargo
         , cd_cgc
         , cd_pessoa_fisica
         , dt_atualizacao
         , dt_atualizacao_nrec
         , ie_avaliacao_fornecedor
         , ie_representante_legal
         , ie_resp_cadastro
         , nm_usuario
         , nm_usuario_nrec
         , nextval('pessoa_jur_resp_seq')
      from pre_pessoa_jur_resp
     where nr_seq_pre_pj = nr_seq_p;
  exception
    when no_data_found then
      null;
  end;

  CALL wheb_usuario_pck.set_ie_executar_trigger('S');

  commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE efetiva_cad_pj ( nr_seq_p bigint ) FROM PUBLIC;

