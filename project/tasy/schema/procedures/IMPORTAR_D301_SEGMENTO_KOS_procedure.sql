-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE importar_d301_segmento_kos (nr_seq_dataset_p bigint, ds_conteudo_p text, nm_usuario_p text) AS $body$
DECLARE


  ds_dt_reembolso_w       d301_segmento_kos.ds_dt_reembolso%type;
  nr_seq_301_caract_cus_w d301_segmento_kos.nr_seq_301_caract_cus%type;
  ds_dt_custo_inicio_w    d301_segmento_kos.ds_dt_custo_inicio%type;
  ds_dt_fim_custo_w       d301_segmento_kos.ds_dt_fim_custo%type;
  qt_dias_copartic_w      d301_segmento_kos.qt_dias_copartic%type;
  vl_maximo_por_dia_w     d301_segmento_kos.vl_maximo_por_dia%type;
  ds_conteudo_w           varchar(32767);


BEGIN
  ds_conteudo_w := replace(ds_conteudo_p,'''','');

  if (obter_valor_separador(ds_conteudo_w,1,'+') = 'KOS') then

    ds_dt_reembolso_w       := obter_valor_separador(ds_conteudo_w,2,'+');
    nr_seq_301_caract_cus_w := obter_seq_valor_301('C301_8_STATUS_CUSTO','IE_STATUS_CUSTO',obter_valor_separador(ds_conteudo_w,3,'+'));
    ds_dt_custo_inicio_w    := obter_valor_separador(ds_conteudo_w,4,'+');
    ds_dt_fim_custo_w       := obter_valor_separador(ds_conteudo_w,5,'+');
    qt_dias_copartic_w      := obter_valor_separador(ds_conteudo_w,6,'+');
    vl_maximo_por_dia_w     := obter_valor_separador(ds_conteudo_w,7,'+');

    insert into d301_segmento_kos(nr_sequencia,
                                  dt_atualizacao,
                                  nm_usuario,
                                  dt_atualizacao_nrec,
                                  nm_usuario_nrec,
                                  ds_dt_reembolso,
                                  nr_seq_301_caract_cus,
                                  ds_dt_custo_inicio,
                                  ds_dt_fim_custo,
                                  qt_dias_copartic,
                                  vl_maximo_por_dia,
                                  nr_seq_dataset_ret) VALUES (nextval('d301_segmento_kos_seq'),
                                                              clock_timestamp(),
                                                              nm_usuario_p,
                                                              clock_timestamp(),
                                                              nm_usuario_p,
                                                              ds_dt_reembolso_w,
                                                              nr_seq_301_caract_cus_w,
                                                              ds_dt_custo_inicio_w,
                                                              ds_dt_fim_custo_w,
                                                              qt_dias_copartic_w,
                                                              vl_maximo_por_dia_w,
                                                              nr_seq_dataset_p);

  end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE importar_d301_segmento_kos (nr_seq_dataset_p bigint, ds_conteudo_p text, nm_usuario_p text) FROM PUBLIC;

