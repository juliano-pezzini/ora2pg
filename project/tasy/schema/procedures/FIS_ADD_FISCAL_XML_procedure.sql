-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE fis_add_fiscal_xml ( user_name_p text, ie_generate_schema_p text, nr_seq_project_p bigint default 0, project_name_p text default '', header_p text default '', definition_p text default '', content_p text default '', recipient_p text default '', ie_transmission_p bigint default 0, layout_p text default '') AS $body$
DECLARE


nr_seq_project_w fis_projeto_xml.nr_seq_projeto%type;
								

BEGIN

	if ie_generate_schema_p = 'S' then
		nr_seq_project_w := fis_xml_project_generator_pck.fis_start_project_generation(project_name_p, header_p, definition_p, user_name_p, content_p, nr_seq_project_w);
	else
		nr_seq_project_w := nr_seq_project_p;
	end if;

	insert into fis_projeto_xml(nr_sequencia,
								dt_atualizacao, 
								nm_usuario, 
								dt_atualizacao_nrec, 
								nm_usuario_nrec, 
								nr_seq_projeto,
								ds_destinatario,
								ie_tipo_transmissao,
								ds_layout)
						 values (nextval('fis_projeto_xml_seq'),
								clock_timestamp(),
								user_name_p,
								clock_timestamp(),
								user_name_p,
								nr_seq_project_w,
								recipient_p,
								ie_transmission_p,
								layout_p);
	commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE fis_add_fiscal_xml ( user_name_p text, ie_generate_schema_p text, nr_seq_project_p bigint default 0, project_name_p text default '', header_p text default '', definition_p text default '', content_p text default '', recipient_p text default '', ie_transmission_p bigint default 0, layout_p text default '') FROM PUBLIC;

