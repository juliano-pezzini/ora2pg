-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE desmarcar_opcao_documento_pj (ie_opcao_p text, comunic_resp_p text, comunic_comprador_p text, comunic_compra_cad_p text, comunic_setor_resp_p text, cd_cnpj_p text, nm_usuario_p text) AS $body$
BEGIN

if ie_opcao_p = 'D' then
	update 	pessoa_juridica_doc
	set	ie_comunic_resp_documento = CASE WHEN comunic_resp_p='S' THEN 'N'  ELSE ie_comunic_resp_documento END ,
		ie_comunic_comprador	  = CASE WHEN comunic_comprador_p='S' THEN 'N'  ELSE ie_comunic_comprador END ,
		ie_comunic_todos_comprador= CASE WHEN comunic_compra_cad_p='S' THEN 'N'  ELSE ie_comunic_todos_comprador END ,
		ie_comunic_setor	  = CASE WHEN comunic_setor_resp_p='S' THEN 'N'  ELSE ie_comunic_setor END ,
		nm_usuario                = nm_usuario_p,
		dt_atualizacao		  = clock_timestamp()
	where	cd_cgc = cd_cnpj_p;
else
		update 	pessoa_juridica_doc
	set	ie_comunic_resp_documento = CASE WHEN comunic_resp_p='S' THEN 'S'  ELSE ie_comunic_resp_documento END ,
		ie_comunic_comprador	  = CASE WHEN comunic_comprador_p='S' THEN 'S'  ELSE ie_comunic_comprador END ,
		ie_comunic_todos_comprador= CASE WHEN comunic_compra_cad_p='S' THEN 'S'  ELSE ie_comunic_todos_comprador END ,
		ie_comunic_setor	  = CASE WHEN comunic_setor_resp_p='S' THEN 'S'  ELSE ie_comunic_setor END ,
		nm_usuario                = nm_usuario_p,
		dt_atualizacao		  = clock_timestamp()
	where	cd_cgc = cd_cnpj_p;
end if;


commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE desmarcar_opcao_documento_pj (ie_opcao_p text, comunic_resp_p text, comunic_comprador_p text, comunic_compra_cad_p text, comunic_setor_resp_p text, cd_cnpj_p text, nm_usuario_p text) FROM PUBLIC;

