-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_sinal_vital_gestacao ( nr_sequencia_p bigint) AS $body$
DECLARE

				 
 
				 
qt_pa_sistolica_w		bigint;
qt_pa_diastolica_w		bigint;
qt_pam_w			bigint;
qt_freq_cardiaca_w		bigint;
qt_freq_resp_w			bigint;
qt_temp_w			real;
qt_saturacao_o2_w		bigint;
qt_bcf_w			bigint;
nr_atendimento_w 		bigint;
cd_pessoa_fisica_w  		varchar(10);
qt_reg_w			bigint;
nm_usuario_w			varchar(15);
cd_escala_dor_w			varchar(10);
qt_escala_dor_w			double precision;
nr_seq_topografia_dor_w 	bigint;
cd_profissional_w		varchar(15);


BEGIN  
  
  
select	max(a.qt_pa_sistolica), 
	max(a.qt_pa_diastolica), 
	max(a.qt_pam), 
	max(a.qt_freq_cardiaca), 
	max(a.qt_freq_resp), 
	max(a.qt_temp), 
	max(a.qt_saturacao_o2), 
	max(a.qt_bcf), 
	max(a.nr_atendimento), 
	max(cd_escala_dor), 
	max(qt_escala_dor), 
	max(nr_seq_topografia_dor), 
	max(CD_PROFISSIONAL) 
into STRICT	qt_pa_sistolica_w, 
	qt_pa_diastolica_w, 
	qt_pam_w, 
	qt_freq_cardiaca_w, 
	qt_freq_resp_w, 
	qt_temp_w, 
	qt_saturacao_o2_w, 
	qt_bcf_w, 
	nr_atendimento_w, 
	cd_escala_dor_w, 
	qt_escala_dor_w, 
	nr_seq_topografia_dor_w, 
	cd_profissional_w 
from	enf_tri_obstetrica a 
where  a.nr_sequencia = nr_sequencia_p;
 
if (nr_atendimento_w IS NOT NULL AND nr_atendimento_w::text <> '') then 
 
	cd_pessoa_fisica_w  := obter_pessoa_atendimento(nr_atendimento_w,'C');
 
	nm_usuario_w := wheb_usuario_pck.get_nm_usuario;
	 
 
	Insert into atendimento_sinal_vital(	nr_sequencia, 
											dt_sinal_vital, 
											dt_atualizacao, 
											dt_liberacao, 
											nm_usuario, 
											nr_atendimento, 
											cd_pessoa_fisica, 
											cd_paciente, 
											qt_pa_sistolica, 
											qt_pa_diastolica, 
											qt_pam, 
											qt_freq_cardiaca, 
											qt_freq_resp, 
											qt_temp, 
											qt_saturacao_o2, 
											qt_bcf, 
											cd_escala_dor, 
											qt_escala_dor, 
											nr_seq_topografia_dor, 
											ie_situacao) 
								values (	 
											nextval('atendimento_sinal_vital_seq'), 
											clock_timestamp(), 
											clock_timestamp(), 
											clock_timestamp(), 
											nm_usuario_w, 
											nr_atendimento_w, 
											cd_profissional_w, 
											cd_pessoa_fisica_w, 
											qt_pa_sistolica_w, 
											qt_pa_diastolica_w, 
											qt_pam_w, 
											qt_freq_cardiaca_w, 
											qt_freq_resp_w, 
											qt_temp_w, 
											qt_saturacao_o2_w, 
											qt_bcf_w, 
											cd_escala_dor_w, 
											qt_escala_dor_w, 
											nr_seq_topografia_dor_w, 
											'A');
		 
 
	Commit;
		 
end if;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_sinal_vital_gestacao ( nr_sequencia_p bigint) FROM PUBLIC;

