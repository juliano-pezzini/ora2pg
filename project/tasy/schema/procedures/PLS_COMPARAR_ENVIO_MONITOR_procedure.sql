-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pls_comparar_envio_monitor ( nr_seq_guia_monitor_p pls_monitor_tiss_guia.nr_sequencia%type) AS $body$
DECLARE


cd_versao_tiss_w			pls_monitor_tiss_guia.cd_versao_tiss%type;
ie_tipo_envio_w				pls_monitor_tiss_guia.ie_tipo_envio%type;
cd_guia_operadora_w			pls_monitor_tiss_guia.cd_guia_operadora%type;
cd_guia_prestador_w			pls_monitor_tiss_guia.cd_guia_prestador%type;
ie_reembolso_w				pls_monitor_tiss_guia.ie_reembolso%type;
cd_guia_principal_w			pls_monitor_tiss_guia.cd_guia_principal%type;
dt_solicitacao_w			pls_monitor_tiss_guia.dt_solicitacao%type;
dt_autorizacao_w			pls_monitor_tiss_guia.dt_autorizacao%type;
dt_realizacao_w				pls_monitor_tiss_guia.dt_realizacao%type;
dt_inicio_faturamento_w			pls_monitor_tiss_guia.dt_inicio_faturamento%type;
dt_fim_internacao_w			pls_monitor_tiss_guia.dt_fim_internacao%type;
dt_protocolo_w				pls_monitor_tiss_guia.dt_protocolo%type;
ie_tipo_consulta_w			pls_monitor_tiss_guia.ie_tipo_consulta%type;
ie_sexo_w				pls_monitor_tiss_guia.ie_sexo%type;
dt_nascimento_w				pls_monitor_tiss_guia.dt_nascimento%type;
cd_cbo_executante_w			pls_monitor_tiss_guia.cd_cbo_executante%type;
ie_recem_nasc_w				pls_monitor_tiss_guia.ie_recem_nasc%type;
ie_indicacao_acidente_w			pls_monitor_tiss_guia.ie_indicacao_acidente%type;
ie_carater_atendimento_w		pls_monitor_tiss_guia.ie_carater_atendimento%type;
ie_tipo_internacao_w			pls_monitor_tiss_guia.ie_tipo_internacao%type;
ie_regime_internacao_w			pls_monitor_tiss_guia.ie_regime_internacao%type;
ie_tipo_atendimento_w			pls_monitor_tiss_guia.ie_tipo_atendimento%type;
ie_tipo_faturamento_w			pls_monitor_tiss_guia.ie_tipo_faturamento%type;
nr_diarias_acompanhante_w		pls_monitor_tiss_guia.nr_diarias_acompanhante%type;
nr_diarias_uti_w			pls_monitor_tiss_guia.nr_diarias_uti%type;
ie_motivo_encerramento_w		pls_monitor_tiss_guia.ie_motivo_encerramento%type;
cd_cnes_prest_exec_w			pls_monitor_tiss_guia.cd_cnes_prest_exec%type;
ie_identif_prest_exec_w			pls_monitor_tiss_guia.ie_identif_prest_exec%type;
cd_cpf_cgc_prest_exec_w			pls_monitor_tiss_guia.cd_cpf_cgc_prest_exec%type;
cd_municipio_prest_exec_w		pls_monitor_tiss_guia.cd_municipio_prest_exec%type;
nr_protocolo_ans_w			pls_monitor_tiss_guia.nr_protocolo_ans%type;
nr_cartao_nac_sus_w			pls_monitor_tiss_guia.nr_cartao_nac_sus%type;
vl_cobranca_guia_w			pls_monitor_tiss_guia.vl_cobranca_guia%type;
vl_total_glosa_w			pls_monitor_tiss_guia.vl_total_glosa%type;
cd_guia_sadt_princ_w			pls_monitor_tiss_guia.cd_guia_sadt_princ%type;
vl_total_copart_w			pls_monitor_tiss_guia.vl_total_copart%type;
cd_municipio_benef_w			pls_monitor_tiss_guia.cd_municipio_benef%type;
cd_versao_tiss_old_w			pls_monitor_tiss_guia.cd_versao_tiss%type;
ie_tipo_envio_old_w			pls_monitor_tiss_guia.ie_tipo_envio%type;
cd_guia_operadora_old_w			pls_monitor_tiss_guia.cd_guia_operadora%type;
cd_guia_prestador_old_w			pls_monitor_tiss_guia.cd_guia_prestador%type;
ie_reembolso_old_w			pls_monitor_tiss_guia.ie_reembolso%type;
cd_guia_principal_old_w			pls_monitor_tiss_guia.cd_guia_principal%type;
dt_solicitacao_old_w			pls_monitor_tiss_guia.dt_solicitacao%type;
dt_autorizacao_old_w			pls_monitor_tiss_guia.dt_autorizacao%type;
dt_realizacao_old_w			pls_monitor_tiss_guia.dt_realizacao%type;
dt_inicio_faturamento_old_w		pls_monitor_tiss_guia.dt_inicio_faturamento%type;
dt_fim_internacao_old_w			pls_monitor_tiss_guia.dt_fim_internacao%type;
dt_protocolo_old_w			pls_monitor_tiss_guia.dt_protocolo%type;
ie_tipo_consulta_old_w			pls_monitor_tiss_guia.ie_tipo_consulta%type;
ie_sexo_old_w				pls_monitor_tiss_guia.ie_sexo%type;
dt_nascimento_old_w			pls_monitor_tiss_guia.dt_nascimento%type;
cd_cbo_executante_old_w			pls_monitor_tiss_guia.cd_cbo_executante%type;
ie_recem_nasc_old_w			pls_monitor_tiss_guia.ie_recem_nasc%type;
ie_indicacao_acidente_old_w		pls_monitor_tiss_guia.ie_indicacao_acidente%type;
ie_carater_atendimento_old_w		pls_monitor_tiss_guia.ie_carater_atendimento%type;
ie_tipo_internacao_old_w		pls_monitor_tiss_guia.ie_tipo_internacao%type;
ie_regime_internacao_old_w		pls_monitor_tiss_guia.ie_regime_internacao%type;
ie_tipo_atendimento_old_w		pls_monitor_tiss_guia.ie_tipo_atendimento%type;
ie_tipo_faturamento_old_w		pls_monitor_tiss_guia.ie_tipo_faturamento%type;
nr_diarias_acompanhante_old_w		pls_monitor_tiss_guia.nr_diarias_acompanhante%type;
nr_diarias_uti_old_w			pls_monitor_tiss_guia.nr_diarias_uti%type;
ie_motivo_encerramento_old_w		pls_monitor_tiss_guia.ie_motivo_encerramento%type;
cd_cnes_prest_exec_old_w		pls_monitor_tiss_guia.cd_cnes_prest_exec%type;
ie_identif_prest_exec_old_w		pls_monitor_tiss_guia.ie_identif_prest_exec%type;
cd_cpf_cgc_prest_exec_old_w		pls_monitor_tiss_guia.cd_cpf_cgc_prest_exec%type;
cd_municipio_prest_exec_old_w		pls_monitor_tiss_guia.cd_municipio_prest_exec%type;
nr_protocolo_ans_old_w			pls_monitor_tiss_guia.nr_protocolo_ans%type;
nr_cartao_nac_sus_old_w			pls_monitor_tiss_guia.nr_cartao_nac_sus%type;
vl_cobranca_guia_old_w			pls_monitor_tiss_guia.vl_cobranca_guia%type;
vl_total_glosa_old_w			pls_monitor_tiss_guia.vl_total_glosa%type;
cd_guia_sadt_princ_old_w		pls_monitor_tiss_guia.cd_guia_sadt_princ%type;
nr_registro_oper_inter_old_w		pls_monitor_tiss_guia.nr_registro_operadora_inter%type;
vl_total_copart_old_w			pls_monitor_tiss_guia.vl_total_copart%type;
cd_municipio_benef_old_w		pls_monitor_tiss_guia.cd_municipio_benef%type;
cd_doenca_w				pls_monitor_tiss_diag.cd_doenca%type;
ie_classificacao_w			pls_monitor_tiss_diag.ie_classificacao%type;
cd_doenca_old_w				pls_monitor_tiss_diag.cd_doenca%type;
ie_classificacao_old_w			pls_monitor_tiss_diag.ie_classificacao%type;
cd_dente_w				pls_monitor_tiss_proc.cd_dente%type;
cd_face_dente_w				pls_monitor_tiss_proc.cd_face_dente%type;
cd_grupo_proc_w				pls_monitor_tiss_proc.cd_grupo_proc%type;
cd_procedimento_w			pls_monitor_tiss_proc.cd_procedimento%type;
cd_regiao_boca_w			pls_monitor_tiss_proc.cd_regiao_boca%type;
cd_tabela_ref_w				pls_monitor_tiss_proc.cd_tabela_ref%type;
qt_procedimento_w			pls_monitor_tiss_proc.qt_procedimento%type;
vl_procedimento_w			pls_monitor_tiss_proc.vl_procedimento%type;
vl_coparticipacao_w			pls_monitor_tiss_proc.vl_coparticipacao%type;
cd_cgc_fornecedor_w			pls_monitor_tiss_mat.cd_cgc_fornecedor%type;
cd_material_w				pls_monitor_tiss_mat.cd_material%type;
qt_material_w				pls_monitor_tiss_mat.qt_material%type;
vl_material_w				pls_monitor_tiss_mat.vl_material%type;
vl_pago_fornecedor_w			pls_monitor_tiss_mat.vl_pago_fornecedor%type;
dados_comparacao_w			pls_gerencia_envio_ans_pck.dados_comparacao;
nr_seq_conta_w				pls_conta.nr_sequencia%type;
nr_seq_guia_monit_old_w			pls_monitor_tiss_guia.nr_sequencia%type;
nr_registro_operadora_inter_w		pls_monitor_tiss_guia.nr_registro_operadora_inter%type;
nr_index_w				integer := 0;
qt_diag_conta_w				integer;
	
C01 CURSOR(	nr_seq_guia_monitor_pc		pls_monitor_tiss_guia.nr_sequencia%type,
		nr_seq_guia_monitor_old_pc	pls_monitor_tiss_guia.nr_sequencia%type) FOR
	SELECT	a.nr_sequencia,
		a.cd_dente,
		a.cd_face_dente,
		a.cd_grupo_proc,
		a.cd_procedimento,
		a.cd_regiao_boca,
		a.cd_tabela_ref,
		a.qt_procedimento,
		a.vl_procedimento,
		a.vl_coparticipacao,
		(SELECT	max(x.nr_sequencia)
		 from	pls_monitor_tiss_proc x
		 where	x.nr_seq_guia_monitor = nr_seq_guia_monitor_old_pc
		 and	x.nr_seq_conta_proc = a.nr_seq_conta_proc) nr_seq_proc_old
	from	pls_monitor_tiss_proc a
	where	a.nr_seq_guia_monitor = nr_seq_guia_monitor_pc;
	
C02 CURSOR(	nr_seq_guia_monitor_pc		pls_monitor_tiss_guia.nr_sequencia%type,
		nr_seq_guia_monitor_old_pc	pls_monitor_tiss_guia.nr_sequencia%type) FOR
	SELECT	a.cd_cgc_fornecedor,
		a.cd_grupo_proc,
		a.cd_material,
		a.cd_tabela_ref,
		a.nr_sequencia,
		a.qt_material,
		a.vl_coparticipacao,
		a.vl_material,
		a.vl_pago_fornecedor,
		(SELECT	max(x.nr_sequencia)
		 from	pls_monitor_tiss_mat x
		 where	x.nr_seq_guia_monitor = nr_seq_guia_monitor_old_pc
		 and	x.nr_seq_conta_mat = a.nr_seq_conta_mat) nr_seq_mat_old
	from	pls_monitor_tiss_mat a
	where	a.nr_seq_guia_monitor = nr_seq_guia_monitor_pc;
	
procedure insere_campos(dados_comparacao_p	in out	pls_gerencia_envio_ans_pck.dados_comparacao) is
;
BEGIN

if (dados_comparacao_p.ds_campo.count > 0) then
	
	forall i in dados_comparacao_p.ds_campo.first .. dados_comparacao_p.ds_campo.last
		insert	into	w_pls_comparacao_monitor(	ds_campo, ds_campo_new, ds_campo_old,
				nr_seq_guia_monitor, nr_seq_proc_monitor, nr_seq_mat_monitor,
				nm_usuario_nrec, nm_usuario, dt_atualizacao_nrec,
				dt_atualizacao, nr_sequencia)
		values (	dados_comparacao_p.ds_campo(i), dados_comparacao_p.valor_new(i), dados_comparacao_p.valor_old(i),
				dados_comparacao_p.nr_seq_guia_monitor(i), dados_comparacao_p.nr_seq_proc_monitor(i), dados_comparacao_p.nr_seq_mat_monitor(i),
				'Tasy', 'Tasy', clock_timestamp(),
				clock_timestamp(), nextval('w_pls_comparacao_monitor_seq'));
	commit;
	
	dados_comparacao_p.ds_campo.delete;
	dados_comparacao_p.valor_new.delete;
	dados_comparacao_p.valor_old.delete;
	dados_comparacao_p.nr_seq_guia_monitor.delete;
	dados_comparacao_p.nr_seq_proc_monitor.delete;
	dados_comparacao_p.nr_seq_mat_monitor.delete;
end if;

end;

begin

EXECUTE 'truncate table w_pls_comparacao_monitor';

if (nr_seq_guia_monitor_p IS NOT NULL AND nr_seq_guia_monitor_p::text <> '') then
	
	select	nr_seq_conta
	into STRICT	nr_seq_conta_w
	from	pls_monitor_tiss_guia
	where	nr_sequencia = nr_seq_guia_monitor_p;
	
	select	max(a.nr_sequencia)
	into STRICT	nr_seq_guia_monit_old_w
	from	pls_monitor_tiss_guia a
	where	a.nr_seq_conta = nr_seq_conta_w
	and	a.ie_tipo_evento_alt = 'FC'
	and	exists (	SELECT	1
				from	pls_mon_tiss_guia_ret_act x
				where	x.nr_seq_guia_monitor = a.nr_sequencia);
				
	if (coalesce(nr_seq_guia_monit_old_w::text, '') = '') then
		select	max(a.nr_sequencia)
		into STRICT	nr_seq_guia_monit_old_w
		from	pls_monitor_tiss_guia a
		where	a.nr_seq_conta = nr_seq_conta_w
		and	coalesce(a.dt_pagamento_previsto::text, '') = ''
		and	exists (	SELECT	1
					from	pls_mon_tiss_guia_ret_act x
					where	x.nr_seq_guia_monitor = a.nr_sequencia);
	end if;
	
	if (nr_seq_guia_monit_old_w IS NOT NULL AND nr_seq_guia_monit_old_w::text <> '') then
		select	pls_obter_cod_ver_tiss_monit(cd_versao_tiss) cd_versao_tiss, pls_obter_tipo_env_cta_monit(nr_seq_conta) ie_tipo_envio, cd_guia_operadora,
			cd_guia_prestador, ie_reembolso, cd_guia_principal,
			dt_solicitacao, dt_autorizacao, dt_realizacao,
			dt_inicio_faturamento, dt_fim_internacao, dt_protocolo,
			ie_tipo_consulta, ie_sexo, dt_nascimento,
			cd_cbo_executante, ie_recem_nasc, ie_indicacao_acidente,
			ie_carater_atendimento, ie_tipo_internacao, ie_regime_internacao,         
			ie_tipo_atendimento, ie_tipo_faturamento, nr_diarias_acompanhante,       
			nr_diarias_uti, ie_motivo_encerramento, coalesce(cd_cnes_prest_exec, '99999999') cd_cnes_prest_exec,
			ie_identif_prest_exec, cd_cpf_cgc_prest_exec, cd_municipio_prest_exec,         
			nr_protocolo_ans, nr_cartao_nac_sus, vl_cobranca_guia,    
			vl_total_glosa, cd_guia_sadt_princ, nr_registro_operadora_inter,
			vl_total_copart, cd_municipio_benef 
		into STRICT	cd_versao_tiss_w, ie_tipo_envio_w, cd_guia_operadora_w,
			cd_guia_prestador_w, ie_reembolso_w, cd_guia_principal_w,
			dt_solicitacao_w, dt_autorizacao_w, dt_realizacao_w,
			dt_inicio_faturamento_w, dt_fim_internacao_w, dt_protocolo_w,
			ie_tipo_consulta_w, ie_sexo_w, dt_nascimento_w,
			cd_cbo_executante_w, ie_recem_nasc_w, ie_indicacao_acidente_w,
			ie_carater_atendimento_w, ie_tipo_internacao_w, ie_regime_internacao_w,
			ie_tipo_atendimento_w, ie_tipo_faturamento_w, nr_diarias_acompanhante_w,
			nr_diarias_uti_w, ie_motivo_encerramento_w, cd_cnes_prest_exec_w,
			ie_identif_prest_exec_w, cd_cpf_cgc_prest_exec_w, cd_municipio_prest_exec_w,
			nr_protocolo_ans_w, nr_cartao_nac_sus_w, vl_cobranca_guia_w,
			vl_total_glosa_w, cd_guia_sadt_princ_w, nr_registro_operadora_inter_w,
			vl_total_copart_w, cd_municipio_benef_w
		from	pls_monitor_tiss_guia
		where	nr_sequencia = nr_seq_guia_monitor_p;
		
		select	pls_obter_cod_ver_tiss_monit(cd_versao_tiss) cd_versao_tiss, pls_obter_tipo_env_cta_monit(nr_seq_conta) ie_tipo_envio, cd_guia_operadora,
			cd_guia_prestador, ie_reembolso, cd_guia_principal,
			dt_solicitacao, dt_autorizacao, dt_realizacao,
			dt_inicio_faturamento, dt_fim_internacao, dt_protocolo,
			ie_tipo_consulta, ie_sexo, dt_nascimento,
			cd_cbo_executante, ie_recem_nasc, ie_indicacao_acidente,
			ie_carater_atendimento, ie_tipo_internacao, ie_regime_internacao,         
			ie_tipo_atendimento, ie_tipo_faturamento, nr_diarias_acompanhante,       
			nr_diarias_uti, ie_motivo_encerramento, coalesce(cd_cnes_prest_exec, '99999999') cd_cnes_prest_exec,
			ie_identif_prest_exec, cd_cpf_cgc_prest_exec, cd_municipio_prest_exec,         
			nr_protocolo_ans, nr_cartao_nac_sus, vl_cobranca_guia,    
			vl_total_glosa, cd_guia_sadt_princ, nr_registro_operadora_inter,
			vl_total_copart, cd_municipio_benef
		into STRICT	cd_versao_tiss_old_w, ie_tipo_envio_old_w, cd_guia_operadora_old_w,
			cd_guia_prestador_old_w, ie_reembolso_old_w, cd_guia_principal_old_w,
			dt_solicitacao_old_w, dt_autorizacao_old_w, dt_realizacao_old_w,
			dt_inicio_faturamento_old_w, dt_fim_internacao_old_w, dt_protocolo_old_w,
			ie_tipo_consulta_old_w, ie_sexo_old_w, dt_nascimento_old_w,
			cd_cbo_executante_old_w, ie_recem_nasc_old_w, ie_indicacao_acidente_old_w,
			ie_carater_atendimento_old_w, ie_tipo_internacao_old_w, ie_regime_internacao_old_w,
			ie_tipo_atendimento_old_w, ie_tipo_faturamento_old_w, nr_diarias_acompanhante_old_w,
			nr_diarias_uti_old_w, ie_motivo_encerramento_old_w, cd_cnes_prest_exec_old_w,
			ie_identif_prest_exec_old_w, cd_cpf_cgc_prest_exec_old_w, cd_municipio_prest_exec_old_w,
			nr_protocolo_ans_old_w, nr_cartao_nac_sus_old_w, vl_cobranca_guia_old_w,
			vl_total_glosa_old_w, cd_guia_sadt_princ_old_w, nr_registro_oper_inter_old_w,
			vl_total_copart_old_w, cd_municipio_benef_old_w
		from	pls_monitor_tiss_guia
		where	nr_sequencia = nr_seq_guia_monit_old_w;
		
		if ( cd_versao_tiss_w <> cd_versao_tiss_old_w ) or ( coalesce(cd_versao_tiss_w::text, '') = '' and (cd_versao_tiss_old_w IS NOT NULL AND cd_versao_tiss_old_w::text <> '') ) or ( (cd_versao_tiss_w IS NOT NULL AND cd_versao_tiss_w::text <> '') and coalesce(cd_versao_tiss_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(782819);
			dados_comparacao_w.valor_new(nr_index_w)		:= cd_versao_tiss_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= cd_versao_tiss_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( ie_tipo_envio_w <> ie_tipo_envio_old_w ) or ( coalesce(ie_tipo_envio_w::text, '') = '' and (ie_tipo_envio_old_w IS NOT NULL AND ie_tipo_envio_old_w::text <> '') ) or ( (ie_tipo_envio_w IS NOT NULL AND ie_tipo_envio_w::text <> '') and coalesce(ie_tipo_envio_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(290295);
			dados_comparacao_w.valor_new(nr_index_w)		:= Obter_Valor_Dominio(8407, ie_tipo_envio_w);
			dados_comparacao_w.valor_old(nr_index_w)		:= Obter_Valor_Dominio(8407, ie_tipo_envio_old_w);
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( cd_guia_operadora_w <> cd_guia_operadora_old_w ) or ( coalesce(cd_guia_operadora_w::text, '') = '' and (cd_guia_operadora_old_w IS NOT NULL AND cd_guia_operadora_old_w::text <> '') ) or ( (cd_guia_operadora_w IS NOT NULL AND cd_guia_operadora_w::text <> '') and coalesce(cd_guia_operadora_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(291177);
			dados_comparacao_w.valor_new(nr_index_w)		:= cd_guia_operadora_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= cd_guia_operadora_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( cd_guia_prestador_w <> cd_guia_prestador_old_w ) or ( coalesce(cd_guia_prestador_w::text, '') = '' and (cd_guia_prestador_old_w IS NOT NULL AND cd_guia_prestador_old_w::text <> '') ) or ( (cd_guia_prestador_w IS NOT NULL AND cd_guia_prestador_w::text <> '') and coalesce(cd_guia_prestador_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(291178);
			dados_comparacao_w.valor_new(nr_index_w)		:= cd_guia_prestador_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= cd_guia_prestador_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( ie_reembolso_w <> ie_reembolso_old_w ) or ( coalesce(ie_reembolso_w::text, '') = '' and (ie_reembolso_old_w IS NOT NULL AND ie_reembolso_old_w::text <> '') ) or ( (ie_reembolso_w IS NOT NULL AND ie_reembolso_w::text <> '') and coalesce(ie_reembolso_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(313664);
			dados_comparacao_w.valor_new(nr_index_w)		:= ie_reembolso_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= ie_reembolso_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( cd_guia_principal_w <> cd_guia_principal_old_w ) or ( coalesce(cd_guia_principal_w::text, '') = '' and (cd_guia_principal_old_w IS NOT NULL AND cd_guia_principal_old_w::text <> '') ) or ( (cd_guia_principal_w IS NOT NULL AND cd_guia_principal_w::text <> '') and coalesce(cd_guia_principal_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(291181);
			dados_comparacao_w.valor_new(nr_index_w)		:= cd_guia_principal_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= cd_guia_principal_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( dt_solicitacao_w <> dt_solicitacao_old_w ) or ( coalesce(dt_solicitacao_w::text, '') = '' and (dt_solicitacao_old_w IS NOT NULL AND dt_solicitacao_old_w::text <> '') ) or ( (dt_solicitacao_w IS NOT NULL AND dt_solicitacao_w::text <> '') and coalesce(dt_solicitacao_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(287230);
			dados_comparacao_w.valor_new(nr_index_w)		:= to_char(dt_solicitacao_w, 'dd/mm/yyyy');
			dados_comparacao_w.valor_old(nr_index_w)		:= to_char(dt_solicitacao_old_w, 'dd/mm/yyyy');
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( dt_autorizacao_w <> dt_autorizacao_old_w ) or ( coalesce(dt_autorizacao_w::text, '') = '' and (dt_autorizacao_old_w IS NOT NULL AND dt_autorizacao_old_w::text <> '') ) or ( (dt_autorizacao_w IS NOT NULL AND dt_autorizacao_w::text <> '') and coalesce(dt_autorizacao_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(286574);
			dados_comparacao_w.valor_new(nr_index_w)		:= to_char(dt_autorizacao_w, 'dd/mm/yyyy');
			dados_comparacao_w.valor_old(nr_index_w)		:= to_char(dt_autorizacao_old_w, 'dd/mm/yyyy');
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( dt_realizacao_old_w <> dt_realizacao_old_w ) or ( coalesce(dt_realizacao_old_w::text, '') = '' and (dt_realizacao_old_w IS NOT NULL AND dt_realizacao_old_w::text <> '') ) or ( (dt_realizacao_old_w IS NOT NULL AND dt_realizacao_old_w::text <> '') and coalesce(dt_realizacao_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(287163);
			dados_comparacao_w.valor_new(nr_index_w)		:= to_char(dt_realizacao_w, 'dd/mm/yyyy');
			dados_comparacao_w.valor_old(nr_index_w)		:= to_char(dt_realizacao_old_w, 'dd/mm/yyyy');
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( dt_inicio_faturamento_w <> dt_inicio_faturamento_old_w ) or ( coalesce(dt_inicio_faturamento_w::text, '') = '' and (dt_inicio_faturamento_old_w IS NOT NULL AND dt_inicio_faturamento_old_w::text <> '') ) or ( (dt_inicio_faturamento_w IS NOT NULL AND dt_inicio_faturamento_w::text <> '') and coalesce(dt_inicio_faturamento_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(345142);
			dados_comparacao_w.valor_new(nr_index_w)		:= to_char(dt_inicio_faturamento_w, 'dd/mm/yyyy');
			dados_comparacao_w.valor_old(nr_index_w)		:= to_char(dt_inicio_faturamento_old_w, 'dd/mm/yyyy');
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( dt_fim_internacao_w <> dt_fim_internacao_old_w ) or ( coalesce(dt_fim_internacao_w::text, '') = '' and (dt_fim_internacao_old_w IS NOT NULL AND dt_fim_internacao_old_w::text <> '') ) or ( (dt_fim_internacao_w IS NOT NULL AND dt_fim_internacao_w::text <> '') and coalesce(dt_fim_internacao_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(345149);
			dados_comparacao_w.valor_new(nr_index_w)		:= to_char(dt_fim_internacao_w, 'dd/mm/yyyy');
			dados_comparacao_w.valor_old(nr_index_w)		:= to_char(dt_fim_internacao_old_w, 'dd/mm/yyyy');
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( dt_protocolo_w <> dt_protocolo_old_w ) or ( coalesce(dt_protocolo_w::text, '') = '' and (dt_protocolo_old_w IS NOT NULL AND dt_protocolo_old_w::text <> '') ) or ( (dt_protocolo_w IS NOT NULL AND dt_protocolo_w::text <> '') and coalesce(dt_protocolo_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(303455);
			dados_comparacao_w.valor_new(nr_index_w)		:= to_char(dt_protocolo_w, 'dd/mm/yyyy');
			dados_comparacao_w.valor_old(nr_index_w)		:= to_char(dt_protocolo_old_w, 'dd/mm/yyyy');
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( ie_tipo_consulta_w <> ie_tipo_consulta_old_w ) or ( coalesce(ie_tipo_consulta_w::text, '') = '' and (ie_tipo_consulta_old_w IS NOT NULL AND ie_tipo_consulta_old_w::text <> '') ) or ( (ie_tipo_consulta_w IS NOT NULL AND ie_tipo_consulta_w::text <> '') and coalesce(ie_tipo_consulta_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(287230);
			dados_comparacao_w.valor_new(nr_index_w)		:= Obter_Valor_Dominio(3435, ie_tipo_consulta_w);
			dados_comparacao_w.valor_old(nr_index_w)		:= Obter_Valor_Dominio(3435, ie_tipo_consulta_old_w);
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( cd_cbo_executante_w <> cd_cbo_executante_old_w ) or ( coalesce(cd_cbo_executante_w::text, '') = '' and (cd_cbo_executante_old_w IS NOT NULL AND cd_cbo_executante_old_w::text <> '') ) or ( (cd_cbo_executante_w IS NOT NULL AND cd_cbo_executante_w::text <> '') and coalesce(cd_cbo_executante_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(303057);
			dados_comparacao_w.valor_new(nr_index_w)		:= cd_cbo_executante_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= cd_cbo_executante_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( ie_recem_nasc_w <> ie_recem_nasc_old_w ) or ( coalesce(ie_recem_nasc_w::text, '') = '' and (ie_recem_nasc_old_w IS NOT NULL AND ie_recem_nasc_old_w::text <> '') ) or ( (ie_recem_nasc_w IS NOT NULL AND ie_recem_nasc_w::text <> '') and coalesce(ie_recem_nasc_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(782821);
			dados_comparacao_w.valor_new(nr_index_w)		:= ie_recem_nasc_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= ie_recem_nasc_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( ie_indicacao_acidente_w <> ie_indicacao_acidente_old_w ) or ( coalesce(ie_indicacao_acidente_w::text, '') = '' and (ie_indicacao_acidente_old_w IS NOT NULL AND ie_indicacao_acidente_old_w::text <> '') ) or ( (ie_indicacao_acidente_w IS NOT NULL AND ie_indicacao_acidente_w::text <> '') and coalesce(ie_indicacao_acidente_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(291835);
			dados_comparacao_w.valor_new(nr_index_w)		:= Obter_Valor_Dominio(1759, ie_indicacao_acidente_w);
			dados_comparacao_w.valor_old(nr_index_w)		:= Obter_Valor_Dominio(1759, ie_indicacao_acidente_old_w);
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( ie_carater_atendimento_w <> ie_carater_atendimento_old_w ) or ( coalesce(ie_carater_atendimento_w::text, '') = '' and (ie_carater_atendimento_old_w IS NOT NULL AND ie_carater_atendimento_old_w::text <> '') ) or ( (ie_carater_atendimento_w IS NOT NULL AND ie_carater_atendimento_w::text <> '') and coalesce(ie_carater_atendimento_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(719512);
			dados_comparacao_w.valor_new(nr_index_w)		:= obter_Valor_Dominio(2819, ie_carater_atendimento_w);
			dados_comparacao_w.valor_old(nr_index_w)		:= obter_Valor_Dominio(2819, ie_carater_atendimento_old_w);
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;			
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( ie_tipo_internacao_w <> ie_tipo_internacao_old_w ) or ( coalesce(ie_tipo_internacao_w::text, '') = '' and (ie_tipo_internacao_old_w IS NOT NULL AND ie_tipo_internacao_old_w::text <> '') ) or ( (ie_tipo_internacao_w IS NOT NULL AND ie_tipo_internacao_w::text <> '') and coalesce(ie_tipo_internacao_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(299828);
			dados_comparacao_w.valor_new(nr_index_w)		:= ie_tipo_internacao_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= ie_tipo_internacao_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( ie_regime_internacao_w <> ie_regime_internacao_old_w ) or ( coalesce(ie_regime_internacao_w::text, '') = '' and (ie_regime_internacao_old_w IS NOT NULL AND ie_regime_internacao_old_w::text <> '') ) or ( (ie_regime_internacao_w IS NOT NULL AND ie_regime_internacao_w::text <> '') and coalesce(ie_regime_internacao_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(297433);
			dados_comparacao_w.valor_new(nr_index_w)		:= obter_Valor_Dominio(1757, ie_regime_internacao_w);
			dados_comparacao_w.valor_old(nr_index_w)		:= obter_Valor_Dominio(1757, ie_regime_internacao_old_w);
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( ie_tipo_atendimento_w <> ie_tipo_atendimento_old_w ) or ( coalesce(ie_tipo_atendimento_w::text, '') = '' and (ie_tipo_atendimento_old_w IS NOT NULL AND ie_tipo_atendimento_old_w::text <> '') ) or ( (ie_tipo_atendimento_w IS NOT NULL AND ie_tipo_atendimento_w::text <> '') and coalesce(ie_tipo_atendimento_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(299425);
			dados_comparacao_w.valor_new(nr_index_w)		:= ie_tipo_atendimento_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= ie_tipo_atendimento_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( ie_tipo_faturamento_w <> ie_tipo_faturamento_old_w ) or ( coalesce(ie_tipo_faturamento_w::text, '') = '' and (ie_tipo_faturamento_old_w IS NOT NULL AND ie_tipo_faturamento_old_w::text <> '') ) or ( (ie_tipo_faturamento_w IS NOT NULL AND ie_tipo_faturamento_w::text <> '') and coalesce(ie_tipo_faturamento_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(299791);
			dados_comparacao_w.valor_new(nr_index_w)		:= ie_tipo_faturamento_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= ie_tipo_faturamento_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( nr_diarias_acompanhante_w <> nr_diarias_acompanhante_old_w ) or ( coalesce(nr_diarias_acompanhante_w::text, '') = '' and (nr_diarias_acompanhante_old_w IS NOT NULL AND nr_diarias_acompanhante_old_w::text <> '') ) or ( (nr_diarias_acompanhante_w IS NOT NULL AND nr_diarias_acompanhante_w::text <> '') and coalesce(nr_diarias_acompanhante_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(340614);
			dados_comparacao_w.valor_new(nr_index_w)		:= nr_diarias_acompanhante_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= nr_diarias_acompanhante_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( nr_diarias_uti_w <> nr_diarias_uti_old_w ) or ( coalesce(nr_diarias_uti_w::text, '') = '' and (nr_diarias_uti_old_w IS NOT NULL AND nr_diarias_uti_old_w::text <> '') ) or ( (nr_diarias_uti_w IS NOT NULL AND nr_diarias_uti_w::text <> '') and coalesce(nr_diarias_uti_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(287746);
			dados_comparacao_w.valor_new(nr_index_w)		:= nr_diarias_uti_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= nr_diarias_uti_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( ie_motivo_encerramento_w <> ie_motivo_encerramento_old_w ) or ( coalesce(ie_motivo_encerramento_w::text, '') = '' and (ie_motivo_encerramento_old_w IS NOT NULL AND ie_motivo_encerramento_old_w::text <> '') ) or ( (ie_motivo_encerramento_w IS NOT NULL AND ie_motivo_encerramento_w::text <> '') and coalesce(ie_motivo_encerramento_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(345445);
			dados_comparacao_w.valor_new(nr_index_w)		:= ie_motivo_encerramento_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= ie_motivo_encerramento_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( cd_cnes_prest_exec_w <> cd_cnes_prest_exec_old_w ) or ( coalesce(cd_cnes_prest_exec_w::text, '') = '' and (cd_cnes_prest_exec_old_w IS NOT NULL AND cd_cnes_prest_exec_old_w::text <> '') ) or ( (cd_cnes_prest_exec_w IS NOT NULL AND cd_cnes_prest_exec_w::text <> '') and coalesce(cd_cnes_prest_exec_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(742386);
			dados_comparacao_w.valor_new(nr_index_w)		:= cd_cnes_prest_exec_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= cd_cnes_prest_exec_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( cd_cpf_cgc_prest_exec_w <> cd_cpf_cgc_prest_exec_old_w ) or ( coalesce(cd_cpf_cgc_prest_exec_w::text, '') = '' and (cd_cpf_cgc_prest_exec_old_w IS NOT NULL AND cd_cpf_cgc_prest_exec_old_w::text <> '') ) or ( (cd_cpf_cgc_prest_exec_w IS NOT NULL AND cd_cpf_cgc_prest_exec_w::text <> '') and coalesce(cd_cpf_cgc_prest_exec_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(651681);
			dados_comparacao_w.valor_new(nr_index_w)		:= cd_cpf_cgc_prest_exec_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= cd_cpf_cgc_prest_exec_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( cd_municipio_prest_exec_w <> cd_municipio_prest_exec_old_w ) or ( coalesce(cd_municipio_prest_exec_w::text, '') = '' and (cd_municipio_prest_exec_old_w IS NOT NULL AND cd_municipio_prest_exec_old_w::text <> '') ) or ( (cd_municipio_prest_exec_w IS NOT NULL AND cd_municipio_prest_exec_w::text <> '') and coalesce(cd_municipio_prest_exec_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(297483);
			dados_comparacao_w.valor_new(nr_index_w)		:= cd_municipio_prest_exec_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= cd_municipio_prest_exec_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( nr_protocolo_ans_w <> nr_protocolo_ans_old_w ) or ( coalesce(nr_protocolo_ans_w::text, '') = '' and (nr_protocolo_ans_old_w IS NOT NULL AND nr_protocolo_ans_old_w::text <> '') ) or ( (nr_protocolo_ans_w IS NOT NULL AND nr_protocolo_ans_w::text <> '') and coalesce(nr_protocolo_ans_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(296588);
			dados_comparacao_w.valor_new(nr_index_w)		:= nr_protocolo_ans_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= nr_protocolo_ans_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( nr_cartao_nac_sus_w <> nr_cartao_nac_sus_old_w ) or ( coalesce(nr_cartao_nac_sus_w::text, '') = '' and (nr_cartao_nac_sus_old_w IS NOT NULL AND nr_cartao_nac_sus_old_w::text <> '') ) or ( (nr_cartao_nac_sus_w IS NOT NULL AND nr_cartao_nac_sus_w::text <> '') and coalesce(nr_cartao_nac_sus_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(284644);
			dados_comparacao_w.valor_new(nr_index_w)		:= nr_cartao_nac_sus_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= nr_cartao_nac_sus_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( vl_cobranca_guia_w <> vl_cobranca_guia_old_w ) or ( coalesce(vl_cobranca_guia_w::text, '') = '' and (vl_cobranca_guia_old_w IS NOT NULL AND vl_cobranca_guia_old_w::text <> '') ) or ( (vl_cobranca_guia_w IS NOT NULL AND vl_cobranca_guia_w::text <> '') and coalesce(vl_cobranca_guia_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(327455);
			dados_comparacao_w.valor_new(nr_index_w)		:= vl_cobranca_guia_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= vl_cobranca_guia_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( vl_total_glosa_w <> vl_total_glosa_old_w ) or ( coalesce(vl_total_glosa_w::text, '') = '' and (vl_total_glosa_old_w IS NOT NULL AND vl_total_glosa_old_w::text <> '') ) or ( (vl_total_glosa_w IS NOT NULL AND vl_total_glosa_w::text <> '') and coalesce(vl_total_glosa_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(493381);
			dados_comparacao_w.valor_new(nr_index_w)		:= vl_total_glosa_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= vl_total_glosa_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( cd_guia_sadt_princ_w <> cd_guia_sadt_princ_old_w ) or ( coalesce(cd_guia_sadt_princ_w::text, '') = '' and (cd_guia_sadt_princ_old_w IS NOT NULL AND cd_guia_sadt_princ_old_w::text <> '') ) or ( (cd_guia_sadt_princ_w IS NOT NULL AND cd_guia_sadt_princ_w::text <> '') and coalesce(cd_guia_sadt_princ_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(782823);
			dados_comparacao_w.valor_new(nr_index_w)		:= cd_guia_sadt_princ_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= cd_guia_sadt_princ_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( nr_registro_operadora_inter_w <> nr_registro_oper_inter_old_w ) or ( coalesce(nr_registro_operadora_inter_w::text, '') = '' and (nr_registro_oper_inter_old_w IS NOT NULL AND nr_registro_oper_inter_old_w::text <> '') ) or ( (nr_registro_operadora_inter_w IS NOT NULL AND nr_registro_operadora_inter_w::text <> '') and coalesce(nr_registro_oper_inter_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(782825);
			dados_comparacao_w.valor_new(nr_index_w)		:= nr_registro_operadora_inter_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= nr_registro_oper_inter_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;
		
		if ( vl_total_copart_w <> vl_total_copart_old_w ) or ( coalesce(vl_total_copart_w::text, '') = '' and (vl_total_copart_old_w IS NOT NULL AND vl_total_copart_old_w::text <> '') ) or ( (vl_total_copart_w IS NOT NULL AND vl_total_copart_w::text <> '') and coalesce(vl_total_copart_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(301302);
			dados_comparacao_w.valor_new(nr_index_w)		:= vl_total_copart_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= vl_total_copart_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;	

		if ( ie_sexo_w <> ie_sexo_old_w ) or ( coalesce(ie_sexo_w::text, '') = '' and (ie_sexo_old_w IS NOT NULL AND ie_sexo_old_w::text <> '') ) or ( (ie_sexo_w IS NOT NULL AND ie_sexo_w::text <> '') and coalesce(ie_sexo_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(288776);
			dados_comparacao_w.valor_new(nr_index_w)		:= ie_sexo_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= ie_sexo_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;	
		
		if ( dt_nascimento_w <> dt_nascimento_old_w ) or ( coalesce(dt_nascimento_w::text, '') = '' and (dt_nascimento_old_w IS NOT NULL AND dt_nascimento_old_w::text <> '') ) or ( (dt_nascimento_w IS NOT NULL AND dt_nascimento_w::text <> '') and coalesce(dt_nascimento_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(287061);
			dados_comparacao_w.valor_new(nr_index_w)		:= dt_nascimento_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= dt_nascimento_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;	
		
		if ( cd_municipio_benef_w <> cd_municipio_benef_old_w ) or ( coalesce(cd_municipio_benef_w::text, '') = '' and (cd_municipio_benef_old_w IS NOT NULL AND cd_municipio_benef_old_w::text <> '') ) or ( (cd_municipio_benef_w IS NOT NULL AND cd_municipio_benef_w::text <> '') and coalesce(cd_municipio_benef_old_w::text, '') = '' ) then
			dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(297510);
			dados_comparacao_w.valor_new(nr_index_w)		:= cd_municipio_benef_w;
			dados_comparacao_w.valor_old(nr_index_w)		:= cd_municipio_benef_old_w;
			dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
			dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
			dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
			nr_index_w := nr_index_w + 1;
		end if;	
		
		select	count(1)
		into STRICT	qt_diag_conta_w
		from	pls_monitor_tiss_diag
		where	nr_seq_guia_monitor = nr_seq_guia_monitor_p
		and	(cd_doenca IS NOT NULL AND cd_doenca::text <> '');
		
		if (qt_diag_conta_w > 0) then
			select	max(cd_doenca),
				max(ie_classificacao)
			into STRICT	cd_doenca_w,
				ie_classificacao_w
			from	pls_monitor_tiss_diag 
			where	nr_seq_guia_monitor = nr_seq_guia_monitor_p
			and	(cd_doenca IS NOT NULL AND cd_doenca::text <> '');
		
			select	max(cd_doenca),
				max(ie_classificacao)
			into STRICT	cd_doenca_old_w,
				ie_classificacao_old_w
			from	pls_monitor_tiss_diag 
			where	nr_seq_guia_monitor = nr_seq_guia_monit_old_w
			and	(cd_doenca IS NOT NULL AND cd_doenca::text <> '');
			
			if ( cd_doenca_w <> cd_doenca_old_w ) or ( coalesce(cd_doenca_w::text, '') = '' and (cd_doenca_old_w IS NOT NULL AND cd_doenca_old_w::text <> '') ) or ( (cd_doenca_w IS NOT NULL AND cd_doenca_w::text <> '') and coalesce(cd_doenca_old_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(310257);
				dados_comparacao_w.valor_new(nr_index_w)		:= cd_doenca_w;
				dados_comparacao_w.valor_old(nr_index_w)		:= cd_doenca_old_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( ie_classificacao_w <> ie_classificacao_old_w ) or ( coalesce(ie_classificacao_w::text, '') = '' and (ie_classificacao_old_w IS NOT NULL AND ie_classificacao_old_w::text <> '') ) or ( (ie_classificacao_w IS NOT NULL AND ie_classificacao_w::text <> '') and coalesce(ie_classificacao_old_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(782829);
				dados_comparacao_w.valor_new(nr_index_w)		:= ie_classificacao_w;
				dados_comparacao_w.valor_old(nr_index_w)		:= ie_classificacao_old_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
				nr_index_w := nr_index_w + 1;
			end if;	
		end if;
		
		for r_C01_w in C01(nr_seq_guia_monitor_p, nr_seq_guia_monit_old_w) loop
			
			select	max(a.cd_dente)	cd_dente,
				max(a.cd_face_dente) cd_face_dente,
				max(a.cd_grupo_proc) cd_grupo_proc,
				max(a.cd_procedimento) cd_procedimento,
				max(a.cd_regiao_boca) cd_regiao_boca,
				max(a.cd_tabela_ref) cd_tabela_ref,
				max(a.qt_procedimento) qt_procedimento,
				max(a.vl_procedimento) vl_procedimento,
				max(a.vl_coparticipacao) vl_coparticipacao
			into STRICT	cd_dente_w,
				cd_face_dente_w,
				cd_grupo_proc_w,
				cd_procedimento_w,
				cd_regiao_boca_w,
				cd_tabela_ref_w,
				qt_procedimento_w,
				vl_procedimento_w,
				vl_coparticipacao_w
			from	pls_monitor_tiss_proc a
			where	a.nr_sequencia = r_C01_w.nr_seq_proc_old;
			
			if ( r_C01_w.cd_dente <> cd_dente_w ) or ( coalesce(r_C01_w.cd_dente::text, '') = '' and (cd_dente_w IS NOT NULL AND cd_dente_w::text <> '') ) or ( (r_C01_w.cd_dente IS NOT NULL AND r_C01_w.cd_dente::text <> '') and coalesce(cd_dente_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(344712);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C01_w.cd_dente;
				dados_comparacao_w.valor_old(nr_index_w)		:= cd_dente_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= r_C01_w.nr_sequencia;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C01_w.cd_face_dente <> cd_face_dente_w ) or ( coalesce(r_C01_w.cd_face_dente::text, '') = '' and (cd_face_dente_w IS NOT NULL AND cd_face_dente_w::text <> '') ) or ( (r_C01_w.cd_face_dente IS NOT NULL AND r_C01_w.cd_face_dente::text <> '') and coalesce(cd_face_dente_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(340667);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C01_w.cd_face_dente;
				dados_comparacao_w.valor_old(nr_index_w)		:= cd_face_dente_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= r_C01_w.nr_sequencia;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C01_w.cd_grupo_proc <> cd_grupo_proc_w ) or ( coalesce(r_C01_w.cd_grupo_proc::text, '') = '' and (cd_grupo_proc_w IS NOT NULL AND cd_grupo_proc_w::text <> '') ) or ( (r_C01_w.cd_grupo_proc IS NOT NULL AND r_C01_w.cd_grupo_proc::text <> '') and coalesce(cd_grupo_proc_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(291048);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C01_w.cd_grupo_proc;
				dados_comparacao_w.valor_old(nr_index_w)		:= cd_grupo_proc_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= r_C01_w.nr_sequencia;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C01_w.cd_procedimento <> cd_procedimento_w ) or ( coalesce(r_C01_w.cd_procedimento::text, '') = '' and (cd_procedimento_w IS NOT NULL AND cd_procedimento_w::text <> '') ) or ( (r_C01_w.cd_procedimento IS NOT NULL AND r_C01_w.cd_procedimento::text <> '') and coalesce(cd_procedimento_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(303022);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C01_w.cd_procedimento;
				dados_comparacao_w.valor_old(nr_index_w)		:= cd_procedimento_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= r_C01_w.nr_sequencia;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C01_w.cd_regiao_boca <> cd_regiao_boca_w ) or ( coalesce(r_C01_w.cd_regiao_boca::text, '') = '' and (cd_regiao_boca_w IS NOT NULL AND cd_regiao_boca_w::text <> '') ) or ( (r_C01_w.cd_regiao_boca IS NOT NULL AND r_C01_w.cd_regiao_boca::text <> '') and coalesce(cd_regiao_boca_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(340868);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C01_w.cd_regiao_boca;
				dados_comparacao_w.valor_old(nr_index_w)		:= cd_regiao_boca_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= r_C01_w.nr_sequencia;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C01_w.cd_tabela_ref <> cd_tabela_ref_w ) or ( coalesce(r_C01_w.cd_tabela_ref::text, '') = '' and (cd_tabela_ref_w IS NOT NULL AND cd_tabela_ref_w::text <> '') ) or ( (r_C01_w.cd_tabela_ref IS NOT NULL AND r_C01_w.cd_tabela_ref::text <> '') and coalesce(cd_tabela_ref_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(299022);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C01_w.cd_tabela_ref;
				dados_comparacao_w.valor_old(nr_index_w)		:= cd_tabela_ref_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= r_C01_w.nr_sequencia;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C01_w.qt_procedimento <> qt_procedimento_w ) or ( coalesce(r_C01_w.qt_procedimento::text, '') = '' and (qt_procedimento_w IS NOT NULL AND qt_procedimento_w::text <> '') ) or ( (r_C01_w.qt_procedimento IS NOT NULL AND r_C01_w.qt_procedimento::text <> '') and coalesce(qt_procedimento_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(327789);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C01_w.qt_procedimento;
				dados_comparacao_w.valor_old(nr_index_w)		:= qt_procedimento_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= r_C01_w.nr_sequencia;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C01_w.vl_procedimento <> vl_procedimento_w ) or ( coalesce(r_C01_w.vl_procedimento::text, '') = '' and (vl_procedimento_w IS NOT NULL AND vl_procedimento_w::text <> '') ) or ( (r_C01_w.vl_procedimento IS NOT NULL AND r_C01_w.vl_procedimento::text <> '') and coalesce(vl_procedimento_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(327455);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C01_w.vl_procedimento;
				dados_comparacao_w.valor_old(nr_index_w)		:= vl_procedimento_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= r_C01_w.nr_sequencia;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C01_w.vl_coparticipacao <> vl_coparticipacao_w ) or ( coalesce(r_C01_w.vl_coparticipacao::text, '') = '' and (vl_coparticipacao_w IS NOT NULL AND vl_coparticipacao_w::text <> '') ) or ( (r_C01_w.vl_coparticipacao IS NOT NULL AND r_C01_w.vl_coparticipacao::text <> '') and coalesce(vl_coparticipacao_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(301302);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C01_w.vl_coparticipacao;
				dados_comparacao_w.valor_old(nr_index_w)		:= vl_coparticipacao_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= r_C01_w.nr_sequencia;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= null;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if (nr_index_w >= pls_util_pck.qt_registro_transacao_w) then
				insere_campos(dados_comparacao_w);
				nr_index_w := 0;
			end if;
		end loop;
		
		for r_C02_w in C02(nr_seq_guia_monitor_p, nr_seq_guia_monit_old_w) loop
			
			select	max(a.cd_cgc_fornecedor) cd_cgc_fornecedor,
				max(a.cd_grupo_proc) cd_grupo_proc,
				max(a.cd_material)	cd_material,
				max(a.cd_tabela_ref) cd_tabela_ref,
				max(a.qt_material) qt_material,
				max(a.vl_coparticipacao) vl_coparticipacao,
				max(a.vl_material) vl_material,
				max(a.vl_pago_fornecedor) vl_pago_fornecedor
			into STRICT	cd_cgc_fornecedor_w,
				cd_grupo_proc_w,
				cd_material_w,
				cd_tabela_ref_w,
				qt_material_w,
				vl_coparticipacao_w,
				vl_material_w,
				vl_pago_fornecedor_w
			from	pls_monitor_tiss_mat a
			where	a.nr_sequencia = r_C02_w.nr_seq_mat_old;
			
			if ( r_C02_w.cd_cgc_fornecedor <> cd_cgc_fornecedor_w ) or ( coalesce(r_C02_w.cd_cgc_fornecedor::text, '') = '' and (cd_cgc_fornecedor_w IS NOT NULL AND cd_cgc_fornecedor_w::text <> '') ) or ( (r_C02_w.cd_cgc_fornecedor IS NOT NULL AND r_C02_w.cd_cgc_fornecedor::text <> '') and coalesce(cd_cgc_fornecedor_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(621887);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C02_w.cd_cgc_fornecedor;
				dados_comparacao_w.valor_old(nr_index_w)		:= vl_coparticipacao_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= r_C02_w.nr_sequencia;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C02_w.cd_grupo_proc <> cd_grupo_proc_w ) or ( coalesce(r_C02_w.cd_grupo_proc::text, '') = '' and (cd_grupo_proc_w IS NOT NULL AND cd_grupo_proc_w::text <> '') ) or ( (r_C02_w.cd_grupo_proc IS NOT NULL AND r_C02_w.cd_grupo_proc::text <> '') and coalesce(cd_grupo_proc_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(291048);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C02_w.cd_grupo_proc;
				dados_comparacao_w.valor_old(nr_index_w)		:= cd_grupo_proc_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= r_C02_w.nr_sequencia;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C02_w.cd_material <> cd_material_w ) or ( coalesce(r_C02_w.cd_material::text, '') = '' and (cd_material_w IS NOT NULL AND cd_material_w::text <> '') ) or ( (r_C02_w.cd_material IS NOT NULL AND r_C02_w.cd_material::text <> '') and coalesce(cd_material_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(302989);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C02_w.cd_material;
				dados_comparacao_w.valor_old(nr_index_w)		:= cd_material_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= r_C02_w.nr_sequencia;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C02_w.cd_tabela_ref <> cd_tabela_ref_w ) or ( coalesce(r_C02_w.cd_tabela_ref::text, '') = '' and (cd_tabela_ref_w IS NOT NULL AND cd_tabela_ref_w::text <> '') ) or ( (r_C02_w.cd_tabela_ref IS NOT NULL AND r_C02_w.cd_tabela_ref::text <> '') and coalesce(cd_tabela_ref_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(299022);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C02_w.cd_tabela_ref;
				dados_comparacao_w.valor_old(nr_index_w)		:= cd_tabela_ref_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= r_C02_w.nr_sequencia;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C02_w.qt_material <> qt_material_w ) or ( coalesce(r_C02_w.qt_material::text, '') = '' and (qt_material_w IS NOT NULL AND qt_material_w::text <> '') ) or ( (r_C02_w.qt_material IS NOT NULL AND r_C02_w.qt_material::text <> '') and coalesce(qt_material_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(327789);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C02_w.qt_material;
				dados_comparacao_w.valor_old(nr_index_w)		:= qt_material_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= r_C02_w.nr_sequencia;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C02_w.vl_coparticipacao <> vl_coparticipacao_w ) or ( coalesce(r_C02_w.vl_coparticipacao::text, '') = '' and (vl_coparticipacao_w IS NOT NULL AND vl_coparticipacao_w::text <> '') ) or ( (r_C02_w.vl_coparticipacao IS NOT NULL AND r_C02_w.vl_coparticipacao::text <> '') and coalesce(vl_coparticipacao_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(301302);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C02_w.vl_coparticipacao;
				dados_comparacao_w.valor_old(nr_index_w)		:= vl_coparticipacao_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= r_C02_w.nr_sequencia;
				nr_index_w := nr_index_w + 1;
			end if;	
			
			if ( r_C02_w.vl_material <> vl_material_w ) or ( coalesce(r_C02_w.vl_material::text, '') = '' and (vl_material_w IS NOT NULL AND vl_material_w::text <> '') ) or ( (r_C02_w.vl_material IS NOT NULL AND r_C02_w.vl_material::text <> '') and coalesce(vl_material_w::text, '') = '' ) then
				dados_comparacao_w.ds_campo(nr_index_w)			:= obter_desc_expressao(327455);
				dados_comparacao_w.valor_new(nr_index_w)		:= r_C02_w.vl_material;
				dados_comparacao_w.valor_old(nr_index_w)		:= vl_material_w;
				dados_comparacao_w.nr_seq_guia_monitor(nr_index_w)	:= nr_seq_guia_monitor_p;
				dados_comparacao_w.nr_seq_proc_monitor(nr_index_w)	:= null;
				dados_comparacao_w.nr_seq_mat_monitor(nr_index_w)	:= r_C02_w.nr_sequencia;
				nr_index_w := nr_index_w + 1;
			end if;

			if (nr_index_w >= pls_util_pck.qt_registro_transacao_w) then
				insere_campos(dados_comparacao_w);
				nr_index_w := 0;
			end if;			
		end loop;
		
		insere_campos(dados_comparacao_w);
	end if;
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_comparar_envio_monitor ( nr_seq_guia_monitor_p pls_monitor_tiss_guia.nr_sequencia%type) FROM PUBLIC;

