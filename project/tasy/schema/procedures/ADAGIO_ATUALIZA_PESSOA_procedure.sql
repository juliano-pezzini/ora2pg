-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE adagio_atualiza_pessoa ( cd_pessoa_fisica_p pessoa_fisica.cd_pessoa_fisica%type, cd_curp_p pessoa_fisica.cd_curp%type, cd_nacionalidade_p pessoa_fisica.cd_nacionalidade%type, cd_rfc_p pessoa_fisica.cd_rfc%type, cd_sistema_ant_p pessoa_fisica.cd_sistema_ant%type, dt_nascimento_p text, ie_funcionario_p pessoa_fisica.ie_funcionario%type, ie_sexo_p pessoa_fisica.ie_sexo%type, nm_primeiro_nome_p pessoa_fisica.nm_primeiro_nome%type, nm_sobrenome_mae_p pessoa_fisica.nm_sobrenome_mae%type, nm_sobrenome_pai_p pessoa_fisica.nm_sobrenome_pai%type, nr_prontuario_p pessoa_fisica.nr_prontuario%type, nr_ddi_celular_p pessoa_fisica.nr_ddi_celular%type, nr_telefone_celular_p pessoa_fisica.nr_telefone_celular%type, nm_usuario_p pessoa_fisica.nm_usuario%type, cd_estabelecimento_p pessoa_fisica.cd_estabelecimento%type, ie_tipo_pessoa_p pessoa_fisica.ie_tipo_pessoa%type, ie_estado_civil_p pessoa_fisica.ie_estado_civil%type, acao text, cd_nv_pessoa_fisica_p INOUT pessoa_fisica.cd_pessoa_fisica%type ) AS $body$
DECLARE


        cd_pessoa_fisica_w pessoa_fisica.cd_pessoa_fisica%type;


BEGIN

  case acao
    when 'INSERT' then

    select  nextval('pessoa_fisica_seq')
      into STRICT  cd_pessoa_fisica_w
;

    insert into pessoa_fisica(
      cd_pessoa_fisica,
      cd_curp,
      cd_nacionalidade,
      cd_rfc,
      cd_sistema_ant,
      dt_nascimento,
      ie_funcionario,
      ie_sexo,
      nm_primeiro_nome,
      nm_sobrenome_mae,
      nm_sobrenome_pai,
      nr_prontuario,
      nr_telefone_celular,
      dt_atualizacao,
      nm_usuario,
      cd_estabelecimento,
      ie_estado_civil,
      ie_tipo_pessoa,
	    nr_ddi_celular

    ) values (
      cd_pessoa_fisica_w,
      cd_curp_p,
      cd_nacionalidade_p,
      cd_rfc_p,
      cd_sistema_ant_p,
      TO_DATE(dt_nascimento_p,'YYYYMMDD'),
      ie_funcionario_p,
      ie_sexo_p,
      nm_primeiro_nome_p,
      nm_sobrenome_mae_p,
      nm_sobrenome_pai_p,
      nr_prontuario_p,
      nr_telefone_celular_p,
      clock_timestamp(),
      nm_usuario_p,
      cd_estabelecimento_p,
      ie_estado_civil_p,
      ie_tipo_pessoa_p,
	    nr_ddi_celular_p
      );
    cd_nv_pessoa_fisica_p := cd_pessoa_fisica_w;

  when 'UPDATE' then
    update pessoa_fisica
      set cd_curp            = cd_curp_p,
      cd_nacionalidade       = cd_nacionalidade_p,
      cd_sistema_ant         = cd_sistema_ant_p,
      dt_nascimento          = TO_DATE(dt_nascimento_p,'YYYYMMDD'),
      ie_funcionario         = ie_funcionario_p,
      ie_sexo                = ie_sexo_p,
      nm_primeiro_nome       = nm_primeiro_nome_p,
      nm_sobrenome_mae       = nm_sobrenome_mae_p,
      nm_sobrenome_pai       = nm_sobrenome_pai_p,
      nr_prontuario          = nr_prontuario_p,
      dt_atualizacao         = clock_timestamp(),
      nm_usuario             = nm_usuario_p,
      cd_estabelecimento     = cd_estabelecimento_p,
	    nr_ddi_celular         = nr_ddi_celular_p,
	    nr_telefone_celular    = nr_telefone_celular_p,
	    ie_estado_civil        = ie_estado_civil_p
    where cd_pessoa_fisica   = cd_pessoa_fisica_p
    and   cd_rfc             = cd_rfc_p;

  when 'DELETE' then

    delete from pessoa_fisica
    where cd_pessoa_fisica     = cd_pessoa_fisica_p;

  end case;
  commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE adagio_atualiza_pessoa ( cd_pessoa_fisica_p pessoa_fisica.cd_pessoa_fisica%type, cd_curp_p pessoa_fisica.cd_curp%type, cd_nacionalidade_p pessoa_fisica.cd_nacionalidade%type, cd_rfc_p pessoa_fisica.cd_rfc%type, cd_sistema_ant_p pessoa_fisica.cd_sistema_ant%type, dt_nascimento_p text, ie_funcionario_p pessoa_fisica.ie_funcionario%type, ie_sexo_p pessoa_fisica.ie_sexo%type, nm_primeiro_nome_p pessoa_fisica.nm_primeiro_nome%type, nm_sobrenome_mae_p pessoa_fisica.nm_sobrenome_mae%type, nm_sobrenome_pai_p pessoa_fisica.nm_sobrenome_pai%type, nr_prontuario_p pessoa_fisica.nr_prontuario%type, nr_ddi_celular_p pessoa_fisica.nr_ddi_celular%type, nr_telefone_celular_p pessoa_fisica.nr_telefone_celular%type, nm_usuario_p pessoa_fisica.nm_usuario%type, cd_estabelecimento_p pessoa_fisica.cd_estabelecimento%type, ie_tipo_pessoa_p pessoa_fisica.ie_tipo_pessoa%type, ie_estado_civil_p pessoa_fisica.ie_estado_civil%type, acao text, cd_nv_pessoa_fisica_p INOUT pessoa_fisica.cd_pessoa_fisica%type ) FROM PUBLIC;

