-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE ptu_imp_anexos_v60 ( nr_seq_pedido_aut_p ptu_pedido_autorizacao.nr_sequencia%type, nr_seq_pedido_aut_compl_p ptu_pedido_compl_aut.nr_sequencia%type, nr_seq_ordem_serv_p ptu_requisicao_ordem_serv.nr_sequencia%type, ds_procedimento_cirurgico_p ptu_pedido_aut_anexo.ds_procedimento_cirurgico%type, dt_real_proc_cirurgico_p text, ds_quimioterapia_p ptu_pedido_aut_anexo.ds_quimioterapia%type, dt_quimioterapia_p text, qt_dose_total_p ptu_pedido_aut_anexo.qt_dose_total%type, qt_dose_dia_p ptu_pedido_aut_anexo.qt_dose_dia%type, dt_inicio_previsto_p text, qt_dias_previsto_p ptu_pedido_aut_anexo.qt_dias_previsto%type, qt_peso_p ptu_pedido_aut_anexo.qt_peso%type, qt_altura_p ptu_pedido_aut_anexo.qt_altura%type, qt_superficie_corporal_p ptu_pedido_aut_anexo.qt_superficie_corporal%type, ds_area_irradiada_p ptu_pedido_aut_anexo.ds_area_irradiada%type, nr_ciclo_previsto_p ptu_pedido_aut_anexo.nr_ciclo_previsto%type, dt_radioterapia_p text, nr_ciclo_atual_p ptu_pedido_aut_anexo.nr_ciclo_atual%type, qt_intervalo_ciclo_p ptu_pedido_aut_anexo.qt_intervalo_ciclo%type, nr_campos_p ptu_pedido_aut_anexo.nr_campos%type, ie_tipo_anexo_p ptu_pedido_aut_anexo.ie_tipo_anexo%type, ds_justificativa_p ptu_pedido_aut_anexo.ds_justificativa%type, ds_especificacao_p ptu_pedido_aut_anexo.ds_especificacao%type, ds_observacao_p ptu_pedido_aut_anexo.ds_observacao%type, nr_dia_ciclo_atual_p ptu_pedido_aut_anexo.nr_dia_ciclo_atual%type, nm_profissional_solic_p ptu_pedido_aut_anexo.nm_profissional_solic%type, nr_telef_prof_solic_p ptu_pedido_aut_anexo.nr_telef_prof_solic%type, ds_email_prof_solic_p ptu_pedido_aut_anexo.ds_email_prof_solic%type, nm_usuario_p usuario.nm_usuario%type, nr_seq_pedido_aut_anexo_p INOUT ptu_pedido_aut_anexo.nr_sequencia%type) AS $body$
DECLARE


/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Finalidade: Realizar a importação dos dados de anexo dos pedidos abaixo

00600 - Pedido de Autorização
00605 - Pedido de Complemento de Autorização
00806 - Ordem de Serviço

NR_SEQ_PEDIDO_AUT_P  Deve ser preenchido somente quando for a transação 00600
NR_SEQ_PEDIDO_AUT_COMPL_P	Deve ser preenchido somente quando for a transação 00605
NR_SEQ_ORDEM_SERV_P Deve ser preenchido somente quando for a transação 00806
-------------------------------------------------------------------------------------------------------------------
Locais de chamada direta:
[  ]  Objetos do dicionário [ X] Tasy (Delphi/Java) [ x ] Portal [  ]  Relatórios [ x] Outros:
 ------------------------------------------------------------------------------------------------------------------
Pontos de atenção:
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
dt_real_proc_cirurgico_w	ptu_pedido_aut_anexo.dt_real_proc_cirurgico%type;
dt_quimioterapia_w		ptu_pedido_aut_anexo.dt_quimioterapia%type;
dt_inicio_previsto_w		ptu_pedido_aut_anexo.dt_inicio_previsto%type;
dt_radioterapia_w		ptu_pedido_aut_anexo.dt_radioterapia%type;


BEGIN

if (coalesce(dt_real_proc_cirurgico_p,'X')	<> 'X') then
	dt_real_proc_cirurgico_w	:= to_date(dt_real_proc_cirurgico_p, 'dd/mm/rrrr');
end if;

if (coalesce(dt_quimioterapia_p,'X')	<> 'X') then
	dt_quimioterapia_w	:= to_date(dt_quimioterapia_p, 'dd/mm/rrrr');
end if;

if (coalesce(dt_inicio_previsto_p,'X')	<> 'X') then
	dt_inicio_previsto_w	:= to_date(dt_inicio_previsto_p, 'dd/mm/rrrr');
end if;

if (coalesce(dt_radioterapia_p,'X')	<> 'X') then
	dt_radioterapia_w	:= to_date(dt_radioterapia_p, 'dd/mm/rrrr');
end if;

insert 	into ptu_pedido_aut_anexo(nr_sequencia, nr_seq_pedido, dt_atualizacao,
	nm_usuario, dt_atualizacao_nrec, nm_usuario_nrec,
	ds_procedimento_cirurgico, dt_real_proc_cirurgico, ds_quimioterapia,
	dt_quimioterapia, qt_dose_total, qt_dose_dia,
	dt_inicio_previsto, qt_dias_previsto, qt_peso,
	qt_altura, qt_superficie_corporal, ds_area_irradiada,
	nr_ciclo_previsto, dt_radioterapia, nr_ciclo_atual,
	qt_intervalo_ciclo, nr_campos, ie_tipo_anexo,
	nr_seq_pedido_compl, ds_justificativa, ds_especificacao,
	ds_observacao, nm_profissional_solic, nr_telef_prof_solic,
	ds_email_prof_solic, nr_seq_ordem_serv, nr_dia_ciclo_atual)
values ( nextval('ptu_pedido_aut_anexo_seq'), nr_seq_pedido_aut_p, clock_timestamp(),
	nm_usuario_p, clock_timestamp(), nm_usuario_p,
	ds_procedimento_cirurgico_p, dt_real_proc_cirurgico_w, ds_quimioterapia_p,
	dt_quimioterapia_w, qt_dose_total_p, qt_dose_dia_p,
	dt_inicio_previsto_w, qt_dias_previsto_p, qt_peso_p,
	qt_altura_p, qt_superficie_corporal_p, ds_area_irradiada_p,
	nr_ciclo_previsto_p, dt_radioterapia_w, nr_ciclo_atual_p,
	qt_intervalo_ciclo_p, nr_campos_p, ie_tipo_anexo_p,
	nr_seq_pedido_aut_compl_p,  ds_justificativa_p, ds_especificacao_p,
	ds_observacao_p, nm_profissional_solic_p, nr_telef_prof_solic_p,
	ds_email_prof_solic_p, nr_seq_ordem_serv_p, nr_dia_ciclo_atual_p) returning nr_sequencia into nr_seq_pedido_aut_anexo_p;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ptu_imp_anexos_v60 ( nr_seq_pedido_aut_p ptu_pedido_autorizacao.nr_sequencia%type, nr_seq_pedido_aut_compl_p ptu_pedido_compl_aut.nr_sequencia%type, nr_seq_ordem_serv_p ptu_requisicao_ordem_serv.nr_sequencia%type, ds_procedimento_cirurgico_p ptu_pedido_aut_anexo.ds_procedimento_cirurgico%type, dt_real_proc_cirurgico_p text, ds_quimioterapia_p ptu_pedido_aut_anexo.ds_quimioterapia%type, dt_quimioterapia_p text, qt_dose_total_p ptu_pedido_aut_anexo.qt_dose_total%type, qt_dose_dia_p ptu_pedido_aut_anexo.qt_dose_dia%type, dt_inicio_previsto_p text, qt_dias_previsto_p ptu_pedido_aut_anexo.qt_dias_previsto%type, qt_peso_p ptu_pedido_aut_anexo.qt_peso%type, qt_altura_p ptu_pedido_aut_anexo.qt_altura%type, qt_superficie_corporal_p ptu_pedido_aut_anexo.qt_superficie_corporal%type, ds_area_irradiada_p ptu_pedido_aut_anexo.ds_area_irradiada%type, nr_ciclo_previsto_p ptu_pedido_aut_anexo.nr_ciclo_previsto%type, dt_radioterapia_p text, nr_ciclo_atual_p ptu_pedido_aut_anexo.nr_ciclo_atual%type, qt_intervalo_ciclo_p ptu_pedido_aut_anexo.qt_intervalo_ciclo%type, nr_campos_p ptu_pedido_aut_anexo.nr_campos%type, ie_tipo_anexo_p ptu_pedido_aut_anexo.ie_tipo_anexo%type, ds_justificativa_p ptu_pedido_aut_anexo.ds_justificativa%type, ds_especificacao_p ptu_pedido_aut_anexo.ds_especificacao%type, ds_observacao_p ptu_pedido_aut_anexo.ds_observacao%type, nr_dia_ciclo_atual_p ptu_pedido_aut_anexo.nr_dia_ciclo_atual%type, nm_profissional_solic_p ptu_pedido_aut_anexo.nm_profissional_solic%type, nr_telef_prof_solic_p ptu_pedido_aut_anexo.nr_telef_prof_solic%type, ds_email_prof_solic_p ptu_pedido_aut_anexo.ds_email_prof_solic%type, nm_usuario_p usuario.nm_usuario%type, nr_seq_pedido_aut_anexo_p INOUT ptu_pedido_aut_anexo.nr_sequencia%type) FROM PUBLIC;

