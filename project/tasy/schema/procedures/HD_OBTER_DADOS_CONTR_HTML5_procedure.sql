-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE hd_obter_dados_contr_html5 ( nr_seq_dialise_p bigint, qt_tempo_controle_p bigint, qt_fluxo_sangue_p INOUT bigint, qt_fluxo_dialisado_p INOUT bigint, qt_pa_arterial_p INOUT bigint, qt_heparina_p INOUT bigint, qt_sangue_dial_p INOUT bigint, ie_clearence_p INOUT text, ie_kvt_p INOUT text, nm_paciente_p INOUT text, hr_controle_p INOUT text, ie_tipo_dialise_p INOUT text, hr_dialise_retro_p INOUT timestamp) AS $body$
DECLARE


ie_cad_maquinas_w	varchar(1) := 'N';

BEGIN
ie_cad_maquinas_w := obter_valor_param_usuario(7009,119,obter_perfil_ativo,wheb_usuario_pck.get_nm_usuario,wheb_usuario_pck.get_cd_estabelecimento);

SELECT * FROM HD_Obter_Dados_Ultimo_Controle(nr_seq_dialise_p, qt_fluxo_sangue_p, qt_fluxo_dialisado_p, qt_pa_arterial_p, qt_heparina_p, qt_sangue_dial_p) INTO STRICT qt_fluxo_sangue_p, qt_fluxo_dialisado_p, qt_pa_arterial_p, qt_heparina_p, qt_sangue_dial_p;
if (ie_cad_maquinas_w = 'N') then
	ie_clearence_p 	:= coalesce(hd_obter_dados_modelo_maq(HD_Obter_Dados_Maquina(hd_obter_maquina_controle(nr_seq_dialise_p),'M'),'CL'),'N');
	ie_kvt_p	:= coalesce(hd_obter_dados_modelo_maq(HD_Obter_Dados_Maquina(hd_obter_maquina_controle(nr_seq_dialise_p),'M'),'K'),'N');
else
	ie_clearence_p  := coalesce(HD_Obter_Dados_Maquina(hd_obter_maquina_controle(nr_seq_dialise_p),'CLE'),'N');
	ie_kvt_p	:= coalesce(HD_Obter_Dados_Maquina(hd_obter_maquina_controle(nr_seq_dialise_p),'KTV'),'N');
end if;
hr_controle_p	:= to_char(obter_hora_controle(nr_seq_dialise_p, qt_tempo_controle_p),'hh24:mi');
nm_paciente_p	:= hd_obter_dados_dialise(nr_seq_dialise_p, 'NP');

ie_tipo_dialise_p := hd_obter_dados_dialise(nr_seq_dialise_p, 'TD');

hr_dialise_retro_p := hd_obter_dt_dia_retro_html5(nr_seq_dialise_p);

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE hd_obter_dados_contr_html5 ( nr_seq_dialise_p bigint, qt_tempo_controle_p bigint, qt_fluxo_sangue_p INOUT bigint, qt_fluxo_dialisado_p INOUT bigint, qt_pa_arterial_p INOUT bigint, qt_heparina_p INOUT bigint, qt_sangue_dial_p INOUT bigint, ie_clearence_p INOUT text, ie_kvt_p INOUT text, nm_paciente_p INOUT text, hr_controle_p INOUT text, ie_tipo_dialise_p INOUT text, hr_dialise_retro_p INOUT timestamp) FROM PUBLIC;

