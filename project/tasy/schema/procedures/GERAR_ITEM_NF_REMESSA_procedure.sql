-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_item_nf_remessa ( nm_usuario_p text, nr_sequencia_p bigint, nr_sequencia_nf_p bigint) AS $body$
BEGIN

if (nr_sequencia_p IS NOT NULL AND nr_sequencia_p::text <> '' AND nr_sequencia_nf_p IS NOT NULL AND nr_sequencia_nf_p::text <> '') then

	insert into nota_fiscal_item(
			nr_sequencia,
			cd_estabelecimento,
			cd_cgc_emitente,
			cd_serie_nf,
			nr_nota_fiscal,
			nr_sequencia_nf,
			nr_item_nf,
			cd_natureza_operacao,
			qt_item_nf,
			vl_unitario_item_nf,
			vl_total_item_nf,
			dt_atualizacao,
			nm_usuario,
			vl_frete,
			vl_desconto,
			vl_despesa_acessoria,
			cd_material,
			cd_procedimento,
			cd_setor_atendimento,
			cd_conta,
			cd_local_estoque,
			ds_observacao,
			qt_peso_bruto,
			qt_peso_liquido,
			cd_unidade_medida_compra,
			qt_item_estoque,
			cd_unidade_medida_estoque,
			cd_lote_fabricacao,
			dt_validade,
			dt_atualizacao_estoque,
			cd_conta_contabil,
			vl_desconto_rateio,
			vl_seguro,
			cd_centro_custo,
			cd_material_estoque,
			ie_origem_proced,
			nr_ordem_compra,
			vl_liquido,
			pr_desconto,
			nr_item_oci,
			dt_entrega_ordem,
			nr_seq_conta_financ,
			nr_contrato,
			ds_complemento,
			nr_seq_proj_rec,
			vl_projeto,
			nr_atendimento,
			pr_desc_financ,
			vl_desc_financ,
			nr_seq_lic_item,
			nr_seq_ordem_serv,
			ds_inconsistencia,
			ds_justificativa,
			vl_liq_moeda_ref,
			nr_seq_unidade_adic,
			nr_emprestimo,
			nr_seq_item_emprestimo,
			ie_atualizar_barras,
			cd_barra_material,
			nr_sequencia_vinc_consig,
			nr_seq_proj_gpi,
			nr_seq_etapa_gpi,
			nr_seq_conta_gpi,
			dt_inicio_garantia,
			dt_fim_garantia,
			nr_seq_marca,
			ie_indeterminado)
		(SELECT	nr_sequencia_nf_p,
			cd_estabelecimento,
			cd_cgc_emitente,
			cd_serie_nf,
			nr_nota_fiscal,
			nr_sequencia_nf,
			nr_item_nf,
			cd_natureza_operacao,
			qt_item_nf,
			vl_unitario_item_nf,
			vl_total_item_nf,
			clock_timestamp(),
			nm_usuario_p,
			vl_frete,
			vl_desconto,
			vl_despesa_acessoria,
			cd_material,
			cd_procedimento,
			cd_setor_atendimento,
			cd_conta,
			cd_local_estoque,
			ds_observacao,
			qt_peso_bruto,
			qt_peso_liquido,
			cd_unidade_medida_compra,
			qt_item_estoque,
			cd_unidade_medida_estoque,
			cd_lote_fabricacao,
			dt_validade,
			'',
			cd_conta_contabil,
			vl_desconto_rateio,
			vl_seguro,
			cd_centro_custo,
			cd_material_estoque,
			ie_origem_proced,
			nr_ordem_compra,
			(vl_total_item_nf - vl_desconto),
			pr_desconto,
			nr_item_oci,
			dt_entrega_ordem,
			nr_seq_conta_financ,
			nr_contrato,
			ds_complemento,
			nr_seq_proj_rec,
			vl_projeto,
			nr_atendimento,
			pr_desc_financ,
			vl_desc_financ,
			nr_seq_lic_item,
			nr_seq_ordem_serv,
			ds_inconsistencia,
			ds_justificativa,
			vl_liq_moeda_ref,
			nr_seq_unidade_adic,
			nr_emprestimo,
			nr_seq_item_emprestimo,
			ie_atualizar_barras,
			cd_barra_material,
			nr_sequencia_vinc_consig,
			nr_seq_proj_gpi,
			nr_seq_etapa_gpi,
			nr_seq_conta_gpi,
			dt_inicio_garantia,
			dt_fim_garantia,
			nr_seq_marca,
			ie_indeterminado
		from	nota_fiscal_item
		where	nr_sequencia = nr_sequencia_p);

end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_item_nf_remessa ( nm_usuario_p text, nr_sequencia_p bigint, nr_sequencia_nf_p bigint) FROM PUBLIC;

