-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE core_table_items_insertion ( nm_value_p text, nm_table_p text, nr_seq_col_ref_p text, ie_status_p text ) AS $body$
DECLARE

    nm_value_w   bigint;
    nr_count_w   bigint;

BEGIN
    EXECUTE 'select count(*) from '
                      || nm_table_p
                      || ' where '
                      || nr_seq_col_ref_p
                      || ' ='''
                      || nm_value_p
                      || ''''
    INTO STRICT nr_count_w;

    IF ( nr_count_w = 0 ) THEN
        EXECUTE 'select nvl(max(nr_sequencia), 0)+1 from ' || nm_table_p
        INTO STRICT nm_value_w;
        EXECUTE 'insert into '
                          || nm_table_p
                          || ' ( nr_sequencia,dt_atualizacao,nm_usuario,'
                          || nr_seq_col_ref_p
                          || ',IE_SITUACAO) values( '
                          || nm_value_w
                          || ',sysdate,''smbuchapalli'','''
                          || nm_value_p
                          || ''','''
                          || ie_status_p
                          || ''')';

        COMMIT;
    END IF;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE core_table_items_insertion ( nm_value_p text, nm_table_p text, nr_seq_col_ref_p text, ie_status_p text ) FROM PUBLIC;

