-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE importar_cep_bairros ( cd_bairro_dne_p bigint, ds_bairro_p text, cd_localidade_dne_p text, sg_uf_p text, nm_usuario_p text) AS $body$
DECLARE


ds_parametros_w		varchar(2000);
ds_insert_w		varchar(2000) := 	':nr_sequencia_p,' ||
						':ds_bairro_p,' ||
						':nr_seq_loc_p,' ||
						':sg_uf_p,' ||
						':dt_atualizacao_p,' ||
						':nm_usuario_p';

ds_comando_w		varchar(2000) := '	insert	into w_cep_bairro ' ||
							'(nr_sequencia,' ||
							'ds_bairro,' ||
							'nr_seq_loc,' ||
							'ds_uf,' ||
							'dt_atualizacao,' ||
							'nm_usuario)' ||
						'values	(' || ds_insert_w || ')';


BEGIN

if (cd_bairro_dne_p IS NOT NULL AND cd_bairro_dne_p::text <> '') and (ds_bairro_p IS NOT NULL AND ds_bairro_p::text <> '') and (cd_localidade_dne_p IS NOT NULL AND cd_localidade_dne_p::text <> '') and (sg_uf_p IS NOT NULL AND sg_uf_p::text <> '') then

	ds_parametros_w := 'NR_SEQUENCIA_P=' || cd_bairro_dne_p || ';' || 'DS_BAIRRO_P=' || ds_bairro_p || ';' || 'NR_SEQ_LOC_P=' || cd_localidade_dne_p || ';'
				|| 'SG_UF_P=' || sg_uf_p || ';' || 'DT_ATUALIZACAO_P=' || clock_timestamp() || ';' || 'NM_USUARIO_P=' || nm_usuario_p || ';';

	CALL gravar_processo_longo(ds_comando_w,'IMPORTAR_CEP_BAIRROS',null);
	CALL Exec_Sql_Dinamico_bv('Insert w_cep_bairro: ' || cd_bairro_dne_p, ds_comando_w,ds_parametros_w);

	commit;
end if;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE importar_cep_bairros ( cd_bairro_dne_p bigint, ds_bairro_p text, cd_localidade_dne_p text, sg_uf_p text, nm_usuario_p text) FROM PUBLIC;

