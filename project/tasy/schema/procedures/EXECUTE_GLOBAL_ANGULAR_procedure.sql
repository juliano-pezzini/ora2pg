-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE execute_global_angular ( nm_acao_p text, cd_funcao_p bigint, nm_usuario_p text, nr_seq_obj_script_p INOUT bigint, nr_seq_obj_proc_func_p INOUT bigint, nr_sequencia_p INOUT bigint ) AS $body$
DECLARE



nr_seq_obj_evento_w 	obj_schematic_evento.nr_sequencia%type;




BEGIN

begin



	select	coalesce(max(y.nr_sequencia),0) nr_sequencia
	into STRICT	nr_seq_obj_evento_w
	from	obj_schematic_evento y
	where	y.nm_acao = nm_acao_p
	and		y.cd_funcao = cd_funcao_p; -- busca o nr_sequencia do registro com refência da desc cadastrada e a função
	if (nr_seq_obj_evento_w > 0) then

			select	coalesce(a.nr_seq_obj_proc,0) nr_seq_obj_proc, -- retorna caso tenha o codigo das procedure ou funcion a ser executado
					coalesce(a.nr_seq_dic_obj_sql,0) nr_seq_dic_obj_sql, --  retorna caso tenha o codigo do script a ser executado
					a.nr_sequencia
			into STRICT	nr_seq_obj_proc_func_p,
					nr_seq_obj_script_p,
					nr_sequencia_p
			from	obj_schematic_evento_acao a
			where	a.nr_seq_obj_evento = nr_seq_obj_evento_w;

	end if;


exception
when others then
	null;
end;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE execute_global_angular ( nm_acao_p text, cd_funcao_p bigint, nm_usuario_p text, nr_seq_obj_script_p INOUT bigint, nr_seq_obj_proc_func_p INOUT bigint, nr_sequencia_p INOUT bigint ) FROM PUBLIC;

