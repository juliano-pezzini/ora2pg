-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE baca_ajustar_convenio_estab () AS $body$
DECLARE

 
 
nr_sequencia_w			bigint;
nr_seq_convenio_estab_w		bigint;
cd_convenio_w			integer;
cd_estabelecimento_w		smallint;
qt_registros_w			integer	:= 0;
nm_usuario_w			varchar(15);

ie_exige_data_ult_pagto_w	varchar(1);
ie_exige_guia_w			varchar(1);
ie_exige_orc_atend_w		varchar(1);
ie_glosa_atendimento_w		varchar(1);
ie_preco_medio_material_w	varchar(1);
ie_agenda_consulta_w		varchar(1);
ie_rep_cod_usuario_w		varchar(1);
ie_exige_carteira_atend_w	varchar(1);
ie_exige_validade_atend_w	varchar(1);
ie_exige_plano_w		varchar(1);
ie_separa_conta_w		varchar(1);
ie_guia_unica_conta_w		varchar(1);
ie_valor_contabil_w		varchar(1);
ie_titulo_receber_w		varchar(1);
ie_conversao_mat_w		varchar(1);
ie_doc_convenio_w		varchar(3);
ie_doc_retorno_w		varchar(15);
qt_conta_protocolo_w		integer;
qt_dia_fim_conta_w		smallint;
ie_exige_senha_atend_w		varchar(1);
ie_partic_cirurgia_w		smallint;
ie_exige_origem_w		varchar(1);/* Rafael em 01/03/2007 OS51372 */
cd_interno_w			varchar(15);
cd_regional_w			varchar(15);

ie_exige_data_ult_pagto_ww	varchar(1);
ie_exige_guia_ww		varchar(1);
ie_exige_orc_atend_ww		varchar(1);
ie_glosa_atendimento_ww		varchar(1);
ie_preco_medio_material_ww	varchar(1);
ie_agenda_consulta_ww		varchar(1);
ie_rep_cod_usuario_ww		varchar(1);
ie_exige_carteira_atend_ww	varchar(1);
ie_exige_validade_atend_ww	varchar(1);
ie_exige_plano_ww		varchar(1);
ie_separa_conta_ww		varchar(1);
ie_guia_unica_conta_ww		varchar(1);
ie_valor_contabil_ww		varchar(1);
ie_titulo_receber_ww		varchar(1);
ie_conversao_mat_ww		varchar(1);
ie_doc_convenio_ww		varchar(3);
ie_doc_retorno_ww		varchar(15);
qt_conta_protocolo_ww		integer;
qt_dia_fim_conta_ww		smallint;
ie_exige_senha_atend_ww		varchar(1);
ie_partic_cirurgia_ww		smallint;
ie_exige_origem_ww		varchar(1);/* Rafael em 01/03/2007 OS51372 */
cd_interno_ww			varchar(15);
cd_regional_ww			varchar(15);

 
C01 CURSOR FOR 
	SELECT	cd_convenio 
	from	convenio;
	
C02 CURSOR FOR 
	SELECT	coalesce(nr_sequencia,0), 
		coalesce(ie_exige_data_ult_pagto,''), 
		coalesce(ie_exige_guia,''), 
		coalesce(ie_exige_orc_atend,''), 
		coalesce(ie_glosa_atendimento,''), 
		coalesce(ie_preco_medio_material,''), 
		coalesce(ie_agenda_consulta,''), 
		coalesce(ie_rep_cod_usuario,''), 
		coalesce(ie_exige_carteira_atend,''), 
		coalesce(ie_exige_validade_atend,''), 
		coalesce(ie_exige_plano,''), 
		coalesce(ie_separa_conta,''), 
		coalesce(ie_guia_unica_conta,''), 
		coalesce(ie_valor_contabil,''), 
		coalesce(ie_titulo_receber,''), 
		coalesce(ie_conversao_mat,''), 
		coalesce(ie_doc_convenio,''), 
		coalesce(ie_doc_retorno,''), 
		coalesce(qt_conta_protocolo,''), 
		coalesce(qt_dia_fim_conta,''), 
		coalesce(ie_exige_senha_atend,''), 
		coalesce(ie_partic_cirurgia,''), 
		coalesce(ie_exige_origem,''), 
		coalesce(cd_interno,''), 
		coalesce(cd_regional,'') 
	from	convenio_estabelecimento 
	where	cd_convenio	= cd_convenio_w;

C03 CURSOR FOR 
	SELECT	cd_estabelecimento 
	from	estabelecimento;

 

BEGIN 
 
OPEN C01;
LOOP 
FETCH C01 into 
	cd_convenio_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
	begin 
	select	nm_usuario, 
		ie_exige_data_ult_pagto, 
		ie_exige_guia, 
		ie_exige_orc_atend, 
		ie_glosa_atendimento, 
		ie_preco_medio_material, 
		ie_agenda_consulta, 
		ie_rep_cod_usuario, 
		ie_exige_carteira_atend, 
		ie_exige_validade_atend, 
		ie_exige_plano, 
		ie_separa_conta, 
		ie_guia_unica_conta, 
		ie_valor_contabil, 
		ie_titulo_receber, 
		ie_conversao_mat, 
		ie_doc_convenio, 
		ie_doc_retorno, 
		qt_conta_protocolo, 
		qt_dia_fim_conta, 
		ie_exige_senha_atend, 
		ie_partic_cirurgia, 
		ie_exige_origem, 
		cd_interno, 
		cd_regional 
	into STRICT	nm_usuario_w, 
		ie_exige_data_ult_pagto_w, 
		ie_exige_guia_w, 
		ie_exige_orc_atend_w, 
		ie_glosa_atendimento_w, 
		ie_preco_medio_material_w, 
		ie_agenda_consulta_w, 
		ie_rep_cod_usuario_w, 
		ie_exige_carteira_atend_w, 
		ie_exige_validade_atend_w, 
		ie_exige_plano_w, 
		ie_separa_conta_w, 
		ie_guia_unica_conta_w, 
		ie_valor_contabil_w, 
		ie_titulo_receber_w, 
		ie_conversao_mat_w, 
		ie_doc_convenio_w, 
		ie_doc_retorno_w, 
		qt_conta_protocolo_w, 
		qt_dia_fim_conta_w, 
		ie_exige_senha_atend_w, 
		ie_partic_cirurgia_w, 
		ie_exige_origem_w, 
		cd_interno_w, 
		cd_regional_w 
	from	convenio 
	where	cd_convenio	= cd_convenio_w;
 
	/* 
	OPEN C03; 
	LOOP 
	FETCH C03 into 
		cd_estabelecimento_w; 
	exit when c03%notfound; 
		begin 
		select	count(*) 
		into	qt_registros_w 
		from	convenio_estabelecimento 
		where	cd_convenio		= cd_convenio_w 
		and	cd_estabelecimento	= cd_estabelecimento_w; 
 
		if	(qt_registros_w		= 0) then 
			select	convenio_estabelecimento_seq.nextval 
			into	nr_seq_convenio_estab_w 
			from	dual; 
 
			insert	into convenio_estabelecimento 
				(nr_sequencia, 
				dt_atualizacao, 
				nm_usuario, 
				cd_convenio, 
				cd_estabelecimento, 
				ie_exige_data_ult_pagto, 
				ie_exige_guia, 
				ie_exige_orc_atend, 
				ie_glosa_atendimento, 
				ie_preco_medio_material, 
				ie_agenda_consulta, 
				ie_rep_cod_usuario, 
				ie_exige_carteira_atend, 
				ie_exige_validade_atend, 
				ie_exige_plano, 
				ie_separa_conta, 
				ie_guia_unica_conta, 
				ie_valor_contabil, 
				ie_titulo_receber, 
				ie_conversao_mat, 
				ie_doc_convenio, 
				ie_doc_retorno, 
				qt_conta_protocolo, 
				qt_dia_fim_conta, 
				ie_exige_senha_atend, 
				ie_partic_cirurgia, 
				ie_exige_origem, 
				cd_interno, 
				cd_regional) 
			values	(nr_seq_convenio_estab_w, 
				sysdate, 
				nm_usuario_w, 
				cd_convenio_w, 
				cd_estabelecimento_w, 
				ie_exige_data_ult_pagto_w, 
				ie_exige_guia_w, 
				ie_exige_orc_atend_w, 
				ie_glosa_atendimento_w, 
				ie_preco_medio_material_w, 
				ie_agenda_consulta_w, 
				ie_rep_cod_usuario_w, 
				ie_exige_carteira_atend_w, 
				ie_exige_validade_atend_w, 
				ie_exige_plano_w, 
				ie_separa_conta_w, 
				ie_guia_unica_conta_w, 
				ie_valor_contabil_w, 
				ie_titulo_receber_w, 
				ie_conversao_mat_w, 
				ie_doc_convenio_w, 
				ie_doc_retorno_w, 
				qt_conta_protocolo_w, 
				qt_dia_fim_conta_w, 
				ie_exige_senha_atend_w, 
				ie_partic_cirurgia_w, 
				ie_exige_origem_w, 
				cd_interno_w, 
				cd_regional_w); 
		end if; 
		end; 
	END LOOP; 
	CLOSE C03; 
	*/
 
		 
 
	OPEN C02;
	LOOP 
	FETCH C02 into 
		nr_sequencia_w, 
		ie_exige_data_ult_pagto_ww, 
		ie_exige_guia_ww, 
		ie_exige_orc_atend_ww, 
		ie_glosa_atendimento_ww, 
		ie_preco_medio_material_ww, 
		ie_agenda_consulta_ww, 
		ie_rep_cod_usuario_ww, 
		ie_exige_carteira_atend_ww, 
		ie_exige_validade_atend_ww, 
		ie_exige_plano_ww, 
		ie_separa_conta_ww, 
		ie_guia_unica_conta_ww, 
		ie_valor_contabil_ww, 
		ie_titulo_receber_ww, 
		ie_conversao_mat_ww, 
		ie_doc_convenio_ww, 
		ie_doc_retorno_ww, 
		qt_conta_protocolo_ww, 
		qt_dia_fim_conta_ww, 
		ie_exige_senha_atend_ww, 
		ie_partic_cirurgia_ww, 
		ie_exige_origem_ww, 
		cd_interno_ww, 
		cd_regional_ww;
	EXIT WHEN NOT FOUND; /* apply on c02 */
		begin 
		if (coalesce(ie_exige_data_ult_pagto_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_exige_data_ult_pagto	= ie_exige_data_ult_pagto_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_exige_guia_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_exige_guia	= ie_exige_guia_w 
			where	nr_sequencia	= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_exige_orc_atend_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_exige_orc_atend	= ie_exige_orc_atend_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_glosa_atendimento_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_glosa_atendimento	= ie_glosa_atendimento_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_preco_medio_material_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_preco_medio_material	= ie_preco_medio_material_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_agenda_consulta_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_agenda_consulta	= ie_agenda_consulta_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_rep_cod_usuario_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_rep_cod_usuario	= ie_rep_cod_usuario_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_exige_carteira_atend_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_exige_carteira_atend	= ie_exige_carteira_atend_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_exige_validade_atend_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_exige_validade_atend	= ie_exige_validade_atend_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_exige_plano_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_exige_plano	= ie_exige_plano_w 
			where	nr_sequencia	= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_separa_conta_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_separa_conta	= ie_separa_conta_w 
			where	nr_sequencia	= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_guia_unica_conta_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_guia_unica_conta	= ie_guia_unica_conta_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_valor_contabil_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_valor_contabil	= ie_valor_contabil_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_titulo_receber_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_titulo_receber	= ie_titulo_receber_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_conversao_mat_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_conversao_mat	= ie_conversao_mat_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_doc_convenio_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_doc_convenio	= ie_doc_convenio_w 
			where	nr_sequencia	= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_doc_retorno_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_doc_retorno	= ie_doc_retorno_w 
			where	nr_sequencia	= nr_sequencia_w;
		end if;
 
		if (coalesce(qt_conta_protocolo_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	qt_conta_protocolo	= qt_conta_protocolo_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(qt_dia_fim_conta_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	qt_dia_fim_conta	= qt_dia_fim_conta_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_exige_senha_atend_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_exige_senha_atend	= ie_exige_senha_atend_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_partic_cirurgia_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_partic_cirurgia	= ie_partic_cirurgia_w 
			where	nr_sequencia		= nr_sequencia_w;
		end if;
 
		if (coalesce(ie_exige_origem_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	ie_exige_origem	= ie_exige_origem_w 
			where	nr_sequencia	= nr_sequencia_w;
		end if;
 
		if (coalesce(cd_interno_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	cd_interno	= cd_interno_w 
			where	nr_sequencia	= nr_sequencia_w;
		end if;
 
		if (coalesce(cd_regional_ww::text, '') = '') then 
			update	convenio_estabelecimento 
			set	cd_regional	= cd_regional_w 
			where	nr_sequencia	= nr_sequencia_w;
		end if;
		end;
	END LOOP;
	CLOSE C02;
	end;
END LOOP;
CLOSE C01;
 
commit;
 
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE baca_ajustar_convenio_estab () FROM PUBLIC;

