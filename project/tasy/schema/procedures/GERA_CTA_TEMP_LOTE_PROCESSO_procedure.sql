-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gera_cta_temp_lote_processo ( nr_seq_lote_p pls_cta_lote_processo.nr_sequencia%type) AS $body$
DECLARE


tb_seq_conta_w pls_util_cta_pck.t_number_table;

c_conta_lote CURSOR(nr_seq_lote_pc	pls_cta_lote_processo.nr_sequencia%type) FOR
	SELECT	x.nr_seq_conta
	from	pls_cta_lote_proc_conta x
	where	x.nr_seq_lote_processo = nr_seq_lote_pc;


BEGIN

EXECUTE 'truncate table pls_cta_lote_proc_cta_temp';

open c_conta_lote(nr_seq_lote_p);
loop
	fetch c_conta_lote
	bulk collect into tb_seq_conta_w
	limit pls_util_pck.qt_registro_transacao_w;

	exit when tb_seq_conta_w.count = 0;

	forall i in tb_seq_conta_w.first..tb_seq_conta_w.last
		insert into pls_cta_lote_proc_cta_temp(nr_seq_conta)
		values (tb_seq_conta_w(i));
	commit;

	tb_seq_conta_w.delete;
end loop;
close c_conta_lote;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gera_cta_temp_lote_processo ( nr_seq_lote_p pls_cta_lote_processo.nr_sequencia%type) FROM PUBLIC;

