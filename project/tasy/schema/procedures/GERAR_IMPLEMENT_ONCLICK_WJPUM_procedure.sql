-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_implement_onclick_wjpum ( nr_seq_wjpopupmenu_p bigint, nm_usuario_p text) AS $body$
DECLARE


nr_seq_wjmenuitem_w	bigint;
nm_wjmenuitem_w		varchar(50);
ds_implementacao_w	text;
ds_implementacao_ww	varchar(2000);
nm_metodo_w		varchar(255);
ds_metodos_w		text;
tab_w			varchar(4) := '    ';
ds_javadoc_w		varchar(2000);
ds_caption_w		varchar(80);
ds_javadoc_ww		varchar(2000);

c01 CURSOR FOR
SELECT	nr_sequencia,
	ajustar_mi_geracao_classe(nm_objeto),
	ds_texto
from	dic_objeto
where	nr_seq_obj_sup = nr_seq_wjpopupmenu_p
and	ie_tipo_objeto = 'MI'
and	coalesce(ie_objeto_nulo,'N') = 'N'
order by
	nr_seq_apres;


BEGIN
CALL exec_sql_dinamico(nm_usuario_p, 'truncate table w_implementacao_wjpum');
CALL exec_sql_dinamico(nm_usuario_p, 'truncate table w_metodos_implement_wjpum');
if (nr_seq_wjpopupmenu_p IS NOT NULL AND nr_seq_wjpopupmenu_p::text <> '') then
	begin
	ds_javadoc_w		:= '/**' || chr(10) || tab_w ||
				   '* @codigo NR_OBJETO ' || chr(10) || tab_w ||
				   '* @caption DS_CAPTION ' || chr(10) || tab_w ||
				   '* @author ' || nm_usuario_p || chr(10) || tab_w ||
				   '* @since '  || to_char(clock_timestamp(),'dd/mm/yy') || chr(10) || tab_w ||
				   '*/';
	ds_implementacao_w	:= tab_w || 'try {' || chr(10);
	ds_implementacao_w	:= ds_implementacao_w || tab_w || tab_w || tab_w || 'switch (getUltimoItemClicadoNrSeq()) {' || chr(10);
	open c01;
	loop
	fetch c01 into	nr_seq_wjmenuitem_w,
			nm_wjmenuitem_w,
			ds_caption_w;
	EXIT WHEN NOT FOUND; /* apply on c01 */
		begin
		nm_metodo_w		:= 'doClick' || nm_wjmenuitem_w || '()';
		ds_implementacao_ww 	:= tab_w || tab_w || tab_w || tab_w || 'case ' || nr_seq_wjmenuitem_w || ' : {' || chr(10);
		ds_implementacao_ww 	:= ds_implementacao_ww || tab_w || tab_w || tab_w || tab_w || tab_w || nm_metodo_w || ';' || chr(10);
		ds_implementacao_ww 	:= ds_implementacao_ww || tab_w || tab_w || tab_w || tab_w || tab_w || 'break;' || chr(10);
		ds_implementacao_ww 	:= ds_implementacao_ww || tab_w || tab_w || tab_w || tab_w || '}' || chr(10);
		ds_implementacao_w	:= ds_implementacao_w || ds_implementacao_ww;
		ds_javadoc_ww		:= ds_javadoc_w;
		ds_javadoc_ww		:= replace(ds_javadoc_ww,'NR_OBJETO',to_char(nr_seq_wjmenuitem_w));
		ds_javadoc_ww		:= replace(ds_javadoc_ww,'DS_CAPTION',ds_caption_w);
		if (ds_metodos_w IS NOT NULL AND ds_metodos_w::text <> '') then
			begin
			ds_metodos_w	:= ds_metodos_w || tab_w || ds_javadoc_ww || chr(10);
			ds_metodos_w	:= ds_metodos_w || tab_w || 'private void ' || nm_metodo_w || ' throws Exception {' || chr(10) || tab_w || tab_w || '//' || chr(10) || tab_w || '}' || chr(10) || chr(10);
			end;
		else
			begin
			ds_metodos_w	:= ds_metodos_w || ds_javadoc_ww || chr(10);
			ds_metodos_w	:= ds_metodos_w || tab_w || 'private void ' || nm_metodo_w || ' throws Exception {' || chr(10) || tab_w || tab_w || '//' || chr(10) || tab_w || '}' || chr(10) || chr(10);
			end;
		end if;
		end;
	end loop;
	close c01;
	ds_implementacao_w	:= ds_implementacao_w || tab_w || tab_w || tab_w || '}' || chr(10);
	ds_implementacao_w	:= ds_implementacao_w || tab_w || tab_w || '}';
	ds_implementacao_w	:= ds_implementacao_w || ' catch (Exception ex) {' || chr(10);
	ds_implementacao_w	:= ds_implementacao_w || tab_w || tab_w || tab_w || 'UGeneric.tratarErro(this, ex);' || chr(10);
	ds_implementacao_w	:= ds_implementacao_w || tab_w || tab_w || '}';

	insert into w_implementacao_wjpum(
		ds_implementacao)
	values (
		ds_implementacao_w);

	if (ds_metodos_w IS NOT NULL AND ds_metodos_w::text <> '') then
		begin
		insert into w_metodos_implement_wjpum(
			ds_metodos)
		values (
			ds_metodos_w);
		end;
	end if;
	end;
end if;
commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_implement_onclick_wjpum ( nr_seq_wjpopupmenu_p bigint, nm_usuario_p text) FROM PUBLIC;

