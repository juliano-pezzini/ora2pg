-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_cid_duplicado (ds_lista_cid_p text, ds_retorno_p INOUT text) AS $body$
DECLARE


--Caso exista um cid duplicado na lista passada como parametro a function retorna o cid que esta duplicado, caso contrario retorna 'N'
ds_result_w		varchar(1) := 'N';
ds_cid_w		varchar(255);
ds_lista_cid_aux_w	varchar(4000);
qt_pos_separador_w	bigint;


BEGIN

ds_lista_cid_aux_w 	:= ds_lista_cid_p;
qt_pos_separador_w 	:= position(',' in ds_lista_cid_aux_w);
ds_cid_w		:= substr(ds_lista_cid_aux_w,1,qt_pos_separador_w-1);
ds_lista_cid_aux_w	:= substr(ds_lista_cid_aux_w,qt_pos_separador_w+1,length(ds_lista_cid_aux_w));

ds_result_w 		:= obter_se_contido_char(ds_cid_w,ds_lista_cid_aux_w);

if (ds_result_w = 'S') then
	ds_retorno_p := ds_cid_w;
elsif (ds_result_w = 'N') then
	if (qt_pos_separador_w > 0) then
		ds_retorno_p := obter_cid_duplicado(ds_lista_cid_aux_w, ds_retorno_p);
	else
		ds_retorno_p := 'N';
	end if;
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_cid_duplicado (ds_lista_cid_p text, ds_retorno_p INOUT text) FROM PUBLIC;

