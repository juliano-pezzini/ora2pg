-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE handlebar_visualizar_imp_eup (nr_atendimento_p bigint, nr_seq_evento_p bigint, nr_prescricao_p bigint, ie_fim_conta_p INOUT text, ie_evento_p INOUT text, ds_msg_aviso_p INOUT text, cd_relatorio_p INOUT text, nm_usuario_p text) AS $body$
DECLARE

 
qt_auto_pendente_w	bigint;


BEGIN 
 
select 	max(ie_fim_conta) 
into STRICT	ie_fim_conta_p 
from 	atendimento_paciente 
where 	nr_atendimento = nr_atendimento_p;
 
ie_evento_p := obter_se_existe_evento(nr_seq_evento_p);
 
select 	cd_relatorio 
into STRICT	cd_relatorio_p 
from 	relatorio 
where 	cd_relatorio_wheb = 65723;
 
qt_auto_pendente_w := obter_qt_autorizacao_pend(nr_atendimento_p, nr_prescricao_p);
 
if (qt_auto_pendente_w > 0) then 
		ds_msg_aviso_p := wheb_mensagem_pck.get_texto(134080);
end if;
 
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE handlebar_visualizar_imp_eup (nr_atendimento_p bigint, nr_seq_evento_p bigint, nr_prescricao_p bigint, ie_fim_conta_p INOUT text, ie_evento_p INOUT text, ds_msg_aviso_p INOUT text, cd_relatorio_p INOUT text, nm_usuario_p text) FROM PUBLIC;

