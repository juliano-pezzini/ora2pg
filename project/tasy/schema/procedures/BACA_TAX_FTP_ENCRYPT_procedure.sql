-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE baca_tax_ftp_encrypt () AS $body$
DECLARE

  ds_retorno_w bigint;	
  update_sql_w varchar(500);

BEGIN
  CALL wheb_usuario_pck.set_ie_executar_trigger('N');

  ds_retorno_w := executar_sql_dinamico('alter table sis_conexao_ftp modify ds_senha varchar2(255)', ds_retorno_w);
  commit;

  update tabela_atributo 
  set qt_tamanho = 255 
  where nm_tabela = 'SIS_CONEXAO_FTP' and nm_atributo = 'DS_SENHA';
  commit;

  update_sql_w :=   ' update  sis_conexao_ftp'                                                                                  ||
                  q'[ set     ds_senha = decode(ds_senha, null, null, wheb_seguranca.encrypt(ds_senha, 'XxSisConexaoFtpxX')),]' ||
                  q'[         ie_atualizado_seg = 'S']'                                                                         ||
                  q'[ where   ie_atualizado_seg = 'N']';

  EXECUTE update_sql_w;
  commit;

  CALL wheb_usuario_pck.set_ie_executar_trigger('S');
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE baca_tax_ftp_encrypt () FROM PUBLIC;

