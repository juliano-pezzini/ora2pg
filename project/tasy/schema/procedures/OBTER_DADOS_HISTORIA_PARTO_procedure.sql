-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_dados_historia_parto (NR_ATENDIMENTO_P bigint, DS_INICIO_PARTO_P INOUT text, DS_FIM_PARTO_P INOUT text, IE_TIPO_PARTO_P INOUT text, QT_NASC_VIVOS_P INOUT bigint, QT_NASC_MORTOS_P INOUT bigint, QT_ABORTOS_PARTO_P INOUT bigint, DS_INDICACAO_CESAREA_P INOUT text) AS $body$
BEGIN

SELECT	max(PKG_DATE_FORMATERS.to_varchar(dt_inicio_parto, 'short', wheb_usuario_pck.get_cd_estabelecimento, wheb_usuario_pck.get_nm_usuario )) ds_inicio_parto_p,
	max(PKG_DATE_FORMATERS.to_varchar(dt_fim_parto, 'short', wheb_usuario_pck.get_cd_estabelecimento, wheb_usuario_pck.get_nm_usuario )) ds_fim_parto_p,
	max(obter_tipo_parto_suep(nr_atendimento_p)) ie_tipo_parto,
	max(qt_nasc_vivos),
	max(qt_nasc_mortos),
	max(qt_abortos_parto),
	max(substr(obter_descricao_padrao('INDICACAO_CESAREA','DS_INDICACAO', nr_seq_indic_cesarea),1,80)) ds_indicacao_cesarea
INTO STRICT	ds_inicio_parto_p,
	ds_fim_parto_p,
	ie_tipo_parto_p,
	qt_nasc_vivos_p,
	qt_nasc_mortos_p,
	qt_abortos_parto_p,
	ds_indicacao_cesarea_p
FROM	parto
WHERE	nr_atendimento = nr_atendimento_p;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_dados_historia_parto (NR_ATENDIMENTO_P bigint, DS_INICIO_PARTO_P INOUT text, DS_FIM_PARTO_P INOUT text, IE_TIPO_PARTO_P INOUT text, QT_NASC_VIVOS_P INOUT bigint, QT_NASC_MORTOS_P INOUT bigint, QT_ABORTOS_PARTO_P INOUT bigint, DS_INDICACAO_CESAREA_P INOUT text) FROM PUBLIC;

