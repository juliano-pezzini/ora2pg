-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE processa_complemento_pf_jst (IE_EVENTO_P text, CD_PESSOA_FISICA_P bigint, NR_SEQUENCIA_SUP_P bigint) AS $body$
DECLARE

  COMPL_PESSOA_FISICA_W COMPL_PESSOA_FISICA%ROWTYPE;
  IS_INSERT_W           boolean := FALSE;
  ALT_ATRIB_W           boolean := FALSE;
  C RECORD;

BEGIN
  IF (CD_PESSOA_FISICA_P IS NOT NULL AND CD_PESSOA_FISICA_P::text <> '' AND NR_SEQUENCIA_SUP_P IS NOT NULL AND NR_SEQUENCIA_SUP_P::text <> '') THEN
      FOR C IN (SELECT * FROM COMPL_PESSOA_FISICA_JST_V CPFT
                 WHERE CPFT.IE_EVENTO_T = IE_EVENTO_P
                 AND CPFT.NR_SEQUENCIA_SUP_T = NR_SEQUENCIA_SUP_P) LOOP
          COMPL_PESSOA_FISICA_W := NULL;
          ALT_ATRIB_W           := FALSE;

          BEGIN
            SELECT CPF.*
              INTO STRICT COMPL_PESSOA_FISICA_W
              FROM COMPL_PESSOA_FISICA CPF
             WHERE CPF.CD_PESSOA_FISICA = CD_PESSOA_FISICA_P
               AND CPF.IE_TIPO_COMPLEMENTO = C.IE_TIPO_COMPLEMENTO
               AND coalesce(CPF.NR_SEQ_TIPO_COMPL_ADIC, 0) = coalesce(C.NR_SEQ_TIPO_COMPL_ADIC, 0);
           EXCEPTION
             WHEN no_data_found THEN
                  IS_INSERT_W := TRUE;
           END;

          COMPL_PESSOA_FISICA_W.CD_PESSOA_FISICA := CD_PESSOA_FISICA_P;

          IF ((C.NR_SEQUENCIA IS NOT NULL AND C.NR_SEQUENCIA::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_SEQUENCIA::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_SEQUENCIA <> C.NR_SEQUENCIA)) THEN
             COMPL_PESSOA_FISICA_W.NR_SEQUENCIA := C.NR_SEQUENCIA;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.IE_TIPO_COMPLEMENTO IS NOT NULL AND C.IE_TIPO_COMPLEMENTO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.IE_TIPO_COMPLEMENTO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.IE_TIPO_COMPLEMENTO <> C.IE_TIPO_COMPLEMENTO)) THEN
             COMPL_PESSOA_FISICA_W.IE_TIPO_COMPLEMENTO := C.IE_TIPO_COMPLEMENTO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NM_CONTATO IS NOT NULL AND C.NM_CONTATO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NM_CONTATO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NM_CONTATO <> C.NM_CONTATO)) THEN
             COMPL_PESSOA_FISICA_W.NM_CONTATO := C.NM_CONTATO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.DS_ENDERECO IS NOT NULL AND C.DS_ENDERECO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.DS_ENDERECO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.DS_ENDERECO <> C.DS_ENDERECO)) THEN
             COMPL_PESSOA_FISICA_W.DS_ENDERECO := C.DS_ENDERECO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.CD_CEP IS NOT NULL AND C.CD_CEP::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.CD_CEP::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.CD_CEP <> C.CD_CEP)) THEN
             COMPL_PESSOA_FISICA_W.CD_CEP := C.CD_CEP;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_ENDERECO IS NOT NULL AND C.NR_ENDERECO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_ENDERECO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_ENDERECO <> C.NR_ENDERECO)) THEN
             COMPL_PESSOA_FISICA_W.NR_ENDERECO := C.NR_ENDERECO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.DS_COMPLEMENTO IS NOT NULL AND C.DS_COMPLEMENTO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.DS_COMPLEMENTO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.DS_COMPLEMENTO <> C.DS_COMPLEMENTO)) THEN
             COMPL_PESSOA_FISICA_W.DS_COMPLEMENTO := C.DS_COMPLEMENTO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_SEQ_ASSENTAMENTO_MX IS NOT NULL AND C.NR_SEQ_ASSENTAMENTO_MX::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_SEQ_ASSENTAMENTO_MX::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_SEQ_ASSENTAMENTO_MX <> C.NR_SEQ_ASSENTAMENTO_MX)) THEN
             COMPL_PESSOA_FISICA_W.NR_SEQ_ASSENTAMENTO_MX := C.NR_SEQ_ASSENTAMENTO_MX;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.DS_BAIRRO IS NOT NULL AND C.DS_BAIRRO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.DS_BAIRRO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.DS_BAIRRO <> C.DS_BAIRRO)) THEN
             COMPL_PESSOA_FISICA_W.DS_BAIRRO := C.DS_BAIRRO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.DS_MUNICIPIO IS NOT NULL AND C.DS_MUNICIPIO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.DS_MUNICIPIO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.DS_MUNICIPIO <> C.DS_MUNICIPIO)) THEN
             COMPL_PESSOA_FISICA_W.DS_MUNICIPIO := C.DS_MUNICIPIO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.SG_ESTADO IS NOT NULL AND C.SG_ESTADO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.SG_ESTADO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.SG_ESTADO <> C.SG_ESTADO)) THEN
             COMPL_PESSOA_FISICA_W.SG_ESTADO := C.SG_ESTADO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_TELEFONE IS NOT NULL AND C.NR_TELEFONE::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_TELEFONE::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_TELEFONE <> C.NR_TELEFONE)) THEN
             COMPL_PESSOA_FISICA_W.NR_TELEFONE := C.NR_TELEFONE;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_RAMAL IS NOT NULL AND C.NR_RAMAL::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_RAMAL::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_RAMAL <> C.NR_RAMAL)) THEN
             COMPL_PESSOA_FISICA_W.NR_RAMAL := C.NR_RAMAL;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.DS_OBSERVACAO IS NOT NULL AND C.DS_OBSERVACAO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.DS_OBSERVACAO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.DS_OBSERVACAO <> C.DS_OBSERVACAO)) THEN
             COMPL_PESSOA_FISICA_W.DS_OBSERVACAO := C.DS_OBSERVACAO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.DS_EMAIL IS NOT NULL AND C.DS_EMAIL::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.DS_EMAIL::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.DS_EMAIL <> C.DS_EMAIL)) THEN
             COMPL_PESSOA_FISICA_W.DS_EMAIL := C.DS_EMAIL;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.CD_EMPRESA_REFER IS NOT NULL AND C.CD_EMPRESA_REFER::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.CD_EMPRESA_REFER::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.CD_EMPRESA_REFER <> C.CD_EMPRESA_REFER)) THEN
             COMPL_PESSOA_FISICA_W.CD_EMPRESA_REFER := C.CD_EMPRESA_REFER;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.CD_PROFISSAO IS NOT NULL AND C.CD_PROFISSAO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.CD_PROFISSAO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.CD_PROFISSAO <> C.CD_PROFISSAO)) THEN
             COMPL_PESSOA_FISICA_W.CD_PROFISSAO := C.CD_PROFISSAO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_IDENTIDADE IS NOT NULL AND C.NR_IDENTIDADE::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_IDENTIDADE::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_IDENTIDADE <> C.NR_IDENTIDADE)) THEN
             COMPL_PESSOA_FISICA_W.NR_IDENTIDADE := C.NR_IDENTIDADE;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.IE_TIPO_SANGUE IS NOT NULL AND C.IE_TIPO_SANGUE::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.IE_TIPO_SANGUE::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.IE_TIPO_SANGUE <> C.IE_TIPO_SANGUE)) THEN
             COMPL_PESSOA_FISICA_W.IE_TIPO_SANGUE := C.IE_TIPO_SANGUE;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.IE_FATOR_RH IS NOT NULL AND C.IE_FATOR_RH::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.IE_FATOR_RH::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.IE_FATOR_RH <> C.IE_FATOR_RH)) THEN
             COMPL_PESSOA_FISICA_W.IE_FATOR_RH := C.IE_FATOR_RH;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_CPF IS NOT NULL AND C.NR_CPF::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_CPF::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_CPF <> C.NR_CPF)) THEN
             COMPL_PESSOA_FISICA_W.NR_CPF := C.NR_CPF;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.CD_MUNICIPIO_IBGE IS NOT NULL AND C.CD_MUNICIPIO_IBGE::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.CD_MUNICIPIO_IBGE::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.CD_MUNICIPIO_IBGE <> C.CD_MUNICIPIO_IBGE)) THEN
             COMPL_PESSOA_FISICA_W.CD_MUNICIPIO_IBGE := C.CD_MUNICIPIO_IBGE;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.DS_SETOR_TRABALHO IS NOT NULL AND C.DS_SETOR_TRABALHO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.DS_SETOR_TRABALHO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.DS_SETOR_TRABALHO <> C.DS_SETOR_TRABALHO)) THEN
             COMPL_PESSOA_FISICA_W.DS_SETOR_TRABALHO := C.DS_SETOR_TRABALHO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.DS_HORARIO_TRABALHO IS NOT NULL AND C.DS_HORARIO_TRABALHO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.DS_HORARIO_TRABALHO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.DS_HORARIO_TRABALHO <> C.DS_HORARIO_TRABALHO)) THEN
             COMPL_PESSOA_FISICA_W.DS_HORARIO_TRABALHO := C.DS_HORARIO_TRABALHO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_MATRICULA_TRABALHO IS NOT NULL AND C.NR_MATRICULA_TRABALHO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_MATRICULA_TRABALHO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_MATRICULA_TRABALHO <> C.NR_MATRICULA_TRABALHO)) THEN
             COMPL_PESSOA_FISICA_W.NR_MATRICULA_TRABALHO := C.NR_MATRICULA_TRABALHO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.DS_WEBSITE IS NOT NULL AND C.DS_WEBSITE::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.DS_WEBSITE::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.DS_WEBSITE <> C.DS_WEBSITE)) THEN
             COMPL_PESSOA_FISICA_W.DS_WEBSITE := C.DS_WEBSITE;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.DS_FONE_ADIC IS NOT NULL AND C.DS_FONE_ADIC::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.DS_FONE_ADIC::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.DS_FONE_ADIC <> C.DS_FONE_ADIC)) THEN
             COMPL_PESSOA_FISICA_W.DS_FONE_ADIC := C.DS_FONE_ADIC;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.DS_FAX IS NOT NULL AND C.DS_FAX::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.DS_FAX::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.DS_FAX <> C.DS_FAX)) THEN
             COMPL_PESSOA_FISICA_W.DS_FAX := C.DS_FAX;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_SEQ_PARENTESCO IS NOT NULL AND C.NR_SEQ_PARENTESCO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_SEQ_PARENTESCO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_SEQ_PARENTESCO <> C.NR_SEQ_PARENTESCO)) THEN
             COMPL_PESSOA_FISICA_W.NR_SEQ_PARENTESCO := C.NR_SEQ_PARENTESCO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.CD_PESSOA_FISICA_REF IS NOT NULL AND C.CD_PESSOA_FISICA_REF::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.CD_PESSOA_FISICA_REF::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.CD_PESSOA_FISICA_REF <> C.CD_PESSOA_FISICA_REF)) THEN
             COMPL_PESSOA_FISICA_W.CD_PESSOA_FISICA_REF := C.CD_PESSOA_FISICA_REF;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_SEQ_PAIS IS NOT NULL AND C.NR_SEQ_PAIS::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_SEQ_PAIS::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_SEQ_PAIS <> C.NR_SEQ_PAIS)) THEN
             COMPL_PESSOA_FISICA_W.NR_SEQ_PAIS := C.NR_SEQ_PAIS;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.CD_TIPO_LOGRADOURO IS NOT NULL AND C.CD_TIPO_LOGRADOURO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.CD_TIPO_LOGRADOURO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.CD_TIPO_LOGRADOURO <> C.CD_TIPO_LOGRADOURO)) THEN
             COMPL_PESSOA_FISICA_W.CD_TIPO_LOGRADOURO := C.CD_TIPO_LOGRADOURO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_DDD_TELEFONE IS NOT NULL AND C.NR_DDD_TELEFONE::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_DDD_TELEFONE::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_DDD_TELEFONE <> C.NR_DDD_TELEFONE)) THEN
             COMPL_PESSOA_FISICA_W.NR_DDD_TELEFONE := C.NR_DDD_TELEFONE;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_DDI_TELEFONE IS NOT NULL AND C.NR_DDI_TELEFONE::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_DDI_TELEFONE::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_DDI_TELEFONE <> C.NR_DDI_TELEFONE)) THEN
             COMPL_PESSOA_FISICA_W.NR_DDI_TELEFONE := C.NR_DDI_TELEFONE;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_DDI_FAX IS NOT NULL AND C.NR_DDI_FAX::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_DDI_FAX::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_DDI_FAX <> C.NR_DDI_FAX)) THEN
             COMPL_PESSOA_FISICA_W.NR_DDI_FAX := C.NR_DDI_FAX;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_DDD_FAX IS NOT NULL AND C.NR_DDD_FAX::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_DDD_FAX::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_DDD_FAX <> C.NR_DDD_FAX)) THEN
             COMPL_PESSOA_FISICA_W.NR_DDD_FAX := C.NR_DDD_FAX;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_SEQ_IDENT_CNES IS NOT NULL AND C.NR_SEQ_IDENT_CNES::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_SEQ_IDENT_CNES::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_SEQ_IDENT_CNES <> C.NR_SEQ_IDENT_CNES)) THEN
             COMPL_PESSOA_FISICA_W.NR_SEQ_IDENT_CNES := C.NR_SEQ_IDENT_CNES;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NM_CONTATO_PESQUISA IS NOT NULL AND C.NM_CONTATO_PESQUISA::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NM_CONTATO_PESQUISA::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NM_CONTATO_PESQUISA <> C.NM_CONTATO_PESQUISA)) THEN
             COMPL_PESSOA_FISICA_W.NM_CONTATO_PESQUISA := C.NM_CONTATO_PESQUISA;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.QT_DEPENDENTE IS NOT NULL AND C.QT_DEPENDENTE::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.QT_DEPENDENTE::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.QT_DEPENDENTE <> C.QT_DEPENDENTE)) THEN
             COMPL_PESSOA_FISICA_W.QT_DEPENDENTE := C.QT_DEPENDENTE;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.IE_EMPRESA_PAGADORA IS NOT NULL AND C.IE_EMPRESA_PAGADORA::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.IE_EMPRESA_PAGADORA::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.IE_EMPRESA_PAGADORA <> C.IE_EMPRESA_PAGADORA)) THEN
             COMPL_PESSOA_FISICA_W.IE_EMPRESA_PAGADORA := C.IE_EMPRESA_PAGADORA;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.IE_CORRESPONDENCIA IS NOT NULL AND C.IE_CORRESPONDENCIA::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.IE_CORRESPONDENCIA::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.IE_CORRESPONDENCIA <> C.IE_CORRESPONDENCIA)) THEN
             COMPL_PESSOA_FISICA_W.IE_CORRESPONDENCIA := C.IE_CORRESPONDENCIA;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.DS_FONETICA IS NOT NULL AND C.DS_FONETICA::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.DS_FONETICA::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.DS_FONETICA <> C.DS_FONETICA)) THEN
             COMPL_PESSOA_FISICA_W.DS_FONETICA := C.DS_FONETICA;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.IE_NF_CORREIO IS NOT NULL AND C.IE_NF_CORREIO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.IE_NF_CORREIO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.IE_NF_CORREIO <> C.IE_NF_CORREIO)) THEN
             COMPL_PESSOA_FISICA_W.IE_NF_CORREIO := C.IE_NF_CORREIO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.CD_ZONA_PROCEDENCIA IS NOT NULL AND C.CD_ZONA_PROCEDENCIA::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.CD_ZONA_PROCEDENCIA::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.CD_ZONA_PROCEDENCIA <> C.CD_ZONA_PROCEDENCIA)) THEN
             COMPL_PESSOA_FISICA_W.CD_ZONA_PROCEDENCIA := C.CD_ZONA_PROCEDENCIA;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_SEQ_LOCAL_ATEND_MED IS NOT NULL AND C.NR_SEQ_LOCAL_ATEND_MED::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_SEQ_LOCAL_ATEND_MED::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_SEQ_LOCAL_ATEND_MED <> C.NR_SEQ_LOCAL_ATEND_MED)) THEN
             COMPL_PESSOA_FISICA_W.NR_SEQ_LOCAL_ATEND_MED := C.NR_SEQ_LOCAL_ATEND_MED;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.CD_PESSOA_END_REF IS NOT NULL AND C.CD_PESSOA_END_REF::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.CD_PESSOA_END_REF::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.CD_PESSOA_END_REF <> C.CD_PESSOA_END_REF)) THEN
             COMPL_PESSOA_FISICA_W.CD_PESSOA_END_REF := C.CD_PESSOA_END_REF;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_SEQ_END_REF IS NOT NULL AND C.NR_SEQ_END_REF::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_SEQ_END_REF::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_SEQ_END_REF <> C.NR_SEQ_END_REF)) THEN
             COMPL_PESSOA_FISICA_W.NR_SEQ_END_REF := C.NR_SEQ_END_REF;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.IE_OBRIGA_EMAIL IS NOT NULL AND C.IE_OBRIGA_EMAIL::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.IE_OBRIGA_EMAIL::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.IE_OBRIGA_EMAIL <> C.IE_OBRIGA_EMAIL)) THEN
             COMPL_PESSOA_FISICA_W.IE_OBRIGA_EMAIL := C.IE_OBRIGA_EMAIL;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.IE_MALA_DIRETA IS NOT NULL AND C.IE_MALA_DIRETA::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.IE_MALA_DIRETA::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.IE_MALA_DIRETA <> C.IE_MALA_DIRETA)) THEN
             COMPL_PESSOA_FISICA_W.IE_MALA_DIRETA := C.IE_MALA_DIRETA;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_SEQ_REGIAO IS NOT NULL AND C.NR_SEQ_REGIAO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_SEQ_REGIAO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_SEQ_REGIAO <> C.NR_SEQ_REGIAO)) THEN
             COMPL_PESSOA_FISICA_W.NR_SEQ_REGIAO := C.NR_SEQ_REGIAO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_DDI_FONE_ADIC IS NOT NULL AND C.NR_DDI_FONE_ADIC::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_DDI_FONE_ADIC::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_DDI_FONE_ADIC <> C.NR_DDI_FONE_ADIC)) THEN
             COMPL_PESSOA_FISICA_W.NR_DDI_FONE_ADIC := C.NR_DDI_FONE_ADIC;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_DDD_FONE_ADIC IS NOT NULL AND C.NR_DDD_FONE_ADIC::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_DDD_FONE_ADIC::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_DDD_FONE_ADIC <> C.NR_DDD_FONE_ADIC)) THEN
             COMPL_PESSOA_FISICA_W.NR_DDD_FONE_ADIC := C.NR_DDD_FONE_ADIC;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_SEQ_TIPO_COMPL_ADIC IS NOT NULL AND C.NR_SEQ_TIPO_COMPL_ADIC::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_SEQ_TIPO_COMPL_ADIC::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_SEQ_TIPO_COMPL_ADIC <> C.NR_SEQ_TIPO_COMPL_ADIC)) THEN
             COMPL_PESSOA_FISICA_W.NR_SEQ_TIPO_COMPL_ADIC := C.NR_SEQ_TIPO_COMPL_ADIC;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_TELEFONE_CELULAR IS NOT NULL AND C.NR_TELEFONE_CELULAR::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_TELEFONE_CELULAR::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_TELEFONE_CELULAR <> C.NR_TELEFONE_CELULAR)) THEN
             COMPL_PESSOA_FISICA_W.NR_TELEFONE_CELULAR := C.NR_TELEFONE_CELULAR;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_DDD_CELULAR IS NOT NULL AND C.NR_DDD_CELULAR::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_DDD_CELULAR::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_DDD_CELULAR <> C.NR_DDD_CELULAR)) THEN
             COMPL_PESSOA_FISICA_W.NR_DDD_CELULAR := C.NR_DDD_CELULAR;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_DDI_CELULAR IS NOT NULL AND C.NR_DDI_CELULAR::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_DDI_CELULAR::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_DDI_CELULAR <> C.NR_DDI_CELULAR)) THEN
             COMPL_PESSOA_FISICA_W.NR_DDI_CELULAR := C.NR_DDI_CELULAR;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.IE_NAO_POSSUI_EMAIL IS NOT NULL AND C.IE_NAO_POSSUI_EMAIL::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.IE_NAO_POSSUI_EMAIL::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.IE_NAO_POSSUI_EMAIL <> C.IE_NAO_POSSUI_EMAIL)) THEN
             COMPL_PESSOA_FISICA_W.IE_NAO_POSSUI_EMAIL := C.IE_NAO_POSSUI_EMAIL;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.IE_CUSTODIANTE IS NOT NULL AND C.IE_CUSTODIANTE::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.IE_CUSTODIANTE::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.IE_CUSTODIANTE <> C.IE_CUSTODIANTE)) THEN
             COMPL_PESSOA_FISICA_W.IE_CUSTODIANTE := C.IE_CUSTODIANTE;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_SEQ_TIPO_CUSTODIA IS NOT NULL AND C.NR_SEQ_TIPO_CUSTODIA::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_SEQ_TIPO_CUSTODIA::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_SEQ_TIPO_CUSTODIA <> C.NR_SEQ_TIPO_CUSTODIA)) THEN
             COMPL_PESSOA_FISICA_W.NR_SEQ_TIPO_CUSTODIA := C.NR_SEQ_TIPO_CUSTODIA;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.DS_COMPL_END IS NOT NULL AND C.DS_COMPL_END::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.DS_COMPL_END::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.DS_COMPL_END <> C.DS_COMPL_END)) THEN
             COMPL_PESSOA_FISICA_W.DS_COMPL_END := C.DS_COMPL_END;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.IE_REGIME_CASAMENTO IS NOT NULL AND C.IE_REGIME_CASAMENTO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.IE_REGIME_CASAMENTO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.IE_REGIME_CASAMENTO <> C.IE_REGIME_CASAMENTO)) THEN
             COMPL_PESSOA_FISICA_W.IE_REGIME_CASAMENTO := C.IE_REGIME_CASAMENTO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.IE_RESP_LEGAL IS NOT NULL AND C.IE_RESP_LEGAL::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.IE_RESP_LEGAL::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.IE_RESP_LEGAL <> C.IE_RESP_LEGAL)) THEN
             COMPL_PESSOA_FISICA_W.IE_RESP_LEGAL := C.IE_RESP_LEGAL;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_SEQ_PESSOA_ENDERECO IS NOT NULL AND C.NR_SEQ_PESSOA_ENDERECO::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_SEQ_PESSOA_ENDERECO::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_SEQ_PESSOA_ENDERECO <> C.NR_SEQ_PESSOA_ENDERECO)) THEN
             COMPL_PESSOA_FISICA_W.NR_SEQ_PESSOA_ENDERECO := C.NR_SEQ_PESSOA_ENDERECO;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.IE_CONTATO_PRINCIPAL IS NOT NULL AND C.IE_CONTATO_PRINCIPAL::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.IE_CONTATO_PRINCIPAL::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.IE_CONTATO_PRINCIPAL <> C.IE_CONTATO_PRINCIPAL)) THEN
             COMPL_PESSOA_FISICA_W.IE_CONTATO_PRINCIPAL := C.IE_CONTATO_PRINCIPAL;
             ALT_ATRIB_W := TRUE;
          END IF;

          IF ((C.NR_SEQ_LOCALIZACAO_MX IS NOT NULL AND C.NR_SEQ_LOCALIZACAO_MX::text <> '')
          AND (coalesce(COMPL_PESSOA_FISICA_W.NR_SEQ_LOCALIZACAO_MX::text, '') = ''
          OR COMPL_PESSOA_FISICA_W.NR_SEQ_LOCALIZACAO_MX <> C.NR_SEQ_LOCALIZACAO_MX)) THEN
             COMPL_PESSOA_FISICA_W.NR_SEQ_LOCALIZACAO_MX := C.NR_SEQ_LOCALIZACAO_MX;
             ALT_ATRIB_W := TRUE;
          END IF;

          COMPL_PESSOA_FISICA_W.NM_USUARIO     := WHEB_USUARIO_PCK.GET_NM_USUARIO;
          COMPL_PESSOA_FISICA_W.DT_ATUALIZACAO := clock_timestamp();

          IF (coalesce(trim(both COMPL_PESSOA_FISICA_W.NM_USUARIO_NREC)::text, '') = '') THEN
            COMPL_PESSOA_FISICA_W.NM_USUARIO_NREC := COMPL_PESSOA_FISICA_W.NM_USUARIO;
          END IF;

          IF (coalesce(COMPL_PESSOA_FISICA_W.DT_ATUALIZACAO_NREC::text, '') = '') THEN
             COMPL_PESSOA_FISICA_W.DT_ATUALIZACAO_NREC := COMPL_PESSOA_FISICA_W.DT_ATUALIZACAO;
          END IF;

          IF (ALT_ATRIB_W) THEN
            IF (IS_INSERT_W) THEN
               SELECT coalesce(MAX(CPF.NR_SEQUENCIA), 0) + 1
                 INTO STRICT COMPL_PESSOA_FISICA_W.NR_SEQUENCIA
                 FROM COMPL_PESSOA_FISICA CPF
                WHERE CPF.CD_PESSOA_FISICA = COMPL_PESSOA_FISICA_W.CD_PESSOA_FISICA;

               INSERT INTO COMPL_PESSOA_FISICA
               VALUES (COMPL_PESSOA_FISICA_W.*);
            ELSE
               UPDATE COMPL_PESSOA_FISICA CPF
                  SET ROW = COMPL_PESSOA_FISICA_W
                WHERE CPF.CD_PESSOA_FISICA = COMPL_PESSOA_FISICA_W.CD_PESSOA_FISICA
                  AND CPF.IE_TIPO_COMPLEMENTO = COMPL_PESSOA_FISICA_W.IE_TIPO_COMPLEMENTO
                  AND coalesce(CPF.NR_SEQ_TIPO_COMPL_ADIC, 0) = coalesce(COMPL_PESSOA_FISICA_W.NR_SEQ_TIPO_COMPL_ADIC, 0);
            END IF;
          END IF;

          COMMIT;
      END LOOP;
  END IF;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE processa_complemento_pf_jst (IE_EVENTO_P text, CD_PESSOA_FISICA_P bigint, NR_SEQUENCIA_SUP_P bigint) FROM PUBLIC;

