-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE enviar_sms_agenda_html ( ds_remetente_p text, ds_destinatario_p text, cd_agenda_p bigint, nr_seq_agenda_p bigint, nm_usuario_p text, ds_mensagem_p text, dt_agenda_p timestamp, nm_paciente_p text, nm_medico_p text, nm_primeiro_p text, ds_especialidade_p text, ds_estab_agenda_p text, dt_resumida_p timestamp, nm_medico_resumido_p text) AS $body$
DECLARE


ds_texto_sms_w			varchar(4000);


BEGIN

ds_texto_sms_w	:= ds_mensagem_p;

ds_texto_sms_w	:= replace_macro(ds_texto_sms_w,'@DT_AGENDA@', dt_agenda_p);
ds_texto_sms_w	:= replace_macro(ds_texto_sms_w,'@NM_PACIENTE@', nm_paciente_p);
ds_texto_sms_w  := replace_macro(ds_texto_sms_w,'@NM_MEDICO@', nm_medico_p);
ds_texto_sms_w  := replace_macro(ds_texto_sms_w,'@PRIMEIRO_NOME@', nm_primeiro_p);
ds_texto_sms_w  := replace_macro(ds_texto_sms_w,'@ESPECIALIDADE@', ds_especialidade_p);
ds_texto_sms_w	:= replace_macro(ds_texto_sms_w,'@ESTAB_AGENDA@', ds_estab_agenda_p);
ds_texto_sms_w	:= replace_macro(ds_texto_sms_w,'@DT_RESUMIDA@', PKG_DATE_FORMATERS.TO_VARCHAR(dt_resumida_p, 'short', WHEB_USUARIO_PCK.GET_CD_ESTABELECIMENTO, nm_usuario_p));
ds_texto_sms_w  := replace_macro(ds_texto_sms_w,'@DT_DIA_MES@', PKG_DATE_FORMATERS.TO_VARCHAR(dt_agenda_p, 'shortDayMonth', WHEB_USUARIO_PCK.GET_CD_ESTABELECIMENTO, nm_usuario_p));
ds_texto_sms_w  := replace_macro(ds_texto_sms_w,'@DT_HOR_MIN@', PKG_DATE_FORMATERS.TO_VARCHAR(dt_resumida_p, 'shortDate', WHEB_USUARIO_PCK.GET_CD_ESTABELECIMENTO, nm_usuario_p));
ds_texto_sms_w  := replace_macro(ds_texto_sms_w,'@NM_MEDICO_RESUMIDO@', nm_medico_resumido_p);

CALL enviar_sms_agenda(ds_remetente_p,ds_destinatario_p,ds_texto_sms_w,cd_agenda_p,nr_seq_agenda_p,nm_usuario_p);

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE enviar_sms_agenda_html ( ds_remetente_p text, ds_destinatario_p text, cd_agenda_p bigint, nr_seq_agenda_p bigint, nm_usuario_p text, ds_mensagem_p text, dt_agenda_p timestamp, nm_paciente_p text, nm_medico_p text, nm_primeiro_p text, ds_especialidade_p text, ds_estab_agenda_p text, dt_resumida_p timestamp, nm_medico_resumido_p text) FROM PUBLIC;

