-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE inclui_sinal_vital_philips ( nr_seq_sinal_vital_p bigint, ds_parametro_p text, ds_unidade_p text, ds_valor_vital_p text ) AS $body$
DECLARE


c001				integer;
ds_campo_vital_p		varchar(20);
nr_seq_sinal_vital_inf_w	bigint;
ie_aparelho_pa_w		varchar(3);


BEGIN

if (nr_seq_sinal_vital_p IS NOT NULL AND nr_seq_sinal_vital_p::text <> '') and (nr_seq_sinal_vital_p > 0) then

	select	max(ie_aparelho_pa),
		max(nr_seq_sinal_vital)
	into STRICT	ie_aparelho_pa_w,
		nr_seq_sinal_vital_inf_w
	from	atendimento_sinal_vital
	where	nr_sequencia = nr_seq_sinal_vital_p;


	if (ds_parametro_p = 'HR') then

		update 	atendimento_sinal_vital
		set	qt_freq_cardiaca= (replace(ds_valor_vital_p,'.',','))::numeric
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'NBPs') then

		if	((coalesce(ie_aparelho_pa_w::text, '') = '') or (ie_aparelho_pa_w = 'A'))then

			update 	atendimento_sinal_vital
			set	qt_pa_sistolica	= (replace(ds_valor_vital_p,'.',','))::numeric ,
				ie_aparelho_pa	= 'A'
			where 	nr_sequencia 	= nr_seq_sinal_vital_p;

		else

			if (coalesce(nr_seq_sinal_vital_inf_w::text, '') = '') then

				nr_seq_sinal_vital_inf_w := gera_sinal_vital_inf(nr_seq_sinal_vital_p, nr_seq_sinal_vital_inf_w);

			end if;

			CALL inclui_sinal_vital_philips(nr_seq_sinal_vital_inf_w, ds_parametro_p, ds_unidade_p, (replace(ds_valor_vital_p,'.',','))::numeric );

		end if;

	elsif (ds_parametro_p = 'NBPd') then

		if	((coalesce(ie_aparelho_pa_w::text, '') = '') or (ie_aparelho_pa_w = 'A'))then

			update 	atendimento_sinal_vital
			set	qt_pa_diastolica = (replace(ds_valor_vital_p,'.',','))::numeric ,
				ie_aparelho_pa	 = 'A'
			where 	nr_sequencia 	 = nr_seq_sinal_vital_p;

		else

			if (coalesce(nr_seq_sinal_vital_inf_w::text, '') = '') then

				nr_seq_sinal_vital_inf_w := gera_sinal_vital_inf(nr_seq_sinal_vital_p, nr_seq_sinal_vital_inf_w);

			end if;

			CALL inclui_sinal_vital_philips(nr_seq_sinal_vital_inf_w, ds_parametro_p, ds_unidade_p, (replace(ds_valor_vital_p,'.',','))::numeric );

		end if;

	elsif (ds_parametro_p = 'NBPm') then

		if	((coalesce(ie_aparelho_pa_w::text, '') = '') or (ie_aparelho_pa_w = 'A'))then

			update 	atendimento_sinal_vital
			set	qt_pam		= (replace(ds_valor_vital_p,'.',','))::numeric ,
				ie_aparelho_pa	= 'A'
			where 	nr_sequencia 	= nr_seq_sinal_vital_p;

		else

			if (coalesce(nr_seq_sinal_vital_inf_w::text, '') = '') then

				nr_seq_sinal_vital_inf_w := gera_sinal_vital_inf(nr_seq_sinal_vital_p, nr_seq_sinal_vital_inf_w);

			end if;

			CALL inclui_sinal_vital_philips(nr_seq_sinal_vital_inf_w, ds_parametro_p, ds_unidade_p, (replace(ds_valor_vital_p,'.',','))::numeric );

		end if;

	elsif 	((ds_parametro_p = 'ARTs') or (ds_parametro_p = 'ABPs')) then

		if	((coalesce(ie_aparelho_pa_w::text, '') = '') or (ie_aparelho_pa_w = 'I'))then

			update 	atendimento_sinal_vital
			set	qt_pa_sistolica	= (replace(ds_valor_vital_p,'.',','))::numeric ,
				ie_aparelho_pa	= 'I'
			where 	nr_sequencia 	= nr_seq_sinal_vital_p;

		else

			if (coalesce(nr_seq_sinal_vital_inf_w::text, '') = '') then

				nr_seq_sinal_vital_inf_w := gera_sinal_vital_inf(nr_seq_sinal_vital_p, nr_seq_sinal_vital_inf_w);

			end if;

			CALL inclui_sinal_vital_philips(nr_seq_sinal_vital_inf_w, ds_parametro_p, ds_unidade_p, (replace(ds_valor_vital_p,'.',','))::numeric );

		end if;

	elsif 	((ds_parametro_p = 'ARTd') or (ds_parametro_p = 'ABPd')) then

		if	((coalesce(ie_aparelho_pa_w::text, '') = '') or (ie_aparelho_pa_w = 'I'))then

			update 	atendimento_sinal_vital
			set	qt_pa_diastolica = (replace(ds_valor_vital_p,'.',','))::numeric ,
				ie_aparelho_pa	 = 'I'
			where 	nr_sequencia 	 = nr_seq_sinal_vital_p;

		else

			if (coalesce(nr_seq_sinal_vital_inf_w::text, '') = '') then

				nr_seq_sinal_vital_inf_w := gera_sinal_vital_inf(nr_seq_sinal_vital_p, nr_seq_sinal_vital_inf_w);

			end if;

			CALL inclui_sinal_vital_philips(nr_seq_sinal_vital_inf_w, ds_parametro_p, ds_unidade_p, (replace(ds_valor_vital_p,'.',','))::numeric );

		end if;

	elsif 	((ds_parametro_p = 'ARTm') or (ds_parametro_p = 'ABPm')) then

		if	((coalesce(ie_aparelho_pa_w::text, '') = '') or (ie_aparelho_pa_w = 'I'))then

			update 	atendimento_sinal_vital
			set	qt_pam		= (replace(ds_valor_vital_p,'.',','))::numeric ,
				ie_aparelho_pa	= 'I'
			where 	nr_sequencia 	= nr_seq_sinal_vital_p;

		else

			if (coalesce(nr_seq_sinal_vital_inf_w::text, '') = '') then

				nr_seq_sinal_vital_inf_w := gera_sinal_vital_inf(nr_seq_sinal_vital_p, nr_seq_sinal_vital_inf_w);

			end if;

			CALL inclui_sinal_vital_philips(nr_seq_sinal_vital_inf_w, ds_parametro_p, ds_unidade_p, (replace(ds_valor_vital_p,'.',','))::numeric );

		end if;


	elsif (ds_parametro_p = 'etCO2') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_co2', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'SpO2') then

		update 	atendimento_sinal_vital
		set	qt_saturacao_o2 = (replace(ds_valor_vital_p,'.',','))::numeric
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'ICls') then

		update 	atendimento_sinal_vital
		set	qt_pressao_intra_cranio = (replace(ds_valor_vital_p,'.',','))::numeric
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'Temp') then

		update 	atendimento_sinal_vital
		set	qt_temp 	= (replace(ds_valor_vital_p,'.',','))::numeric ,
			ie_sitio	= 1 		--Dom. 1558
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'Tcore') then

		update 	atendimento_sinal_vital
		set	qt_temp 	= (replace(ds_valor_vital_p,'.',','))::numeric ,
			ie_sitio	= 1 		--Dom. 1558
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'Tesoph') then

		update 	atendimento_sinal_vital
		set	qt_temp 	= (replace(ds_valor_vital_p,'.',','))::numeric ,
			ie_sitio	= 2 		--Dom. 1558
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'Tskin') then

		update 	atendimento_sinal_vital
		set	qt_temp 	= (replace(ds_valor_vital_p,'.',','))::numeric ,
			ie_sitio	= 4 		--Dom. 1558
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'Ttymp') then

		update 	atendimento_sinal_vital
		set	qt_temp 	= (replace(ds_valor_vital_p,'.',','))::numeric ,
			ie_sitio	= 5 		--Dom. 1558
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'Tnaso') then

		update 	atendimento_sinal_vital
		set	qt_temp 	= (replace(ds_valor_vital_p,'.',','))::numeric ,
			ie_sitio	= 6 		--Dom. 1558
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'Trect') then

		update 	atendimento_sinal_vital
		set	qt_temp 	= (replace(ds_valor_vital_p,'.',','))::numeric ,
			ie_sitio	= 3 		--Dom. 1558
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'ST') then

		update 	atendimento_sinal_vital
		set	qt_segmento_st 	= (replace(ds_valor_vital_p,'.',','))::numeric
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'SVRI') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'tx_rv_sistemica', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'LVSWI') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'tx_indice_sist', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'C.I.') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'tx_indice_cardio', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'RVSWI') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'tx_trab_sist_vd', replace(ds_valor_vital_p,'.',','));

	elsif 	((ds_parametro_p = 'PAP') or (ds_parametro_p = 'PAWP')) then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'qt_pa_ocluida_ap', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'PAPs') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'qt_pa_sist_ap', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'PAPd') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'qt_pa_diast_ap', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'PAPm') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'qt_pa_media_ap', replace(ds_valor_vital_p,'.',','));

	elsif 	((ds_parametro_p = 'CVP') or (ds_parametro_p = 'CVPm')) then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'qt_pvc', replace(ds_valor_vital_p,'.',','));

		update 	atendimento_sinal_vital
		set	qt_pvc		= (replace(ds_valor_vital_p,'.',','))::numeric
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif 	((ds_parametro_p = 'LAP') or (ds_parametro_p = 'LAPm')) then

		update 	atendimento_sinal_vital
		set	qt_pae		= (replace(ds_valor_vital_p,'.',','))::numeric
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'VO2') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'qt_consumo_tiss_oxig', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'C.O.') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'qt_debito_card', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'Cuff') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_pressao_cuff', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'PVR') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'qt_rv_pulmonar', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'SVR') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'qt_rv_sistemica', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'SPO2') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_saturacao_o2', replace(ds_valor_vital_p,'.',','));

		update 	atendimento_sinal_vital
		set	qt_saturacao_o2	= (replace(ds_valor_vital_p,'.',','))::numeric
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'SvO2') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'qt_satur_ven_mista_oxigenio', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'AaDO2') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_grad_aao2', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'SV') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'qt_volume_sist', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'LCW') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'tx_trab_sist_ve', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'RCW') then

		CALL update_atend_monit_hemod(nr_seq_sinal_vital_p, 'qt_trab_sist_vd', replace(ds_valor_vital_p,'.',','));

	elsif 	((ds_parametro_p = 'RR') or (ds_parametro_p = 'Resp') or (upper(ds_parametro_p) = 'AWRR')) then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_freq_resp', replace(ds_valor_vital_p,'.',','));

		update 	atendimento_sinal_vital
		set	qt_freq_resp	= (replace(ds_valor_vital_p,'.',','))::numeric
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'VC') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_capac_vital', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'Cstat') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_cst', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'etCO2') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_co2', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'PIP') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_pip', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'PIF') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_fluxo_insp', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'Pplat') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_pplato', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'AWP') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_pc', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'iPEEP') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_auto_peep', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'MnAwP') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_pva', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'I:E1:') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_ti_te', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'Raw') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_rsr', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'TV') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_vci', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'MINVOL') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_vmin', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'FIO2') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_fio2', replace(ds_valor_vital_p,'.',','));

	elsif (ds_parametro_p = 'PEEP') then

		CALL update_atend_monit_resp(nr_seq_sinal_vital_p, 'qt_peep', replace(ds_valor_vital_p,'.',','));

	elsif 	((ds_parametro_p = 'ICP') or (ds_parametro_p = 'ICPm')) then

		update 	atendimento_sinal_vital
		set	qt_pressao_intra_cranio	= (replace(ds_valor_vital_p,'.',','))::numeric
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'CPP') then

		update 	atendimento_sinal_vital
		set	qt_ppc		= (replace(ds_valor_vital_p,'.',','))::numeric
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	elsif (ds_parametro_p = 'HC') then

		update 	atendimento_sinal_vital
		set	qt_perimetro_cefalico = (replace(ds_valor_vital_p,'.',','))::numeric
		where 	nr_sequencia 	= nr_seq_sinal_vital_p;

	end if;

	commit;

end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE inclui_sinal_vital_philips ( nr_seq_sinal_vital_p bigint, ds_parametro_p text, ds_unidade_p text, ds_valor_vital_p text ) FROM PUBLIC;

