-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE cpoe_obter_padrao_prm_presc_md ( ie_opcao_p text, cd_intervalo_p text, ie_dose_p text, qt_dose_p bigint, ie_fracao_dose_p text, qt_peso_p bigint, qt_dose_ataque_p bigint, cd_unidade_medida_p text, ie_via_aplic_padrao_p text, ie_dispositivo_inf_p text, qt_minuto_aplicacao_p bigint, qt_hora_aplicacao_p bigint, qt_solucao_p bigint, ds_justificativa_p text, ie_diluicao_p INOUT text, ie_diluicao_sel_p text, qt_dias_solicitado_p bigint, hr_prim_horario_p text, ie_justificativa_padrao_p text, ie_se_necessario_p text, ie_dose_nula_p text, ie_urgencia_p text, ds_mensagem_p text, ie_obriga_just_dose_p text, qt_dose_terapeutica_p bigint, nr_seq_dose_terap_p bigint, ie_obedecer_limite_p text, ds_horarios_p text, ds_obs_padrao_p text, ie_limpar_prim_hor_p text, ie_tipo_dosagem_p text, ds_retorno_p INOUT text ) AS $body$
DECLARE

  ds_retorno_w varchar(255) := null;

BEGIN
    if (ie_opcao_p = 'I') then
        ds_retorno_w := cd_intervalo_p;
    elsif (ie_opcao_p = 'D') then
        if (coalesce(ie_dose_p, 'F') = 'F') then
            ds_retorno_w := qt_dose_p;
        else
            if (ie_fracao_dose_p = 'S') then
                ds_retorno_w := coalesce(qt_dose_p, 0) * coalesce(qt_peso_p, 1);
            else
                ds_retorno_w := round(coalesce(qt_dose_p, 0) * coalesce(qt_peso_p, 1));
            end if;
        end if;
    elsif (ie_opcao_p = 'DT') then
        if (coalesce(ie_dose_p, 'F') = 'F') then
            ds_retorno_w := qt_dose_ataque_p;
        else
            if (ie_fracao_dose_p = 'S') then
                ds_retorno_w := coalesce(qt_dose_ataque_p, 0) * coalesce(qt_peso_p, 1);
            else
                ds_retorno_w := round(coalesce(qt_dose_ataque_p, 0) * coalesce(qt_peso_p, 1));
            end if;
        end if;
    elsif (ie_opcao_p = 'U') then
        ds_retorno_w := cd_unidade_medida_p;
    elsif (ie_opcao_p = 'V') then	
        ds_retorno_w := ie_via_aplic_padrao_p;
    elsif (ie_opcao_p = 'DI') then	
        ds_retorno_w := ie_dispositivo_inf_p;
    elsif (ie_opcao_p = 'MA') then	
        ds_retorno_w := qt_minuto_aplicacao_p;
    elsif (ie_opcao_p = 'HA') then	
        ds_retorno_w := qt_hora_aplicacao_p;
    elsif (ie_opcao_p = 'S') then
        ds_retorno_w := qt_solucao_p;
    elsif (ie_opcao_p = 'J') then	
        ds_retorno_w := substr(ds_justificativa_p, 1, 255);
    elsif (ie_opcao_p = 'L') then	
        if (coalesce(ie_diluicao_p::text, '') = '') then
            ie_diluicao_p := ie_diluicao_sel_p;
        end if;
    elsif (ie_opcao_p = 'Q') then
        ds_retorno_w := qt_dias_solicitado_p;
    elsif (ie_opcao_p = 'H') then
        ds_retorno_w := hr_prim_horario_p;
    elsif (ie_opcao_p = 'JP') then
        ds_retorno_w := ie_justificativa_padrao_p;
    elsif (ie_opcao_p = 'SN') then
        ds_retorno_w := ie_se_necessario_p;
    elsif (ie_opcao_p = 'DB') then
        ds_retorno_w := ie_dose_nula_p;
    elsif (ie_opcao_p = 'A') then
        ds_retorno_w := ie_urgencia_p;
    elsif (ie_opcao_p = 'M') then
        ds_retorno_w := ds_mensagem_p;
    elsif (ie_opcao_p = 'M1') then
        ds_retorno_w := ie_obriga_just_dose_p;
    elsif (ie_opcao_p = 'QT') then
        ds_retorno_w := qt_dose_terapeutica_p;
    elsif (ie_opcao_p = 'TT') then
        ds_retorno_w := nr_seq_dose_terap_p;
    elsif (ie_opcao_p = 'OL') then
        ds_retorno_w := ie_obedecer_limite_p;
    elsif (ie_opcao_p = 'HP') then
        ds_retorno_w := ds_horarios_p;	
    elsif (ie_opcao_p = 'O') then
        ds_retorno_w := substr(ds_obs_padrao_p, 1, 255);
    elsif (ie_opcao_p = 'LH') then
        ds_retorno_w  := ie_limpar_prim_hor_p;
    elsif (ie_opcao_p = 'TD') then
        ds_retorno_w := ie_tipo_dosagem_p;
    else
        ds_retorno_w := '';
    end if;

    ds_retorno_p := ds_retorno_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE cpoe_obter_padrao_prm_presc_md ( ie_opcao_p text, cd_intervalo_p text, ie_dose_p text, qt_dose_p bigint, ie_fracao_dose_p text, qt_peso_p bigint, qt_dose_ataque_p bigint, cd_unidade_medida_p text, ie_via_aplic_padrao_p text, ie_dispositivo_inf_p text, qt_minuto_aplicacao_p bigint, qt_hora_aplicacao_p bigint, qt_solucao_p bigint, ds_justificativa_p text, ie_diluicao_p INOUT text, ie_diluicao_sel_p text, qt_dias_solicitado_p bigint, hr_prim_horario_p text, ie_justificativa_padrao_p text, ie_se_necessario_p text, ie_dose_nula_p text, ie_urgencia_p text, ds_mensagem_p text, ie_obriga_just_dose_p text, qt_dose_terapeutica_p bigint, nr_seq_dose_terap_p bigint, ie_obedecer_limite_p text, ds_horarios_p text, ds_obs_padrao_p text, ie_limpar_prim_hor_p text, ie_tipo_dosagem_p text, ds_retorno_p INOUT text ) FROM PUBLIC;

