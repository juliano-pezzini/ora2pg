-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE intpd_recebe_man_equipamento ( nr_sequencia_p bigint, xml_p xml) AS $body$
DECLARE


_ora2pg_r RECORD;
ds_id_origin_w				intpd_eventos_sistema.ds_id_origin%type;
ie_conversao_w				intpd_eventos_sistema.ie_conversao%type;
nr_seq_sistema_w			intpd_eventos_sistema.nr_seq_sistema%type;
nr_seq_projeto_xml_w			intpd_eventos_sistema.nr_seq_projeto_xml%type;
nr_seq_regra_conv_w			conversao_meio_externo.nr_seq_regra%type;
ie_sistema_externo_w			varchar(15);
reg_integracao_w			gerar_int_padrao.reg_integracao_conv;
man_equipamento_w				man_equipamento%rowtype;
ie_erro_w				varchar(1) := 'N';
nr_man_equipamento_delete_w		man_equipamento.nr_sequencia%type;
qt_registros_w				bigint;
nr_man_equipamento_hosp_w 		man_equipamento.nr_sequencia%type;
qt_reg_equip_hosp_w			bigint;
ds_erro_w				varchar(2000);
ds_operacao_w				varchar(255);

c01 CURSOR FOR
SELECT	*
from	xmltable('/STRUCTURE/EQUIPMENT' passing xml_p columns

	IE_ACTION				varchar(15)	path 'IE_ACTION',
	CD_IMOBILIZADO_EXT			varchar(40)	path 'CD_IMOBILIZADO_EXT',
	DS_EQUIPAMENTO				varchar(80)	path 'DS_EQUIPAMENTO',
	IE_CONTROLE_SETOR			varchar(1)	path 'IE_CONTROLE_SETOR',
	IE_DISPONIBILIDADE			varchar(1)	path 'IE_DISPONIBILIDADE',
	IE_PARADO				varchar(1)	path 'IE_PARADO',
	IE_PROPRIEDADE				varchar(1)	path 'IE_PROPRIEDADE',
	IE_ROTINA_SEGURANCA			varchar(1)	path 'IE_ROTINA_SEGURANCA',
	IE_SITUACAO				varchar(1)	path 'IE_SITUACAO',
	NM_USUARIO				varchar(15)	path 'NM_USUARIO',
	NR_SEQ_LOCAL				bigint	path 'NR_SEQ_LOCAL',
	NR_SEQ_PLANEJ				bigint	path 'NR_SEQ_PLANEJ',
	NR_SEQ_TIPO_EQUIP			bigint	path 'NR_SEQ_TIPO_EQUIP',
	NR_SEQ_TRAB				bigint	path 'NR_SEQ_TRAB',
	CD_ESTAB_CONTABIL			bigint	path 'CD_ESTAB_CONTABIL',
	IE_EQUIP_HOSPITALAR			varchar(15)	path 'IE_EQUIP_HOSPITALAR',
	CD_CONTROLE				varchar(20)	path 'CD_CONTROLE',
	CD_FORNECEDOR				varchar(14)	path 'CD_FORNECEDOR',
	CD_IMOBILIZADO				varchar(20)	path 'CD_IMOBILIZADO',
	CD_IMPACTO				varchar(1)	path 'CD_IMPACTO',
	CD_LOTE_FABRICACAO			varchar(20)	path 'CD_LOTE_FABRICACAO',
	CD_MATERIAL				integer	path 'CD_MATERIAL',
	CD_MOEDA				smallint	path 'CD_MOEDA',
	CD_NACIONALIDADE			varchar(8)	path 'CD_NACIONALIDADE',
	CD_PESSOA_TERCEIRO			varchar(10)	path 'CD_PESSOA_TERCEIRO',
	DS_COR_EQUIP				varchar(255)	path 'DS_COR_EQUIP',
	DS_DANO_BREVE				varchar(80)	path 'DS_DANO_BREVE',
	DS_ENDERECO				varchar(255)	path 'DS_ENDERECO',
	DS_MARCA				varchar(50)	path 'DS_MARCA',
	DS_MODELO				varchar(50)	path 'DS_MODELO',
	DS_OBSERVACAO				varchar(2000)	path 'DS_OBSERVACAO',
	DS_OBSERVACAO_TENSAO			varchar(2000)	path 'DS_OBSERVACAO_TENSAO',
	DS_PADRAO_OS				varchar(2000)	path 'DS_PADRAO_OS',
	DT_ANO_FABRICACAO			smallint	path 'DT_ANO_FABRICACAO',
	DT_AQUISICAO				varchar(20)	path 'DT_AQUISICAO',
	DT_FIM_GARANTIA				varchar(20)	path 'DT_FIM_GARANTIA',
	DT_INICIO_GARANTIA			varchar(20)	path 'DT_INICIO_GARANTIA',
	DT_INSTALACAO				varchar(20)	path 'DT_INSTALACAO',
	DT_PROG_PREVENTIVA			varchar(20)	path 'DT_PROG_PREVENTIVA',
	IE_CALIBRACAO				varchar(1)	path 'IE_CALIBRACAO',
	IE_CLASSIFICACAO_OS			varchar(1)	path 'IE_CLASSIFICACAO_OS',
	IE_CONSISTE_OS_DUPLIC			varchar(15)	path 'IE_CONSISTE_OS_DUPLIC',
	CD_CGC_TERC				varchar(14)	path 'CD_CGC_TERC',
	IE_EXIGE_FUNCAO_OS			varchar(15)	path 'IE_EXIGE_FUNCAO_OS',
	IE_PRIORIDADE				varchar(15)	path 'IE_PRIORIDADE',
	IE_TENSAO_AC				varchar(20)	path 'IE_TENSAO_AC',
	IE_TENSAO_AC_SAIDA			varchar(20)	path 'IE_TENSAO_AC_SAIDA',
	IE_TENSAO_DC				varchar(20)	path 'IE_TENSAO_DC',
	IE_TENSAO_DC_SAIDA			varchar(20)	path 'IE_TENSAO_DC_SAIDA',
	IE_TIPO_ORDEM				varchar(15)	path 'IE_TIPO_ORDEM',
	IE_VOLTAGEM				varchar(15)	path 'IE_VOLTAGEM',
	NR_DOC_GARANTIA				varchar(20)	path 'NR_DOC_GARANTIA',
	NR_REGISTRO_ANVISA			varchar(60)	path 'NR_REGISTRO_ANVISA',
	NR_SEQ_BEM				bigint	path 'NR_SEQ_BEM',
	NR_SEQ_CATEGORIA			bigint	path 'NR_SEQ_CATEGORIA',
	NR_SEQ_CLASSIF_ELET_EQUIP		bigint	path 'NR_SEQ_CLASSIF_ELET_EQUIP',
	NR_SEQ_CLASSIF_RISCO			bigint	path 'NR_SEQ_CLASSIF_RISCO',
	NR_SEQ_CONTADOR				bigint	path 'NR_SEQ_CONTADOR',
	NR_SEQ_ESTAGIO_INICIO_OS		bigint	path 'NR_SEQ_ESTAGIO_INICIO_OS',
	NR_SEQ_FABRICANTE			bigint	path 'NR_SEQ_FABRICANTE',
	NR_SEQ_FAMILIA				bigint	path 'NR_SEQ_FAMILIA',
	NR_SEQ_ITEM_NF_INTEG			integer	path 'NR_SEQ_ITEM_NF_INTEG',
	NR_SEQ_MARCA				bigint	path 'NR_SEQ_MARCA',
	NR_SEQ_MODELO				bigint	path 'NR_SEQ_MODELO',
	NR_SEQ_NF_INTEG				bigint	path 'NR_SEQ_NF_INTEG',
	NR_SEQ_ORIGEM_DANO			bigint	path 'NR_SEQ_ORIGEM_DANO',
	NR_SEQ_STATUS				bigint	path 'NR_SEQ_STATUS',
	NR_SEQ_SUPERIOR				bigint	path 'NR_SEQ_SUPERIOR',
	NR_SEQ_TIPO_ORDEM			bigint	path 'NR_SEQ_TIPO_ORDEM',
	NR_SERIE				varchar(30)	path 'NR_SERIE',
	QT_ALTURA				double precision	path 'QT_ALTURA',
	QT_CARGA_HORARIA			real	path 'QT_CARGA_HORARIA',
	QT_COMPRIMENTO				double precision	path 'QT_COMPRIMENTO',
	QT_CORRENTE_AC				varchar(20)	path 'QT_CORRENTE_AC',
	QT_CORRENTE_AC_SAIDA			varchar(20)	path 'QT_CORRENTE_AC_SAIDA',
	QT_CORRENTE_DC				varchar(20)	path 'QT_CORRENTE_DC',
	QT_CORRENTE_DC_SAIDA			varchar(20)	path 'QT_CORRENTE_DC_SAIDA',
	QT_LARGURA				double precision	path 'QT_LARGURA',
	QT_PESO					double precision	path 'QT_PESO',
	QT_POTENCIA_AC				varchar(20)	path 'QT_POTENCIA_AC',
	QT_POTENCIA_AC_SAIDA			varchar(20)	path 'QT_POTENCIA_AC_SAIDA',
	QT_POTENCIA_DC				varchar(20)	path 'QT_POTENCIA_DC',
	QT_POTENCIA_DC_SAIDA			varchar(20)	path 'QT_POTENCIA_DC_SAIDA',
	QT_TEMPO_VIDA_UTIL			bigint	path 'QT_TEMPO_VIDA_UTIL',
	VL_AQUISICAO				double precision	path 'VL_AQUISICAO',
	VL_CUSTO_SEM_UTILIZACAO			double precision	path 'VL_CUSTO_SEM_UTILIZACAO',
	CD_CENTRO_CUSTO				integer	path 'CD_CENTRO_CUSTO');

c01_w	c01%rowtype;

BEGIN

select	id_origin
into STRICT	ds_id_origin_w
from	xmltable('/STRUCTURE' passing xml_p
	columns id_origin	varchar2(10) path 'ID_ORIGIN');

select	coalesce(b.ie_conversao,'I'),
	nr_seq_sistema,
	nr_seq_projeto_xml,
	nr_seq_regra_conv,
	coalesce(ds_id_origin,ds_id_origin_w)
into STRICT	ie_conversao_w,
	nr_seq_sistema_w,
	nr_seq_projeto_xml_w,
	nr_seq_regra_conv_w,
	ds_id_origin_w
from	intpd_fila_transmissao a,
	intpd_eventos_sistema b
where	a.nr_seq_evento_sistema = b.nr_sequencia
and	a.nr_sequencia = nr_sequencia_p;

ie_sistema_externo_w				:=	nr_seq_sistema_w;

reg_integracao_w.nr_seq_fila_transmissao	:=	nr_sequencia_p;
reg_integracao_w.ie_envio_recebe		:=	'R';
reg_integracao_w.ie_sistema_externo		:=	ie_sistema_externo_w;
reg_integracao_w.ie_conversao			:=	ie_conversao_w;
reg_integracao_w.nr_seq_projeto_xml		:=	nr_seq_projeto_xml_w;
reg_integracao_w.nr_seq_regra_conversao		:=	nr_seq_regra_conv_w;

open c01;
loop
fetch c01 into
	c01_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
	begin
	ie_erro_w := 'N';

	if (c01_w.ie_action = 'E') then
		begin
			select	coalesce(max(nr_sequencia),0)
			into STRICT	nr_man_equipamento_delete_w
			from	man_equipamento
			where	CD_IMOBILIZADO_EXT = c01_w.CD_IMOBILIZADO_EXT;

			if (nr_man_equipamento_delete_w > 0) then
				ds_operacao_w	:= 'INATIVAR MAN_EQUIPAMENTO';
				update man_equipamento set ie_situacao = 'I' where nr_sequencia = nr_man_equipamento_delete_w;
			end if;
		exception
		when others then
			ie_erro_w := 'S';
			ds_erro_w := substr(ds_operacao_w || ': ' || sqlerrm(SQLSTATE),1,2000);
			intpd_gravar_log_recebimento(nr_sequencia_p, ds_erro_w, c01_w.nm_usuario);
		end;
	else
		begin
			reg_integracao_w.nm_tabela		:=	'MAN_EQUIPAMENTO';
			reg_integracao_w.nm_elemento		:=	'EQUIPMENT';
			reg_integracao_w.nr_seq_visao		:=	31105;

			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_IMOBILIZADO_EXT', c01_w.CD_IMOBILIZADO_EXT, 'S', man_equipamento_w.CD_IMOBILIZADO_EXT) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.CD_IMOBILIZADO_EXT := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_EQUIPAMENTO', c01_w.DS_EQUIPAMENTO, 'S', man_equipamento_w.DS_EQUIPAMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DS_EQUIPAMENTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_CONTROLE_SETOR', c01_w.IE_CONTROLE_SETOR, 'S', man_equipamento_w.IE_CONTROLE_SETOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_CONTROLE_SETOR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_DISPONIBILIDADE', c01_w.IE_DISPONIBILIDADE, 'S', man_equipamento_w.IE_DISPONIBILIDADE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_DISPONIBILIDADE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PARADO', c01_w.IE_PARADO, 'S', man_equipamento_w.IE_PARADO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_PARADO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PROPRIEDADE', c01_w.IE_PROPRIEDADE, 'S', man_equipamento_w.IE_PROPRIEDADE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_PROPRIEDADE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_ROTINA_SEGURANCA', c01_w.IE_ROTINA_SEGURANCA, 'S', man_equipamento_w.IE_ROTINA_SEGURANCA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_ROTINA_SEGURANCA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_SITUACAO', c01_w.IE_SITUACAO, 'S', man_equipamento_w.IE_SITUACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_SITUACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NM_USUARIO', c01_w.NM_USUARIO, 'S', man_equipamento_w.NM_USUARIO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NM_USUARIO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_LOCAL', c01_w.NR_SEQ_LOCAL, 'S', man_equipamento_w.NR_SEQ_LOCAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_LOCAL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_PLANEJ', c01_w.NR_SEQ_PLANEJ, 'S', man_equipamento_w.NR_SEQ_PLANEJ) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_PLANEJ := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_TIPO_EQUIP', c01_w.NR_SEQ_TIPO_EQUIP, 'S', man_equipamento_w.NR_SEQ_TIPO_EQUIP) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_TIPO_EQUIP := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_TRAB', c01_w.NR_SEQ_TRAB, 'S', man_equipamento_w.NR_SEQ_TRAB) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_TRAB := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_ESTAB_CONTABIL', c01_w.CD_ESTAB_CONTABIL, 'S', man_equipamento_w.CD_ESTAB_CONTABIL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.CD_ESTAB_CONTABIL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_EQUIP_HOSPITALAR', c01_w.IE_EQUIP_HOSPITALAR, 'S', man_equipamento_w.IE_EQUIP_HOSPITALAR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_EQUIP_HOSPITALAR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CONTROLE', c01_w.CD_CONTROLE, 'S', man_equipamento_w.CD_CONTROLE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.CD_CONTROLE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_FORNECEDOR', c01_w.CD_FORNECEDOR, 'S', man_equipamento_w.CD_FORNECEDOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.CD_FORNECEDOR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_IMOBILIZADO', c01_w.CD_IMOBILIZADO, 'S', man_equipamento_w.CD_IMOBILIZADO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.CD_IMOBILIZADO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_IMPACTO', c01_w.CD_IMPACTO, 'S', man_equipamento_w.CD_IMPACTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.CD_IMPACTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_LOTE_FABRICACAO', c01_w.CD_LOTE_FABRICACAO, 'S', man_equipamento_w.CD_LOTE_FABRICACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.CD_LOTE_FABRICACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_MATERIAL', c01_w.CD_MATERIAL, 'S', man_equipamento_w.CD_MATERIAL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.CD_MATERIAL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_MOEDA', c01_w.CD_MOEDA, 'S', man_equipamento_w.CD_MOEDA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.CD_MOEDA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_NACIONALIDADE', c01_w.CD_NACIONALIDADE, 'S', man_equipamento_w.CD_NACIONALIDADE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.CD_NACIONALIDADE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_PESSOA_TERCEIRO', c01_w.CD_PESSOA_TERCEIRO, 'S', man_equipamento_w.CD_PESSOA_TERCEIRO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.CD_PESSOA_TERCEIRO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_COR_EQUIP', c01_w.DS_COR_EQUIP, 'S', man_equipamento_w.DS_COR_EQUIP) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DS_COR_EQUIP := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_DANO_BREVE', c01_w.DS_DANO_BREVE, 'S', man_equipamento_w.DS_DANO_BREVE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DS_DANO_BREVE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_ENDERECO', c01_w.DS_ENDERECO, 'S', man_equipamento_w.DS_ENDERECO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DS_ENDERECO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_MARCA', c01_w.DS_MARCA, 'S', man_equipamento_w.DS_MARCA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DS_MARCA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_MODELO', c01_w.DS_MODELO, 'S', man_equipamento_w.DS_MODELO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DS_MODELO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_OBSERVACAO', c01_w.DS_OBSERVACAO, 'S', man_equipamento_w.DS_OBSERVACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DS_OBSERVACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_OBSERVACAO_TENSAO', c01_w.DS_OBSERVACAO_TENSAO, 'S', man_equipamento_w.DS_OBSERVACAO_TENSAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DS_OBSERVACAO_TENSAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DS_PADRAO_OS', c01_w.DS_PADRAO_OS, 'S', man_equipamento_w.DS_PADRAO_OS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DS_PADRAO_OS := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_ANO_FABRICACAO', c01_w.DT_ANO_FABRICACAO, 'S', man_equipamento_w.DT_ANO_FABRICACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DT_ANO_FABRICACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_AQUISICAO', c01_w.DT_AQUISICAO, 'S', man_equipamento_w.DT_AQUISICAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DT_AQUISICAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_FIM_GARANTIA', c01_w.DT_FIM_GARANTIA, 'S', man_equipamento_w.DT_FIM_GARANTIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DT_FIM_GARANTIA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_INICIO_GARANTIA', c01_w.DT_INICIO_GARANTIA, 'S', man_equipamento_w.DT_INICIO_GARANTIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DT_INICIO_GARANTIA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_INSTALACAO', c01_w.DT_INSTALACAO, 'S', man_equipamento_w.DT_INSTALACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DT_INSTALACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'DT_PROG_PREVENTIVA', c01_w.DT_PROG_PREVENTIVA, 'S', man_equipamento_w.DT_PROG_PREVENTIVA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.DT_PROG_PREVENTIVA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_CALIBRACAO', c01_w.IE_CALIBRACAO, 'S', man_equipamento_w.IE_CALIBRACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_CALIBRACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_CLASSIFICACAO_OS', c01_w.IE_CLASSIFICACAO_OS, 'S', man_equipamento_w.IE_CLASSIFICACAO_OS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_CLASSIFICACAO_OS := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_CONSISTE_OS_DUPLIC', c01_w.IE_CONSISTE_OS_DUPLIC, 'S', man_equipamento_w.IE_CONSISTE_OS_DUPLIC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_CONSISTE_OS_DUPLIC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CGC_TERC', c01_w.CD_CGC_TERC, 'S', man_equipamento_w.CD_CGC_TERC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.CD_CGC_TERC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_EXIGE_FUNCAO_OS', c01_w.IE_EXIGE_FUNCAO_OS, 'S', man_equipamento_w.IE_EXIGE_FUNCAO_OS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_EXIGE_FUNCAO_OS := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_PRIORIDADE', c01_w.IE_PRIORIDADE, 'S', man_equipamento_w.IE_PRIORIDADE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_PRIORIDADE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TENSAO_AC', c01_w.IE_TENSAO_AC, 'S', man_equipamento_w.IE_TENSAO_AC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_TENSAO_AC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TENSAO_AC_SAIDA', c01_w.IE_TENSAO_AC_SAIDA, 'S', man_equipamento_w.IE_TENSAO_AC_SAIDA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_TENSAO_AC_SAIDA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TENSAO_DC', c01_w.IE_TENSAO_DC, 'S', man_equipamento_w.IE_TENSAO_DC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_TENSAO_DC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TENSAO_DC_SAIDA', c01_w.IE_TENSAO_DC_SAIDA, 'S', man_equipamento_w.IE_TENSAO_DC_SAIDA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_TENSAO_DC_SAIDA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_TIPO_ORDEM', c01_w.IE_TIPO_ORDEM, 'S', man_equipamento_w.IE_TIPO_ORDEM) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_TIPO_ORDEM := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'IE_VOLTAGEM', c01_w.IE_VOLTAGEM, 'S', man_equipamento_w.IE_VOLTAGEM) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.IE_VOLTAGEM := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_DOC_GARANTIA', c01_w.NR_DOC_GARANTIA, 'S', man_equipamento_w.NR_DOC_GARANTIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_DOC_GARANTIA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_REGISTRO_ANVISA', c01_w.NR_REGISTRO_ANVISA, 'S', man_equipamento_w.NR_REGISTRO_ANVISA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_REGISTRO_ANVISA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_BEM', c01_w.NR_SEQ_BEM, 'S', man_equipamento_w.NR_SEQ_BEM) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_BEM := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CATEGORIA', c01_w.NR_SEQ_CATEGORIA, 'S', man_equipamento_w.NR_SEQ_CATEGORIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_CATEGORIA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CLASSIF_ELET_EQUIP', c01_w.NR_SEQ_CLASSIF_ELET_EQUIP, 'S', man_equipamento_w.NR_SEQ_CLASSIF_ELET_EQUIP) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_CLASSIF_ELET_EQUIP := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CLASSIF_RISCO', c01_w.NR_SEQ_CLASSIF_RISCO, 'S', man_equipamento_w.NR_SEQ_CLASSIF_RISCO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_CLASSIF_RISCO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_CONTADOR', c01_w.NR_SEQ_CONTADOR, 'S', man_equipamento_w.NR_SEQ_CONTADOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_CONTADOR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_ESTAGIO_INICIO_OS', c01_w.NR_SEQ_ESTAGIO_INICIO_OS, 'S', man_equipamento_w.NR_SEQ_ESTAGIO_INICIO_OS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_ESTAGIO_INICIO_OS := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_FABRICANTE', c01_w.NR_SEQ_FABRICANTE, 'S', man_equipamento_w.NR_SEQ_FABRICANTE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_FABRICANTE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_FAMILIA', c01_w.NR_SEQ_FAMILIA, 'S', man_equipamento_w.NR_SEQ_FAMILIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_FAMILIA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_ITEM_NF_INTEG', c01_w.NR_SEQ_ITEM_NF_INTEG, 'S', man_equipamento_w.NR_SEQ_ITEM_NF_INTEG) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_ITEM_NF_INTEG := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_MARCA', c01_w.NR_SEQ_MARCA, 'S', man_equipamento_w.NR_SEQ_MARCA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_MARCA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_MODELO', c01_w.NR_SEQ_MODELO, 'S', man_equipamento_w.NR_SEQ_MODELO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_MODELO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_NF_INTEG', c01_w.NR_SEQ_NF_INTEG, 'S', man_equipamento_w.NR_SEQ_NF_INTEG) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_NF_INTEG := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_ORIGEM_DANO', c01_w.NR_SEQ_ORIGEM_DANO, 'S', man_equipamento_w.NR_SEQ_ORIGEM_DANO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_ORIGEM_DANO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_STATUS', c01_w.NR_SEQ_STATUS, 'S', man_equipamento_w.NR_SEQ_STATUS) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_STATUS := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_SUPERIOR', c01_w.NR_SEQ_SUPERIOR, 'S', man_equipamento_w.NR_SEQ_SUPERIOR) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_SUPERIOR := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SEQ_TIPO_ORDEM', c01_w.NR_SEQ_TIPO_ORDEM, 'S', man_equipamento_w.NR_SEQ_TIPO_ORDEM) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SEQ_TIPO_ORDEM := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'NR_SERIE', c01_w.NR_SERIE, 'S', man_equipamento_w.NR_SERIE) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.NR_SERIE := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_ALTURA', c01_w.QT_ALTURA, 'S', man_equipamento_w.QT_ALTURA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_ALTURA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_CARGA_HORARIA', c01_w.QT_CARGA_HORARIA, 'S', man_equipamento_w.QT_CARGA_HORARIA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_CARGA_HORARIA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_COMPRIMENTO', c01_w.QT_COMPRIMENTO, 'S', man_equipamento_w.QT_COMPRIMENTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_COMPRIMENTO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_CORRENTE_AC', c01_w.QT_CORRENTE_AC, 'S', man_equipamento_w.QT_CORRENTE_AC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_CORRENTE_AC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_CORRENTE_AC_SAIDA', c01_w.QT_CORRENTE_AC_SAIDA, 'S', man_equipamento_w.QT_CORRENTE_AC_SAIDA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_CORRENTE_AC_SAIDA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_CORRENTE_DC', c01_w.QT_CORRENTE_DC, 'S', man_equipamento_w.QT_CORRENTE_DC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_CORRENTE_DC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_CORRENTE_DC_SAIDA', c01_w.QT_CORRENTE_DC_SAIDA, 'S', man_equipamento_w.QT_CORRENTE_DC_SAIDA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_CORRENTE_DC_SAIDA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_LARGURA', c01_w.QT_LARGURA, 'S', man_equipamento_w.QT_LARGURA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_LARGURA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_PESO', c01_w.QT_PESO, 'S', man_equipamento_w.QT_PESO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_PESO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_POTENCIA_AC', c01_w.QT_POTENCIA_AC, 'S', man_equipamento_w.QT_POTENCIA_AC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_POTENCIA_AC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_POTENCIA_AC_SAIDA', c01_w.QT_POTENCIA_AC_SAIDA, 'S', man_equipamento_w.QT_POTENCIA_AC_SAIDA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_POTENCIA_AC_SAIDA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_POTENCIA_DC', c01_w.QT_POTENCIA_DC, 'S', man_equipamento_w.QT_POTENCIA_DC) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_POTENCIA_DC := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_POTENCIA_DC_SAIDA', c01_w.QT_POTENCIA_DC_SAIDA, 'S', man_equipamento_w.QT_POTENCIA_DC_SAIDA) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_POTENCIA_DC_SAIDA := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'QT_TEMPO_VIDA_UTIL', c01_w.QT_TEMPO_VIDA_UTIL, 'S', man_equipamento_w.QT_TEMPO_VIDA_UTIL) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.QT_TEMPO_VIDA_UTIL := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_AQUISICAO', c01_w.VL_AQUISICAO, 'S', man_equipamento_w.VL_AQUISICAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.VL_AQUISICAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'VL_CUSTO_SEM_UTILIZACAO', c01_w.VL_CUSTO_SEM_UTILIZACAO, 'S', man_equipamento_w.VL_CUSTO_SEM_UTILIZACAO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.VL_CUSTO_SEM_UTILIZACAO := _ora2pg_r.ds_valor_retorno_p;
			SELECT * FROM intpd_processar_atributo(reg_integracao_w, 'CD_CENTRO_CUSTO', c01_w.CD_CENTRO_CUSTO, 'S', man_equipamento_w.CD_CENTRO_CUSTO) INTO STRICT _ora2pg_r;
 reg_integracao_w := _ora2pg_r.reg_integracao_p; man_equipamento_w.CD_CENTRO_CUSTO := _ora2pg_r.ds_valor_retorno_p;
			man_equipamento_w.dt_atualizacao := clock_timestamp();
			man_equipamento_w.dt_atualizacao_nrec := clock_timestamp();
			man_equipamento_w.nm_usuario_nrec := man_equipamento_w.nm_usuario;


			if (reg_integracao_w.qt_reg_log = 0) then
				select	coalesce(max(nr_sequencia),0)
				into STRICT	man_equipamento_w.nr_sequencia
				from	man_equipamento
				where	cd_imobilizado_ext = man_equipamento_w.cd_imobilizado_ext;

				if (man_equipamento_w.nr_sequencia > 0) then
					ds_operacao_w	:= 'UPDATE MAN_EQUIPAMENTO';
					update	man_equipamento
					set	row = man_equipamento_w
					where	nr_sequencia = man_equipamento_w.nr_sequencia;
				else
					ds_operacao_w	:= 'INSERT MAN_EQUIPAMENTO';
					select	nextval('man_equipamento_seq')
					into STRICT	man_equipamento_w.nr_sequencia
					;

					insert into man_equipamento values (man_equipamento_w.*);

				end if;

				select count(*)
				into STRICT qt_reg_equip_hosp_w
				from equipamento
				where nr_seq_equipamento_man = man_equipamento_w.nr_sequencia;

				if (man_equipamento_w.IE_EQUIP_HOSPITALAR = 'S' and qt_reg_equip_hosp_w = 0) then
					ds_operacao_w	:= 'INSERT EQUIPAMENTO (HOSPITALAR)';
					select	coalesce(max(nr_sequencia),0)
					into STRICT	nr_man_equipamento_hosp_w
					from	man_equipamento
					where	CD_IMOBILIZADO_EXT = man_equipamento_w.CD_IMOBILIZADO_EXT;

					CALL man_gerar_equip_hosp(nr_man_equipamento_hosp_w, man_equipamento_w.nm_usuario);
				end if;

			end if;
		exception
		when others then
			ds_erro_w := substr(ds_operacao_w || ': ' || sqlerrm(SQLSTATE),1,2000);
			ie_erro_w := 'S';
			intpd_gravar_log_recebimento(nr_sequencia_p, ds_erro_w, c01_w.nm_usuario);
		end;
	end if;

	end;
end loop;
close C01;

if	((reg_integracao_w.qt_reg_log > 0) or (ie_erro_w = 'S')) then
	begin
	rollback;

	update 	intpd_fila_transmissao
	set	ie_status = 'E',
		ie_tipo_erro = 'F'
	where	nr_sequencia = nr_sequencia_p;

	for i in 0..reg_integracao_w.qt_reg_log-1 loop
		INTPD_GRAVAR_LOG_RECEBIMENTO(nr_sequencia_p,reg_integracao_w.intpd_log_receb[i].ds_log,'INTPDTASY');
	end loop;
	end;
else
	update	intpd_fila_transmissao
	set	ie_status = 'S',
		nr_seq_documento = coalesce(nr_man_equipamento_delete_w, man_equipamento_w.nr_sequencia),
		nr_doc_externo = c01_w.CD_IMOBILIZADO_EXT
	where	nr_sequencia = nr_sequencia_p;
end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE intpd_recebe_man_equipamento ( nr_sequencia_p bigint, xml_p xml) FROM PUBLIC;

