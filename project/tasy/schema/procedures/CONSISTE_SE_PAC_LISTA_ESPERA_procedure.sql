-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE consiste_se_pac_lista_espera ( cd_agenda_p bigint, dt_agenda_p timestamp, cd_estabelecimento_p bigint, cd_perfil_p bigint, nm_usuario_p text, ds_mensagem_p INOUT text) AS $body$
DECLARE

 
ie_horario_pac_espera_w		varchar(1);
vl_parametro_w			varchar(255);
ds_mensagem_w			varchar(255);
				

BEGIN 
	 
if (cd_agenda_p IS NOT NULL AND cd_agenda_p::text <> '') and (dt_agenda_p IS NOT NULL AND dt_agenda_p::text <> '') then 
	begin 
	vl_parametro_w := Obter_Param_Usuario(820, 97, cd_perfil_p, nm_usuario_p, cd_estabelecimento_p, vl_parametro_w);
 
	if (vl_parametro_w = 'S') then 
		begin	 
		ie_horario_pac_espera_w	:= substr(obter_se_pac_espera_hor_agenda(cd_agenda_p, dt_agenda_p),1,1);
	 
		if (ie_horario_pac_espera_w = 'S') then			 
			ds_mensagem_w	:= substr(obter_texto_tasy(37668, wheb_usuario_pck.get_nr_seq_idioma),1,255);
		end if;
		end;
	end if;
	end;
end if;
 
ds_mensagem_p		:= ds_mensagem_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE consiste_se_pac_lista_espera ( cd_agenda_p bigint, dt_agenda_p timestamp, cd_estabelecimento_p bigint, cd_perfil_p bigint, nm_usuario_p text, ds_mensagem_p INOUT text) FROM PUBLIC;

