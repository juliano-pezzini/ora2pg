-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE phi_inserir_participantes_ata ( nr_seq_ata_p proj_ata.nr_sequencia%type, cd_pessoa_participante_p proj_equipe_papel.cd_pessoa_fisica%type, nr_seq_equipe_p proj_equipe_papel.nr_seq_equipe%type, nm_usuario_p text) AS $body$
DECLARE


/*
	++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
	Objective: N/A
	------------------------------------------------------------------------
	Direct call: 
	[   ] Dictionary objects
	[   ] Tasy (Delphi/Java/HTML5)
	[   ] Portal
	[   ] Reports
	[   ] Others:
	 -----------------------------------------------------------------------
	Attention points: N/A
	------------------------------------------------------------------------
	References:
		Tables: N/A
		Objects: N/A
	------------------------------------------------------------------------
	Called in:
		Java: N/A
		HTML5: N/A
		Object: N/A
	++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
*/
BEGIN

if (nr_seq_ata_p IS NOT NULL AND nr_seq_ata_p::text <> '' AND cd_pessoa_participante_p IS NOT NULL AND cd_pessoa_participante_p::text <> '') then
	begin

		insert into proj_ata_participante(
			nr_sequencia,
			dt_atualizacao,
			nm_usuario,
			dt_atualizacao_nrec,
			nm_usuario_nrec,
			nr_seq_ata,
			ie_faltou,
			cd_pessoa_participante,
			ds_email,
			cd_setor_atendimento)
		 values (
			nextval('proj_ata_participante_seq'),
			clock_timestamp(),
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			nr_seq_ata_p,
			'N', 
			cd_pessoa_participante_p,
			substr(coalesce(proj_obter_dados_equipe_papel(nr_seq_equipe_p, 'E', cd_pessoa_participante_p), obter_email_usuario_pf(cd_pessoa_participante_p)), 1, 255),
			obter_setor_usuario(obter_usuario_pf(cd_pessoa_participante_p)));
		commit;
	end;
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE phi_inserir_participantes_ata ( nr_seq_ata_p proj_ata.nr_sequencia%type, cd_pessoa_participante_p proj_equipe_papel.cd_pessoa_fisica%type, nr_seq_equipe_p proj_equipe_papel.nr_seq_equipe%type, nm_usuario_p text) FROM PUBLIC;

