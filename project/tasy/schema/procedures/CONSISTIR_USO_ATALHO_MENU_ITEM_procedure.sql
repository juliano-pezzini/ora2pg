-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE consistir_uso_atalho_menu_item (nr_seq_menu_item_p bigint) AS $body$
DECLARE


nr_seq_menu_w		bigint;
ie_atalho_w		varchar(15);
ie_ctrl_w			varchar(1);
ie_shift_w			varchar(1);
ie_alt_w			varchar(1);
ie_atalho_duplicado_w	varchar(1);


BEGIN
if (nr_seq_menu_item_p IS NOT NULL AND nr_seq_menu_item_p::text <> '') then
	begin
	select	nr_seq_obj_sup,
		ie_atalho,
		ie_ctrl,
		ie_shift,
		ie_alt
	into STRICT	nr_seq_menu_w,
		ie_atalho_w,
		ie_ctrl_w,
		ie_shift_w,
		ie_alt_w
	from	dic_objeto
	where	nr_sequencia = nr_seq_menu_item_p;

	if (ie_atalho_w IS NOT NULL AND ie_atalho_w::text <> '') then
		begin
		CALL consistir_atalho_tasy(ie_atalho_w, ie_ctrl_w, ie_shift_w, ie_alt_w);

		select	CASE WHEN count(*)=0 THEN 'N'  ELSE 'S' END
		into STRICT	ie_atalho_duplicado_w
		from	dic_objeto
		where	nr_seq_obj_sup	= nr_seq_menu_w
		and	ie_tipo_objeto	= 'MI'
		and	nr_sequencia	<> nr_seq_menu_item_p
		and	ie_atalho		= ie_atalho_w
		and	coalesce(ie_ctrl,'N')	= coalesce(ie_ctrl_w,'N')
		and	coalesce(ie_shift,'N')	= coalesce(ie_shift_w,'N')
		and	coalesce(ie_alt,'N')	= coalesce(ie_alt_w,'N');

		if (ie_atalho_duplicado_w = 'S') then
			begin
			CALL wheb_mensagem_pck.exibir_mensagem_abort(282010);
			end;
		end if;
		end;
	end if;
	end;
end if;
commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE consistir_uso_atalho_menu_item (nr_seq_menu_item_p bigint) FROM PUBLIC;

