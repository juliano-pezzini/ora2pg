-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_inf_agenda_cirurgiao_js ( cd_medico_p text, cd_pessoa_fisica_p text, nr_seq_proc_interno_p bigint, nm_usuario_p text, qt_tempo_medico_p INOUT bigint, qt_tempo_proced_p INOUT bigint, qt_tempo_min_proced_p INOUT bigint, qt_tempo_hig_p INOUT bigint, ie_exige_lado_p INOUT text ) AS $body$
DECLARE


qt_tempo_medico_w	integer := 0;
qt_tempo_proced_w	integer := 0;
qt_tempo_min_proced_w	integer := 0;
qt_tempo_hig_w		integer := 0;
ie_exige_lado_w		varchar(1) := '';


BEGIN

select 	coalesce(max(qt_min_cirugia),0)
into STRICT	qt_tempo_medico_w
from   	proc_interno_tempo
where  	coalesce(cd_medico,coalesce(cd_medico_p,'X')) = coalesce(cd_medico_p,'X')
and		coalesce(cd_estabelecimento,coalesce(wheb_usuario_pck.get_cd_estabelecimento,0)) = coalesce(wheb_usuario_pck.get_cd_estabelecimento,0)
and    	nr_seq_proc_interno = nr_seq_proc_interno_p;

select 	coalesce(max(qt_min_cirurgia),0)
into STRICT	qt_tempo_proced_w
from   	proc_interno
where  	nr_sequencia = nr_seq_proc_interno_p;

select 	sum(qt_min_proced)
into STRICT	qt_tempo_min_proced_w
from   	w_agenda_proc_adic
where  	cd_pessoa_fisica = cd_pessoa_fisica_p;

select 	coalesce(max(qt_min_higienizacao),0)
into STRICT	qt_tempo_hig_w
from   	proc_interno
where  	nr_sequencia = nr_seq_proc_interno_p;

ie_exige_lado_w 	:= obter_se_proc_exige_lado(nr_seq_proc_interno_p, null, null);

qt_tempo_medico_p	:= qt_tempo_medico_w;
qt_tempo_proced_p	:= qt_tempo_proced_w;
qt_tempo_min_proced_p	:= qt_tempo_min_proced_w;
qt_tempo_hig_p		:= qt_tempo_hig_w;
ie_exige_lado_p		:= ie_exige_lado_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_inf_agenda_cirurgiao_js ( cd_medico_p text, cd_pessoa_fisica_p text, nr_seq_proc_interno_p bigint, nm_usuario_p text, qt_tempo_medico_p INOUT bigint, qt_tempo_proced_p INOUT bigint, qt_tempo_min_proced_p INOUT bigint, qt_tempo_hig_p INOUT bigint, ie_exige_lado_p INOUT text ) FROM PUBLIC;

