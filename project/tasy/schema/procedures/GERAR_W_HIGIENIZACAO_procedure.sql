-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';



CREATE TYPE colunas AS (nm_coluna_w varchar(60));


CREATE OR REPLACE PROCEDURE gerar_w_higienizacao () AS $body$
DECLARE


/* vetor */

type vetor is table of colunas index by integer;

/* globais */

vetor_w					vetor;
cd_setor_atendimento_w			bigint;
i					smallint;
cd_estabelecimento_w			bigint;


ds_concatenado_w			varchar(2000);
ds_concatenado_ww			varchar(2000);

ds_ocupacao_w				varchar(255);
cd_unidade_basica_w			varchar(255);
cd_unidade_compl_w			varchar(255);
ie_status_w				varchar(20);
ie_temporario_w				varchar(1);
nr_seq_interno_w			varchar(20);
cd_pessoa_fisica_w			varchar(10);
cd_setor_atendimento_ww			varchar(20);
ie_status_ww				varchar(20);	
ie_todos_previsto_w 			varchar(1);

ds_retorno_w		varchar(90);
nr_atendimento_w	bigint;
dt_alta_w		timestamp;
dt_saida_real_w		timestamp;
NR_SEQ_INTERNO_ww	bigint;
ie_status_serv_w	varchar(15);
qt_setor_regra_w	bigint;
ie_evento_w		varchar(15);
qt_check_list_w		bigint;
nr_seq_unid_atend_w	bigint;
ie_status_unidade_w	varchar(15);
nr_atendimento_atual_w 	bigint;
ie_pac_isolado_w	varchar(1);
qt_status_isolado_w	bigint;
ie_classificao_cc_w	varchar(1);

c01 CURSOR FOR
	SELECT  distinct cd_setor_atendimento
	from    ocupacao_setores_v
	where   ie_ocup_hospitalar = 'S'
	and	cd_estabelecimento_base = cd_estabelecimento_w
	order by 1;
	
c02 CURSOR FOR
	SELECT	ds_ocupacao,
		cd_unidade_basica,
		cd_unidade_compl,
		'@ie_status_w',
		ie_temporario,
		nr_seq_interno,
		cd_pessoa_fisica
	from	ocupacao_higienizacao_v
	where	cd_setor_atendimento = cd_setor_atendimento_w
	order by ds_ocupacao;
	
c03 CURSOR FOR
	SELECT	distinct cd_setor_atendimento
	from	ocupacao_setores_hig_v
	where       ie_ocup_hospitalar in ('S','M')
	and	cd_estabelecimento_base = cd_estabelecimento_w
	order by 1;


BEGIN

delete from w_higienizacao;

/*HTML5 Inicio*/

delete	FROM w_higienizacao_setor
where	nm_usuario = obter_usuario_ativo;

delete	FROM w_higienizacao_unidade
where	nm_usuario = obter_usuario_ativo;
/*Fim*/

cd_estabelecimento_w	:= WHEB_USUARIO_PCK.GET_CD_ESTABELECIMENTO;

select	coalesce(max(obter_valor_param_usuario(75,69,obter_perfil_ativo, wheb_usuario_pck.get_nm_usuario, cd_estabelecimento_w)), 'N')
into STRICT	ie_classificao_cc_w
;

if (ie_classificao_cc_w = 'N') then
	OPEN c01;
	LOOP
	FETCH c01 INTO
		cd_setor_atendimento_w;
		EXIT WHEN NOT FOUND; /* apply on c01 */

		for i in 1..60 loop
			begin
				vetor_w[i].nm_coluna_w := null;
			end;
		end loop;
		
		/*HTML5 Inicio*/

		insert into w_higienizacao_setor(
			cd_setor_atendimento,
			nm_usuario,
			dt_atualizacao)
		values (cd_setor_atendimento_w,
			obter_usuario_ativo,
			clock_timestamp());
		/*Fim*/

		
		i := 1;
		OPEN c02;
		LOOP
		FETCH c02 INTO
			ds_ocupacao_w,
			cd_unidade_basica_w,
			cd_unidade_compl_w,
			ie_status_w,
			ie_temporario_w,
			nr_seq_interno_w,
			cd_pessoa_fisica_w;
		EXIT WHEN NOT FOUND; /* apply on c02 */
			begin
			
			select	max(NR_SEQ_INTERNO),
				max(nr_atendimento),
				max(IE_STATUS_UNIDADE)
			into STRICT	NR_SEQ_INTERNO_ww,
				nr_atendimento_atual_w,
				ie_status_unidade_w
			from	unidade_atendimento
			where	cd_setor_atendimento 	= cd_setor_atendimento_w
			and	cd_unidade_basica 	= cd_unidade_basica_w
			and	cd_unidade_compl	= cd_unidade_compl_w;


			select 	max(nr_sequencia)
			into STRICT	nr_seq_unid_atend_w
			from	sl_unid_atend
			where	nr_seq_unidade	= NR_SEQ_INTERNO_ww
			and	trunc(dt_prevista) 	= trunc(clock_timestamp());


			select	max(ie_status_serv),
				coalesce(max(ie_evento),'X')
			into STRICT	ie_status_serv_w,
				ie_evento_w
			from	sl_unid_atend
			where	nr_sequencia = nr_seq_unid_atend_w;

			select	count(*)
			into STRICT	qt_check_list_w
			from	SL_CHECK_LIST_UNID
			where	NR_SEQ_SL_UNID = nr_seq_unid_atend_w;

			select	count(*)
			into STRICT	qt_setor_regra_w
			from	HIGIENIZACAO_SETOR_REGRA
			where	cd_setor_atendimento 	= cd_setor_atendimento_w;

			select	obter_ult_atend_unidade(cd_setor_atendimento_w,cd_unidade_basica_w,cd_unidade_compl_w)
			into STRICT	nr_atendimento_w
			;


			begin
			select	dt_alta,
				dt_saida_real,
				coalesce(ie_paciente_isolado,'N')
			into STRICT	dt_alta_w,
				dt_saida_real_w,
				ie_pac_isolado_w
			from	atendimento_paciente
			where	nr_atendimento = nr_atendimento_w;
				exception when others then
					dt_alta_w	:= null;
					dt_saida_real_w	:= null;
			end;

			select	count(*)
			into STRICT	qt_status_isolado_w
			from 	SL_STATUS_HIGIENIZACAO
			where   ie_status_higienizacao = 'PI';
			
			ds_retorno_w	:= 'L';
			
			ie_todos_previsto_w := Obter_Param_Usuario(75, 53, obter_perfil_ativo, WHEB_USUARIO_PCK.GET_NM_USUARIO, cd_estabelecimento_w, ie_todos_previsto_w);

			if (nr_atendimento_atual_w > 0) and (obter_status_higien_cadastrado('LCP') = 'S') then
				ds_retorno_w	:= 'LCP';
			end if;
			if (dt_alta_w IS NOT NULL AND dt_alta_w::text <> '') and (ie_status_unidade_w = 'A') and (coalesce(dt_saida_real_w::text, '') = '') and (obter_status_higien_cadastrado('ACP') = 'S') then
				ds_retorno_w	:= 'ACP';
			end if;

			if (dt_alta_w IS NOT NULL AND dt_alta_w::text <> '') and (dt_saida_real_w IS NOT NULL AND dt_saida_real_w::text <> '') and (ie_status_serv_w = 'P') and (qt_setor_regra_w = 0) and (ie_evento_w <> 'LL') and (obter_status_higien_cadastrado('ASP') = 'S') then
				ds_retorno_w	:= 'ASP';
			end if;	

			if (ie_status_unidade_w = 'I') and (obter_status_higien_cadastrado('LI') = 'S') then
				ds_retorno_w	:= 'LI';
			end if;

			if (dt_alta_w IS NOT NULL AND dt_alta_w::text <> '') and (ie_status_serv_w = 'P') and (qt_setor_regra_w > 0) and (ie_evento_w <> 'LL') and (obter_status_higien_cadastrado('LU') = 'S') then
				ds_retorno_w	:= 'LU';
			end if;	
			

			if (ie_status_unidade_w = 'G') and
				((ie_status_serv_w = 'P') or (pkg_i18n.get_user_locale = 'en_AU')) and
				((ie_evento_w = 'LL') or (ie_todos_previsto_w = 'S')) and (obter_status_higien_cadastrado('AL') = 'S') then
				ds_retorno_w	:= 'AL';
			end if;	


			if (ie_status_unidade_w = 'H') and (ie_status_serv_w = 'EE') and (obter_status_higien_cadastrado('EM') = 'S') then
				ds_retorno_w	:= 'EM';
			end if;	

			if (dt_alta_w IS NOT NULL AND dt_alta_w::text <> '') and (ie_status_serv_w = 'E') and (qt_check_list_w = 0) and (obter_status_higien_cadastrado('ACL') = 'S') then
				ds_retorno_w	:= 'ACL';
			end if;	

			if (dt_alta_w IS NOT NULL AND dt_alta_w::text <> '') and (ie_status_serv_w = 'A') and (obter_status_higien_cadastrado('L') = 'S') then
				ds_retorno_w	:= 'L';
				
				
			end if;	
			
			if (coalesce(dt_alta_w::text, '') = '') and (nr_atendimento_atual_w > 0) and (qt_status_isolado_w > 0) and (ie_pac_isolado_w = 'S') and (obter_status_higien_cadastrado('PI') = 'S') then
				ds_retorno_w	:= 'PI';
					
			end if;	
			
			if (ie_status_unidade_w = 'E') and (obter_status_higien_cadastrado('M') = 'S') then
				ds_retorno_w	:= 'M';
			end if;
						
			ds_concatenado_w	:= 	(ds_ocupacao_w || ';' || cd_unidade_basica_w	|| ';' ||  cd_unidade_compl_w || ';' ||  ie_status_w || ';' || ie_temporario_w  || ';' || nr_seq_interno_w || ';' || cd_pessoa_fisica_w);			
			
			ds_concatenado_ww	:=	replace(ds_concatenado_w,'@ie_status_w',ds_retorno_w);
			
			vetor_w[i].nm_coluna_w	:=	substr(ds_concatenado_ww, 1, 50);
			i := i + 1;
			ds_concatenado_w	:=	'';
			ds_concatenado_ww	:=	'';
			
			
			/*HTML5 Inicio*/

			insert into w_higienizacao_unidade(	
				cd_setor_atendimento,
				nr_seq_unidade,
				ie_status_higienizacao,
				ds_leito,
				cd_pessoa_fisica,
				nm_usuario,
				dt_atualizacao)
			values (	cd_setor_atendimento_w,
				nr_seq_interno_w,
				ds_retorno_w,
				ds_ocupacao_w,
				cd_pessoa_fisica_w,
				obter_usuario_ativo,
				clock_timestamp());
			/*Fim*/
	
			
			end;
		END LOOP;
		CLOSE c02;

		insert into w_higienizacao(
			CD_SETOR_ATENDIMENTO,
			DS_LEITO1,
			DS_LEITO2,
			DS_LEITO3,
			DS_LEITO4,
			DS_LEITO5,
			DS_LEITO6,
			DS_LEITO7,
			DS_LEITO8,
			DS_LEITO9,
			DS_LEITO10,
			DS_LEITO11,
			DS_LEITO12,
			DS_LEITO13,
			DS_LEITO14,
			DS_LEITO15,
			DS_LEITO16,
			DS_LEITO17,
			DS_LEITO18,
			DS_LEITO19,
			DS_LEITO20,
			DS_LEITO21,
			DS_LEITO22,
			DS_LEITO23,
			DS_LEITO24,
			DS_LEITO25,
			DS_LEITO26,
			DS_LEITO27,
			DS_LEITO28,
			DS_LEITO29,
			DS_LEITO30,
			DS_LEITO31,
			DS_LEITO32,
			DS_LEITO33,
			DS_LEITO34,
			DS_LEITO35,
			DS_LEITO36,
			DS_LEITO37,
			DS_LEITO38,
			DS_LEITO39,
			DS_LEITO40,
			DS_LEITO41,
			DS_LEITO42,
			DS_LEITO43,
			DS_LEITO44,
			DS_LEITO45,
			DS_LEITO46,
			DS_LEITO47,
			DS_LEITO48,
			DS_LEITO49,
			DS_LEITO50,
			DS_LEITO51,
			DS_LEITO52,
			DS_LEITO53,
			DS_LEITO54,
			DS_LEITO55,
			DS_LEITO56,
			DS_LEITO57,
			DS_LEITO58,
			DS_LEITO59,
			DS_LEITO60
		) values (
			cd_setor_atendimento_w,
			vetor_w[1].nm_coluna_w,
			vetor_w[2].nm_coluna_w,
			vetor_w[3].nm_coluna_w,
			vetor_w[4].nm_coluna_w,
			vetor_w[5].nm_coluna_w,
			vetor_w[6].nm_coluna_w,
			vetor_w[7].nm_coluna_w,
			vetor_w[8].nm_coluna_w,
			vetor_w[9].nm_coluna_w,
			vetor_w[10].nm_coluna_w,
			vetor_w[11].nm_coluna_w,
			vetor_w[12].nm_coluna_w,
			vetor_w[13].nm_coluna_w,
			vetor_w[14].nm_coluna_w,
			vetor_w[15].nm_coluna_w,
			vetor_w[16].nm_coluna_w,
			vetor_w[17].nm_coluna_w,
			vetor_w[18].nm_coluna_w,
			vetor_w[19].nm_coluna_w,
			vetor_w[20].nm_coluna_w,
			vetor_w[21].nm_coluna_w,
			vetor_w[22].nm_coluna_w,
			vetor_w[23].nm_coluna_w,
			vetor_w[24].nm_coluna_w,
			vetor_w[25].nm_coluna_w,
			vetor_w[26].nm_coluna_w,
			vetor_w[27].nm_coluna_w,
			vetor_w[28].nm_coluna_w,
			vetor_w[29].nm_coluna_w,
			vetor_w[30].nm_coluna_w,
			vetor_w[31].nm_coluna_w,
			vetor_w[32].nm_coluna_w,
			vetor_w[33].nm_coluna_w,
			vetor_w[34].nm_coluna_w,
			vetor_w[35].nm_coluna_w,
			vetor_w[36].nm_coluna_w,
			vetor_w[37].nm_coluna_w,
			vetor_w[38].nm_coluna_w,
			vetor_w[39].nm_coluna_w,
			vetor_w[40].nm_coluna_w,
			vetor_w[41].nm_coluna_w,
			vetor_w[42].nm_coluna_w,
			vetor_w[43].nm_coluna_w,
			vetor_w[44].nm_coluna_w,
			vetor_w[45].nm_coluna_w,
			vetor_w[46].nm_coluna_w,
			vetor_w[47].nm_coluna_w,
			vetor_w[48].nm_coluna_w,
			vetor_w[49].nm_coluna_w,
			vetor_w[50].nm_coluna_w,
			vetor_w[51].nm_coluna_w,
			vetor_w[52].nm_coluna_w,
			vetor_w[53].nm_coluna_w,
			vetor_w[54].nm_coluna_w,
			vetor_w[55].nm_coluna_w,
			vetor_w[56].nm_coluna_w,
			vetor_w[57].nm_coluna_w,
			vetor_w[58].nm_coluna_w,
			vetor_w[59].nm_coluna_w,
			vetor_w[60].nm_coluna_w
			);

	END LOOP;
	CLOSE c01;
else
	OPEN c03;
	LOOP
	FETCH c03 INTO
		cd_setor_atendimento_w;
	EXIT WHEN NOT FOUND; /* apply on c03 */

		for i in 1..60 loop
			begin
				vetor_w[i].nm_coluna_w := null;
			end;
		end loop;

		i := 1;
		
		/*HTML5 Inicio*/

		insert into w_higienizacao_setor(
			cd_setor_atendimento,
			nm_usuario,
			dt_atualizacao)
		values (cd_setor_atendimento_w,
			obter_usuario_ativo,
			clock_timestamp());
		/*Fim*/
		
		
		OPEN c02;
		LOOP
		FETCH c02 INTO
			ds_ocupacao_w,
			cd_unidade_basica_w,
			cd_unidade_compl_w,
			ie_status_w,
			ie_temporario_w,
			nr_seq_interno_w,
			cd_pessoa_fisica_w;
		EXIT WHEN NOT FOUND; /* apply on c02 */
			begin
			
			
			select	max(NR_SEQ_INTERNO),
				max(nr_atendimento),
				max(IE_STATUS_UNIDADE)
			into STRICT	NR_SEQ_INTERNO_ww,
				nr_atendimento_atual_w,
				ie_status_unidade_w			
			from	unidade_atendimento
			where	cd_setor_atendimento 	= cd_setor_atendimento_w
			and	cd_unidade_basica 	= cd_unidade_basica_w
			and	cd_unidade_compl	= cd_unidade_compl_w;


			select 	max(nr_sequencia)
			into STRICT	nr_seq_unid_atend_w
			from	sl_unid_atend
			where	nr_seq_unidade	= NR_SEQ_INTERNO_ww
			and	trunc(dt_prevista) 	= trunc(clock_timestamp());


			select	max(ie_status_serv),
				coalesce(max(ie_evento),'X')
			into STRICT	ie_status_serv_w,
				ie_evento_w
			from	sl_unid_atend
			where	nr_sequencia = nr_seq_unid_atend_w;

			select	count(*)
			into STRICT	qt_check_list_w
			from	SL_CHECK_LIST_UNID
			where	NR_SEQ_SL_UNID = nr_seq_unid_atend_w;

			select	count(*)
			into STRICT	qt_setor_regra_w
			from	HIGIENIZACAO_SETOR_REGRA
			where	cd_setor_atendimento 	= cd_setor_atendimento_w;

			select	obter_ult_atend_unidade(cd_setor_atendimento_w,cd_unidade_basica_w,cd_unidade_compl_w)
			into STRICT	nr_atendimento_w
			;


			begin
			select	dt_alta,
				dt_saida_real,
				coalesce(ie_paciente_isolado,'N')
			into STRICT	dt_alta_w,
				dt_saida_real_w,
				ie_pac_isolado_w
			from	atendimento_paciente
			where	nr_atendimento = nr_atendimento_w;
				exception when others then
					dt_alta_w	:= null;
					dt_saida_real_w	:= null;
			end;

			select	count(*)
			into STRICT	qt_status_isolado_w
			from 	SL_STATUS_HIGIENIZACAO
			where   ie_status_higienizacao = 'PI';
			
			ds_retorno_w	:= 'L';
			
			ie_todos_previsto_w := Obter_Param_Usuario(75, 53, obter_perfil_ativo, WHEB_USUARIO_PCK.GET_NM_USUARIO, cd_estabelecimento_w, ie_todos_previsto_w);

			if (nr_atendimento_atual_w > 0) and (obter_status_higien_cadastrado('LCP') = 'S') then
				ds_retorno_w	:= 'LCP';
			end if;
			if (dt_alta_w IS NOT NULL AND dt_alta_w::text <> '') and (ie_status_unidade_w = 'A') and (coalesce(dt_saida_real_w::text, '') = '') and (obter_status_higien_cadastrado('ACP') = 'S') then
				ds_retorno_w	:= 'ACP';
			end if;

			if (dt_alta_w IS NOT NULL AND dt_alta_w::text <> '') and (dt_saida_real_w IS NOT NULL AND dt_saida_real_w::text <> '') and (ie_status_serv_w = 'P') and (qt_setor_regra_w = 0) and (ie_evento_w <> 'LL') and (obter_status_higien_cadastrado('ASP') = 'S') then
				ds_retorno_w	:= 'ASP';
			end if;	

			if (ie_status_unidade_w = 'I')  and (obter_status_higien_cadastrado('LI') = 'S') then
				ds_retorno_w	:= 'LI';
			end if;

			if (dt_alta_w IS NOT NULL AND dt_alta_w::text <> '') and (ie_status_serv_w = 'P') and (qt_setor_regra_w > 0) and (ie_evento_w <> 'LL') and (obter_status_higien_cadastrado('LU') = 'S') then
				ds_retorno_w	:= 'LU';
			end if;	
			
			if (dt_alta_w IS NOT NULL AND dt_alta_w::text <> '') and (ie_status_unidade_w = 'G') and
				((ie_status_serv_w = 'P') or (pkg_i18n.get_user_locale = 'en_AU')) and
				((ie_evento_w = 'LL') or (ie_todos_previsto_w = 'S')) and (obter_status_higien_cadastrado('AL') = 'S') then
				ds_retorno_w	:= 'AL';
			end if;	

			if (dt_alta_w IS NOT NULL AND dt_alta_w::text <> '') and (ie_status_unidade_w = 'H') and (ie_status_serv_w = 'EE')  and (obter_status_higien_cadastrado('EM') = 'S') then
				ds_retorno_w	:= 'EM';
			end if;	

			if (dt_alta_w IS NOT NULL AND dt_alta_w::text <> '') and
			--	(dt_saida_real_w is not null) and
				(ie_status_serv_w = 'E') and (qt_check_list_w = 0)  and (obter_status_higien_cadastrado('ACL') = 'S') then
				ds_retorno_w	:= 'ACL';
			end if;	

			if (dt_alta_w IS NOT NULL AND dt_alta_w::text <> '') and
				--(dt_saida_real_w is not null) and
				(ie_status_serv_w = 'A')  and (obter_status_higien_cadastrado('L') = 'S') then
				ds_retorno_w	:= 'L';
				
				
			end if;	
			
			if (coalesce(dt_alta_w::text, '') = '') and (nr_atendimento_atual_w > 0) and (qt_status_isolado_w > 0) and (ie_pac_isolado_w = 'S') and (obter_status_higien_cadastrado('PI') = 'S') then
				ds_retorno_w	:= 'PI';
					
			end if;	
			
			if (ie_status_unidade_w = 'E') and (obter_status_higien_cadastrado('M') = 'S') then
				ds_retorno_w	:= 'M';
			end if;			
			
			ds_concatenado_w	:= 	(ds_ocupacao_w || ';' || cd_unidade_basica_w	|| ';' ||  cd_unidade_compl_w || ';' ||  ie_status_w || ';' || ie_temporario_w  || ';' || nr_seq_interno_w|| ';' || cd_pessoa_fisica_w);
			--ie_status_ww		:=	substr(sl_obter_status_unidade(cd_setor_atendimento_w,cd_unidade_basica_w,cd_unidade_compl_w,sysdate),1,5);
			
			ds_concatenado_ww	:=	replace(ds_concatenado_w,'@ie_status_w',ds_retorno_w);
			
			vetor_w[i].nm_coluna_w	:=	substr(ds_concatenado_ww, 1, 50);		
			i := i + 1;
			ds_concatenado_w	:=	'';
			ds_concatenado_ww	:=	'';
			
			
			/*HTML5 Inicio*/

			insert into w_higienizacao_unidade(	
				cd_setor_atendimento,
				nr_seq_unidade,
				ie_status_higienizacao,
				ds_leito,
				cd_pessoa_fisica,
				nm_usuario,
				dt_atualizacao)
			values (	cd_setor_atendimento_w,
				nr_seq_interno_w,
				ds_retorno_w,
				ds_ocupacao_w,
				cd_pessoa_fisica_w,
				obter_usuario_ativo,
				clock_timestamp());
			/*Fim*/
	
			
			
			end;
		END LOOP;
		CLOSE c02;

		insert into w_higienizacao(
			CD_SETOR_ATENDIMENTO,
			DS_LEITO1,
			DS_LEITO2,
			DS_LEITO3,
			DS_LEITO4,
			DS_LEITO5,
			DS_LEITO6,
			DS_LEITO7,
			DS_LEITO8,
			DS_LEITO9,
			DS_LEITO10,
			DS_LEITO11,
			DS_LEITO12,
			DS_LEITO13,
			DS_LEITO14,
			DS_LEITO15,
			DS_LEITO16,
			DS_LEITO17,
			DS_LEITO18,
			DS_LEITO19,
			DS_LEITO20,
			DS_LEITO21,
			DS_LEITO22,
			DS_LEITO23,
			DS_LEITO24,
			DS_LEITO25,
			DS_LEITO26,
			DS_LEITO27,
			DS_LEITO28,
			DS_LEITO29,
			DS_LEITO30,
			DS_LEITO31,
			DS_LEITO32,
			DS_LEITO33,
			DS_LEITO34,
			DS_LEITO35,
			DS_LEITO36,
			DS_LEITO37,
			DS_LEITO38,
			DS_LEITO39,
			DS_LEITO40,
			DS_LEITO41,
			DS_LEITO42,
			DS_LEITO43,
			DS_LEITO44,
			DS_LEITO45,
			DS_LEITO46,
			DS_LEITO47,
			DS_LEITO48,
			DS_LEITO49,
			DS_LEITO50,
			DS_LEITO51,
			DS_LEITO52,
			DS_LEITO53,
			DS_LEITO54,
			DS_LEITO55,
			DS_LEITO56,
			DS_LEITO57,
			DS_LEITO58,
			DS_LEITO59,
			DS_LEITO60
			) values (
			cd_setor_atendimento_w,
			vetor_w[1].nm_coluna_w,
			vetor_w[2].nm_coluna_w,
			vetor_w[3].nm_coluna_w,
			vetor_w[4].nm_coluna_w,
			vetor_w[5].nm_coluna_w,
			vetor_w[6].nm_coluna_w,
			vetor_w[7].nm_coluna_w,
			vetor_w[8].nm_coluna_w,
			vetor_w[9].nm_coluna_w,
			vetor_w[10].nm_coluna_w,
			vetor_w[11].nm_coluna_w,
			vetor_w[12].nm_coluna_w,
			vetor_w[13].nm_coluna_w,
			vetor_w[14].nm_coluna_w,
			vetor_w[15].nm_coluna_w,
			vetor_w[16].nm_coluna_w,
			vetor_w[17].nm_coluna_w,
			vetor_w[18].nm_coluna_w,
			vetor_w[19].nm_coluna_w,
			vetor_w[20].nm_coluna_w,
			vetor_w[21].nm_coluna_w,
			vetor_w[22].nm_coluna_w,
			vetor_w[23].nm_coluna_w,
			vetor_w[24].nm_coluna_w,
			vetor_w[25].nm_coluna_w,
			vetor_w[26].nm_coluna_w,
			vetor_w[27].nm_coluna_w,
			vetor_w[28].nm_coluna_w,
			vetor_w[29].nm_coluna_w,
			vetor_w[30].nm_coluna_w,
			vetor_w[31].nm_coluna_w,
			vetor_w[32].nm_coluna_w,
			vetor_w[33].nm_coluna_w,
			vetor_w[34].nm_coluna_w,
			vetor_w[35].nm_coluna_w,
			vetor_w[36].nm_coluna_w,
			vetor_w[37].nm_coluna_w,
			vetor_w[38].nm_coluna_w,
			vetor_w[39].nm_coluna_w,
			vetor_w[40].nm_coluna_w,
			vetor_w[41].nm_coluna_w,
			vetor_w[42].nm_coluna_w,
			vetor_w[43].nm_coluna_w,
			vetor_w[44].nm_coluna_w,
			vetor_w[45].nm_coluna_w,
			vetor_w[46].nm_coluna_w,
			vetor_w[47].nm_coluna_w,
			vetor_w[48].nm_coluna_w,
			vetor_w[49].nm_coluna_w,
			vetor_w[50].nm_coluna_w,
			vetor_w[51].nm_coluna_w,
			vetor_w[52].nm_coluna_w,
			vetor_w[53].nm_coluna_w,
			vetor_w[54].nm_coluna_w,
			vetor_w[55].nm_coluna_w,
			vetor_w[56].nm_coluna_w,
			vetor_w[57].nm_coluna_w,
			vetor_w[58].nm_coluna_w,
			vetor_w[59].nm_coluna_w,
			vetor_w[60].nm_coluna_w
			);

	END LOOP;
	CLOSE c03;
end if;

/*HTML5 Inicio*/

delete	FROM w_higienizacao_setor a
where	not exists (SELECT 1 from w_higienizacao_unidade b where a.cd_setor_atendimento = b.cd_setor_atendimento);
/*Fim*/

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_w_higienizacao () FROM PUBLIC;

