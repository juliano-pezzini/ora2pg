-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_esc_framingham_updat_md (ie_sexo_p text, IE_ESC_ORIGINAL_p text, qt_idade_p bigint, qt_colesterol_p bigint, ie_fumante_p text, qt_HDL_p bigint, ie_trat_pas_p text, qt_pa_sistolica_p bigint, IE_DIABETES_p text, qt_pontuacao_p INOUT bigint, qt_risco_p INOUT text ) AS $body$
DECLARE


    qt_ponto_w	 smallint	:= 0;
    qt_risco_w 	 varchar(10);

BEGIN
	--- Inicio MD 1
	if (IE_ESC_ORIGINAL_p = 'N') then
		if ( ie_sexo_p = 'M' ) then
			if (qt_idade_p <= 34) then
				qt_ponto_w := -9;
				
				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 4;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 7;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 9;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 11;
				end if;
				
				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 8;
				end if;
			elsif ( qt_idade_p >= 35 ) and (qt_idade_p <= 39) then
				qt_ponto_w := -4;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 4;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 7;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 9;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 11;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 8;
				end if;
			elsif ( qt_idade_p >= 40 ) and (qt_idade_p <= 44) then
				qt_ponto_w := 0;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 3;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 5;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 6;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 8;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 5;
				end if;
			elsif ( qt_idade_p >= 45 ) and (qt_idade_p <= 49) then
				qt_ponto_w := 3;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 3;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 5;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 6;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 8;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 5;
				end if;
			elsif ( qt_idade_p >= 50 ) and (qt_idade_p <= 54) then
				qt_ponto_w := 6;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 3;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 4;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 5;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 3;
				end if;
			elsif ( qt_idade_p >= 55 ) and (qt_idade_p <= 59) then
				qt_ponto_w := 8;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 3;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 4;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 5;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 3;
				end if;
			elsif ( qt_idade_p >= 60 ) and (qt_idade_p <= 64) then
				qt_ponto_w := 10;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 3;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 1;
				end if;
			elsif ( qt_idade_p >= 65 ) and (qt_idade_p <= 69) then
				qt_ponto_w := 11;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 3;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 1;
				end if;
			elsif ( qt_idade_p >= 70 ) and (qt_idade_p <= 74) then
				qt_ponto_w := 12;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 0;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 0;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 1;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 1;
				end if;
			elsif ( qt_idade_p >= 75 ) then
				qt_ponto_w := 13;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 0;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 0;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 1;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 1;
				end if;
			end if;

			if ( qt_HDL_p >= 60 )  then
				qt_ponto_w := qt_ponto_w + (-1);
			elsif ( qt_HDL_p> 50 ) and (qt_HDL_p<= 59 ) then
				qt_ponto_w := qt_ponto_w + 0;
			elsif ( qt_HDL_p > 40 ) and ( qt_HDL_p <= 49 ) then
				qt_ponto_w := qt_ponto_w + 1;
			elsif (qt_HDL_p<= 40 ) then
				qt_ponto_w := qt_ponto_w + 2;
			end if;
			
			if (ie_trat_pas_p = 'S') then
				if (qt_pa_sistolica_p < 120) then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (qt_pa_sistolica_p >= 120) and (qt_pa_sistolica_p <= 129) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif (qt_pa_sistolica_p >= 130) and (qt_pa_sistolica_p <= 139) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif (qt_pa_sistolica_p >= 140) and (qt_pa_sistolica_p <= 159) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif (qt_pa_sistolica_p >= 160) then
					qt_ponto_w := qt_ponto_w + 3;
				end if;		
			elsif (ie_trat_pas_p = 'N') then
				if (qt_pa_sistolica_p < 120) then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (qt_pa_sistolica_p >= 120) and (qt_pa_sistolica_p <= 129) then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (qt_pa_sistolica_p >= 130) and (qt_pa_sistolica_p <= 139) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif (qt_pa_sistolica_p >= 140) and (qt_pa_sistolica_p <= 159) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif (qt_pa_sistolica_p >= 160) then
					qt_ponto_w := qt_ponto_w + 2;
				end if;
			end if;

			qt_pontuacao_p := qt_ponto_w;

			if (qt_ponto_w < 0 ) then
				qt_risco_w := '<1';
			elsif (qt_ponto_w = 0 ) then
				qt_risco_w := '1';
			elsif (qt_ponto_w =1 ) then
				qt_risco_w := '1';
			elsif (qt_ponto_w = 2 ) then
				qt_risco_w := '1';
			elsif (qt_ponto_w = 3) then
				qt_risco_w := '1';
			elsif (qt_ponto_w = 4 ) then
				qt_risco_w := '1';
			elsif (qt_ponto_w = 5 ) then
				qt_risco_w := '2';
			elsif (qt_ponto_w = 6 ) then
				qt_risco_w := '2';
			elsif (qt_ponto_w = 7 ) then
				qt_risco_w := '3';
			elsif (qt_ponto_w = 8 ) then
				qt_risco_w := '4';
			elsif (qt_ponto_w = 9 ) then
				qt_risco_w := '5';
			elsif (qt_ponto_w = 10 ) then
				qt_risco_w := '6';
			elsif (qt_ponto_w = 11 ) then
				qt_risco_w := '8';
			elsif (qt_ponto_w = 12 ) then
				qt_risco_w := '10';
			elsif (qt_ponto_w = 13 ) then
				qt_risco_w := '12';
			elsif (qt_ponto_w = 14 ) then
				qt_risco_w := '16';
			elsif (qt_ponto_w = 15 ) then
				qt_risco_w := '20';
			elsif (qt_ponto_w = 16 ) then
				qt_risco_w := '25';
			elsif (qt_ponto_w = 17 ) then
				qt_risco_w :=  '>=30';
			elsif (qt_ponto_w = 18 ) then
				qt_risco_w :=  '>=30';
			elsif (qt_ponto_w = 19 ) then
				qt_risco_w :=  '>=30';
			elsif (qt_ponto_w = 20 ) then
				qt_risco_w :=  '>=30';
			elsif (qt_ponto_w = 21 ) then
				qt_risco_w :=  '>=30';
			elsif (qt_ponto_w = 22 ) then
				qt_risco_w :=  '>=30';
			elsif (qt_ponto_w = 23 ) then
				qt_risco_w :=  '>=30';
			elsif (qt_ponto_w = 24 ) then
				qt_risco_w :=  '>=30';
			elsif (qt_ponto_w >= 25 ) then
				qt_risco_w := '>=30';
			end if;	
		end if;

		if ( ie_sexo_p = 'F' ) then
			if (qt_idade_p <= 34) then
				qt_ponto_w := -7;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 4;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 8;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 11;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 13;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 9;
				end if;
			elsif ( qt_idade_p >= 35 ) and (qt_idade_p <= 39) then
				qt_ponto_w := -3;
				
				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 4;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 8;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 11;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 13;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 9;
				end if;
			elsif ( qt_idade_p >= 40 ) and (qt_idade_p <= 44) then
				qt_ponto_w := 0;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 3;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 6;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 8;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 10;
				end if;
				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 7;
				end if;
			elsif ( qt_idade_p >= 45 ) and (qt_idade_p <= 49) then
				qt_ponto_w := 3;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 3;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 6;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 8;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 10;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 7;
				end if;
			elsif ( qt_idade_p >= 50 ) and (qt_idade_p <= 54) then
				qt_ponto_w := 6;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 4;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 5;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 7;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 4;
				end if;
			elsif ( qt_idade_p >= 55 ) and (qt_idade_p <= 59) then
				qt_ponto_w := 8;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 4;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 5;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 7;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 4;
				end if;
			elsif ( qt_idade_p >= 60 ) and (qt_idade_p <= 64) then
				qt_ponto_w := 10;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 3;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 4;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 2;
				end if;
			elsif ( qt_idade_p >= 65 ) and (qt_idade_p <= 69) then
				qt_ponto_w := 12;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 3;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 4;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 2;
				end if;
			elsif ( qt_idade_p >= 70 ) and (qt_idade_p <= 74) then
				qt_ponto_w := 14;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 2;
				end if;

				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 1;
				end if;
			elsif ( qt_idade_p >= 75 ) then
				qt_ponto_w := 16;

				If ( qt_colesterol_p < 160 )  then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif ( qt_colesterol_p >= 280 ) then
					qt_ponto_w := qt_ponto_w + 2;
				end if;
				
				if (ie_fumante_p = 'S' ) then
					qt_ponto_w := qt_ponto_w + 1;
				end if;
			end if;	

			if ( qt_HDL_p >= 60 )  then
				qt_ponto_w := qt_ponto_w + (-1);
			elsif ( qt_HDL_p> 50 ) and (qt_HDL_p<= 59 ) then
				qt_ponto_w := qt_ponto_w + 0;
			elsif ( qt_HDL_p > 40 ) and ( qt_HDL_p <= 49 ) then
				qt_ponto_w := qt_ponto_w + 1;
			elsif (qt_HDL_p<= 40 ) then
				qt_ponto_w := qt_ponto_w + 2;
			end if;

			if (ie_trat_pas_p = 'S') then
				if (qt_pa_sistolica_p < 120) then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (qt_pa_sistolica_p >= 120) and (qt_pa_sistolica_p <= 129) then
					qt_ponto_w := qt_ponto_w + 3;
				elsif (qt_pa_sistolica_p >= 130) and (qt_pa_sistolica_p <= 139) then
					qt_ponto_w := qt_ponto_w + 4;
				elsif (qt_pa_sistolica_p >= 140) and (qt_pa_sistolica_p <= 159) then
					qt_ponto_w := qt_ponto_w + 5;
				elsif (qt_pa_sistolica_p >= 160) then
					qt_ponto_w := qt_ponto_w + 6;
				end if;		
			elsif (ie_trat_pas_p = 'N') then
				if (qt_pa_sistolica_p < 120) then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (qt_pa_sistolica_p >= 120) and (qt_pa_sistolica_p <= 129) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif (qt_pa_sistolica_p >= 130) and (qt_pa_sistolica_p <= 139) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif (qt_pa_sistolica_p >= 140) and (qt_pa_sistolica_p <= 159) then
					qt_ponto_w := qt_ponto_w + 3;
				elsif (qt_pa_sistolica_p >= 160) then
					qt_ponto_w := qt_ponto_w + 4;
				end if;
			end if;
			
			qt_pontuacao_p := qt_ponto_w;

			if (qt_ponto_w <= 0 ) then
				qt_risco_w := '<1';
			elsif (qt_ponto_w =1 ) then
				qt_risco_w := '<1';
			elsif (qt_ponto_w = 2 ) then
				qt_risco_w := '<1';
			elsif (qt_ponto_w = 3) then
				qt_risco_w := '<1';
			elsif (qt_ponto_w = 4 ) then
				qt_risco_w := '<1';
			elsif (qt_ponto_w = 5 ) then
				qt_risco_w := '<1';
			elsif (qt_ponto_w = 6 ) then
				qt_risco_w := '<1';
			elsif (qt_ponto_w = 7 ) then
				qt_risco_w := '<1';
			elsif (qt_ponto_w = 8 ) then
				qt_risco_w := '<1';
			elsif (qt_ponto_w = 9 ) then
				qt_risco_w := '1';
			elsif (qt_ponto_w = 10 ) then
				qt_risco_w := '1';
			elsif (qt_ponto_w = 11 ) then
				qt_risco_w := '1';
			elsif (qt_ponto_w = 12 ) then
				qt_risco_w := '1';
			elsif (qt_ponto_w = 13 ) then
				qt_risco_w := '2';
			elsif (qt_ponto_w = 14 ) then
				qt_risco_w := '2';
			elsif (qt_ponto_w = 15 ) then
				qt_risco_w := '3';
			elsif (qt_ponto_w = 16 ) then
				qt_risco_w := '4';
			elsif (qt_ponto_w = 17 ) then
				qt_risco_w :=  '5';
			elsif (qt_ponto_w = 18 ) then
				qt_risco_w :=  '6';
			elsif (qt_ponto_w = 19 ) then
				qt_risco_w :=  '8';
			elsif (qt_ponto_w = 20 ) then
				qt_risco_w :=  '11';
			elsif (qt_ponto_w = 21 ) then
				qt_risco_w :=  '14';
			elsif (qt_ponto_w = 22 ) then
				qt_risco_w :=  '17';
			elsif (qt_ponto_w = 23 ) then
				qt_risco_w :=  '22';
			elsif (qt_ponto_w = 24 ) then
				qt_risco_w :=  '27';
			elsif (qt_ponto_w >= 25 ) then
				qt_risco_w := '>=30';
			end if;	
		end if;
	else if (IE_ESC_ORIGINAL_p = 'S') then
		if ( ie_sexo_p = 'M' ) then
			qt_ponto_w	:= 0;

			if (qt_idade_p >= 35) and (qt_idade_p <= 39) then
				qt_ponto_w := 2;
			elsif (qt_idade_p >= 40) and (qt_idade_p <= 44) then
				qt_ponto_w := 5;
			elsif (qt_idade_p >= 45) and (qt_idade_p <= 49) then
				qt_ponto_w := 6;
			elsif (qt_idade_p >= 50) and (qt_idade_p <= 54) then
				qt_ponto_w := 8;
			elsif (qt_idade_p >= 55) and (qt_idade_p <= 59) then
				qt_ponto_w := 10;
			elsif (qt_idade_p >= 60) and (qt_idade_p <= 64) then
				qt_ponto_w := 11;
			elsif (qt_idade_p >= 65) and (qt_idade_p <= 69) then
				qt_ponto_w := 12;
			elsif (qt_idade_p >= 70) and (qt_idade_p <= 74) then
				qt_ponto_w := 14;
			elsif (qt_idade_p > 75) then
				qt_ponto_w := 15;
			end if;
			
			If ( qt_colesterol_p < 160 )  then
				qt_ponto_w := qt_ponto_w + 0;
			elsif (  qt_colesterol_p >= 160 ) and ( qt_colesterol_p<= 199 ) then
				qt_ponto_w := qt_ponto_w + 1;
			elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
				qt_ponto_w := qt_ponto_w + 2;
			elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
				qt_ponto_w := qt_ponto_w + 3;
			elsif ( qt_colesterol_p >= 280 ) then
				qt_ponto_w := qt_ponto_w + 4;
			end if;
		
			if ( qt_HDL_p >= 60 )  then
				qt_ponto_w := qt_ponto_w + (-2);
			elsif ( qt_HDL_p>= 50 ) and (qt_HDL_p<= 59 ) then
				qt_ponto_w := qt_ponto_w + (-1);
			elsif ( qt_HDL_p >= 45 ) and ( qt_HDL_p <= 49 ) then
				qt_ponto_w := qt_ponto_w + 0;
			elsif ( qt_HDL_p >= 35 ) and ( qt_HDL_p <= 44 ) then
				qt_ponto_w := qt_ponto_w + 1;
			elsif (qt_HDL_p < 35 ) then
				qt_ponto_w := qt_ponto_w + 2;
			end if;

			if (ie_trat_pas_p = 'S') then
				if (qt_pa_sistolica_p < 120) then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (qt_pa_sistolica_p >= 120) and (qt_pa_sistolica_p <= 129) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif (qt_pa_sistolica_p >= 130) and (qt_pa_sistolica_p <= 139) then
					qt_ponto_w := qt_ponto_w + 3;
				elsif (qt_pa_sistolica_p >= 140) and (qt_pa_sistolica_p <= 159) then
					qt_ponto_w := qt_ponto_w + 4;
				elsif (qt_pa_sistolica_p >= 160) then
					qt_ponto_w := qt_ponto_w + 5;
				end if;		
			elsif (ie_trat_pas_p = 'N') then
				if (qt_pa_sistolica_p < 120) then
					qt_ponto_w := qt_ponto_w - 2;
				elsif (qt_pa_sistolica_p >= 120) and (qt_pa_sistolica_p <= 129) then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (qt_pa_sistolica_p >= 130) and (qt_pa_sistolica_p <= 139) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif (qt_pa_sistolica_p >= 140) and (qt_pa_sistolica_p <= 159) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif (qt_pa_sistolica_p >= 160) then
					qt_ponto_w := qt_ponto_w + 3;
				end if;
			end if;		
			
			if (ie_fumante_p = 'S' ) then
				qt_ponto_w := qt_ponto_w + 4;
			end if;
			if (IE_DIABETES_p = 'S' ) then
				qt_ponto_w := qt_ponto_w + 3;
			end if;
			
			qt_pontuacao_p := qt_ponto_w;		

			if (qt_ponto_w <= -3 ) then
				qt_risco_w := '<1';
			elsif (qt_ponto_w = -2 ) then
				qt_risco_w := '1.1';
			elsif (qt_ponto_w = -1 ) then
				qt_risco_w := '1.4';
			elsif (qt_ponto_w = 0 ) then
				qt_risco_w := '1.6';
			elsif (qt_ponto_w = 1 ) then
				qt_risco_w := '1.9';
			elsif (qt_ponto_w = 2 ) then
				qt_risco_w := '2.3';
			elsif (qt_ponto_w = 3) then
				qt_risco_w := '2.8';
			elsif (qt_ponto_w = 4 ) then
				qt_risco_w := '3.3';
			elsif (qt_ponto_w = 5 ) then
				qt_risco_w := '3.9';
			elsif (qt_ponto_w = 6 ) then
				qt_risco_w := '4.7';
			elsif (qt_ponto_w = 7 ) then
				qt_risco_w := '5.6';
			elsif (qt_ponto_w = 8 ) then
				qt_risco_w := '6.7';
			elsif (qt_ponto_w = 9 ) then
				qt_risco_w := '7.9';
			elsif (qt_ponto_w = 10 ) then
				qt_risco_w := '9.4';
			elsif (qt_ponto_w = 11 ) then
				qt_risco_w := '11.2';
			elsif (qt_ponto_w = 12 ) then
				qt_risco_w := '13.2';
			elsif (qt_ponto_w = 13 ) then
				qt_risco_w := '15.6';
			elsif (qt_ponto_w = 14 ) then
				qt_risco_w := '18.4';
			elsif (qt_ponto_w = 15 ) then
				qt_risco_w := '21.6';
			elsif (qt_ponto_w = 16 ) then
				qt_risco_w := '25.3';
			elsif (qt_ponto_w = 17 ) then
				qt_risco_w :=  '29.4';
			elsif (qt_ponto_w >= 18 ) then
				qt_risco_w :=  '>30';
			end if;	
		end if;

		if ( ie_sexo_p = 'F' ) then
			if (qt_idade_p >= 35) and (qt_idade_p <= 39) then
				qt_ponto_w := 2;
			elsif (qt_idade_p >= 40) and (qt_idade_p <= 44) then			
				qt_ponto_w := 4;		
			elsif (qt_idade_p >= 45) and (qt_idade_p <= 49) then			
				qt_ponto_w := 5;					
			elsif (qt_idade_p >= 50) and (qt_idade_p <= 54) then			
				qt_ponto_w := 7;					
			elsif (qt_idade_p >= 55) and (qt_idade_p <= 59) then			
				qt_ponto_w := 8;					
			elsif (qt_idade_p >= 60) and (qt_idade_p <= 64) then			
				qt_ponto_w := 9;				
			elsif (qt_idade_p >= 65) and (qt_idade_p <= 69) then			
				qt_ponto_w := 10;				
			elsif (qt_idade_p >= 70) and (qt_idade_p <= 74) then			
				qt_ponto_w := 11;				
			elsif (qt_idade_p > 75) then
				qt_ponto_w := 12;
			end if;								
				
			If ( qt_colesterol_p < 160 )  then
				qt_ponto_w := qt_ponto_w + 0;
			elsif (  qt_colesterol_p >=160 ) and ( qt_colesterol_p<= 199 ) then
				qt_ponto_w := qt_ponto_w + 1;
			elsif ( qt_colesterol_p >= 200  ) and ( qt_colesterol_p <= 239 ) then
				qt_ponto_w := qt_ponto_w + 3;
			elsif ( qt_colesterol_p >= 240  ) and ( qt_colesterol_p <= 279 ) then
				qt_ponto_w := qt_ponto_w + 4;
			elsif ( qt_colesterol_p >= 280 ) then
				qt_ponto_w := qt_ponto_w + 5;
			end if;	

			if (ie_fumante_p = 'S' ) then
				qt_ponto_w := qt_ponto_w + 3;
			end if;
			if (IE_DIABETES_p = 'S' ) then
				qt_ponto_w := qt_ponto_w + 4;
			end if;		
				
			if ( qt_HDL_p >= 60 )  then
				qt_ponto_w := qt_ponto_w + (-2);
			elsif ( qt_HDL_p>= 50 ) and (qt_HDL_p<= 59 ) then
				qt_ponto_w := qt_ponto_w + (-1);
			elsif ( qt_HDL_p >= 45 ) and ( qt_HDL_p <= 49 ) then
				qt_ponto_w := qt_ponto_w + 0;
			elsif ( qt_HDL_p >= 35 ) and ( qt_HDL_p <= 44 ) then
				qt_ponto_w := qt_ponto_w + 1;
			elsif (qt_HDL_p < 35 ) then
				qt_ponto_w := qt_ponto_w + 2;
			end if;			
				
			if (ie_trat_pas_p = 'S') then
				if (qt_pa_sistolica_p < 120) then
					qt_ponto_w := qt_ponto_w - 1;
				elsif (qt_pa_sistolica_p >= 120) and (qt_pa_sistolica_p <= 129) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif (qt_pa_sistolica_p >= 130) and (qt_pa_sistolica_p <= 139) then
					qt_ponto_w := qt_ponto_w + 3;
				elsif (qt_pa_sistolica_p >= 140) and (qt_pa_sistolica_p <= 149) then
					qt_ponto_w := qt_ponto_w + 5;
				elsif (qt_pa_sistolica_p >= 150) and (qt_pa_sistolica_p <= 159) then
					qt_ponto_w := qt_ponto_w + 6;				
				elsif (qt_pa_sistolica_p >= 160) then
					qt_ponto_w := qt_ponto_w + 7;
				end if;		
			elsif (ie_trat_pas_p = 'N') then
				if (qt_pa_sistolica_p < 120) then
					qt_ponto_w := qt_ponto_w - 3;
				elsif (qt_pa_sistolica_p >= 120) and (qt_pa_sistolica_p <= 129) then
					qt_ponto_w := qt_ponto_w + 0;
				elsif (qt_pa_sistolica_p >= 130) and (qt_pa_sistolica_p <= 139) then
					qt_ponto_w := qt_ponto_w + 1;
				elsif (qt_pa_sistolica_p >= 140) and (qt_pa_sistolica_p <= 149) then
					qt_ponto_w := qt_ponto_w + 2;
				elsif (qt_pa_sistolica_p >= 150) and (qt_pa_sistolica_p <= 159) then
					qt_ponto_w := qt_ponto_w + 4;				
				elsif (qt_pa_sistolica_p >= 160) then
					qt_ponto_w := qt_ponto_w + 5;
				end if;
			end if;			

			qt_pontuacao_p := qt_ponto_w;

			if (qt_ponto_w <= -2 ) then
				qt_risco_w := '<1';
			elsif (qt_ponto_w = -1 ) then
				qt_risco_w := '1.0';
			elsif (qt_ponto_w = 0 ) then
				qt_risco_w := '1.2';
			elsif (qt_ponto_w = 1 ) then
				qt_risco_w := '1.5';
			elsif (qt_ponto_w = 2 ) then
				qt_risco_w := '1.7';
			elsif (qt_ponto_w = 3) then
				qt_risco_w := '2.0';
			elsif (qt_ponto_w = 4 ) then
				qt_risco_w := '2.4';
			elsif (qt_ponto_w = 5 ) then
				qt_risco_w := '2.8';
			elsif (qt_ponto_w = 6 ) then
				qt_risco_w := '3.3';
			elsif (qt_ponto_w = 7 ) then
				qt_risco_w := '3.9';
			elsif (qt_ponto_w = 8 ) then
				qt_risco_w := '4.5';
			elsif (qt_ponto_w = 9 ) then
				qt_risco_w := '5.3';
			elsif (qt_ponto_w = 10 ) then
				qt_risco_w := '6.3';
			elsif (qt_ponto_w = 11 ) then
				qt_risco_w := '7.3';
			elsif (qt_ponto_w = 12 ) then
				qt_risco_w := '8.6';
			elsif (qt_ponto_w = 13 ) then
				qt_risco_w := '10.0';
			elsif (qt_ponto_w = 14 ) then
				qt_risco_w := '11.7';
			elsif (qt_ponto_w = 15 ) then
				qt_risco_w := '13.7';
			elsif (qt_ponto_w = 16 ) then
				qt_risco_w := '15.9';
			elsif (qt_ponto_w = 17 ) then
				qt_risco_w :=  '18.5';
			elsif (qt_ponto_w = 18 ) then
				qt_risco_w :=  '21.5';
			elsif (qt_ponto_w = 19 ) then
				qt_risco_w :=  '24.8';
			elsif (qt_ponto_w = 20 ) then
				qt_risco_w :=  '28.5';
			elsif (qt_ponto_w >= 21 ) then
				qt_risco_w :=  '>30';
			end if;	
		end if;
	end if;
    end if;

	qt_risco_p := qt_risco_w;
	--- Fim MD 1
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_esc_framingham_updat_md (ie_sexo_p text, IE_ESC_ORIGINAL_p text, qt_idade_p bigint, qt_colesterol_p bigint, ie_fumante_p text, qt_HDL_p bigint, ie_trat_pas_p text, qt_pa_sistolica_p bigint, IE_DIABETES_p text, qt_pontuacao_p INOUT bigint, qt_risco_p INOUT text ) FROM PUBLIC;

