-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_evolucao_acolhimento ( nr_sequencia_p bigint, nm_usuario_p text) AS $body$
DECLARE

				 
				 
				 
-- PARAMETROS GERAIS. 
ds_idade_w				varchar(50);
ds_sexo_w				varchar(1);
				
-- ACOLHIMENTO				 
qt_registro_w			bigint;
cd_pessoa_fisica_w 	atend_escuta_inicial.cd_pessoa_fisica%type;
cd_profissional_w		atend_escuta_inicial.cd_profissional%type;
nr_atendimento_w		atend_escuta_inicial.nr_atendimento%type;
dt_acolhimento_w		atend_escuta_inicial.dt_triagem%type;	
 
-- TIPO EVOLUÇÃO. 
ie_tipo_evolucao_w		usuario.ie_tipo_evolucao%type;

-- SINTOMAS C01 
dt_reg_sintoma_w		ciap_atendimento.dt_registro%type;
nr_sequencia_sintoma_w	ciap_atendimento.nr_sequencia%type;
ds_sintoma_w			varchar(255);
ds_obs_sintoma_w		text;
ie_gerar_sintoma_w		varchar(1) := 'N';

-- SINAIS VITAIS C02 
qt_pa_sistolica_w			atendimento_sinal_vital.qt_pa_sistolica%type;
qt_pa_dialostica_w			atendimento_sinal_vital.qt_pa_diastolica%type;
qt_freq_cardia_w			atendimento_sinal_vital.qt_freq_cardiaca%type;
qt_freq_resp_w			atendimento_sinal_vital.qt_freq_resp%type;
qt_temp_w			atendimento_sinal_vital.qt_temp%type;
qt_peso_w			atendimento_sinal_vital.qt_peso%type;
qt_altura_cm_w		  	atendimento_sinal_vital.qt_altura_cm%type;
qt_glicemia_capilar_w		atendimento_sinal_vital.qt_glicemia_capilar%type;
ds_obs_sv_w		atendimento_sinal_vital.ds_observacao%type;
qt_perimetro_cefalico_w 	atendimento_sinal_vital.qt_perimetro_cefalico%type;
qt_perimetro_toracico_w 	atendimento_sinal_vital.qt_perimetro_toracico%type;
qt_perimitro_abdominal_w 	atendimento_sinal_vital.qt_perimitro_abdominal%type;
ie_dinamica_uteria_w 	atendimento_sinal_vital.ie_dinamica_uterina%type;
qt_au_cm_w 		atendimento_sinal_vital.qt_au_cm%type;
qt_contracoes_w 		atendimento_sinal_vital.qt_contracoes%type;
dt_sinal_vital_w		atendimento_sinal_vital.dt_sinal_vital%type;
ie_gerar_sv_w		varchar(1) := 'N';

-- CLASSIFICAÇÃO DE RISCO. c03 e c04 
nr_seq_triagem_prioridade_w  escuta_inicial_classif.nr_seq_triagem_prioridade%type;
nr_seq_classif_w  		 escuta_inicial_classif.nr_seq_classif%type;
nr_seq_escala_w		 escala_eif_ii.nr_seq_escala%type;
qt_pontos_w		 escala_eif_ii.qt_pontos%type;

ds_prioridade_w				 varchar(2500);
ds_classif_w				 varchar(2500);
ds_resultado_w				 varchar(2500);

ie_gerar_class_risco_w		 varchar(1) := 'N';
ie_utilizar_escala_flex_w	 	 varchar(1) := 'N';

 
-- ENCAMINHAMENTOS. c05 
cd_agenda_w 				atend_encaminhamento.cd_agenda%type;
dt_agenda_w 				atend_encaminhamento.dt_agenda%type;
ie_encaixe_urgencia_w			varchar(5);
nr_seq_agenda_w				atend_encaminhamento.nr_seq_agenda%type;
ds_agenda_w				varchar(2500);
ie_gerar_encaminhamento_w			varchar(1) := 'N';

 
-- EVOLUÇÃO. 
cd_evolucao_w		bigint;
ie_evolucao_clinica_w	tipo_evolucao.cd_tipo_evolucao%type;
cd_prescritor_w		varchar(10);
ds_cabecalho_w		varchar(32000);
ds_tipo_item_w		varchar(80);
ds_conteudo_w		varchar(32000);

ds_fonte_w		varchar(100);
ds_tam_fonte_w		varchar(10);
nr_tam_fonte_w		integer;
ds_rodape_w		 varchar(255);

ds_sintomas_w		varchar(8000) := '';
ds_sinais_vitais_w		varchar(8000) := '';
ds_classif_risco_w 		varchar(8000) := '';
ds_encaminhamento_w	varchar(8000) := '';
ds_evolucao_w		varchar(32000) := '';

c01 CURSOR FOR 
	SELECT distinct   
		dt_registro, 
		substr(obter_desc_ciap(cd_ciap),1,255) ds_sintoma, 
		nr_sequencia 
	from  ciap_atendimento 
	where  nr_seq_escuta = nr_sequencia_p;
	
c02 CURSOR FOR 
	SELECT	qt_pa_sistolica pas, 
		qt_pa_diastolica pad, 
		qt_freq_cardiaca fc, 
		qt_freq_resp fr, 
		qt_temp temp, 
		qt_peso peso, 
		qt_altura_cm altura, 
		qt_glicemia_capilar glic, 
		ds_observacao obs, 
		qt_perimetro_cefalico cefalico, 
		qt_perimetro_toracico toracico, 
		qt_perimitro_abdominal abdominal, 
		ie_dinamica_uterina dinamica, 
		qt_au_cm altura_uterina, 
		qt_contracoes contracoes, 
		dt_sinal_vital 
	from atendimento_sinal_vital 
	where nr_seq_escuta = nr_sequencia_p;
	
	 
c03 CURSOR FOR 
	SELECT nr_seq_triagem_prioridade, 
		  nr_seq_classif 
	from escuta_inicial_classif 
	where	nr_seq_escuta = nr_sequencia_p;
	
 
c04 CURSOR FOR 
	SELECT	nr_seq_escala, 
		qt_pontos 
	from	escala_eif_ii 
	where	nr_seq_escuta = nr_sequencia_p;
	
c05 CURSOR FOR 
	SELECT cd_agenda, 
		dt_agenda, 
		CASE WHEN ie_encaixe_urgencia='S' THEN obter_desc_expressao(719927)  ELSE obter_desc_expressao(327114) END , 
		nr_seq_agenda 
	from atend_encaminhamento 
	where nr_seq_escuta = nr_sequencia_p;
	
 

BEGIN 
 
-- GET NR_ATENDIMENTO AND CD_ESTABELECIMENTO. 
select	coalesce(max(nr_atendimento),0) 
into STRICT	nr_atendimento_w 
from	atend_escuta_inicial 
where	nr_sequencia = nr_sequencia_p;
 
 
ie_utilizar_escala_flex_w := obter_param_usuario(281, 1500, obter_perfil_ativo, nm_usuario_p, wheb_usuario_pck.get_cd_estabelecimento, ie_utilizar_escala_flex_w);
ds_fonte_w := Obter_Param_Usuario(281, 5, obter_perfil_ativo, nm_usuario_p, wheb_usuario_pck.get_cd_estabelecimento, ds_fonte_w);
ds_tam_fonte_w := Obter_Param_Usuario(281, 6, obter_perfil_ativo, nm_usuario_p, wheb_usuario_pck.get_cd_estabelecimento, ds_tam_fonte_w);
nr_tam_fonte_w := somente_numero(ds_tam_fonte_w) * 2;
 
 
select	count(*) 
into STRICT	qt_registro_w 
from	atend_escuta_inicial 
where	nr_sequencia = nr_sequencia_p;
 
 
if (qt_registro_w > 0) then 
 
	select	cd_pessoa_fisica, 
		cd_profissional, 
		nr_atendimento, 
		dt_triagem 
	into STRICT	cd_pessoa_fisica_w, 
		cd_profissional_w, 
		nr_atendimento_w, 
		dt_acolhimento_w 
	from	atend_escuta_inicial 
	where	nr_sequencia = nr_sequencia_p;
 
	select	max(ie_tipo_evolucao) 
	into STRICT	ie_tipo_evolucao_w 
	from	usuario 
	where	nm_usuario = nm_usuario_p;
	 
	ds_idade_w := obter_idade_pf(cd_pessoa_fisica_w,clock_timestamp(),'EI');
	 
	ds_sexo_w := obter_sexo_pf(cd_pessoa_fisica_w,'C');
	 
 
	if (coalesce(ie_tipo_evolucao_w::text, '') = '') then 
		--Tipo de evolução não informado para este usuário. 
		CALL Wheb_mensagem_pck.exibir_mensagem_abort(264634);
	end if;
     
	ds_evolucao_w := ds_evolucao_w 	|| wheb_rtf_pck.get_negrito(true) || obter_desc_expressao(780075) || wheb_rtf_pck.get_negrito(false) ||chr(13)||chr(10);
	 
	select coalesce(max('S'),'N') 
	into STRICT	ie_gerar_sintoma_w 
	from  ciap_atendimento 
	where  nr_seq_escuta = nr_sequencia_p;
	 
	select coalesce(max('S'),'N') 
	into STRICT	ie_gerar_sv_w 
	from  atendimento_sinal_vital 
	where  nr_seq_escuta = nr_sequencia_p;
	 
	select coalesce(max('S'),'N') 
	into STRICT	ie_gerar_encaminhamento_w 
	from  atend_encaminhamento 
	where  nr_seq_escuta = nr_sequencia_p;
	 
	select 	max(CD_TIPO_EVOLUCAO) 
	into STRICT	ie_evolucao_clinica_w 
	from	tipo_evolucao 
	where	ie_evolucao_acolhimento = 'S' 
	and		ie_situacao = 'A';
 
	 
	if (ie_utilizar_escala_flex_w = 'N') then 
	 
		select coalesce(max('S'),'N') 
		into STRICT 	ie_gerar_class_risco_w 
		from 	escuta_inicial_classif 
		where	nr_seq_escuta = nr_sequencia_p;
		 
	elsif (ie_utilizar_escala_flex_w = 'S') then 
	 
		select coalesce(max('S'),'N') 
		into STRICT 	ie_gerar_class_risco_w 
		from 	escuta_inicial_classif 
		where	nr_seq_escuta = nr_sequencia_p;
		 
	end if;
 
	if (ie_gerar_sintoma_w = 'S') then 
	 
		ds_sintomas_w := wheb_rtf_pck.get_negrito(true)|| obter_desc_expressao(298535)||wheb_rtf_pck.get_negrito(false) ||chr(13)||chr(10);
		 
		open c01;
		loop 
		fetch c01 into	 
			dt_reg_sintoma_w, 
			ds_sintoma_w, 
			nr_sequencia_sintoma_w;
		EXIT WHEN NOT FOUND; /* apply on c01 */
			begin 
			if (dt_reg_sintoma_w IS NOT NULL AND dt_reg_sintoma_w::text <> '') then		 
				ds_sintomas_w := ds_sintomas_w || obter_desc_expressao(286754) || ': ' || to_char(dt_reg_sintoma_w,'dd/mm/yyyy hh24:mi:ss') ||chr(13)||chr(10);
			end if;
			 
			if (ds_sintoma_w IS NOT NULL AND ds_sintoma_w::text <> '') then 
				ds_sintomas_w := ds_sintomas_w || obter_desc_expressao(298534) || ': ' || ds_sintoma_w ||chr(13)||chr(10);
			end if;
			 
			select ds_motivo_consulta_long 
			into STRICT ds_obs_sintoma_w 
			from ciap_atendimento 
			where nr_sequencia = nr_sequencia_sintoma_w;
			 
			if (ds_obs_sintoma_w IS NOT NULL AND ds_obs_sintoma_w::text <> '') then 
				ds_sintomas_w := ds_sintomas_w || obter_desc_expressao(287493) || ': ' || ds_obs_sintoma_w ||chr(13)||chr(10);
			end if;
			 
			ds_sintomas_w := ds_sintomas_w || chr(13)||chr(10);
			end;
			 
		end loop;
		close c01;
		 
		ds_evolucao_w := ds_evolucao_w || chr(13)||chr(10);
		ds_evolucao_w := ds_evolucao_w || ds_sintomas_w || chr(13)||chr(10);
 
	end if;
	 
	if (ie_gerar_sv_w = 'S') then 
	 
		ds_evolucao_w := ds_evolucao_w || wheb_rtf_pck.get_negrito(true)|| obter_desc_expressao(497205)||wheb_rtf_pck.get_negrito(false);
		 
		open c02;
		loop 
		fetch c02 into	 
		  qt_pa_sistolica_w, 
		qt_pa_dialostica_w,	 
		qt_freq_cardia_w, 
		qt_freq_resp_w, 
		qt_temp_w, 
		qt_peso_w, 
		qt_altura_cm_w, 
		qt_glicemia_capilar_w, 
		ds_obs_sv_w, 
		qt_perimetro_cefalico_w, 
		qt_perimetro_toracico_w, 
		qt_perimitro_abdominal_w, 
		ie_dinamica_uteria_w, 
		qt_au_cm_w, 
		qt_contracoes_w, 
		dt_sinal_vital_w;
		EXIT WHEN NOT FOUND; /* apply on c02 */
			begin	 
				if (ds_obs_sv_w IS NOT NULL AND ds_obs_sv_w::text <> '') then 
					ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(286507)||': ' || to_char(dt_sinal_vital_w,'dd/mm/yyyy hh24:mi:ss') ||chr(13)||chr(10);
				end if;
				 
				if (qt_pa_sistolica_w IS NOT NULL AND qt_pa_sistolica_w::text <> '') then		 
					ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(295340)||': ' || qt_pa_sistolica_w ||chr(13)||chr(10);
				end if;
				 
				if (qt_pa_dialostica_w IS NOT NULL AND qt_pa_dialostica_w::text <> '') then 
					ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(295182) ||': ' || qt_pa_dialostica_w ||chr(13)||chr(10);
				end if;
				 
				if (qt_freq_cardia_w IS NOT NULL AND qt_freq_cardia_w::text <> '') then 
					ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(290038) ||': ' || qt_freq_cardia_w ||chr(13)||chr(10);
				end if;
				 
				if (qt_freq_resp_w IS NOT NULL AND qt_freq_resp_w::text <> '') then		 
					ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(290454) ||': ' || qt_freq_resp_w ||chr(13)||chr(10);
				end if;
				 
				if (qt_temp_w IS NOT NULL AND qt_temp_w::text <> '') then 
					ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(299184) ||': ' || qt_temp_w ||chr(13)||chr(10);
				end if;
				 
				if (qt_peso_w IS NOT NULL AND qt_peso_w::text <> '') then 
					ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(295734)||': ' || qt_peso_w ||chr(13)||chr(10);
				end if;
				 
				if (qt_altura_cm_w IS NOT NULL AND qt_altura_cm_w::text <> '') then		 
					ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(283402)||': ' || qt_altura_cm_w ||chr(13)||chr(10);
				end if;
				 
				if (qt_glicemia_capilar_w IS NOT NULL AND qt_glicemia_capilar_w::text <> '') then 
					ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(290915)||': ' || qt_glicemia_capilar_w ||chr(13)||chr(10);
				end if;
				 
				if (ds_obs_sv_w IS NOT NULL AND ds_obs_sv_w::text <> '') then 
					ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(294639)||': ' || ds_obs_sv_w ||chr(13)||chr(10);
				end if;
 
				 
				if (ds_idade_w = '1') then 
					if (qt_perimetro_cefalico_w IS NOT NULL AND qt_perimetro_cefalico_w::text <> '') then		 
						ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(295496)||': ' || qt_perimetro_cefalico_w ||chr(13)||chr(10);
					end if;
					 
					if (qt_perimetro_toracico_w IS NOT NULL AND qt_perimetro_toracico_w::text <> '') then 
						ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(295497)||': ' || qt_perimetro_toracico_w ||chr(13)||chr(10);
					end if;
					 
					if (qt_perimitro_abdominal_w IS NOT NULL AND qt_perimitro_abdominal_w::text <> '') then 
						ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(716169)||': ' || qt_perimitro_abdominal_w ||chr(13)||chr(10);
					end if;
				elsif (ds_sexo_w = 'F') then 
					if (ie_dinamica_uteria_w IS NOT NULL AND ie_dinamica_uteria_w::text <> '') then		 
						ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(287953)||': ' || ie_dinamica_uteria_w ||chr(13)||chr(10);
					end if;
					 
					if (qt_au_cm_w IS NOT NULL AND qt_au_cm_w::text <> '') then 
						ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(283415)||': ' || qt_au_cm_w ||chr(13)||chr(10);
					end if;
					 
					if (qt_contracoes_w IS NOT NULL AND qt_contracoes_w::text <> '') then 
						ds_sinais_vitais_w := ds_sinais_vitais_w || obter_desc_expressao(286127)||': ' || qt_contracoes_w ||chr(13)||chr(10);
					end if;
				end if;
			end;
			 
			ds_sinais_vitais_w := ds_sinais_vitais_w ||chr(13)||chr(10);
			 
		end loop;
		close c02;
		 
		ds_evolucao_w := ds_evolucao_w || chr(13)||chr(10);
		ds_evolucao_w := ds_evolucao_w || ds_sinais_vitais_w || chr(13)||chr(10);
 
	end if;
	 
	 
	if (ie_gerar_class_risco_w = 'S') then 
	 
		ds_evolucao_w := ds_evolucao_w 	|| wheb_rtf_pck.get_negrito(true)|| obter_desc_expressao(706546)||wheb_rtf_pck.get_negrito(false);
		 
		if (ie_utilizar_escala_flex_w = 'N') then 
			 
			open c03;
			loop 
			fetch c03 into	 
				nr_seq_triagem_prioridade_w, 
				nr_seq_classif_w;
			EXIT WHEN NOT FOUND; /* apply on c03 */
				begin 
				 
				select substr(obter_desc_triagem(nr_seq_classif_w),1,2500) 
				into STRICT ds_prioridade_w 
				;
				 
				select substr(obter_dados_tcp(nr_seq_triagem_prioridade_w,'DESC'),1,2500) 
				into STRICT ds_classif_w 
				;
								 
				if (ds_classif_w IS NOT NULL AND ds_classif_w::text <> '') then 
					ds_classif_risco_w := ds_classif_risco_w || obter_desc_expressao(285080) ||': ' || ds_classif_w ||chr(13)||chr(10);
				end if;	
					 
				if (ds_prioridade_w IS NOT NULL AND ds_prioridade_w::text <> '') then		 
					ds_classif_risco_w := ds_classif_risco_w || obter_desc_expressao(296328)||': ' || ds_prioridade_w ||chr(13)||chr(10);
				end if;
				 
				ds_classif_risco_w := ds_classif_risco_w ||chr(13)||chr(10);
				end;
			end loop;
			close c03;
			 
			ds_evolucao_w := ds_evolucao_w || chr(13)||chr(10);
			ds_evolucao_w := ds_evolucao_w || ds_classif_risco_w || chr(13)||chr(10);
			 
		elsif (ie_utilizar_escala_flex_w = 'S') then 
 
			 
			open c04;
			loop 
			fetch c04 into	 
				nr_seq_escala_w, 
				qt_pontos_w;
			EXIT WHEN NOT FOUND; /* apply on c04 */
				begin 
				 
				select substr(obter_desc_resul_score_flex_2(qt_pontos_w,nr_seq_escala_w),1,255) 
				into STRICT ds_resultado_w 
				;
		 
				if (ds_resultado_w IS NOT NULL AND ds_resultado_w::text <> '') then 
					ds_classif_risco_w := ds_classif_risco_w || obter_desc_expressao(297817) ||': ' || ds_resultado_w ||chr(13)||chr(10);
				end if;	
					 
				end;
			end loop;
			close c04;
			 
			ds_evolucao_w := ds_evolucao_w || chr(13)||chr(10);
			ds_evolucao_w := ds_evolucao_w || ds_classif_risco_w || chr(13)||chr(10);
			 
		end if;
	end if;
	 
	if (ie_gerar_encaminhamento_w = 'S') then 
		 
		ds_evolucao_w := ds_evolucao_w 	|| wheb_rtf_pck.get_negrito(true)|| obter_desc_expressao(317061)||wheb_rtf_pck.get_negrito(false);
		 
		 
		open c05;
		loop 
		fetch c05 into	 
			cd_agenda_w, 
		dt_agenda_w, 
		ie_encaixe_urgencia_w, 
		nr_seq_agenda_w;
		EXIT WHEN NOT FOUND; /* apply on c05 */
			begin 
				 
				select substr(obter_desc_agenda(cd_agenda_w),1,2500) 
				into STRICT ds_agenda_w 
				;
 
								 
				if (ds_agenda_w IS NOT NULL AND ds_agenda_w::text <> '') then 
					ds_encaminhamento_w := ds_encaminhamento_w || obter_desc_expressao(283242) ||': ' || ds_agenda_w ||chr(13)||chr(10);
				end if;	
					 
				if (dt_agenda_w IS NOT NULL AND dt_agenda_w::text <> '') then		 
					ds_encaminhamento_w := ds_encaminhamento_w || obter_desc_expressao(327181)||': ' || to_char(dt_agenda_w,'dd/mm/yyyy hh24:mi:ss')||chr(13)||chr(10);
				end if;
				 
				if (nr_seq_agenda_w IS NOT NULL AND nr_seq_agenda_w::text <> '') then		 
					ds_encaminhamento_w := ds_encaminhamento_w || obter_desc_expressao(699810)||': ' || nr_seq_agenda_w||chr(13)||chr(10);
				end if;
				 
				if (ie_encaixe_urgencia_w IS NOT NULL AND ie_encaixe_urgencia_w::text <> '') then		 
					ds_encaminhamento_w := ds_encaminhamento_w || obter_desc_expressao(687930)||': ' || ie_encaixe_urgencia_w ||chr(13)||chr(10);
				end if;
				 
				ds_encaminhamento_w := ds_encaminhamento_w || chr(13)||chr(10);
				 
			end;
		end loop;
		close c05;
		 
		ds_evolucao_w := ds_evolucao_w || chr(13)||chr(10);
		ds_evolucao_w := ds_evolucao_w || ds_encaminhamento_w || chr(13)||chr(10);
	end if;
	 
 
	select	nextval('evolucao_paciente_seq') 
	into STRICT	cd_evolucao_w 
	;
	 
	 
	ds_cabecalho_w	:= '{\rtf1\ansi\ansicpg1252\deff0\deflang1046{\fonttbl{\f0\fswiss\fcharset0 '||ds_fonte_w||';}}'|| 
			  '{\*\generator Msftedit 5.41.15.1507;}\viewkind4\uc1\pard\f0\fs'||nr_tam_fonte_w||' ';
			   
	ds_rodape_w	:= '}';
 
	ds_evolucao_w	:= replace(ds_evolucao_w, chr(13)||chr(10), ' \par ');
	ds_conteudo_w := ds_cabecalho_w||ds_evolucao_w||ds_rodape_w;
 
 
 
	if (ie_evolucao_clinica_w IS NOT NULL AND ie_evolucao_clinica_w::text <> '') then 
		insert into evolucao_paciente( 
				cd_evolucao, 
				dt_evolucao, 
				ie_tipo_evolucao, 
				cd_pessoa_fisica, 
				dt_atualizacao, 
				nm_usuario, 
				nr_atendimento, 
				ds_evolucao, 
				cd_medico, 
				dt_liberacao, 
				ie_evolucao_clinica, 
				ie_situacao) 
			values (cd_evolucao_w, 
				clock_timestamp(), 
				ie_tipo_evolucao_w, 
				cd_pessoa_fisica_w, 
				clock_timestamp(), 
				nm_usuario_p, 
				nr_atendimento_w, 
				ds_conteudo_w, 
				cd_profissional_w, 
				clock_timestamp(), 
				ie_evolucao_clinica_w, 
				'A');
 
				commit;
	end if;
end if;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_evolucao_acolhimento ( nr_sequencia_p bigint, nm_usuario_p text) FROM PUBLIC;

