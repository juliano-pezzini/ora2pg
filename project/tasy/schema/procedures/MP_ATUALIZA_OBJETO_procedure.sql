-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE mp_atualiza_objeto ( nr_sequencia_p bigint, qt_topo_p bigint, qt_esquerda_p bigint, qt_altura_p bigint, qt_largura_p bigint, ds_lista_pontos_p text, nm_objeto_p text, nm_usuario_p text) AS $body$
DECLARE


ie_tipo_grupo_w		varchar(255);
nr_seq_processo_ref_w	bigint;


BEGIN

if (nr_sequencia_p IS NOT NULL AND nr_sequencia_p::text <> '') then

	select	c.ie_tipo_grupo,
		a.nr_seq_processo_ref
	into STRICT	ie_tipo_grupo_w,
		nr_seq_processo_ref_w
	from	mp_grupo_objeto c,
		mp_objeto b,
		mp_processo_objeto a
	where	c.nr_sequencia	= b.nr_seq_grupo
	and	b.nr_sequencia	= a.nr_seq_objeto
	and	a.nr_sequencia	= nr_sequencia_p;

	if (ie_tipo_grupo_w = 'F') then

		update	mp_processo_objeto
		set	ds_lista_pontos	= ds_lista_pontos_p
		where	nr_sequencia	= nr_sequencia_p;
	else
		update	mp_processo_objeto
		set	qt_topo		= qt_topo_p,
			qt_esquerda	= qt_esquerda_p,
			qt_altura	= qt_altura_p,
			qt_largura	= qt_largura_p,
			nm_objeto	= coalesce(nm_objeto_p,nm_objeto)
		where	nr_sequencia	= nr_sequencia_p;
	end if;

	CALL mp_atualiza_processo_ref(nr_sequencia_p,nm_usuario_p);

	CALL mp_atualizar_unid_org(nr_sequencia_p,nm_usuario_p);
end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE mp_atualiza_objeto ( nr_sequencia_p bigint, qt_topo_p bigint, qt_esquerda_p bigint, qt_altura_p bigint, qt_largura_p bigint, ds_lista_pontos_p text, nm_objeto_p text, nm_usuario_p text) FROM PUBLIC;

