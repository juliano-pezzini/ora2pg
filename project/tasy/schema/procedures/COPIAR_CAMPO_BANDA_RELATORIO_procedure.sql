-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE copiar_campo_banda_relatorio ( NR_SEQ_BANDA_ORIGEM_P bigint, NR_SEQ_BANDA_DESTINO_P bigint, IE_LIMPA_DESTINO_P text, NM_USUARIO_P text) AS $body$
DECLARE


NR_SEQ_CAMPO_W		bigint := 0;
NR_SEQ_CAMPO_ATUAL_W		bigint := 0;


C02 CURSOR FOR
   SELECT NR_SEQUENCIA
   FROM BANDA_RELAT_CAMPO
   WHERE NR_SEQ_BANDA = NR_SEQ_BANDA_ORIGEM_P;


BEGIN

if (ie_limpa_destino_p = 'S') then
	DELETE FROM BANDA_RELAT_CAMPO
	WHERE NR_SEQ_BANDA	= NR_SEQ_BANDA_DESTINO_P;
end if;

OPEN C02;
LOOP
FETCH C02 INTO NR_SEQ_CAMPO_W;
EXIT WHEN NOT FOUND; /* apply on C02 */
	BEGIN
	SELECT nextval('banda_relat_campo_seq')
	INTO STRICT NR_SEQ_CAMPO_ATUAL_W
	;

	INSERT INTO BANDA_RELAT_CAMPO(NR_SEQUENCIA,
		NR_SEQ_BANDA,
		DS_CAMPO,
		NR_SEQ_APRESENTACAO,
		IE_TIPO_CAMPO,
	 	DT_ATUALIZACAO,
		NM_USUARIO,
		IE_BORDA_SUP,
		IE_BORDA_INF,
		IE_BORDA_ESQ,
	 	IE_BORDA_DIR,
		IE_TOTALIZAR,
		IE_CAMPO_QUEBRA,
		IE_QUEBRA_PAGINA,
		IE_ZERA_APOS_IMPRIMIR,
	 	IE_TRANSPARENTE,
		IE_ALINHAMENTO,
		IE_AJUSTAR_TAMANHO,
		IE_ESTENDER,
		IE_ALINHAR_BANDA,
  	 	QT_ALTURA,
		QT_TAMANHO,
		QT_TOPO,
		QT_ESQUERDA,
		DS_LABEL,
		NM_ATRIBUTO,
		DS_CONTEUDO,
         	DS_EXPRESSAO,
		DS_MASCARA,
		DS_SQL,
		DS_COR_FUNDO,
		QT_TAM_FONTE,
		DS_COR_FONTE,
		DS_TIPO_FONTE,
	 	IE_TIPO_BARCODE,
		IE_HUMANO_BARCODE,
		PR_ALTURA_BARCODE,
		QT_FONTE_BARCODE,
		DS_ESTILO_FONTE,
		DS_COR_LABEL,
		IE_ALTERA_VALOR,
		IE_METODO_ESTENDER)
	(SELECT NR_SEQ_CAMPO_ATUAL_W,
		NR_SEQ_BANDA_DESTINO_P,
		DS_CAMPO,
		NR_SEQ_APRESENTACAO,
		IE_TIPO_CAMPO,
	 	clock_timestamp(),
		NM_USUARIO_P,
		IE_BORDA_SUP,
		IE_BORDA_INF,
		IE_BORDA_ESQ,
	 	IE_BORDA_DIR,
		IE_TOTALIZAR,
		IE_CAMPO_QUEBRA,
		IE_QUEBRA_PAGINA,
		IE_ZERA_APOS_IMPRIMIR,
	 	IE_TRANSPARENTE,
		IE_ALINHAMENTO,
		IE_AJUSTAR_TAMANHO,
		IE_ESTENDER,
		IE_ALINHAR_BANDA,
  	 	QT_ALTURA,
		QT_TAMANHO,
		QT_TOPO,
		QT_ESQUERDA,
		DS_LABEL,
		NM_ATRIBUTO,
		DS_CONTEUDO,
         	DS_EXPRESSAO,
		DS_MASCARA,
		DS_SQL,
		DS_COR_FUNDO,
		QT_TAM_FONTE,
		DS_COR_FONTE,
		DS_TIPO_FONTE,
	 	IE_TIPO_BARCODE,
		IE_HUMANO_BARCODE,
		PR_ALTURA_BARCODE,
		QT_FONTE_BARCODE,
		DS_ESTILO_FONTE,
		DS_COR_LABEL,
		IE_ALTERA_VALOR,
		IE_METODO_ESTENDER
	 FROM BANDA_RELAT_CAMPO
	 WHERE NR_SEQUENCIA = NR_SEQ_CAMPO_W);


	 insert into banda_relat_campo_longo(
		   nr_sequencia,
		   nr_seq_banda_relat_campo,
		   dt_atualizacao,
		   nm_usuario,
		   dt_atualizacao_nrec,
		   nm_usuario_nrec,
		   ds_conteudo)
	 SELECT nextval('banda_relat_campo_longo_seq'),
		   nr_seq_campo_atual_w,
		   dt_atualizacao,
		   nm_usuario,
		   dt_atualizacao_nrec,
		   nm_usuario_nrec,
		   ds_conteudo
	 from  banda_relat_campo_longo
	where  nr_seq_banda_relat_campo = nr_seq_campo_w;


	END;
END LOOP;
CLOSE C02;

COMMIT;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE copiar_campo_banda_relatorio ( NR_SEQ_BANDA_ORIGEM_P bigint, NR_SEQ_BANDA_DESTINO_P bigint, IE_LIMPA_DESTINO_P text, NM_USUARIO_P text) FROM PUBLIC;

