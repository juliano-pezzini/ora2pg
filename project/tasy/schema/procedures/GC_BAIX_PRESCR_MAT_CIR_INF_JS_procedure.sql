-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gc_baix_prescr_mat_cir_inf_js ( nr_prescricao_p bigint, nr_cirurgia_p bigint, nm_usuario_p text, cd_estabelecimento_p bigint, cd_perfil_p bigint, cd_setor_atendimento_p bigint, cd_local_estoque_p INOUT bigint, ds_kit_p INOUT text, ds_perg_kit_nao_devol_p INOUT text, ds_perg_atend_item_prescr_p INOUT text, ds_perg_baixar_materiais_p INOUT text, ds_mens_atend_prescr_p INOUT text, ds_mens_nao_passagem_cc_p INOUT text, nr_seq_atepacu_p INOUT bigint, cd_local_prescr_matcir_p INOUT bigint ) AS $body$
DECLARE

 
ds_kit_w						varchar(255);
ds_perg_kit_nao_devol_w 		varchar(255);
ds_perg_atend_item_prescr_w 	varchar(255);
ds_perg_baixar_materiais_w 		varchar(255);
ds_mens_atend_prescr_w 		varchar(255);
ds_mens_nao_passagem_cc_w	varchar(255);
cd_local_estoque_w		smallint;
cd_local_prescr_matcir_w		bigint;
nr_seq_atepacu_w			varchar(10);
	

BEGIN 
 
ds_perg_kit_nao_devol_w 		:= substr(obter_texto_tasy(51244, philips_param_pck.get_nr_seq_idioma),1,255);
 
ds_perg_atend_item_prescr_w	:= substr(obter_texto_tasy(51241, philips_param_pck.get_nr_seq_idioma),1,255);
 
ds_perg_baixar_materiais_w 		:= substr(obter_texto_tasy(51243, philips_param_pck.get_nr_seq_idioma),1,255);
 
ds_mens_atend_prescr_w		:= substr(obter_texto_tasy(51242, philips_param_pck.get_nr_seq_idioma),1,255);
 
ds_mens_nao_passagem_cc_w	:= substr(obter_texto_tasy(51245, philips_param_pck.get_nr_seq_idioma),1,255);
 
ds_kit_w				:= substr(obter_se_mat_kit_devolucao(nr_prescricao_p),1,255);
 
cd_local_estoque_w 		:= cd_local_estoque_p;
 
if (nr_cirurgia_p IS NOT NULL AND nr_cirurgia_p::text <> '') then 
	begin 
	nr_seq_atepacu_w := obter_unid_setor_cirurgia(nr_cirurgia_p,'N');
	end;
end if;
 
if ((nr_seq_atepacu_w IS NOT NULL AND nr_seq_atepacu_w::text <> '') and trim(both nr_seq_atepacu_w) <> '') then 
	cd_local_prescr_matcir_w	:= obter_local_prescr_matcirurgia(nr_cirurgia_p,nr_prescricao_p,cd_local_estoque_w,nr_seq_atepacu_w,nm_usuario_p,cd_perfil_p,cd_setor_atendimento_p);
end if;
 
 
ds_kit_p				:= ds_kit_w;
ds_perg_kit_nao_devol_p 		:= ds_perg_kit_nao_devol_w;
ds_perg_atend_item_prescr_p		:= ds_perg_atend_item_prescr_w;
ds_perg_baixar_materiais_p 		:= ds_perg_baixar_materiais_w;
ds_mens_atend_prescr_p 		:= ds_mens_atend_prescr_w;
ds_mens_nao_passagem_cc_p	:= ds_mens_nao_passagem_cc_w;
cd_local_estoque_p		:= cd_local_estoque_w;
nr_seq_atepacu_p			:= nr_seq_atepacu_w;
cd_local_prescr_matcir_p		:= cd_local_prescr_matcir_w;
 
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gc_baix_prescr_mat_cir_inf_js ( nr_prescricao_p bigint, nr_cirurgia_p bigint, nm_usuario_p text, cd_estabelecimento_p bigint, cd_perfil_p bigint, cd_setor_atendimento_p bigint, cd_local_estoque_p INOUT bigint, ds_kit_p INOUT text, ds_perg_kit_nao_devol_p INOUT text, ds_perg_atend_item_prescr_p INOUT text, ds_perg_baixar_materiais_p INOUT text, ds_mens_atend_prescr_p INOUT text, ds_mens_nao_passagem_cc_p INOUT text, nr_seq_atepacu_p INOUT bigint, cd_local_prescr_matcir_p INOUT bigint ) FROM PUBLIC;

