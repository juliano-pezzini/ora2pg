-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE intpd_batch_gerar_drg () AS $body$
DECLARE

reg_integracao_p    gerar_int_padrao.reg_integracao;
nr_sequencia_episodio_w episodio_paciente.nr_sequencia%type;

c01 CURSOR FOR 
SELECT ep.nr_sequencia 
from  episodio_paciente ep 
where coalesce(ep.ie_status, 'X') <> 'T' 
and  exists (SELECT 1 
	    from  atendimento_paciente ap 
        where ap.ie_tipo_atendimento = 1 
        and  ap.nr_seq_episodio = ep.nr_sequencia);

BEGIN
open c01;
loop 
	fetch c01 into nr_sequencia_episodio_w;
	EXIT WHEN NOT FOUND; /* apply on c01 */
		begin 
		reg_integracao_p := gerar_int_padrao.gravar_integracao('64', nr_sequencia_episodio_w, 'Tasy', reg_integracao_p);
		end;		
end loop;
close c01;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE intpd_batch_gerar_drg () FROM PUBLIC;

