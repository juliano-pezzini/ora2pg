-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE hd_retirar_concentrado_dialise ( nr_seq_dialise_p bigint, nm_usuario_p text, ie_assinar_p text default 'S') AS $body$
DECLARE

 
 
nr_seq_maquina_w	bigint;
nr_seq_ponto_acesso_w	bigint;
						
C01 CURSOR FOR 
	SELECT	distinct nr_seq_maquina, 
		nr_seq_ponto_acesso 
	from	hd_dialise_concentrado 
	where	nr_seq_dialise = nr_seq_dialise_p 
	and	coalesce(dt_retirada::text, '') = '' 
	order by 1;

BEGIN
 
if (nr_seq_dialise_p IS NOT NULL AND nr_seq_dialise_p::text <> '') then 
 
	open C01;
	loop 
	fetch C01 into	 
		nr_seq_maquina_w, 
		nr_seq_ponto_acesso_w;
	EXIT WHEN NOT FOUND; /* apply on C01 */
		begin 
 
		CALL hd_retirar_concentrado(nr_seq_maquina_w, 
					nr_seq_ponto_acesso_w, 
					nm_usuario_p, 
					ie_assinar_p);
		 
		end;
	end loop;
	close C01;
 
end if;
			 
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE hd_retirar_concentrado_dialise ( nr_seq_dialise_p bigint, nm_usuario_p text, ie_assinar_p text default 'S') FROM PUBLIC;

