-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE sus_gerar_w_esus_cad_ind ( nr_seq_lote_p esus_lote_envio.nr_sequencia%type, ie_tipo_lote_esus_p esus_lote_envio.ie_tipo_lote_esus%type, cd_cnes_estab_p estabelecimento.cd_cns%type, nm_usuario_p usuario.nm_usuario%type) AS $body$
DECLARE


cd_cns_paciente_w		w_esus_cad_individual.cd_cns_paciente%type;				
dt_nascimento_paciente_w	w_esus_cad_individual.dt_nascimento_paciente%type;					

cd_cns_profissional_w		w_esus_cad_individual.cd_cns_profissional%type;
nr_seq_exp_w			w_esus_cad_individual.nr_sequencia%type;
cd_uuid_original_w		w_esus_cad_individual.cd_uuid_original%type;
cd_uuid_atualiza_w		w_esus_cad_individual.cd_uuid_atualiza%type;

nr_sequencia_w			esus_cad_individual.nr_sequencia%type;
cd_estabelecimento_w            esus_cad_individual.cd_estabelecimento%type;
dt_atualizacao_w		esus_cad_individual.dt_atualizacao%type;
nm_usuario_w			esus_cad_individual.nm_usuario%type;
dt_atualizacao_nrec_w		esus_cad_individual.dt_atualizacao_nrec%type;
nm_usuario_nrec_w		esus_cad_individual.nm_usuario_nrec%type;
cd_pessoa_fisica_w		esus_cad_individual.cd_pessoa_fisica%type;
dt_liberacao_w			esus_cad_individual.dt_liberacao%type;
cd_profissional_w		esus_cad_individual.cd_profissional%type;
cd_cbo_paciente_w		esus_cad_individual.cd_cbo_paciente%type;
cd_cnes_unidade_w		esus_cad_individual.cd_cnes_unidade%type;
cd_cnes_unidade_ww		esus_cad_individual.cd_cnes_unidade%type;
nr_seq_sus_equipe_w		esus_cad_individual.nr_seq_sus_equipe%type;
dt_atendimento_w		esus_cad_individual.dt_atendimento%type;
ds_micro_area_w			esus_cad_individual.ds_micro_area%type;
cd_pessoa_responsavel_w		esus_cad_individual.cd_pessoa_responsavel%type;
ie_resp_adolecente_w		esus_cad_individual.ie_resp_adolecente%type;
ie_resp_creche_w		esus_cad_individual.ie_resp_creche%type;
ie_resp_outra_crian_w		esus_cad_individual.ie_resp_outra_crian%type;
ie_resp_outro_w			esus_cad_individual.ie_resp_outro%type;
ie_resp_sozinha_w		esus_cad_individual.ie_resp_sozinha%type;

ie_resp_familiar_w		w_esus_cad_individual.ie_resp_familiar%type;
ie_relacao_resp_w		w_esus_cad_individual.ie_relacao_resp%type;
ie_frequenta_escola_w		w_esus_cad_individual.ie_frequenta_escola%type;
ie_curso_frequentado_w		w_esus_cad_individual.ie_curso_frequentado%type;
ie_situacao_merc_trab_w		w_esus_cad_individual.ie_situacao_merc_trab%type;
ie_resp_crianca_w		w_esus_cad_individual.ie_resp_crianca%type;
ie_freq_cuidador_w		w_esus_cad_individual.ie_freq_cuidador%type;
ie_partic_grupo_com_w		w_esus_cad_individual.ie_partic_grupo_com%type;
ie_plano_saude_w		w_esus_cad_individual.ie_plano_saude%type;
ie_membro_povo_com_w		w_esus_cad_individual.ie_membro_povo_com%type;
ds_povo_comunidade_w		w_esus_cad_individual.ds_povo_comunidade%type;
ie_inf_orient_sexual_w		w_esus_cad_individual.ie_inf_orient_sexual%type;
ie_orient_sexual_w		w_esus_cad_individual.ie_orient_sexual%type;
ie_deficiente_w			w_esus_cad_individual.ie_deficiente%type;
ie_def_auditiva_w		w_esus_cad_individual.ie_def_auditiva%type;
ie_saida_cadastro_w		w_esus_cad_individual.ie_saida_cadastro%type;
ie_gestante_w			w_esus_cad_individual.ie_gestante%type;
ds_maternidade_ref_w		w_esus_cad_individual.ds_maternidade_ref%type;
ie_situacao_peso_w		w_esus_cad_individual.ie_situacao_peso%type;
ie_fumante_w			w_esus_cad_individual.ie_fumante%type;
ie_alcoolatra_w			w_esus_cad_individual.ie_alcoolatra%type;
ie_usa_drogas_w			w_esus_cad_individual.ie_usa_drogas%type;
ie_hipertenso_w			w_esus_cad_individual.ie_hipertenso%type;
ie_diabetico_w			w_esus_cad_individual.ie_diabetico%type;
ie_avc_derrame_w		w_esus_cad_individual.ie_avc_derrame%type;
ie_infarto_w			w_esus_cad_individual.ie_infarto%type;
ie_cardiaco_w			w_esus_cad_individual.ie_cardiaco%type;
ie_doenca_cardiaca_w		w_esus_cad_individual.ie_doenca_cardiaca%type;
ie_problema_renal_w		w_esus_cad_individual.ie_problema_renal%type;
ie_doenca_renal_w		w_esus_cad_individual.ie_doenca_renal%type;
ie_prob_respiratorio_w		w_esus_cad_individual.ie_prob_respiratorio%type;
ie_doenca_respi_asma_w		w_esus_cad_individual.ie_doenca_respi_asma%type;
ie_hanseniase_w			w_esus_cad_individual.ie_hanseniase%type;
ie_tuberculose_w		w_esus_cad_individual.ie_tuberculose%type;
ie_cancer_w			w_esus_cad_individual.ie_cancer%type;
ie_internacao_w			w_esus_cad_individual.ie_internacao%type;
ds_motivo_internacao_w		w_esus_cad_individual.ds_motivo_internacao%type;
ie_prob_mental_w		w_esus_cad_individual.ie_prob_mental%type;
ie_acamado_w			w_esus_cad_individual.ie_acamado%type;
ie_domiciliado_w		w_esus_cad_individual.ie_domiciliado%type;
ie_planta_medicinal_w		w_esus_cad_individual.ie_planta_medicinal%type;
ds_planta_medicinal_w		w_esus_cad_individual.ds_planta_medicinal%type;
ie_prat_integ_compl_w		w_esus_cad_individual.ie_prat_integ_compl%type;
ds_pri_cond_saude_w		w_esus_cad_individual.ds_pri_cond_saude%type;
ds_seg_cond_saude_w		w_esus_cad_individual.ds_seg_cond_saude%type;
ds_ter_cond_saude_w		w_esus_cad_individual.ds_ter_cond_saude%type;
ie_situacao_rua_w		w_esus_cad_individual.ie_situacao_rua%type;
ie_tempo_sit_rua_w		w_esus_cad_individual.ie_tempo_sit_rua%type;
ie_acomp_outra_inst_w		w_esus_cad_individual.ie_acomp_outra_inst%type;
ds_instit_acompanha_w		w_esus_cad_individual.ds_instit_acompanha%type;
ie_recebe_beneficio_w		w_esus_cad_individual.ie_recebe_beneficio%type;
ie_visita_familiar_w		w_esus_cad_individual.ie_visita_familiar%type;
ds_grau_parentesco_w		w_esus_cad_individual.ds_grau_parentesco%type;
ie_ref_familiar_w		w_esus_cad_individual.ie_ref_familiar%type;
ie_alimentacao_dia_w		w_esus_cad_individual.ie_alimentacao_dia%type;
ie_orig_ali_rest_pop_w		w_esus_cad_individual.ie_orig_ali_rest_pop%type;
ie_higiene_pessoal_w		w_esus_cad_individual.ie_higiene_pessoal%type;
ie_banho_w			w_esus_cad_individual.ie_banho%type;
ie_acesso_sanitario_w		w_esus_cad_individual.ie_acesso_sanitario%type;
ie_higiene_bucal_w		w_esus_cad_individual.ie_higiene_bucal%type;
ie_outra_higiene_w		w_esus_cad_individual.ie_outra_higiene%type;
ie_termo_recusa_w		w_esus_cad_individual.ie_termo_recusa%type;
nr_seq_lote_envio_w		w_esus_cad_individual.nr_seq_lote_envio%type;
ie_deficiente_visual_w		w_esus_cad_individual.ie_deficiente_visual%type;
ie_def_intelec_cogni_w		w_esus_cad_individual.ie_def_intelec_cogni%type;
ie_deficiente_fisico_w		w_esus_cad_individual.ie_deficiente_fisico%type;
ie_outra_deficiencia_w		w_esus_cad_individual.ie_outra_deficiencia%type;
ie_doe_res_dpoc_enfi_w		w_esus_cad_individual.ie_doe_res_dpoc_enfi%type;
ie_doenca_resp_outro_w		w_esus_cad_individual.ie_doenca_resp_outro%type;
ie_doen_res_nao_sabe_w		w_esus_cad_individual.ie_doen_res_nao_sabe%type;
ie_ori_ali_doac_rest_w		w_esus_cad_individual.ie_ori_ali_doac_rest%type;
ie_origem_alim_outro_w		w_esus_cad_individual.ie_origem_alim_outro%type;
ie_ori_ali_doa_grupo_w		w_esus_cad_individual.ie_ori_ali_doa_grupo%type;
ie_orig_alim_doa_pop_w		w_esus_cad_individual.ie_orig_alim_doa_pop%type;
ie_outra_doe_card_w		w_esus_cad_individual.ie_outra_doe_card%type;
ie_nao_sab_doe_car_w		w_esus_cad_individual.ie_nao_sab_doe_car%type;
ie_outra_doe_ren_w		w_esus_cad_individual.ie_outra_doe_ren%type;
ie_nao_sabe_doe_ren_w		w_esus_cad_individual.ie_nao_sabe_doe_ren%type;
cd_etnia_w			w_esus_cad_individual.cd_etnia%type;
nm_pai_pessoa_fisica_w		w_esus_cad_individual.nm_pai_pessoa_fisica%type;
ie_desconhece_pai_w		w_esus_cad_individual.ie_desconhece_pai%type;
dt_naturalizacao_w		w_esus_cad_individual.dt_naturalizacao%type;
dt_entrada_brasil_w		w_esus_cad_individual.dt_entrada_brasil%type;
nr_data_naturalizacao_w		w_esus_cad_individual.nr_data_naturalizacao%type;
nr_data_atendimento_w		w_esus_cad_individual.nr_data_atendimento%type;
nr_data_nasc_paciente_w		w_esus_cad_individual.nr_data_nasc_paciente%type;
nr_port_naturalizacao_w		w_esus_cad_individual.nr_port_naturalizacao%type;
nr_data_entra_brasil_w		w_esus_cad_individual.nr_data_entra_brasil%type;
cd_micro_area_w			w_esus_cad_individual.cd_micro_area%type;
ie_fora_area_w			w_esus_cad_individual.ie_fora_area%type;
ie_inf_ident_genero_w		w_esus_cad_individual.ie_inf_ident_genero%type;
ie_identidade_genero_w		w_esus_cad_individual.ie_identidade_genero%type;
dt_obito_w			w_esus_cad_individual.dt_obito%type;
nr_certidao_obito_w		w_esus_cad_individual.nr_certidao_obito%type;
nr_data_obito_w			w_esus_cad_individual.nr_data_obito%type;
cd_cbo_profissional_w		w_esus_cad_individual.cd_cbo_profissional%type;
cd_cns_resp_familia_w		w_esus_cad_individual.cd_cns_resp_familia%type;
ie_sexo_paciente_w		w_esus_cad_individual.ie_sexo_paciente%type;

ie_raca_cor_pac_w		varchar(255);
nm_pessoa_fisica_w 		varchar(255);
nm_social_pes_fis_w		varchar(255);
cd_municipo_ibge_w		varchar(255);
cd_munic_ibge_pf_w		varchar(255);
cd_nascionalidade_w		varchar(255);
nr_pis_pessoa_fisic_w	varchar(255);
ie_desconhece_mae_w 	varchar(255);
ds_email_pes_fisic_w	varchar(255);
cd_tipo_logradouro_w	varchar(255);
nm_logradouro_w			varchar(255);
nr_logradouro_w			varchar(255);
ds_complemento_log_w	varchar(255);
ds_bairro_w				varchar(255);
cd_uf_logradouro_w		varchar(255);
cd_cep_logradouro_w		varchar(255);
nr_telefone_resid_w		varchar(255);
nr_telefone_refer_w		varchar(255);
ie_sem_numero_log_w		varchar(255);
nr_telefone_celul_w		varchar(255);
nm_pais_nascimento_w			varchar(255);		
nm_mae_pessoa_fisica_w				varchar(255);	
ie_atualizada_w				varchar(255);	
qt_idade_pac_w			bigint;

cd_contra_chave_rem_w		w_esus_header_footer.cd_contra_chave_rem%type;
cd_uuid_instal_rem_w		w_esus_header_footer.cd_uuid_instal_rem%type;
cd_contra_chave_ori_w		w_esus_header_footer.cd_contra_chave_ori%type;
cd_uuid_instal_orig_w		w_esus_header_footer.cd_uuid_instal_orig%type;
cd_municipio_ibge_ww		w_esus_header_footer.cd_municipio_ibge%type;

CadInd CURSOR FOR
	SELECT 	nr_sequencia,
		cd_estabelecimento,
		dt_atualizacao,
		nm_usuario,
		dt_atualizacao_nrec,
		nm_usuario_nrec,
		cd_pessoa_fisica,
		dt_liberacao,
		cd_profissional,
		cd_cbo_paciente,
		cd_cnes_unidade,
		nr_seq_sus_equipe,
		dt_atendimento,
		ie_resp_familiar,
		ie_relacao_resp,
		ie_frequenta_escola,
		ie_curso_frequentado,
		ie_situacao_merc_trab,
		ie_resp_crianca,
		ie_freq_cuidador,
		ie_partic_grupo_com,
		ie_plano_saude,
		ie_membro_povo_com,
		ds_povo_comunidade,
		ie_inf_orient_sexual,
		ie_orient_sexual,
		ie_deficiente,
		ie_def_auditiva,
		ie_saida_cadastro,
		ie_gestante,
		ds_maternidade_ref,
		ie_situacao_peso,
		ie_fumante,
		ie_alcoolatra,
		ie_usa_drogas,
		ie_hipertenso,
		ie_diabetico,
		ie_avc_derrame,
		ie_infarto,
		ie_cardiaco,
		ie_doenca_cardiaca,
		ie_problema_renal,
		ie_doenca_renal,
		ie_prob_respiratorio,
		ie_doenca_respi_asma,
		ie_hanseniase,
		ie_tuberculose,
		ie_cancer,
		ie_internacao,
		ds_motivo_internacao,
		ie_prob_mental,
		ie_acamado,
		ie_domiciliado,
		ie_planta_medicinal,
		ds_planta_medicinal,
		ie_prat_integ_compl,
		ds_pri_cond_saude,
		ds_seg_cond_saude,
		ds_ter_cond_saude,
		ie_situacao_rua,
		ie_tempo_sit_rua,
		ie_acomp_outra_inst,
		ds_instit_acompanha,
		ie_recebe_beneficio,
		ie_visita_familiar,
		ds_grau_parentesco,
		ie_ref_familiar,
		ie_alimentacao_dia,
		ie_orig_ali_rest_pop,
		ie_higiene_pessoal,
		ie_banho,
		ie_acesso_sanitario,
		ie_higiene_bucal,
		ie_outra_higiene,
		ie_termo_recusa,
		nr_seq_lote_envio,
		ie_deficiente_visual,
		ie_def_intelec_cogni,
		ie_deficiente_fisico,
		ie_outra_deficiencia,
		ie_doe_res_dpoc_enfi,
		ie_doenca_resp_outro,
		ie_doen_res_nao_sabe,
		ie_ori_ali_doac_rest,
		ie_origem_alim_outro,
		ie_ori_ali_doa_grupo,
		ie_orig_alim_doa_pop,
		cd_uuid_original,
		ie_outra_doe_card,
		ie_nao_sab_doe_car,
		ie_outra_doe_ren,
		ie_nao_sabe_doe_ren,
		cd_cbo_profissional,
		ds_micro_area,
		ie_fora_area,
		cd_pessoa_responsavel,
		ie_resp_adolecente,
		ie_resp_creche,
		ie_resp_outra_crian,
		ie_resp_outro,
		ie_resp_sozinha
	from	esus_cad_individual
	where	nr_seq_lote_envio = nr_seq_lote_p
	order by nr_sequencia;

type 		fetch_array is table of CadInd%rowtype;
s_array 	fetch_array;
i		integer := 1;
type vetor is table of fetch_array index by integer;
vetor_CadInd_w			vetor;

	
BEGIN

delete 	from w_esus_cad_individual
where	nr_seq_lote_envio = nr_seq_lote_p;


open CadInd;
loop
fetch CadInd bulk collect into s_array limit 1000;
	vetor_CadInd_w(i) := s_array;
	i := i + 1;
EXIT WHEN NOT FOUND; /* apply on CadInd */
end loop;
close CadInd;


for i in 1..vetor_CadInd_w.count loop
	begin
	s_array := vetor_CadInd_w(i);
	for z in 1..s_array.count loop
		begin
		
		nr_sequencia_w				:= s_array[z].nr_sequencia;
		cd_estabelecimento_w			:= s_array[z].cd_estabelecimento;
		dt_atualizacao_w			:= s_array[z].dt_atualizacao;
		nm_usuario_w				:= s_array[z].nm_usuario;
		dt_atualizacao_nrec_w			:= s_array[z].dt_atualizacao_nrec;
		nm_usuario_nrec_w			:= s_array[z].nm_usuario_nrec;
		cd_pessoa_fisica_w			:= s_array[z].cd_pessoa_fisica;
		dt_liberacao_w				:= s_array[z].dt_liberacao;
		cd_profissional_w			:= s_array[z].cd_profissional;
		cd_cbo_paciente_w			:= s_array[z].cd_cbo_paciente;
		cd_cnes_unidade_w			:= s_array[z].cd_cnes_unidade;
		nr_seq_sus_equipe_w			:= s_array[z].nr_seq_sus_equipe;
		dt_atendimento_w			:= s_array[z].dt_atendimento;
		ie_resp_familiar_w			:= s_array[z].ie_resp_familiar;
		ie_relacao_resp_w			:= s_array[z].ie_relacao_resp;
		ie_frequenta_escola_w			:= s_array[z].ie_frequenta_escola;
		ie_curso_frequentado_w			:= s_array[z].ie_curso_frequentado;
		ie_situacao_merc_trab_w			:= s_array[z].ie_situacao_merc_trab;
		ie_resp_crianca_w			:= s_array[z].ie_resp_crianca;
		ie_freq_cuidador_w			:= s_array[z].ie_freq_cuidador;
		ie_partic_grupo_com_w			:= s_array[z].ie_partic_grupo_com;
		ie_plano_saude_w			:= s_array[z].ie_plano_saude;
		ie_membro_povo_com_w			:= s_array[z].ie_membro_povo_com;
		ds_povo_comunidade_w			:= s_array[z].ds_povo_comunidade;
		ie_inf_orient_sexual_w			:= s_array[z].ie_inf_orient_sexual;
		ie_orient_sexual_w			:= s_array[z].ie_orient_sexual;
		ie_deficiente_w				:= s_array[z].ie_deficiente;
		ie_def_auditiva_w			:= s_array[z].ie_def_auditiva;
		ie_saida_cadastro_w			:= s_array[z].ie_saida_cadastro;
		ie_gestante_w				:= s_array[z].ie_gestante;
		ds_maternidade_ref_w			:= s_array[z].ds_maternidade_ref;
		ie_situacao_peso_w			:= s_array[z].ie_situacao_peso;
		ie_fumante_w				:= s_array[z].ie_fumante;
		ie_alcoolatra_w				:= s_array[z].ie_alcoolatra;
		ie_usa_drogas_w				:= s_array[z].ie_usa_drogas;
		ie_hipertenso_w				:= s_array[z].ie_hipertenso;
		ie_diabetico_w				:= s_array[z].ie_diabetico;
		ie_avc_derrame_w			:= s_array[z].ie_avc_derrame;
		ie_infarto_w				:= s_array[z].ie_infarto;
		ie_cardiaco_w				:= s_array[z].ie_cardiaco;
		ie_doenca_cardiaca_w			:= s_array[z].ie_doenca_cardiaca;
		ie_problema_renal_w			:= s_array[z].ie_problema_renal;
		ie_doenca_renal_w			:= s_array[z].ie_doenca_renal;
		ie_prob_respiratorio_w			:= s_array[z].ie_prob_respiratorio;
		ie_doenca_respi_asma_w			:= s_array[z].ie_doenca_respi_asma;
		ie_hanseniase_w				:= s_array[z].ie_hanseniase;
		ie_tuberculose_w			:= s_array[z].ie_tuberculose;
		ie_cancer_w				:= s_array[z].ie_cancer;
		ie_internacao_w				:= s_array[z].ie_internacao;
		ds_motivo_internacao_w			:= s_array[z].ds_motivo_internacao;
		ie_prob_mental_w			:= s_array[z].ie_prob_mental;
		ie_acamado_w				:= s_array[z].ie_acamado;
		ie_domiciliado_w			:= s_array[z].ie_domiciliado;
		ie_planta_medicinal_w			:= s_array[z].ie_planta_medicinal;
		ds_planta_medicinal_w			:= s_array[z].ds_planta_medicinal;
		ie_prat_integ_compl_w			:= s_array[z].ie_prat_integ_compl;
		ds_pri_cond_saude_w			:= s_array[z].ds_pri_cond_saude;
		ds_seg_cond_saude_w			:= s_array[z].ds_seg_cond_saude;
		ds_ter_cond_saude_w			:= s_array[z].ds_ter_cond_saude;
		ie_situacao_rua_w			:= s_array[z].ie_situacao_rua;
		ie_tempo_sit_rua_w			:= s_array[z].ie_tempo_sit_rua;
		ie_acomp_outra_inst_w			:= s_array[z].ie_acomp_outra_inst;
		ds_instit_acompanha_w			:= s_array[z].ds_instit_acompanha;
		ie_recebe_beneficio_w			:= s_array[z].ie_recebe_beneficio;
		ie_visita_familiar_w			:= s_array[z].ie_visita_familiar;
		ds_grau_parentesco_w			:= s_array[z].ds_grau_parentesco;
		ie_ref_familiar_w			:= s_array[z].ie_ref_familiar;
		ie_alimentacao_dia_w			:= s_array[z].ie_alimentacao_dia;
		ie_orig_ali_rest_pop_w			:= s_array[z].ie_orig_ali_rest_pop;
		ie_higiene_pessoal_w			:= s_array[z].ie_higiene_pessoal;
		ie_banho_w				:= s_array[z].ie_banho;
		ie_acesso_sanitario_w			:= s_array[z].ie_acesso_sanitario;
		ie_higiene_bucal_w			:= s_array[z].ie_higiene_bucal;
		ie_outra_higiene_w			:= s_array[z].ie_outra_higiene;
		ie_termo_recusa_w			:= s_array[z].ie_termo_recusa;
		nr_seq_lote_envio_w			:= s_array[z].nr_seq_lote_envio;
		ie_deficiente_visual_w			:= s_array[z].ie_deficiente_visual;
		ie_def_intelec_cogni_w			:= s_array[z].ie_def_intelec_cogni;
		ie_deficiente_fisico_w			:= s_array[z].ie_deficiente_fisico;
		ie_outra_deficiencia_w			:= s_array[z].ie_outra_deficiencia;
		ie_doe_res_dpoc_enfi_w			:= s_array[z].ie_doe_res_dpoc_enfi;
		ie_doenca_resp_outro_w			:= s_array[z].ie_doenca_resp_outro;
		ie_doen_res_nao_sabe_w			:= s_array[z].ie_doen_res_nao_sabe;
		ie_ori_ali_doac_rest_w			:= s_array[z].ie_ori_ali_doac_rest;
		ie_origem_alim_outro_w			:= s_array[z].ie_origem_alim_outro;
		ie_ori_ali_doa_grupo_w			:= s_array[z].ie_ori_ali_doa_grupo;
		ie_orig_alim_doa_pop_w			:= s_array[z].ie_orig_alim_doa_pop;
		cd_uuid_original_w			:= s_array[z].cd_uuid_original;		
		ie_outra_doe_card_w			:= s_array[z].ie_outra_doe_card;
		ie_nao_sab_doe_car_w			:= s_array[z].ie_nao_sab_doe_car;
		ie_outra_doe_ren_w			:= s_array[z].ie_outra_doe_ren;
		ie_nao_sabe_doe_ren_w			:= s_array[z].ie_nao_sabe_doe_ren;
		cd_cbo_profissional_w			:= s_array[z].cd_cbo_profissional;
		ds_micro_area_w				:= s_array[z].ds_micro_area;
		ie_fora_area_w				:= s_array[z].ie_fora_area;
		cd_pessoa_responsavel_w			:= s_array[z].cd_pessoa_responsavel;
		ie_resp_adolecente_w			:= s_array[z].ie_resp_adolecente;
		ie_resp_creche_w			:= s_array[z].ie_resp_creche;
		ie_resp_outra_crian_w			:= s_array[z].ie_resp_outra_crian;
		ie_resp_outro_w				:= s_array[z].ie_resp_outro;
		ie_resp_sozinha_w			:= s_array[z].ie_resp_sozinha;
		
		if (coalesce(cd_pessoa_fisica_w,'X') <> 'X') then
			begin
				cd_cns_paciente_w		:= substr(obter_dados_pf(cd_pessoa_fisica_w,'CNS'),1,20);
				dt_nascimento_paciente_w	:= to_date(substr(obter_dados_pf(cd_pessoa_fisica_w,'DN'),1,10),'dd/mm/yyyy');
			end;
		end if;		
		
		begin
			cd_cns_profissional_w := substr(obter_dados_pf(cd_profissional_w,'CNS'),1,15);		
		exception
		when others then
			cd_cns_profissional_w := '';
		end;
			
		select	nextval('w_esus_cad_individual_seq')
		into STRICT	nr_seq_exp_w
		;
		
		ie_raca_cor_pac_w		:= coalesce(Sus_Obter_Cor_Pele(cd_pessoa_fisica_w,'C'),'6');
		if (ie_raca_cor_pac_w > '6') then
			ie_raca_cor_pac_w	:= '6';
		end if;
		
		begin
		select	coalesce(obter_municipio_ibge(nr_cep_cidade_nasc),obter_dados_pf(cd_pessoa_fisica,'MN'))
		into STRICT	cd_municipo_ibge_w
		from	pessoa_fisica
		where	cd_pessoa_fisica = cd_pessoa_fisica_w  LIMIT 1;		
		exception
		when others then
			cd_municipo_ibge_w := '';
		end;
		
		nm_pessoa_fisica_w 		:= upper(elimina_acentos(obter_nome_pf(cd_pessoa_fisica_w),'S'));
		nm_social_pes_fis_w		:= upper(elimina_acentos(obter_dados_pf(cd_pessoa_fisica_w, 'NSOC'),'S'));
		--cd_municipo_ibge_w		:= obter_dados_pf(cd_pessoa_fisica_w, 'MN'); 
		cd_munic_ibge_pf_w		:= substr(cd_municipo_ibge_w||Calcula_Digito('MODULO10',cd_municipo_ibge_w),1,7);
		nr_pis_pessoa_fisic_w		:= obter_dados_pf(cd_pessoa_fisica_w, 'PIS');
		dt_naturalizacao_w		:= to_date(obter_dados_pf(cd_pessoa_fisica_w, 'DNAT'),'dd/mm/yyyy');
		dt_entrada_brasil_w		:= to_date(obter_dados_pf(cd_pessoa_fisica_w, 'DCB'),'dd/mm/yyyy');
		nr_port_naturalizacao_w		:= obter_dados_pf(cd_pessoa_fisica_w, 'NRPNAT');
		dt_obito_w			:= to_date(obter_dados_pf(cd_pessoa_fisica_w, 'DO'),'dd/mm/yyyy');
		nr_certidao_obito_w		:= substr(obter_dados_pf(cd_pessoa_fisica_w, 'COB'),1,9);
		cd_nascionalidade_w		:= coalesce(obter_dados_pf(cd_pessoa_fisica_w, 'N'),'10');
		ie_sexo_paciente_w		:= coalesce(obter_sexo_pf(cd_pessoa_fisica_w,'C'),'X');
		
		if (dt_naturalizacao_w IS NOT NULL AND dt_naturalizacao_w::text <> '') then
			cd_nascionalidade_w := '2';
--		elsif	(nvl(cd_nascionalidade_w,'10') <> '10') then

--			cd_nascionalidade_w := '3';
		else	
			cd_nascionalidade_w := '1';			
		end if;
		
		nm_mae_pessoa_fisica_w		:= upper(elimina_acentos(obter_compl_pf(cd_pessoa_fisica_w, 5, 'N'),'S'));
		ie_desconhece_mae_w 		:= 'false';
		if (coalesce(nm_mae_pessoa_fisica_w,'X') = 'X') then
			ie_desconhece_mae_w := 'true';
		end if;		
		nm_pai_pessoa_fisica_w		:= upper(elimina_acentos(obter_compl_pf(cd_pessoa_fisica_w, 4, 'N'),'S'));
		ie_desconhece_pai_w		:= 'false';
		if (coalesce(nm_pai_pessoa_fisica_w,'X') = 'X') then
			ie_desconhece_pai_w := 'true';
		end if;			
		
		ds_email_pes_fisic_w		:= obter_compl_pf(cd_pessoa_fisica_w, 1, 'M');
		cd_tipo_logradouro_w		:= obter_compl_pf(cd_pessoa_fisica_w, 1, 'TLS');
		nm_logradouro_w			:= elimina_acentos(obter_compl_pf(cd_pessoa_fisica_w, 1, 'EN'),'S');
		nr_logradouro_w			:= obter_compl_pf(cd_pessoa_fisica_w, 1, 'NR');
		ds_complemento_log_w		:= obter_compl_pf(cd_pessoa_fisica_w, 1, 'CO');
		ds_bairro_w			:= obter_compl_pf(cd_pessoa_fisica_w, 1, 'B');
		cd_uf_logradouro_w		:= esus_obter_codigo_uf(obter_compl_pf(cd_pessoa_fisica_w, 1, 'UF'));
		cd_cep_logradouro_w		:= obter_compl_pf(cd_pessoa_fisica_w, 1, 'CEP');
		nr_telefone_celul_w		:= substr(obter_dados_pf(cd_pessoa_fisica_w,'TCD'),1,11);
		nr_telefone_resid_w		:= obter_compl_pf(cd_pessoa_fisica_w, 1, 'DDT');
		nr_telefone_refer_w		:= obter_compl_pf(cd_pessoa_fisica_w, 1, 'TA');
		nm_pais_nascimento_w		:= elimina_acentos(obter_compl_pf(cd_pessoa_fisica_w, 1, 'PAIS'),'S');
		cd_etnia_w			:= somente_numero(Sus_Obter_Etnia(cd_pessoa_fisica_w,'C'));
		
		ie_sem_numero_log_w		:= 	'FALSE';
		if (coalesce(nm_logradouro_w,'X') = 'X') then
			ie_sem_numero_log_w	:=	'TRUE';
		end if;
		
		if (ie_resp_familiar_w = 'S') then
			ie_resp_familiar_w := 'TRUE';
		else	
			ie_resp_familiar_w := 'FALSE';
		end if;	
				
		if (coalesce(cd_etnia_w,'0') <> '0') then
			cd_etnia_w := coalesce((cd_etnia_w)::numeric ,'');
		else
			cd_etnia_w := '';
		end if;
		
		cd_micro_area_w := lpad(substr(trim(both ds_micro_area_w),1,2),2,'0');
		
		if (coalesce(cd_pessoa_responsavel_w,'X') <> 'X') then
			begin
			cd_cns_resp_familia_w := substr(obter_dados_pf(cd_pessoa_responsavel_w,'CNS'),1,15);		
			end;
		end if;
		
		if (dt_atendimento_w IS NOT NULL AND dt_atendimento_w::text <> '') then
			nr_data_atendimento_w := ((dt_atendimento_w - to_date('01/01/1970 00:00:00','dd/mm/yyyy hh24:mi:ss')) * 86400);
		else
			nr_data_atendimento_w := null;
		end if;
		
		if (dt_naturalizacao_w IS NOT NULL AND dt_naturalizacao_w::text <> '') then
			nr_data_naturalizacao_w := rpad(((dt_naturalizacao_w - to_date('01/01/1970 00:00:00','dd/mm/yyyy hh24:mi:ss')) * 86400),13,0);
		else
			nr_data_naturalizacao_w := null;
		end if;
		
		if (dt_nascimento_paciente_w IS NOT NULL AND dt_nascimento_paciente_w::text <> '') then
			nr_data_nasc_paciente_w := ((dt_nascimento_paciente_w - to_date('01/01/1970 00:00:00','dd/mm/yyyy hh24:mi:ss')) * 86400);
		else
			nr_data_nasc_paciente_w := null;
		end if;
		
		if (dt_entrada_brasil_w IS NOT NULL AND dt_entrada_brasil_w::text <> '') then
			nr_data_entra_brasil_w := rpad(((dt_entrada_brasil_w - to_date('01/01/1970 00:00:00','dd/mm/yyyy hh24:mi:ss')) * 86400),13,0);
		else
			nr_data_entra_brasil_w := null;
		end if;
		
		if (dt_obito_w IS NOT NULL AND dt_obito_w::text <> '') then
			nr_data_obito_w := rpad(((dt_obito_w - to_date('01/01/1970 00:00:00','dd/mm/yyyy hh24:mi:ss')) * 86400),13,0);
		else
			nr_data_obito_w := null;
		end if;
		
		begin
		qt_idade_pac_w := somente_numero(obter_idade(dt_nascimento_paciente_w,dt_atendimento_w,'A'));		
		exception
		when others then
			qt_idade_pac_w := null;
		end;
		
		if	((ie_sexo_paciente_w = 'M') or (coalesce(qt_idade_pac_w,10) > 9)) then
			ie_gestante_w := 'X';
		end if;
		
		if (coalesce(qt_idade_pac_w,9) > 9) then
			begin
			ie_resp_crianca_w	:= 'N';
			ie_resp_adolecente_w	:= 'N';
			ie_resp_creche_w	:= 'N';
			ie_resp_outra_crian_w	:= 'N';
			ie_resp_outro_w		:= 'N';
			ie_resp_sozinha_w	:= 'N';
			end;
		end if;
		
		select	coalesce(max(cd_cnes_unidade),'0')
		into STRICT	cd_cnes_unidade_ww
		from	w_esus_header_footer
		where	nr_seq_lote_envio = nr_seq_lote_p;
		
		if (cd_cnes_unidade_w <> cd_cnes_unidade_ww) then
			begin
			cd_contra_chave_rem_w	:= substr(sus_gerar_uuid_esus(cd_cnes_unidade_w,'C'),1,50);
			cd_uuid_instal_rem_w	:= substr(sus_gerar_uuid_esus(cd_cnes_unidade_w,'U'),1,50);
			cd_contra_chave_ori_w	:= cd_contra_chave_rem_w;
			cd_uuid_instal_orig_w	:= cd_uuid_instal_rem_w;			
			cd_municipio_ibge_ww	:= sus_obter_dados_equipe(nr_seq_sus_equipe_w,'CM');
			cd_municipio_ibge_ww	:= substr(cd_municipio_ibge_ww||Calcula_Digito('MODULO10',cd_municipio_ibge_ww),1,7);
			
			update 	w_esus_header_footer
			set 	cd_cnes_unidade = cd_cnes_unidade_w,
				cd_cnes_serealizado = cd_cnes_unidade_w,
				cd_contra_chave_rem = cd_contra_chave_rem_w,
				cd_uuid_instal_rem = cd_uuid_instal_rem_w,
				cd_contra_chave_ori = cd_contra_chave_ori_w,
				cd_uuid_instal_orig = cd_uuid_instal_orig_w,
				cd_municipio_ibge = cd_municipio_ibge_ww
			where	nr_seq_lote_envio = nr_seq_lote_p;
			
			end;
		end if;
		
		if (coalesce(cd_uuid_original_w,'X') = 'X')  then
			cd_uuid_atualiza_w := coalesce(sus_gerar_uuid_esus(cd_cnes_unidade_w,'U'),'0');
			update esus_cad_individual set cd_uuid_original = cd_uuid_atualiza_w where  nr_sequencia = nr_sequencia_w;
			cd_uuid_original_w := cd_uuid_atualiza_w;
		else
			cd_uuid_atualiza_w := coalesce(sus_gerar_uuid_esus(cd_cnes_unidade_w,'U'),'0');			
		end if;
		
		ie_atualizada_w	:= 'FALSE';
		if (coalesce(cd_uuid_original_w,'X') <> coalesce(cd_uuid_atualiza_w,'X')) and (coalesce(cd_uuid_original_w,'X') <> 'X') then
			ie_atualizada_w	:= 'TRUE';
		end if;
				
		insert into w_esus_cad_individual(nr_sequencia,
						nr_seq_ficha,
						dt_atualizacao,
						nm_usuario,
						dt_atualizacao_nrec,
						nm_usuario_nrec,
						cd_pessoa_fisica,
						cd_profissional,
						cd_cbo_paciente,
						cd_cnes_unidade,
						nr_seq_sus_equipe,
						dt_atendimento,
						ie_resp_familiar,
						ie_relacao_resp,
						ie_frequenta_escola,
						ie_curso_frequentado,
						ie_situacao_merc_trab,
						ie_resp_crianca,
						ie_resp_adolecente,
						ie_resp_creche,
						ie_resp_outra_crian,
						ie_resp_outro,
						ie_resp_sozinha,
						ie_freq_cuidador,
						ie_partic_grupo_com,
						ie_plano_saude,
						ie_membro_povo_com,
						ds_povo_comunidade,
						ie_inf_orient_sexual,
						ie_orient_sexual,
						ie_deficiente,
						ie_def_auditiva,
						ie_saida_cadastro,
						ie_gestante,
						ds_maternidade_ref,
						ie_situacao_peso,
						ie_fumante,
						ie_alcoolatra,
						ie_usa_drogas,
						ie_hipertenso,
						ie_diabetico,
						ie_avc_derrame,
						ie_infarto,
						ie_cardiaco,
						ie_doenca_cardiaca,
						ie_outra_doe_card,
						ie_nao_sab_doe_car,
						ie_problema_renal,
						ie_doenca_renal,
						ie_outra_doe_ren,
						ie_nao_sabe_doe_ren,
						ie_prob_respiratorio,
						ie_doenca_respi_asma,
						ie_hanseniase,
						ie_tuberculose,
						ie_cancer,
						ie_internacao,
						ds_motivo_internacao,
						ie_prob_mental,
						ie_acamado,
						ie_domiciliado,
						ie_planta_medicinal,
						ds_planta_medicinal,
						ie_prat_integ_compl,
						ds_pri_cond_saude,
						ds_seg_cond_saude,
						ds_ter_cond_saude,
						ie_situacao_rua,
						ie_tempo_sit_rua,
						ie_acomp_outra_inst,
						ds_instit_acompanha,
						ie_recebe_beneficio,
						ie_visita_familiar,
						ds_grau_parentesco,
						ie_ref_familiar,
						ie_alimentacao_dia,
						ie_orig_ali_rest_pop,
						ie_higiene_pessoal,
						ie_banho,
						ie_acesso_sanitario,
						ie_higiene_bucal,
						ie_outra_higiene,
						ie_termo_recusa,
						nr_seq_lote_envio,
						ie_deficiente_visual,
						ie_def_intelec_cogni,
						ie_deficiente_fisico,
						ie_outra_deficiencia,
						ie_doe_res_dpoc_enfi,
						ie_doenca_resp_outro,
						ie_doen_res_nao_sabe,
						ie_ori_ali_doac_rest,
						ie_origem_alim_outro,
						ie_ori_ali_doa_grupo,
						ie_orig_alim_doa_pop,
						cd_cns_paciente,
						dt_nascimento_paciente,
						cd_cns_profissional,
						cd_uuid_original,
						ie_raca_cor_pac,
						nm_pessoa_fisica,
						nm_social_pes_fis,
						cd_munic_ibge_pf,
						cd_nascionalidade,
						nr_pis_pessoa_fisic,
						ie_desconhece_mae,
						ds_email_pes_fisic,
						cd_tipo_logradouro,
						nm_logradouro,
						nr_logradouro,
						ds_complemento_log,
						ds_bairro,
						cd_uf_logradouro,
						cd_cep_logradouro,
						nr_telefone_resid,
						nr_telefone_refer,
						ie_sem_numero_log,
						nr_telefone_celul,
						nm_pais_nascimento,
						nm_mae_pessoa_fisica,
						ie_atualizada,
						cd_uuid_atualiza,
						cd_etnia,
						nm_pai_pessoa_fisica,
						ie_desconhece_pai,
						dt_naturalizacao,
						dt_entrada_brasil,
						nr_data_naturalizacao,
						nr_data_atendimento,
						nr_data_nasc_paciente,
						nr_port_naturalizacao,
						nr_data_entra_brasil,
						cd_micro_area,
						ie_fora_area,
						ie_inf_ident_genero,
						ie_identidade_genero,
						dt_obito,
						nr_certidao_obito,
						nr_data_obito,
						cd_cbo_profissional,
						cd_cns_resp_familia,
						ie_sexo_paciente)
				values (	nr_seq_exp_w,
						nr_sequencia_w,
						dt_atualizacao_w,
						nm_usuario_w,
						dt_atualizacao_nrec_w,
						nm_usuario_nrec_w,
						cd_pessoa_fisica_w,
						cd_profissional_w,
						cd_cbo_paciente_w,
						cd_cnes_unidade_w,
						nr_seq_sus_equipe_w,
						dt_atendimento_w,
						CASE WHEN ie_resp_familiar_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_resp_familiar_w='N' THEN CASE WHEN ie_relacao_resp_w='B' THEN '140' WHEN ie_relacao_resp_w='C' THEN '137' WHEN ie_relacao_resp_w='E' THEN '139' WHEN ie_relacao_resp_w='F' THEN '138' WHEN ie_relacao_resp_w='G' THEN '144' WHEN ie_relacao_resp_w='I' THEN '143' WHEN ie_relacao_resp_w='N' THEN '146' WHEN ie_relacao_resp_w='O' THEN '145' WHEN ie_relacao_resp_w='P' THEN '141' WHEN ie_relacao_resp_w='S' THEN '142'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_frequenta_escola_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_curso_frequentado_w='1' THEN '51' WHEN ie_curso_frequentado_w='2' THEN '52' WHEN ie_curso_frequentado_w='3' THEN '53' WHEN ie_curso_frequentado_w='4' THEN '54' WHEN ie_curso_frequentado_w='5' THEN '55' WHEN ie_curso_frequentado_w='6' THEN '56' WHEN ie_curso_frequentado_w='7' THEN '57' WHEN ie_curso_frequentado_w='8' THEN '58' WHEN ie_curso_frequentado_w='9' THEN '59' WHEN ie_curso_frequentado_w='10' THEN '60' WHEN ie_curso_frequentado_w='11' THEN '61' WHEN ie_curso_frequentado_w='12' THEN '62' WHEN ie_curso_frequentado_w='13' THEN '63' WHEN ie_curso_frequentado_w='14' THEN '64' WHEN ie_curso_frequentado_w='15' THEN '65'  ELSE '' END ,
						CASE WHEN ie_situacao_merc_trab_w='1' THEN '66' WHEN ie_situacao_merc_trab_w='2' THEN '67' WHEN ie_situacao_merc_trab_w='3' THEN '68' WHEN ie_situacao_merc_trab_w='4' THEN '69' WHEN ie_situacao_merc_trab_w='5' THEN '70' WHEN ie_situacao_merc_trab_w='6' THEN '71' WHEN ie_situacao_merc_trab_w='7' THEN '72' WHEN ie_situacao_merc_trab_w='8' THEN '73' WHEN ie_situacao_merc_trab_w='9' THEN '74' WHEN ie_situacao_merc_trab_w='10' THEN '147'  ELSE '' END ,
						CASE WHEN ie_resp_crianca_w='S' THEN '1'  ELSE '' END ,
						CASE WHEN ie_resp_adolecente_w='S' THEN '133'  ELSE '' END ,
						CASE WHEN ie_resp_creche_w='S' THEN '134'  ELSE '' END ,
						CASE WHEN ie_resp_outra_crian_w='S' THEN '2'  ELSE '' END ,
						CASE WHEN ie_resp_outro_w='S' THEN '4'  ELSE '' END ,
						CASE WHEN ie_resp_sozinha_w='S' THEN '3'  ELSE '' END ,
						CASE WHEN ie_freq_cuidador_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_partic_grupo_com_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_plano_saude_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_membro_povo_com_w='S' THEN 'true'  ELSE 'false' END ,
						substr(elimina_acentos(ds_povo_comunidade_w,'N'),1,100),
						CASE WHEN ie_inf_orient_sexual_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_inf_orient_sexual_w='S' THEN CASE WHEN ie_orient_sexual_w='H' THEN '148' WHEN ie_orient_sexual_w='GL' THEN '153' WHEN ie_orient_sexual_w='B' THEN '154' WHEN ie_orient_sexual_w='O' THEN '155' END   ELSE '' END ,
						CASE WHEN ie_deficiente_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_deficiente_w='S' THEN CASE WHEN ie_def_auditiva_w='S' THEN '12'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_saida_cadastro_w='O' THEN '135' WHEN ie_saida_cadastro_w='M' THEN '136'  ELSE '' END ,
						CASE WHEN ie_gestante_w='S' THEN 'true' WHEN ie_gestante_w='N' THEN 'false'  ELSE '' END ,
						CASE WHEN ie_gestante_w='S' THEN substr(elimina_acentos(ds_maternidade_ref_w,'N'),1,100)  ELSE '' END ,
						CASE WHEN ie_situacao_peso_w='B' THEN '21' WHEN ie_situacao_peso_w='P' THEN '22' WHEN ie_situacao_peso_w='C' THEN '23'  ELSE '' END ,
						CASE WHEN ie_fumante_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_alcoolatra_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_usa_drogas_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_hipertenso_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_diabetico_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_avc_derrame_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_infarto_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_cardiaco_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_doenca_cardiaca_w='S' THEN '24'  ELSE '' END ,
						CASE WHEN ie_outra_doe_card_w='S' THEN '25'  ELSE '' END ,
						CASE WHEN ie_nao_sab_doe_car_w='S' THEN '26'  ELSE '' END ,
						CASE WHEN ie_problema_renal_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_doenca_renal_w='S' THEN '27'  ELSE '' END ,
						CASE WHEN ie_outra_doe_ren_w='S' THEN '28'  ELSE '' END ,
						CASE WHEN ie_nao_sabe_doe_ren_w='S' THEN '29'  ELSE '' END ,
						CASE WHEN ie_prob_respiratorio_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_doenca_respi_asma_w='S' THEN '30'  ELSE '' END ,
						CASE WHEN ie_hanseniase_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_tuberculose_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_cancer_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_internacao_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_internacao_w='S' THEN substr(elimina_acentos(ds_motivo_internacao_w,'N'),1,100)  ELSE '' END ,
						CASE WHEN ie_prob_mental_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_acamado_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_domiciliado_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_planta_medicinal_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_planta_medicinal_w='S' THEN substr(elimina_acentos(ds_planta_medicinal_w,'N'),1,100)  ELSE '' END ,
						CASE WHEN ie_prat_integ_compl_w='S' THEN 'true'  ELSE 'false' END ,
						substr(elimina_acentos(ds_pri_cond_saude_w,'N'),1,100),
						substr(elimina_acentos(ds_seg_cond_saude_w,'N'),1,100),
						substr(elimina_acentos(ds_ter_cond_saude_w,'N'),1,100),						
						CASE WHEN ie_situacao_rua_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_tempo_sit_rua_w='01' THEN '17' WHEN ie_tempo_sit_rua_w='02' THEN '18' WHEN ie_tempo_sit_rua_w='03' THEN '19' WHEN ie_tempo_sit_rua_w='04' THEN '20' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_acomp_outra_inst_w='S' THEN 'true'  ELSE 'false' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_acomp_outra_inst_w='S' THEN substr(elimina_acentos(ds_instit_acompanha_w,'N'),1,100)  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_recebe_beneficio_w='S' THEN 'true'  ELSE 'false' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_visita_familiar_w='S' THEN 'true'  ELSE 'false' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_visita_familiar_w='S' THEN substr(elimina_acentos(ds_grau_parentesco_w,'N'),1,100)  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_ref_familiar_w='S' THEN 'true'  ELSE 'false' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_alimentacao_dia_w='1' THEN '34' WHEN ie_alimentacao_dia_w='2' THEN '35' WHEN ie_alimentacao_dia_w='3' THEN '36'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_orig_ali_rest_pop_w='S' THEN '37'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_higiene_pessoal_w='S' THEN 'true'  ELSE 'false' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_banho_w='S' THEN '42'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_acesso_sanitario_w='S' THEN '43'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_higiene_bucal_w='S' THEN '44'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_outra_higiene_w='S' THEN '45'  ELSE '' END   ELSE '' END ,						
						CASE WHEN ie_termo_recusa_w='S' THEN 'true'  ELSE 'false' END ,
						nr_seq_lote_envio_w,
						CASE WHEN ie_deficiente_w='S' THEN CASE WHEN ie_deficiente_visual_w='S' THEN '13'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_deficiente_w='S' THEN CASE WHEN ie_def_intelec_cogni_w='S' THEN '14'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_deficiente_w='S' THEN CASE WHEN ie_deficiente_fisico_w='S' THEN '15'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_deficiente_w='S' THEN CASE WHEN ie_outra_deficiencia_w='S' THEN '16'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_doe_res_dpoc_enfi_w='S' THEN '31'  ELSE '' END ,
						CASE WHEN ie_doenca_resp_outro_w='S' THEN '32'  ELSE '' END ,
						CASE WHEN ie_doen_res_nao_sabe_w='S' THEN '33'  ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_ori_ali_doac_rest_w='S' THEN '39'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_origem_alim_outro_w='S' THEN '41'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_ori_ali_doa_grupo_w='S' THEN '38'  ELSE '' END   ELSE '' END ,
						CASE WHEN ie_situacao_rua_w='S' THEN CASE WHEN ie_orig_alim_doa_pop_w='S' THEN '40'  ELSE '' END   ELSE '' END ,
						cd_cns_paciente_w,
						dt_nascimento_paciente_w,
						cd_cns_profissional_w,
						cd_uuid_original_w,
						ie_raca_cor_pac_w,
						nm_pessoa_fisica_w,
						nm_social_pes_fis_w,
						CASE WHEN cd_munic_ibge_pf_w='0' THEN ''  ELSE cd_munic_ibge_pf_w END ,
						cd_nascionalidade_w,
						nr_pis_pessoa_fisic_w,
						ie_desconhece_mae_w,
						substr(elimina_acentos(CASE WHEN position('@' in ds_email_pes_fisic_w)=0 THEN ''  ELSE ds_email_pes_fisic_w END ,'N'),1,100),
						cd_tipo_logradouro_w,
						nm_logradouro_w,
						nr_logradouro_w,
						substr(elimina_acentos(ds_complemento_log_w,'N'),1,30),
						substr(elimina_acentos(ds_bairro_w,'N'),1,72),
						cd_uf_logradouro_w,
						cd_cep_logradouro_w,
						nr_telefone_resid_w,
						nr_telefone_refer_w,
						CASE WHEN ie_sem_numero_log_w='S' THEN 'true'  ELSE 'false' END ,
						nr_telefone_celul_w,
						CASE WHEN cd_nascionalidade_w='1' THEN '31'  ELSE '' END ,
						CASE WHEN ie_desconhece_mae_w='false' THEN substr(nm_mae_pessoa_fisica_w,1,70)  ELSE '' END ,
						CASE WHEN ie_atualizada_w='S' THEN 'true'  ELSE 'false' END ,
						cd_uuid_atualiza_w,
						cd_etnia_w,
						CASE WHEN ie_desconhece_pai_w='false' THEN substr(nm_pai_pessoa_fisica_w,1,70)  ELSE '' END ,
						ie_desconhece_pai_w,
						dt_naturalizacao_w,
						dt_entrada_brasil_w,
						nr_data_naturalizacao_w,
						nr_data_atendimento_w,
						nr_data_nasc_paciente_w,
						nr_port_naturalizacao_w,
						nr_data_entra_brasil_w,
						cd_micro_area_w,
						CASE WHEN ie_fora_area_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_inf_ident_genero_w='S' THEN 'true'  ELSE 'false' END ,
						CASE WHEN ie_inf_ident_genero_w='S' THEN ie_identidade_genero_w  ELSE '' END ,
						dt_obito_w,
						nr_certidao_obito_w,
						nr_data_obito_w,
						cd_cbo_profissional_w,
						cd_cns_resp_familia_w,
						CASE WHEN ie_sexo_paciente_w='F' THEN '1' WHEN ie_sexo_paciente_w='M' THEN '0'  ELSE '4' END );
		end;
	end loop;
	end;
end loop;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE sus_gerar_w_esus_cad_ind ( nr_seq_lote_p esus_lote_envio.nr_sequencia%type, ie_tipo_lote_esus_p esus_lote_envio.ie_tipo_lote_esus%type, cd_cnes_estab_p estabelecimento.cd_cns%type, nm_usuario_p usuario.nm_usuario%type) FROM PUBLIC;

