-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_vini_adep ( nr_atendimento_p bigint, cd_Indenc_p bigint, ie_tipo_item_p text, ie_atend_pac_p text, nr_prescricao_p bigint, ie_dias_medicamento_p text, nm_usuario_p text, Ie_opcao_gerar_p text, dt_inicio_p timestamp, dt_fim_p timestamp ) AS $body$
DECLARE

/* 
	<--	cd_Indenc_p	--> 
	____________________________ 
	|passar_________| Para_________| 
	|cd_material_____| Medicamenos __| 
	|cd_procedimento_| Procedimentos__| 
	|_____________ |_____________|	 
*/
 
 
/* 
	<--	ie_atend_pac_p	--> 
	____________________________ 
	|passar_________| Para___________ | 
	|PAC___________|Todas Paciente ___ | 
	|ATEND________| Todas Atendimento | 
	|_____________ |_______________|	 
 */
 
 
 /* 
		<--	Ie_opcao_gerar_p	--> 
	______________________________ 
	|passar_________| Para___________ | 
	|MED__________| Mat/Med _____ __| 
	|PROC_________ | Procedimento _____| 
	|_____________ |______________ _|	 
 */
 
			 
 

BEGIN 
 
delete	FROM Vime_Adep 
where	nm_usuario	= nm_usuario_p;
 
commit;
 
if (Ie_opcao_gerar_p = 'MED') then 
	CALL Gerar_Vini_Adep_medic(nr_atendimento_p, cd_Indenc_p, ie_tipo_item_p, 
				ie_atend_pac_p, nr_prescricao_p, 
				ie_dias_medicamento_p, nm_usuario_p, dt_inicio_p, dt_fim_p);
elsif (Ie_opcao_gerar_p = 'PROC') then 
	CALL Gerar_Vini_Adep_proc(nr_atendimento_p, cd_Indenc_p, 
				ie_atend_pac_p, nr_prescricao_p, 
				ie_dias_medicamento_p, nm_usuario_p, dt_inicio_p, dt_fim_p);
end if;
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_vini_adep ( nr_atendimento_p bigint, cd_Indenc_p bigint, ie_tipo_item_p text, ie_atend_pac_p text, nr_prescricao_p bigint, ie_dias_medicamento_p text, nm_usuario_p text, Ie_opcao_gerar_p text, dt_inicio_p timestamp, dt_fim_p timestamp ) FROM PUBLIC;

