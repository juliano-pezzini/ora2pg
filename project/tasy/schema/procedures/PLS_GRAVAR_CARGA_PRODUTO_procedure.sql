-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pls_gravar_carga_produto ( cd_estabelecimento_p bigint, nm_usuario_p text) AS $body$
DECLARE


ds_plano_w			varchar(80);
cd_codigo_ant_w			varchar(20);
ie_segmentacao_w		varchar(3);
ie_situacao_w			varchar(1);
ie_tipo_contratacao_w		varchar(2);
ie_regulamentacao_w		varchar(2);
ie_abrangencia_w		varchar(3);
ie_franquia_w			varchar(1);
ie_acomodacao_w			varchar(1);
ie_coparticipacao_w		varchar(1);
ie_preco_w			varchar(2);
nm_fantasia_w			varchar(255);
ie_vinculo_ativo_w		varchar(1);
ie_vinculo_inativo_w		varchar(1);
ie_sem_vinculo_w		varchar(1);
ie_participacao_w		varchar(1);
ie_livre_escolha_w		varchar(1);
cd_plano_w			varchar(20);
ie_simulacao_preco_w		varchar(1);
ie_proposta_adesao_w		varchar(1);
ie_tipo_operacao_w		varchar(1);
nr_seq_outorgante_w		bigint;

C01 CURSOR FOR
	SELECT	ds_plano,
		cd_codigo_ant,
		ie_segmentacao,
		coalesce(ie_situacao,'A'),
		ie_tipo_contratacao,
		ie_regulamentacao,
		ie_abrangencia,
		coalesce(ie_franquia,'N'),
		ie_acomodacao,
		coalesce(ie_coparticipacao,'N'),
		ie_preco,
		nm_fantasia,
		coalesce(ie_vinculo_ativo,'N'),
		coalesce(ie_vinculo_inativo,'N'),
		coalesce(ie_sem_vinculo,'N'),
		ie_participacao,
		coalesce(ie_livre_escolha,'N'),
		cd_plano,
		ie_simulacao_preco,
		ie_proposta_adesao,
		ie_tipo_operacao,
		nr_seq_outorgante
	from	w_pls_carga_produto
	where	(ds_plano IS NOT NULL AND ds_plano::text <> '');


BEGIN

open C01;
loop
fetch C01 into
	ds_plano_w,
	cd_codigo_ant_w,
	ie_segmentacao_w,
	ie_situacao_w,
	ie_tipo_contratacao_w,
	ie_regulamentacao_w,
	ie_abrangencia_w,
	ie_franquia_w,
	ie_acomodacao_w,
	ie_coparticipacao_w,
	ie_preco_w,
	nm_fantasia_w,
	ie_vinculo_ativo_w,
	ie_vinculo_inativo_w,
	ie_sem_vinculo_w,
	ie_participacao_w,
	ie_livre_escolha_w,
	cd_plano_w,
	ie_simulacao_preco_w,
	ie_proposta_adesao_w,
	ie_tipo_operacao_w,
	nr_seq_outorgante_w;
EXIT WHEN NOT FOUND; /* apply on C01 */
	begin
	insert into pls_plano(nr_sequencia, cd_estabelecimento, dt_atualizacao,
		nm_usuario, dt_atualizacao_nrec, nm_usuario_nrec,
		ds_plano, nr_seq_outorgante, nr_protocolo_ans,
		cd_codigo_ant, ie_segmentacao, ie_situacao,
		ie_tipo_contratacao, ie_regulamentacao, ie_abrangencia,
		ie_franquia, ie_acomodacao, ie_coparticipacao,
		ie_preco, nm_fantasia, ie_vinculo_ativo,
		ie_vinculo_inativo, ie_sem_vinculo, ie_participacao,
		ie_livre_escolha, cd_plano, ie_simulacao_preco,
		ie_proposta_adesao, ie_tipo_operacao, dt_liberacao)
	values (	nextval('pls_plano_seq'), cd_estabelecimento_p, clock_timestamp(),
		nm_usuario_p, clock_timestamp(), nm_usuario_p,
		ds_plano_w, nr_seq_outorgante_w, null,
		cd_codigo_ant_w, ie_segmentacao_w, ie_situacao_w,
		ie_tipo_contratacao_w, ie_regulamentacao_w, ie_abrangencia_w,
		ie_franquia_w, ie_acomodacao_w, ie_coparticipacao_w,
		ie_preco_w, nm_fantasia_w, ie_vinculo_ativo_w,
		ie_vinculo_inativo_w, ie_sem_vinculo_w, ie_participacao_w,
		ie_livre_escolha_w, cd_plano_w, ie_simulacao_preco_w,
		ie_proposta_adesao_w, ie_tipo_operacao_w, null);
	end;
end loop;
close C01;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_gravar_carga_produto ( cd_estabelecimento_p bigint, nm_usuario_p text) FROM PUBLIC;

