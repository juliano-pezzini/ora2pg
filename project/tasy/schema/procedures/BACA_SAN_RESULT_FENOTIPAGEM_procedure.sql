-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE baca_san_result_fenotipagem () AS $body$
DECLARE


nr_linhas_bkp_w		bigint;
nr_tabela_existe	varchar(1);

BEGIN

	select 	CASE WHEN count(*)=0 THEN  'N'  ELSE 'S' END
	into STRICT	nr_tabela_existe
	from 	user_tables
	where 	upper(table_name) = 'SAN_RESULT_FENOTIPAGEM_BCK';

	if	nr_tabela_existe = 'N' then
		CALL exec_sql_dinamico('Tasy','create table san_result_fenotipagem_bck as
		SELECT a.*,SUBSTR(san_obter_result_fenotipagem(a.nr_sequencia),1,255) ds_fenotipo
		FROM san_result_fenotipagem a');
		commit;
	end if;

	nr_linhas_bkp_w := obter_valor_dinamico('select 	count(*)
	from 	san_result_fenotipagem_bck', nr_linhas_bkp_w);

	if (nr_linhas_bkp_w > 0) then

		UPDATE 	san_result_fenotipagem SET
			ds_d 		= CASE WHEN ds_d='N' THEN  NULL  ELSE CASE WHEN ds_d='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_d END   ELSE ds_d END  END ,
			ds_c 		= CASE WHEN ds_c='N' THEN  NULL  ELSE CASE WHEN ds_c='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_c END   ELSE ds_c END  END ,
			ds_e 		= CASE WHEN ds_e='N' THEN  NULL  ELSE CASE WHEN ds_e='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_e END   ELSE ds_e END  END ,
			ds_c_min 	= CASE WHEN ds_c_min='N' THEN  NULL  ELSE CASE WHEN ds_c_min='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_c_min END   ELSE ds_c_min END  END ,
			ds_e_min 	= CASE WHEN ds_e_min='N' THEN  NULL  ELSE CASE WHEN ds_e_min='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_e_min END   ELSE ds_e_min END  END ,
			ds_f_min 	= CASE WHEN ds_f_min='N' THEN  NULL  ELSE CASE WHEN ds_f_min='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_f_min END   ELSE ds_f_min END  END ,
			ds_cw 		= CASE WHEN ds_cw='N' THEN  NULL  ELSE CASE WHEN ds_cw='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_cw END   ELSE ds_cw END  END ,
			ds_k 		= CASE WHEN ds_k='N' THEN  NULL  ELSE CASE WHEN ds_k='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_k END   ELSE ds_k END  END ,
			ds_k_min 	= CASE WHEN ds_k_min='N' THEN  NULL  ELSE CASE WHEN ds_k_min='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_k_min END   ELSE ds_k_min END  END ,
			ds_kpa 		= CASE WHEN ds_kpa='N' THEN  NULL  ELSE CASE WHEN ds_kpa='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_kpa END   ELSE ds_kpa END  END ,
			ds_kpb 		= CASE WHEN ds_kpb='N' THEN  NULL  ELSE CASE WHEN ds_kpb='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_kpb END   ELSE ds_kpb END  END ,
			ds_jsa 		= CASE WHEN ds_jsa='N' THEN  NULL  ELSE CASE WHEN ds_jsa='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_jsa END   ELSE ds_jsa END  END ,
			ds_jsb 		= CASE WHEN ds_jsb='N' THEN  NULL  ELSE CASE WHEN ds_jsb='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_jsb END   ELSE ds_jsb END  END ,
			ds_fya 		= CASE WHEN ds_fya='N' THEN  NULL  ELSE CASE WHEN ds_fya='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_fya END   ELSE ds_fya END  END ,
			ds_fyb 		= CASE WHEN ds_fyb='N' THEN  NULL  ELSE CASE WHEN ds_fyb='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_fyb END   ELSE ds_fyb END  END ,
			ds_jka 		= CASE WHEN ds_jka='N' THEN  NULL  ELSE CASE WHEN ds_jka='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_jka END   ELSE ds_jka END  END ,
			ds_jkb 		= CASE WHEN ds_jkb='N' THEN  NULL  ELSE CASE WHEN ds_jkb='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_jkb END   ELSE ds_jkb END  END ,
			ds_lea 		= CASE WHEN ds_lea='N' THEN  NULL  ELSE CASE WHEN ds_lea='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_lea END   ELSE ds_lea END  END ,
			ds_leb 		= CASE WHEN ds_leb='N' THEN  NULL  ELSE CASE WHEN ds_leb='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_leb END   ELSE ds_leb END  END ,
			ds_s 		= CASE WHEN ds_s='N' THEN  NULL  ELSE CASE WHEN ds_s='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_s END   ELSE ds_s END  END ,
			ds_s_min 	= CASE WHEN ds_s_min='N' THEN  NULL  ELSE CASE WHEN ds_s_min='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_s_min END   ELSE ds_s_min END  END ,
			ds_m 		= CASE WHEN ds_m='N' THEN  NULL  ELSE CASE WHEN ds_m='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_m END   ELSE ds_m END  END ,
			ds_n 		= CASE WHEN ds_n='N' THEN  NULL  ELSE CASE WHEN ds_n='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_n END   ELSE ds_n END  END ,
			ds_p1 		= CASE WHEN ds_p1='N' THEN  NULL  ELSE CASE WHEN ds_p1='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_p1 END   ELSE ds_p1 END  END ,
			ds_lua 		= CASE WHEN ds_lua='N' THEN  NULL  ELSE CASE WHEN ds_lua='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_lua END   ELSE ds_lua END  END ,
			ds_lub 		= CASE WHEN ds_lub='N' THEN  NULL  ELSE CASE WHEN ds_lub='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_lub END   ELSE ds_lub END  END ,
			ds_dia 		= CASE WHEN ds_dia='N' THEN  NULL  ELSE CASE WHEN ds_dia='S' THEN  CASE WHEN ie_resultado='P' THEN  '1' WHEN ie_resultado='N' THEN  '0' WHEN ie_resultado = NULL THEN  '1'  ELSE ds_dia END   ELSE ds_dia END  END;
	end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE baca_san_result_fenotipagem () FROM PUBLIC;

