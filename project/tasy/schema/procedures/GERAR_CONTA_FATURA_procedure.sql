-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_conta_fatura ( nr_interno_conta_p bigint, nr_interno_conta_nova_p INOUT bigint, pr_coseguro_hosp_p bigint, pr_coseguro_honor_p bigint, vl_deduzido_p bigint, vl_base_conta_p bigint, nm_usuario_p text) AS $body$
DECLARE

 
nr_interno_conta_nova_w	conta_paciente.nr_interno_conta%type;


BEGIN 
 
if (nr_interno_conta_p IS NOT NULL AND nr_interno_conta_p::text <> '') then 
	select	nextval('conta_paciente_seq') 
	into STRICT	nr_interno_conta_nova_w 
	;
 
	insert into conta_paciente( 
				nr_atendimento, 
				dt_acerto_conta, 
				ie_status_acerto, 
				dt_periodo_inicial, 
				dt_periodo_final, 
				dt_atualizacao, 
				nm_usuario, 
				cd_convenio_parametro, 
				nr_protocolo, 
				dt_mesano_referencia, 
				dt_mesano_contabil, 
				cd_convenio_calculo, 
				cd_categoria_calculo, 
				nr_interno_conta, 
				nr_seq_protocolo, 
				cd_categoria_parametro, 
				ds_inconsistencia, 
				dt_recalculo, 
				cd_estabelecimento, 
				ie_cancelamento, 
				nr_lote_contabil, 
				nr_seq_apresent, 
				ie_complexidade, 
				ie_tipo_nascimento, 
				ie_tipo_guia, 
				cd_autorizacao, 
				vl_conta, 
				vl_desconto, 
				dt_cancelamento, 
				cd_proc_princ, 
				nr_seq_conta_origem, 
				nr_conta_convenio, 
				dt_conta_definitiva, 
				dt_conta_protocolo, 
				nr_seq_conta_prot, 
				nr_seq_pq_protocolo, 
				ds_observacao, 
				ie_tipo_atend_tiss, 
				nr_seq_saida_consulta, 
				nr_seq_saida_int, 
				nr_seq_saida_spsadt, 
				dt_geracao_tiss, 
				nr_lote_repasse, 
				ie_reapresentacao_sus, 
				nr_seq_ret_glosa, 
				dt_prev_protocolo, 
				nr_conta_pacote_exced, 
				dt_alta_tiss, 
				dt_entrada_tiss, 
				ie_tipo_fatur_tiss, 
				ie_tipo_consulta_tiss, 
				cd_especialidade_conta, 
				cd_plano_retorno_conv, 
				ie_tipo_atend_conta, 
				qt_dias_conta, 
				cd_responsavel, 
				nr_seq_estagio_conta, 
				nm_usuario_original, 
				nr_seq_audit_hist_glosa, 
				vl_repasse_conta, 
				nr_fechamento, 
				nr_seq_tipo_fatura, 
				nr_seq_apresentacao, 
				nr_seq_motivo_cancel, 
				dt_conferencia_sus, 
				cd_medico_conta, 
				qt_dias_periodo, 
				dt_geracao_resumo, 
				vl_conta_relat, 
				ie_faec, 
				nr_seq_apresent_sus, 
				nr_seq_status_fat, 
				nr_seq_status_mob, 
				nr_seq_regra_fluxo, 
				dt_atual_conta_conv, 
				nr_conta_orig_desdob, 
				pr_coseguro_hosp, 
				pr_coseguro_honor, 
				vl_deduzido, 
				vl_base_conta, 
				dt_definicao_conta) 
	SELECT	nr_atendimento,			-- nr_atendimento 
		dt_acerto_conta,			-- dt_acerto_conta 
		ie_status_acerto,			-- ie_status_acerto 
		dt_periodo_inicial,			-- dt_periodo_inicial 
		dt_periodo_final,			-- dt_periodo_final 
		clock_timestamp(),				-- dt_atualizacao 
		nm_usuario_p,			-- nm_usuario 
		cd_convenio_parametro,		-- cd_convenio_parametro 
		nr_protocolo,			-- nr_protocolo 
		dt_mesano_referencia,		-- dt_mesano_referencia 
		dt_mesano_contabil,		-- dt_mesano_contabil 
		cd_convenio_calculo,		-- cd_convenio_calculo 
		cd_categoria_calculo,		-- cd_categoria_calculo 
		nr_interno_conta_nova_w,		-- nr_interno_conta 
		nr_seq_protocolo,			-- nr_seq_protocolo 
		cd_categoria_parametro,		-- cd_categoria_parametro 
		ds_inconsistencia,			-- ds_inconsistencia 
		dt_recalculo,			-- dt_recalculo 
		cd_estabelecimento,		-- cd_estabelecimento 
		ie_cancelamento,			-- ie_cancelamento 
		nr_lote_contabil,			-- nr_lote_contabil 
		nr_seq_apresent,			-- nr_seq_apresent 
		ie_complexidade,			-- ie_complexidade 
		ie_tipo_nascimento,			-- ie_tipo_nascimento 
		ie_tipo_guia,			-- ie_tipo_guia 
		cd_autorizacao,			-- cd_autorizacao 
		vl_conta,				-- vl_conta 
		vl_desconto,			-- vl_desconto 
		dt_cancelamento,			-- dt_cancelamento 
		cd_proc_princ,			-- cd_proc_princ 
		nr_seq_conta_origem,		-- nr_seq_conta_origem 
		nr_conta_convenio,			-- nr_conta_convenio 
		dt_conta_definitiva,			-- dt_conta_definitiva 
		dt_conta_protocolo,			-- dt_conta_protocolo 
		nr_seq_conta_prot,			-- nr_seq_conta_prot 
		nr_seq_pq_protocolo,		-- nr_seq_pq_protocolo 
		ds_observacao,			-- ds_observacao 
		ie_tipo_atend_tiss,			-- ie_tipo_atend_tiss 
		nr_seq_saida_consulta,		-- nr_seq_saida_consulta 
		nr_seq_saida_int,			-- nr_seq_saida_int 
		nr_seq_saida_spsadt,		-- nr_seq_saida_spsadt 
		dt_geracao_tiss,			-- dt_geracao_tiss 
		nr_lote_repasse,			-- nr_lote_repasse 
		ie_reapresentacao_sus,		-- ie_reapresentacao_sus 
		nr_seq_ret_glosa,			-- nr_seq_ret_glosa 
		dt_prev_protocolo,			-- dt_prev_protocolo 
		nr_conta_pacote_exced,		-- nr_conta_pacote_exced 
		dt_alta_tiss,			-- dt_alta_tiss 
		dt_entrada_tiss,			-- dt_entrada_tiss 
		ie_tipo_fatur_tiss,			-- ie_tipo_fatur_tiss 
		ie_tipo_consulta_tiss,		-- ie_tipo_consulta_tiss 
		cd_especialidade_conta,		-- cd_especialidade_conta 
		cd_plano_retorno_conv,		-- cd_plano_retorno_conv 
		ie_tipo_atend_conta,		-- ie_tipo_atend_conta 
		qt_dias_conta,			-- qt_dias_conta 
		cd_responsavel,			-- cd_responsavel 
		nr_seq_estagio_conta,		-- nr_seq_estagio_conta 
		nm_usuario_original,		-- nm_usuario_original 
		nr_seq_audit_hist_glosa,		-- nr_seq_audit_hist_glosa 
		vl_repasse_conta,			-- vl_repasse_conta 
		nr_fechamento,			-- nr_fechamento 
		nr_seq_tipo_fatura,			-- nr_seq_tipo_fatura 
		nr_seq_apresentacao,		-- nr_seq_apresentacao 
		nr_seq_motivo_cancel,		-- nr_seq_motivo_cancel 
		dt_conferencia_sus,		-- dt_conferencia_sus 
		cd_medico_conta,			-- cd_medico_conta 
		qt_dias_periodo,			-- qt_dias_periodo 
		dt_geracao_resumo,		-- dt_geracao_resumo 
		vl_conta_relat,			-- vl_conta_relat 
		ie_faec,				-- ie_faec 
		nr_seq_apresent_sus,		-- nr_seq_apresent_sus 
		nr_seq_status_fat,			-- nr_seq_status_fat 
		nr_seq_status_mob,			-- nr_seq_status_mob 
		nr_seq_regra_fluxo,			-- nr_seq_regra_fluxo 
		dt_atual_conta_conv,		-- dt_atual_conta_conv 
		nr_conta_orig_desdob,		-- nr_conta_orig_desdob 
		pr_coseguro_hosp_p,		-- pr_coseguro_hosp 
		pr_coseguro_honor_p,		-- pr_coseguro_honor 
		vl_deduzido_p,			-- vl_deduzido 
		vl_base_conta_p,			-- vl_base_conta 
		clock_timestamp()				-- dt_definicao_conta 
	from	conta_paciente 
	where	nr_interno_conta = nr_interno_conta_p;
	 
	commit;
end if;
 
nr_interno_conta_nova_p := nr_interno_conta_nova_w;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_conta_fatura ( nr_interno_conta_p bigint, nr_interno_conta_nova_p INOUT bigint, pr_coseguro_hosp_p bigint, pr_coseguro_honor_p bigint, vl_deduzido_p bigint, vl_base_conta_p bigint, nm_usuario_p text) FROM PUBLIC;

