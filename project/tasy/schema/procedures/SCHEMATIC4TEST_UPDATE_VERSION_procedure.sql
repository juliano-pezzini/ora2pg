-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE schematic4test_update_version (NR_SEQUENCIA_P bigint, DS_VERSION_P text, IE_TIPO_P text, NM_USUARIO_P text) AS $body$
BEGIN
    --procedure that update script or suite
	IF (NR_SEQUENCIA_P IS NOT NULL AND NR_SEQUENCIA_P::text <> '') THEN
		IF (IE_TIPO_P = '1') THEN
			UPDATE SCHEM_TEST_SCRIPT SET DS_VERSION = DS_VERSION_P, NM_USUARIO = NM_USUARIO_P, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = NR_SEQUENCIA_P;
		ELSE
			IF (IE_TIPO_P = '2') THEN
				UPDATE SCHEM_TEST_SCRIPT SET DS_VERSION = DS_VERSION_P, NM_USUARIO = NM_USUARIO_P, DT_ATUALIZACAO = clock_timestamp() WHERE NR_SEQUENCIA = (SELECT NR_SEQ_SCRIPT FROM SCHEM_TEST_TEST WHERE NR_SEQUENCIA = NR_SEQUENCIA_P);
			END IF;
		END IF;	
		COMMIT;
    END IF;		
    EXCEPTION
    WHEN no_data_found THEN
      RAISE NOTICE 'Erro: Data not found';
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE schematic4test_update_version (NR_SEQUENCIA_P bigint, DS_VERSION_P text, IE_TIPO_P text, NM_USUARIO_P text) FROM PUBLIC;

