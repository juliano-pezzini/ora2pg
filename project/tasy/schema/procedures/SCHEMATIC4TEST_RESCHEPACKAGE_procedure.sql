-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE schematic4test_reschepackage (NR_SEQUENCIA_P bigint, NM_USUARIO_P text) AS $body$
DECLARE

NR_SEQUENCIA_W bigint;
NR_SEQ_PACKAGE_W bigint;
DS_VERSION_W varchar(255);
NM_OWNER_W varchar(255);
NM_USUARIO_W varchar(15);
NM_USUARIO_NREC_W varchar(15);
DS_INFO_W varchar(255);
IE_ESTAG_EXECW varchar(255);
IE_VIDEOW varchar(255);
IE_AUTO_RESTOREW varchar(255);


BEGIN
  --procedure that duplicate group  
  INSERT INTO SCHEM_TEST_BEHOLDER(nr_sequencia, nm_usuario, dt_atualizacao, nm_usuario_nrec, dt_atualizacao_nrec, ds_interaction, ds_param_a)
		VALUES (nextval('schem_test_beholder_seq'), NM_USUARIO_P, clock_timestamp(), 'Robot', clock_timestamp(), 'SCHEMATIC4TEST_RESCHEPACKAGE',
		'NR_SEQUENCIA_P as '||NR_SEQUENCIA_P);

  SELECT sched.NR_SEQUENCIA NR_SEQUENCIA, sched.NR_SEQ_PACKAGE NR_SEQ_PACKAGE, sched.DS_VERSION DS_VERSION, sched.NM_OWNER NM_OWNER, sched.NM_USUARIO NM_USUARIO, sched.NM_USUARIO_NREC NM_USUARIO_NREC, sched.DS_INFO DS_INFO, sched.IE_ESTAG_EXEC, sched.IE_VIDEO, sched.IE_AUTO_RESTORE
      INTO STRICT NR_SEQUENCIA_W, NR_SEQ_PACKAGE_W, DS_VERSION_W, NM_OWNER_W, NM_USUARIO_W, NM_USUARIO_NREC_W, DS_INFO_W, IE_ESTAG_EXECW, IE_VIDEOW, IE_AUTO_RESTOREW 
  FROM SCHEM_TEST_PACKAGE_SCHED sched
  WHERE sched.NR_SEQUENCIA = NR_SEQUENCIA_P;
                        
  IF (NR_SEQUENCIA_W IS NOT NULL AND NR_SEQUENCIA_W::text <> '') THEN       
    INSERT INTO SCHEM_TEST_PACKAGE_SCHED(nr_sequencia, nr_seq_package, ds_version, nm_owner, nm_usuario, nm_usuario_nrec, ds_info, dt_schedule, dt_atualizacao, dt_atualizacao_nrec, ie_status, IE_ESTAG_EXEC, IE_VIDEO, IE_AUTO_RESTORE)
					VALUES (nextval('schem_test_package_sched_seq'), NR_SEQ_PACKAGE_W, DS_VERSION_W, NM_USUARIO_P, NM_USUARIO_P, NM_USUARIO_P, DS_INFO_W, clock_timestamp(), clock_timestamp(), clock_timestamp(), '1', '0', IE_VIDEOW, IE_AUTO_RESTOREW);
    COMMIT;
  END IF;
  EXCEPTION
  WHEN no_data_found THEN
    RAISE NOTICE 'Erro: Data not found';
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE schematic4test_reschepackage (NR_SEQUENCIA_P bigint, NM_USUARIO_P text) FROM PUBLIC;

