-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE copiar_repasse_terceiro_regra (nr_repasse_terc_origem_p bigint, nr_repasse_terc_destino_p bigint, nm_usuario_p text) AS $body$
DECLARE


cd_regra_w		bigint;
ie_tipo_convenio_w      smallint;
cd_convenio_w           integer;
ie_tipo_atendimento_w   smallint;
dt_prot_inicial_w       timestamp;
dt_prot_final_w         timestamp;
dt_prot_par_inicial_w   timestamp;
dt_prot_par_fina_l_w    timestamp;
cd_plano_w              varchar(10);
cd_setor_atendimento_w  integer;
ds_protocolos_w         varchar(255);
cd_medico_executor_w    varchar(10);
dt_ditado_inicial_w     timestamp;
dt_ditado_final_w       timestamp;
nr_seq_tipo_plantao_w   bigint;


c01 CURSOR FOR
SELECT	cd_regra,
	ie_tipo_convenio,
	cd_convenio,
	ie_tipo_atendimento,
	dt_prot_inicial,
	dt_prot_final,
	dt_prot_par_inicial,
	dt_prot_par_final,
	cd_plano,
	cd_setor_atendimento,
	ds_protocolos,
	cd_medico_executor,
	dt_ditado_inicial,
	dt_ditado_final,
	nr_seq_tipo_plantao
from	repasse_terceiro_regra
where	nr_repasse_terceiro	= nr_repasse_terc_origem_p;


BEGIN

open C01;
loop
fetch C01 into
	cd_regra_w,
	ie_tipo_convenio_w,
	cd_convenio_w,
	ie_tipo_atendimento_w,
	dt_prot_inicial_w,
	dt_prot_final_w,
	dt_prot_par_inicial_w,
	dt_prot_par_fina_l_w,
	cd_plano_w,
	cd_setor_atendimento_w,
	ds_protocolos_w,
	cd_medico_executor_w,
	dt_ditado_inicial_w,
	dt_ditado_final_w,
	nr_seq_tipo_plantao_w;
EXIT WHEN NOT FOUND; /* apply on C01 */

	insert into repasse_terceiro_regra(nr_sequencia,
		dt_atualizacao,
		nm_usuario,
		nr_repasse_terceiro,
		cd_regra,
		ie_tipo_convenio,
		cd_convenio,
		ie_tipo_atendimento,
		dt_prot_inicial,
		dt_prot_final,
		dt_prot_par_inicial,
		dt_prot_par_final,
		cd_plano,
		cd_setor_atendimento,
		ds_protocolos,
		cd_medico_executor,
		dt_ditado_inicial,
		dt_ditado_final,
		nr_seq_tipo_plantao)
	values (nextval('repasse_terceiro_regra_seq'),
		clock_timestamp(),
		nm_usuario_p,
		nr_repasse_terc_destino_p,
		cd_regra_w,
		ie_tipo_convenio_w,
		cd_convenio_w,
		ie_tipo_atendimento_w,
		dt_prot_inicial_w,
		dt_prot_final_w,
		dt_prot_par_inicial_w,
		dt_prot_par_fina_l_w,
		cd_plano_w,
		cd_setor_atendimento_w,
		ds_protocolos_w,
		cd_medico_executor_w,
		dt_ditado_inicial_w,
		dt_ditado_final_w,
		nr_seq_tipo_plantao_w);

end loop;
close C01;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE copiar_repasse_terceiro_regra (nr_repasse_terc_origem_p bigint, nr_repasse_terc_destino_p bigint, nm_usuario_p text) FROM PUBLIC;

