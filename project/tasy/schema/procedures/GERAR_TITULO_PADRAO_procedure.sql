-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_titulo_padrao ( vl_titulo_p bigint, vl_saldo_titulo_p bigint, cd_pessoa_fisica_p text, cd_cgc_p text, dt_emissao_p timestamp, dt_vencimento_atual_p timestamp, dt_vencimento_original_p timestamp, dt_contabil_p timestamp, nr_bloqueto_p text, nr_seq_classe_p bigint, cd_estab_financeiro_p bigint, ds_observacao_titulo_p text, nm_usuario_p text, cd_estabelecimento_p bigint, ie_pls_p text, cd_tipo_baixa_neg_p bigint, nr_titulo_gerado_p INOUT bigint) AS $body$
DECLARE


cd_moeda_w		integer;
nr_titulo_gerado_w	bigint;


BEGIN

select	max(a.cd_moeda_padrao)
into STRICT	cd_moeda_w
FROM moeda g, pessoa_juridica c, estabelecimento b, parametros_contas_pagar a
LEFT OUTER JOIN tipo_baixa_cpa d ON (a.cd_tipo_baixa_padrao = d.cd_tipo_baixa)
LEFT OUTER JOIN tipo_baixa_cpa e ON (a.cd_tipo_baixa_devolucao = e.cd_tipo_baixa)
LEFT OUTER JOIN tipo_baixa_cpa f ON (a.cd_tipo_baixa_estorno = f.cd_tipo_baixa)
WHERE a.cd_estabelecimento		= b.cd_estabelecimento and b.cd_cgc			= c.cd_cgc    and a.cd_moeda_padrao		= g.cd_moeda and b.cd_estabelecimento		= obter_estabelecimento_ativo;

select	nextval('titulo_pagar_seq')
into STRICT	nr_titulo_gerado_w
;

insert 	into titulo_pagar(
		nr_titulo,
		vl_titulo,
		vl_saldo_titulo,
		cd_pessoa_fisica,
		cd_cgc,
		dt_emissao,
		dt_vencimento_atual,
		dt_vencimento_original,
		dt_contabil,
		nr_bloqueto,
		cd_estab_financeiro,
		ds_observacao_titulo,
		nr_seq_classe,
		cd_estabelecimento,
		cd_moeda,
		cd_tipo_taxa_juro,
		cd_tipo_taxa_multa,
		dt_atualizacao,
		ie_origem_titulo,
		ie_situacao,
		ie_tipo_titulo,
		nm_usuario,
		tx_juros,
		tx_multa,
		vl_saldo_juros,
		vl_saldo_multa,
		ie_bloqueto,
		nr_lote_contabil,
		vl_outros_acrescimos,
		vl_inss,
		vl_ir,
		tx_desc_antecipacao,
		vl_out_desp_bordero,
		cd_tipo_taxa_antecipacao,
		vl_imposto_munic,
		ie_desconto_dia,
		ie_status_tributo,
		vl_bloq_juros,
		vl_bloq_desc,
		ie_pls,
		cd_tipo_baixa_neg,
		vl_outras_despesas)
	values (
		nr_titulo_gerado_w,
		vl_titulo_p,
		vl_saldo_titulo_p,
		cd_pessoa_fisica_p,
		cd_cgc_p,
		dt_emissao_p,
		dt_vencimento_atual_p,
		dt_vencimento_original_p,
		dt_contabil_p,
		nr_bloqueto_p,
		cd_estab_financeiro_p,
		ds_observacao_titulo_p,
		nr_seq_classe_p,
		cd_estabelecimento_p,
		cd_moeda_w,
		1,
		1,
		clock_timestamp(),
		2,
		'A',
		1,
		nm_usuario_p,
		0,
		0,
		0,
		0,
		'N',
		0,
		0,
		0,
		0,
		0,
		0,
		1,
		0,
		'N',
		'N',
		0,
		0,
		ie_pls_p,
		cd_tipo_baixa_neg_p,
		0);

commit;

nr_titulo_gerado_p := nr_titulo_gerado_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_titulo_padrao ( vl_titulo_p bigint, vl_saldo_titulo_p bigint, cd_pessoa_fisica_p text, cd_cgc_p text, dt_emissao_p timestamp, dt_vencimento_atual_p timestamp, dt_vencimento_original_p timestamp, dt_contabil_p timestamp, nr_bloqueto_p text, nr_seq_classe_p bigint, cd_estab_financeiro_p bigint, ds_observacao_titulo_p text, nm_usuario_p text, cd_estabelecimento_p bigint, ie_pls_p text, cd_tipo_baixa_neg_p bigint, nr_titulo_gerado_p INOUT bigint) FROM PUBLIC;

