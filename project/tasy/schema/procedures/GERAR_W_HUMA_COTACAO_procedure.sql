-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_w_huma_cotacao ( cd_fornecedor_p text, nm_fornecedor_p text, tp_frete_p text, vl_cotacao_p text, ie_situacao_p text, dt_cotacao_p text, dt_venda_p text, vl_venda_p text, dt_validade_p text, nm_vendedor_p text, vl_fatura_min_p text, ds_prazo_entrega_p text, ds_observacao_p text, ds_condicao_pagto_p text, cd_cep_fornecedor_p text, ds_endereco_fornec_p text, ds_municipio_fornec_p text, nm_razao_social_fornec_p text, sg_estado_fornec_p text, cd_condicao_pagamento_p text, qt_dias_entrega_p text, nm_usuario_p text, nr_cot_compra_p bigint default null, nr_seq_cotacao_p INOUT text DEFAULT NULL) AS $body$
DECLARE


nr_seq_cotacao_w	bigint;
dt_cotacao_w	timestamp;
dt_venda_w	timestamp;
dt_validade_w	timestamp;


BEGIN

dt_cotacao_w 	:= to_date(dt_cotacao_p,'yyyy-mm-dd');
dt_venda_w 	:= to_date(dt_venda_p,'yyyy-mm-dd');
dt_validade_w 	:= to_date(dt_validade_p,'yyyy-mm-dd');

select	nextval('w_huma_cotacao_seq')
into STRICT	nr_seq_cotacao_w
;

insert into w_huma_cotacao(
	nr_sequencia,
	nr_cot_compra,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	cd_fornecedor,
	nm_fornecedor,
	tp_frete,
	vl_cotacao,
	ie_situacao,
	dt_cotacao,
	dt_venda,
	vl_venda,
	dt_validade,
	nm_vendedor,
	vl_fatura_min,
	ds_prazo_entrega,
	ds_observacao,
	ds_condicao_pagto,
	nr_cep,
	ds_endereco,
	ds_municipio,
	ds_razao_social,
	sg_estado,
	cd_condicao_pagamento,
	qt_dias_entrega)
values (	nr_seq_cotacao_w,
	nr_cot_compra_p,
	clock_timestamp(),
	nm_usuario_p,
	clock_timestamp(),
	nm_usuario_p,
	substr(cd_fornecedor_p,1,14),
	substr(nm_fornecedor_p,1,100),
	substr(tp_frete_p,1,3),
	(replace(vl_cotacao_p,'.',','))::numeric ,
	substr(ie_situacao_p,1,1),
	dt_cotacao_w,
	dt_venda_w,
	(replace(vl_venda_p,'.',','))::numeric ,
	dt_validade_w,
	substr(nm_vendedor_p,1,100),
	(replace(vl_fatura_min_p,'.',','))::numeric ,
	substr(ds_prazo_entrega_p,1,255),
	substr(ds_observacao_p,1,100),
	substr(ds_condicao_pagto_p,1,255),
	substr(cd_cep_fornecedor_p,1,15),
	substr(ds_endereco_fornec_p,1,40),
	substr(ds_municipio_fornec_p,1,40),
	substr(nm_razao_social_fornec_p,1,80),
	substr(sg_estado_fornec_p,1,15),
	substr(cd_condicao_pagamento_p,1,10),
	substr(qt_dias_entrega_p,1,10));

nr_seq_cotacao_p := nr_seq_cotacao_w;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_w_huma_cotacao ( cd_fornecedor_p text, nm_fornecedor_p text, tp_frete_p text, vl_cotacao_p text, ie_situacao_p text, dt_cotacao_p text, dt_venda_p text, vl_venda_p text, dt_validade_p text, nm_vendedor_p text, vl_fatura_min_p text, ds_prazo_entrega_p text, ds_observacao_p text, ds_condicao_pagto_p text, cd_cep_fornecedor_p text, ds_endereco_fornec_p text, ds_municipio_fornec_p text, nm_razao_social_fornec_p text, sg_estado_fornec_p text, cd_condicao_pagamento_p text, qt_dias_entrega_p text, nm_usuario_p text, nr_cot_compra_p bigint default null, nr_seq_cotacao_p INOUT text DEFAULT NULL) FROM PUBLIC;

