-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE prc_matrix_validar_autentic (nr_prescricao_p bigint, usuario_p text, senha_p text, sis_integracao_p text) AS $body$
DECLARE

retorno integer;

--1 Encontrou informacao/esta validado
--0 Nao encontrou informacao/nao esta validado
BEGIN

select CASE WHEN count(*)=0 THEN 0  ELSE 1 END
into STRICT   retorno
from   prescr_medica pm,
       lab_parametro lp
where  pm.nr_prescricao = nr_prescricao_p
and    lp.cd_estabelecimento = pm.cd_estabelecimento
and    lp.ds_usuario_matrix = usuario_p
and    lp.ds_senha_matrix = senha_p
and    lp.ds_sistema_ext_matrix = sis_integracao_p;

if (retorno = 0) then
   CALL WHEB_MENSAGEM_PCK.exibir_mensagem_abort(nr_seq_mensagem_p => 1109344);
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE prc_matrix_validar_autentic (nr_prescricao_p bigint, usuario_p text, senha_p text, sis_integracao_p text) FROM PUBLIC;

