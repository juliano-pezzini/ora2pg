-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE cpoe_regra_disp_semanal ( cd_setor_atendimento_p cpoe_week_dispens_rule.cd_setor_atendimento%type, ie_via_aplicacao_p cpoe_week_dispens_rule.ie_via_aplicacao%type, nr_sequencia_p INOUT cpoe_week_dispens_rule.nr_sequencia%type, hr_dispensation_time_p INOUT cpoe_week_dispens_rule.hr_dispensation_time%type, si_dispensation_day_p INOUT cpoe_week_dispens_rule.si_dispensation_day%type) AS $body$
DECLARE

	
c01 CURSOR FOR
SELECT	nr_sequencia,
		hr_dispensation_time,
		si_dispensation_day
from	cpoe_week_dispens_rule
where (ie_via_aplicacao = ie_via_aplicacao_p or coalesce(ie_via_aplicacao::text, '') = '')
and (cd_setor_atendimento = cd_setor_atendimento_p or coalesce(cd_setor_atendimento::text, '') = '')
order by ie_via_aplicacao desc;
rule_week c01%rowtype;
	

BEGIN

	nr_sequencia_p := null;
	hr_dispensation_time_p := null;
	si_dispensation_day_p := null;
	
	for rule_week in c01
	loop
		
		nr_sequencia_p := rule_week.nr_sequencia;
		hr_dispensation_time_p := rule_week.hr_dispensation_time;
		si_dispensation_day_p := rule_week.si_dispensation_day;
	
	end loop;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE cpoe_regra_disp_semanal ( cd_setor_atendimento_p cpoe_week_dispens_rule.cd_setor_atendimento%type, ie_via_aplicacao_p cpoe_week_dispens_rule.ie_via_aplicacao%type, nr_sequencia_p INOUT cpoe_week_dispens_rule.nr_sequencia%type, hr_dispensation_time_p INOUT cpoe_week_dispens_rule.hr_dispensation_time%type, si_dispensation_day_p INOUT cpoe_week_dispens_rule.si_dispensation_day%type) FROM PUBLIC;

