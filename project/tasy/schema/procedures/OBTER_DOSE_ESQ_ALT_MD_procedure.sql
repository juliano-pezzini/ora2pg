-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE obter_dose_esq_alt_md (ds_aux_p INOUT text, ie_separador_padrao_p char, nr_etapas_ww_p bigint, nls_numeric_characters_p text, ds_aux_ww_p INOUT text, qt_dose_mat_p INOUT bigint) AS $body$
DECLARE

posicao bigint;

BEGIN
  if (ds_aux_p IS NOT NULL AND ds_aux_p::text <> '') then
	if (substr(ds_aux_p, length(ds_aux_p)) <> ie_separador_padrao_p) then
	  ds_aux_p := ds_aux_p || ie_separador_padrao_p;
	end if;

	for i in 1 .. nr_etapas_ww_p loop
	  begin
		posicao := position(ie_separador_padrao_p in ds_aux_p);

		if (nls_numeric_characters_p = '. ') then
		  ds_aux_ww_p := replace(substr(ds_aux_p, 1, posicao - 1),
							   ',',
							   '.');
		else
		  ds_aux_ww_p := substr(ds_aux_p, 1, posicao - 1);
		end if;

		qt_dose_mat_p := coalesce(qt_dose_mat_p, 0) +
						 coalesce((ds_aux_ww_p)::numeric , 0);

		ds_aux_p := substr(ds_aux_p, posicao + 1);
	  end;
	end loop;
  end if;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE obter_dose_esq_alt_md (ds_aux_p INOUT text, ie_separador_padrao_p char, nr_etapas_ww_p bigint, nls_numeric_characters_p text, ds_aux_ww_p INOUT text, qt_dose_mat_p INOUT bigint) FROM PUBLIC;

