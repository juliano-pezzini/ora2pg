-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE atualizar_procedimento_sus () AS $body$
BEGIN
/* ATUALIZAR GRUPO DOS PROCEDIMENTOS SUS */

/* Zera Todos */

update	procedimento
set 	cd_grupo_sus = '0'
where 	ie_origem_proced = 2;

/* SADT */

update	procedimento
set 	cd_grupo_sus = '1'
where 	ie_origem_proced = 2
and 	cd_procedimento between 00000001 and 23999999;

/* SP Externo */

update	procedimento
set 	cd_grupo_sus = '2'
where 	ie_origem_proced = 2
and 	cd_procedimento between 24000000 and 30999999;

/* SP Externo - Anestesista */

update	procedimento
set 	cd_grupo_sus = '2'
where	ie_origem_proced = 2
and 	cd_procedimento = 45000050;

/* SSM */

update	procedimento
set	cd_grupo_sus = '3'
where	ie_origem_proced = 2
and	((cd_procedimento in (47810017,56110103, 68300018, 68500017, 95002022, 95009019)) or
	/*Elemar 15/09/2004 - 68300018, 68500017, 95007016, 95002022, 95008012, 95009019*/

	(cd_procedimento between 31000000 and 44999999) or (cd_procedimento between 69000000 and 91999999) or (cd_procedimento between 93000000 and 94999999) or (cd_procedimento between 48000000 and 48099999));

/*Felipe - 08/09/2006 - Reinaldo informou que esse grupo de procedimentos devem cair na coluna de SSM*/

update	procedimento
set 	cd_grupo_sus	= '3'
where 	ie_origem_proced = 2
and 	cd_procedimento between 62000000 and 62999999;

/* Diária de UTI Especial */

update	procedimento
/* Passado de 4 para 12 devido problema de totais do HSA que nao usa proc do tasy adelson 25052005*/

/* Desfiz alteração de Adelson - Elemar 07062005 */

set	cd_grupo_sus = '4'
where 	ie_origem_proced = 2
and 	cd_procedimento between 96000000 and 96999999;

/* Procedimentos Especiais */

update	procedimento
set 	cd_grupo_sus = '6'
where	ie_origem_proced = 2
and 	((cd_procedimento between 92000000 and 92999999) or (cd_procedimento between 97000000 and 99999999));

/* Procedimentos Especiais - Procedimentos não definidos*/

update	procedimento
set 	cd_grupo_sus = '6'
where 	ie_origem_proced = 2
and (cd_procedimento = 50000004);

/* Componente I*/

update	procedimento
set 	cd_grupo_sus = '15'
where 	ie_origem_proced = 2
and (cd_procedimento = 95002014);

/* Procedimentos Especiais - Psiquiatria*/

update	procedimento
set 	cd_grupo_sus = '6'
where 	ie_origem_proced = 2
and (cd_procedimento between 63000000 and 63999999);

/* Procedimentos Especiais - Reabilitação*/

update	procedimento
set 	cd_grupo_sus = '6'
where 	ie_origem_proced = 2
and (cd_procedimento between 67000000 and 67999999);

/* Sangue */

update	procedimento
set 	cd_grupo_sus = '7'
where	ie_origem_proced = 2
and 	((cd_procedimento between 94000000 and 94009999) or (cd_procedimento = 94020019));

/* Ortese e Protese */

update	procedimento
set 	cd_grupo_sus = '11'
where 	ie_origem_proced = 2
and 	cd_procedimento between 93300000 and 93999999;

/* Atend. RN */

update	procedimento
set 	cd_grupo_sus = '10'
where	ie_origem_proced = 2
and 	cd_procedimento in (95001018, 95003010, 95004017,95002022);

/* Felipe - 08/06/2006 - Inclui o código 99079011 de acordo com a portaria Nº 238*/

/* Diária de Acompanhante */

update	procedimento
set 	cd_grupo_sus = '5'
where	ie_origem_proced = 2
and 	cd_procedimento in ( 99080010, 99081016, 99080011, 99079011);

/* Transplante */

update	procedimento
set 	cd_grupo_sus = '8'
where 	ie_origem_proced = 2
and 	cd_procedimento between 46000000 and 47999999
and	cd_procedimento <> 47810017;

/* Perfusionista o sus trata como Transplante */

update	procedimento
set 	cd_grupo_sus = '8'
where	ie_origem_proced = 2
and 	cd_procedimento = 99086018;

/*Felipe - 08/09/2006 verificado com Reinaldo e no manual do SUS (pg88) que esses procedimentos devem ser tratados como transplante*/

update	procedimento
set 	cd_grupo_sus = '8'
where	ie_origem_proced = 2
and 	cd_procedimento in (	99800136,99800152,99800179,99800195,99800217,99800233,99800250,99800276,99800292,
				99800314,99800330,99800357,99800373,99800390,99800535,99801019,99802015,99870010,
				99871017,99872013,99873010,99874016,99875012,99876019,99877015,99878011,99879018,
				99880016,99881012,99882019,99883015,99884011,99885018,99887010,99888017);

/* Analgesia Obstetricia */

update	procedimento
set 	cd_grupo_sus = '13'
where	ie_origem_proced = 2
and 	cd_procedimento in (95003010, 95005013, 95006010);

/* Diária de UTI */

update	procedimento
set 	cd_grupo_sus = '12'
where	ie_origem_proced = 2
and 	cd_procedimento = 99080991;

/* Registro Civil */

update	procedimento
set 	cd_grupo_sus = '17'
where 	ie_origem_proced = 2
and 	cd_procedimento = 99085011;

/* Notificação de Agravo */

update	procedimento
set 	cd_grupo_sus = '16'
where	ie_origem_proced = 2
and 	cd_procedimento = 99083019;

/* Sífilis / HIV*/

update	procedimento
set 	cd_grupo_sus = '18'
where	ie_origem_proced = 2
and 	cd_procedimento in (95008012,95007016);

/* Cateterismo */

update	procedimento
set 	cd_grupo_sus = '19'
where	ie_origem_proced = 2
and 	cd_procedimento in (97004057,97001058,97021008,97022004,97023000,97024007,97025003,97026000,
				97029009,97030007,97031003,97032000,97033006,97027006,97028002);

/* P. Renal agudo */

update	procedimento
set	cd_grupo_sus = '20'
where	ie_origem_proced = 2
and	cd_procedimento = 99042010;

/* Nutricao */

update	procedimento
set 	cd_grupo_sus = '14'
where 	ie_origem_proced = 2
and 	cd_procedimento in (98300016, 98500015);

/* Neurocirurgia */

/* incluido codigos 97209007 e 97210005 OS 25106 */

update	procedimento
set 	cd_grupo_sus = '9'
where 	ie_origem_proced = 2
and 	((cd_procedimento between 97220000 and 97229999) or (cd_procedimento = 97209007) or (cd_procedimento = 97210005));

/* ATUALIZAR MAXIMO DE QUANTIDADE DOS PROCEDIMENTOS SUS */

/* Inicializa */

update	procedimento
set 	qt_max_procedimento = 99
where 	ie_origem_proced = 2;

update procedimento
set qt_max_procedimento = 1
where ie_origem_proced = 2
and cd_procedimento between 31000000 and 44999999;

update procedimento
set qt_max_procedimento = 99999
where ie_origem_proced <> 2
and (coalesce(qt_max_procedimento::text, '') = '' or
	 qt_max_procedimento = 0);

/* ATUALIZAR IE_EXIGE_LAUDO DOS PROCEDIMENTOS SUS */

/* Inicializa */

update procedimento
set ie_exige_laudo = 'N'
where ie_origem_proced = 2;


/* Inicializa */

update procedimento
set ie_exige_laudo = 'S'
where ie_origem_proced = 2
and   ((cd_procedimento = 99020017) 		or (substr(cd_procedimento,1,2) = '92')	or (substr(cd_procedimento,1,5) = '99300')	or (substr(cd_procedimento,1,5) = '99500')	or (substr(cd_procedimento,1,5) = '97013')	or (substr(cd_procedimento,1,5) = '97014')	or (substr(cd_procedimento,1,5) = '97015')	or (substr(cd_procedimento,1,5) = '99003')	or (substr(cd_procedimento,1,5) = '99063')	or (substr(cd_procedimento,1,5) = '98300')	or (substr(cd_procedimento,1,5) = '76400')	or (substr(cd_procedimento,1,5) = '98500'));

update procedimento
set ie_exige_laudo = 'S'
where ie_origem_proced = 2
and   ((substr(cd_procedimento,1,5) between 97001 and 97012)	or (substr(cd_procedimento,1,5) between 97203 and 97223)	or (cd_procedimento between 69000000 and 91999999)		or (cd_procedimento between 31000000 and 44999999));

/* De acordo com portaria PT-MS-GM 2292-98 estes procedimentos são cobrados como serviços profissionais OS28091 */

update procedimento
set ie_exige_laudo = 'N'
where ie_origem_proced = 2
and cd_procedimento in (97209007,97210005);

commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE atualizar_procedimento_sus () FROM PUBLIC;

