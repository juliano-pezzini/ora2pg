-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE exportar_filtro_perfil ( nm_usuario_p text, nm_filtro_p text, cd_funcao_p bigint, cd_perfil_p bigint, cd_perfil_usu_p bigint) AS $body$
DECLARE


ds_filtro_w			varchar(80);
ie_tipo_campo_w			varchar(1);
ds_campo_w			varchar(50);
ie_origem_w			varchar(3);
cd_dominio_w			bigint;
ds_sql_w			varchar(2000);
ie_tipo_filtro_w		varchar(1);
vl_campo_w			varchar(4000);
nm_usuario_ref_w		varchar(15);
nr_seq_tipo_localizar_w		bigint;
cd_estabelecimento_w		integer;
nr_seq_filtro_w			bigint;
nm_filtro_w			varchar(80);
ds_filtro_dinamico_w		varchar(4000);

c01 CURSOR FOR
SELECT	ds_filtro,
	ie_tipo_campo,
	ds_campo,
	ie_origem,
	cd_dominio,
	ds_sql,
	ie_tipo_filtro,
	vl_campo,
	nm_usuario_ref,
	nr_seq_tipo_localizar,
	cd_estabelecimento,
	nr_seq_filtro,
	nm_filtro,
	ds_filtro_dinamico
from	funcao_filtro
where	cd_funcao = cd_funcao_p
and	cd_perfil = cd_perfil_usu_p
and	nm_filtro = nm_filtro_p;


BEGIN
open c01;
loop
fetch c01 into
	ds_filtro_w,
	ie_tipo_campo_w,
	ds_campo_w,
	ie_origem_w,
	cd_dominio_w,
	ds_sql_w,
	ie_tipo_filtro_w,
	vl_campo_w,
	nm_usuario_ref_w,
	nr_seq_tipo_localizar_w,
	cd_estabelecimento_w,
	nr_seq_filtro_w,
	nm_filtro_w,
	ds_filtro_dinamico_w;
EXIT WHEN NOT FOUND; /* apply on c01 */
	begin
	insert	into funcao_filtro(
			nr_sequencia,
			dt_atualizacao,
			nm_usuario,
			ds_filtro,
			ie_tipo_campo,
			ds_campo,
			cd_funcao,
			ie_origem,
			cd_dominio,
			ds_sql,
			dt_atualizacao_nrec,
			nm_usuario_nrec,
			ie_tipo_filtro,
			vl_campo,
			nm_usuario_ref,
			nr_seq_tipo_localizar,
			cd_estabelecimento,
			nr_seq_filtro,
			nm_filtro,
			ds_filtro_dinamico,
			cd_perfil)
		values (	nextval('funcao_filtro_seq'),
			clock_timestamp(),
			nm_usuario_p,
			ds_filtro_w,
			ie_tipo_campo_w,
			ds_campo_w,
			cd_funcao_p,
			ie_origem_w,
			cd_dominio_w,
			ds_sql_w,
			clock_timestamp(),
			nm_usuario_p,
			ie_tipo_filtro_w,
			vl_campo_w,
			nm_usuario_ref_w,
			nr_seq_tipo_localizar_w,
			cd_estabelecimento_w,
			nr_seq_filtro_w,
			nm_filtro_w,
			ds_filtro_dinamico_w,
			cd_perfil_p);
	end;
end loop;
close c01;
commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE exportar_filtro_perfil ( nm_usuario_p text, nm_filtro_p text, cd_funcao_p bigint, cd_perfil_p bigint, cd_perfil_usu_p bigint) FROM PUBLIC;

