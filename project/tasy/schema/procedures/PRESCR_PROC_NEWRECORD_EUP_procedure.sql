-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE prescr_proc_newrecord_eup (cd_convenio_p bigint, nr_atendimento_cat_p bigint, cd_estabelecimento_p bigint, ie_obter_se_exige_cpf_p text, nr_atendimento_p bigint, cd_pessoa_fisica_p text, cd_pessoa_responsavel_p text, nr_prescricao_p bigint, nm_usuario_p text, ds_msg_erro_p INOUT text, ie_pasta_cadastro_p INOUT text, cd_setor_coleta_p INOUT bigint, nr_seq_interno_p INOUT bigint, ie_exige_cpf_paciente_p INOUT text) AS $body$
DECLARE

										 
ie_atualiza_setor_coleta_w	varchar(1);
										

BEGIN 
 
ie_exige_cpf_paciente_p := 'N';
 
ie_atualiza_setor_coleta_w := Obter_param_Usuario(916, 820, obter_perfil_ativo, nm_usuario_p, cd_estabelecimento_p, ie_atualiza_setor_coleta_w);
 
SELECT * FROM prescr_proc_newrec_abort_eup(cd_convenio_p, nr_atendimento_cat_p, cd_estabelecimento_p, ie_obter_se_exige_cpf_p, nr_atendimento_p, cd_pessoa_fisica_p, cd_pessoa_responsavel_p, nm_usuario_p, ds_msg_erro_p, ie_pasta_cadastro_p, nr_seq_interno_p, ie_exige_cpf_paciente_p) INTO STRICT ds_msg_erro_p, ie_pasta_cadastro_p, nr_seq_interno_p, ie_exige_cpf_paciente_p;
 
if (ds_msg_erro_p IS NOT NULL AND ds_msg_erro_p::text <> '') then 
	goto final;	
end if;
 
if (ie_atualiza_setor_coleta_w = 'S') then 
	cd_setor_coleta_p := obter_prim_setor_coleta_prescr(nr_prescricao_p);
end if;
 
<<final>> 
 
commit;
 
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE prescr_proc_newrecord_eup (cd_convenio_p bigint, nr_atendimento_cat_p bigint, cd_estabelecimento_p bigint, ie_obter_se_exige_cpf_p text, nr_atendimento_p bigint, cd_pessoa_fisica_p text, cd_pessoa_responsavel_p text, nr_prescricao_p bigint, nm_usuario_p text, ds_msg_erro_p INOUT text, ie_pasta_cadastro_p INOUT text, cd_setor_coleta_p INOUT bigint, nr_seq_interno_p INOUT bigint, ie_exige_cpf_paciente_p INOUT text) FROM PUBLIC;

