-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE atualiza_registro_questionavel ( nr_sequencia_interface_p bomba_infusao_interface.nr_sequencia%TYPE, ie_problema_p bomba_infusao_prob.ie_problema%TYPE ) AS $body$
BEGIN

    UPDATE bomba_infusao_prob
    SET
        dt_confirmacao = trunc(clock_timestamp()),
        nm_usuario_nrec = wheb_usuario_pck.get_nm_usuario
    WHERE
        nr_seq_bomba_interface = nr_sequencia_interface_p
        AND coalesce(dt_confirmacao::text, '') = ''
        and ie_problema = ie_problema_p;

    UPDATE bomba_infusao_interface
    SET
        ie_estado_questionavel = 'N'
    WHERE
        nr_sequencia = nr_sequencia_interface_p;

    COMMIT;

END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE atualiza_registro_questionavel ( nr_sequencia_interface_p bomba_infusao_interface.nr_sequencia%TYPE, ie_problema_p bomba_infusao_prob.ie_problema%TYPE ) FROM PUBLIC;

