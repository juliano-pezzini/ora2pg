-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE wsuite_generate_username ( nr_cpf_p pessoa_fisica.nr_cpf%type, cd_rfc_p pessoa_fisica.cd_rfc%type, ds_email_p compl_pessoa_fisica.ds_email%type, nr_seq_wsuite_user_p wsuite_usuario.nr_sequencia%type, ie_tipo_login_p wsuite_usuario.ie_tipo_login%type, ds_replacement_login_p INOUT wsuite_usuario.nm_usuario_web%type, ds_login_p INOUT usuario.nm_usuario%type) AS $body$
DECLARE

/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Finality: Generate username and Tasy control user
-------------------------------------------------------------------------------------------------------------------

Locais de chamada direta: 
[  ]  Objetos do dicionario [ ] Tasy (Delphi/Java) [  ] Portal [  ]  Relatorios [ ] Outros:
 ------------------------------------------------------------------------------------------------------------------

Caution:

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
ds_sigla_w 			varchar(10);
ds_login_w			varchar(15);
ds_replacemento_login_w		varchar(100);



BEGIN

-- Pacient User
if ( ie_tipo_login_p = 'PA' ) then
	
	select 'TWS-' || SUBSTR('00000000000' || to_char(nextval('tws_dslogin_sequence')),-11,11) ds_login
	into STRICT ds_login_w
	;

	ds_replacemento_login_w := ds_email_p;
end if;

ds_login_p		:= ds_login_w;
ds_replacement_login_p	:= ds_replacemento_login_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE wsuite_generate_username ( nr_cpf_p pessoa_fisica.nr_cpf%type, cd_rfc_p pessoa_fisica.cd_rfc%type, ds_email_p compl_pessoa_fisica.ds_email%type, nr_seq_wsuite_user_p wsuite_usuario.nr_sequencia%type, ie_tipo_login_p wsuite_usuario.ie_tipo_login%type, ds_replacement_login_p INOUT wsuite_usuario.nm_usuario_web%type, ds_login_p INOUT usuario.nm_usuario%type) FROM PUBLIC;

