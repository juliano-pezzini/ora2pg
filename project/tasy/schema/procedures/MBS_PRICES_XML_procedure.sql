-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE mbs_prices_xml ( nr_item_p bigint, nm_usuario_p text, dt_item_start_p timestamp, dt_item_end_p timestamp, cd_category_p text, cd_group_p text, cd_sub_group_p text, cd_subheading_p text, cd_item_type_p text, cd_fee_type_p text, cd_provider_type_p text, cd_new_tem_p text, cd_item_change_p text, cd_anaes_change_p text, cd_descr_change_p text, cd_fee_change_p text, cd_emsn_change_p text, cd_emsn_cap_p text, cd_benefit_type_p text, dt_benefit_start_p timestamp, dt_fee_start_p timestamp, vl_schedule_fee_p text, vl_benefit_75_p text, vl_benefit_85_p text, vl_benefit_100_p text, qt_anaes_basic_unit_p text, dt_emsn_start_p timestamp, dt_emsn_end_p timestamp, vl_fixed_cap_amt_p text, vl_cap_percent_p text, vl_max_cap_p text, ds_emsn_p text, dt_emsn_change_p timestamp, dt_derived_fee_start_p timestamp, ds_derived_fee_p text, cd_anaes_p text, dt_desc_start_p timestamp, ds_description_p text, dt_qfe_start_p timestamp, dt_qfe_end_p timestamp, vl_count_p bigint) AS $body$
DECLARE

nr_sequencia_w 		bigint;
qt_item_w 		bigint;
dt_benefit_start_w 	timestamp;

BEGIN
select	nextval('mbs_prices_seq')
into STRICT	nr_sequencia_w
;
if (coalesce(nr_sequencia_w::text, '') = '') then
	nr_sequencia_w :=1;
end if;
if (vl_count_p = 1) then
	update mbs_prices set ie_status = 'I';
end if;
EXECUTE 'ALTER SESSION SET NLS_NUMERIC_CHARACTERS= ''.,'' ';
insert into mbs_prices( nr_sequencia,
          dt_atualizacao,
          nm_usuario,
          dt_atualizacao_nrec,
          nm_usuario_nrec,
          nr_item,
          dt_item_start,
          dt_item_end,
          cd_category,
          cd_group,
          cd_sub_group,
          cd_subheading,
          cd_item_type,
          cd_fee_type,
          cd_provider_type,
          cd_new_tem,
          cd_item_change,
          cd_anaes_change,
          cd_descr_change,
          cd_fee_change,
          cd_emsn_change,
          cd_emsn_cap,
          cd_benefit_type,
          dt_benefit_start,
          dt_fee_start,
          vl_schedule_fee,
          vl_benefit_75,
          vl_benefit_85,
          vl_benefit_100,
          qt_anaes_basic_unit,
          dt_emsn_start,
          dt_emsn_end,
          vl_fixed_cap_amt,
          vl_cap_percent,
          vl_max_cap,
          ds_emsn,
          dt_emsn_change,
          dt_derived_fee_start,
          ds_derived_fee,
          cd_anaes,
          dt_desc_start,
          ds_description,
          dt_qfe_start,
          dt_qfe_end,
          ie_status
        )
        values (
          nr_sequencia_w,
          clock_timestamp(),
          nm_usuario_p,
          clock_timestamp(),
          nm_usuario_p,
          lpad(nr_item_p, 5 ,0),
          dt_item_start_p,
          dt_item_end_p,
          cd_category_p,
          cd_group_p,
          cd_sub_group_p,
          cd_subheading_p,
          cd_item_type_p,
          cd_fee_type_p,
          cd_provider_type_p,
          cd_new_tem_p,
          cd_item_change_p,
          cd_anaes_change_p,
          cd_descr_change_p,
          cd_fee_change_p,
          cd_emsn_change_p,
          cd_emsn_cap_p,
          cd_benefit_type_p,
          dt_benefit_start_p,
          dt_fee_start_p,
          (vl_schedule_fee_p)::numeric ,
          (vl_benefit_75_p)::numeric ,
          (vl_benefit_85_p)::numeric ,
          (vl_benefit_100_p)::numeric ,
          qt_anaes_basic_unit_p,
          dt_emsn_start_p,
          dt_emsn_end_p,
          (vl_fixed_cap_amt_p)::numeric ,
          (vl_cap_percent_p)::numeric ,
          (vl_max_cap_p)::numeric ,
          ds_emsn_p,
          dt_emsn_change_p,
          dt_derived_fee_start_p,
          ds_derived_fee_p,
          cd_anaes_p,
          dt_desc_start_p,
          ds_description_p,
          dt_qfe_start_p,
          dt_qfe_end_p,
          'A'
        );
commit;
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE mbs_prices_xml ( nr_item_p bigint, nm_usuario_p text, dt_item_start_p timestamp, dt_item_end_p timestamp, cd_category_p text, cd_group_p text, cd_sub_group_p text, cd_subheading_p text, cd_item_type_p text, cd_fee_type_p text, cd_provider_type_p text, cd_new_tem_p text, cd_item_change_p text, cd_anaes_change_p text, cd_descr_change_p text, cd_fee_change_p text, cd_emsn_change_p text, cd_emsn_cap_p text, cd_benefit_type_p text, dt_benefit_start_p timestamp, dt_fee_start_p timestamp, vl_schedule_fee_p text, vl_benefit_75_p text, vl_benefit_85_p text, vl_benefit_100_p text, qt_anaes_basic_unit_p text, dt_emsn_start_p timestamp, dt_emsn_end_p timestamp, vl_fixed_cap_amt_p text, vl_cap_percent_p text, vl_max_cap_p text, ds_emsn_p text, dt_emsn_change_p timestamp, dt_derived_fee_start_p timestamp, ds_derived_fee_p text, cd_anaes_p text, dt_desc_start_p timestamp, ds_description_p text, dt_qfe_start_p timestamp, dt_qfe_end_p timestamp, vl_count_p bigint) FROM PUBLIC;

