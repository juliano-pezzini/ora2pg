-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE reg_duplicate_program ( nr_seq_program_p reg_program.nr_sequencia%TYPE, nm_usuario_p reg_program.nm_usuario%TYPE ) AS $body$
DECLARE

    nr_seq_program_w reg_program.nr_sequencia%TYPE;

BEGIN
    SELECT
        nextval('reg_program_seq')
    INTO STRICT nr_seq_program_w
;

    INSERT INTO reg_program(
        ds_escopo,
        ds_fluxo_trabalho,
        ds_indicacao_uso,
        ds_oferta_compet,
        ds_oport_mercado,
        ds_program,
        ds_publico_alvo,
        ds_req_alegacao,
        ds_segmento_alvo,
        ds_versao,
        ds_visao_geral_reg,
        dt_atualizacao,
        dt_atualizacao_nrec,
        ie_situacao,
        nm_abreviado,
        nm_usuario,
        nm_usuario_nrec,
        nr_seq_cliente,
        nr_seq_intencao_uso,
        nr_seq_projeto,
        nr_seq_proj_prog,
        nr_sequencia
    )
        SELECT
            ds_escopo,
            ds_fluxo_trabalho,
            ds_indicacao_uso,
            ds_oferta_compet,
            ds_oport_mercado,
            ds_program,
            ds_publico_alvo,
            ds_req_alegacao,
            ds_segmento_alvo,
            ds_versao,
            ds_visao_geral_reg,
            clock_timestamp(),
            clock_timestamp(),
            ie_situacao,
            nm_abreviado,
            nm_usuario_p,
            nm_usuario_p,
            nr_seq_cliente,
            nr_seq_intencao_uso,
            nr_seq_projeto,
            nr_seq_proj_prog,
            nr_seq_program_w
        FROM
            reg_program
        WHERE
            nr_sequencia = nr_seq_program_p;

    INSERT INTO reg_program_urs(
        ds_justificativa_ativacao,
        ds_justificativa_inativacao,
        dt_atualizacao,
        dt_atualizacao_nrec,
        ie_situacao,
        nm_usuario,
        nm_usuario_nrec,
        nr_customer_requirement,
        nr_seq_reg_program,
        nr_sequencia
    )
        SELECT
            ds_justificativa_ativacao,
            ds_justificativa_inativacao,
            clock_timestamp(),
            clock_timestamp(),
            ie_situacao,
            nm_usuario_p,
            nm_usuario_p,
            nr_customer_requirement,
            nr_seq_program_w,
            nextval('reg_program_urs_seq')
        FROM
            reg_program_urs
        WHERE
            nr_seq_reg_program = nr_seq_program_p;

    INSERT INTO reg_program_urs_cts(
        ds_justificativa_ativacao,
        ds_justificativa_inativacao,
        dt_atualizacao,
        dt_atualizacao_nrec,
        ie_situacao,
        nm_usuario,
        nm_usuario_nrec,
        nr_seq_caso_teste,
        nr_seq_reg_program,
        nr_sequencia
    )
        SELECT
            ds_justificativa_ativacao,
            ds_justificativa_inativacao,
            clock_timestamp(),
            clock_timestamp(),
            ie_situacao,
            nm_usuario_p,
            nm_usuario_p,
            nr_seq_caso_teste,
            nr_seq_program_w,
            nextval('reg_program_urs_cts_seq')
        FROM
            reg_program_urs_cts
        WHERE
            nr_seq_reg_program = nr_seq_program_p;

    INSERT INTO reg_program_prs(
        ds_motivo_exclusao,
        ds_motivo_inclusao,
        dt_atualizacao,
        dt_atualizacao_nrec,
        ie_situacao,
        nm_usuario,
        nm_usuario_exclusao,
        nm_usuario_inclusao,
        nm_usuario_nrec,
        nr_seq_product_requirement,
        nr_seq_reg_program,
        nr_sequencia
    )
        SELECT
            ds_motivo_exclusao,
            ds_motivo_inclusao,
            clock_timestamp(),
            clock_timestamp(),
            ie_situacao,
            nm_usuario_p,
            nm_usuario_exclusao,
            nm_usuario_inclusao,
            nm_usuario_p,
            nr_seq_product_requirement,
            nr_seq_program_w,
            nextval('reg_program_prs_seq')
        FROM
            reg_program_prs
        WHERE
            nr_seq_reg_program = nr_seq_program_p;

    INSERT INTO reg_program_prs_cts(
        ds_justificativa_ativacao,
        ds_justificativa_inativacao,
        dt_atualizacao,
        dt_atualizacao_nrec,
        ie_situacao,
        nm_usuario,
        nm_usuario_nrec,
        nr_seq_caso_teste,
        nr_seq_reg_program,
        nr_sequencia
    )
        SELECT
            ds_justificativa_ativacao,
            ds_justificativa_inativacao,
            clock_timestamp(),
            clock_timestamp(),
            ie_situacao,
            nm_usuario_p,
            nm_usuario_p,
            nr_seq_caso_teste,
            nr_seq_program_w,
            nextval('reg_program_prs_cts_seq')
        FROM
            reg_program_prs_cts
        WHERE
            nr_seq_reg_program = nr_seq_program_p;

    INSERT INTO reg_program_test_case(
        cd_version,
        dt_atualizacao,
        dt_atualizacao_nrec,
        nm_usuario,
        nm_usuario_nrec,
        nr_seq_caso_teste,
        nr_seq_reg_program,
        nr_sequencia
    )
        SELECT
            cd_version,
            clock_timestamp(),
            clock_timestamp(),
            nm_usuario_p,
            nm_usuario_p,
            nr_seq_caso_teste,
            nr_seq_program_w,
            nextval('reg_program_test_case_seq')
        FROM
            reg_program_test_case
        WHERE
            nr_seq_reg_program = nr_seq_program_p;

    INSERT INTO reg_program_prs_interf(
        dt_atualizacao,
        dt_atualizacao_nrec,
        nm_interface,
        nm_usuario,
        nm_usuario_nrec,
        nr_seq_prog_prs,
        nr_sequencia
    )
        SELECT
            clock_timestamp(),
            clock_timestamp(),
            reg_program_prs_interf.nm_interface,
            nm_usuario_p,
            nm_usuario_p,
            (
                SELECT
                    prs.nr_sequencia
                FROM
                    reg_program_prs prs
                WHERE
                    prs.nr_seq_reg_program = nr_seq_program_w
                    AND prs.nr_seq_product_requirement = reg_program_prs.nr_seq_product_requirement
            ),
            nextval('reg_program_prs_interf_seq')
        FROM
            reg_program_prs_interf,
            reg_program_prs
        WHERE
            reg_program_prs_interf.nr_seq_prog_prs = reg_program_prs.nr_sequencia
            AND reg_program_prs.nr_seq_reg_program = nr_seq_program_p;

    COMMIT;
END;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE reg_duplicate_program ( nr_seq_program_p reg_program.nr_sequencia%TYPE, nm_usuario_p reg_program.nm_usuario%TYPE ) FROM PUBLIC;

