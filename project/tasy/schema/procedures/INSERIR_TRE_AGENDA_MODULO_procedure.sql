-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE inserir_tre_agenda_modulo ( ds_agenda_p text, nr_seq_agenda_p bigint, nm_usuario_p text) AS $body$
DECLARE


nr_sequencia_w		bigint;
ds_lista_modulo_w		varchar(800);
tam_lista_w		bigint;
ie_pos_virgula_w		smallint	:= 0;
cd_modulo_w		bigint;
ie_tipo_consultor_w		varchar(5);


BEGIN
ds_lista_modulo_w	:= ds_agenda_p;
if (ds_lista_modulo_w IS NOT NULL AND ds_lista_modulo_w::text <> '') then
	begin
	WHILE(ds_lista_modulo_w IS NOT NULL AND ds_lista_modulo_w::text <> '') LOOP
		begin
		tam_lista_w		:= length(ds_lista_modulo_w);
		ie_pos_virgula_w	:= position(',' in ds_lista_modulo_w);

		if (ie_pos_virgula_w <> 0) then
			cd_modulo_w		:= substr(ds_lista_modulo_w,1,(ie_pos_virgula_w - 1));
			ds_lista_modulo_w		:= substr(ds_lista_modulo_w, (ie_pos_virgula_w + 1), tam_lista_w);
		end if;

		insert	into	tre_agenda_modulo(
				nr_sequencia,
				nr_seq_agenda,
				dt_atualizacao,
				nm_usuario,
				dt_atualizacao_nrec,
				nm_usuario_nrec,
				nr_seq_modulo,
				dt_inicio,
				dt_termino,
				qt_carga_horaria,
				cd_palestrante)
			values (nextval('tre_agenda_modulo_seq'),
				nr_seq_agenda_p,
				clock_timestamp(),
				nm_usuario_p,
				clock_timestamp(),
				nm_usuario_p,
				cd_modulo_w,
				clock_timestamp(),
				null,
				null,
				null);

		end;
	END loop;
	end;
end if;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE inserir_tre_agenda_modulo ( ds_agenda_p text, nr_seq_agenda_p bigint, nm_usuario_p text) FROM PUBLIC;

