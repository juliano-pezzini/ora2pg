-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pep_just_inativ_sv_integracao (nr_sequencia_p bigint, ds_justificativa_p text default null, nm_tabela_p text default null) AS $body$
DECLARE


ds_comando_w varchar(4000);
nm_usuario_w varchar(15) := obter_usuario_ativo;	


BEGIN

if ((upper(nm_tabela_p) = 'ATENDIMENTO_SINAL_VITAL') or (upper(nm_tabela_p) = 'ATENDIMENTO_MONIT_RESP') or (upper(nm_tabela_p) = 'ATEND_MONIT_HEMOD')) then

 ds_comando_w  := ' update ' || nm_tabela_p || 
    ' set dt_liberacao = sysdate, ' ||
    ' nm_usuario_inativacao  = '''||nm_usuario_w||''','||
    ' dt_inativacao = sysdate,' ||
    ' ds_justificativa = substr('''||ds_justificativa_p||''',1,255),' ||
    ' ie_situacao = ''I'''||
    ' where  nr_sequencia = ' ||  nr_sequencia_p;
	
    CALL exec_sql_dinamico('pep_just_inativ_sv_integracao', ds_comando_w);

    end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pep_just_inativ_sv_integracao (nr_sequencia_p bigint, ds_justificativa_p text default null, nm_tabela_p text default null) FROM PUBLIC;

