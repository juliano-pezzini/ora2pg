-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE reavaliar_sepse_ped_js ( nr_seq_escala_p bigint, ie_status_p text, nm_usuario_p text, nr_atendimento_p bigint, qt_horas_p bigint) AS $body$
DECLARE

									
jobno	bigint;
nr_seq_status_w bigint;
ie_opcao_w varchar(5);
								

BEGIN

select max(nr_sequencia)
into STRICT nr_seq_status_w
from escala_sepse_status
where nr_seq_escala_ped = nr_seq_escala_p;

ie_opcao_w:= 'N';

dbms_job.submit(jobno, 'alterar_status_escala_sepse(' || nr_seq_escala_p || ',''' ||  ie_status_p  || ''',''' || nm_usuario_p || ''',''' || null || ''',' ||  nr_atendimento_p || ',''' || ie_opcao_w || ''',''' || null || ''',' || qt_horas_p || ',' || nr_seq_status_w ||');', (clock_timestamp() + (qt_horas_p/24)));
end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE reavaliar_sepse_ped_js ( nr_seq_escala_p bigint, ie_status_p text, nm_usuario_p text, nr_atendimento_p bigint, qt_horas_p bigint) FROM PUBLIC;

