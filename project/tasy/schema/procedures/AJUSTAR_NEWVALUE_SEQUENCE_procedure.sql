-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE ajustar_newvalue_sequence ( nm_sequence_p text, vl_newvalue_p bigint) AS $body$
DECLARE


vl_last_number_w	bigint;
vl_increment_w	bigint;
vl_diferenca_w	bigint;



BEGIN

-- Após ajuste o proximo valor da seq será sempre o informado no vl_newvalue_p + o increment da sequence
select	increment_by
into STRICT	vl_increment_w
from 	user_sequences
where 	sequence_name = upper(nm_sequence_p);

EXECUTE 'select ' || nm_sequence_p ||'.nextval from dual' into STRICT vl_last_number_w;
EXECUTE 'alter sequence ' || nm_sequence_p  ||' increment by ' || (vl_newvalue_p - vl_last_number_w);
EXECUTE 'select ' || nm_sequence_p ||'.nextval from dual' into STRICT vl_last_number_w;
EXECUTE 'alter sequence ' || nm_sequence_p || ' increment by ' || vl_increment_w;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ajustar_newvalue_sequence ( nm_sequence_p text, vl_newvalue_p bigint) FROM PUBLIC;

