-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE inserir_mat_ate_pac_conta_pac (nr_atendimento_p material_atend_paciente.nr_atendimento%type, nr_interno_conta_p material_atend_paciente.nr_interno_conta%type, dt_atendimento_p material_atend_paciente.dt_atendimento%type, cd_material_p material_atend_paciente.cd_material%type, cd_unidade_medida_p material_atend_paciente.cd_unidade_medida%type, dt_conta_p material_atend_paciente.dt_conta%type, qt_material_p material_atend_paciente.qt_material%type, qt_executada_p material_atend_paciente.qt_executada%type, nr_seq_cor_exec_p material_atend_paciente.nr_seq_cor_exec%type, vl_unitario_p material_atend_paciente.vl_unitario%type, vl_material_p material_atend_paciente.vl_material%type, ie_valor_informado_p material_atend_paciente.ie_valor_informado%type, cd_setor_atendimento_p material_atend_paciente.cd_setor_atendimento%type, nr_seq_atepacu_p material_atend_paciente.nr_seq_atepacu%type, dt_entrada_unidade_p material_atend_paciente.dt_entrada_unidade%type, qt_devolvida_p material_atend_paciente.qt_devolvida%type, cd_acao_p material_atend_paciente.cd_acao%type, dt_conferencia_p material_atend_paciente.dt_conferencia%type, nr_doc_convenio_p material_atend_paciente.nr_doc_convenio%type, nm_usuario_p material_atend_paciente.nm_usuario%type) AS $body$
DECLARE




  nr_sequencia_w                                          material_atend_paciente.nr_sequencia%type;

  dt_entrada_unidade_w                                    material_atend_paciente.dt_entrada_unidade%type;




BEGIN



  select nextval('material_atend_paciente_seq') into STRICT nr_sequencia_w;

  dt_entrada_unidade_w := dt_entrada_unidade_p;

  if coalesce(dt_entrada_unidade_w::text, '') = '' then
    select	dt_entrada_unidade into STRICT	dt_entrada_unidade_w
      from	atend_paciente_unidade
     where	nr_seq_interno	= nr_seq_atepacu_p;
  end if;


  insert into material_atend_paciente(nr_sequencia,

     nr_atendimento,

     nr_interno_conta,

     dt_atendimento,

     cd_material,

     cd_unidade_medida,

     dt_conta,

     qt_material,

     qt_executada,

     nr_seq_cor_exec,

     vl_unitario,

     vl_material,

     ie_valor_informado,

     cd_setor_atendimento,

     nr_seq_atepacu,

     dt_entrada_unidade,

     qt_devolvida,

     cd_acao,

     dt_conferencia,

     nr_doc_convenio,

     nm_usuario,

     dt_atualizacao)

  values (nr_sequencia_w,

     nr_atendimento_p,

     nr_interno_conta_p,

     dt_atendimento_p,

     cd_material_p,

     cd_unidade_medida_p,

     dt_conta_p,

     qt_material_p,

     qt_executada_p,

     nr_seq_cor_exec_p,

     vl_unitario_p,

     vl_material_p,

     ie_valor_informado_p,

     cd_setor_atendimento_p,

     nr_seq_atepacu_p,

     dt_entrada_unidade_w,

     qt_devolvida_p,

     cd_acao_p,

     dt_conferencia_p,

     nr_doc_convenio_p,

     nm_usuario_p,

     clock_timestamp());



  commit;



end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE inserir_mat_ate_pac_conta_pac (nr_atendimento_p material_atend_paciente.nr_atendimento%type, nr_interno_conta_p material_atend_paciente.nr_interno_conta%type, dt_atendimento_p material_atend_paciente.dt_atendimento%type, cd_material_p material_atend_paciente.cd_material%type, cd_unidade_medida_p material_atend_paciente.cd_unidade_medida%type, dt_conta_p material_atend_paciente.dt_conta%type, qt_material_p material_atend_paciente.qt_material%type, qt_executada_p material_atend_paciente.qt_executada%type, nr_seq_cor_exec_p material_atend_paciente.nr_seq_cor_exec%type, vl_unitario_p material_atend_paciente.vl_unitario%type, vl_material_p material_atend_paciente.vl_material%type, ie_valor_informado_p material_atend_paciente.ie_valor_informado%type, cd_setor_atendimento_p material_atend_paciente.cd_setor_atendimento%type, nr_seq_atepacu_p material_atend_paciente.nr_seq_atepacu%type, dt_entrada_unidade_p material_atend_paciente.dt_entrada_unidade%type, qt_devolvida_p material_atend_paciente.qt_devolvida%type, cd_acao_p material_atend_paciente.cd_acao%type, dt_conferencia_p material_atend_paciente.dt_conferencia%type, nr_doc_convenio_p material_atend_paciente.nr_doc_convenio%type, nm_usuario_p material_atend_paciente.nm_usuario%type) FROM PUBLIC;

