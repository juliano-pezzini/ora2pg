-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE man_insert_hist_classif_indev ( nr_seq_ordem_p bigint, nm_usuario_p text, nr_seq_classif_cad_p bigint) AS $body$
DECLARE



ds_classif_w varchar(255);
ds_mensagem_w varchar(4000);
				

BEGIN

if (nr_seq_ordem_p IS NOT NULL AND nr_seq_ordem_p::text <> '') then

select obter_desc_expressao_idioma(cd_exp_classificacao, '', man_obter_idioma_os_local(nr_seq_ordem_p))
into STRICT ds_classif_w
from man_classif_cadastro
where nr_sequencia  = nr_seq_classif_cad_p;

ds_mensagem_w := SUBSTR(obter_texto_dic_objeto(1181296, man_obter_idioma_os_local(nr_seq_ordem_p), 'CLASSIFICACAO_PHILIPS='|| ds_classif_w),1 , 4000);

insert into man_ordem_serv_tecnico(	nr_sequencia,
        nr_seq_ordem_serv,
        dt_atualizacao,
        nm_usuario,
        ds_relat_tecnico,
        dt_historico,
        dt_liberacao,
        nm_usuario_lib,
        nr_seq_tipo,
        ie_origem)
values (nextval('man_ordem_serv_tecnico_seq'),
        nr_seq_ordem_p,
        clock_timestamp(),
        nm_usuario_p,
        ds_mensagem_w,
        clock_timestamp(),
        clock_timestamp(),
        nm_usuario_p,
        281,
        'I');

commit;

end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE man_insert_hist_classif_indev ( nr_seq_ordem_p bigint, nm_usuario_p text, nr_seq_classif_cad_p bigint) FROM PUBLIC;

