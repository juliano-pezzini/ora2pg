-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE pls_obter_produto_compl ( nr_seq_produto_p bigint, ds_produto_p INOUT text, nm_fantasia_p INOUT text, ds_seg_assist_p INOUT text, ie_regulamentacao_p INOUT text, nr_protocolo_ans_p INOUT text, ie_situacao_p INOUT text, ds_acomodacao_p INOUT text, ie_tipo_contrat_p INOUT text, ds_fator_p INOUT text, cd_anterior_p INOUT text, ds_formacao_preco_p INOUT text, ds_abrangencia_p INOUT text) AS $body$
BEGIN

select	ds_plano,
	nm_fantasia,
	obter_valor_dominio(1665, ie_segmentacao),
	CASE WHEN ie_regulamentacao='P' THEN 'Pós' WHEN ie_regulamentacao='A' THEN 'Adaptado' WHEN ie_regulamentacao='R' THEN 'Pré' END ,
	nr_protocolo_ans || CASE WHEN coalesce(cd_scpa::text, '') = '' THEN  ''  ELSE ' / ' || cd_scpa END  nr_protocolo_ans,
	CASE WHEN ie_situacao='A' THEN 'Ativo' WHEN ie_situacao='S' THEN 'Suspenso' WHEN ie_situacao='c' THEN 'Cancelados' END ,
	CASE WHEN ie_acomodacao='I' THEN  'Individual'  WHEN ie_acomodacao='C' THEN 'Coletivo'  ELSE '' END ,
	obter_valor_dominio(1666, ie_tipo_contratacao),
	CASE WHEN ie_coparticipacao='S' THEN 'Co-participação'  ELSE '' END ,
	cd_codigo_ant,
	obter_valor_dominio(1669,ie_preco),
	substr(pls_obter_dados_produto(nr_sequencia,'A'),1,255)
into STRICT	ds_produto_p,
	nm_fantasia_p,
	ds_seg_assist_p,
	ie_regulamentacao_p,
	nr_protocolo_ans_p,
	ie_situacao_p,
	ds_acomodacao_p,
	ie_tipo_contrat_p,
	ds_fator_p,
	cd_anterior_p,
	ds_formacao_preco_p,
	ds_abrangencia_p
from	pls_plano
where	nr_sequencia = nr_seq_produto_p;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_obter_produto_compl ( nr_seq_produto_p bigint, ds_produto_p INOUT text, nm_fantasia_p INOUT text, ds_seg_assist_p INOUT text, ie_regulamentacao_p INOUT text, nr_protocolo_ans_p INOUT text, ie_situacao_p INOUT text, ds_acomodacao_p INOUT text, ie_tipo_contrat_p INOUT text, ds_fator_p INOUT text, cd_anterior_p INOUT text, ds_formacao_preco_p INOUT text, ds_abrangencia_p INOUT text) FROM PUBLIC;

