-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE alterar_status_consentimento ( nr_sequencia_p bigint, ie_status_p text, nm_usuario_p text, ds_justificativa_p text default null, ie_assinado_p text default null, nr_seq_relat_received_expl_p text default null, ds_representante_p text default null, nr_cartao_nac_sus_p text default null, nr_cpf_p text default null) AS $body$
BEGIN

if (nr_sequencia_p > 0) then

	update	pep_pac_ci
	set	ds_just_recusa = ds_justificativa_p,
		nm_usuario_status = nm_usuario_p,
		ie_status = ie_status_p,
		dt_aceite_recusa = clock_timestamp(),
        	ie_assinado = ie_assinado_p,
        	nr_seq_relat_received_expl = nr_seq_relat_received_expl_p,
        	ds_representante = ds_representante_p,
        	nr_cartao_nac_sus = nr_cartao_nac_sus_p,
        	nr_cpf = nr_cpf_p
	where	nr_sequencia = nr_sequencia_p
	and	coalesce(ie_status,'X') <> coalesce(ie_status_p,'X');

	commit;

end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE alterar_status_consentimento ( nr_sequencia_p bigint, ie_status_p text, nm_usuario_p text, ds_justificativa_p text default null, ie_assinado_p text default null, nr_seq_relat_received_expl_p text default null, ds_representante_p text default null, nr_cartao_nac_sus_p text default null, nr_cpf_p text default null) FROM PUBLIC;

