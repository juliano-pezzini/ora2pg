-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE gerar_w_sintese_fornec ( tp_movimento_p text, dt_gravacao_p text, cd_comprador_p text, nr_cnpj_fornecedor_p text, nm_razao_social_p text, nm_fantasia_p text, nr_inscricao_estadual_p text, nr_inscricao_municipal_p text, ds_website_p text, ds_email_p text, nm_usuario_p text, nr_seq_fornecedor_p INOUT text, ie_atualiza_forn_p text default 'S') AS $body$
DECLARE


nr_seq_fornecedor_w	bigint;
dt_gravacao_w		timestamp;	
ie_atualiza_forn_w	varchar(1);		
			

BEGIN

if (substr(ie_atualiza_forn_p,1,1) = 'N') then
	ie_atualiza_forn_w := 'N';
else
	ie_atualiza_forn_w := 'S';
end if;

select	nextval('w_sintese_fornec_seq')
into STRICT	nr_seq_fornecedor_w
;

dt_gravacao_w := to_date(dt_gravacao_p, 'dd/mm/yyyy hh24:mi:ss');


insert into w_sintese_fornec(	
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,             
	dt_atualizacao_nrec,    
	nm_usuario_nrec,        
	tp_movimento,           
	dt_gravacao,            
	cd_comprador,           
	nr_cnpj_fornecedor,     
	nm_razao_social,        
	nm_fantasia,            
	nr_inscricao_estadual,  
	nr_inscricao_municipal, 
	ds_website,             
	ds_email,
	ie_lido,
	ie_atualiza_forn)
values (	nr_seq_fornecedor_w,           
	clock_timestamp(),      
	nm_usuario_p,             
	clock_timestamp(),    
	nm_usuario_p,        
	tp_movimento_p,           
	dt_gravacao_w,            
	cd_comprador_p,           
	nr_cnpj_fornecedor_p,     
	substr(nm_razao_social_p,1,50),        
	substr(nm_fantasia_p,1,50),            
	nr_inscricao_estadual_p,  
	nr_inscricao_municipal_p, 
	ds_website_p,             
	ds_email_p,
	'N',
	ie_atualiza_forn_w);
	
nr_seq_fornecedor_p := nr_seq_fornecedor_w;

commit;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_w_sintese_fornec ( tp_movimento_p text, dt_gravacao_p text, cd_comprador_p text, nr_cnpj_fornecedor_p text, nm_razao_social_p text, nm_fantasia_p text, nr_inscricao_estadual_p text, nr_inscricao_municipal_p text, ds_website_p text, ds_email_p text, nm_usuario_p text, nr_seq_fornecedor_p INOUT text, ie_atualiza_forn_p text default 'S') FROM PUBLIC;

