-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';





CREATE OR REPLACE PROCEDURE incluir_tit_rec_classif_html (nr_titulo_p titulo_receber.nr_titulo%type, cd_conta_financ_p conta_financeira.cd_conta_financ%type, cd_conta_contabil_p conta_contabil.cd_conta_contabil%type, cd_centro_custo_p centro_custo.cd_centro_custo%type, cd_historico_p historico_padrao.cd_historico%type, nr_seq_produto_p produto_financeiro.nr_sequencia%type, vl_classificacao_p titulo_receber_classif.vl_classificacao%type, nm_usuario_p text) AS $body$
DECLARE



nr_seq_classif_w		titulo_receber_classif.nr_sequencia%type;


BEGIN

if	((cd_centro_custo_p IS NOT NULL AND cd_centro_custo_p::text <> '') or (cd_conta_contabil_p IS NOT NULL AND cd_conta_contabil_p::text <> '')) and (vl_classificacao_p IS NOT NULL AND vl_classificacao_p::text <> '') then

	select	coalesce(max(nr_sequencia),0) + 1
	into STRICT	nr_seq_classif_w
	from	titulo_receber_classif
	where	nr_titulo	= nr_titulo_p;

	insert into titulo_receber_classif(nr_sequencia,
		nr_titulo,
		dt_atualizacao,
		nm_usuario,
		cd_conta_financ,
		cd_centro_custo,
		cd_conta_contabil,
		nr_seq_contrato,
		nr_seq_produto,
		cd_historico,
		vl_classificacao,
		vl_desconto)
	values (nr_seq_classif_w,
		nr_titulo_p,
		clock_timestamp(),
		nm_usuario_p,
		cd_conta_financ_p,
		cd_centro_custo_p,
		cd_conta_contabil_p,
		null,
		nr_seq_produto_p,
		cd_historico_p,
		vl_classificacao_p,
		0);
end if;

end;
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE incluir_tit_rec_classif_html (nr_titulo_p titulo_receber.nr_titulo%type, cd_conta_financ_p conta_financeira.cd_conta_financ%type, cd_conta_contabil_p conta_contabil.cd_conta_contabil%type, cd_centro_custo_p centro_custo.cd_centro_custo%type, cd_historico_p historico_padrao.cd_historico%type, nr_seq_produto_p produto_financeiro.nr_sequencia%type, vl_classificacao_p titulo_receber_classif.vl_classificacao%type, nm_usuario_p text) FROM PUBLIC;

