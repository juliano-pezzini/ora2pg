-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pre_faturamento_v (dt_referencia, dt_receita, cd_convenio, dt_atualizacao, nm_usuario, cd_setor_receita, cd_setor_atendimento, cd_especialidade, cd_conta_contabil, cd_material, cd_unidade_medida, ie_origem_proced, cd_procedimento, nr_seq_grupo_rec, cd_estrutura_conta, ie_diaria, qt_resumo, vl_medico, nr_seq_conta_financ, vl_auxiliares, vl_custo_operacional, vl_anestesista, vl_materiais, vl_procedimento, vl_material, vl_medico_fora_conta, vl_sadt_fora_conta, vl_repasse_terceiro, vl_custo, nr_interno_conta, cd_estabelecimento, vl_repasse_calc, vl_total_medico, vl_diaria, vl_proced, vl_item, vl_total_receita, nr_sequencia, nr_seq_proc_interno, cd_sequencia_parametro) AS select	dt_referencia,
	dt_receita,
	cd_convenio,
	dt_atualizacao,
	nm_usuario,
	cd_setor_receita,
	cd_setor_atendimento,
	cd_especialidade,
	cd_conta_contabil,
	cd_material,
	cd_unidade_medida,
	ie_origem_proced,
	cd_procedimento,
	nr_seq_grupo_rec,
	cd_estrutura_conta,
	ie_diaria,
	qt_resumo,
	vl_medico,
	nr_seq_conta_financ,
	vl_auxiliares,
	vl_custo_operacional,
	vl_anestesista,
	vl_materiais,
	vl_procedimento,
	vl_material,
	vl_medico_fora_conta,
	vl_sadt_fora_conta,
	vl_repasse_terceiro,
	vl_custo,
	nr_interno_conta,
	cd_estabelecimento,
	vl_repasse_calc,
	(vl_medico + vl_anestesista + vl_auxiliares) vl_total_medico,
	(CASE WHEN ie_diaria='S' THEN vl_procedimento  ELSE 0 END ) vl_diaria,
	(CASE WHEN ie_diaria='S' THEN 0  ELSE (vl_materiais + vl_custo_operacional) END ) vl_proced,
	(vl_materiais + vl_custo_operacional + vl_material) vl_item,
	(vl_procedimento + vl_material) vl_total_receita,
	nr_sequencia,
  	nr_seq_proc_interno,
	a.cd_sequencia_parametro
FROM	pre_faturamento a;

