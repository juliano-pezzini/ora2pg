-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW proj_projeto_inf_v (nr_seq_portifolio, ds_portifolio, ie_program_type, ds_program_type, ie_status_portifolio, nr_seq_programa, ie_status_programa, ds_programa, nr_seq_projeto, ds_titulo, nr_seq_estagio, dt_inicio_prev, dt_inicio_real, dt_fim_prev, qt_hora_prev, qt_hora_real, pr_etapa, ie_status_geral_progr, ie_sit_programa) AS select	pf.nr_sequencia nr_seq_portifolio,
	pf.ds_portifolio,
	pf.ie_program_type,
	Obter_Descricao_Dominio(2975, pf.ie_program_type) ds_program_type,
	pf.ie_status ie_status_portifolio,
	pr.nr_sequencia nr_seq_programa,
	pr.ie_status ie_status_programa,
	pr.ds_programa,
	p.nr_sequencia nr_seq_projeto,
	p.ds_titulo,
	p.nr_seq_estagio,
	e.dt_inicio_prev dt_inicio_prev,
	e.dt_inicio_real dt_inicio_real,
	e.dt_fim_prev dt_fim_prev,
	e.qt_hora_prev qt_hora_prev,
	e.qt_hora_real qt_hora_real,
	e.pr_etapa,
	pf.ie_status_programa ie_status_geral_progr,
	pr.ie_situacao ie_sit_programa
FROM	proj_portifolio pf,
	proj_programa pr,
	proj_projeto p, 
	proj_cronograma c, 
	proj_cron_etapa e
where	pf.nr_sequencia = pr.nr_seq_portifolio
and	pr.nr_sequencia = p.nr_seq_programa
and	p.nr_sequencia  = c.nr_seq_proj
and	c.nr_sequencia  = e.nr_seq_cronograma
and	c.ie_situacao   = 'A'
and	e.ie_fase       = 'N'
and	coalesce(c.ie_tipo_cronograma, '0') <> 'I'
and	coalesce(c.ie_cliente, 'N')	= 'N'
and	c.dt_aprovacao is not null
and	not exists (	select	1 
			from	proj_cron_etapa xx 
			where	xx.nr_seq_superior = e.nr_sequencia);

