-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW home_care_indicador_v (qt_reg, nr_sequencia, ds_doenca_cid, cd_cid, ds_equipamento, cd_equipamento, ds_servico, cd_servico, ds_equipe, cd_equipe, ds_regiao, nr_seq_regiao, dt_referencia) AS select count(*) qt_reg,
	  a.nr_sequencia,
	  obter_desc_cid(b.cd_doenca_cid) ds_doenca_cid,
	  b.cd_doenca_cid cd_cid,
	  obter_desc_equip_home_care(c.NR_SEQ_EQUIPAMENTO) ds_equipamento,
	  c.NR_SEQ_EQUIPAMENTO cd_equipamento,
	  obter_desc_servico_home_care(d.NR_SEQ_SERVICO) ds_servico,
	  d.NR_SEQ_SERVICO cd_servico,
	  obter_desc_equipe_home_care(e.NR_SEQ_EQUIPE) ds_equipe,
	  e.NR_SEQ_EQUIPE cd_equipe,
	  obter_desc_regiao_home_care(f.NR_SEQ_REGIAO) ds_regiao,
	  f.NR_SEQ_REGIAO,
	  a.dt_inicio dt_referencia
FROM paciente_home_care a
LEFT OUTER JOIN paciente_hc_doenca b ON (a.nr_sequencia = b.nr_seq_paciente)
LEFT OUTER JOIN hc_pac_equipamento c ON (a.nr_sequencia = c.nr_seq_paciente)
LEFT OUTER JOIN hc_paciente_servico d ON (a.nr_sequencia = d.NR_SEQ_PAC_HOME_CARE)
LEFT OUTER JOIN paciente_hc_equipe e ON (a.nr_sequencia = e.nr_seq_paciente)
LEFT OUTER JOIN hc_como_chegar_paciente f ON (a.nr_sequencia = f.nr_seq_paciente) group BY a.nr_sequencia, b.cd_doenca_cid,c.NR_SEQ_EQUIPAMENTO,d.NR_SEQ_SERVICO,
	   e.NR_SEQ_EQUIPE,f.NR_SEQ_REGIAO, a.dt_inicio
order by 1;

