-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW os_encerrada_satisf_ger_sup_v (nr_sequencia, dt_fim_real, nr_seq_gerencia, nr_seq_grupo_sup, nr_seq_localizacao, cd_funcao, nr_seq_gerencia_insatisf, ie_area_gerencia) AS select  a.nr_sequencia,
		a.dt_fim_real,
		coalesce(a.nr_seq_gerencia_insatisf, b.nr_seq_gerencia_sup) nr_seq_gerencia,
		a.nr_seq_grupo_sup,
		a.nr_seq_localizacao,
		a.cd_funcao,
		a.nr_seq_gerencia_insatisf,
		c.ie_area_gerencia
FROM    grupo_suporte b,
		man_ordem_servico a,
		gerencia_wheb c
where   a.nr_seq_grupo_sup = b.nr_sequencia
and		c.nr_sequencia = b.nr_seq_gerencia_sup
and		a.ie_status_ordem = 3
and		a.ie_grau_satisfacao in ('E','O','B','P','R')
and	exists ( select 1
		from 	man_estagio_processo d,
				man_ordem_serv_estagio e
		where	e.nr_seq_ordem = a.nr_sequencia
		and		d.nr_sequencia = e.nr_seq_estagio
		and (d.ie_suporte = 'S' ));

