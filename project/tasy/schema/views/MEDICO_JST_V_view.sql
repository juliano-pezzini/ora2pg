-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW medico_jst_v (ie_evento_t, nm_tabela_t, nr_sequencia_t, nr_sequencia_sup_t, dt_atualizacao_t, nm_usuario_t, cd_pessoa_fisica, nr_crm, nm_guerra, ie_vinculo_medico, dt_atualizacao, nm_usuario, cd_cgc, ie_cobra_pf_pj, ie_conveniado_sus, ie_auditor_sus, uf_crm, ie_situacao, ie_corpo_clinico, dt_admissao, dt_desligamento, ie_corpo_assist, dt_efetivacao, nr_seq_categoria, ie_tipo_compl_corresp, ie_ama, ie_origem_inf, dt_atualizacao_nrec, nm_usuario_nrec, nr_rqe, ds_senha, ie_tsa, ds_orientacao_medico, ie_retaguarda, cd_setor_atendimento, ds_entidade_juridica, ie_coordenador, cd_estab_orig, ie_email_laudo, ds_observacao, nr_crm_numerico, ie_receb_pgto_prod, ie_integrado, ie_medico_senior, nr_prescritor, ds_especialidade) AS SELECT T.IE_EVENTO IE_EVENTO_T, T.NM_TABELA NM_TABELA_T, T.NR_SEQUENCIA NR_SEQUENCIA_T, T.NR_SEQUENCIA_SUP NR_SEQUENCIA_SUP_T, T.DT_ATUALIZACAO DT_ATUALIZACAO_T, T.NM_USUARIO NM_USUARIO_T
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_PESSOA_FISICA' THEN T.VL_CAMPO END) CD_PESSOA_FISICA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_CRM' THEN T.VL_CAMPO END) NR_CRM
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NM_GUERRA' THEN T.VL_CAMPO END) NM_GUERRA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_VINCULO_MEDICO' THEN T.VL_CAMPO END) IE_VINCULO_MEDICO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DT_ATUALIZACAO' THEN T.VL_CAMPO END) DT_ATUALIZACAO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NM_USUARIO' THEN T.VL_CAMPO END) NM_USUARIO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_CGC' THEN T.VL_CAMPO END) CD_CGC
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_COBRA_PF_PJ' THEN T.VL_CAMPO END) IE_COBRA_PF_PJ
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_CONVENIADO_SUS' THEN T.VL_CAMPO END) IE_CONVENIADO_SUS
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_AUDITOR_SUS' THEN T.VL_CAMPO END) IE_AUDITOR_SUS
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'UF_CRM' THEN T.VL_CAMPO END) UF_CRM
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_SITUACAO' THEN T.VL_CAMPO END) IE_SITUACAO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_CORPO_CLINICO' THEN T.VL_CAMPO END) IE_CORPO_CLINICO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DT_ADMISSAO' THEN T.VL_CAMPO END) DT_ADMISSAO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DT_DESLIGAMENTO' THEN T.VL_CAMPO END) DT_DESLIGAMENTO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_CORPO_ASSIST' THEN T.VL_CAMPO END) IE_CORPO_ASSIST
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DT_EFETIVACAO' THEN T.VL_CAMPO END) DT_EFETIVACAO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQ_CATEGORIA' THEN T.VL_CAMPO END) NR_SEQ_CATEGORIA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_TIPO_COMPL_CORRESP' THEN T.VL_CAMPO END) IE_TIPO_COMPL_CORRESP
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_AMA' THEN T.VL_CAMPO END) IE_AMA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_ORIGEM_INF' THEN T.VL_CAMPO END) IE_ORIGEM_INF
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DT_ATUALIZACAO_NREC' THEN T.VL_CAMPO END) DT_ATUALIZACAO_NREC
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NM_USUARIO_NREC' THEN T.VL_CAMPO END) NM_USUARIO_NREC
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_RQE' THEN T.VL_CAMPO END) NR_RQE
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_SENHA' THEN CASE WHEN coalesce(pkg_i18n.get_user_locale, 'pt_BR')='pt_BR' THEN  T.VL_CAMPO  ELSE null END  END) DS_SENHA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_TSA' THEN T.VL_CAMPO END) IE_TSA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_ORIENTACAO_MEDICO' THEN T.VL_CAMPO END) DS_ORIENTACAO_MEDICO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_RETAGUARDA' THEN T.VL_CAMPO END) IE_RETAGUARDA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_SETOR_ATENDIMENTO' THEN T.VL_CAMPO END) CD_SETOR_ATENDIMENTO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_ENTIDADE_JURIDICA' THEN T.VL_CAMPO END) DS_ENTIDADE_JURIDICA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_COORDENADOR' THEN T.VL_CAMPO END) IE_COORDENADOR
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_ESTAB_ORIG' THEN T.VL_CAMPO END) CD_ESTAB_ORIG
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_EMAIL_LAUDO' THEN T.VL_CAMPO END) IE_EMAIL_LAUDO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_OBSERVACAO' THEN T.VL_CAMPO END) DS_OBSERVACAO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_CRM_NUMERICO' THEN T.VL_CAMPO END) NR_CRM_NUMERICO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_RECEB_PGTO_PROD' THEN T.VL_CAMPO END) IE_RECEB_PGTO_PROD
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_INTEGRADO' THEN T.VL_CAMPO END) IE_INTEGRADO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_MEDICO_SENIOR' THEN T.VL_CAMPO END) IE_MEDICO_SENIOR
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_PRESCRITOR' THEN T.VL_CAMPO END) NR_PRESCRITOR
	 ,(select VL_CAMPO FROM JSON_SCHEMA_T J WHERE J.NM_TABELA like 'ESPECIALIDADE_MEDICA' AND J.NR_SEQUENCIA_SUP = T.NR_SEQUENCIA AND J.NM_ATRIBUTO = 'DS_ESPECIALIDADE') DS_ESPECIALIDADE
  FROM JSON_SCHEMA_T T
 WHERE T.NM_TABELA = 'MEDICO'
 GROUP BY T.IE_EVENTO, T.NM_TABELA, T.NR_SEQUENCIA, T.NR_SEQUENCIA_SUP, T.DT_ATUALIZACAO, T.NM_USUARIO;

