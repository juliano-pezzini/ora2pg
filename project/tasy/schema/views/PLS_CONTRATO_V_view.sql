-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_contrato_v (nr_sequencia, dt_atualizacao, nm_usuario, dt_atualizacao_nrec, nm_usuario_nrec, cd_cgc_estipulante, cd_pf_estipulante, dt_aprovacao, cd_cod_anterior, qt_intervalo, ie_renovacao_automatica, ie_permite_prod_dif, ie_situacao, dt_rescisao_contrato, dt_contrato, dt_reativacao, cd_contrato, ie_reajuste, cd_estabelecimento, ie_geracao_valores, nr_seq_emissor, ie_tipo_beneficiario, nr_seq_congenere, qt_dias_valid_cart, qt_idade_limite_reaj, qt_anos_limite_reaj, dt_cancelamento, nr_seq_motivo_rescisao, nr_seq_proposta, nr_contrato_principal, ie_preco_co_operadora, ie_itens_nao_cobertos, ie_tipo_operacao, dt_limite_movimentacao, ie_cobranca_mensalidade, qt_interv_mes_mensalidade, dt_ultima_mens_gerada, dt_limite_utilizacao, ie_controle_carteira, nr_contrato, nr_seq_assinatura, cd_operadora_empresa, nr_seq_operadora, nr_seq_cooperativa, nr_seq_indice_reajuste, nr_seq_contrato_ant, ie_novo_beneficiario, dt_reajuste, cd_contrato_principal, ie_exige_vinc_operadora, dt_base_validade_carteira, cd_cooperativa, nr_proposta_ant, nr_seq_compl_pj, ie_permite_matricula_dif, nr_seq_classificacao, cd_classif_contrato, ie_consistir_carencia_rede, cd_scpa, ie_mes_cobranca_reaj, nr_seq_tipo_comissao, dt_base_carteira, cd_estipulante, nm_estipulante) AS select	a.nr_sequencia,
	a.dt_atualizacao,
	a.nm_usuario,
	a.dt_atualizacao_nrec,
	a.nm_usuario_nrec,
	a.cd_cgc_estipulante,
	a.cd_pf_estipulante,
	a.dt_aprovacao,
	a.cd_cod_anterior,
	a.qt_intervalo,
	a.ie_renovacao_automatica,
	a.ie_permite_prod_dif,
	a.ie_situacao,
	a.dt_rescisao_contrato,
	a.dt_contrato,
	a.dt_reativacao,
	a.cd_contrato,
	a.ie_reajuste,
	a.cd_estabelecimento,
	a.ie_geracao_valores,
	a.nr_seq_emissor,
	a.ie_tipo_beneficiario,
	a.nr_seq_congenere,
	a.qt_dias_valid_cart,
	a.qt_idade_limite_reaj,
	a.qt_anos_limite_reaj,
	a.dt_cancelamento,
	a.nr_seq_motivo_rescisao,
	a.nr_seq_proposta,
	a.nr_contrato_principal,
	a.ie_preco_co_operadora,
	a.ie_itens_nao_cobertos,
	a.ie_tipo_operacao,
	a.dt_limite_movimentacao,
	a.ie_cobranca_mensalidade,
	a.qt_interv_mes_mensalidade,
	a.dt_ultima_mens_gerada,
	a.dt_limite_utilizacao,
	a.ie_controle_carteira,
	a.nr_contrato,
	a.nr_seq_assinatura,
	a.cd_operadora_empresa,
	a.nr_seq_operadora,
	a.nr_seq_cooperativa,
	a.nr_seq_indice_reajuste,
	a.nr_seq_contrato_ant,
	a.ie_novo_beneficiario,
	a.dt_reajuste,
	a.cd_contrato_principal,
	a.ie_exige_vinc_operadora,
	a.dt_base_validade_carteira,
	a.cd_cooperativa,
	a.nr_proposta_ant,
	a.nr_seq_compl_pj,
	a.ie_permite_matricula_dif,
	a.nr_seq_classificacao,
	a.cd_classif_contrato,
	a.ie_consistir_carencia_rede,
	a.cd_scpa,
	a.ie_mes_cobranca_reaj,
	a.nr_seq_tipo_comissao,
	a.dt_base_carteira,
	b.cd_pessoa_fisica cd_estipulante,
	b.nm_pessoa_fisica nm_estipulante
FROM	pls_contrato a,
	pessoa_fisica b
where	a.cd_pf_estipulante	= b.cd_pessoa_fisica
and	a.cd_cgc_estipulante is null

union

select	a.nr_sequencia,
	a.dt_atualizacao,
	a.nm_usuario,
	a.dt_atualizacao_nrec,
	a.nm_usuario_nrec,
	a.cd_cgc_estipulante,
	a.cd_pf_estipulante,
	a.dt_aprovacao,
	a.cd_cod_anterior,
	a.qt_intervalo,
	a.ie_renovacao_automatica,
	a.ie_permite_prod_dif,
	a.ie_situacao,
	a.dt_rescisao_contrato,
	a.dt_contrato,
	a.dt_reativacao,
	a.cd_contrato,
	a.ie_reajuste,
	a.cd_estabelecimento,
	a.ie_geracao_valores,
	a.nr_seq_emissor,
	a.ie_tipo_beneficiario,
	a.nr_seq_congenere,
	a.qt_dias_valid_cart,
	a.qt_idade_limite_reaj,
	a.qt_anos_limite_reaj,
	a.dt_cancelamento,
	a.nr_seq_motivo_rescisao,
	a.nr_seq_proposta,
	a.nr_contrato_principal,
	a.ie_preco_co_operadora,
	a.ie_itens_nao_cobertos,
	a.ie_tipo_operacao,
	a.dt_limite_movimentacao,
	a.ie_cobranca_mensalidade,
	a.qt_interv_mes_mensalidade,
	a.dt_ultima_mens_gerada,
	a.dt_limite_utilizacao,
	a.ie_controle_carteira,
	a.nr_contrato,
	a.nr_seq_assinatura,
	a.cd_operadora_empresa,
	a.nr_seq_operadora,
	a.nr_seq_cooperativa,
	a.nr_seq_indice_reajuste,
	a.nr_seq_contrato_ant,
	a.ie_novo_beneficiario,
	a.dt_reajuste,
	a.cd_contrato_principal,
	a.ie_exige_vinc_operadora,
	a.dt_base_validade_carteira,
	a.cd_cooperativa,
	a.nr_proposta_ant,
	a.nr_seq_compl_pj,
	a.ie_permite_matricula_dif,
	a.nr_seq_classificacao,
	a.cd_classif_contrato,
	a.ie_consistir_carencia_rede,
	a.cd_scpa,
	a.ie_mes_cobranca_reaj,
	a.nr_seq_tipo_comissao,
	a.dt_base_carteira,
	b.cd_cgc cd_estipulante,
	b.ds_razao_social nm_estipulante
from	pls_contrato a,
	pessoa_juridica b
where	a.cd_cgc_estipulante	= b.cd_cgc
and	a.cd_pf_estipulante is null;

