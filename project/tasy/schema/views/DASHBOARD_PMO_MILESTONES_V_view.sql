-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW dashboard_pmo_milestones_v (nr_seq_portifolio, ds_portifolio, nr_seq_programa, ds_programa, nr_seq_proj, ds_titulo, ds_atividade, dt_inicio_prev, dt_fim_prev, dt_inicio_real, dt_fim_real, pr_etapa, pr_previsto, ie_tipo_cronograma, ie_status_milestone) AS select	pr.nr_seq_portifolio,
		pf.ds_portifolio,
		p.nr_seq_programa,
		pr.ds_programa,
		c.nr_seq_proj,
		p.ds_titulo,
		e.ds_atividade,
		e.dt_inicio_prev,
		e.dt_fim_prev,
		e.dt_inicio_real,
		e.dt_fim_real,
		e.pr_etapa,
		e.pr_previsto,
		c.ie_tipo_cronograma,
	   --obter_status_mlt_dashboard(e.nr_sequencia) ie_status_milestone
		obter_status_dashboard_pmo( null,
									null,
									e.dt_inicio_prev,
									e.dt_inicio_real,
									e.dt_fim_prev,
									e.dt_fim_real,
									coalesce(e.pr_previsto,0) ,
									coalesce(e.pr_etapa,0)) ie_status_milestone
FROM	proj_portifolio pf,
		proj_programa pr,
		proj_projeto p,
		proj_cronograma c,
		proj_cron_etapa e
where	pf.nr_sequencia = pr.nr_seq_portifolio
and		pr.nr_sequencia = p.nr_seq_programa
and		p.nr_sequencia = c.nr_seq_proj
and		c.nr_sequencia = e.nr_seq_cronograma
and		c.ie_situacao = 'A'
and		e.ie_milestone = 'S';

