-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW bft_service_provider_v (legal_entity_code, previous_system_code, type_code, establishment_code, legal_entity_type, company_number, corporate_name, commercial_name, address, city, state_code, state_desc, country_code, country_name, postal_code, phone_number) AS select	a.cd_cgc legal_entity_code,
	a.cd_sistema_ant previous_system_code,
	a.cd_tipo_pessoa type_code,
	b.cd_estabelecimento establishment_code,
	substr(obter_desc_tipo_pessoa(a.cd_tipo_pessoa),1,255) legal_entity_type,
	a.cd_rfc company_number,
	a.ds_razao_social corporate_name,
	a.nm_fantasia commercial_name,
	a.ds_endereco address,
	a.ds_municipio city,
	a.sg_estado state_code,
	obter_valor_dominio_idioma(50, a.sg_estado, wheb_usuario_pck.get_nr_seq_idioma) state_desc,
	a.nr_seq_pais country_code,
	obter_nome_pais(a.nr_seq_pais) country_name,
	a.cd_cep postal_code,
	a.nr_telefone Phone_number
FROM	pessoa_juridica a,
	estabelecimento b
where 	a.cd_cgc = b.cd_cgc
and 	b.ie_situacao = 'A'
and 	a.ie_situacao = 'A';

