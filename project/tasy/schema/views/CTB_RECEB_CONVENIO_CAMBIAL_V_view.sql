-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ctb_receb_convenio_cambial_v (nr_lote_contabil, cd_convenio, vl_adicional, nr_seq_trans_financ, dt_atualizacao, nm_atributo, nr_seq_conta_banco, cd_cgc, nr_agrupamento, ds_observacao, dt_recebimento, nr_sequencia, nr_seq_receb) AS select	e.nr_lote_contabil,
        b.cd_convenio,
        e.vl_cambial_ativo vl_adicional,
        e.nr_seq_trans_financ,
        e.dt_atualizacao,
        'VL_CAMBIAL_ATIVO' nm_atributo,
        a.nr_seq_conta_banco,
        b.cd_cgc,
        1 nr_agrupamento,
        null ds_observacao,
        dt_recebimento,
        a.nr_sequencia,
        e.nr_sequencia nr_seq_receb
FROM 	Convenio b,
        Convenio_Receb a,
        Convenio_Receb_adic e
where	a.cd_convenio = b.cd_convenio
and     a.nr_sequencia = e.nr_seq_receb
and     e.nr_seq_trans_financ is not null
and     e.vl_cambial_ativo <> 0

union all

select	e.nr_lote_contabil,
        b.cd_convenio,
        e.vl_cambial_passivo vl_adicional,
        e.nr_seq_trans_financ,
        e.dt_atualizacao,
        'VL_CAMBIAL_PASSIVO' nm_atributo,
        a.nr_seq_conta_banco,
        b.cd_cgc,
        1 nr_agrupamento,
        null ds_observacao,
        dt_recebimento,
        a.nr_sequencia,
        e.nr_sequencia nr_seq_receb
from 	Convenio b,
        Convenio_Receb a,
        Convenio_Receb_adic e
where	a.cd_convenio = b.cd_convenio
and     a.nr_sequencia = e.nr_seq_receb
and     e.nr_seq_trans_financ is not null
and     e.vl_cambial_passivo <> 0;

