-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW itens_cpoe_v (nr_sequencia, ie_tipo_item, ie_tipo_item_cpoe, cd_item, ds_item, nr_atendimento, cd_pessoa_fisica, dt_inicio, dt_fim, dt_suspensao, dt_liberacao, ie_prescritor_aux, cd_medico, nm_usuario, dt_ciencia_medico, ie_futuro, dt_liberacao_fut, cd_intervalo, qt_dose, qt_dose_total, ds_dose_diferenciada, cd_unidade_medida, ie_via_aplicacao, ie_tipo_hemoterap, ds_horarios, nr_seq_cpoe_order_unit, nr_seq_cpoe_rp, dt_lib_suspensao) AS select	nr_sequencia,
		cpoe_obter_tipo_item('CPOE_DIETA',nr_sequencia,ie_tipo_dieta,null,null) ie_tipo_item,
		'N' ie_tipo_item_cpoe,
		cd_dieta cd_item,
		substr(obter_desc_dieta(cd_dieta),1,255) ds_item,
		nr_atendimento,
		cd_pessoa_fisica,
		dt_inicio,
		dt_fim,
		CASE WHEN dt_lib_suspensao IS NULL THEN  null  ELSE dt_suspensao END  dt_suspensao,
		dt_liberacao,
		ie_prescritor_aux,
		cd_medico,
		nm_usuario,
		dt_ciencia_medico,
		ie_futuro,
		dt_liberacao_fut,
		cd_intervalo,
		qt_dose,
		null qt_dose_total,
		ds_dose_diferenciada,
		cd_unidade_medida_dose cd_unidade_medida,
		ie_via_aplicacao,
		null ie_tipo_hemoterap,
		ds_horarios,
		nr_seq_cpoe_order_unit,
		null nr_seq_cpoe_rp,
		dt_lib_suspensao
FROM	cpoe_dieta

union all

select	nr_sequencia,
		cpoe_obter_tipo_item('CPOE_MATERIAL',nr_sequencia,null,ie_controle_tempo,ie_material) ie_tipo_item,
		'M' ie_tipo_item_cpoe,
		cd_material cd_item,
		substr(obter_desc_material(cd_material),1,255) ds_item,
		nr_atendimento,
		cd_pessoa_fisica,
		dt_inicio,
		dt_fim,
		CASE WHEN dt_lib_suspensao IS NULL THEN  null  ELSE dt_suspensao END  dt_suspensao,
		dt_liberacao,
		ie_prescritor_aux,
		cd_medico,
		nm_usuario,
		dt_ciencia_medico,
		ie_futuro,
		dt_liberacao_fut,
		cd_intervalo,
		qt_dose,
		null qt_dose_total,
		ds_dose_diferenciada,
		cd_unidade_medida,
		ie_via_aplicacao,
		null ie_tipo_hemoterap,
		ds_horarios,
		nr_seq_cpoe_order_unit,
		nr_seq_cpoe_rp,
		dt_lib_suspensao
from	cpoe_material

union all

select	nr_sequencia,
		cpoe_obter_tipo_item('CPOE_PROCEDIMENTO',nr_sequencia,null,null,null) ie_tipo_item,
		'P' ie_tipo_item_cpoe,
		nr_seq_proc_interno cd_item,
		substr(obter_desc_proc_interno(nr_seq_proc_interno),1,255) ds_item,
		nr_atendimento,
		cd_pessoa_fisica,
		dt_inicio,
		dt_fim,
		CASE WHEN dt_lib_suspensao IS NULL THEN  null  ELSE dt_suspensao END  dt_suspensao,
		dt_liberacao,
		ie_prescritor_aux,
		cd_medico,
		nm_usuario,
		dt_ciencia_medico,
		ie_futuro,
		dt_liberacao_fut,
		cd_intervalo,
		null qt_dose,
		null qt_dose_total,
		null ds_dose_diferenciada,
		null cd_unidade_medida,
		null ie_via_aplicacao,
		null ie_tipo_hemoterap,
		ds_horarios,
		nr_seq_cpoe_order_unit,
		null nr_seq_cpoe_rp,
		dt_lib_suspensao
from	cpoe_procedimento

union all

select	nr_sequencia,
		cpoe_obter_tipo_item('CPOE_GASOTERAPIA',nr_sequencia,null,null,null) ie_tipo_item,
		'G' ie_tipo_item_cpoe,
		nr_seq_gas cd_item,
		substr(obter_desc_gas(nr_seq_gas),1,255) ds_item,
		nr_atendimento,
		cd_pessoa_fisica,
		dt_inicio,
		dt_fim,
		CASE WHEN dt_lib_suspensao IS NULL THEN  null  ELSE dt_suspensao END  dt_suspensao,
		dt_liberacao,
		ie_prescritor_aux,
		cd_medico,
		nm_usuario,
		dt_ciencia_medico,
		ie_futuro,
		dt_liberacao_fut,
		cd_intervalo,
		null qt_dose,
		null qt_dose_total,
		null ds_dose_diferenciada,
		null cd_unidade_medida,
		null ie_via_aplicacao,
		null ie_tipo_hemoterap,
		ds_horarios,
		nr_seq_cpoe_order_unit,
		null nr_seq_cpoe_rp,
		dt_lib_suspensao
from	cpoe_gasoterapia

union all

select	nr_sequencia,
		cpoe_obter_tipo_item('CPOE_RECOMENDACAO',nr_sequencia,null,null,null) ie_tipo_item,
		'R' ie_tipo_item_cpoe,
		cd_recomendacao cd_item,
		substr(obter_desc_recomendacao(cd_recomendacao),1,255) ds_item,
		nr_atendimento,
		cd_pessoa_fisica,
		dt_inicio,
		dt_fim,
		CASE WHEN dt_lib_suspensao IS NULL THEN  null  ELSE dt_suspensao END  dt_suspensao,
		dt_liberacao,
		ie_prescritor_aux,
		cd_medico,
		nm_usuario,
		dt_ciencia_medico,
		ie_futuro,
		dt_liberacao_fut,
		cd_intervalo,
		null qt_dose,
		null qt_dose_total,
		null ds_dose_diferenciada,
		null cd_unidade_medida,
		null ie_via_aplicacao,
		null ie_tipo_hemoterap,
		ds_horarios,
		nr_seq_cpoe_order_unit,
		null nr_seq_cpoe_rp,
		dt_lib_suspensao
from	cpoe_recomendacao

union all

select	nr_sequencia,
		cpoe_obter_tipo_item('CPOE_HEMOTERAPIA',nr_sequencia,null,null,null) ie_tipo_item,
		'HM' ie_tipo_item_cpoe,
		coalesce(nr_seq_derivado, nr_seq_proc_interno) cd_item,
		substr(cpoe_obter_desc_info_hemote(nr_sequencia),1,255) ds_item,
		nr_atendimento,
		cd_pessoa_fisica,
		dt_inicio,
		dt_fim,
		CASE WHEN dt_lib_suspensao IS NULL THEN  null  ELSE dt_suspensao END  dt_suspensao,
		dt_liberacao,
		ie_prescritor_aux,
		cd_medico,
		nm_usuario,
		dt_ciencia_medico,
		ie_futuro,
		dt_liberacao_fut,
		cd_intervalo,
		null qt_dose,
		null qt_dose_total,
		null ds_dose_diferenciada,
		null cd_unidade_medida,
		ie_via_aplicacao,
		CASE WHEN nr_seq_derivado IS NULL THEN  1  ELSE 0 END  ie_tipo_hemoterap,
		ds_horarios,
		nr_seq_cpoe_order_unit,
		null nr_seq_cpoe_rp,
		dt_lib_suspensao
from	cpoe_hemoterapia

union all

select	nr_sequencia,
		cpoe_obter_tipo_item('CPOE_DIALISE',nr_sequencia,null,null,null) ie_tipo_item,
		'D' ie_tipo_item_cpoe,
		0 cd_item,
		substr(CPOE_Obter_desc_dialise( ie_tipo_dialise, nr_seq_protocolo, dt_lib_suspensao, dt_suspensao, qt_fluxo_sangue, qt_hora_min_sessao, 'N', ie_hemodialise, ie_tipo_peritoneal, qt_volume_ciclo, qt_hora_min_duracao, ie_categoria),1,255) ds_item,
		nr_atendimento,
		cd_pessoa_fisica,
		dt_inicio,
		dt_fim,
		CASE WHEN dt_lib_suspensao IS NULL THEN  null  ELSE dt_suspensao END  dt_suspensao,
		dt_liberacao,
		ie_prescritor_aux,
		cd_medico,
		nm_usuario,
		dt_ciencia_medico,
		ie_futuro,
		dt_liberacao_fut,
		null cd_intervalo,
		null qt_dose,
		null qt_dose_total,
		null ds_dose_diferenciada,
		null cd_unidade_medida,
		null ie_via_aplicacao,
		null ie_tipo_hemoterap,
		ds_horarios,
		nr_seq_cpoe_order_unit,
		null nr_seq_cpoe_rp,
		dt_lib_suspensao
from	cpoe_dialise

union all

select 	nr_sequencia,
		cpoe_obter_tipo_item('CPOE_ANATOMIA_PATOLOGICA',nr_sequencia,null ,null,null) ie_tipo_item,
		'AP' ie_tipo_item_cpoe,
		0 cd_item,
		substr(obter_desc_proc_interno(nr_Seq_proc_interno),1,255) ds_item,
		nr_atendimento,
		cd_pessoa_fisica,
		dt_inicio,
		dt_fim,
		CASE WHEN dt_lib_suspensao IS NULL THEN null  ELSE dt_suspensao END  dt_suspensao,
		dt_liberacao,
		ie_prescritor_aux,
		cd_medico,
		nm_usuario,
		dt_ciencia_medico,
		ie_futuro,
		dt_liberacao_fut,
		null cd_intervalo,
		null qt_dose,
		null qt_dose_total,
		null ds_dose_diferenciada,
		null cd_unidade_medida,
		null ie_via_aplicacacao,
		null ie_tipo_hemoterap,
		null ds_horarios,
		nr_seq_cpoe_order_unit,
		null nr_seq_cpoe_rp,
		dt_lib_suspensao
from 	cpoe_anatomia_patologica;

