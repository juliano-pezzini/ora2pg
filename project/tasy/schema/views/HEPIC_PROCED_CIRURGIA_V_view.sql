-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW hepic_proced_cirurgia_v (ds_procedimento, cd_grupo_proc, ds_grupo_proc, nr_prescricao, nr_sequencia, cd_procedimento, ie_origem_proced, qt_procedimento, dt_procedimento, nr_cirurgia) AS select distinct ds_procedimento,
					d.cd_grupo_proc,
					d.ds_grupo_proc,
					a.nr_prescricao,
					a.nr_sequencia,
					a.cd_procedimento,
					a.ie_origem_proced,
					a.qt_procedimento,
					a.dt_procedimento,
					b.nr_cirurgia
              FROM 	procedimento_paciente a,
					cirurgia b,
					procedimento c,
					grupo_proc d
             where 	a.nr_prescricao = b.nr_prescricao
               and 	a.cd_procedimento = c.cd_procedimento
               and 	a.ie_origem_proced = c.ie_origem_proced
               and 	c.cd_grupo_proc = d.cd_grupo_proc
               and  obter_se_proc_cirurgico(a.cd_procedimento, a.ie_origem_proced, a.cd_setor_atendimento) = 'S';

