-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW sus_interface_raas_v (ds_registro, cd_linha, ds_indicador_cabecalho, dt_competencia, qt_folhas_arquivo, nr_controle, nm_orgao_responsavel, ds_sigla_org_resp, cd_cgc_prestador, nm_orgao_destino, ie_indicador_destino, dt_geracao, ds_versao_raas, ds_versao_bdsia, cd_uf, dt_producao, cd_unidade_prestadora, cd_cartao_saude_paciente, dt_inicial_validade, dt_final_validade, nm_paciente, nr_prontuario, nm_mae_paciente, ds_logradouro, nr_residencia, ds_complemento, cd_cep, cd_municipio_ibge, dt_nascimento, ie_sexo, ds_raca, ds_nome_responsavel, cd_nacionalidade, cd_etnia, nr_telefone, nr_celular, cd_motivo_saida, dt_ocorrencia, cd_cid_principal, cd_cid_secundario_1, cd_cid_secundario_2, cd_cid_secundario_3, cd_cid_causas_assoc, cd_carater_atend, cd_origem_paciente, ie_cobertura_familiar, cd_estab_esf, qt_total_acoes, cd_destino_paciente, ie_origem, ie_situacao_rua, ie_usuario_drogas, ie_usuario_tipo_droga, nr_autorizacao, ds_filler, cd_sigtap_acao, cd_cbos, cd_cns, dt_execucao_acao, cd_servico, cd_classificacao, cd_seq_equipe, cd_area_equipe, qt_realizada, cd_ine, ie_local_exame) AS select	'CABECALHO' ds_registro,
		'01' cd_linha,
		ds_indicador_cabecalho,
		to_char(dt_competencia, 'yyyymm') dt_competencia,
		lpad(qt_folhas_arquivo,6,0) qt_folhas_arquivo,
		nr_controle,
		nm_orgao_responsavel,
		ds_sigla_org_resp,
		lpad(cd_cgc_prestador,14,0) cd_cgc_prestador,
		nm_orgao_destino,
		ie_indicador_destino,
		to_char(dt_geracao, 'yyyymmdd') dt_geracao,
		ds_versao_raas,
		ds_versao_bdsia,
		'' cd_uf,
		null dt_producao,
		'' cd_unidade_prestadora,
		'' cd_cartao_saude_paciente,
		null dt_inicial_validade,
		null dt_final_validade,
		'' nm_paciente,
		0 nr_prontuario,
		'' nm_mae_paciente,
		'' ds_logradouro,
		0 nr_residencia,
		'' ds_complemento,
		'' cd_cep,
		'' cd_municipio_ibge,
		null dt_nascimento,
		'' ie_sexo,
		'' ds_raca,
		'' ds_nome_responsavel,
		0 cd_nacionalidade,
		'' cd_etnia,
		'' nr_telefone,
		'' nr_celular,
		0 cd_motivo_saida,
		null dt_ocorrencia,
		'' cd_cid_principal,
		'' cd_cid_secundario_1,
		'' cd_cid_secundario_2,
		'' cd_cid_secundario_3,
		'' cd_cid_causas_assoc,
		'' cd_carater_atend,
		'' cd_origem_paciente,
		'' ie_cobertura_familiar,
		null cd_estab_esf,
		0 qt_total_acoes,
		'' cd_destino_paciente,
		'' ie_origem,
		'' ie_situacao_rua,
		'' ie_usuario_drogas,
		'' ie_usuario_tipo_droga,
		'' nr_autorizacao,
		'' ds_filler,
		'' cd_sigtap_acao,
		'' cd_cbos,
		'' cd_cns,
		null dt_execucao_acao,
		0 cd_servico,
		0 cd_classificacao,
		'' cd_seq_equipe,
		'' cd_area_equipe,
		0 qt_realizada,
		'' cd_ine,
		'' ie_local_exame
FROM	w_raas_interf_header

union

select	'DADOS ATENCAO DOMICILIAR' ds_registro,
		cd_linha,
		'' ds_indicador_cabecalho,
		null dt_competencia,
		'' qt_folhas_arquivo,
		0 nr_controle,
		'' nm_orgao_responsavel,
		'' ds_sigla_org_resp,
		'' cd_cgc_prestador,
		'' nm_orgao_destino,
		'' ie_indicador_destino,
		null dt_geracao,
		'' ds_versao_raas,
		'' ds_versao_bdsia,
		cd_uf,
		to_char(dt_producao, 'yyyymm') dt_producao,
		cd_unidade_prestadora,
		cd_cartao_saude_paciente,
		to_char(dt_inicial_validade, 'yyyymmdd') dt_inicial_validade,
		to_char(dt_final_validade, 'yyyymmdd') dt_final_validade,
		nm_paciente,
		nr_prontuario,
		nm_mae_paciente,
		ds_logradouro,
		nr_residencia,
		ds_complemento,
		cd_cep,
		cd_municipio_ibge,
		to_char(dt_nascimento, 'yyyymmdd') dt_nascimento,
		ie_sexo,
		coalesce(ds_raca,'99') ds_raca,
		ds_nome_responsavel,
		cd_nacionalidade,
		cd_etnia,
		nr_telefone,
		nr_celular,
		cd_motivo_saida,
		to_char(dt_ocorrencia, 'yyyymmdd') dt_ocorrencia,
		cd_cid_principal,
		cd_cid_secundario_1,
		cd_cid_secundario_2,
		cd_cid_secundario_3,
		cd_cid_causas_assoc,
		lpad(cd_carater_atend,2,0) cd_carater_atend,
		cd_origem_paciente,
		ie_cobertura_familiar,
		cd_estab_esf,
		qt_total_acoes,
		cd_destino_paciente,
		ie_origem,
		'' ie_situacao_rua,
		'' ie_usuario_drogas,
		'' ie_usuario_tipo_droga,
		'' nr_autorizacao,
		'    ' ds_filler,
		'' cd_sigtap_acao,
		'' cd_cbos,
		'' cd_cns,
		null dt_execucao_acao,
		0 cd_servico,
		0 cd_classificacao,
		'' cd_seq_equipe,
		'' cd_area_equipe,
		0 qt_realizada,
		'' cd_ine,
		'' ie_local_exame
from	w_raas_interf_paciente_dom

union

select	'ACOES ATENCAO DOMICILIAR' ds_registro,
		cd_linha,
		'' ds_indicador_cabecalho,
		null dt_competencia,
		'' qt_folhas_arquivo,
		0 nr_controle,
		'' nm_orgao_responsavel,
		'' ds_sigla_org_resp,
		'' cd_cgc_prestador,
		'' nm_orgao_destino,
		'' ie_indicador_destino,
		null dt_geracao,
		'' ds_versao_raas,
		'' ds_versao_bdsia,
		to_char(cd_uf) cd_uf,
		to_char(dt_producao, 'yyyymm') dt_producao,
		cd_cnes cd_unidade_prestadora,
		cd_cartao_saude_paciente,
		to_char(dt_validade_inicial, 'yyyymmdd') dt_inicial_validade,
		null dt_final_validade,
		'' nm_paciente,
		0 nr_prontuario,
		'' nm_mae_paciente,
		'' ds_logradouro,
		0 nr_residencia,
		'' ds_complemento,
		'' cd_cep,
		'' cd_municipio_ibge,
		null dt_nascimento,
		'' ie_sexo,
		'' ds_raca,
		'' ds_nome_responsavel,
		0 cd_nacionalidade,
		'' cd_etnia,
		'' nr_telefone,
		'' nr_celular,
		0 cd_motivo_saida,
		null dt_ocorrencia,
		cd_cid_principal,
		'' cd_cid_secundario_1,
		'' cd_cid_secundario_2,
		'' cd_cid_secundario_3,
		'' cd_cid_causas_assoc,
		'' cd_carater_atend,
		'' cd_origem_paciente,
		'' ie_cobertura_familiar,
		null cd_estab_esf,
		0 qt_total_acoes,
		'' cd_destino_paciente,
		ie_origem,
		'' ie_situacao_rua,
		'' ie_usuario_drogas,
		'' ie_usuario_tipo_droga,
		'' nr_autorizacao,
		'    ' ds_filler,
		cd_sigtap_acao,
		cd_cbos,
		cd_cns,
		to_char(dt_execucao_acao, 'yyyymmdd') dt_execucao_acao,
		cd_servico,
		cd_classificacao,
		cd_seq_equipe,
		cd_area_equipe,
		qt_realizada,
		cd_ine,
		'' ie_local_exame
from	w_raas_interf_acoes_dom

union

select	'DADOS ATENDIMENTO PSICOSOCIAL' ds_registro,
		cd_linha,
		'' ds_indicador_cabecalho,
		null dt_competencia,
		'' qt_folhas_arquivo,
		0 nr_controle,
		'' nm_orgao_responsavel,
		'' ds_sigla_org_resp,
		'' cd_cgc_prestador,
		'' nm_orgao_destino,
		'' ie_indicador_destino,
		null dt_geracao,
		'' ds_versao_raas,
		'' ds_versao_bdsia,
		cd_uf,
		to_char(dt_producao, 'yyyymm') dt_producao,
		cd_unidade_prestadora,
		cd_cartao_saude_paciente,
		to_char(dt_inicial_validade, 'yyyymmdd') dt_inicial_validade,
		to_char(dt_final_validade, 'yyyymmdd') dt_final_validade,
		nm_paciente,
		nr_prontuario,
		nm_mae_paciente,
		ds_logradouro,
		nr_residencia,
		ds_complemento,
		cd_cep,
		to_char(cd_municipio_ibge) cd_municipio_ibge,
		to_char(dt_nascimento, 'yyyymmdd') dt_nascimento,
		ie_sexo,
		coalesce(ds_raca,'99') ds_raca,
		ds_nome_responsavel,
		cd_nacionalidade,
		cd_etnia,
		nr_telefone,
		nr_celular,
		cd_motivo_saida,
		to_char(dt_ocorrencia, 'yyyymmdd') dt_ocorrencia,
		cd_cid_principal,
		cd_cid_secundario_1,
		cd_cid_secundario_2,
		cd_cid_secundario_3,
		cd_cid_causas_assoc,
		lpad(cd_carater_atend,2,0) cd_carater_atend,
		cd_origem_paciente,
		ie_cobertura_familiar,
		cd_estab_esf,
		qt_total_acoes,
		cd_destino_paciente,
		ie_origem,
		ie_situacao_rua,
		ie_usuario_drogas,
		CASE WHEN ie_usuario_alcool='S' THEN 'A' END  || CASE WHEN ie_usuario_crack='S' THEN 'C' END  || CASE WHEN ie_usuario_outros='S' THEN 'O' END  ie_usuario_tipo_droga,
		nr_autorizacao,
		'    ' ds_filler,
		'' cd_sigtap_acao,
		'' cd_cbos,
		'' cd_cns,
		null dt_execucao_acao,
		0 cd_servico,
		0 cd_classificacao,
		'' cd_seq_equipe,
		'' cd_area_equipe,
		0 qt_realizada,
		'' cd_ine,
		'' ie_local_exame
from	w_raas_interf_pac_psico

union

select	'ACOES ATENDIMENTO PSICOSOCIAL' ds_registro,
		cd_linha,
		'' ds_indicador_cabecalho,
		null dt_competencia,
		'' qt_folhas_arquivo,
		0 nr_controle,
		'' nm_orgao_responsavel,
		'' ds_sigla_org_resp,
		'' cd_cgc_prestador,
		'' nm_orgao_destino,
		'' ie_indicador_destino,
		null dt_geracao,
		'' ds_versao_raas,
		'' ds_versao_bdsia,
		cd_uf,
		to_char(dt_producao, 'yyyymm') dt_producao,
		cd_cnes cd_unidade_prestadora,
		cd_cartao_saude_paciente,
		to_char(dt_validade_inicial, 'yyyymmdd') dt_inicial_validade,
		null dt_final_validade,
		'' nm_paciente,
		0 nr_prontuario,
		'' nm_mae_paciente,
		'' ds_logradouro,
		0 nr_residencia,
		'' ds_complemento,
		'' cd_cep,
		'' cd_municipio_ibge,
		null dt_nascimento,
		'' ie_sexo,
		'' ds_raca,
		'' ds_nome_responsavel,
		0 cd_nacionalidade,
		'' cd_etnia,
		'' nr_telefone,
		'' nr_celular,
		0 cd_motivo_saida,
		null dt_ocorrencia,
		'' cd_cid_principal,
		'' cd_cid_secundario_1,
		'' cd_cid_secundario_2,
		'' cd_cid_secundario_3,
		'' cd_cid_causas_assoc,
		'' cd_carater_atend,
		'' cd_origem_paciente,
		'' ie_cobertura_familiar,
		null cd_estab_esf,
		0 qt_total_acoes,
		'' cd_destino_paciente,
		ie_origem,
		'' ie_situacao_rua,
		'' ie_usuario_drogas,
		'' ie_usuario_tipo_droga,
		'' nr_autorizacao,
		'    ' ds_filler,
		cd_sigtap_acao,
		cd_cbos,
		cd_cns,
		to_char(dt_execucao_acao, 'yyyymmdd') dt_execucao_acao,
		cd_servico,
		cd_classificacao,
		'' cd_seq_equipe,
		'' cd_area_equipe,
		qt_realizada,
		'' cd_ine,
		ie_local_exame
from	w_raas_interf_acoes_psico
order by cd_linha;

