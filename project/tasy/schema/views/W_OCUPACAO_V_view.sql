-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW w_ocupacao_v (cd_setor_atendimento, qt_leitos_data, dt_mes_ref, qt_pac_d1, pr_ocup_d1, qt_pac_d2, pr_ocup_d2, qt_pac_d3, pr_ocup_d3, qt_pac_d4, pr_ocup_d4, qt_pac_d5, pr_ocup_d5, qt_pac_d6, pr_ocup_d6, qt_pac_d7, pr_ocup_d7, qt_pac_d8, pr_ocup_d8, qt_pac_d9, pr_ocup_d9, qt_pac_d10, pr_ocup_d10, qt_pac_d11, pr_ocup_d11, qt_pac_d12, pr_ocup_d12, qt_pac_d13, pr_ocup_d13, qt_pac_d14, pr_ocup_d14, qt_pac_d15, pr_ocup_d15, qt_pac_d16, pr_ocup_d16, qt_pac_d17, pr_ocup_d17, qt_pac_d18, pr_ocup_d18, qt_pac_d19, pr_ocup_d19, qt_pac_d20, pr_ocup_d20, qt_pac_d21, pr_ocup_d21, qt_pac_d22, pr_ocup_d22, qt_pac_d23, pr_ocup_d23, qt_pac_d24, pr_ocup_d24, qt_pac_d25, pr_ocup_d25, qt_pac_d26, pr_ocup_d26, qt_pac_d27, pr_ocup_d27, qt_pac_d28, pr_ocup_d28, qt_pac_d29, pr_ocup_d29, qt_pac_d30, pr_ocup_d30, qt_pac_d31, pr_ocup_d31) AS Select	cd_setor_atendimento,
	MAX(QT_LEITOS_DATA) qt_leitos_data,
	trunc(a.dt_referencia,'mm') dt_mes_ref,
	max((Select QT_PAC_DIA
	 FROM	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '01')) qt_pac_d1,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '01')) pr_ocup_d1,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '02')) qt_pac_d2,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '02')) pr_ocup_d2,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '03')) qt_pac_d3,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '03')) pr_ocup_d3,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '04')) qt_pac_d4,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '04')) pr_ocup_d4,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '05')) qt_pac_d5,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '05')) pr_ocup_d5,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '06')) qt_pac_d6,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '06')) pr_ocup_d6,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '07')) qt_pac_d7,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '07')) pr_ocup_d7,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '08')) qt_pac_d8,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '08')) pr_ocup_d8,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '09')) qt_pac_d9,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '09')) pr_ocup_d9,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '10')) qt_pac_d10,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '10')) pr_ocup_d10,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '11')) qt_pac_d11,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '11')) pr_ocup_d11,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '12')) qt_pac_d12,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '12')) pr_ocup_d12,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '13')) qt_pac_d13,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '13')) pr_ocup_d13,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '14')) qt_pac_d14,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '14')) pr_ocup_d14,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '15')) qt_pac_d15,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '15')) pr_ocup_d15,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '16')) qt_pac_d16,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '16')) pr_ocup_d16,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '17')) qt_pac_d17,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '17')) pr_ocup_d17,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '18')) qt_pac_d18,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '18')) pr_ocup_d18,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '19')) qt_pac_d19,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '19')) pr_ocup_d19,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '20')) qt_pac_d20,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '20')) pr_ocup_d20,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '21')) qt_pac_d21,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '21')) pr_ocup_d21,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '22')) qt_pac_d22,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '22')) pr_ocup_d22,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '23')) qt_pac_d23,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '23')) pr_ocup_d23,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '24')) qt_pac_d24,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	and 	to_char(x.dt_referencia,'dd') = '24')) pr_ocup_d24,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '25')) qt_pac_d25,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '25')) pr_ocup_d25,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '26')) qt_pac_d26,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '26')) pr_ocup_d26,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '27')) qt_pac_d27,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '27')) pr_ocup_d27,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '28')) qt_pac_d28,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '28')) pr_ocup_d28,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '29')) qt_pac_d29,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '29')) pr_ocup_d29,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '30')) qt_pac_d30,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '30')) pr_ocup_d30,
	max((Select QT_PAC_DIA
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '31')) qt_pac_d31,
	max((Select PR_OCUPACAO_SETOR
	 from	w_ocupacao x
	 where	x.dt_referencia = a.dt_referencia
	 and	x.cd_setor_atendimento  = a.cd_setor_atendimento
	 and 	to_char(x.dt_referencia,'dd') = '31')) pr_ocup_d31
from	 w_ocupacao a
group by a.cd_setor_atendimento,
	trunc(a.dt_referencia,'mm');

