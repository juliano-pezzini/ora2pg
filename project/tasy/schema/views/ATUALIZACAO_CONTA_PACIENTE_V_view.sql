-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW atualizacao_conta_paciente_v (ds_item, ie_item, nr_atendimento, nr_interno_conta, dt_atualizacao, dt_registro, dt_liberacao, cd_profissional, nm_usuario) AS select	'Conta' ds_item,
	1 ie_item, 
	nr_atendimento, 
	nr_interno_conta, 
	dt_atualizacao, 
	dt_acerto_conta dt_registro, 
	null dt_liberacao, 
	substr(obter_dados_usuario_opcao(nm_usuario,'C'),1,20) cd_profissional, 
	nm_usuario 
FROM	conta_paciente 

union all
 
select	'Procedimento' ds_item, 
	2 ie_item, 
	nr_atendimento, 
	nr_interno_conta, 
	dt_atualizacao, 
	dt_procedimento dt_registro, 
	null dt_liberacao, 
	substr(coalesce(obter_dados_usuario_opcao(nm_usuario_original,'C'),obter_dados_usuario_opcao(nm_usuario,'C')),1,20) cd_profissional, 
	nm_usuario 
from	procedimento_paciente 
where	((ie_responsavel_credito is null or (coalesce(vl_custo_operacional, 0) + coalesce(vl_materiais, 0)) > 0) or (obter_se_pasta_honorario(ie_responsavel_credito) = 'N')) 
and		cd_motivo_exc_conta is null 

union all
 
select	'Procedimento participante' ds_item, 
	3 ie_item, 
	b.nr_atendimento, 
	b.nr_interno_conta, 
	a.dt_atualizacao, 
	a.dt_atualizacao dt_registro, 
	null dt_liberacao, 
	substr(obter_dados_usuario_opcao(a.nm_usuario,'C'),1,20) cd_profissional, 
	a.nm_usuario 
from	procedimento_paciente b, 
	procedimento_participante a 
where	a.nr_sequencia = b.nr_sequencia	 

union all
 
select	'Honorário' ds_item, 
	4 ie_item, 
	nr_atendimento, 
	nr_interno_conta, 
	dt_atualizacao, 
	dt_procedimento dt_registro, 
	null dt_liberacao, 
	substr(coalesce(obter_dados_usuario_opcao(nm_usuario_original,'C'),obter_dados_usuario_opcao(nm_usuario,'C')),1,20) cd_profissional, 
	nm_usuario 
from	procedimento_paciente 
where (ie_responsavel_credito is not null) 
and (obter_se_pasta_honorario(ie_responsavel_credito) = 'S') 
and		cd_motivo_exc_conta is null 

union all
 
select	'Taxa' ds_item, 
	5 ie_item, 
	nr_atendimento, 
	nr_interno_conta, 
	dt_atualizacao, 
	dt_procedimento dt_registro, 
	null dt_liberacao, 
	substr(coalesce(obter_dados_usuario_opcao(nm_usuario_original,'C'),obter_dados_usuario_opcao(nm_usuario,'C')),1,20) cd_profissional, 
	nm_usuario 
from	procedimento_paciente 
where (ie_responsavel_credito is not null) 
and (obter_se_pasta_honorario(ie_responsavel_credito) = 'S') 
and		obter_classif_material_proced(null, cd_procedimento, ie_origem_proced) = '2' 
and		cd_motivo_exc_conta is null 

union all
 
select	'Diária' ds_item, 
	6 ie_item, 
	nr_atendimento, 
	nr_interno_conta, 
	dt_atualizacao, 
	dt_procedimento dt_registro, 
	null dt_liberacao, 
	substr(coalesce(obter_dados_usuario_opcao(nm_usuario_original,'C'),obter_dados_usuario_opcao(nm_usuario,'C')),1,20) cd_profissional, 
	nm_usuario 
from	procedimento_paciente 
where (ie_responsavel_credito is not null) 
and (obter_se_pasta_honorario(ie_responsavel_credito) = 'S') 
and		obter_classif_material_proced(null, cd_procedimento, ie_origem_proced) = '3' 
and		cd_motivo_exc_conta is null 

union all
 
select	'Filme Utilizado' ds_item, 
	7 ie_item, 
	b.nr_atendimento, 
	b.nr_interno_conta, 
	a.dt_atualizacao, 
	a.dt_atualizacao dt_registro, 
	null dt_liberacao, 
	substr(obter_dados_usuario_opcao(a.nm_usuario,'C'),1,20) cd_profissional, 
	a.nm_usuario 
from	procedimento_paciente b, 
	proc_paciente_material a 
where	a.nr_seq_procedimento = b.nr_sequencia 

union all
 
select	'Proced Principal' ds_item, 
	8 ie_item, 
	nr_atendimento, 
	null nr_interno_conta, 
	dt_atualizacao, 
	dt_atualizacao dt_registro, 
	null dt_liberacao, 
	substr(obter_dados_usuario_opcao(nm_usuario,'C'),1,20) cd_profissional, 
	nm_usuario 
from	atend_pac_proc_princ 

union all
 
select	'Material' ds_item, 
	9 ie_item, 
	nr_atendimento, 
	nr_interno_conta, 
	dt_atualizacao, 
	dt_atendimento dt_registro, 
	null dt_liberacao, 
	substr(obter_dados_usuario_opcao(nm_usuario,'C'),1,20) cd_profissional, 
	nm_usuario 
from	material_atend_paciente 
where	cd_motivo_exc_conta is null 
and	dt_acerto_convenio is null 
and obter_classif_material_proced(cd_material, null, null) in ('1','5') 

union all
 
select	'Medicamento' ds_item, 
	10 ie_item, 
	nr_atendimento, 
	nr_interno_conta, 
	dt_atualizacao, 
	dt_atendimento dt_registro, 
	null dt_liberacao, 
	substr(obter_dados_usuario_opcao(nm_usuario,'C'),1,20) cd_profissional, 
	nm_usuario 
from	material_atend_paciente 
where	cd_motivo_exc_conta is null 
and	dt_acerto_convenio is null 
and obter_classif_material_proced(cd_material, null, null) in ('2','3','4') 

union all
 
select	'Extras' ds_item, 
	11 ie_item, 
	nr_atendimento, 
	nr_interno_conta, 
	dt_atualizacao, 
	dt_atendimento dt_registro, 
	null dt_liberacao, 
	substr(obter_dados_usuario_opcao(nm_usuario,'C'),1,20) cd_profissional, 
	nm_usuario 
from	material_atend_paciente 
where	cd_motivo_exc_conta is null 
and	dt_acerto_convenio is null 
and obter_classif_material_proced(cd_material, null, null) in ('5') 

union all
 
select	'OPME' ds_item, 
	12 ie_item, 
	b.nr_atendimento, 
	b.nr_interno_conta, 
	coalesce(a.dt_atualizacao_nrec ,a.dt_atualizacao) dt_atualizacao, 
	a.dt_atualizacao dt_registro, 
	null dt_liberacao, 
	substr(coalesce(obter_dados_usuario_opcao(a.nm_usuario_nrec,'C'), obter_dados_usuario_opcao(a.nm_usuario,'C')),1,20) cd_profissional, 
	a.nm_usuario 
from	material_atend_paciente	b, 
	mat_atend_paciente_opme a 
where	a.nr_seq_material = b.nr_sequencia 
and	cd_motivo_exc_conta is null 
and	dt_acerto_convenio is null 
and obter_classif_material_proced(cd_material, null, null) in ('5') 

union all
 
select	'Desconto' ds_item, 
	13 ie_item, 
	obter_atendimento_conta(nr_interno_conta) nr_atendimento, 
	nr_interno_conta, 
	dt_atualizacao, 
	dt_desconto dt_registro, 
	null dt_liberacao, 
	substr(obter_dados_usuario_opcao(nm_usuario,'C'),1,20) cd_profissional, 
	nm_usuario 
from	conta_paciente_desconto 

union all
 
select	'Desc. Item(Desconto)' ds_item, 
	14 ie_item, 
	obter_atendimento_conta(nr_interno_conta) nr_atendimento, 
	b.nr_interno_conta, 
	coalesce(a.dt_atualizacao_nrec, a.dt_atualizacao) dt_atualizacao, 
	a.dt_atualizacao dt_registro, 
	null dt_liberacao, 
	substr(coalesce(obter_dados_usuario_opcao(a.nm_usuario_nrec,'C'), obter_dados_usuario_opcao(a.nm_usuario,'C')),1,20) cd_profissional, 
	a.nm_usuario 
from	conta_paciente_desconto b, 
	conta_paciente_desc_item a 
where	a.nr_seq_desconto = b.nr_sequencia 

union all
 
select	'Pacote' ds_item, 
	15 ie_item, 
	nr_atendimento, 
	null nr_interno_conta, 
	dt_atualizacao, 
	dt_atualizacao dt_registro, 
	null dt_liberacao, 
	substr(obter_dados_usuario_opcao(nm_usuario,'C'),1,20) cd_profissional, 
	nm_usuario 
from	atendimento_pacote 

union all
 
select	'Regras especiais pacote(Pacote)' ds_item, 
	16 ie_item, 
	nr_atendimento, 
	null nr_interno_conta, 
	dt_atualizacao, 
	dt_atualizacao dt_registro, 
	null dt_liberacao, 
	substr(obter_dados_usuario_opcao(nm_usuario,'C'),1,20) cd_profissional, 
	nm_usuario 
from	atend_pacote_regra 

union all
 
select	'Processo' ds_item, 
	17 ie_item, 
	nr_atendimento, 
	null nr_interno_conta, 
	dt_atualizacao, 
	dt_fim_prev dt_registro, 
	null dt_liberacao, 
	substr(obter_dados_usuario_opcao(nm_usuario,'C'),1,20) cd_profissional, 
	nm_usuario 
from	processo_atendimento 

union all
 
select	'Controle de contas(Etapas Conta)' ds_item, 
	18 ie_item, 
	obter_atendimento_conta(nr_interno_conta) nr_atendimento, 
	nr_interno_conta, 
	dt_atualizacao, 
	dt_etapa dt_registro, 
	null dt_liberacao, 
	substr(obter_dados_usuario_opcao(nm_usuario,'C'),1,20) cd_profissional, 
	nm_usuario 
from	conta_paciente_etapa 

union all
 
select	'Motivos devolução adicional(Etapas Conta)' ds_item, 
	19 ie_item, 
	obter_atendimento_conta(nr_interno_conta) nr_atendimento, 
	b.nr_interno_conta, 
	coalesce(a.dt_atualizacao_nrec, a.dt_atualizacao) dt_atualizacao, 
	a.dt_atualizacao dt_registro, 
	null dt_liberacao, 
	substr(coalesce(obter_dados_usuario_opcao(a.nm_usuario_nrec,'C'), obter_dados_usuario_opcao(a.nm_usuario,'C')),1,20) cd_profissional, 
	a.nm_usuario 
from	conta_paciente_etapa b, 
	conta_paciente_etapa_dev a 
where	b.nr_sequencia = a.nr_seq_etapa 

union all
 
select	'Guias' ds_item, 
	20 ie_item, 
	obter_atendimento_conta(nr_interno_conta) nr_atendimento, 
	nr_interno_conta, 
	dt_atualizacao, 
	dt_atualizacao dt_registro, 
	null dt_liberacao, 
	substr(obter_dados_usuario_opcao(nm_usuario,'C'),1,20) cd_profissional, 
	nm_usuario 
from	tiss_conta_guia;

