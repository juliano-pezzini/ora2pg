-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW estadios_tnm_v (cd_topografia, ie_tipo, ie_classificacao_tnm, cd_estadio, cd_tumor_primario, cd_linfonodo_regional, cd_metastase_distancia, cd_grau_histo, cd_categoria, cd_dunkes, nr_sequencia, cd_mac, ie_tipo_tnm, ie_class_tnm_estadio, vl_fator_risco_estadio, cd_edicao_tnm) AS SELECT  b.cd_topografia,
	'T' ie_tipo,
	'C' ie_classificacao_tnm,
	a.cd_estadio,
	a.cd_tumor_primario,
	a.cd_linfonodo_regional,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a
where	a.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
and	d.cd_topografia	   	 			= b.cd_topografia
and	obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
and	((a.nr_seq_localizacao		= obter_loc_tnm(d.nr_sequencia,'T','C')) or (a.nr_seq_localizacao is null))
and     a.cd_tumor_primario is not null
and     a.cd_linfonodo_regional is not null
and     a.cd_metastase_distancia is not null

union

SELECT  b.cd_topografia,
	'T' ie_tipo,
	'C' ie_classificacao_tnm,
	a.cd_estadio,
	e.cd_tnm,
	a.cd_linfonodo_regional,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'T'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NOT NULL

UNION

SELECT   b.cd_topografia,
	'T' ie_tipo,
	'C' ie_classificacao_tnm,		
	a.cd_estadio,
	a.CD_TUMOR_PRIMARIO,
	e.cd_tnm,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'N'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NOT NULL

UNION

SELECT   b.cd_topografia,
	'T' ie_tipo,
	'C' ie_classificacao_tnm,		 
	a.cd_estadio,
	a.CD_TUMOR_PRIMARIO,
	a.cd_linfonodo_regional,
	e.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'M'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NULL

UNION

SELECT   b.cd_topografia,
	'T' ie_tipo,
	'C' ie_classificacao_tnm,		 
	a.cd_estadio,
	e.cd_tnm,
	f.cd_tnm,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'T'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'C'
AND		 f.ie_componente_tnm    	 		= 'N'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NOT NULL

UNION

SELECT   b.cd_topografia,
	'T' ie_tipo,
	'C' ie_classificacao_tnm,	
	a.cd_estadio,
	e.cd_tnm,
	a.cd_linfonodo_regional,
	f.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'T'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'C'
AND		 f.ie_componente_tnm    	 		= 'M'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NULL

UNION

SELECT   b.cd_topografia,
	'T' ie_tipo,
	'C' ie_classificacao_tnm,
	a.cd_estadio,
	a.CD_TUMOR_PRIMARIO,
	e.cd_tnm,
	f.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'N'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'C'
AND		 f.ie_componente_tnm    	 		= 'M'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NULL

UNION

SELECT   b.cd_topografia,
	'T' ie_tipo,
	'C' ie_classificacao_tnm,	
	a.cd_estadio,
	g.cd_tnm,
	e.cd_tnm,
	f.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f,
		can_tnm_regra g		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'N'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'C'
AND		 f.ie_componente_tnm    	 		= 'M'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND    	 g.ie_classificacao_tnm 	 		= 'C'
AND		 g.ie_componente_tnm    	 		= 'T'
AND		 g.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(g.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NULL

union

SELECT  b.cd_topografia,
	'C' ie_tipo,
	'C' ie_classificacao_tnm,	
	a.cd_estadio,
	a.cd_tumor_primario,
	a.cd_linfonodo_regional,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
		
FROM	   can_tnm_loc_categoria d,
	      can_tnm_localizacao c,
	      cido_topografia b,
	      can_estadio a
WHERE	   a.nr_seq_loc_tnm  	    	= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   ((a.nr_seq_localizacao		= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND	   obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NOT NULL

union

SELECT  b.cd_topografia,
	'C' ie_tipo,
	'C' ie_classificacao_tnm,	
	a.cd_estadio,
	e.cd_tnm,
	a.cd_linfonodo_regional,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'T'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NOT NULL

UNION

SELECT  b.cd_topografia,
	'C' ie_tipo,   
	'C' ie_classificacao_tnm,	
	a.cd_estadio,
	a.CD_TUMOR_PRIMARIO,
	e.cd_tnm,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'N'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NOT NULL

UNION

SELECT   b.cd_topografia,
	'C' ie_tipo,
	'C' ie_classificacao_tnm,	
	a.cd_estadio,
	a.CD_TUMOR_PRIMARIO,
	a.cd_linfonodo_regional,
	e.cd_tnm,
	a.cd_grau_histo,
    a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'M'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NULL

UNION

SELECT  b.cd_topografia,
	'C' ie_tipo,
	'C' ie_classificacao_tnm,	
	a.cd_estadio,
	e.cd_tnm,
	f.cd_tnm,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'T'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'C'
AND		 f.ie_componente_tnm    	 		= 'N'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NOT NULL

UNION

SELECT   b.cd_topografia,
	'C' ie_tipo,
	'C' ie_classificacao_tnm,	
	a.cd_estadio,
	e.cd_tnm,
	a.cd_linfonodo_regional,
	f.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'T'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'C'
AND		 f.ie_componente_tnm    	 		= 'M'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NULL

UNION

SELECT  b.cd_topografia,
	'C' ie_tipo,
	'C' ie_classificacao_tnm,	
	a.cd_estadio,
	a.CD_TUMOR_PRIMARIO,
	e.cd_tnm,
	f.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'N'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'C'
AND		 f.ie_componente_tnm    	 		= 'M'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NULL

UNION

SELECT  b.cd_topografia,
	'C' ie_tipo,
	'C' ie_classificacao_tnm,	
	a.cd_estadio,
	g.cd_tnm,
	e.cd_tnm,
	f.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f,
		can_tnm_regra g		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'C'
AND		 e.ie_componente_tnm    	 		= 'N'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'C'
AND		 f.ie_componente_tnm    	 		= 'M'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND    	 g.ie_classificacao_tnm 	 		= 'C'
AND		 g.ie_componente_tnm    	 		= 'T'
AND		 g.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(g.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NULL

UNION

SELECT  b.cd_topografia,
	'pT' ie_tipo,
	'P' ie_classificacao_tnm,
	a.cd_estadio,
	a.cd_tumor_primario,
	a.cd_linfonodo_regional,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
from	can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a
where	a.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
and	d.cd_topografia	   	 			= b.cd_topografia
and	obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
and	((a.nr_seq_localizacao		= obter_loc_tnm(d.nr_sequencia,'T','C')) or (a.nr_seq_localizacao is null))
and     a.cd_tumor_primario is not null
and     a.cd_linfonodo_regional is not null
and     a.cd_metastase_distancia is not null

union

SELECT  b.cd_topografia,
	'pT' ie_tipo,
	'P' ie_classificacao_tnm,	
	a.cd_estadio,
	e.cd_tnm,
	a.cd_linfonodo_regional,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'P'
AND		 e.ie_componente_tnm    	 		= 'T'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NOT NULL

UNION

SELECT  b.cd_topografia,
	'pT' ie_tipo,
	'P' ie_classificacao_tnm,	
	a.cd_estadio,
	a.CD_TUMOR_PRIMARIO,
	e.cd_tnm,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
	can_tnm_regra e
WHERE	 a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'P'
AND		 e.ie_componente_tnm    	 		= 'N'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NOT NULL

UNION

SELECT   b.cd_topografia,
	'pT' ie_tipo,
	'P' ie_classificacao_tnm,	
	a.cd_estadio,
	a.CD_TUMOR_PRIMARIO,
	a.cd_linfonodo_regional,
	e.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'P'
AND		 e.ie_componente_tnm    	 		= 'M'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NULL

UNION

SELECT   b.cd_topografia,
	'pT' ie_tipo,
	'P' ie_classificacao_tnm,
	a.cd_estadio,
	e.cd_tnm,
	f.cd_tnm,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'P'
AND		 e.ie_componente_tnm    	 		= 'T'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'P'
AND		 f.ie_componente_tnm    	 		= 'N'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NOT NULL

UNION

SELECT   b.cd_topografia,
	'pT' ie_tipo,
	'P' ie_classificacao_tnm,	
	a.cd_estadio,
	e.cd_tnm,
	a.cd_linfonodo_regional,
	f.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'P'
AND		 e.ie_componente_tnm    	 		= 'T'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'P'
AND		 f.ie_componente_tnm    	 		= 'M'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NULL

UNION

SELECT   b.cd_topografia,
	'pT' ie_tipo,
	'P' ie_classificacao_tnm,	
	a.cd_estadio,
	a.CD_TUMOR_PRIMARIO,
	e.cd_tnm,
	f.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_topografia d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'P'
AND		 e.ie_componente_tnm    	 		= 'N'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'P'
AND		 f.ie_componente_tnm    	 		= 'M'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NULL

UNION

SELECT	b.cd_topografia,
	'pT' ie_tipo,
	'P' ie_classificacao_tnm,	
	a.cd_estadio,
	g.cd_tnm,
	e.cd_tnm,
	f.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	can_tnm_loc_topografia d,
	can_tnm_localizacao c,
	cido_topografia b,
	can_estadio a,
	can_tnm_regra e,
	can_tnm_regra f,
	can_tnm_regra g		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_topografia	   	 			    = b.cd_topografia
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'T','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'P'
AND		 e.ie_componente_tnm    	 		= 'N'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'P'
AND		 f.ie_componente_tnm    	 		= 'M'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND    	 g.ie_classificacao_tnm 	 		= 'P'
AND		 g.ie_componente_tnm    	 		= 'T'
AND		 g.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(g.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'T','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NULL

union

SELECT  b.cd_topografia,
	'pC' ie_tipo,
	'P' ie_classificacao_tnm,	
	a.cd_estadio,
	a.cd_tumor_primario,
	a.cd_linfonodo_regional,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	can_tnm_loc_categoria d,
	can_tnm_localizacao c,
	cido_topografia b,
	can_estadio a
WHERE	   a.nr_seq_loc_tnm  	    	= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   ((a.nr_seq_localizacao		= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND	   obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NOT NULL

union

SELECT  b.cd_topografia,
	'pC' ie_tipo,
	'P' ie_classificacao_tnm,	
	a.cd_estadio,
	e.cd_tnm,
	a.cd_linfonodo_regional,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'P'
AND		 e.ie_componente_tnm    	 		= 'T'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NOT NULL

UNION

SELECT   b.cd_topografia,
	'pC' ie_tipo,
	'P' ie_classificacao_tnm,		 
	a.cd_estadio,
	a.CD_TUMOR_PRIMARIO,
	e.cd_tnm,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'P'
AND		 e.ie_componente_tnm    	 		= 'N'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NOT NULL

UNION

SELECT   b.cd_topografia,
	'pC' ie_tipo,
	'P' ie_classificacao_tnm,	
	a.cd_estadio,
	a.CD_TUMOR_PRIMARIO,
	a.cd_linfonodo_regional,
	e.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   obter_loc_anat_tnm(d.nr_sequencia,'T','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'P'
AND		 e.ie_componente_tnm    	 		= 'M'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NULL

UNION

SELECT   b.cd_topografia,
	'pC' ie_tipo,
	'P' ie_classificacao_tnm,	
	a.cd_estadio,
	e.cd_tnm,
	f.cd_tnm,
	a.cd_metastase_distancia,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'P'
AND		 e.ie_componente_tnm    	 		= 'T'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'P'
AND		 f.ie_componente_tnm    	 		= 'N'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NOT NULL

UNION

SELECT   b.cd_topografia,
	'pC' ie_tipo,
	'P' ie_classificacao_tnm,	
	a.cd_estadio,
	e.cd_tnm,
	a.cd_linfonodo_regional,
	f.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,	 
	c.cd_edicao_tnm
FROM	   can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'P'
AND		 e.ie_componente_tnm    	 		= 'T'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'P'
AND		 f.ie_componente_tnm    	 		= 'M'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND      a.cd_tumor_primario IS NULL
AND      a.cd_linfonodo_regional IS NOT NULL
AND      a.cd_metastase_distancia IS NULL

UNION

SELECT   b.cd_topografia,
	'pC' ie_tipo,
	'P' ie_classificacao_tnm,	
	a.cd_estadio,
	a.CD_TUMOR_PRIMARIO,
	e.cd_tnm,
	f.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	   can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
      	can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f		
WHERE	   a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	   d.cd_categoria			= b.cd_categoria
AND	   obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND	   ((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	 e.ie_classificacao_tnm 	 		= 'P'
AND		 e.ie_componente_tnm    	 		= 'N'
AND		 e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND    	 f.ie_classificacao_tnm 	 		= 'P'
AND		 f.ie_componente_tnm    	 		= 'M'
AND		 f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND		 obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND      a.cd_tumor_primario IS NOT NULL
AND      a.cd_linfonodo_regional IS NULL
AND      a.cd_metastase_distancia IS NULL

UNION

SELECT   b.cd_topografia,
	'pC' ie_tipo,
	'P' ie_classificacao_tnm,	
	a.cd_estadio,
	g.cd_tnm,
	e.cd_tnm,
	f.cd_tnm,
	a.cd_grau_histo,
	a.cd_categoria,
	a.cd_dunkes,
	a.nr_sequencia,
    a.cd_mac,
	a.ie_tipo_tnm,
	a.ie_classificacao_tnm as ie_class_tnm_estadio,
	a.vl_fator_risco_estadio,
	c.cd_edicao_tnm
FROM	can_tnm_loc_categoria d,
      	can_tnm_localizacao c,
      	cido_topografia b,
		can_estadio a,
		can_tnm_regra e,
		can_tnm_regra f,
		can_tnm_regra g		
WHERE	a.nr_seq_loc_tnm  	   	 		= c.nr_sequencia
AND	d.cd_categoria			= b.cd_categoria
AND	obter_loc_anat_tnm(d.nr_sequencia,'C','C')	= c.nr_sequencia
AND	((a.nr_seq_localizacao				= obter_loc_tnm(d.nr_sequencia,'C','C')) OR (a.nr_seq_localizacao IS NULL))
AND    	e.ie_classificacao_tnm 	 		= 'P'
AND	e.ie_componente_tnm    	 		= 'N'
AND	e.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND	obter_se_loc_tnm_regra(e.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND    	f.ie_classificacao_tnm 	 		= 'P'
AND	f.ie_componente_tnm    	 		= 'M'
AND	f.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND	obter_se_loc_tnm_regra(f.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND    	g.ie_classificacao_tnm 	 		= 'P'
AND	g.ie_componente_tnm    	 		= 'T'
AND	g.nr_seq_loc_tnm  	   	 		    = c.nr_sequencia
AND	obter_se_loc_tnm_regra(g.nr_sequencia,obter_loc_tnm(d.nr_sequencia,'C','C')) = 'S'
AND     a.cd_tumor_primario IS NULL
AND     a.cd_linfonodo_regional IS NULL
AND     a.cd_metastase_distancia IS NULL;

