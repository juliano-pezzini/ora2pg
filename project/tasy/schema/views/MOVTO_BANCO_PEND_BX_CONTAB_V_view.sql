-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW movto_banco_pend_bx_contab_v (nr_titulo, vl_baixa, nr_seq_trans_contab_cheque, dt_baixa, nr_seq_conta_banco, nm_atributo, cd_centro_custo, dt_recebimento, cd_conta_contabil, nr_seq_retorno, nr_seq_ret_item, cd_conta_deb_pls, cd_conta_rec_pls, cd_historico_pls, nr_seq_movto_trans_fin, ds_observacao_titulo, ds_comprovante, nr_autorizacao, nr_seq_produto, ds_observacao, ie_acao, nr_adiantamento, nr_seq_movto_cartao_cr, vl_antecipacao_mens, ie_lote_antecip_pls, dt_referencia_pls_mens, nr_seq_baixa, nr_seq_nota_credito, nr_seq_liq_cc, ie_lote_pro_rata, cd_tributo, ie_origem_titulo, ds_obs_movto_cartao_baixa, nr_seq_propaci_partic, nr_lote_contabil, nr_seq_movto_pend_baixa) AS select 	a.nr_titulo,
	a.vl_baixa,
	coalesce(a.nr_seq_trans_financ_baixa, a.nr_seq_trans_contab_cheque) nr_seq_trans_contab_cheque,
	a.dt_baixa,
	null nr_seq_conta_banco,
	'VL_BAIXA_CNI' nm_atributo,
	0 cd_centro_custo,
	a.dt_baixa dt_recebimento,
	'' cd_conta_contabil,
	null nr_seq_retorno,
	null nr_seq_ret_item,
	'' cd_conta_deb_pls,
	'' cd_conta_rec_pls,
	(null)::numeric  cd_historico_pls,
	a.nr_seq_movto_trans_fin,
	null ds_observacao_titulo,
	'' DS_COMPROVANTE,
	'' NR_AUTORIZACAO,
	(null)::numeric  nr_seq_produto,
	a.ds_observacao,
	null ie_acao,
	a.nr_adiantamento,
	null nr_seq_movto_cartao_cr,
	(null)::numeric  vl_antecipacao_mens,
	to_char(null) ie_lote_antecip_pls,
	to_date(null) dt_referencia_pls_mens,
	null nr_seq_baixa,
	null nr_seq_nota_credito,
	null nr_seq_liq_cc,
	null ie_lote_pro_rata,
	null cd_tributo,
	null ie_origem_titulo,
	to_char(null) ds_obs_movto_cartao_baixa,
	null nr_seq_propaci_partic,
	a.nr_lote_contabil,
	a.nr_sequencia nr_seq_movto_pend_baixa
FROM 	movto_banco_pend_baixa	a
where	coalesce(a.nr_seq_trans_financ_baixa, a.nr_seq_trans_contab_cheque) is not null

union all

select	a.nr_titulo,
	a.vl_juros,
	coalesce(a.nr_seq_trans_financ_baixa, a.nr_seq_trans_contab_cheque) nr_seq_trans_contab_cheque,
	a.dt_baixa,
	null nr_seq_conta_banco,
	'VL_JUROS_CNI',
	0 cd_centro_custo,
	a.dt_baixa,
	'' cd_conta_contabil,
	null nr_seq_retorno,
	null nr_seq_ret_item,
	'' cd_conta_deb_pls,
	'' cd_conta_rec_pls,
	(null)::numeric  cd_historico_pls,
	a.nr_seq_movto_trans_fin,
	null ds_observacao_titulo,
	'' DS_COMPROVANTE,
	'' NR_AUTORIZACAO,
	(null)::numeric  nr_seq_produto,
	a.ds_observacao,
	null ie_acao,
	a.nr_adiantamento,
	null nr_seq_movto_cartao_cr,
	(null)::numeric  vl_antecipacao_mens,
	to_char(null) ie_lote_antecip_pls,
	to_date(null) dt_referencia_pls_mens,
	null nr_seq_baixa,
	null nr_seq_nota_credito,
	null nr_seq_liq_cc,
	null ie_lote_pro_rata,
	null cd_tributo,
	null ie_origem_titulo,
	to_char(null) ds_obs_movto_cartao_baixa,
	null nr_seq_propaci_partic,
	a.nr_lote_contabil,
	a.nr_sequencia nr_seq_movto_pend_baixa
from 	movto_banco_pend_baixa	a
where 	coalesce(a.nr_seq_trans_financ_baixa, a.nr_seq_trans_contab_cheque) is not null
and	a.vl_juros <> 0

union all

select	a.nr_titulo,
	a.vl_multa,
	coalesce(a.nr_seq_trans_financ_baixa, a.nr_seq_trans_contab_cheque) nr_seq_trans_contab_cheque,
	a.dt_baixa,
	null nr_seq_conta_banco,
	'VL_MULTA_CNI',
	0 cd_centro_custo,
	a.dt_baixa,
	'' cd_conta_contabil,
	null nr_seq_retorno,
	null nr_seq_ret_item,
	'' cd_conta_deb_pls,
	'' cd_conta_rec_pls,
	(null)::numeric  cd_historico_pls,
	a.nr_seq_movto_trans_fin,
	null ds_observacao_titulo,
	'' DS_COMPROVANTE,
	'' NR_AUTORIZACAO,
	(null)::numeric  nr_seq_produto,
	a.ds_observacao,
	null ie_acao,
	a.nr_adiantamento,
	null nr_seq_movto_cartao_cr,
	(null)::numeric  vl_antecipacao_mens,
	to_char(null) ie_lote_antecip_pls,
	to_date(null) dt_referencia_pls_mens,
	null nr_seq_baixa,
	null nr_seq_nota_credito,
	null nr_seq_liq_cc,
	null ie_lote_pro_rata,
	null cd_tributo,
	null ie_origem_titulo,
	to_char(null) ds_obs_movto_cartao_baixa,
	null nr_seq_propaci_partic,
	a.nr_lote_contabil,
	a.nr_sequencia nr_seq_movto_pend_baixa
from 	movto_banco_pend_baixa	a
where 	a.vl_multa <> 0
and	coalesce(a.nr_seq_trans_financ_baixa, a.nr_seq_trans_contab_cheque) is not null;

