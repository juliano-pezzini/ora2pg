-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW conta_paciente_pacote_v (dt_mesano_referencia, nr_seq_protocolo, nr_atendimento, cd_proc_pacote, ie_origem_proc_pacote, cd_material_pacote, nr_interno_conta, nr_sequencia, qt_resumo, vl_medico, vl_auxiliares, vl_custo_operacional, vl_anestesista, vl_materiais, vl_procedimento, vl_material, vl_custo, cd_setor_atendimento, cd_especialidade, cd_conta_contabil, cd_material, cd_unidade_medida, ie_origem_proced, cd_procedimento, nr_seq_grupo_rec, vl_medico_fora_conta, cd_setor_receita, ie_diaria, vl_sadt_fora_conta, vl_repasse_terceiro, cd_estrutura_conta, nr_seq_conta_financ, dt_referencia, vl_imposto, nr_cirugia, nr_prescricao, cd_cgc_fornec, vl_desconto, nr_seq_proc_pacote, vl_original, vl_custo_dir_apoio, vl_custo_mao_obra, vl_custo_direto, vl_custo_variavel, vl_custo_indireto, vl_despesa, vl_glosa, vl_custo_sadt, vl_repasse_calc, vl_desc_financ, vl_custo_hm, qt_exclusao_custo, nr_seq_exame, nr_seq_proc_interno, pr_imposto_custo, qt_exclusao_conta, vl_custo_excluido, nr_seq_produto, vl_custo_var_mc, qt_estoque, ie_responsavel_credito, cd_cgc_prestador, cd_setor_paciente) AS select
	a.dt_mesano_referencia,
	a.nr_seq_protocolo,
	a.nr_atendimento,
	c.cd_procedimento cd_proc_pacote,
	c.ie_origem_proced ie_origem_proc_pacote,
	coalesce(d.cd_material_agrup, b.cd_material) cd_material_pacote,
	b.NR_INTERNO_CONTA,b.NR_SEQUENCIA,b.QT_RESUMO,b.VL_MEDICO,b.VL_AUXILIARES,b.VL_CUSTO_OPERACIONAL,b.VL_ANESTESISTA,b.VL_MATERIAIS,b.VL_PROCEDIMENTO,b.VL_MATERIAL,b.VL_CUSTO,b.CD_SETOR_ATENDIMENTO,b.CD_ESPECIALIDADE,b.CD_CONTA_CONTABIL,b.CD_MATERIAL,b.CD_UNIDADE_MEDIDA,b.IE_ORIGEM_PROCED,b.CD_PROCEDIMENTO,b.NR_SEQ_GRUPO_REC,b.VL_MEDICO_FORA_CONTA,b.CD_SETOR_RECEITA,b.IE_DIARIA,b.VL_SADT_FORA_CONTA,b.VL_REPASSE_TERCEIRO,b.CD_ESTRUTURA_CONTA,b.NR_SEQ_CONTA_FINANC,b.DT_REFERENCIA,b.VL_IMPOSTO,b.NR_CIRUGIA,b.NR_PRESCRICAO,b.CD_CGC_FORNEC,b.VL_DESCONTO,b.NR_SEQ_PROC_PACOTE,b.VL_ORIGINAL,b.VL_CUSTO_DIR_APOIO,b.VL_CUSTO_MAO_OBRA,b.VL_CUSTO_DIRETO,b.VL_CUSTO_VARIAVEL,b.VL_CUSTO_INDIRETO,b.VL_DESPESA,b.VL_GLOSA,b.VL_CUSTO_SADT,b.VL_REPASSE_CALC,b.VL_DESC_FINANC,b.VL_CUSTO_HM,b.QT_EXCLUSAO_CUSTO,b.NR_SEQ_EXAME,b.NR_SEQ_PROC_INTERNO,b.PR_IMPOSTO_CUSTO,b.QT_EXCLUSAO_CONTA,b.VL_CUSTO_EXCLUIDO,b.NR_SEQ_PRODUTO,b.VL_CUSTO_VAR_MC,b.QT_ESTOQUE,b.IE_RESPONSAVEL_CREDITO,b.CD_CGC_PRESTADOR,b.CD_SETOR_PACIENTE
FROM procedimento_paciente c, conta_paciente a, conta_paciente_resumo b
LEFT OUTER JOIN material_agrup d ON (b.cd_material = d.cd_material AND 1 = d.ie_motivo)
WHERE a.nr_interno_conta 	= b.nr_interno_conta and b.nr_seq_proc_pacote	= c.nr_sequencia;

