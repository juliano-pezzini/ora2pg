-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW sulamerica_sp_v (nr_seq_protocolo, nr_conta, tp_registro, nr_seq_item, nr_parcela, cd_plano, cd_cliente, cd_autorizacao, cd_acomodacao, dt_entrada, dt_alta, dt_inicio_conta, dt_fim_conta, cd_atendimento, cd_cid, cd_proc_principal, nr_crm, sg_uf_crm, nm_paciente, cd_item_convenio, ds_item_convenio, ie_emergencia, ie_hora_extra, dt_item, ie_funcao_medico, qt_item, vl_item, pr_via_acesso) AS select
	a.nr_seq_protocolo,
	a.nr_interno_conta nr_conta,
	1 tp_registro,
	0 nr_seq_item,
	1 nr_parcela,
	a.cd_plano_convenio cd_plano,
	a.cd_usuario_convenio cd_cliente,
	a.nr_doc_convenio cd_autorizacao,
	a.cd_tipo_acomodacao cd_acomodacao,
	a.dt_entrada,
	a.dt_alta,
	a.dt_periodo_inicial dt_inicio_conta,
	a.dt_periodo_final dt_fim_conta,
	a.ie_clinica cd_atendimento,
	a.cd_cid_principal cd_cid,
	a.cd_proc_principal cd_proc_principal,
	a.nr_crm_medico_resp nr_crm,
	a.uf_crm_medico_resp sg_uf_crm,
	a.nm_paciente,
	0 cd_item_convenio,
	' '  ds_item_convenio,
	' ' ie_emergencia,
	' ' ie_hora_extra,
	LOCALTIMESTAMP dt_item,
	0 ie_funcao_medico,
	0 qt_item,
	0 vl_item,
	0 pr_via_acesso
FROM	w_interf_conta_cab a

union

select
	b.nr_seq_protocolo,
	b.nr_interno_conta nr_conta,
	2 tp_registro,
	b.nr_seq_item,
	0,
	' ',
	' ',
	' ',
	0,
	LOCALTIMESTAMP,
	LOCALTIMESTAMP,
	LOCALTIMESTAMP,
	LOCALTIMESTAMP,
	0,
	' ',
	' ',
	' ',
	' ',
	' ',
	(b.cd_item_convenio)::numeric ,
	b.ds_item,
	CASE WHEN c.ie_carater_inter='05' THEN 'S'  ELSE 'N' END  ie_emergencia,
	CASE WHEN b.pr_hora_extra=0 THEN 'N'  ELSE 'S' END  ie_hora_extra,
	b.dt_item,
	b.cd_funcao_executor ie_funcao_medico,
	b.qt_item,
	b.vl_total_item vl_item,
	b.pr_via_acesso
from	w_interf_conta_cab c,
	w_interf_conta_item b
where b.nr_seq_protocolo = c.nr_seq_protocolo
and	b.nr_interno_conta = c.nr_interno_conta;

