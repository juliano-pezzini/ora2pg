-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_requisicao_glosa_ptu_v (nr_codigo, ds_descricao_glosa_ocor, ds_observacao, nr_seq_requisicao, nr_seq_proc, nr_seq_mat) AS select  substr(pls_obter_erro_intercambio(a.nr_seq_inconsistencia,'C'),1,10) nr_codigo,
        substr(pls_obter_erro_intercambio(a.nr_seq_inconsistencia,'D'),1,255) ds_descricao_glosa_ocor,
        substr(a.ds_observacao,1,255) ds_observacao,
        a.nr_seq_requisicao nr_seq_requisicao,
        a.nr_seq_procedimento nr_seq_proc,
        a.nr_seq_material nr_seq_mat
FROM    ptu_intercambio_consist a

union

select  substr(pls_obter_erro_intercambio(y.nr_sequencia,'C'),1,10) nr_codigo,
        substr(pls_obter_erro_intercambio(y.nr_sequencia,'D'),1,255) ds_descricao_glosa_ocor,
        substr(y.ds_observacao,1,255) ds_observacao,
        z.nr_seq_requisicao nr_seq_requisicao,
        z.nr_seq_req_proc nr_seq_proc,
        z.nr_seq_req_mat nr_seq_mat
from	pls_acao_glosa_tiss x,
        ptu_inconsistencia y,
        pls_requisicao_glosa z 
where   x.nr_seq_inconsis_scs = y.nr_sequencia  
and 	x.nr_seq_motivo_glosa = z.nr_seq_motivo_glosa

union

select  substr(pls_obter_erro_intercambio(v.nr_sequencia,'C'),1,10) nr_codigo,
        substr(pls_obter_erro_intercambio(v.nr_sequencia,'D'),1,255) ds_descricao_glosa_ocor,
        substr(v.ds_observacao,1,255) ds_observacao,
        w.nr_seq_requisicao nr_seq_requisicao,
        w.nr_seq_proc nr_seq_proc,
        w.nr_seq_mat nr_seq_mat
from	pls_ocorrencia_scs u,
        ptu_inconsistencia v,
        pls_ocorrencia_benef w,
        pls_requisicao  r 
where   r.nr_sequencia  = w.nr_seq_requisicao  
and 	u.nr_seq_inconsis_scs = v.nr_sequencia  
and	u.nr_seq_ocorrencia = w.nr_seq_ocorrencia  
and 	r.ie_tipo_intercambio = 'E';

