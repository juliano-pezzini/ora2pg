-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_intercambio_60_v (nr_seq_intercabio, tp_registro, nr_sequencia, cd_tipo_registro, cd_unimed_destino, cd_unimed_origem, dt_geracao, ie_tipo_mov, dt_mov_inicio, dt_mov_fim, nr_versao_transacao, cd_filial, nm_empr_comp, nm_empr_abrev, ds_reservado, cd_cgc_cpf, nr_insc_estadual, ds_endereco, ds_complemento, ds_bairro, cd_cep, nm_cidade, sg_uf, nr_ddd, dt_inclusao, dt_exclusao, cd_empresa_origem, cd_municipio_ibge, nr_telefone, nr_fax, nr_endereco_empresa, cd_plano_origem, ds_plano_origem, cd_plano_intercambio, dt_inclusao_plano, dt_exclusao_plano, ie_natureza, ie_abrangencia, nr_ind_reembolso, cd_ope_ans, cd_prod_ans, ie_plano, cd_unimed, cd_usuario_plano, cd_familia, nm_benef_abreviado, cd_plano_intercambio_benef, dt_nascimento, ie_sexo, cd_cgc_cpf_benef, nr_rg, sg_uf_rg, ie_estado_civil, dt_inclusao_benef, dt_exclusao_benef, ie_repasse, cd_dependencia, ie_recem_nascido, nr_matricula, dt_validade_carteira, cd_local_atendimento, cd_lotacao, ds_lotacao, dt_repasse, dt_fim_repasse, dt_inclusao_plano_dest, cd_plano_origem_benef, nr_vigencia_origem, cd_titular_plano, nm_beneficiario, nr_cartao_nac_sus, nm_mae_benef, nr_pis_pasep, cd_tipo_cobertura, dt_fim_carencia, cd_tipo_produto, ds_produto, ds_endereco_benef, ds_bairro_benef, cd_cep_benef, nm_municipio, sg_uf_benef, nr_ddd_benef, nr_ramal, nr_fone, nr_endereco, cd_cid, dt_fim_carencia_preex, qt_total_r102, qt_total_r103, qt_total_r104, qt_total_inclusao, qt_exclusos_benef, qt_total_alteracoes, qt_total_transferencia, qt_total_r105, qt_total_r106, qt_total_r107, qt_total_r108, dt_postagem, nr_protocolo, nr_seq_plano, nr_seq_segurado, nr_seq_empresa, nr_seq_benef) AS select	nr_sequencia		nr_seq_intercabio,
	1			tp_registro,
	1			nr_sequencia,
	'101'			cd_tipo_registro,
	cd_unimed_destino	cd_unimed_destino,
	cd_unimed_origem	cd_unimed_origem,
	dt_geracao		dt_geracao,
	ie_tipo_mov		ie_tipo_mov,
	dt_mov_inicio		dt_mov_inicio,
	dt_mov_fim		dt_mov_fim,
	nr_versao_transacao	nr_versao_transacao,
	null			cd_filial,
	null			nm_empr_comp,
	null			nm_empr_abrev,
	' '			ds_reservado,
	null			cd_cgc_cpf,
	null			nr_insc_estadual,
	null			ds_endereco,
	null			ds_complemento,
	null			ds_bairro,
	null			cd_cep,
	null			nm_cidade,
	null			sg_uf,
	null			nr_ddd,
	null			dt_inclusao,
	null			dt_exclusao,
	null			cd_empresa_origem,
	null			cd_municipio_ibge,
	null			nr_telefone,
	null			nr_fax,
	null			nr_endereco_empresa,
	null			cd_plano_origem,
	null			ds_plano_origem,
	null			cd_plano_intercambio,
	null			dt_inclusao_plano,
	null			dt_exclusao_plano,
	null			ie_natureza,
	null			ie_abrangencia,
	null			nr_ind_reembolso,
	null			cd_ope_ans,
	null			cd_prod_ans,
	null			ie_plano,
	null			cd_unimed,
	null			cd_usuario_plano,
	null			cd_familia,
	null			nm_benef_abreviado,
	null			cd_plano_intercambio_benef,
	null			dt_nascimento,
	null			ie_sexo,
	null			cd_cgc_cpf_benef,
	null			nr_rg,
	null			sg_uf_rg,
	null			ie_estado_civil,
	null			dt_inclusao_benef,
	null			dt_exclusao_benef,
	null			ie_repasse,
	null			cd_dependencia,
	null			ie_recem_nascido,
	null			nr_matricula,
	null			dt_validade_carteira,
	null			cd_local_atendimento,
	null			cd_lotacao,
	null			ds_lotacao,
	null			dt_repasse,
	null			dt_fim_repasse,
	null			dt_inclusao_plano_dest,
	null			cd_plano_origem_benef,
	null			nr_vigencia_origem,
	null			cd_titular_plano,
	null			nm_beneficiario,
	null			nr_cartao_nac_sus,
	null			nm_mae_benef,
	null			nr_pis_pasep,
	null			cd_tipo_cobertura,
	null			dt_fim_carencia,
	null			cd_tipo_produto,
	null			ds_produto,
	null			ds_endereco_benef,
	null			ds_bairro_benef,
	null			cd_cep_benef,
	null			nm_municipio,
	null			sg_uf_benef,
	null			nr_ddd_benef,
	null			nr_ramal,
	null			nr_fone,
	null			nr_endereco,
	null			cd_cid,
	null			dt_fim_carencia_preex,
	null			qt_total_r102,
	null			qt_total_r103,
	null			qt_total_r104,
	null			qt_total_inclusao,
	null			qt_exclusos_benef,
	null			qt_total_alteracoes,
	null			qt_total_transferencia,
	null			qt_total_r105,
	null			qt_total_r106,
	null			qt_total_r107,
	null			qt_total_r108,
	null			dt_postagem,
	null			nr_protocolo,
	null			nr_seq_plano,
	null			nr_seq_segurado,
	0			nr_seq_empresa,
	0			nr_seq_benef
FROM	ptu_intercambio

union all

select	nr_seq_intercambio		nr_seq_intercabio,
	2			tp_registro,
	2			nr_sequencia,
	'102'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			ie_tipo_mov,
	null			dt_mov_inicio,
	null			dt_mov_fim,
	null			nr_versao_transacao,
	a.cd_filial			cd_filial,
	a.ds_razao_social		nm_empr_comp,
	a.nm_empr_abrev		nm_empr_abrev,
	' '			ds_reservado,
	a.cd_cgc_cpf cd_cgc_cpf,
	a.nr_insc_estadual		nr_insc_estadual,
	a.ds_endereco		ds_endereco,
	a.ds_complemento		ds_complemento,
	a.ds_bairro		ds_bairro,
	a.cd_cep			cd_cep,
	a.nm_cidade		nm_cidade,
	a.sg_uf			sg_uf,
	a.nr_ddd			nr_ddd,
	a.dt_inclusao		dt_inclusao,
	a.dt_exclusao		dt_exclusao,
	a.cd_empresa_origem	cd_empresa_origem,
	a.cd_municipio_ibge	cd_municipio_ibge,
	a.nr_telefone		nr_telefone,
	a.nr_fax			nr_fax,
	coalesce(a.nr_endereco,'S/N') 	nr_endereco_empresa,
	null			cd_plano_origem,
	null			ds_plano_origem,
	null			cd_plano_intercambio,
	null			dt_inclusao_plano,
	null			dt_exclusao_plano,
	null			ie_natureza,
	null			ie_abrangencia,
	null			nr_ind_reembolso,
	null			cd_ope_ans,
	null			cd_prod_ans,
	null			ie_plano,
	null			cd_unimed,
	null			cd_usuario_plano,
	null			cd_familia,
	null			nm_benef_abreviado,
	null			cd_plano_intercambio_benef,
	null			dt_nascimento,
	null			ie_sexo,
	null			cd_cgc_cpf_benef,
	null			nr_rg,
	null			sg_uf_rg,
	null			ie_estado_civil,
	null			dt_inclusao_benef,
	null			dt_exclusao_benef,
	null			ie_repasse,
	null			cd_dependencia,
	null			ie_recem_nascido,
	null			nr_matricula,
	null			dt_validade_carteira,
	null			cd_local_atendimento,
	null			cd_lotacao,
	null			ds_lotacao,
	null			dt_repasse,
	null			dt_fim_repasse,
	null			dt_inclusao_plano_dest,
	null			cd_plano_origem_benef,
	null			nr_vigencia_origem,
	null			cd_titular_plano,
	null			nm_beneficiario,
	null			nr_cartao_nac_sus,
	null			nm_mae_benef,
	null			nr_pis_pasep,
	null			cd_tipo_cobertura,
	null			dt_fim_carencia,
	null			cd_tipo_produto,
	null			ds_produto,
	null			ds_endereco_benef,
	null			ds_bairro_benef,
	null			cd_cep_benef,
	null			nm_municipio,
	null			sg_uf_benef,
	null			nr_ddd_benef,
	null			nr_ramal,
	null			nr_fone,
	null			nr_endereco,
	null			cd_cid,
	null			dt_fim_carencia_preex,
	null			qt_total_r102,
	null			qt_total_r103,
	null			qt_total_r104,
	null			qt_total_inclusao,
	null			qt_exclusos_benef,
	null			qt_total_alteracoes,
	null			qt_total_transferencia,
	null			qt_total_r105,
	null			qt_total_r106,
	null			qt_total_r107,
	null			qt_total_r108,
	null			dt_postagem,
	null			nr_protocolo,
	null			nr_seq_plano,
	null			nr_seq_segurado,
	a.nr_sequencia		nr_seq_empresa,
	1			nr_seq_benef
from	ptu_intercambio_empresa	a

union all

select	b.nr_seq_intercambio	nr_seq_intercabio,
	3			tp_registro,
	3			nr_sequencia,
	'103'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			ie_tipo_mov,
	null			dt_mov_inicio,
	null			dt_mov_fim,
	null			nr_versao_transacao,
	b.cd_filial			cd_filial,
	null			nm_empr_comp,
	null			nm_empr_abrev,
	' '			ds_reservado,
	null			cd_cgc_cpf,
	null			nr_insc_estadual,
	null			ds_endereco,
	null			ds_complemento,
	null			ds_bairro,
	null			cd_cep,
	null			nm_cidade,
	null			sg_uf,
	null			nr_ddd,
	null			dt_inclusao,
	null			dt_exclusao,
	null			cd_empresa_origem,
	null			cd_municipio_ibge,
	null			nr_telefone,
	null			nr_fax,
	null			nr_endereco_empresa,
	lpad(a.cd_plano_origem,6,'0') cd_plano_origem,
	a.ds_plano_origem		ds_plano_origem,
	a.cd_plano_intercambio	cd_plano_intercambio,
	a.dt_inclusao		dt_inclusao_plano,
	a.dt_exclusao		dt_exclusao_plano,
	a.ie_natureza		ie_natureza,
	a.ie_abrangencia		ie_abrangencia,
	a.nr_ind_reembolso		nr_ind_reembolso,
	a.cd_ope_ans		cd_ope_ans,
	a.cd_prod_ans		cd_prod_ans,
	a.ie_plano		ie_plano,
	null			cd_unimed,
	null			cd_usuario_plano,
	null			cd_familia,
	null			nm_benef_abreviado,
	null			cd_plano_intercambio_benef,
	null			dt_nascimento,
	null			ie_sexo,
	null			cd_cgc_cpf_benef,
	null			nr_rg,
	null			sg_uf_rg,
	null			ie_estado_civil,
	null			dt_inclusao_benef,
	null			dt_exclusao_benef,
	null			ie_repasse,
	null			cd_dependencia,
	null			ie_recem_nascido,
	null			nr_matricula,
	null			dt_validade_carteira,
	null			cd_local_atendimento,
	null			cd_lotacao,
	null			ds_lotacao,
	null			dt_repasse,
	null			dt_fim_repasse,
	null			dt_inclusao_plano_dest,
	null			cd_plano_origem_benef,
	null			nr_vigencia_origem,
	null			cd_titular_plano,
	null			nm_beneficiario,
	null			nr_cartao_nac_sus,
	null			nm_mae_benef,
	null			nr_pis_pasep,
	null			cd_tipo_cobertura,
	null			dt_fim_carencia,
	null			cd_tipo_produto,
	null			ds_produto,
	null			ds_endereco_benef,
	null			ds_bairro_benef,
	null			cd_cep_benef,
	null			nm_municipio,
	null			sg_uf_benef,
	null			nr_ddd_benef,
	null			nr_ramal,
	null			nr_fone,
	null			nr_endereco,
	null			cd_cid,
	null			dt_fim_carencia_preex,
	null			qt_total_r102,
	null			qt_total_r103,
	null			qt_total_r104,
	null			qt_total_inclusao,
	null			qt_exclusos_benef,
	null			qt_total_alteracoes,
	null			qt_total_transferencia,
	null			qt_total_r105,
	null			qt_total_r106,
	null			qt_total_r107,
	null			qt_total_r108,
	null			dt_postagem,
	null			nr_protocolo,
	a.nr_seq_plano		nr_seq_plano,
	null			nr_seq_segurado,
	b.nr_sequencia		nr_seq_empresa,
	2			nr_seq_benef
from	ptu_intercambio_empresa	b,
	ptu_intercambio_plano	a
where	a.nr_seq_empresa		= b.nr_sequencia

union  all

select	b.nr_seq_intercambio	nr_seq_intercabio,
	4			tp_registro,
	4			nr_sequencia,
	'104'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			ie_tipo_mov,
	null			dt_mov_inicio,
	null			dt_mov_fim,
	null			nr_versao_transacao,
	b.cd_filial			cd_filial,
	null			nm_empr_comp,
	null			nm_empr_abrev,
	' '			ds_reservado,
	null			cd_cgc_cpf,
	null			nr_insc_estadual,
	null			ds_endereco,
	null			ds_complemento,
	null			ds_bairro,
	null			cd_cep,
	null			nm_cidade,
	null			sg_uf,
	null			nr_ddd,
	null			dt_inclusao,
	null			dt_exclusao,
	null			cd_empresa_origem,
	null			cd_municipio_ibge,
	null			nr_telefone,
	null			nr_fax,
	null			nr_endereco_empresa,
	null			cd_plano_origem,
	null			ds_plano_origem,
	null			cd_plano_intercambio,
	null			dt_inclusao_plano,
	null			dt_exclusao_plano,
	null			ie_natureza,
	null			ie_abrangencia,
	null			nr_ind_reembolso,
	null			cd_ope_ans,
	null			cd_prod_ans,
	null			ie_plano,
	a.cd_unimed		cd_unimed,
	a.cd_usuario_plano		cd_usuario_plano,
	a.cd_familia		cd_familia,
	a.nm_benef_abreviado	nm_benef_abreviado,
	a.cd_plano_intercambio	cd_plano_intercambio_benef,
	a.dt_nascimento		dt_nascimento,
	a.ie_sexo			ie_sexo,
	a.cd_cgc_cpf cd_cgc_cpf_benef,	--checar
	a.nr_rg			nr_rg,
	a.sg_uf_rg		sg_uf_rg,
	a.ie_estado_civil		ie_estado_civil,
	a.dt_inclusao		dt_inclusao_benef,
	a.dt_exclusao		dt_exclusao_benef,
	a.ie_repasse		ie_repasse,
	a.cd_dependencia		cd_dependencia,
	a.ie_recem_nascido	ie_recem_nascido,
	a.nr_matricula		nr_matricula,
	a.dt_validade_carteira	dt_validade_carteira,
	a.cd_local_atendimento	cd_local_atendimento,
	a.cd_lotacao		cd_lotacao,
	a.ds_lotacao		ds_lotacao,
	a.dt_repasse		dt_repasse,
	a.dt_fim_repasse		dt_fim_repasse,
	a.dt_inclusao_plano_dest	dt_inclusao_plano_dest,
	a.cd_plano_origem		cd_plano_origem_benef,
	a.nr_vigencia_origem	nr_vigencia_origem,
	a.cd_titular_plano		cd_titular_plano,
	a.nm_beneficiario		nm_beneficiario,
	a.nr_cartao_nac_sus	nr_cartao_nac_sus,
	a.nm_mae_benef		nm_mae_benef,
	a.nr_pis_pasep		nr_pis_pasep,
	null			cd_tipo_cobertura,
	null			dt_fim_carencia,
	null			cd_tipo_produto,
	null			ds_produto,
	null			ds_endereco_benef,
	null			ds_bairro_benef,
	null			cd_cep_benef,
	null			nm_municipio,
	null			sg_uf_benef,
	null			nr_ddd_benef,
	null			nr_ramal,
	null			nr_fone,
	null			nr_endereco,
	null			cd_cid,
	null			dt_fim_carencia_preex,
	null			qt_total_r102,
	null			qt_total_r103,
	null			qt_total_r104,
	null			qt_total_inclusao,
	null			qt_exclusos_benef,
	null			qt_total_alteracoes,
	null			qt_total_transferencia,
	null			qt_total_r105,
	null			qt_total_r106,
	null			qt_total_r107,
	null			qt_total_r108,
	null			dt_postagem,
	null			nr_protocolo,
	null			nr_seq_plano,
	nr_seq_segurado		nr_seq_segurado,
	b.nr_sequencia		nr_seq_empresa,
	a.nr_sequencia		nr_seq_benef
from	ptu_intercambio_empresa	b,
	ptu_intercambio_benef	a
where	a.nr_seq_empresa		= b.nr_sequencia

union all

select	b.nr_seq_intercambio	nr_seq_intercabio,
	5			tp_registro,
	5			nr_sequencia,
	'105'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			ie_tipo_mov,
	null			dt_mov_inicio,
	null			dt_mov_fim,
	null			nr_versao_transacao,
	b.cd_filial			cd_filial,
	null			nm_empr_comp,
	null			nm_empr_abrev,
	' '			ds_reservado,
	null			cd_cgc_cpf,
	null			nr_insc_estadual,
	null			ds_endereco,
	null			ds_complemento,
	null			ds_bairro,
	null			cd_cep,
	null			nm_cidade,
	null			sg_uf,
	null			nr_ddd,
	null			dt_inclusao,
	null			dt_exclusao,
	null			cd_empresa_origem,
	null			cd_municipio_ibge,
	null			nr_telefone,
	null			nr_fax,
	null			nr_endereco_empresa,
	null			cd_plano_origem,
	null			ds_plano_origem,
	null			cd_plano_intercambio,
	null			dt_inclusao_plano,
	null			dt_exclusao_plano,
	null			ie_natureza,
	null			ie_abrangencia,
	null			nr_ind_reembolso,
	null			cd_ope_ans,
	null			cd_prod_ans,
	null			ie_plano,
	null			cd_unimed,
	null			cd_usuario_plano,
	null			cd_familia,
	null			nm_benef_abreviado,
	null			cd_plano_intercambio_benef,
	null			dt_nascimento,
	null			ie_sexo,
	null			cd_cgc_cpf_benef,
	null			nr_rg,
	null			sg_uf_rg,
	null			ie_estado_civil,
	null			dt_inclusao_benef,
	null			dt_exclusao_benef,
	null			ie_repasse,
	null			cd_dependencia,
	null			ie_recem_nascido,
	null			nr_matricula,
	null			dt_validade_carteira,
	null			cd_local_atendimento,
	null			cd_lotacao,
	null			ds_lotacao,
	null			dt_repasse,
	null			dt_fim_repasse,
	null			dt_inclusao_plano_dest,
	null			cd_plano_origem_benef,
	null			nr_vigencia_origem,
	null			cd_titular_plano,
	null			nm_beneficiario,
	null			nr_cartao_nac_sus,
	null			nm_mae_benef,
	null			nr_pis_pasep,
	a.cd_tipo_cobertura		cd_tipo_cobertura,
	a.dt_fim_carencia		dt_fim_carencia,
	null			cd_tipo_produto,
	null			ds_produto,
	null			ds_endereco_benef,
	null			ds_bairro_benef,
	null			cd_cep_benef,
	null			nm_municipio,
	null			sg_uf_benef,
	null			nr_ddd_benef,
	null			nr_ramal,
	null			nr_fone,
	null			nr_endereco,
	null			cd_cid,
	null			dt_fim_carencia_preex,
	null			qt_total_r102,
	null			qt_total_r103,
	null			qt_total_r104,
	null			qt_total_inclusao,
	null			qt_exclusos_benef,
	null			qt_total_alteracoes,
	null			qt_total_transferencia,
	null			qt_total_r105,
	null			qt_total_r106,
	null			qt_total_r107,
	null			qt_total_r108,
	null			dt_postagem,
	null			nr_protocolo,
	null			nr_seq_plano,
	null			nr_seq_segurado,
	b.nr_sequencia		nr_seq_empresa,
	c.nr_sequencia		nr_seq_benef
from	ptu_intercambio_benef	c,
	ptu_intercambio_empresa	b,
	ptu_beneficiario_carencia a
where	c.nr_seq_empresa	= b.nr_sequencia
and	a.nr_seq_beneficiario	= c.nr_sequencia

union all

select	b.nr_seq_intercambio	nr_seq_intercabio,
	6			tp_registro,
	6			nr_sequencia,
	'106'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			ie_tipo_mov,
	null			dt_mov_inicio,
	null			dt_mov_fim,
	null			nr_versao_transacao,
	b.cd_filial			cd_filial,
	null			nm_empr_comp,
	null			nm_empr_abrev,
	' '			ds_reservado,
	null			cd_cgc_cpf,
	null			nr_insc_estadual,
	null			ds_endereco,
	null			ds_complemento,
	null			ds_bairro,
	null			cd_cep,
	null			nm_cidade,
	null			sg_uf,
	null			nr_ddd,
	null			dt_inclusao,
	null			dt_exclusao,
	null			cd_empresa_origem,
	null			cd_municipio_ibge,
	null			nr_telefone,
	null			nr_fax,
	null			nr_endereco_empresa,
	null			cd_plano_origem,
	null			ds_plano_origem,
	null			cd_plano_intercambio,
	null			dt_inclusao_plano,
	null			dt_exclusao_plano,
	null			ie_natureza,
	null			ie_abrangencia,
	null			nr_ind_reembolso,
	null			cd_ope_ans,
	null			cd_prod_ans,
	null			ie_plano,
	null			cd_unimed,
	null			cd_usuario_plano,
	null			cd_familia,
	null			nm_benef_abreviado,
	null			cd_plano_intercambio_benef,
	null			dt_nascimento,
	null			ie_sexo,
	null			cd_cgc_cpf_benef,
	null			nr_rg,
	null			sg_uf_rg,
	null			ie_estado_civil,
	null			dt_inclusao_benef,
	null			dt_exclusao_benef,
	null			ie_repasse,
	null			cd_dependencia,
	null			ie_recem_nascido,
	null			nr_matricula,
	null			dt_validade_carteira,
	null			cd_local_atendimento,
	null			cd_lotacao,
	null			ds_lotacao,
	null			dt_repasse,
	null			dt_fim_repasse,
	null			dt_inclusao_plano_dest,
	null			cd_plano_origem_benef,
	null			nr_vigencia_origem,
	null			cd_titular_plano,
	null			nm_beneficiario,
	null			nr_cartao_nac_sus,
	null			nm_mae_benef,
	null			nr_pis_pasep,
	null			cd_tipo_cobertura,
	null			dt_fim_carencia,
	a.cd_tipo_produto		cd_tipo_produto,
	a.ds_produto		ds_produto,
	null			ds_endereco_benef,
	null			ds_bairro_benef,
	null			cd_cep_benef,
	null			nm_municipio,
	null			sg_uf_benef,
	null			nr_ddd_benef,
	null			nr_ramal,
	null			nr_fone,
	null			nr_endereco,
	null			cd_cid,
	null			dt_fim_carencia_preex,
	null			qt_total_r102,
	null			qt_total_r103,
	null			qt_total_r104,
	null			qt_total_inclusao,
	null			qt_exclusos_benef,
	null			qt_total_alteracoes,
	null			qt_total_transferencia,
	null			qt_total_r105,
	null			qt_total_r106,
	null			qt_total_r107,
	null			qt_total_r108,
	null			dt_postagem,
	null			nr_protocolo,
	null			nr_seq_plano,
	null			nr_seq_segurado,
	b.nr_sequencia		nr_seq_empresa,
	c.nr_sequencia		nr_seq_benef
from	ptu_intercambio_benef	c,
	ptu_intercambio_empresa	b,
	ptu_benef_plano_agregado a
where	c.nr_seq_empresa	= b.nr_sequencia
and	a.nr_seq_beneficiario	= c.nr_sequencia

union all

select	b.nr_seq_intercambio	nr_seq_intercabio,
	7			tp_registro,
	7			nr_sequencia,
	'107'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			ie_tipo_mov,
	null			dt_mov_inicio,
	null			dt_mov_fim,
	null			nr_versao_transacao,
	b.cd_filial			cd_filial,
	null			nm_empr_comp,
	null			nm_empr_abrev,
	' '			ds_reservado,
	null			cd_cgc_cpf,
	null			nr_insc_estadual,
	null			ds_endereco,
	null			ds_complemento,
	null			ds_bairro,
	null			cd_cep,
	null			nm_cidade,
	null			sg_uf,
	null			nr_ddd,
	null			dt_inclusao,
	null			dt_exclusao,
	null			cd_empresa_origem,
	null			cd_municipio_ibge,
	null			nr_telefone,
	null			nr_fax,
	null			nr_endereco_empresa,
	null			cd_plano_origem,
	null			ds_plano_origem,
	null			cd_plano_intercambio,
	null			dt_inclusao_plano,
	null			dt_exclusao_plano,
	null			ie_natureza,
	null			ie_abrangencia,
	null			nr_ind_reembolso,
	null			cd_ope_ans,
	null			cd_prod_ans,
	null			ie_plano,
	null			cd_unimed,
	null			cd_usuario_plano,
	null			cd_familia,
	null			nm_benef_abreviado,
	null			cd_plano_intercambio_benef,
	null			dt_nascimento,
	null			ie_sexo,
	null			cd_cgc_cpf_benef,
	null			nr_rg,
	null			sg_uf_rg,
	null			ie_estado_civil,
	null			dt_inclusao_benef,
	null			dt_exclusao_benef,
	null			ie_repasse,
	null			cd_dependencia,
	null			ie_recem_nascido,
	null			nr_matricula,
	null			dt_validade_carteira,
	null			cd_local_atendimento,
	null			cd_lotacao,
	null			ds_lotacao,
	null			dt_repasse,
	null			dt_fim_repasse,
	null			dt_inclusao_plano_dest,
	null			cd_plano_origem_benef,
	null			nr_vigencia_origem,
	null			cd_titular_plano,
	null			nm_beneficiario,
	null			nr_cartao_nac_sus,
	null			nm_mae_benef,
	null			nr_pis_pasep,
	null			cd_tipo_cobertura,
	null			dt_fim_carencia,
	null			cd_tipo_produto,
	null			ds_produto,
	a.ds_endereco		ds_endereco_benef,
	a.ds_bairro		ds_bairro_benef,
	a.cd_cep			cd_cep_benef,
	a.nm_municipio		nm_municipio,
	a.sg_uf			sg_uf_benef,
	a.nr_ddd			nr_ddd_benef,
	a.nr_ramal		nr_ramal,
	a.nr_fone			nr_fone,
	a.nr_endereco		nr_endereco,
	null			cd_cid,
	null			dt_fim_carencia_preex,
	null			qt_total_r102,
	null			qt_total_r103,
	null			qt_total_r104,
	null			qt_total_inclusao,
	null			qt_exclusos_benef,
	null			qt_total_alteracoes,
	null			qt_total_transferencia,
	null			qt_total_r105,
	null			qt_total_r106,
	null			qt_total_r107,
	null			qt_total_r108,
	null			dt_postagem,
	null			nr_protocolo,
	null			nr_seq_plano,
	null			nr_seq_segurado,
	b.nr_sequencia		nr_seq_empresa,
	c.nr_sequencia		nr_seq_benef
from	ptu_intercambio_benef	c,
	ptu_intercambio_empresa	b,
	ptu_beneficiario_compl	a
where	c.nr_seq_empresa		= b.nr_sequencia
and	a.nr_seq_beneficiario	= c.nr_sequencia

union all

select	b.nr_seq_intercambio	nr_seq_intercabio,
	8			tp_registro,
	8			nr_sequencia,
	'108'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			ie_tipo_mov,
	null			dt_mov_inicio,
	null			dt_mov_fim,
	null			nr_versao_transacao,
	b.cd_filial			cd_filial,
	null			nm_empr_comp,
	null			nm_empr_abrev,
	' '			ds_reservado,
	null			cd_cgc_cpf,
	null			nr_insc_estadual,
	null			ds_endereco,
	null			ds_complemento,
	null			ds_bairro,
	null			cd_cep,
	null			nm_cidade,
	null			sg_uf,
	null			nr_ddd,
	null			dt_inclusao,
	null			dt_exclusao,
	null			cd_empresa_origem,
	null			cd_municipio_ibge,
	null			nr_telefone,
	null			nr_fax,
	null			nr_endereco_empresa,
	null			cd_plano_origem,
	null			ds_plano_origem,
	null			cd_plano_intercambio,
	null			dt_inclusao_plano,
	null			dt_exclusao_plano,
	null			ie_natureza,
	null			ie_abrangencia,
	null			nr_ind_reembolso,
	null			cd_ope_ans,
	null			cd_prod_ans,
	null			ie_plano,
	null			cd_unimed,
	null			cd_usuario_plano,
	null			cd_familia,
	null			nm_benef_abreviado,
	null			cd_plano_intercambio_benef,
	null			dt_nascimento,
	null			ie_sexo,
	null			cd_cgc_cpf_benef,
	null			nr_rg,
	null			sg_uf_rg,
	null			ie_estado_civil,
	null			dt_inclusao_benef,
	null			dt_exclusao_benef,
	null			ie_repasse,
	null			cd_dependencia,
	null			ie_recem_nascido,
	null			nr_matricula,
	null			dt_validade_carteira,
	null			cd_local_atendimento,
	null			cd_lotacao,
	null			ds_lotacao,
	null			dt_repasse,
	null			dt_fim_repasse,
	null			dt_inclusao_plano_dest,
	null			cd_plano_origem_benef,
	null			nr_vigencia_origem,
	null			cd_titular_plano,
	null			nm_beneficiario,
	null			nr_cartao_nac_sus,
	null			nm_mae_benef,
	null			nr_pis_pasep,
	null			cd_tipo_cobertura,
	null			dt_fim_carencia,
	null			cd_tipo_produto,
	null			ds_produto,
	null			ds_endereco_benef,
	null			ds_bairro_benef,
	null			cd_cep_benef,
	null			nm_municipio,
	null			sg_uf_benef,
	null			nr_ddd_benef,
	null			nr_ramal,
	null			nr_fone,
	null			nr_endereco,
	a.cd_cid			cd_cid,
	a.dt_fim_carencia		dt_fim_carencia_preex,
	null			qt_total_r102,
	null			qt_total_r103,
	null			qt_total_r104,
	null			qt_total_inclusao,
	null			qt_exclusos_benef,
	null			qt_total_alteracoes,
	null			qt_total_transferencia,
	null			qt_total_r105,
	null			qt_total_r106,
	null			qt_total_r107,
	null			qt_total_r108,
	null			dt_postagem,
	null			nr_protocolo,
	null			nr_seq_plano,
	null			nr_seq_segurado,
	b.nr_sequencia		nr_seq_empresa,
	c.nr_sequencia		nr_seq_benef
from	ptu_intercambio_benef	c,
	ptu_intercambio_empresa	b,
	ptu_benef_preexistencia 	a
where	c.nr_seq_empresa		= b.nr_sequencia
and	a.nr_seq_beneficiario	= c.nr_sequencia

union all

select	nr_sequencia		nr_seq_intercabio,
	9			tp_registro,
	9			nr_sequencia,
	'109'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			ie_tipo_mov,
	null			dt_mov_inicio,
	null			dt_mov_fim,
	null			nr_versao_transacao,
	99999			cd_filial,
	null			nm_empr_comp,
	null			nm_empr_abrev,
	' '			ds_reservado,
	null			cd_cgc_cpf,
	null			nr_insc_estadual,
	null			ds_endereco,
	null			ds_complemento,
	null			ds_bairro,
	null			cd_cep,
	null			nm_cidade,
	null			sg_uf,
	null			nr_ddd,
	null			dt_inclusao,
	null			dt_exclusao,
	null			cd_empresa_origem,
	null			cd_municipio_ibge,
	null			nr_telefone,
	null			nr_fax,
	null			nr_endereco_empresa,
	null			cd_plano_origem,
	null			ds_plano_origem,
	null			cd_plano_intercambio,
	null			dt_inclusao_plano,
	null			dt_exclusao_plano,
	null			ie_natureza,
	null			ie_abrangencia,
	null			nr_ind_reembolso,
	null			cd_ope_ans,
	null			cd_prod_ans,
	null			ie_plano,
	null			cd_unimed,
	null			cd_usuario_plano,
	null			cd_familia,
	null			nm_benef_abreviado,
	null			cd_plano_intercambio_benef,
	null			dt_nascimento,
	null			ie_sexo,
	null			cd_cgc_cpf_benef,
	null			nr_rg,
	null			sg_uf_rg,
	null			ie_estado_civil,
	null			dt_inclusao_benef,
	null			dt_exclusao_benef,
	null			ie_repasse,
	null			cd_dependencia,
	null			ie_recem_nascido,
	null			nr_matricula,
	null			dt_validade_carteira,
	null			cd_local_atendimento,
	null			cd_lotacao,
	null			ds_lotacao,
	null			dt_repasse,
	null			dt_fim_repasse,
	null			dt_inclusao_plano_dest,
	null			cd_plano_origem_benef,
	null			nr_vigencia_origem,
	null			cd_titular_plano,
	null			nm_beneficiario,
	null			nr_cartao_nac_sus,
	null			nm_mae_benef,
	null			nr_pis_pasep,
	null			cd_tipo_cobertura,
	null			dt_fim_carencia,
	null			cd_tipo_produto,
	null			ds_produto,
	null			ds_endereco_benef,
	null			ds_bairro_benef,
	null			cd_cep_benef,
	null			nm_municipio,
	null			sg_uf_benef,
	null			nr_ddd_benef,
	null			nr_ramal,
	null			nr_fone,
	null			nr_endereco,
	null			cd_cid,
	null			dt_fim_carencia_preex,
	substr(obter_quantidade_registro_ptu(nr_sequencia,'102'),1,4)		qt_total_r102,
	substr(obter_quantidade_registro_ptu(nr_sequencia,'103'),1,4)		qt_total_r103,
	substr(obter_quantidade_registro_ptu(nr_sequencia,'104'),1,7)		qt_total_r104,
	substr(obter_quantidade_registro_ptu(nr_sequencia,'QT_INCLUSAO'),1,7)	qt_total_inclusao,
	substr(obter_quantidade_registro_ptu(nr_sequencia,'QT_EXCLUSAO'),1,7)	qt_exclusos_benef,
	0			qt_total_alteracoes,
	0			qt_total_transferencia,
	substr(obter_quantidade_registro_ptu(nr_sequencia,'105'),1,7)		qt_total_r105,
	substr(obter_quantidade_registro_ptu(nr_sequencia,'106'),1,7)		qt_total_r106,
	substr(obter_quantidade_registro_ptu(nr_sequencia,'107'),1,7)		qt_total_r107,
	substr(obter_quantidade_registro_ptu(nr_sequencia,'108'),1,7)		qt_total_r108,
	null			dt_postagem,
	null			nr_protocolo,
	null			nr_seq_plano,
	null			nr_seq_segurado,
	99999999999999		nr_seq_empresa,
	99999999999999		nr_seq_benef
from	ptu_intercambio

union all

select	nr_sequencia		nr_seq_intercabio,
	10			tp_registro,
	10			nr_sequencia,
	'110'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			ie_tipo_mov,
	null			dt_mov_inicio,
	null			dt_mov_fim,
	null			nr_versao_transacao,
	99999			cd_filial,
	null			nm_empr_comp,
	null			nm_empr_abrev,
	' '			ds_reservado,
	null			cd_cgc_cpf,
	null			nr_insc_estadual,
	null			ds_endereco,
	null			ds_complemento,
	null			ds_bairro,
	null			cd_cep,
	null			nm_cidade,
	null			sg_uf,
	null			nr_ddd,
	null			dt_inclusao,
	null			dt_exclusao,
	null			cd_empresa_origem,
	null			cd_municipio_ibge,
	null			nr_telefone,
	null			nr_fax,
	null			nr_endereco_empresa,
	null			cd_plano_origem,
	null			ds_plano_origem,
	null			cd_plano_intercambio,
	null			dt_inclusao_plano,
	null			dt_exclusao_plano,
	null			ie_natureza,
	null			ie_abrangencia,
	null			nr_ind_reembolso,
	null			cd_ope_ans,
	null			cd_prod_ans,
	null			ie_plano,
	null			cd_unimed,
	null			cd_usuario_plano,
	null			cd_familia,
	null			nm_benef_abreviado,
	null			cd_plano_intercambio_benef,
	null			dt_nascimento,
	null			ie_sexo,
	null			cd_cgc_cpf_benef,
	null			nr_rg,
	null			sg_uf_rg,
	null			ie_estado_civil,
	null			dt_inclusao_benef,
	null			dt_exclusao_benef,
	null			ie_repasse,
	null			cd_dependencia,
	null			ie_recem_nascido,
	null			nr_matricula,
	null			dt_validade_carteira,
	null			cd_local_atendimento,
	null			cd_lotacao,
	null			ds_lotacao,
	null			dt_repasse,
	null			dt_fim_repasse,
	null			dt_inclusao_plano_dest,
	null			cd_plano_origem_benef,
	null			nr_vigencia_origem,
	null			cd_titular_plano,
	null			nm_beneficiario,
	null			nr_cartao_nac_sus,
	null			nm_mae_benef,
	null			nr_pis_pasep,
	null			cd_tipo_cobertura,
	null			dt_fim_carencia,
	null			cd_tipo_produto,
	null			ds_produto,
	null			ds_endereco_benef,
	null			ds_bairro_benef,
	null			cd_cep_benef,
	null			nm_municipio,
	null			sg_uf_benef,
	null			nr_ddd_benef,
	null			nr_ramal,
	null			nr_fone,
	null			nr_endereco,
	null			cd_cid,
	null			dt_fim_carencia_preex,
	null			qt_total_r102,
	null			qt_total_r103,
	null			qt_total_r104,
	null			qt_total_inclusao,
	null			qt_exclusos_benef,
	null			qt_total_alteracoes,
	null			qt_total_transferencia,
	null			qt_total_r105,
	null			qt_total_r106,
	null			qt_total_r107,
	null			qt_total_r108,
	LOCALTIMESTAMP			dt_postagem,
	0			nr_protocolo,
	null			nr_seq_plano,
	null			nr_seq_segurado,
	0			nr_seq_empresa,
	0			nr_seq_benef
from	ptu_intercambio;

