-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW valores_atend_paciente_v (dt_entrada, nr_atendimento, cd_setor_atendimento, tipo, dt_conta, codigo, quantidade, valor, medico, anestesista, filme, auxiliares, ctoope, vl_procedimento, vl_material, dt_acerto_conta, nr_interno_conta, dt_acerto_convenio, cd_convenio, cd_categoria, nr_doc_convenio, cd_medico, cobra_pf_pj, cd_acao, cd_motivo_exc_conta, dt_execucao, codigo_ref, cd_conta_contabil, nr_lote_contabil, nr_sequencia, nr_seq_proc_pacote, ie_origem_proced, nr_seq_proc_interno, nr_seq_exame) AS select 	to_date(to_char(dt_entrada_unidade, 'dd/mm/yyyy'),'dd/mm/yyyy') dt_entrada,
	nr_atendimento,
	cd_setor_atendimento,
	1 tipo,
	dt_conta,
	cd_procedimento codigo,
	qt_procedimento quantidade,
	vl_procedimento valor,
	vl_medico medico,
	vl_anestesista anestesista,
	vl_materiais filme,
	vl_auxiliares auxiliares,
	vl_custo_operacional ctoope,
	vl_procedimento,
	0 vl_material,
	dt_acerto_conta,
	nr_interno_conta,
	dt_acerto_convenio,
	cd_convenio,
	cd_categoria,
	nr_doc_convenio,
	cd_medico_executor cd_medico,
	ie_cobra_pf_pj cobra_pf_pj,
	cd_acao,
	cd_motivo_exc_conta,
	dt_procedimento dt_execucao,
	cd_procedimento codigo_ref,
	cd_conta_contabil,
	nr_lote_contabil,
	nr_sequencia,
	nr_seq_proc_pacote,
	ie_origem_proced,
	nr_seq_proc_interno,
	nr_seq_exame
FROM 	procedimento_paciente

union all

select	to_date(to_char(dt_entrada_unidade, 'dd/mm/yyyy'),'dd/mm/yyyy') dt_entrada,
	nr_atendimento,
	cd_setor_atendimento,
	2 tipo,
	dt_conta,
	cd_material codigo,
	qt_material quantidade,
	vl_material valor,
	0 medico,
	0 anestesista,
	0 filme,
	0 auxiliares,
	0 ctoope,
	0 vl_procedimento,
	vl_material,
	dt_acerto_conta,
	nr_interno_conta,
	dt_acerto_convenio,
	cd_convenio,
	cd_categoria,
	nr_doc_convenio,
	null cd_medico,
	null cobra_pf_pj,
	cd_acao,
	cd_motivo_exc_conta,
	dt_atendimento dt_execucao,
	cd_proced_referencia codigo_ref,
	cd_conta_contabil,
	nr_lote_contabil,
	nr_sequencia,
	nr_seq_proc_pacote,
	null,
	null,
	null
from   material_atend_paciente;

