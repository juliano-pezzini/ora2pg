-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW movimento_estoque_valor_v1 (nr_movimento_estoque, vl_movimento) AS select /*+ ORDERED */       a.nr_movimento_estoque,
       sum(CASE WHEN b.ie_aumenta_diminui_valor='D' THEN (a.vl_movimento * -1)  ELSE a.vl_movimento END ) vl_movimento
FROM movimento_estoque_valor a,
     tipo_valor b
where a.cd_tipo_valor          = b.cd_tipo_valor
group by nr_movimento_estoque;

