-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW bft_encounter_diagnosis_v (nr_atendimento, encounter_id, icd_code, icd_description, diagnosis_date, diagnosis_classif_code, diagnosis_classif_desc, diagnosis_type_code, diagnosis_type_desc, release_date) AS select	a.nr_atendimento,
	a.nr_atendimento encounter_id,
	a.cd_doenca icd_code,
	b.DS_DOENCA_CID icd_description,
	a.dt_diagnostico diagnosis_date,
	a.IE_CLASSIFICACAO_DOENCA diagnosis_classif_code,
	substr(obter_valor_dominio(58,a.IE_CLASSIFICACAO_DOENCA),1,255)  diagnosis_classif_desc,
	a.IE_TIPO_DIAGNOSTICO  diagnosis_type_code,
	substr(obter_valor_dominio(13,a.IE_TIPO_DIAGNOSTICO),1,255)  diagnosis_type_desc,
	a.dt_liberacao release_date
FROM	DIAGNOSTICO_DOENCA a,
	cid_doenca b
where	a.cd_doenca = b.CD_DOENCA_CID
and	a.dt_liberacao is not null
and	a.dt_inativacao is null;

