-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ctb_orc_empresarial_v (dt_referencia, cd_centro_custo, cd_conta_contabil, cd_estabelecimento, cd_empresa, vl_orcado, vl_realizado) AS select  b.dt_referencia,
        a.cd_centro_custo,
        a.cd_conta_contabil,
        a.cd_estabelecimento,
        b.cd_empresa,
        sum(a.vl_orcado) vl_orcado,
        sum(a.vl_realizado) vl_realizado
FROM    ctb_orcamento a,
        ctb_mes_ref b
where   a.nr_seq_mes_ref = b.nr_sequencia
group by b.dt_referencia, a.cd_conta_contabil, a.cd_centro_custo, a.cd_estabelecimento, b.cd_empresa

UNION ALL

select  b.dt_referencia,
        a.cd_centro_custo,
        a.cd_conta_contabil,
        a.cd_estabelecimento,
        b.cd_empresa,
        sum(a.vl_orcado),
        sum(a.vl_realizado)
from    ctb_mes_ref b,
        ctb_orcamento_capex a
where   a.nr_seq_mes_ref = b.nr_sequencia
group by b.dt_referencia, a.cd_centro_custo, a.cd_conta_contabil, a.cd_estabelecimento, b.cd_empresa
order by 1;

