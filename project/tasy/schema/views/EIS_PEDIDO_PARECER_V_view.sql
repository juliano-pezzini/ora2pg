-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_pedido_parecer_v (cd_medico_req, nm_medico_req, cd_medico_consultor, nm_medico_consultor, cd_pessoa_parecer, nm_medico_parecer, cd_especialidade_dest, ds_especialidade_dest, cd_especialidade, ds_especialidade_origem, dt_atualizacao, nr_parecer, nr_seq_equipe_dest, ds_equipe, nr_atendimento, ds_tipo_atendimento, ie_tipo_atendimento, ds_diferenca, cd_paciente, nm_paciente, cd_setor_atendimento, ds_setor_atendimento, cd_convenio, ds_convenio) AS SELECT 	a.cd_medico cd_medico_req,
	substr(obter_nome_pf(a.cd_medico),1,80) nm_medico_req, 
	b.cd_medico cd_medico_consultor, 
	substr(obter_nome_pf(b.cd_medico),1,80) nm_medico_consultor, 
	a.CD_PESSOA_PARECER, 
	substr(obter_nome_pf(a.CD_PESSOA_PARECER),1,80) nm_medico_parecer, 
	a.CD_ESPECIALIDADE_DEST, 
	SUBSTR(Obter_Desc_Espec_medica(a.CD_ESPECIALIDADE_DEST),1,100) DS_ESPECIALIDADE_DEST, 
	CD_ESPECIALIDADE, 
	SUBSTR(Obter_Desc_Espec_medica(CD_ESPECIALIDADE),1,100) DS_ESPECIALIDADE_ORIGEM, 
	a.dt_atualizacao, 
	a.nr_parecer, 
	nr_seq_equipe_dest, 
	substr(OBTER_DESC_PF_EQUIPE(nr_seq_equipe_dest),1,80) ds_equipe, 
	a.nr_atendimento, 
	substr(obter_valor_dominio(12,c.ie_tipo_atendimento),1,255) ds_tipo_atendimento, 
	c.ie_tipo_atendimento, 
	substr(obter_dif_data(a.dt_liberacao,b.dt_liberacao,''),1,50) ds_diferenca, 
	a.cd_pessoa_fisica cd_paciente, 
	SUBSTR(OBTER_NOME_PF(a.cd_pessoa_fisica),1,255) nm_paciente, 
	substr(obter_setor_atend_data(a.nr_atendimento, a.DT_ATUALIZACAO_NREC),1,50) cd_setor_atendimento, 
	substr(obter_nome_setor(obter_setor_atend_data(a.nr_atendimento, a.DT_ATUALIZACAO_NREC)),1,255) ds_setor_atendimento, 
	substr(obter_convenio_atendimento(a.nr_atendimento),1,50) cd_convenio, 
	substr(obter_nome_convenio(obter_convenio_atendimento(a.nr_atendimento)),1,50) ds_convenio 
FROM atendimento_paciente c, parecer_medico_req a
LEFT OUTER JOIN parecer_medico b ON (a.nr_parecer = b.nr_parecer)
WHERE a.nr_atendimento = c.nr_atendimento;

