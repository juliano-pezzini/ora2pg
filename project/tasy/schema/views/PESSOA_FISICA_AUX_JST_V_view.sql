-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pessoa_fisica_aux_jst_v (ie_evento_t, nr_sequencia_t, nr_sequencia_sup_t, dt_atualizacao_t, nm_usuario_t, nr_sequencia, dt_atualizacao, nm_usuario, dt_atualizacao_nrec, nm_usuario_nrec, nr_seq_motivo, cd_pessoa_fisica, cd_agente_saude, ie_control_ext, cd_corporativo, ie_motivo_sem_cpf) AS SELECT T.IE_EVENTO IE_EVENTO_T, T.NR_SEQUENCIA NR_SEQUENCIA_T, T.NR_SEQUENCIA_SUP NR_SEQUENCIA_SUP_T, T.DT_ATUALIZACAO DT_ATUALIZACAO_T, T.NM_USUARIO NM_USUARIO_T
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQUENCIA' THEN T.VL_CAMPO END) NR_SEQUENCIA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DT_ATUALIZACAO' THEN T.VL_CAMPO END) DT_ATUALIZACAO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NM_USUARIO' THEN T.VL_CAMPO END) NM_USUARIO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DT_ATUALIZACAO_NREC' THEN T.VL_CAMPO END) DT_ATUALIZACAO_NREC
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NM_USUARIO_NREC' THEN T.VL_CAMPO END) NM_USUARIO_NREC
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQ_MOTIVO' THEN T.VL_CAMPO END) NR_SEQ_MOTIVO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_PESSOA_FISICA' THEN T.VL_CAMPO END) CD_PESSOA_FISICA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_AGENTE_SAUDE' THEN T.VL_CAMPO END) CD_AGENTE_SAUDE
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_CONTROL_EXT' THEN T.VL_CAMPO END) IE_CONTROL_EXT
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_CORPORATIVO' THEN T.VL_CAMPO END) CD_CORPORATIVO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_MOTIVO_SEM_CPF' THEN T.VL_CAMPO END) IE_MOTIVO_SEM_CPF
  FROM JSON_SCHEMA_T T
 WHERE T.NM_TABELA = 'PESSOA_FISICA_AUX'
 GROUP BY T.IE_EVENTO, T.NM_TABELA, T.NR_SEQUENCIA, T.NR_SEQUENCIA_SUP, T.DT_ATUALIZACAO, T.NM_USUARIO;

