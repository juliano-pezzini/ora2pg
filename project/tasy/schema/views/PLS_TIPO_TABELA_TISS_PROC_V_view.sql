-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_tipo_tabela_tiss_proc_v (cd_procedimento, ie_origem_proced, cd_tabela, nr_prioridade, cd_estabelecimento, nr_seq_regra, nr_seq_regra_princ) AS select	a.cd_procedimento,
	a.ie_origem_proced,
	(select t.cd_tabela_xml
	FROM	tiss_tipo_tabela t
	where	t.nr_sequencia = r.nr_seq_tiss_tabela) cd_tabela,
	4 nr_prioridade,
	r.cd_estabelecimento,
	p.nr_sequencia nr_seq_regra,
	r.nr_sequencia nr_seq_regra_princ
from	pls_regra_tabela_tiss 	r,
	pls_regra_tab_tiss_proc	p,
	procedimento a
where	r.ie_situacao 		= 'A'
and	p.nr_seq_regra_tab_tiss	= r.nr_sequencia
and	p.ie_situacao 		= 'A'
and	p.ie_origem_proced	is not null
and	p.cd_procedimento	is not null
and	a.ie_origem_proced	= p.ie_origem_proced
and	a.cd_procedimento	= p.cd_procedimento

union all

select	a.cd_procedimento,
	a.ie_origem_proced,
	(select t.cd_tabela_xml
	from	tiss_tipo_tabela t
	where	t.nr_sequencia = r.nr_seq_tiss_tabela) cd_tabela,
	3 nr_prioridade,
	r.cd_estabelecimento,
	p.nr_sequencia nr_seq_regra,
	r.nr_sequencia nr_seq_regra_princ
from	pls_regra_tabela_tiss 	r,
	pls_regra_tab_tiss_proc	p,
	estrutura_procedimento_v a
where	r.ie_situacao 		= 'A'
and	p.nr_seq_regra_tab_tiss	= r.nr_sequencia
and	p.ie_situacao 		= 'A'
and	p.cd_grupo_proc is not null
and	p.cd_grupo_proc	  	= a.cd_grupo_proc

union all

select	a.cd_procedimento,
	a.ie_origem_proced,
	(select t.cd_tabela_xml
	from	tiss_tipo_tabela t
	where	t.nr_sequencia = r.nr_seq_tiss_tabela) cd_tabela,
	2 nr_prioridade,
	r.cd_estabelecimento,
	p.nr_sequencia nr_seq_regra,
	r.nr_sequencia nr_seq_regra_princ
from	pls_regra_tabela_tiss 	r,
	pls_regra_tab_tiss_proc	p,
	estrutura_procedimento_v a
where	r.ie_situacao 		= 'A'
and	p.nr_seq_regra_tab_tiss	= r.nr_sequencia
and	p.ie_situacao 		= 'A'
and	p.cd_especialidade	is not null
and	p.cd_especialidade	= a.cd_especialidade;

