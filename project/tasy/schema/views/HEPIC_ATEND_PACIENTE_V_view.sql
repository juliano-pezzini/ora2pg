-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW hepic_atend_paciente_v (nr_prontuario, nm_pessoa_fisica, dt_nascimento, ie_sexo, dt_atualizacao_paciente, ie_clinica, ds_valor_dominio, nr_atendimento, nr_cirurgia, dt_atualizacao_atendimento, ie_tipo_atendimento, dt_entrada, dt_alta, peso, altura, cd_medico_atendimento, cd_motivo_alta, cd_procedencia, ds_procedencia, ie_tipo_complemento, cd_cep, cd_municipio_ibge, ds_municipio, cd_tipo_logradouro, ds_bairro, ds_complemento, ds_endereco, nr_endereco, sg_estado, nr_seq_pais, nm_pais) AS Select 	distinct
		b.nr_prontuario,
		b.nm_pessoa_fisica,
		b.dt_nascimento,
		b.ie_sexo,
		b.dt_atualizacao dt_atualizacao_paciente,
		a.ie_clinica,
		i.ds_valor_dominio,
		a.nr_atendimento,
		d.nr_cirurgia,
		a.dt_atualizacao dt_atualizacao_atendimento,
		a.ie_tipo_atendimento,
		a.dt_entrada,
		a.dt_alta,
		0 peso,
	    0 altura,
		a.cd_medico_atendimento,
		a.cd_motivo_alta,
	    a.cd_procedencia,
		c.ds_procedencia,
		g.ie_tipo_complemento,
	    g.cd_cep,
		g.cd_municipio_ibge,
		g.ds_municipio,
	    g.cd_tipo_logradouro,
		g.ds_bairro,
		g.ds_complemento,
	    g.ds_endereco,
		g.nr_endereco,
		g.sg_estado,
		g.nr_seq_pais,
	    h.nm_pais
  FROM procedencia c, atendimento_paciente a
LEFT OUTER JOIN valor_dominio i ON (a.ie_clinica = i.vl_dominio)
LEFT OUTER JOIN cirurgia d ON (a.nr_atendimento = d.nr_atendimento)
, pessoa_fisica b
LEFT OUTER JOIN compl_pessoa_fisica g ON (b.cd_pessoa_fisica = g.cd_pessoa_fisica)
LEFT OUTER JOIN pais h ON (g.nr_seq_pais = h.nr_sequencia)
WHERE a.cd_pessoa_fisica = b.cd_pessoa_fisica AND c.cd_procedencia = a.cd_procedencia  AND i.cd_dominio = 17   AND a.ie_tipo_atendimento <> 8 AND (g.ie_tipo_complemento = 1 OR g.ie_tipo_complemento = 8);

