-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW titulo_pagar_baixa_cc_contab_v (nr_seq_baixa, nr_lote_contabil, nr_titulo, vl_transacao, nr_seq_conta_banco, nr_seq_trans_fin, ds_atributo, nr_bordero, nr_seq_escrit, cd_centro_custo, cd_conta_contabil, dt_baixa, nr_seq_movto_trans_fin, cd_tipo_baixa, nr_seq_baixa_cc, cd_moeda, nr_seq_baixa_origem) AS select 	a.nr_sequencia nr_seq_baixa,
	a.nr_lote_contabil,
	a.nr_titulo,
	coalesce(b.vl_baixa, a.vl_baixa) vl_transacao,
	a.nr_seq_conta_banco,
	a.nr_seq_trans_fin,
	'VL_BAIXA' ds_atributo,
	a.nr_bordero,
	a.nr_seq_escrit,
	b.cd_centro_custo,
	b.cd_conta_contabil,
	a.dt_baixa,
	a.nr_seq_movto_trans_fin,
	a.cd_tipo_baixa,
	b.nr_sequencia nr_seq_baixa_cc,
	a.cd_moeda,
	a.nr_seq_baixa_origem
FROM titulo_pagar_baixa a
LEFT OUTER JOIN titulo_pagar_baixa_cc b ON (a.nr_titulo = b.nr_titulo AND a.nr_sequencia = b.nr_Seq_baixa)
WHERE coalesce(b.vl_baixa, a.vl_baixa) <> 0

union all

select 	a.nr_sequencia nr_seq_baixa,
	a.nr_lote_contabil,
	a.nr_titulo,
	coalesce(b.vl_desconto, a.vl_descontos),
	a.nr_seq_conta_banco,
	a.nr_seq_trans_fin,
	'VL_DESCONTOS',
	a.nr_bordero,
	a.nr_seq_escrit,
	b.cd_centro_custo,
	b.cd_conta_contabil,
	a.dt_baixa,
	a.nr_seq_movto_trans_fin,
	a.cd_tipo_baixa,
	b.nr_sequencia nr_seq_baixa_cc,
	a.cd_moeda,
	a.nr_seq_baixa_origem
FROM titulo_pagar_baixa a
LEFT OUTER JOIN titulo_pagar_baixa_cc b ON (a.nr_titulo = b.nr_titulo AND a.nr_sequencia = b.nr_Seq_baixa)
WHERE coalesce(b.vl_desconto, a.vl_descontos) <> 0
 
union all

select	a.nr_sequencia nr_seq_baixa,
	a.nr_lote_contabil,
	a.nr_titulo,
	a.vl_outras_deducoes,
	a.nr_seq_conta_banco,
	a.nr_seq_trans_fin,
	'VL_OUTRAS_DEDUCOES',
	a.nr_bordero,
	a.nr_seq_escrit,
	a.cd_centro_custo,
	a.cd_conta_contabil,
	a.dt_baixa,
	a.nr_seq_movto_trans_fin,
	a.cd_tipo_baixa,
	null nr_seq_baixa_cc,
	a.cd_moeda,
	a.nr_seq_baixa_origem
from 	titulo_pagar_baixa a
where 	a.vl_outras_deducoes <> 0

union all

select	a.nr_sequencia nr_seq_baixa,
	a.nr_lote_contabil,
	a.nr_titulo,
	coalesce(b.vl_juros, a.vl_juros),
	a.nr_seq_conta_banco,
	a.nr_seq_trans_fin,
	'VL_JUROS',
	a.nr_bordero,
	a.nr_seq_escrit,
	b.cd_centro_custo,
	b.cd_conta_contabil,
	a.dt_baixa,
	a.nr_seq_movto_trans_fin,
	a.cd_tipo_baixa,
	b.nr_sequencia nr_seq_baixa_cc,
	a.cd_moeda,
	a.nr_seq_baixa_origem
FROM titulo_pagar_baixa a
LEFT OUTER JOIN titulo_pagar_baixa_cc b ON (a.nr_titulo = b.nr_titulo AND a.nr_sequencia = b.nr_Seq_baixa)
WHERE coalesce(b.vl_juros, a.vl_juros) <> 0
 
union all

select	a.nr_sequencia nr_seq_baixa,
	a.nr_lote_contabil,
	a.nr_titulo,
	coalesce(b.vl_multa, a.vl_multa),
	a.nr_seq_conta_banco,
	a.nr_seq_trans_fin,
	'VL_MULTA',
	a.nr_bordero,
	a.nr_seq_escrit,
	b.cd_centro_custo,
	b.cd_conta_contabil,
	a.dt_baixa,
	a.nr_seq_movto_trans_fin,
	a.cd_tipo_baixa,
	b.nr_sequencia nr_seq_baixa_cc,
	a.cd_moeda,
	a.nr_seq_baixa_origem
FROM titulo_pagar_baixa a
LEFT OUTER JOIN titulo_pagar_baixa_cc b ON (a.nr_titulo = b.nr_titulo AND a.nr_sequencia = b.nr_Seq_baixa)
WHERE coalesce(b.vl_multa, a.vl_multa) <> 0
 
union all

select	a.nr_sequencia nr_seq_baixa,
	a.nr_lote_contabil,
	a.nr_titulo,
	coalesce(b.vl_outros_acrescimos, a.vl_outros_acrescimos),
	a.nr_seq_conta_banco,
	a.nr_seq_trans_fin,
	'VL_OUTROS_ACRESCIMOS',
	a.nr_bordero,
	a.nr_seq_escrit,
	b.cd_centro_custo,
	b.cd_conta_contabil,
	a.dt_baixa,
	a.nr_seq_movto_trans_fin,
	a.cd_tipo_baixa,
	b.nr_sequencia nr_seq_baixa_cc,
	a.cd_moeda,
	a.nr_seq_baixa_origem
FROM titulo_pagar_baixa a
LEFT OUTER JOIN titulo_pagar_baixa_cc b ON (a.nr_titulo = b.nr_titulo AND a.nr_sequencia = b.nr_Seq_baixa)
WHERE coalesce(b.vl_outros_acrescimos, a.vl_outros_acrescimos) <> 0
 
union all

select	a.nr_sequencia nr_seq_baixa,
	a.nr_lote_contabil,
	a.nr_titulo,
	coalesce(b.vl_pago,a.vl_pago),
	a.nr_seq_conta_banco,
	a.nr_seq_trans_fin,
	'VL_PAGO',
	a.nr_bordero,
	a.nr_seq_escrit,
	b.cd_centro_custo,
	b.cd_conta_contabil,
	a.dt_baixa,
	a.nr_seq_movto_trans_fin,
	a.cd_tipo_baixa,
	b.nr_sequencia nr_seq_baixa_cc,
	a.cd_moeda,
	a.nr_seq_baixa_origem
FROM titulo_pagar_baixa a
LEFT OUTER JOIN titulo_pagar_baixa_cc b ON (a.nr_titulo = b.nr_titulo AND a.nr_sequencia = b.nr_seq_baixa)
WHERE coalesce(b.vl_pago, a.vl_pago) <> 0
 
union all

select	a.nr_sequencia nr_seq_baixa,
	a.nr_lote_contabil,
	a.nr_titulo,
	a.vl_inss,
	a.nr_seq_conta_banco,
	nr_seq_trans_fin,
	'VL_INSS',
	nr_bordero,
	nr_seq_escrit,
	cd_centro_custo,
	cd_conta_contabil,
	dt_baixa,
	nr_seq_movto_trans_fin,
	a.cd_tipo_baixa,
	null nr_seq_baixa_cc,
	a.cd_moeda,
	a.nr_seq_baixa_origem
from 	titulo_pagar_baixa a
where 	coalesce(a.vl_inss,0) <> 0

union all

select	a.nr_sequencia nr_seq_baixa,
	a.nr_lote_contabil,
	a.nr_titulo,
	a.vl_imposto_munic,
	a.nr_seq_conta_banco,
	a.nr_seq_trans_fin,
	'VL_IMPOSTO_MUNIC',
	nr_bordero,
	nr_seq_escrit,
	cd_centro_custo,
	cd_conta_contabil,
	dt_baixa,
	nr_seq_movto_trans_fin,
	a.cd_tipo_baixa,
	null nr_seq_baixa_cc,
	a.cd_moeda,
	a.nr_seq_baixa_origem
from 	titulo_pagar_baixa a
where 	coalesce(a.vl_imposto_munic,0) <> 0

union all

select	a.nr_sequencia nr_seq_baixa,
	a.nr_lote_contabil,
	a.nr_titulo,
	a.vl_imposto vl_transacao,
	a.nr_seq_conta_banco,
	nr_seq_trans_fin,
	'VL_IMPOSTO_BAIXA',
	nr_bordero,
	nr_seq_escrit,
	cd_centro_custo,
	cd_conta_contabil,
	dt_baixa,
	nr_seq_movto_trans_fin,
	a.cd_tipo_baixa,
	null nr_seq_baixa_cc,
	a.cd_moeda,
	a.nr_seq_baixa_origem
from 	titulo_pagar_baixa a
where 	coalesce(a.vl_imposto,0) <> 0;

