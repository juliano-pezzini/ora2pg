-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_movto_contab_faturamento_v (ie_status, nr_seq_conta_proc, nr_seq_conta_mat, cd_conta_credito, cd_conta_debito, cd_classif_cred, cd_classif_deb, nr_seq_esquema, nr_sequencia, nr_seq_item_mensalidade, nr_seq_conta_copartic, nr_seq_conta_pos_estab, nr_seq_atualizacao, nr_seq_ppsc_movimento, nr_seq_ppsc_mov_item, nr_seq_fatura_proc, nr_seq_fatura_mat, nr_seq_evento_movimento, nr_seq_pag_tributo, cd_conta_credito_ndc, cd_conta_debito_ndc, cd_classif_cred_ndc, cd_classif_deb_ndc, nr_seq_esquema_ndc, cd_conta_credito_dif, cd_conta_debito_dif, cd_classif_cred_dif, cd_classif_deb_dif, nr_seq_esquema_dif, nr_seq_pos_estab_contab, nr_seq_fat_item_trib) AS select	a.ie_status,
	a.nr_seq_conta_proc,
	a.nr_seq_conta_mat,
	b.cd_conta_credito,
	b.cd_conta_debito,
	b.cd_classif_cred,
	b.cd_classif_deb,
	b.nr_seq_esquema,
	a.nr_sequencia,
	a.nr_seq_item_mensalidade,
	a.nr_seq_conta_copartic,
	a.nr_seq_conta_pos_estab,
	a.nr_seq_atualizacao,
	a.nr_seq_ppsc_movimento,
	a.nr_seq_ppsc_mov_item,
	a.nr_seq_fatura_proc,
	a.nr_seq_fatura_mat,
	a.nr_seq_evento_movimento,
	a.nr_seq_pag_tributo,
	b.cd_conta_credito_ndc,
	b.cd_conta_debito_ndc,
	b.cd_classif_cred_ndc,
	b.cd_classif_deb_ndc,
	b.nr_seq_esquema_ndc,
	b.cd_conta_credito_dif,
	b.cd_conta_debito_dif,
	b.cd_classif_cred_dif,
	b.cd_classif_deb_dif,
	b.nr_seq_esquema_dif,
	a.nr_seq_pos_estab_contab,
	a.nr_seq_fat_item_trib
FROM	pls_movimento_contabil	a,
	pls_fatura_proc		b
where	a.nr_seq_fatura_proc	= b.nr_sequencia
and	not exists (	select 	1
			from	pls_conta 			c,
				pls_conta_pos_estabelecido 	p,
				pls_conta_pos_estab_contab 	e
			where	c.nr_sequencia 		= p.nr_seq_conta
			and	p.nr_sequencia 		= e.nr_seq_conta_pos
			and	p.nr_sequencia 		= b.nr_seq_conta_pos_estab)

union all

select	a.ie_status,
	a.nr_seq_conta_proc,
	a.nr_seq_conta_mat,
	b.cd_conta_credito,
	b.cd_conta_debito,
	b.cd_classif_cred,
	b.cd_classif_deb,
	b.nr_seq_esquema,
	a.nr_sequencia,
	a.nr_seq_item_mensalidade,
	a.nr_seq_conta_copartic,
	a.nr_seq_conta_pos_estab,
	a.nr_seq_atualizacao,
	a.nr_seq_ppsc_movimento,
	a.nr_seq_ppsc_mov_item,
	a.nr_seq_fatura_proc,
	a.nr_seq_fatura_mat,
	a.nr_seq_evento_movimento,
	a.nr_seq_pag_tributo,
	b.cd_conta_credito_ndc,
	b.cd_conta_debito_ndc,
	b.cd_classif_cred_ndc,
	b.cd_classif_deb_ndc,
	b.nr_seq_esquema_ndc,
	b.cd_conta_credito_dif,
	b.cd_conta_debito_dif,
	b.cd_classif_cred_dif,
	b.cd_classif_deb_dif,
	b.nr_seq_esquema_dif,
	a.nr_seq_pos_estab_contab,
	a.nr_seq_fat_item_trib
from	pls_movimento_contabil	a,
	pls_fatura_mat		b
where	a.nr_seq_fatura_mat	= b.nr_sequencia
and	not exists (	select 	1
			from	pls_conta 			c,
				pls_conta_pos_estabelecido 	p,
				pls_conta_pos_estab_contab 	e
			where	c.nr_sequencia 		= p.nr_seq_conta
			and	p.nr_sequencia 		= e.nr_seq_conta_pos
			and	p.nr_sequencia 		= b.nr_seq_conta_pos_estab)

union all

select	a.ie_status,
	a.nr_seq_conta_proc,
	a.nr_seq_conta_mat,
	b.cd_conta_cred,
	b.cd_conta_deb,
	b.cd_classif_cred,
	b.cd_classif_deb,
	b.nr_seq_esquema,
	a.nr_sequencia,
	a.nr_seq_item_mensalidade,
	a.nr_seq_conta_copartic,
	a.nr_seq_conta_pos_estab,
	a.nr_seq_atualizacao,
	a.nr_seq_ppsc_movimento,
	a.nr_seq_ppsc_mov_item,
	a.nr_seq_fatura_proc,
	a.nr_seq_fatura_mat,
	a.nr_seq_evento_movimento,
	a.nr_seq_pag_tributo,
	b.cd_conta_cred_ndc,
	b.cd_conta_deb_ndc,
	b.cd_classif_cred_ndc,
	b.cd_classif_deb_ndc,
	b.nr_seq_esquema_ndc,
	b.cd_conta_cred_dif,
	b.cd_conta_deb_dif,
	b.cd_classif_cred_dif,
	b.cd_classif_deb_dif,
	b.nr_seq_esquema_dif,
	a.nr_seq_pos_estab_contab,
	a.nr_seq_fat_item_trib
from	pls_movimento_contabil	a,
	pls_conta_pos_estab_contab b
where	a.nr_seq_pos_estab_contab = b.nr_sequencia

union all

select	a.ie_status,
	a.nr_seq_conta_proc,
	a.nr_seq_conta_mat,
	b.cd_conta_cred,
	b.cd_conta_deb,
	b.cd_classif_cred,
	b.cd_classif_deb,
	b.nr_seq_esquema,
	a.nr_sequencia,
	a.nr_seq_item_mensalidade,
	a.nr_seq_conta_copartic,
	a.nr_seq_conta_pos_estab,
	a.nr_seq_atualizacao,
	a.nr_seq_ppsc_movimento,
	a.nr_seq_ppsc_mov_item,
	a.nr_seq_fatura_proc,
	a.nr_seq_fatura_mat,
	a.nr_seq_evento_movimento,
	a.nr_seq_pag_tributo,
	b.cd_conta_prov_cred,
	b.cd_conta_prov_deb,
	b.cd_classif_prov_cred,
	b.cd_classif_prov_deb,
	b.nr_seq_esquema_prov,
	null,
	null,
	null,
	null,
	null,
	a.nr_seq_pos_estab_contab,
	a.nr_seq_fat_item_trib
from	pls_movimento_contabil	a,
	pls_fatura_item_trib	b
where	a.nr_seq_fat_item_trib	= b.nr_sequencia;

