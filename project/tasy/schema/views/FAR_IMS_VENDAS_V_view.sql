-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW far_ims_vendas_v (tp_registro, fixo_1, cd_ims, dt_inicial, dt_final, dt_arquivo, fixo_2, ds_branco, cd_interno_ims, ie_periodo, cd_pessoa_fisica, flag_cliente, cd_material, flag_produto, flag_venda, qt_material, qt_registro, qt_unidade, qt_total_devolucao) AS select	'4' tp_registro,
	'0' fixo_1,
	'????'cd_ims,
	to_char(LOCALTIMESTAMP,'ddmmyyyy') dt_inicial,
	to_char(LOCALTIMESTAMP,'ddmmyyyy') dt_final,
	to_char(LOCALTIMESTAMP,'ddmmyyyy') dt_arquivo,
	'D' fixo_2,
	'   ' ds_branco,
	'imsbrpro7' cd_interno_ims,
	'' ie_periodo,
	'' cd_pessoa_fisica,
	'' flag_cliente,
	'' cd_material,
	'' flag_produto,
	'' flag_venda,
	'' qt_material,
	'' qt_registro,
	'' qt_unidade,
	'' qt_total_devolucao


union all

select '5' tp_registro,
	'0' fixo_1,
	''cd_ims,
	'' dt_inicial,
	'' dt_final,
	'' dt_arquivo,
	'V' fixo_2,
	'' ds_branco,
	'' cd_interno_ims,
	'01' ie_periodo,
	lpad(a.cd_pessoa_fisica,14,0) cd_pessoa_fisica,
	'1' flag_cliente,
	to_char(lpad(b.cd_material,13,0)) cd_material,
	'1' flag_produto,
	'N' flag_venda,
	to_char(lpad(b.qt_material,13,0)) qt_material,
	'' qt_registro,
	'' qt_unidade,
	'' qt_total_devolucao
from far_pedido a,
		far_pedido_item b
where a.nr_sequencia = b.nr_seq_pedido

union all

select '6' tp_registro,
	'0' fixo_1,
	'????'cd_ims,
	'' dt_inicial,
	'' dt_final,
	'' dt_arquivo,
	'' fixo_2,
	'' ds_branco,
	'imsbrven6' cd_interno_ims,
	'' ie_periodo,
	'' cd_pessoa_fisica,
	'' flag_cliente,
	'' cd_material,
	'' flag_produto,
	'' flag_venda,
	'' qt_material,
	'00000000' qt_registro,
	to_char(lpad(sum(b.qt_material),10,0)) qt_unidade,
	'0000000000' qt_total_devolucao
from	far_pedido a,
	far_pedido_item b
where a.nr_sequencia = b.nr_seq_pedido;

