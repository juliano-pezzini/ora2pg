-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pepo_item_pendente_pep_v (nr_sequencia, ds_item, nr_seq_apres, nm_usuario, nr_atendimento, cd_perfil, dt_liberacao, dt_assinatura, cd_pessoa_fisica, nr_item, nr_projeto, ds_tipo_fk, ie_processo_assinado) AS select	f.nr_parecer	nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
		d.cd_pessoa_fisica,
		coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
        null nr_projeto,
        'nr_parecer' ds_tipo_fk,
        '' ie_processo_assinado
FROM parecer_medico_req f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_parecer							= f.nr_parecer and c.nr_seq_perda_ganho					is null and c.nr_parecer							is not null and c.nr_seq_anamnese						is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.cd_evolucao					        is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and c.nr_seq_atend_monit_resp				is null and f.dt_liberacao						is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'

union
 -- Perda e Ganho
select	f.nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
		d.cd_pessoa_fisica,
		coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
        36671 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'LGP' ie_processo_assinado
 FROM atendimento_perda_ganho f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_perda_ganho					= f.nr_sequencia and c.nr_seq_perda_ganho					is not null and c.nr_parecer							is null and c.nr_seq_anamnese						is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.cd_evolucao					        is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and c.nr_seq_atend_monit_resp				is null and f.dt_liberacao						is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
 -- Anamnese
select	f.nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
		d.cd_pessoa_fisica,
		coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
        25172 nr_projeto,
         'nr_sequencia' ds_tipo_fk,
         '' ie_processo_assinado
FROM anamnese_paciente f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_anamnese						= f.nr_sequencia and c.nr_seq_anamnese						is not null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.cd_evolucao					        is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and c.nr_seq_atend_monit_resp				is null and f.dt_liberacao						is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
	--  Sinais Vitais
select	f.nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
		d.cd_pessoa_fisica,
		coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
        184 nr_projeto,
         'nr_sequencia' ds_tipo_fk,
         'SV' ie_processo_assinado
FROM atendimento_sinal_vital f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_sinal_vital					= f.nr_sequencia and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.cd_evolucao					        is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_sinal_vital					is not null and f.dt_liberacao						is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' and (coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S' 
or (f.nr_cirurgia is not null)
or (f.nr_seq_pepo is not null and exists (select 1 from cirurgia z where z.nr_seq_pepo = f.nr_seq_pepo)))
 
union
   -- Monitorizacao
select	f.nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
		d.cd_pessoa_fisica,
		coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
        25185 nr_projeto,
         'nr_sequencia' ds_tipo_fk,
         'SVMR' ie_processo_assinado
FROM atendimento_monit_resp f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_atend_monit_resp				= f.nr_sequencia and c.nr_seq_sinal_vital					is null and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.cd_evolucao					        is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_atend_monit_resp					is not null and f.dt_liberacao						is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' and (coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S' 
or (f.nr_cirurgia is not null)
or (f.nr_seq_pepo is not null and exists (select 1 from cirurgia z where z.nr_seq_pepo = f.nr_seq_pepo)))
 
union
	-- SAE
select	f.nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
		d.cd_pessoa_fisica,
		coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
        25290 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        '' ie_processo_assinado
FROM pe_prescricao f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_sae							= f.nr_sequencia and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is null and c.cd_evolucao					        is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is not null and c.nr_seq_sinal_vital					is null and c.nr_seq_atend_monit_resp				is null and f.dt_liberacao						is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
	-- CID Doencas
select	f.nr_seq_interno nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
		d.cd_pessoa_fisica,
		coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
        null nr_projeto,
        'nr_seq_interno' ds_tipo_fk,
        '' ie_processo_assinado
FROM diagnostico_doenca f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_diag_doenca					= f.nr_seq_interno and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is not null and c.nr_seq_ehr_reg						is null and c.cd_evolucao					        is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and c.nr_seq_atend_monit_resp				is null and f.dt_liberacao						is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
	-- Registro EHR
select	f.nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
		d.cd_pessoa_fisica,
		coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
	25187 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'T' ie_processo_assinado
FROM ehr_registro f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_ehr_reg						= f.nr_sequencia and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is null and c.cd_evolucao					        is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is not null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and c.nr_seq_atend_monit_resp				is null and f.dt_liberacao						is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
	-- Loco Regional
select	f.nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
		d.cd_pessoa_fisica,
		coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
        null nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        '' ie_processo_assinado
FROM can_loco_regional f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_loco_reg						= f.nr_sequencia and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.cd_evolucao					        is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is not null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and c.nr_seq_atend_monit_resp				is null and f.dt_liberacao						is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
	-- Pendencia Conta
select	f.nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		null dt_liberacao,
		null dt_assinatura,
		d.cd_pessoa_fisica,
		coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
        null nr_projeto,
        'nr_sequencia' ds_tipo_fk,
       ''  ie_processo_assinado
FROM cta_pendencia f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_cta_pendencia					= f.nr_sequencia and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is not null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.cd_evolucao					        is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and c.nr_seq_atend_monit_resp				is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
 --evolucao
select	f.cd_evolucao nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
		d.cd_pessoa_fisica,
		coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
        183 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'EP' ie_processo_assinado
FROM evolucao_paciente f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.cd_evolucao					= f.cd_evolucao and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.cd_evolucao					        is not null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and c.nr_seq_atend_monit_resp				is null and f.dt_liberacao						is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
 -- posicao
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        50332 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'PLP' ie_processo_assinado
FROM posicao_cirurgia f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_posicao		= f.nr_sequencia and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
 -- pele
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        50334 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'PLPE' ie_processo_assinado
FROM pepo_pele f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_pele			= f.nr_sequencia and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
 -- curativo
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        50338 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'PLC' ie_processo_assinado
FROM pepo_curativo f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_curativo		= f.nr_sequencia and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is null and c.nr_seq_curativo		is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
 -- incisao
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        50336 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'PLI' ie_processo_assinado
FROM incisao_cirurgia f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_incisao		= f.nr_sequencia and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is null and c.nr_seq_curativo		is null and c.nr_seq_incisao		is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
 -- aldrete
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        50658 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'LEA' ie_processo_assinado
FROM escala_aldrete f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_aldrete		= f.nr_sequencia and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is null and c.nr_seq_curativo		is null and c.nr_seq_incisao		is null and c.nr_seq_aldrete		is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
 -- conjunto
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        50952 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'LCJ' ie_processo_assinado
FROM cm_conjunto_cont f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_conjunto		= f.nr_sequencia and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is null and c.nr_seq_curativo		is null and c.nr_seq_incisao		is null and c.nr_seq_aldrete		is null and c.nr_seq_conjunto		is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
 -- avaliacao
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        50672 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'LAV' ie_processo_assinado
FROM med_avaliacao_paciente f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_avaliacao		= f.nr_sequencia and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is null and c.nr_seq_curativo		is null and c.nr_seq_incisao		is null and c.nr_seq_aldrete		is null and c.nr_seq_conjunto		is null and c.nr_seq_avaliacao		is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
 -- agentes anestesicos
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        51092 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'PLA' ie_processo_assinado
FROM cirurgia_agente_anestesico f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_cirur_agente		= f.nr_sequencia and f.ie_tipo			= 1 and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is null and c.nr_seq_curativo		is null and c.nr_seq_incisao		is null and c.nr_seq_aldrete		is null and c.nr_seq_conjunto		is null and c.nr_seq_avaliacao		is null and c.nr_seq_cirur_agente		is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and (coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S' 
or (f.nr_cirurgia is not null)
or (f.nr_seq_pepo is not null and exists (select 1 from cirurgia z where z.nr_seq_pepo = f.nr_seq_pepo)))
 
union
 -- Terapia hidroeletrolitica
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        51097 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'PLT' ie_processo_assinado
FROM cirurgia_agente_anestesico f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_cirur_agente		= f.nr_sequencia and f.ie_tipo			= 2 and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is null and c.nr_seq_curativo		is null and c.nr_seq_incisao		is null and c.nr_seq_aldrete		is null and c.nr_seq_conjunto		is null and c.nr_seq_avaliacao		is null and c.nr_seq_cirur_agente		is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and (coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S' 
or (f.nr_cirurgia is not null)
or (f.nr_seq_pepo is not null and exists (select 1 from cirurgia z where z.nr_seq_pepo = f.nr_seq_pepo)))
 
union
 -- Medicamentos
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        51095 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'PLM' ie_processo_assinado
FROM cirurgia_agente_anestesico f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_cirur_agente		= f.nr_sequencia and f.ie_tipo			= 3 and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is null and c.nr_seq_curativo		is null and c.nr_seq_incisao		is null and c.nr_seq_aldrete		is null and c.nr_seq_conjunto		is null and c.nr_seq_avaliacao		is null and c.nr_seq_cirur_agente		is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and (coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S' 
or (f.nr_cirurgia is not null)
or (f.nr_seq_pepo is not null and exists (select 1 from cirurgia z where z.nr_seq_pepo = f.nr_seq_pepo)))
 
union
 -- Materiais
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        51099 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'PLMT' ie_processo_assinado
FROM cirurgia_agente_anestesico f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_cirur_agente		= f.nr_sequencia and f.ie_tipo			= 4 and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is null and c.nr_seq_curativo		is null and c.nr_seq_incisao		is null and c.nr_seq_aldrete		is null and c.nr_seq_conjunto		is null and c.nr_seq_avaliacao		is null and c.nr_seq_cirur_agente		is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and (coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S' 
or (f.nr_cirurgia is not null)
or (f.nr_seq_pepo is not null and exists (select 1 from cirurgia z where z.nr_seq_pepo = f.nr_seq_pepo)))
 
union
 -- Hemoderivados
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        51101 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'PLH' ie_processo_assinado
FROM cirurgia_agente_anestesico f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_cirur_agente		= f.nr_sequencia and f.ie_tipo			= 5 and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp		is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is null and c.nr_seq_curativo		is null and c.nr_seq_incisao		is null and c.nr_seq_aldrete		is null and c.nr_seq_conjunto		is null and c.nr_seq_avaliacao		is null and c.nr_seq_cirur_agente		is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and (coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S' 
or (f.nr_cirurgia is not null)
or (f.nr_seq_pepo is not null and exists (select 1 from cirurgia z where z.nr_seq_pepo = f.nr_seq_pepo)))
 
union
 -- Tecnica Anestesica
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        44466 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'LTA' ie_processo_assinado
FROM cirurgia_tec_anestesica f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_tecnica_anest		= f.nr_sequencia and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is null and c.nr_seq_curativo		is null and c.nr_seq_incisao		is null and c.nr_seq_aldrete		is null and c.nr_seq_conjunto		is null and c.nr_seq_avaliacao		is null and c.nr_seq_cirur_agente		is null and c.nr_seq_tecnica_anest		is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
 -- Descricao Anestesica
select	f.nr_sequencia,
	coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        44469 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'LDA' ie_processo_assinado
FROM anestesia_descricao f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_desc_anest		= f.nr_sequencia and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is null and c.nr_seq_curativo		is null and c.nr_seq_incisao		is null and c.nr_seq_aldrete		is null and c.nr_seq_conjunto		is null and c.nr_seq_avaliacao		is null and c.nr_seq_cirur_agente		is null and c.nr_seq_tecnica_anest		is null and c.nr_seq_desc_anest		is not null and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
 -- SV Monit Analgesia
select	f.nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
		d.cd_pessoa_fisica,
		coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
        25183 nr_projeto,
         'nr_sequencia' ds_tipo_fk,
         'SVMA' ie_processo_assinado
FROM atend_aval_analgesia f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica 					= c.cd_pessoa_fisica and c.nr_atendimento					= f.nr_atendimento and c.nr_seq_atend_aval_analgesia				= f.nr_sequencia and c.nr_seq_anamnese					is null and c.nr_parecer						is null and c.nr_seq_perda_ganho					is null and c.cd_evolucao					        is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg					is null and c.nr_seq_loco_reg					is null and c.nr_seq_sae						is null and c.nr_seq_sinal_vital					is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_atend_aval_analgesia				is not null and f.dt_liberacao						is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)		is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union

select	f.nr_sequencia,
	'Escala Steward' ds_item,
	coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres,
	c.nm_usuario,
	c.nr_atendimento,
	b.cd_perfil,
	f.dt_liberacao dt_liberacao,
	obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura,
	d.cd_pessoa_fisica,
	coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item,
        50653 nr_projeto,
        'nr_sequencia' ds_tipo_fk,
        'LES' ie_processo_assinado
FROM escala_stewart f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica		= c.cd_pessoa_fisica and c.nr_seq_anamnese		is null and c.nr_parecer			is null and c.nr_seq_perda_ganho		is null and c.cd_evolucao			is null and c.nr_seq_diag_doenca		is null and c.nr_seq_ehr_reg		is null and c.nr_seq_loco_reg		is null and c.nr_seq_sae			is null and c.nr_seq_sinal_vital		is null and c.nr_seq_atend_monit_resp				is null and c.nr_seq_posicao		is null and c.nr_seq_pele			is null and c.nr_seq_curativo		is null and c.nr_seq_incisao		is null and c.nr_seq_aldrete		is null and c.nr_seq_conjunto		is null and c.nr_seq_avaliacao		is null and c.nr_seq_cirur_agente		is null and c.nr_seq_tecnica_anest		is null and c.nr_seq_desc_anest		is null and c.nr_seq_escala = f.nr_sequencia and c.nr_seq_escala is not null and ie_escala = '71' and f.dt_liberacao			is not null and obter_data_assinatura_digital(f.nr_seq_assinatura)	is null and coalesce(c.ie_pendente_assinat_usuario,'N')			= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S'
 
union
	/* Administracoes  Hemoderivados, Agentes Anestesicos, Medicamentos, Terapia Hidroelectrolitica*/

SELECT f.nr_sequencia,
  COALESCE(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
  coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
  c.nm_usuario,
  c.nr_atendimento,
  b.cd_perfil,
  f.dt_liberacao dt_liberacao,
  null dt_assinatura,
  d.cd_pessoa_fisica,
  coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
  CASE WHEN UPPER(IE_TIPO_REGISTRO)='ADHE' THEN  51118 WHEN UPPER(IE_TIPO_REGISTRO)='ADAA' THEN  51112 WHEN UPPER(IE_TIPO_REGISTRO)='ADMD' THEN  51114 WHEN UPPER(IE_TIPO_REGISTRO)='ADTH' THEN  51116 END  nr_projeto,
  'nr_sequencia' ds_tipo_fk,
  CASE WHEN UPPER(IE_TIPO_REGISTRO)='ADHE' THEN  'PLAH' WHEN UPPER(IE_TIPO_REGISTRO)='ADAA' THEN  'PLAA' WHEN UPPER(IE_TIPO_REGISTRO)='ADMD' THEN  'PLAM' WHEN UPPER(IE_TIPO_REGISTRO)='ADTH' THEN  '' END  ie_processo_assinado
FROM cirurgia_agente_anest_ocor f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                     = c.cd_pessoa_fisica AND f.nr_sequencia		  		 			         = c.nr_seq_registro AND c.nr_seq_anamnese                     IS NULL AND c.nr_parecer                          IS NULL AND c.nr_seq_perda_ganho                  IS NULL AND c.nr_seq_cta_pendencia                IS NULL AND c.nr_seq_diag_doenca                  IS NULL AND c.nr_seq_ehr_reg                      IS NULL AND c.nr_seq_loco_reg                     IS NULL AND c.nr_seq_sae                          IS NULL AND c.cd_evolucao                         IS NULL AND c.nr_seq_sinal_vital                  IS NULL AND c.nr_seq_atend_monit_resp             IS NULL AND c.nr_seq_posicao                      IS NULL AND c.nr_seq_pele                         IS NULL AND c.nr_seq_curativo                     IS NULL AND c.nr_seq_incisao                      IS NULL AND c.nr_seq_aldrete                      IS NULL AND c.nr_seq_conjunto                     IS NULL AND c.nr_seq_avaliacao                    IS NULL AND c.nr_seq_cirur_agente                 IS NULL AND c.nr_seq_tecnica_anest                IS NULL AND c.nr_seq_desc_anest                   IS NULL AND c.nr_seq_anamnese                     IS NULL AND c.nr_seq_atend_aval_analgesia         IS NULL AND c.nr_prescricao                       IS NULL AND upper(ie_tipo_registro)               IN ('ADHE', 'ADAA', 'ADMD', 'ADTH') AND coalesce(ie_escala,0)                      <> '71' AND coalesce(c.ie_pendente_assinat_usuario,'N') = 'N' AND (coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')   =   'S'
or	exists (select 1 from CIRURGIA_AGENTE_ANESTESICO Y where y.nr_cirurgia is not null and f.NR_SEQ_CIRUR_AGENTE = y.nr_sequencia)
or	exists (select 1 from cirurgia z, CIRURGIA_AGENTE_ANESTESICO Y where z.nr_seq_pepo = y.nr_seq_pepo and y.nr_seq_pepo is not null and f.NR_SEQ_CIRUR_AGENTE = y.nr_sequencia))
 
union
	-- Outras pendencias
select	c.nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item,
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		null dt_liberacao,
		null dt_assinatura,
		d.cd_pessoa_fisica,
		coalesce(b.NR_SEQ_ITEM_PEPO, a.nr_sequencia) nr_item,
        null,
        'nr_sequencia' ds_tipo_fk,
        '' ie_processo_assinado
FROM pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_seq_anamnese					is null and c.nr_parecer						is null and c.nr_seq_perda_ganho				is null and c.nr_seq_cta_pendencia				is null and c.nr_seq_diag_doenca				is null and c.nr_seq_ehr_reg					is null and c.nr_seq_loco_reg					is null and c.nr_seq_sae						is null and c.cd_evolucao					    is null and c.nr_seq_sinal_vital				is null and c.nr_seq_atend_monit_resp			is null and c.nr_seq_posicao					is null and c.nr_seq_pele						is null and c.nr_seq_curativo					is null and c.nr_seq_incisao					is null and c.nr_seq_aldrete					is null and c.nr_seq_conjunto					is null and c.nr_seq_avaliacao					is null and c.nr_seq_cirur_agente				is null and c.nr_seq_tecnica_anest				is null and c.nr_seq_desc_anest					is null and c.nr_seq_anamnese					is null and c.nr_seq_atend_aval_analgesia		is null and c.nr_prescricao 					is null and ie_escala <> '71' and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' and coalesce(c.IE_GERADO_FUNCAO_PEPO,'N') = 'S' order by
		nr_seq_apres,
		ds_item;

