-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW adep_item_pendente_pep_v (nr_sequencia, ds_item, nr_seq_apres, nm_usuario, nr_atendimento, cd_perfil, dt_liberacao, dt_assinatura) AS select	f.nr_parecer	nr_sequencia,
		substr(coalesce(Obter_descricao_tipo_item(c.ie_tipo_item_adep),b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item),1,255) ds_item,
		coalesce(b.nr_seq_apres,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura
FROM parecer_medico_req f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN prontuario_item a ON (c.nr_seq_item_pront = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pront b ON (a.nr_sequencia = b.nr_seq_item_pront)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_parecer							= f.nr_parecer and c.nr_seq_perda_ganho					is null and c.nr_parecer							is not null and c.nr_seq_anamnese						is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N'

union
 -- Perda e Ganho
select	f.nr_sequencia,
		substr(coalesce(Obter_descricao_tipo_item(c.ie_tipo_item_adep),b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item),1,255) ds_item,
		coalesce(b.nr_seq_apres,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura
FROM atendimento_perda_ganho f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN prontuario_item a ON (c.nr_seq_item_pront = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pront b ON (a.nr_sequencia = b.nr_seq_item_pront)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_perda_ganho					= f.nr_sequencia and c.nr_seq_perda_ganho					is not null and c.nr_parecer							is null and c.nr_seq_anamnese						is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N'
 
union
 -- Anamnese
select	f.nr_sequencia,
		substr(coalesce(Obter_descricao_tipo_item(c.ie_tipo_item_adep),b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item),1,255) ds_item,
		coalesce(b.nr_seq_apres,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura
FROM anamnese_paciente f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN prontuario_item a ON (c.nr_seq_item_pront = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pront b ON (a.nr_sequencia = b.nr_seq_item_pront)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_anamnese						= f.nr_sequencia and c.nr_seq_anamnese						is not null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N'
 
union
	--  Sinais Vitais
select	f.nr_sequencia,
		substr(coalesce(Obter_descricao_tipo_item(c.ie_tipo_item_adep),b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item),1,255) ds_item,
		coalesce(b.nr_seq_apres,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura
FROM atendimento_sinal_vital f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN prontuario_item a ON (c.nr_seq_item_pront = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pront b ON (a.nr_sequencia = b.nr_seq_item_pront)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_sinal_vital					= f.nr_sequencia and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is not null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N'
 
union
	-- SAE
select	f.nr_sequencia,
		substr(coalesce(Obter_descricao_tipo_item(c.ie_tipo_item_adep),b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item),1,255) ds_item,
		coalesce(b.nr_seq_apres,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura
FROM pe_prescricao f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN prontuario_item a ON (c.nr_seq_item_pront = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pront b ON (a.nr_sequencia = b.nr_seq_item_pront)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_sae							= f.nr_sequencia and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is not null and c.nr_seq_sinal_vital					is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N'
 
union
	-- CID Doencas
select	f.nr_seq_interno nr_sequencia,
		substr(coalesce(Obter_descricao_tipo_item(c.ie_tipo_item_adep),b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item),1,255) ds_item,
		coalesce(b.nr_seq_apres,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura
FROM diagnostico_doenca f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN prontuario_item a ON (c.nr_seq_item_pront = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pront b ON (a.nr_sequencia = b.nr_seq_item_pront)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_diag_doenca					= f.nr_seq_interno and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is not null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N'
 
union
	-- Registro EHR
select	f.nr_sequencia,
		substr(coalesce(Obter_descricao_tipo_item(c.ie_tipo_item_adep),b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item),1,255) ds_item,
		coalesce(b.nr_seq_apres,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura
FROM ehr_registro f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN prontuario_item a ON (c.nr_seq_item_pront = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pront b ON (a.nr_sequencia = b.nr_seq_item_pront)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_ehr_reg						= f.nr_sequencia and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is not null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N'
 
union
	-- Loco Regional
select	f.nr_sequencia,
		substr(coalesce(Obter_descricao_tipo_item(c.ie_tipo_item_adep),b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item),1,255) ds_item,
		coalesce(b.nr_seq_apres,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		f.dt_liberacao,
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura
FROM can_loco_regional f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN prontuario_item a ON (c.nr_seq_item_pront = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pront b ON (a.nr_sequencia = b.nr_seq_item_pront)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_loco_reg						= f.nr_sequencia and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is not null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N'
 
union
	-- Pendencia Conta
select	f.nr_sequencia,
		substr(coalesce(Obter_descricao_tipo_item(c.ie_tipo_item_adep),b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item),1,255) ds_item,
		coalesce(b.nr_seq_apres,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		null dt_liberacao,
		null dt_assinatura
FROM cta_pendencia f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN prontuario_item a ON (c.nr_seq_item_pront = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pront b ON (a.nr_sequencia = b.nr_seq_item_pront)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_atendimento						= f.nr_atendimento and c.nr_seq_cta_pendencia					= f.nr_sequencia and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is not null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N'
 
union
	-- Outras pendencias
select	c.nr_sequencia,
		substr(coalesce(Obter_descricao_tipo_item(c.ie_tipo_item_adep),b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item),1,255) ds_item,
		coalesce(b.nr_seq_apres,99999) nr_seq_apres,
		c.nm_usuario,
		c.nr_atendimento,
		b.cd_perfil,
		null dt_liberacao,
		null dt_assinatura
FROM pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN prontuario_item a ON (c.nr_seq_item_pront = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pront b ON (a.nr_sequencia = b.nr_seq_item_pront)
WHERE d.cd_pessoa_fisica 						= c.cd_pessoa_fisica and c.nr_seq_anamnese						is null and c.nr_parecer							is null and c.nr_seq_perda_ganho					is null and c.nr_seq_cta_pendencia					is null and c.nr_seq_diag_doenca					is null and c.nr_seq_ehr_reg						is null and c.nr_seq_loco_reg						is null and c.nr_seq_sae							is null and c.nr_seq_sinal_vital					is null and coalesce(c.ie_pendente_assinat_usuario,'N')	= 'N' order by
		nr_seq_apres,
		ds_item;

