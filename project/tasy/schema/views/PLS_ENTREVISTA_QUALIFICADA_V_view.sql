-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_entrevista_qualificada_v (nr_seq_proposta, dt_inicio_proposta, nr_seq_pessoa_proposta, nr_seq_segurado, cd_pessoa_fisica, ie_status_entrevista, ds_status_entrevista, nm_pessoa_fisica, cd_estipulante, cd_cgc_estipulante, nm_estipulante, nr_seq_pagador, nm_pagador, nm_titular, ds_idade, qt_peso, qt_altura_cm, qt_imc, ie_pericia_medica, ie_cpt, ie_declaracao_saude, nr_seq_entrevista) AS select	a.nr_seq_proposta nr_seq_proposta,
	b.dt_inicio_proposta, 
	a.nr_sequencia nr_seq_pessoa_proposta, 
	null nr_seq_segurado, 
	a.cd_beneficiario cd_pessoa_fisica, 
	substr(pls_eq_obter_status(a.nr_sequencia, 'C'),1,5) ie_status_entrevista, 
	substr(pls_eq_obter_status(a.nr_sequencia, 'D'),1,80) ds_status_entrevista, 
	substr(obter_nome_pf(a.cd_beneficiario),1,255) nm_pessoa_fisica, 
	b.cd_estipulante, 
	b.cd_cgc_estipulante, 
	substr(pls_obter_dados_proposta(b.nr_sequencia, 'NE'),1,80) nm_estipulante, 
	a.nr_seq_pagador, 
	substr(pls_obter_dados_pagador_prop(a.nr_seq_pagador,'N'),1,255) nm_pagador, 
	substr(pls_obter_dados_benef_prop(a.nr_seq_titular,'N'),1,255) nm_titular, 
	substr(obter_dados_pf(a.cd_beneficiario, 'I'),1,40) ds_idade, 
	substr(pls_obter_dados_declaracao('0',b.nr_sequencia,0, 'P'),1,10) qt_peso, 
	substr(pls_obter_dados_declaracao('0',b.nr_sequencia,0, 'A'),1,10) qt_altura_cm, 
	substr(pls_obter_dados_declaracao('0',b.nr_sequencia,0, 'I'),1,10) qt_imc, 
	substr(pls_proposta_obter_se_pericia(a.nr_sequencia),1,1) ie_pericia_medica, 
	substr(pls_proposta_obter_se_cpt(a.nr_sequencia),1,1) ie_cpt, 
	substr(pls_obter_dec_saude_proposta(a.nr_sequencia, 'D'),1,80) ie_declaracao_saude, 
	pls_obter_entrevista_benef(a.nr_sequencia) nr_seq_entrevista 
FROM	pls_proposta_adesao		b, 
	pls_proposta_beneficiario	a 
where	a.nr_seq_proposta		= b.nr_sequencia;

