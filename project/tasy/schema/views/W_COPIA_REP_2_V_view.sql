-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW w_copia_rep_2_v (nr_seq_ordem, ds_item, nr_sequencia, dt_atualizacao, nm_usuario, dt_atualizacao_nrec, nm_usuario_nrec, nr_prescricao, ie_tipo_item, qt_item, cd_unidade_medida, cd_intervalo, ie_via_aplicacao, nr_seq_item, cd_item, ie_copiar, hr_prim_horario, ds_intervalo_sol, nr_seq_apres_grupo, nr_seq_apres_inf, ie_superior_composto, ds_horarios, ie_duplicado, ie_mesma_vigencia, ds_dose_diferenciada) AS select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
FROM	w_copia_rep
where	ie_tipo_item = 'J'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('J', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('J', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'J'
and	ie_mesma_vigencia = 'S'
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'J')

union all

-- DIETA ORAL
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'D'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('D', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('D', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'D'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'D')

union all

-- SUPLEMENTO ORAL
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'S'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('S', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('S', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'S'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'S')

union all

-- SOLUÇÕES
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'SOL'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('SOL', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('SOL', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'SOL'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'SOL')

union all

-- SUPORTE NUTRICIONAL ENTERAL
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'SNE'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('SNE', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('SNE', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'SNE'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'SNE')

union all

-- HEMOTERAPIA
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'HM'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('HM', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('HM', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'HM'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'HM')

union all

-- MEDICAMENTOS
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), cd_intervalo),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'M'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('M', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('M', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item	= 'M'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'M')

union all

-- MATERIAIS
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), cd_intervalo),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'MAT'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('MAT', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('MAT', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'MAT'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'MAT')

union all

-- PROCEDIMENTOS
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', 'P') nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), cd_intervalo),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'P'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('P', 'T', 'P') nr_seq_ordem,
	obter_titulos_gestao_adep('P', 'P') ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'P'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'P')

union all

-- CONTROLE DE GLICEMIA
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item in ('G', 'C')
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('G', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('G', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item in ('G', 'C')
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item in ('C','G'))

union all

-- IRRIGAÇÃO VESICAL CONTÍNUA
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'I'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('I', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('I', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'I'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'I')

union all

-- COLETAS
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'L'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('L', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('L', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'L'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'L')

union all

-- GASOTERAPIA
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'O'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('O', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('O', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'O'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'O')

union all

-- RECOMENDAÇÕES
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'R'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('R', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('R', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'R'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'R')

union all

-- ORDENS MÉDICAS
select	obter_ordem_informacoes_gestao(ie_tipo_item, 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'B'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('B', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('B', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'B'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'B')

union all

-- CCG
select	obter_ordem_informacoes_gestao('C', 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'CG'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('C', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('C', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'CG'
and	ie_mesma_vigencia = 'S' 
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'CG')

union all

-- NPT Adulta
select	obter_ordem_informacoes_gestao('NAN', 'R', null) nr_seq_ordem,
	('          ' || ds_item) ds_item,
	nr_sequencia,
	dt_atualizacao,
	nm_usuario,
	dt_atualizacao_nrec,
	nm_usuario_nrec,
	nr_prescricao,
	ie_tipo_item,
	qt_item,
	cd_unidade_medida,
	substr(coalesce(OBTER_DESC_INTERVALO_PRESCR(cd_intervalo), OBTER_DESC_INTERVALO(cd_intervalo)),1,80) cd_intervalo,
	ie_via_aplicacao,
	nr_seq_item,
	cd_item,
	ie_copiar,
	hr_prim_horario,
	ds_intervalo_sol,
	nr_seq_apres_grupo,
	nr_seq_apres_inf,
	ie_superior_composto,
	ds_horarios,
	ie_duplicado,
	ie_mesma_vigencia,
	ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'NAN'
and	ie_mesma_vigencia = 'S'

union all

select	obter_ordem_informacoes_gestao('NAN', 'T', null) nr_seq_ordem,
	obter_titulos_gestao_adep('NAN', null) ds_prescrito,
	(null)::numeric  nr_sequencia,
	to_date(null) dt_atualizacao,
	nm_usuario,
	to_date(null) dt_atualizacao_nrec,
	null nm_usuario_nrec,
	(null)::numeric  nr_prescricao,
	ie_tipo_item,
	(null)::numeric  qt_item,
	null cd_unidade_medida,
	null cd_intervalo,
	null ie_via_aplicacao,
	(null)::numeric  nr_seq_item,
	(null)::numeric  cd_item,
	null ie_copiar,
	null hr_prim_horario,
	null ds_intervalo_sol,
	(null)::numeric  nr_seq_apres_grupo,
	(null)::numeric  nr_seq_apres_inf,
	'S' ie_superior_composto,
	null ds_horarios,
	'N' ie_duplicado,
	ie_mesma_vigencia,
	null ds_dose_diferenciada
from	w_copia_rep
where	ie_tipo_item = 'NAN' 
and	ie_mesma_vigencia = 'S'
and	dt_atualizacao	= (	select	max(dt_atualizacao)
				from	w_copia_rep
				where	ie_tipo_item = 'NAN')
order by nr_seq_ordem, nr_seq_apres_inf, ds_item LIMIT 1;

