-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW centro_custo_v (cd_centro_custo, ds_centro_custo, ie_situacao, dt_atualizacao, nm_usuario, nr_seq_terceiro, cd_grupo, cd_classificacao, ie_tipo, cd_estabelecimento, cd_centro_custo_consumo, cd_sistema_contabil, ie_tipo_custo, ie_periodo_proj_receita, dt_atualizacao_nrec, nm_usuario_nrec, ds_grupo, ds_centro_apres, ie_nivel, ie_classif_superior) AS select 	a.CD_CENTRO_CUSTO,a.DS_CENTRO_CUSTO,a.IE_SITUACAO,a.DT_ATUALIZACAO,a.NM_USUARIO,a.NR_SEQ_TERCEIRO,a.CD_GRUPO,a.CD_CLASSIFICACAO,a.IE_TIPO,a.CD_ESTABELECIMENTO,a.CD_CENTRO_CUSTO_CONSUMO,a.CD_SISTEMA_CONTABIL,a.IE_TIPO_CUSTO,a.IE_PERIODO_PROJ_RECEITA,a.DT_ATUALIZACAO_NREC,a.NM_USUARIO_NREC,
		b.ds_grupo,
		substr(lpad('  ', 5 *(substr(obter_classif_ctb(a.cd_classificacao,'NIVEL'),1,3) -1))||ds_centro_custo,1,60) ds_centro_apres,
		substr(obter_classif_ctb(a.cd_classificacao,'NIVEL'),1,3) ie_nivel,
		substr(obter_classif_ctb(a.cd_classificacao,'SUPERIOR'),1,20) ie_classif_superior
FROM		ctb_grupo_centro b,
		centro_custo a
where		a.cd_grupo	= b.cd_grupo;

