-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW cih_paciente_alta_v (nr_ficha_ocorrencia, nr_atendimento, ds_diagnostico_int, cd_medico_resp, nm_medico, nm_paciente, ie_sexo, dt_nascimento, ds_tipo_evolucao, dt_entrada, dt_alta) AS SELECT /*+ ORDERED */       A.NR_FICHA_OCORRENCIA,
       A.NR_ATENDIMENTO,
       A.DS_DIAGNOSTICO_INT,
       F.CD_MEDICO_RESP,
       (B.NM_PESSOA_FISICA) nm_medico,
       (D.NM_PESSOA_FISICA) nm_paciente,
       D.IE_SEXO,
       D.DT_NASCIMENTO,
       C.DS_TIPO_EVOLUCAO,
       F.DT_ENTRADA,
       F.DT_ALTA
FROM CIH_FICHA_OCORRENCIA A,
     ATENDIMENTO_PACIENTE F,
     CIH_LOCAL_INFECCAO E,
     CIH_PROC_REALIZADO G,
     PESSOA_FISICA B,
     PESSOA_FISICA D,
     CIH_TIPO_EVOLUCAO C
WHERE A.NR_ATENDIMENTO      = F.NR_ATENDIMENTO
AND   E.NR_FICHA_OCORRENCIA = A.NR_FICHA_OCORRENCIA
AND   G.NR_FICHA_OCORRENCIA = A.NR_FICHA_OCORRENCIA
AND   A.CD_CLINICA          = E.CD_CLINICA
AND   F.CD_MEDICO_RESP      = B.CD_PESSOA_FISICA
AND   F.CD_PESSOA_FISICA    = D.CD_PESSOA_FISICA
AND   A.CD_TIPO_EVOLUCAO    = C.CD_TIPO_EVOLUCAO
GROUP BY A.NR_FICHA_OCORRENCIA,
       A.NR_ATENDIMENTO,
       A.DS_DIAGNOSTICO_INT,
	 F.CD_MEDICO_RESP,
       B.NM_PESSOA_FISICA,
       D.NM_PESSOA_FISICA,
       D.IE_SEXO,
       D.DT_NASCIMENTO,
       C.DS_TIPO_EVOLUCAO,
       F.DT_ENTRADA,
       F.DT_ALTA;

