-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW dpc_report4907_medical_info3_v (nr_sequencia, undernourished_start, dysphagia_start, nasogast_tube_start, gastrointestinal_start, peripheral_nutr_start, total_nutr_start, undernourished_after, dysphagia_after, nasogast_tube_after, gastrointestinal_after, peripheral_nutr_after, total_nutr_after, not_numb_1, medical_expenses_1, not_numb_2, medical_expenses_2, bedsores_entry_date_1, presence_bedsores_1_1, presence_bedsores_1_2, presence_bedsores_1_3, presence_bedsores_1_4, presence_bedsores_1_5, presence_bedsores_1_6, presence_bedsores_1_7, bedsores_entry_date_2, presence_bedsores_2_1, presence_bedsores_2_2, presence_bedsores_2_3, presence_bedsores_2_4, presence_bedsores_2_5, presence_bedsores_2_6, presence_bedsores_2_7, bedsores_entry_date_3, presence_bedsores_3_1, presence_bedsores_3_2, presence_bedsores_3_3, presence_bedsores_3_4, presence_bedsores_3_5, presence_bedsores_3_6, presence_bedsores_3_7, bedsores_exit_date_1, presence_bedsores_exit_1_1, presence_bedsores_exit_1_2, presence_bedsores_exit_1_3, presence_bedsores_exit_1_4, presence_bedsores_exit_1_5, presence_bedsores_exit_1_6, presence_bedsores_exit_1_7, bedsores_exit_date_2, presence_bedsores_exit_2_1, presence_bedsores_exit_2_2, presence_bedsores_exit_2_3, presence_bedsores_exit_2_4, presence_bedsores_exit_2_5, presence_bedsores_exit_2_6, presence_bedsores_exit_2_7, bedsores_exit_date_3, presence_bedsores_exit_3_1, presence_bedsores_exit_3_2, presence_bedsores_exit_3_3, presence_bedsores_exit_3_4, presence_bedsores_exit_3_5, presence_bedsores_exit_3_6, presence_bedsores_exit_3_7, fim_entry_date_1, fim_entry_date_2, fim_entry_date_3, fim_entry_weight_1, fim_entry_weight_2, fim_entry_weight_3, fim_socre_1, fim_socre_2, fim_socre_3, fim_exit_date_1, fim_exit_date_2, fim_exit_date_3, fim_exit_weight_1, fim_exit_weight_2, fim_exit_weight_3, fim_score_exit_1, fim_score_exit_2, fim_score_exit_3) AS select coalesce(a.nr_sequencia, 0) nr_sequencia,
  coalesce((select
   case
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_UNDERNOURISHED','N') = '0' then 'No'   
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_UNDERNOURISHED','N') = '1' then 'Yes'
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_UNDERNOURISHED','N') = '9' then 'A judgement has not been made'
   end 
  ), ' ') undernourished_start,
  coalesce((select
   case 
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_DYSPHAGIA','N') = '0' then 'No'   
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_DYSPHAGIA','N') = '1' then 'Yes'
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_DYSPHAGIA','N') = '9' then 'A judgement has not been made'
   end 
  ), ' ') dysphagia_start,
  coalesce((select
   case 
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_NASOGASTRICTUBE','N') = '0' then 'Not yet performed'   
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_NASOGASTRICTUBE','N') = '1' then 'Performed'
   end 
  ), ' ') nasogast_tube_start,  
  coalesce((select
   case 
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_GASTROSTOMY','N') = '0' then 'Not yet performed'   
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_GASTROSTOMY','N') = '1' then 'Performed'
   end 
  ), ' ') gastrointestinal_start,    
  coalesce((select
   case 
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_PERIPHERAL_NUTRITION','N') = '0' then 'Not yet performed'   
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_PERIPHERAL_NUTRITION','N') = '1' then 'Performed'
   end 
  ), ' ') peripheral_nutr_start, 
  coalesce((select
   case 
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_TOTAL_NUTRITION','N') = '0' then 'Not yet performed'   
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_TOTAL_NUTRITION','N') = '1' then 'Performed'
   end 
  ), ' ') total_nutr_start,   
  coalesce((select
   case 
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_UNDERNOURISHED_COMP','N') = '0' then 'No'   
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_UNDERNOURISHED_COMP','N') = '1' then 'Yes'
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_UNDERNOURISHED_COMP','N') = '9' then 'A judgement has not been made'
   end 
  ), ' ') undernourished_after,
  coalesce((select
   case 
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_DYSPHAGIA_COMP','N') = '0' then 'No'   
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_DYSPHAGIA_COMP','N') = '1' then 'Yes'
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_DYSPHAGIA_COMP','N') = '9' then 'A judgement has not been made'
   end 
  ), ' ') dysphagia_after,
  coalesce((select
   case 
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_NASOGASTRIC_COMP','N') = '0' then 'Not yet performed'   
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_NASOGASTRIC_COMP','N') = '1' then 'Performed'
   end 
  ), ' ') nasogast_tube_after,  
  coalesce((select
   case 
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_GASTROSTOMY_COMP','N') = '0' then 'Not yet performed'   
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_GASTROSTOMY_COMP','N') = '1' then 'Performed'
   end 
  ), ' ') gastrointestinal_after,  
  coalesce((select
   case 
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_PERIPHERAL_COMP','N') = '0' then 'Not yet performed'   
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_PERIPHERAL_COMP','N') = '1' then 'Performed'
   end 
  ), ' ') peripheral_nutr_after,
  coalesce((select
   case 
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_TOTAL_NUTRITION_COMP','N') = '0' then 'Not yet performed'   
      when dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_TOTAL_NUTRITION_COMP','N') = '1' then 'Performed'
   end 
  ), ' ') total_nutr_after,
  dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_INTRACTABLE_DISEASE_1','N') not_numb_1,
  (select  CASE WHEN dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_WITH_MED_EXP_SUB_1','N')=1 THEN  'Yes'  ELSE 'No' END 
           ) medical_expenses_1,
  dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_INTRACTABLE_DISEASE_2','N') not_numb_2,
  (select  CASE WHEN dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_WITH_MED_EXP_SUB_2','N')=1 THEN  'Yes'  ELSE 'No' END 
           ) medical_expenses_2,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'DT_ENTRANCE_PRESSURE','S'), ' ') bedsores_entry_date_1,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_DEPTH','N'),' ') presence_bedsores_1_1,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_EXUDATE','N'),' ') presence_bedsores_1_2,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_INFLAMMATION','N'),' ') presence_bedsores_1_3,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_SIZE','N'),' ') presence_bedsores_1_4,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_GRANULATION','N'),' ') presence_bedsores_1_5,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_NECROTICTISSUE','N'),' ') presence_bedsores_1_6,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_POCKET','N'),' ') presence_bedsores_1_7,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'DT_ENTRANCE_PRESSURE_2','S'), ' ') bedsores_entry_date_2,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_DEPTH_2','N'),' ') presence_bedsores_2_1,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_EXUDATE_2','N'),' ') presence_bedsores_2_2, 
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_INFLAMMATION_2','N'),' ') presence_bedsores_2_3,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_SIZE_2','N'),' ') presence_bedsores_2_4,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_GRANULATION_2','N'),' ') presence_bedsores_2_5,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_NRECROTICTISSUE_2','N'),' ') presence_bedsores_2_6,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_POCKET_2','N'),' ') presence_bedsores_2_7,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'DT_ENTRANCE_PRESSURE_3','S'), ' ') bedsores_entry_date_3,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_DEPTH_3','N'),' ') presence_bedsores_3_1,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_EXUDATE_3','N'),' ') presence_bedsores_3_2,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_INFLAMMATION_3','N'),' ') presence_bedsores_3_3,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_SIZE_3','N'),' ') presence_bedsores_3_4,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_GRANULATION_3','N'),' ') presence_bedsores_3_5,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_NECROTICTISSUE_3','N'),' ') presence_bedsores_3_6,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_POCKET_3','N'),' ') presence_bedsores_3_7,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'DT_DEPARTURE_PRESSURE','S'), ' ') bedsores_exit_date_1,
    coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_DEPTH_LEAVING','N'),' ') presence_bedsores_exit_1_1,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_EXUDATE_LEAVING','N'),' ') presence_bedsores_exit_1_2,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_INFLAMMATION_LEAVING','N'),' ') presence_bedsores_exit_1_3,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_SIZE_LEAVING','N'),' ') presence_bedsores_exit_1_4,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_GRANULATION_LEAVING','N'),' ') presence_bedsores_exit_1_5,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_NECROTICTISSUE_LEAVING','N'),' ') presence_bedsores_exit_1_6,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_POCKET_LEAVING','N'),' ') presence_bedsores_exit_1_7,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'DT_DEPARTURE_PRESSURE_2','S'), ' ') bedsores_exit_date_2,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_DEPTH_LEAVING2','N'),' ') presence_bedsores_exit_2_1,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_EXUDATE_LEAVING2','N'),' ') presence_bedsores_exit_2_2, 
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_SIZE_LEAVING2','N'),' ') presence_bedsores_exit_2_3,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_INFLAMMATION_LEAVING2','N'),' ') presence_bedsores_exit_2_4,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_GRANULATION_LEAVING2','N'),' ') presence_bedsores_exit_2_5,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_NECROTICTISSUE_LEAVING2','N'),' ') presence_bedsores_exit_2_6,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_POCKET_LEAVING2','N'),' ') presence_bedsores_exit_2_7,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'DT_DEPARTURE_PRESSURE_3','S'), ' ') bedsores_exit_date_3,
    coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_DEPTH_LEAVING3','N'),' ') presence_bedsores_exit_3_1,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_EXUDATE_LEAVING3','N'),' ') presence_bedsores_exit_3_2, 
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_SIZE_LEAVING3','N'),' ') presence_bedsores_exit_3_3,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_INFLAMMATION_LEAVING3','N'),' ') presence_bedsores_exit_3_4,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_GRANULATION_LEAVING3','N'),' ') presence_bedsores_exit_3_5,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_NECROTICTISSUE_LEAVING3','N'),' ') presence_bedsores_exit_3_6,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_POCKET_LEAVING3','N'),' ') presence_bedsores_exit_3_7,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'DT_ADMISSION_FIM','S'), ' ') fim_entry_date_1,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'DT_ADMISSION_FIM_2','S'), ' ') fim_entry_date_2,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'DT_ADMISSION_FIM_3','S'), ' ') fim_entry_date_3,
  dpc_pkg.get_value_report4907(a.nr_sequencia,'DS_WEIGHT_ENTERING','N') fim_entry_weight_1,
  dpc_pkg.get_value_report4907(a.nr_sequencia,'DS_WEIGHT_ENTERING_2','N') fim_entry_weight_2,
  dpc_pkg.get_value_report4907(a.nr_sequencia,'DS_WEIGHT_ENTERING_3','N') fim_entry_weight_3,  
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_MEAL','N'),' ') || ' - ' || 
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_GROOMING','N'),' ') || ' - ' || 
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CHANGING_UP','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CLEANING','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CHANGING_LOW','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_SELF_TOILET','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_URINATION','N'),' ') || ' - ' ||  
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_DEFECATION','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_BED_WHEELCHAIR','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_TOILET_MOV','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_BATH_SHOWER','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_WALK_WHEELCHAIR','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_STAIRS','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_UNDERSTANDING','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_EXPRESSION','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_SOCIAL','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_PROBLEM_SOLVING','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_MEMORY','N'),' ') fim_socre_1,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_MEAL_2','N'),' ') || ' - ' || 
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_GROOMING_2','N'),' ') || ' - ' || 
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CHANGING_UP_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CLEANING_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CHANGING_LOW_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_SELF_TOILET_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_URINATION_2','N'),' ') || ' - ' ||  
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_DEFECATION_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_BED_WHEELCHAIR_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_TOILET_MOV_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_BATH_SHOWER_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_WALK_WHEELCHAIR_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_STAIRS_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_UNDERSTANDING_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_EXPRESSION_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_SOCIAL_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_PROBLEM_SOLVING_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_MEMORY_2','N'),' ') fim_socre_2,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_MEAL_3','N'),' ') || ' - ' || 
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_GROOMING_3','N'),' ') || ' - ' || 
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CHANGING_UP_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CLEANING_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CHANGING_LOW_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_SELF_TOILET_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_URINATION_3','N'),' ') || ' - ' ||  
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_DEFECATION_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_BED_WHEELCHAIR_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_TOILET_MOV_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_BATH_SHOWER_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_WALK_WHEELCHAIR_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_STAIRS_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_UNDERSTANDING_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_EXPRESSION_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_SOCIAL_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_PROBLEM_SOLVING_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_MEMORY_3','N'),' ') fim_socre_3,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'DT_LEAVING_FIM','S'), ' ') fim_exit_date_1,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'DT_LEAVING_FIM_2','S'), ' ') fim_exit_date_2,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'DT_LEAVING_FIM_3','S'), ' ') fim_exit_date_3,
  dpc_pkg.get_value_report4907(a.nr_sequencia,'DS_WHEIGHT_LEAVING','N') fim_exit_weight_1,
  dpc_pkg.get_value_report4907(a.nr_sequencia,'DS_WHEIGHT_LEAVING_2','N') fim_exit_weight_2,
  dpc_pkg.get_value_report4907(a.nr_sequencia,'DS_WHEIGHT_LEAVING_3','N') fim_exit_weight_3,  
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_MEAL_EXIT','N'),' ') || ' - ' || 
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_GROOMING_EXIT','N'),' ') || ' - ' || 
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CHANGING_UP_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CLEANING_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CHANGING_LOW_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_SELF_TOILET_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_URINATION_EXIT','N'),' ') || ' - ' ||  
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_DEFECATION_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_BED_WHEELCHAIR_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_TOILET_MOV_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_BATH_SHOWER_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_WALK_WHEELCHAIR_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_STAIRS_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_UNDERSTANDING_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_EXPRESSION_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_SOCIAL_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_PROBLEM_SOLVING_EXIT','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_MEMORY_EXIT','N'),' ') fim_score_exit_1,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_GROOMING_EXIT_2','N'),' ') || ' - ' || 
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CHANGING_UP_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CLEANING_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CHANGING_LOW_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_SELF_TOILET_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_URINATION_EXIT_2','N'),' ') || ' - ' ||  
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_DEFECATION_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_BED_WHEELCHAIR_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_TOILET_MOV_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_BATH_SHOWER_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_WALK_WHEELCHAIR_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_STAIRS_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_UNDERSTANDING_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_EXPRESSION_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_SOCIAL_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_PROBLEM_SOLVING_EXIT_2','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_MEMORY_EXIT_2','N'),' ') fim_score_exit_2,
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_GROOMING_EXIT_3','N'),' ') || ' - ' || 
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CHANGING_UP_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CLEANING_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_CHANGING_LOW_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_SELF_TOILET_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_URINATION_EXIT_3','N'),' ') || ' - ' ||  
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_DEFECATION_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_BED_WHEELCHAIR_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_TOILET_MOV_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_BATH_SHOWER_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_WALK_WHEELCHAIR_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_STAIRS_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_UNDERSTANDING_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_EXPRESSION_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_SOCIAL_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_PROBLEM_SOLVING_EXIT_3','N'),' ') || ' - ' ||
  coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'SI_FIM_MEMORY_EXIT_3','N'),' ') fim_score_exit_3
from patient_dpc_questionnaire a;

