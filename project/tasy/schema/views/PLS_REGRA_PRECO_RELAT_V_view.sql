-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_regra_preco_relat_v (ds_comando, nr_sequencia, ie_tipo_regra, ie_tipo_consulta, ie_origem_protocolo, ie_atend_pcmso) AS select 'Regra '||nr_sequencia||' '||chr(13) || chr(10)||
 'Dt início : '||to_char(dt_inicio_vigencia,'dd/mm/yyyy')||' '||chr(13) || chr(10)|| 
 CASE WHEN DT_FIM_VIGENCIA IS NULL THEN null  ELSE 'Dt fim vigência: '||to_char(dt_fim_vigencia,'dd/mm/yyyy')||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_situacao IS NULL THEN null  ELSE 'Situação: '||CASE WHEN ie_situacao='A' THEN 'Ativo'  ELSE 'Inativo' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN DS_REGRA IS NULL THEN null  ELSE 'Regra: '||ds_regra||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_grupo_servico IS NULL THEN null  ELSE 'Grupo servico '||(select b.ds_grupo ds FROM pls_preco_grupo_servico b       where b.nr_sequencia = a.nr_seq_grupo_servico)||' '||chr(13) || chr(10) END || 
 CASE WHEN CD_AREA_PROCEDIMENTO IS NULL THEN null  ELSE 'Área proc: '||( select b.ds_area_procedimento ds from area_procedimento b         where b.cd_area_procedimento = a.cd_area_procedimento)||' '||chr(13) || chr(10) END || 
 CASE WHEN CD_ESPECIALIDADE IS NULL THEN null  ELSE 'Especialdiade proc: '||( select b.ds_especialidade ds from especialidade_proc b         where b.cd_especialidade = a.cd_especialidade)||' '||chr(13) || chr(10) END || 
 CASE WHEN CD_GRUPO_PROC IS NULL THEN null  ELSE 'Grupo proc: '||( select b.ds_grupo_proc ds from grupo_proc b         where b.cd_grupo_proc = a.cd_grupo_proc)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_procedimento IS NULL THEN null  ELSE 'Procedimento: '||cd_procedimento||' - '||substr(obter_descricao_procedimento(cd_procedimento, ie_origem_proced),1,150)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_GRUPO_REC IS NULL THEN null  ELSE 'Grupo receita: '||( select b.ds_grupo_receita ds from grupo_receita b         where b.nr_sequencia = a.nr_seq_grupo_rec)||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_ORIGEM_PROCEDIMENTO IS NULL THEN null  ELSE 'Origem procedimento: '||obter_valor_dominio(30,ie_origem_procedimento)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_proc_tabela IS NULL THEN null  ELSE 'Procedimento existe na tabela de preço: '||ie_proc_tabela||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_TECNICA_UTILIZADA IS NULL THEN null  ELSE 'Técnica utilizada: '||obter_valor_dominio(1834,IE_TECNICA_UTILIZADA)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tipo_intercambio IS NULL THEN null  ELSE 'Tipo intercâmbio: '||CASE WHEN ie_tipo_intercambio='A' THEN 'Ambos' WHEN ie_tipo_intercambio='E' THEN 'Estadual'  ELSE 'Nacional' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tipo_vinculo IS NULL THEN null  ELSE 'Vínculo: '||obter_valor_dominio(2232,ie_tipo_vinculo)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_classificacao IS NULL THEN null  ELSE 'Classif prestador: '||( select b.ds_classificacao ds from PLS_CLASSIF_PRESTADOR b         where b.nr_sequencia = a.nr_seq_classificacao)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_grupo_prestador IS NULL THEN null  ELSE 'Grupo prestador: '||( select b.ds_grupo ds from PLS_preco_grupo_prestador b         where b.nr_sequencia = a.nr_seq_grupo_prestador)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_prestador IS NULL THEN null  ELSE 'Prestador executor: '||substr(pls_obter_dados_prestador(nr_seq_prestador, 'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_prestador IS NULL THEN null  ELSE 'Prestador executor(código): '||substr(pls_obter_dados_prestador(substr(pls_obter_cod_prestador(null,cd_prestador),1,255),'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_prestador_prot IS NULL THEN null  ELSE 'Prestador prot: '||substr(pls_obter_dados_prestador(substr(pls_obter_cod_prestador(null,cd_prestador_prot),1,255),'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_especialidade_prest IS NULL THEN null  ELSE 'Especialidade prest exec: '||( select b.ds_especialidade ds from especialidade_medica b         where b.cd_especialidade = a.cd_especialidade_prest)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_convenio IS NULL THEN null  ELSE 'Outro convênio: '||( select b.ds_convenio ds from convenio b         where b.cd_convenio = a.cd_convenio)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_categoria IS NULL THEN null  ELSE 'Outra categoria: '||( select b.ds_categoria ds from categoria_convenio b         where b.cd_categoria = a.cd_categoria)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_categoria IS NULL THEN null  ELSE 'Categoria: '||( select b.ds_categoria ds from pls_categoria b         where b.nr_sequencia = a.nr_seq_categoria)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_tipo_acomodacao IS NULL THEN null  ELSE 'Tipo acomocação: '||( select b.ds_tipo_acomodacao ds from pls_tipo_acomodacao b         where b.nr_sequencia = a.nr_seq_tipo_acomodacao)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_tipo_atendimento IS NULL THEN null  ELSE 'Tipo atendimento: '||( select b.ds_tipo_atendimento ds from pls_tipo_atendimento b         where b.nr_sequencia = a.nr_seq_tipo_atendimento)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_clinica IS NULL THEN null  ELSE 'Tipo internação: '||( select b.ds_clinica ds from pls_clinica b         where b.nr_sequencia = a.nr_seq_clinica)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_tipo_prestador IS NULL THEN null  ELSE 'Tipo prestador exec: '||( select b.ds_tipo_prestador ds from pls_tipo_prestador b           where b.nr_sequencia = a.nr_seq_tipo_prestador)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_tipo_prestador_prot IS NULL THEN null  ELSE 'Tipo prestador prot: '||( select b.ds_tipo_prestador ds from pls_tipo_prestador b           where b.nr_sequencia = a.nr_seq_tipo_prestador_prot)||' '||chr(13) || chr(10) END || 
 CASE WHEN QT_DIAS_INTER_INICIO IS NULL THEN null  ELSE 'Qt dias internação inicio: '||QT_DIAS_INTER_INICIO END || 
 CASE WHEN QT_DIAS_INTER_final IS NULL THEN null  ELSE 'Qt dias internação final: '||QT_DIAS_INTER_final END || 
 CASE WHEN IE_CARATER_INTERNACAO IS NULL THEN null  ELSE 'Caráter internação: '||obter_valor_dominio(2819,IE_CARATER_INTERNACAO)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tipo_guia IS NULL THEN null  ELSE 'Tipo guia: '||obter_valor_dominio(1746,ie_tipo_guia)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_CBO_SAUDE IS NULL THEN null  ELSE 'CBO saúde: '||substr(obter_cbo_saude(nr_seq_cbo_saude),1,80)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_RP_COMBINADA IS NULL THEN null  ELSE 'Pagamento diferenciado: '||( select b.nm_regra ds from pls_rp_cta_combinada b           where b.nr_sequencia = a.nr_seq_rp_combinada)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_CATEGORIA_PLANO IS NULL THEN null  ELSE 'Categoria plano: '||( select b.ds_categoria ds from pls_categoria b           where b.nr_sequencia = a.nr_seq_categoria_plano)||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_COOPERADO IS NULL THEN null  ELSE 'Médico cooperado: '||CASE WHEN ie_cooperado='S' THEN 'Cooperado'  ELSE 'Não cooperado' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_INTERNADO IS NULL THEN null  ELSE 'Internado: '||CASE WHEN ie_internado='S' THEN 'Internado'  ELSE 'Não internado' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_TAXA_COLETA IS NULL THEN null  ELSE 'Taxa coleta: '||CASE WHEN ie_taxa_coleta='S' THEN 'Taxa coleta'  ELSE 'Não taxa coleta' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_TIPO_CONTRATACAO IS NULL THEN null  ELSE 'Tipo contratação: '||obter_valor_dominio(1666,IE_TIPO_CONTRATACAO)||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_TIPO_CONTRATO IS NULL THEN null  ELSE 'Tipo de contrato intercâmbio: '||obter_valor_dominio(3769,IE_TIPO_CONTRATO)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_preco IS NULL THEN null  ELSE 'Formação preço: '||obter_valor_dominio(1669,ie_preco)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tipo_segurado IS NULL THEN null  ELSE 'Tipo beneficiário: '||obter_valor_dominio(2406,ie_tipo_segurado)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_GRUPO_CONTRATO IS NULL THEN null  ELSE 'Grupo contratos: '||( select b.ds_grupo ds from PLS_preco_grupo_contrato b         where b.nr_sequencia = a.nr_seq_grupo_contrato)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_CONTRATO IS NULL THEN null  ELSE 'Contrato: '||substr(pls_obter_dados_contrato(nr_seq_contrato, 'E'),1,170)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_GRUPO_PRODUTO IS NULL THEN null  ELSE 'Grupo de produtos: '||( select b.ds_grupo ds from PLS_preco_grupo_produto b         where b.nr_sequencia = a.nr_seq_grupo_produto)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_plano IS NULL THEN null  ELSE 'Produto: '||substr(pls_obter_dados_produto(nr_seq_plano,'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_CONGENERE_PROT IS NULL THEN null  ELSE 'Operadora protocolo: '||substr(pls_obter_nome_congenere(nr_seq_congenere_prot),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_CONGENERE IS NULL THEN null  ELSE 'Cooperativa: '||substr(pls_obter_nome_congenere(nr_seq_congenere),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_OPS_CONGENERE IS NULL THEN null  ELSE 'Congênere: '||substr(pls_obter_nome_congenere(nr_seq_ops_congenere),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_GRUPO_INTERCAMBIO IS NULL THEN null  ELSE 'Grupo intercâmbio: '||( select b.ds_grupo ds from PLS_regra_grupo_inter b         where b.nr_sequencia = a.nr_seq_grupo_intercambio)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_intercambio IS NULL THEN null  ELSE 'Intercâmbio: '||substr(pls_obter_dados_intercambio(nr_seq_intercambio,'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN qt_idade_inicial IS NULL THEN null  ELSE 'Idade inicial: '||qt_idade_inicial||' '||chr(13) || chr(10) END || 
 CASE WHEN qt_idade_final IS NULL THEN null  ELSE 'Idade final: '||qt_idade_final||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_REGRA_ATEND_CART IS NULL THEN null  ELSE 'Regra de carteirinha: '||( select b.ds_regra ds from PLS_oc_atend_carteira b         where b.nr_sequencia = a.NR_SEQ_REGRA_ATEND_CART)||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_ACOMODACAO IS NULL THEN null  ELSE 'Padrão de acomodação: '||CASE WHEN ie_acomodacao='I' THEN 'Individual' WHEN ie_acomodacao='C' THEN 'Coletivo'  ELSE 'Nenhum' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_franquia IS NULL THEN null  ELSE 'Fator moderador: '||CASE WHEN ie_franquia='S' THEN 'Sim'  ELSE 'Não' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_PCMSO IS NULL THEN null  ELSE 'Beneficiário possui PCMSO: '||CASE WHEN ie_pcmso='S' THEN 'Possuí'  ELSE 'Não possuí' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN CD_EDICAO_AMB IS NULL THEN null  ELSE 'Edição de preço: '||( select b.ds_edicao_amb ds from edicao_amb b         where b.cd_edicao_amb = a.cd_edicao_amb)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_CBHPM_EDICAO IS NULL THEN null  ELSE 'Edição CBHPM: '||( select b.ds_edicao_cbhpm ds from cbhpm_edicao b         where b.nr_sequencia = a.nr_seq_cbhpm_edicao)||' '||chr(13) || chr(10) END || 
 CASE WHEN VL_CH_HONORARIOS IS NULL THEN null  ELSE 'Ch médico: '||VL_CH_HONORARIOS||' '||chr(13) || chr(10) END || 
 CASE WHEN CD_MOEDA_CH_MEDICO IS NULL THEN null  ELSE 'Moeda Ch médico: '||( select b.ds_moeda ds from moeda b         where b.cd_moeda = a.CD_MOEDA_CH_MEDICO)||' '||chr(13) || chr(10) END || 
 CASE WHEN VL_CH_CUSTO_OPER IS NULL THEN null  ELSE 'CH custo oper: '||VL_CH_CUSTO_OPER||' '||chr(13) || chr(10) END || 
 CASE WHEN CD_MOEDA_CH_CO IS NULL THEN null  ELSE 'Moeda CH custo oper: '||( select b.ds_moeda ds from moeda b         where b.cd_moeda = a.CD_MOEDA_CH_CO)||' '||chr(13) || chr(10) END || 
 CASE WHEN VL_FILME IS NULL THEN null  ELSE 'Vl filme: '||VL_FILME||' '||chr(13) || chr(10) END || 
 CASE WHEN CD_MOEDA_FILME IS NULL THEN null  ELSE 'Moeda vl filme: '||( select b.ds_moeda ds from moeda b         where b.cd_moeda = a.CD_MOEDA_FILME)||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE_PARTIC IS NULL THEN null  ELSE 'Tx ajuste anest: '||TX_AJUSTE_PARTIC||' '||chr(13) || chr(10) END || 
 CASE WHEN CD_MOEDA_ANESTESISTA IS NULL THEN null  ELSE 'Moeda tx ajuste anest: '||( select b.ds_moeda ds from moeda b         where b.cd_moeda = a.CD_MOEDA_ANESTESISTA)||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE_CH_HONOR IS NULL THEN null  ELSE 'Tx ajuste médico: '||TX_AJUSTE_CH_HONOR||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE_CUSTO_OPER IS NULL THEN null  ELSE 'Tx ajuste custo oper: '||TX_AJUSTE_CUSTO_OPER||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE_FILME IS NULL THEN null  ELSE 'Tx ajuste filme: '||TX_AJUSTE_FILME||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE_GERAL IS NULL THEN null  ELSE 'Índice ajuste: '||TX_AJUSTE_GERAL||' '||chr(13) || chr(10) END || 
 -- decode(IE_PRECO_INFORMADO,null,null,'Obedece valor informado: '||), 
 CASE WHEN IE_NAO_GERA_TX_INTER IS NULL THEN null  ELSE 'Aplicação taxa intercâmbio: '||obter_valor_dominio(6069,IE_NAO_GERA_TX_INTER)||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_AUTOGERADO IS NULL THEN null  ELSE 'Aplicar autogerado: '||CASE WHEN ie_autogerado='S' THEN 'Sim'  ELSE 'Não' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_ch_padrao_anestesista IS NULL THEN null  ELSE 'Ch padrao anestesista: '||CASE WHEN ie_ch_padrao_anestesista='A' THEN 'Ambos' WHEN ie_ch_padrao_anestesista='M' THEN 'Ch médico'  ELSE 'Ch anestesista' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN DS_OBSERVACAO IS NULL THEN null  ELSE 'Observação: '||ds_observacao||' '||chr(13) || chr(10) END  ds_comando, 
 nr_sequencia, 
 'P' ie_tipo_regra, 
 substr(obter_valor_dominio(3435, IE_TIPO_CONSULTA),1,255) ie_tipo_consulta, 
 ie_origem_protocolo, 
 ie_atend_pcmso 
from 	pls_regra_preco_proc a 

union all
 
select 'Regra '||nr_sequencia||' '||chr(13) || chr(10)|| 
 'Dt início : '||to_char(dt_inicio_vigencia,'dd/mm/yyyy')||' '||chr(13) || chr(10)|| 
 CASE WHEN DT_FIM_VIGENCIA IS NULL THEN null  ELSE 'Dt fim vigência: '||to_char(dt_fim_vigencia,'dd/mm/yyyy')||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_situacao IS NULL THEN null  ELSE 'Situação: '||CASE WHEN ie_situacao='A' THEN 'Ativo'  ELSE 'Inativo' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN DS_REGRA IS NULL THEN null  ELSE 'Regra: '||ds_regra||' '||chr(13) || chr(10) END || 
 CASE WHEN a.NR_SEQ_GRUPO_MATERIAL IS NULL THEN null  ELSE 'Grupo material: '||( select b.ds_grupo ds from PLS_preco_grupo_material b         where b.nr_sequencia = a.nr_seq_grupo_material)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_MATERIAL IS NULL THEN null  ELSE 'Material: '||substr(obter_descricao_padrao('PLS_MATERIAL','DS_MATERIAL',nr_seq_material),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_ESTRUTURA_MAT IS NULL THEN null  ELSE 'Estrutura material: '||substr(pls_obter_desc_estrut_material(nr_seq_estrutura_mat),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tipo_despesa IS NULL THEN null  ELSE 'Tipo despesa: '||substr(obter_valor_dominio(1854,ie_tipo_despesa),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_tipo_uso IS NULL THEN null  ELSE 'Tipo de uso: '||( select b.ds_tipo_uso ds from PLS_tipo_uso_material b         where b.nr_sequencia = a.nr_seq_tipo_uso)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_generico_unimed IS NULL THEN null  ELSE 'Genérico : '||CASE WHEN ie_generico_unimed='S' THEN 'Sim'  ELSE 'Não' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_mat_autorizacao_esp IS NULL THEN null  ELSE 'Exige autorização especial : '||CASE WHEN ie_mat_autorizacao_esp='S' THEN 'Sim'  ELSE 'Não' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tipo_vinculo IS NULL THEN null  ELSE 'Vínculo: '||obter_valor_dominio(2232,ie_tipo_vinculo)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_classificacao IS NULL THEN null  ELSE 'Classif prestador: '||( select b.ds_classificacao ds from PLS_CLASSIF_PRESTADOR b         where b.nr_sequencia = a.nr_seq_classificacao)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_grupo_prestador IS NULL THEN null  ELSE 'Grupo prestador: '||( select b.ds_grupo ds from PLS_preco_grupo_prestador b         where b.nr_sequencia = a.nr_seq_grupo_prestador)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_prestador IS NULL THEN null  ELSE 'Prestador executor: '||substr(pls_obter_dados_prestador(nr_seq_prestador, 'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_prestador IS NULL THEN null  ELSE 'Prestador executor(código): '||substr(pls_obter_dados_prestador(substr(pls_obter_cod_prestador(null,cd_prestador),1,255),'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_prestador_prot IS NULL THEN null  ELSE 'Prestador prot: '||substr(pls_obter_dados_prestador(substr(pls_obter_cod_prestador(null,cd_prestador_prot),1,255),'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_especialidade_prest IS NULL THEN null  ELSE 'Especialidade prest exec: '||( select b.ds_especialidade ds from especialidade_medica b         where b.cd_especialidade = a.cd_especialidade_prest)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_convenio IS NULL THEN null  ELSE 'Outro convênio: '||( select b.ds_convenio ds from convenio b         where b.cd_convenio = a.cd_convenio)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_categoria IS NULL THEN null  ELSE 'Outra categoria: '||( select b.ds_categoria ds from categoria_convenio b         where b.cd_categoria = a.cd_categoria)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_categoria IS NULL THEN null  ELSE 'Categoria: '||( select b.ds_categoria ds from pls_categoria b         where b.nr_sequencia = a.nr_seq_categoria)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_tipo_acomodacao IS NULL THEN null  ELSE 'Tipo acomocação: '||( select b.ds_tipo_acomodacao ds from pls_tipo_acomodacao b         where b.nr_sequencia = a.nr_seq_tipo_acomodacao)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_tipo_atendimento IS NULL THEN null  ELSE 'Tipo atendimento: '||( select b.ds_tipo_atendimento ds from pls_tipo_atendimento b         where b.nr_sequencia = a.nr_seq_tipo_atendimento)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_clinica IS NULL THEN null  ELSE 'Tipo internação: '||( select b.ds_clinica ds from pls_clinica b         where b.nr_sequencia = a.nr_seq_clinica)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_tipo_prestador IS NULL THEN null  ELSE 'Tipo prestador exec: '||( select b.ds_tipo_prestador ds from pls_tipo_prestador b           where b.nr_sequencia = a.nr_seq_tipo_prestador)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_tipo_prestador_prot IS NULL THEN null  ELSE 'Tipo prestador prot: '||( select b.ds_tipo_prestador ds from pls_tipo_prestador b           where b.nr_sequencia = a.nr_seq_tipo_prestador_prot)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tipo_guia IS NULL THEN null  ELSE 'Tipo guia: '||obter_valor_dominio(1746,ie_tipo_guia)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tipo_intercambio IS NULL THEN null  ELSE 'Tipo intercâmbio: '||CASE WHEN ie_tipo_intercambio='A' THEN 'Ambos' WHEN ie_tipo_intercambio='E' THEN 'Estadual'  ELSE 'Nacional' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_COOPERADO IS NULL THEN null  ELSE 'Médico cooperado: '||CASE WHEN ie_cooperado='S' THEN 'Cooperado'  ELSE 'Não cooperado' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_INTERNADO IS NULL THEN null  ELSE 'Internado: '||CASE WHEN ie_internado='S' THEN 'Internado'  ELSE 'Não internado' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_preco IS NULL THEN null  ELSE 'Formação preço: '||obter_valor_dominio(1669,ie_preco)||' '||chr(13) || chr(10) END || 
  CASE WHEN NR_SEQ_GRUPO_PRODUTO IS NULL THEN null  ELSE 'Grupo de produtos: '||( select b.ds_grupo ds from PLS_preco_grupo_produto b         where b.nr_sequencia = a.nr_seq_grupo_produto)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_plano IS NULL THEN null  ELSE 'Produto: '||substr(pls_obter_dados_produto(nr_seq_plano,'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_GRUPO_CONTRATO IS NULL THEN null  ELSE 'Grupo contratos: '||( select b.ds_grupo ds from PLS_preco_grupo_contrato b         where b.nr_sequencia = a.nr_seq_grupo_contrato)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_CONTRATO IS NULL THEN null  ELSE 'Contrato: '||substr(pls_obter_dados_contrato(nr_seq_contrato, 'E'),1,170)||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_TIPO_CONTRATACAO IS NULL THEN null  ELSE 'Tipo contratação: '||obter_valor_dominio(1666,IE_TIPO_CONTRATACAO)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tipo_segurado IS NULL THEN null  ELSE 'Tipo beneficiário: '||obter_valor_dominio(2406,ie_tipo_segurado)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_CONGENERE_PROT IS NULL THEN null  ELSE 'Operadora protocolo: '||substr(pls_obter_nome_congenere(nr_seq_congenere_prot),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_intercambio IS NULL THEN null  ELSE 'Intercâmbio: '||substr(pls_obter_dados_intercambio(nr_seq_intercambio,'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_REGRA_ATEND_CART IS NULL THEN null  ELSE 'Regra de carteirinha: '||( select b.ds_regra ds from PLS_oc_atend_carteira b         where b.nr_sequencia = a.NR_SEQ_REGRA_ATEND_CART)||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_PCMSO IS NULL THEN null  ELSE 'Beneficiário possui PCMSO: '||CASE WHEN ie_pcmso='S' THEN 'Possuí'  ELSE 'Não possuí' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_ORIGEM_PRECO IS NULL THEN null  ELSE 'Origem preço: '||obter_valor_dominio(7309,IE_ORIGEM_PRECO)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_MATERIAL_PRECO IS NULL THEN null  ELSE 'Tabela própria: '||( select b.ds_tabela ds from pls_material_preco b         where b.nr_sequencia = a.nr_seq_material_preco)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tabela_adicional IS NULL THEN null  ELSE 'Tabela adicional: '||obter_valor_dominio(3752,IE_ORIGEM_PRECO)||' '||chr(13) || chr(10) END || 
 CASE WHEN tx_ajuste IS NULL THEN null  ELSE 'Tx ajuste: '||tx_ajuste||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE_PMC_NEUT IS NULL THEN null  ELSE 'Tx brasíndice pmc neutra: '||TX_AJUSTE_PMC_NEUT||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE_SIMPRO_PMC IS NULL THEN null  ELSE 'Tx simpro PMC: '||TX_AJUSTE_SIMPRO_PMC||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE_PMC_NEG IS NULL THEN null  ELSE 'Tx brasíndice PMC negativa: '||TX_AJUSTE_PMC_NEG||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE_TAB_PROPRIA IS NULL THEN null  ELSE 'Tx ajuste tabela: '||TX_AJUSTE_TAB_PROPRIA||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE_PMC_POS IS NULL THEN null  ELSE 'Tx brasíndice PMC positiva: '||TX_AJUSTE_PMC_POS||' '||chr(13) || chr(10) END || 
 CASE WHEN VL_NEGOCIADO IS NULL THEN null  ELSE 'Valor negociado: '||VL_NEGOCIADO||' '||chr(13) || chr(10) END || 
 CASE WHEN DT_BASE_FIXO IS NULL THEN null  ELSE 'Data base tabela fixa: '||DT_BASE_FIXO||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_TIPO_PRECO_SIMPRO IS NULL THEN null  ELSE 'Tipo preço Simpro: '||CASE WHEN ie_tipo_preco_simpro='F' THEN 'Fábrica' WHEN ie_tipo_preco_simpro='V' THEN 'Venda' WHEN ie_tipo_preco_simpro='L' THEN 'Fora de linha'  ELSE 'Não se aplica' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_TIPO_PRECO_BRASINDICE IS NULL THEN null  ELSE 'Tipo preço brasíndice: '||CASE WHEN ie_tipo_preco_brasindice='PMC' THEN 'PMC' WHEN ie_tipo_preco_brasindice='PFB' THEN 'PFB'  ELSE 'Conforme regra' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_TIPO_AJUSTE_PFB IS NULL THEN null  ELSE 'Taxa ajuste PMF: '||CASE WHEN ie_tipo_ajuste_pfb='U' THEN 'Utilizar taxa única'  ELSE 'Utilizar conjunto de taxas' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE_SIMPRO_PFB IS NULL THEN null  ELSE 'Tx única: '||TX_AJUSTE_SIMPRO_PFB||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE_PFB IS NULL THEN null  ELSE 'Tx única: '||TX_AJUSTE_PFB||' '||chr(13) || chr(10) END || 
 CASE WHEN VL_PFB_NEUTRA_SIMPRO IS NULL THEN null  ELSE 'Tx neutra: '||VL_PFB_NEUTRA_SIMPRO||' '||chr(13) || chr(10) END || 
 CASE WHEN VL_PFB_NEUTRA_BRASINDICE IS NULL THEN null  ELSE 'Tx neutra: '||VL_PFB_NEUTRA_BRASINDICE||' '||chr(13) || chr(10) END || 
 CASE WHEN VL_PFB_POSITIVA_SIMPRO IS NULL THEN null  ELSE 'Tx positiva: '||VL_PFB_POSITIVA_SIMPRO||' '||chr(13) || chr(10) END || 
 CASE WHEN VL_PFB_POSITIVA_BRASINDICE IS NULL THEN null  ELSE 'Tx positiva: '||VL_PFB_POSITIVA_BRASINDICE||' '||chr(13) || chr(10) END || 
 CASE WHEN VL_PFB_NEGATIVA_SIMPRO IS NULL THEN null  ELSE 'Tx negativa: '||VL_PFB_NEGATIVA_SIMPRO||' '||chr(13) || chr(10) END || 
 CASE WHEN VL_PFB_NEGATIVA_BRASINDICE IS NULL THEN null  ELSE 'Tx negativa: '||VL_PFB_NEGATIVA_BRASINDICE||' '||chr(13) || chr(10) END || 
 CASE WHEN VL_PFB_NAO_APLICAVEL_SIMPRO IS NULL THEN null  ELSE 'Tx não aplicável: '||VL_PFB_NAO_APLICAVEL_SIMPRO||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_NAO_GERA_TX_INTER IS NULL THEN null  ELSE 'Aplica taxa de intercâmbio: '||CASE WHEN ie_nao_gera_tx_inter='S' THEN 'Não'  ELSE 'Sim' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN DS_OBSERVACAO IS NULL THEN null  ELSE 'Observação: '||ds_observacao||' '||chr(13) || chr(10) END  ds_comando, 
 nr_sequencia, 
 'M' ie_tipo_regra, 
 '' ie_tipo_consulta, 
 ie_origem_protocolo, 
 ie_atend_pcmso 
from	pls_regra_preco_mat a 

union all
 
select 'Regra '||nr_sequencia||' '||chr(13) || chr(10)|| 
 'Dt início : '||to_char(dt_inicio_vigencia,'dd/mm/yyyy')||' '||chr(13) || chr(10)|| 
 CASE WHEN DT_FIM_VIGENCIA IS NULL THEN null  ELSE 'Dt fim vigência: '||to_char(dt_fim_vigencia,'dd/mm/yyyy')||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_situacao IS NULL THEN null  ELSE 'Situação: '||CASE WHEN ie_situacao='A' THEN 'Ativo'  ELSE 'Inativo' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN DS_REGRA IS NULL THEN null  ELSE 'Regra: '||ds_regra||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_grupo_servico IS NULL THEN null  ELSE 'Grupo servico '||(select b.ds_grupo ds from pls_preco_grupo_servico b       where b.nr_sequencia = a.nr_seq_grupo_servico)||' '||chr(13) || chr(10) END || 
 CASE WHEN CD_AREA_PROCEDIMENTO IS NULL THEN null  ELSE 'Área proc: '||( select b.ds_area_procedimento ds from area_procedimento b         where b.cd_area_procedimento = a.cd_area_procedimento)||' '||chr(13) || chr(10) END || 
 CASE WHEN CD_ESPECIALIDADE IS NULL THEN null  ELSE 'Especialdiade proc: '||( select b.ds_especialidade ds from especialidade_proc b         where b.cd_especialidade = a.cd_especialidade)||' '||chr(13) || chr(10) END || 
 CASE WHEN CD_GRUPO_PROC IS NULL THEN null  ELSE 'Grupo proc: '||( select b.ds_grupo_proc ds from grupo_proc b         where b.cd_grupo_proc = a.cd_grupo_proc)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_procedimento IS NULL THEN null  ELSE 'Procedimento: '||cd_procedimento||' - '||substr(obter_descricao_procedimento(cd_procedimento, ie_origem_proced),1,150)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_GRUPO_REC IS NULL THEN null  ELSE 'Grupo receita: '||( select b.ds_grupo_receita ds from grupo_receita b         where b.nr_sequencia = a.nr_seq_grupo_rec)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tipo_intercambio IS NULL THEN null  ELSE 'Tipo intercâmbio: '||CASE WHEN ie_tipo_intercambio='A' THEN 'Ambos' WHEN ie_tipo_intercambio='E' THEN 'Estadual'  ELSE 'Nacional' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tipo_vinculo IS NULL THEN null  ELSE 'Vínculo: '||obter_valor_dominio(2232,ie_tipo_vinculo)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_classificacao IS NULL THEN null  ELSE 'Classif prestador: '||( select b.ds_classificacao ds from PLS_CLASSIF_PRESTADOR b         where b.nr_sequencia = a.nr_seq_classificacao)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_grupo_prestador IS NULL THEN null  ELSE 'Grupo prestador: '||( select b.ds_grupo ds from PLS_preco_grupo_prestador b         where b.nr_sequencia = a.nr_seq_grupo_prestador)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_prestador IS NULL THEN null  ELSE 'Prestador executor: '||substr(pls_obter_dados_prestador(nr_seq_prestador, 'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_prestador IS NULL THEN null  ELSE 'Prestador executor(código): '||substr(pls_obter_dados_prestador(substr(pls_obter_cod_prestador(null,cd_prestador),1,255),'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_prestador_prot IS NULL THEN null  ELSE 'Prestador prot: '||substr(pls_obter_dados_prestador(substr(pls_obter_cod_prestador(null,cd_prestador_prot),1,255),'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN cd_especialidade_prest IS NULL THEN null  ELSE 'Especialidade prest exec: '||( select b.ds_especialidade ds from especialidade_medica b         where b.cd_especialidade = a.cd_especialidade_prest)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_categoria IS NULL THEN null  ELSE 'Categoria: '||( select b.ds_categoria ds from pls_categoria b         where b.nr_sequencia = a.nr_seq_categoria)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_tipo_acomodacao IS NULL THEN null  ELSE 'Tipo acomocação: '||( select b.ds_tipo_acomodacao ds from pls_tipo_acomodacao b         where b.nr_sequencia = a.nr_seq_tipo_acomodacao)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_tipo_atendimento IS NULL THEN null  ELSE 'Tipo atendimento: '||( select b.ds_tipo_atendimento ds from pls_tipo_atendimento b         where b.nr_sequencia = a.nr_seq_tipo_atendimento)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_clinica IS NULL THEN null  ELSE 'Tipo internação: '||( select b.ds_clinica ds from pls_clinica b         where b.nr_sequencia = a.nr_seq_clinica)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_tipo_prestador IS NULL THEN null  ELSE 'Tipo prestador exec: '||( select b.ds_tipo_prestador ds from pls_tipo_prestador b           where b.nr_sequencia = a.nr_seq_tipo_prestador)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_tipo_prestador_prot IS NULL THEN null  ELSE 'Tipo prestador prot: '||( select b.ds_tipo_prestador ds from pls_tipo_prestador b           where b.nr_sequencia = a.nr_seq_tipo_prestador_prot)||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_CARATER_INTERNACAO IS NULL THEN null  ELSE 'Caráter internação: '||obter_valor_dominio(2819,IE_CARATER_INTERNACAO)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tipo_guia IS NULL THEN null  ELSE 'Tipo guia: '||obter_valor_dominio(1746,ie_tipo_guia)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_CBO_SAUDE IS NULL THEN null  ELSE 'CBO saúde: '||substr(obter_cbo_saude(nr_seq_cbo_saude),1,80)||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_COOPERADO IS NULL THEN null  ELSE 'Médico cooperado: '||CASE WHEN ie_cooperado='S' THEN 'Cooperado'  ELSE 'Não cooperado' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_INTERNADO IS NULL THEN null  ELSE 'Internado: '||CASE WHEN ie_internado='S' THEN 'Internado'  ELSE 'Não internado' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_TIPO_CONTRATACAO IS NULL THEN null  ELSE 'Tipo contratação: '||obter_valor_dominio(1666,IE_TIPO_CONTRATACAO)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_preco IS NULL THEN null  ELSE 'Formação preço: '||obter_valor_dominio(1669,ie_preco)||' '||chr(13) || chr(10) END || 
 CASE WHEN ie_tipo_segurado IS NULL THEN null  ELSE 'Tipo beneficiário: '||obter_valor_dominio(2406,ie_tipo_segurado)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_GRUPO_CONTRATO IS NULL THEN null  ELSE 'Grupo contratos: '||( select b.ds_grupo ds from PLS_preco_grupo_contrato b         where b.nr_sequencia = a.nr_seq_grupo_contrato)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_CONTRATO IS NULL THEN null  ELSE 'Contrato: '||substr(pls_obter_dados_contrato(nr_seq_contrato, 'E'),1,170)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_GRUPO_PRODUTO IS NULL THEN null  ELSE 'Grupo de produtos: '||( select b.ds_grupo ds from PLS_preco_grupo_produto b         where b.nr_sequencia = a.nr_seq_grupo_produto)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_plano IS NULL THEN null  ELSE 'Produto: '||substr(pls_obter_dados_produto(nr_seq_plano,'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_CONGENERE_PROT IS NULL THEN null  ELSE 'Operadora protocolo: '||substr(pls_obter_nome_congenere(nr_seq_congenere_prot),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_CONGENERE IS NULL THEN null  ELSE 'Cooperativa: '||substr(pls_obter_nome_congenere(nr_seq_congenere),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_GRUPO_INTERCAMBIO IS NULL THEN null  ELSE 'Grupo intercâmbio: '||( select b.ds_grupo ds from PLS_regra_grupo_inter b         where b.nr_sequencia = a.nr_seq_grupo_intercambio)||' '||chr(13) || chr(10) END || 
 CASE WHEN nr_seq_intercambio IS NULL THEN null  ELSE 'Intercâmbio: '||substr(pls_obter_dados_intercambio(nr_seq_intercambio,'N'),1,255)||' '||chr(13) || chr(10) END || 
 CASE WHEN NR_SEQ_REGRA_ATEND_CART IS NULL THEN null  ELSE 'Regra de carteirinha: '||( select b.ds_regra ds from PLS_oc_atend_carteira b         where b.nr_sequencia = a.NR_SEQ_REGRA_ATEND_CART)||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_ACOMODACAO IS NULL THEN null  ELSE 'Padrão de acomodação: '||CASE WHEN ie_acomodacao='I' THEN 'Individual' WHEN ie_acomodacao='C' THEN 'Coletivo'  ELSE 'Nenhum' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_PCMSO IS NULL THEN null  ELSE 'Beneficiário possui PCMSO: '||CASE WHEN ie_pcmso='S' THEN 'Possuí'  ELSE 'Não possuí' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN CD_TABELA_SERVICO IS NULL THEN null  ELSE 'Tabela serviço: '||( select b.ds_tabela_servico ds from tabela_servico b 							  where b.cd_tabela_servico = a.cd_tabela_servico 								and	a.cd_estabelecimento = b.cd_estabelecimento)||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE IS NULL THEN null  ELSE 'Índice ajuste: '||tx_ajuste||' '||chr(13) || chr(10) END || 
 CASE WHEN VL_NEGOCIADO IS NULL THEN null  ELSE 'Vl negociado: '||vl_negociado||' '||chr(13) || chr(10) END || 
 CASE WHEN TX_AJUSTE_PRECO IS NULL THEN null  ELSE 'Tx ajuste preço: '||tx_ajuste_preco||' '||chr(13) || chr(10) END || 
 CASE WHEN CD_MOEDA IS NULL THEN null  ELSE 'Moeda serv: '||( select b.ds_moeda ds from moeda b 			where b.cd_moeda = a.CD_MOEDA)||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_AUTOGERADO IS NULL THEN null  ELSE 'Aplicar autogerado: '||CASE WHEN ie_autogerado='S' THEN 'Sim'  ELSE 'Não' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN IE_NAO_GERA_TX_INTER IS NULL THEN null  ELSE 'Aplica taxa de intercâmbio: '||CASE WHEN ie_nao_gera_tx_inter='S' THEN 'Não'  ELSE 'Sim' END ||' '||chr(13) || chr(10) END || 
 CASE WHEN DS_OBSERVACAO IS NULL THEN null  ELSE 'Observação: '||ds_observacao||' '||chr(13) || chr(10) END  ds_comando, 
 nr_sequencia, 
 'S' ie_tipo_regra, 
 '' ie_tipo_consulta, 
 ie_origem_protocolo, 
 ie_atend_pcmso 
from pls_regra_preco_servico a;

