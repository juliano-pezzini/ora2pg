-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW capa_ficha_financ_col_v (nr_seq_capa, ds_col1, ds_col2, ds_col3, ds_col4, ds_col5, ds_col6, ds_col7, ds_col8, ds_col9, ds_col10, qt_coluna) AS select	nr_seq_capa,
	substr(max(CASE WHEN nr_col=1 THEN ds_coluna  ELSE null END ),1,255) ds_col1,
	substr(max(CASE WHEN nr_col=2 THEN ds_coluna  ELSE null END ),1,255) ds_col2,
	substr(max(CASE WHEN nr_col=3 THEN ds_coluna  ELSE null END ),1,255) ds_col3,
	substr(max(CASE WHEN nr_col=4 THEN ds_coluna  ELSE null END ),1,255) ds_col4,
	substr(max(CASE WHEN nr_col=5 THEN ds_coluna  ELSE null END ),1,255) ds_col5,
	substr(max(CASE WHEN nr_col=6 THEN ds_coluna  ELSE null END ),1,255) ds_col6,
	substr(max(CASE WHEN nr_col=7 THEN ds_coluna  ELSE null END ),1,255) ds_col7,
	substr(max(CASE WHEN nr_col=8 THEN ds_coluna  ELSE null END ),1,255) ds_col8,
	substr(max(CASE WHEN nr_col=9 THEN ds_coluna  ELSE null END ),1,255) ds_col9,
	substr(max(CASE WHEN nr_col=10 THEN ds_coluna  ELSE null END ),1,255) ds_col10,
	count(*) qt_coluna
FROM (	select	nr_seq_capa,
		nr_sequencia,
		ds_coluna,
		nr_ordem_apres,
		row_number() OVER () AS nr_col
	from (	select	a.nr_seq_capa,
			a.nr_sequencia,
			a.ds_coluna,
			a.nr_ordem_apres
		from	capa_ficha_financ_col a
		order by	coalesce(nr_ordem_apres,0),
			a.nr_sequencia) alias22) alias23
group by	nr_seq_capa;

