-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW bft_order_v (prescription_number, ordering_provider_id_number, procedure_name, encounter_id, ordering_provider_given_name, ordering_provider_last_name, ordering_provider_middle_name, requested_date_time, release_date_time, suspended_time, nr_prescricao, notes, clinical_notes) AS select	b.nr_prescricao prescription_number,
	        b.cd_medico ordering_provider_id_number, 
        	obter_desc_proc_interno(a.nr_seq_proc_interno) procedure_name,
        	b.nr_atendimento encounter_id,  
        	obter_dados_pf(b.cd_medico,'PNG') ordering_provider_given_name,
        	obter_dados_pf(b.cd_medico,'PNL') ordering_provider_last_name,
        	obter_dados_pf(b.cd_medico,'PNM') ordering_provider_middle_name,
        	b.dt_prescricao requested_date_time,  
        	b.dt_liberacao release_date_time,
          b.dt_suspensao suspended_time,
        	b.nr_prescricao,    
        	coalesce(a.ds_observacao, b.ds_observacao) notes,  
        	coalesce(a.ds_dado_clinico, b.ds_dado_clinico) clinical_notes
FROM    	prescr_procedimento a,	
        	prescr_medica b
where   	a.nr_prescricao = b.nr_prescricao;

