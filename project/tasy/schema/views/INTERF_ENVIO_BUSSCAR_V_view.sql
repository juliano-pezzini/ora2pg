-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW interf_envio_busscar_v (tp_registro, ds_constante, cd_interno, cd_cnpj_hospital, nr_seq_protocolo, nr_nota_fiscal, nr_serie_nf, nr_interno_conta, cd_empresa, cd_cnpj_convenio, cd_usuario_convenio, nm_funcionario, nm_paciente, ie_servico_prestado, cd_categoria, cd_plano, ie_tipo_atendimento, cd_procedimento, ds_procedimento, ie_clinica, ie_internado, ie_cirurgia, dt_atendimento, dt_pagamento, vl_procedimento, vl_adicional) AS select 	1				tp_registro,
	' '				ds_constante,
	substr(c.cd_interno,1,5)	cd_interno,
	c.cd_cgc_hospital		cd_cnpj_hospital,
	c.nr_seq_protocolo		nr_seq_protocolo,
	0				nr_nota_fiscal,
	' '				nr_serie_nf,
	c.nr_interno_conta		nr_interno_conta,
	'   '				cd_empresa,
	c.cd_cgc_convenio		cd_cnpj_convenio,
	substr(c.cd_usuario_convenio,1,13) cd_usuario_convenio,
	lpad(' ',40, ' ')		nm_funcionario,
	substr(c.nm_paciente,1,40)	nm_paciente,
	c.cd_dependente			ie_servico_prestado,
	lpad(c.cd_categoria_convenio,2,'0') cd_categoria,
	lpad(c.cd_plano_convenio,2,'0')	cd_plano,
	c.ie_tipo_atendimento		ie_tipo_atendimento,
	lpad(substr(i.cd_item_convenio,1,8),8,'0') cd_procedimento,
	substr(i.ds_item,1,60)		ds_procedimento,
	c.ie_clinica			ie_clinica,
	' '				ie_internado,
	' '				ie_cirurgia,
	c.dt_entrada			dt_atendimento,
	h.dt_vencimento			dt_pagamento,
	i.vl_total_item			vl_procedimento,
	0				vl_adicional
FROM 	w_interf_conta_header	h,
	w_interf_conta_cab	c,
	w_interf_conta_item	i
where 	c.nr_interno_conta = i.nr_interno_conta
and 	h.nr_seq_protocolo = c.nr_seq_protocolo
and 	i.ie_tipo_item	= 1;

