-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW interf_envio_itaipu_bio_v (tp_registro, cd_registro, dt_geracao, cd_empresa, cd_matricula, cd_dependente, nm_paciente, dt_atendimento, cd_convenio, cd_cpf_medico, nm_medico, nr_crm_medico, cd_procedimento, ie_funcao, ds_espaco, qt_procedimento, qt_utilizado, vl_procedimento, nr_conta, cd_centro_custo, nr_doc_convenio, ie_tipo_guia, dt_emissao_guia, cd_cid1, cd_cid2, cd_cid3, cd_cid4, nr_doc_conv_principal, cd_edicao_amb, nr_seq_lote_protocolo, dt_mesano_referencia, hr_mesano_referencia, ds_zeros, ie_tipo_atendimento, cd_tipo_acomodacao, dt_entrada, hr_entrada, dt_alta, hr_alta, ie_clinica, ie_regime_inter, id_int_obstetricia_1, id_int_obstetricia_2, id_int_obstetricia_3, id_int_obstetricia_4, id_int_obstetricia_5, id_int_obstetricia_6, id_int_obstetricia_7, id_int_obstetricia_8, id_int_obstetricia_9, id_int_obstetricia_10, obito_mulher, qt_obito_nasc_precoce, qt_obito_nasc_tardio, nr_declaracao_vivos, qt_nasc_vivo_termo, qt_nasc_mortos, qt_nasc_vivo_prematuro, ie_acidente, cd_motivo_alta, cd_cid_obito, nr_declaracao_obito, tp_faturamento, vl_diarias, vl_taxas, vl_materiais, vl_medicamentos, vl_gases, vl_total, nr_seq_protocolo) AS select
	0						tp_registro, 
	0						cd_registro, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_geracao, 
	' '						cd_empresa, 
	0						cd_matricula, 
	0						cd_dependente, 
	' '						nm_paciente, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_atendimento, 
	' '						cd_convenio, 
	' '						cd_cpf_medico, 
	' '						nm_medico, 
	' '						nr_crm_medico, 
	' '						cd_procedimento, 
	' '						ie_funcao, 
	' '						ds_espaco, 
	0						qt_procedimento, 
	0						qt_utilizado, 
	0						vl_procedimento, 
	0						nr_conta, 
	' '						cd_centro_custo, 
	' '						nr_doc_convenio, 
	' '						ie_tipo_guia, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_emissao_guia, 
	' '						cd_cid1, 
	' '						cd_cid2, 
	' ' 						cd_cid3, 
	' ' 						cd_cid4, 
	' '						nr_doc_conv_principal, 
	' '						cd_edicao_amb, 
	0						nr_seq_lote_protocolo, 
	' '						dt_mesano_referencia, 
	' '						hr_mesano_referencia, 
	'0'						ds_zeros, 
	0						ie_tipo_atendimento, 
	' '						cd_tipo_acomodacao, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_entrada, 
	to_char(LOCALTIMESTAMP, 'hh24mi')			hr_entrada, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_alta, 
	to_char(LOCALTIMESTAMP, 'hh24mi')			hr_alta, 
	0						ie_clinica, 
	0						ie_regime_inter, 
	' '						id_int_obstetricia_1, 
	' '						id_int_obstetricia_2, 
	' '						id_int_obstetricia_3, 
	' '						id_int_obstetricia_4, 
	' '						id_int_obstetricia_5, 
	' '						id_int_obstetricia_6, 
	' '						id_int_obstetricia_7, 
	' '						id_int_obstetricia_8, 
	' '						id_int_obstetricia_9, 
	' '						id_int_obstetricia_10, 
	' '						obito_mulher, 
	0						qt_obito_nasc_precoce, 
	0						qt_obito_nasc_tardio, 
	' '						nr_declaracao_vivos, 
	0						qt_nasc_vivo_termo, 
	0						qt_nasc_mortos, 
	0						qt_nasc_vivo_prematuro, 
	0						ie_acidente, 
	0						cd_motivo_alta, 
	' '						cd_cid_obito, 
	' '						nr_declaracao_obito, 
	' '						tp_faturamento, 
	0						vl_diarias, 
	0						vl_taxas, 
	0						vl_materiais, 
	0						vl_medicamentos, 
	0						vl_gases, 
	0						vl_total,	 
	a.nr_seq_protocolo				nr_seq_protocolo 
FROM	w_interf_conta_header a 

union all
 
 /* Detalhe */
 
select 
	1						tp_registro, 
	1						cd_registro, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_geracao, 
	substr(a.cd_empresa_referencia,1,3)		cd_empresa, 
	coalesce(somente_numero(a.cd_usuario_convenio),0)	cd_matricula, 
	a.cd_dependente					cd_dependente, 
	substr(a.nm_paciente,1,30)			nm_paciente, 
	to_char(a.dt_entrada, 'yyyymmdd')		dt_atendimento, 
	'0536H'						cd_convenio, 
	coalesce(b.nr_cpf_executor,' ')			cd_cpf_medico, 
	coalesce(substr(b.nm_medico_executor,1,30),' ')	nm_medico, 
	coalesce(substr(b.nr_crm_executor,1,5),' ')		nr_crm_medico, 
	coalesce(substr(b.cd_item_convenio,1,8),' ')		cd_procedimento, 
	substr(b.cd_funcao_executor,1,2)		ie_funcao, 
	' '						ds_espaco, 
	sum(b.qt_item * 100)				qt_procedimento, 
	sum(b.qt_filme * 100)				qt_utilizado, 
	sum(b.vl_total_item * 100)			vl_procedimento, 
	b.nr_interno_conta				nr_conta, 
	coalesce(substr(obter_centro_custo_setor(b.cd_setor_atendimento, 'C'),1,6),' ') 
							cd_centro_custo, 
	b.nr_doc_convenio				nr_doc_convenio, 
	d.ie_tipo_guia					ie_tipo_guia, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_emissao_guia, 
	substr(a.cd_cid_principal,1,5)			cd_cid1, 
	substr(a.cd_cid_secundario,1,5)			cd_cid2, 
	' ' 						cd_cid3, 
	' ' 						cd_cid4, 
	b.nr_doc_convenio				nr_doc_conv_principal, 
	substr((select max(x.cd_edicao_amb) from procedimento_paciente x where x.nr_sequencia = b.nr_sequencia),1,2) 
							cd_edicao_amb, 
	a.nr_seq_protocolo				nr_seq_lote_protocolo, 
	(select max(to_char(x.dt_mesano_referencia,'yyyymmdd')) from protocolo_convenio x where x.nr_seq_protocolo = a.nr_seq_protocolo) 
							dt_mesano_referencia, 
	(select max(to_char(x.dt_mesano_referencia,'hh24mi')) from protocolo_convenio x where x.nr_seq_protocolo = a.nr_seq_protocolo) 
							hr_mesano_referencia, 
	'000000000000000000000000000000000000000000'	ds_zeros, 
	a.ie_tipo_atendimento				ie_tipo_atendimento, 
	substr(obter_tipo_acomod_atend(a.nr_atendimento, 'C'),1,2) 
							cd_tipo_acomodacao, 
	to_char(a.dt_entrada,'yyyymmdd')		dt_entrada, 
	to_char(a.dt_entrada,'hh24mi')			hr_entrada, 
	to_char(a.dt_alta,'yyyymmdd')			dt_alta, 
	to_char(a.dt_alta,'hh24mi')			hr_alta, 
	a.ie_clinica					ie_clinica, 
	1						ie_regime_inter, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'1'),1,1) id_int_obstetricia_1, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'2'),1,1) id_int_obstetricia_2, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'3'),1,1) id_int_obstetricia_3, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'4'),1,1) id_int_obstetricia_4, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'5'),1,1) id_int_obstetricia_5, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'6'),1,1) id_int_obstetricia_6, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'7'),1,1) id_int_obstetricia_7, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'8'),1,1) id_int_obstetricia_8, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'9'),1,1) id_int_obstetricia_9, 
	' '						id_int_obstetricia_10, 
	'0'						obito_mulher, 
	CASE WHEN a.ie_tipo_nascimento=8 THEN 1  ELSE 0 END 		qt_obito_nasc_precoce, 
	CASE WHEN a.ie_tipo_nascimento=7 THEN 1  ELSE 0 END 		qt_obito_nasc_tardio, 
	substr(obter_dnv_nascimento(a.nr_atendimento),1,15) 
							nr_declaracao_vivos, 
	CASE WHEN a.ie_tipo_nascimento=4 THEN 1  ELSE 0 END 		qt_nasc_vivo_termo, 
	CASE WHEN a.ie_tipo_nascimento=5 THEN 1  ELSE 0 END 		qt_nasc_mortos, 
	CASE WHEN a.ie_tipo_nascimento=3 THEN 1  ELSE 0 END 		qt_nasc_vivo_prematuro, 
	obter_acidente_tiss_atend(a.nr_atendimento)	ie_acidente, 
	a.cd_motivo_alta				cd_motivo_alta, 
	substr(obter_cid_obito(a.nr_atendimento),1,7)	cd_cid_obito, 
	substr(Obter_Declaracao_Obito(a.nr_atendimento),1,7) 
							nr_declaracao_obito, 
	'T'						tp_faturamento, 
	0						vl_diarias, 
	0						vl_taxas, 
	0						vl_materiais, 
	0						vl_medicamentos, 
	0						vl_gases, 
	0						vl_total,	 
	a.nr_seq_protocolo				nr_seq_protocolo	 
FROM w_interf_conta_cab a, w_interf_conta_item b
LEFT OUTER JOIN w_interf_conta_autor d ON (b.nr_interno_conta = d.nr_interno_conta)
WHERE b.nr_interno_conta	= a.nr_interno_conta  and b.ie_tipo_item	= 1 group by 
	substr(a.cd_empresa_referencia,1,3), 
	coalesce(somente_numero(a.cd_usuario_convenio),0), 
	a.cd_dependente, 
	substr(a.nm_paciente,1,30), 
	to_char(a.dt_entrada,'yyyymmdd'), 
	coalesce(b.nr_cpf_executor,' '), 
	coalesce(substr(b.nm_medico_executor,1,30),' '), 
	coalesce(substr(b.nr_crm_executor,1,5),' '), 
	coalesce(substr(b.cd_item_convenio,1,8),' '), 
	substr(b.cd_funcao_executor,1,2), 
	b.nr_interno_conta, 
	substr(obter_centro_custo_setor(b.cd_setor_atendimento, 'C'),1,6), 
	b.nr_doc_convenio, 
	d.ie_tipo_guia, 
	substr(a.cd_cid_principal,1,5), 
	substr(a.cd_cid_secundario,1,5), 
	b.nr_doc_convenio, 
	a.nr_seq_protocolo, 
	a.ie_tipo_atendimento, 
	substr(obter_tipo_acomod_atend(a.nr_atendimento, 'C'),1,2), 
	to_char(a.dt_entrada,'yyyymmdd'), 
	to_char(a.dt_entrada,'hh24mi'), 
	to_char(a.dt_alta,'yyyymmdd'), 
	to_char(a.dt_alta,'hh24mi'), 
	a.ie_clinica, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'1'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'2'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'3'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'4'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'5'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'6'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'7'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'8'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'9'),1,1), 
	CASE WHEN a.ie_tipo_nascimento=8 THEN 1  ELSE 0 END , 
	CASE WHEN a.ie_tipo_nascimento=7 THEN 1  ELSE 0 END , 
	substr(obter_dnv_nascimento(a.nr_atendimento),1,15), 
	CASE WHEN a.ie_tipo_nascimento=4 THEN 1  ELSE 0 END , 
	CASE WHEN a.ie_tipo_nascimento=5 THEN 1  ELSE 0 END , 
	CASE WHEN a.ie_tipo_nascimento=3 THEN 1  ELSE 0 END , 
	obter_acidente_tiss_atend(a.nr_atendimento), 
	a.cd_motivo_alta, 
	substr(obter_cid_obito(a.nr_atendimento),1,7), 
	substr(Obter_Declaracao_Obito(a.nr_atendimento),1,7), 
	b.nr_sequencia 

union all
 
 /* Guia Resumo */
 
select 
	2						tp_registro, 
	2						cd_registro, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_geracao, 
	substr(a.cd_empresa_referencia,1,3)		cd_empresa, 
	coalesce(somente_numero(a.cd_usuario_convenio),0)	cd_matricula, 
	a.cd_dependente					cd_dependente, 
	substr(a.nm_paciente,1,30)			nm_paciente, 
	to_char(a.dt_entrada,'yyyymmdd')		dt_atendimento, 
	'0536H'						cd_convenio, 
	coalesce(b.nr_cpf_executor,' ')			cd_cpf_medico, 
	coalesce(substr(b.nm_medico_executor,1,30),' ')	nm_medico, 
	coalesce(substr(b.nr_crm_executor,1,5),' ')		nr_crm_medico, 
	coalesce(substr(b.cd_item_convenio,1,8),' ')		cd_procedimento, 
	substr(b.cd_funcao_executor,1,2)		ie_funcao, 
	' '						ds_espaco, 
	sum(b.qt_item * 100)				qt_procedimento, 
	sum(b.qt_filme * 100)				qt_utilizado, 
	sum(b.vl_total_item * 100)			vl_procedimento, 
	b.nr_interno_conta				nr_conta, 
	coalesce(substr(obter_centro_custo_setor(b.cd_setor_atendimento, 'C'),1,6),' ') 
							cd_centro_custo, 
	b.nr_doc_convenio				nr_doc_convenio, 
	d.ie_tipo_guia					ie_tipo_guia, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_emissao_guia, 
	substr(a.cd_cid_principal,1,5)			cd_cid1, 
	substr(a.cd_cid_secundario,1,5)			cd_cid2, 
	' ' 						cd_cid3, 
	' ' 						cd_cid4, 
	b.nr_doc_convenio				nr_doc_conv_principal, 
	substr((select max(x.cd_edicao_amb) from procedimento_paciente x where x.nr_sequencia = b.nr_sequencia),1,2) 
							cd_edicao_amb, 
	a.nr_seq_protocolo				nr_seq_lote_protocolo, 
	(select max(to_char(x.dt_mesano_referencia,'yyyymmdd')) from protocolo_convenio x where x.nr_seq_protocolo = a.nr_seq_protocolo) 
							dt_mesano_referencia, 
	(select max(to_char(x.dt_mesano_referencia,'hh24mi')) from protocolo_convenio x where x.nr_seq_protocolo = a.nr_seq_protocolo) 
							hr_mesano_referencia, 
	'000000000000000000000000000000000000000000'	ds_zeros, 
	a.ie_tipo_atendimento				ie_tipo_atendimento, 
	substr(obter_tipo_acomod_atend(a.nr_atendimento, 'C'),1,2) 
							cd_tipo_acomodacao, 
	to_char(a.dt_entrada,'yyyymmdd')		dt_entrada, 
	to_char(a.dt_entrada,'hh24mi')			hr_entrada, 
	to_char(a.dt_alta,'yyyymmdd')			dt_alta, 
	to_char(a.dt_entrada,'hh24mi')			hr_alta, 
	a.ie_clinica					ie_clinica, 
	1						ie_regime_inter, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'1'),1,1) id_int_obstetricia_1, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'2'),1,1) id_int_obstetricia_2, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'3'),1,1) id_int_obstetricia_3, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'4'),1,1) id_int_obstetricia_4, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'5'),1,1) id_int_obstetricia_5, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'6'),1,1) id_int_obstetricia_6, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'7'),1,1) id_int_obstetricia_7, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'8'),1,1) id_int_obstetricia_8, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'9'),1,1) id_int_obstetricia_9, 
	' '						id_int_obstetricia_10, 
	'0'						obito_mulher, 
	CASE WHEN a.ie_tipo_nascimento=8 THEN 1  ELSE 0 END 		qt_obito_nasc_precoce, 
	CASE WHEN a.ie_tipo_nascimento=7 THEN 1  ELSE 0 END 		qt_obito_nasc_tardio, 
	substr(obter_dnv_nascimento(a.nr_atendimento),1,15) 
							nr_declaracao_vivos, 
	CASE WHEN a.ie_tipo_nascimento=4 THEN 1  ELSE 0 END 		qt_nasc_vivo_termo, 
	CASE WHEN a.ie_tipo_nascimento=5 THEN 1  ELSE 0 END 		qt_nasc_mortos, 
	CASE WHEN a.ie_tipo_nascimento=3 THEN 1  ELSE 0 END 		qt_nasc_vivo_prematuro, 
	obter_acidente_tiss_atend(a.nr_atendimento)	ie_acidente, 
	a.cd_motivo_alta				cd_motivo_alta, 
	substr(obter_cid_obito(a.nr_atendimento),1,7)	cd_cid_obito, 
	substr(Obter_Declaracao_Obito(a.nr_atendimento),1,7) 
							nr_declaracao_obito, 
	'T'						tp_faturamento, 
	sum(e.vl_diarias)				vl_diarias, 
	sum(e.vl_taxas)					vl_taxas, 
	sum(e.vl_materiais)				vl_materiais, 
	sum(e.vl_medicamentos)				vl_medicamentos, 
	0						vl_gases, 
	sum(e.vl_total_conta)				vl_total,	 
	a.nr_seq_protocolo				nr_seq_protocolo	 
FROM w_interf_conta_cab a, w_interf_conta_item b
LEFT OUTER JOIN w_interf_conta_autor d ON (b.nr_interno_conta = d.nr_interno_conta)
LEFT OUTER JOIN w_interf_conta_total e ON (b.nr_interno_conta = e.nr_interno_conta)
WHERE b.nr_interno_conta	= a.nr_interno_conta   and b.ie_tipo_item	= 1 group by 
	substr(a.cd_empresa_referencia,1,3), 
	coalesce(somente_numero(a.cd_usuario_convenio),0), 
	a.cd_dependente, 
	substr(a.nm_paciente,1,30), 
	trunc(a.dt_entrada), 
	coalesce(b.nr_cpf_executor,' '), 
	coalesce(substr(b.nm_medico_executor,1,30),' '), 
	coalesce(substr(b.nr_crm_executor,1,5),' '), 
	coalesce(substr(b.cd_item_convenio,1,8),' '), 
	substr(b.cd_funcao_executor,1,2), 
	b.nr_interno_conta, 
	substr(obter_centro_custo_setor(b.cd_setor_atendimento, 'C'),1,6), 
	b.nr_doc_convenio, 
	d.ie_tipo_guia, 
	substr(a.cd_cid_principal,1,5), 
	substr(a.cd_cid_secundario,1,5), 
	b.nr_doc_convenio, 
	a.nr_seq_protocolo, 
	a.ie_tipo_atendimento, 
	substr(obter_tipo_acomod_atend(a.nr_atendimento, 'C'),1,2), 
	to_char(a.dt_entrada,'yyyymmdd'), 
	to_char(a.dt_entrada,'hh24mi'), 
	to_char(a.dt_alta,'yyyymmdd'), 
	to_char(a.dt_entrada,'hh24mi'), 
	a.ie_clinica, 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'1'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'2'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'3'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'4'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'5'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'6'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'7'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'8'),1,1), 
	substr(obter_dados_int_obstetrica(b.nr_atendimento,'9'),1,1), 
	CASE WHEN a.ie_tipo_nascimento=8 THEN 1  ELSE 0 END , 
	CASE WHEN a.ie_tipo_nascimento=7 THEN 1  ELSE 0 END , 
	substr(obter_dnv_nascimento(a.nr_atendimento),1,15), 
	CASE WHEN a.ie_tipo_nascimento=4 THEN 1  ELSE 0 END , 
	CASE WHEN a.ie_tipo_nascimento=5 THEN 1  ELSE 0 END , 
	CASE WHEN a.ie_tipo_nascimento=3 THEN 1  ELSE 0 END , 
	obter_acidente_tiss_atend(a.nr_atendimento), 
	a.cd_motivo_alta, 
	substr(obter_cid_obito(a.nr_atendimento),1,7), 
	substr(Obter_Declaracao_Obito(a.nr_atendimento),1,7), 
	b.nr_sequencia 

union all
 
 /* Trailler do Arquivo */
 
select 
	9						tp_registro, 
	9						cd_registro, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_geracao, 
	' '						cd_empresa, 
	0						cd_matricula, 
	0						cd_dependente, 
	' '						nm_paciente, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_atendimento, 
	' '						cd_convenio, 
	' '						cd_cpf_medico, 
	' '						nm_medico, 
	' '						nr_crm_medico, 
	' '						cd_procedimento, 
	' '						ie_funcao, 
	' '						ds_espaco, 
	sum(a.qt_item)					qt_procedimento, 
	0						qt_utilizado, 
	0						vl_procedimento, 
	0						nr_conta, 
	' '						cd_centro_custo, 
	' '						nr_doc_convenio, 
	' '						ie_tipo_guia, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_emissao_guia, 
	' '						cd_cid1, 
	' '						cd_cid2, 
	' ' 						cd_cid3, 
	' ' 						cd_cid4, 
	' '						nr_doc_conv_principal, 
	' '						cd_edicao_amb, 
	0						nr_seq_lote_protocolo, 
	' '						dt_mesano_referencia, 
	' '						hr_mesano_referencia, 
	'0'						ds_zeros, 
	0						ie_tipo_atendimento, 
	' '						cd_tipo_acomodacao, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_entrada, 
	to_char(LOCALTIMESTAMP, 'hh24mi')			hr_entrada, 
	to_char(LOCALTIMESTAMP, 'yyyymmdd')			dt_alta, 
	to_char(LOCALTIMESTAMP, 'hh24mi')			hr_alta, 
	0						ie_clinica, 
	0						ie_regime_inter, 
	' '						id_int_obstetricia_1, 
	' '						id_int_obstetricia_2, 
	' '						id_int_obstetricia_3, 
	' '						id_int_obstetricia_4, 
	' '						id_int_obstetricia_5, 
	' '						id_int_obstetricia_6, 
	' '						id_int_obstetricia_7, 
	' '						id_int_obstetricia_8, 
	' '						id_int_obstetricia_9, 
	' '						id_int_obstetricia_10, 
	' '						obito_mulher, 
	0						qt_obito_nasc_precoce, 
	0						qt_obito_nasc_tardio, 
	' '						nr_declaracao_vivos, 
	0						qt_nasc_vivo_termo, 
	0						qt_nasc_mortos, 
	0						qt_nasc_vivo_prematuro, 
	0						ie_acidente, 
	0						cd_motivo_alta, 
	' '						cd_cid_obito, 
	' '						nr_declaracao_obito, 
	' '						tp_faturamento, 
	0						vl_diarias, 
	0						vl_taxas, 
	0						vl_materiais, 
	0						vl_medicamentos, 
	0						vl_gases, 
	sum(a.vl_total_conta)				vl_total,	 
	a.nr_seq_protocolo				nr_seq_protocolo 
from	w_interf_conta_trailler a 
group by 
	a.nr_seq_protocolo;

