-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW hepic_diagnosticos_atend_v (nr_atendimento, ie_tipo_atendimento, nr_prontuario, dt_diagnostico, cd_doenca, dt_atualizacao, nm_usuario, cd_medico, ie_classificacao_doenca, ie_tipo_diagnostico) AS select a.nr_atendimento, b.ie_tipo_atendimento, c.nr_prontuario,
		dt_diagnostico, cd_doenca, a.dt_atualizacao, a.nm_usuario, 
		CASE WHEN a.cd_medico IS NULL THEN  cd_medico_resp  ELSE a.cd_medico END  cd_medico, 
		CASE WHEN a.ie_classificacao_doenca='P' THEN  'Principal'  ELSE 'Secund√°ria' END  ie_classificacao_doenca, 
		CASE WHEN a.ie_tipo_diagnostico='P' THEN  'Preliminar'  ELSE 'Definitiva' END  ie_tipo_diagnostico 
  FROM diagnostico_doenca a, 
		atendimento_paciente b, 
		pessoa_fisica c 
 where a.nr_atendimento = b.nr_atendimento 
	and b.cd_pessoa_fisica = c.cd_pessoa_fisica 
	order by nr_atendimento desc, 
			dt_diagnostico desc;

