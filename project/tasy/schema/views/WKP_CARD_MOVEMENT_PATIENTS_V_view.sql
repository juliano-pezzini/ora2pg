-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW wkp_card_movement_patients_v (nr_case, entry_date_time, exit_date_time, cd_setor_atendimento, ds_department, ds_medical_department, function_code, ds_room, ds_bed) AS SELECT
SUBSTR(OBTER_EPISODIO_ATEND_TELA(a.NR_ATENDIMENTO),1,80) NR_CASE,
a.DT_ENTRADA_UNIDADE ENTRY_DATE_TIME, a.DT_SAIDA_UNIDADE EXIT_DATE_TIME,
a.CD_SETOR_ATENDIMENTO, substr(OBTER_DESC_SETOR_ATEND(a.CD_SETOR_ATENDIMENTO),1,100) DS_DEPARTMENT,
substr(OBTER_NOME_DEPARTAMENTO_MEDICO(a.CD_DEPARTAMENTO), 1, 100) DS_MEDICAL_DEPARTMENT,
(SELECT x.CD_CNES FROM SETOR_ATENDIMENTO x WHERE x.CD_SETOR_ATENDIMENTO = a.CD_SETOR_ATENDIMENTO) FUNCTION_CODE,
a.CD_UNIDADE_BASICA DS_ROOM, a.CD_UNIDADE_COMPL DS_BED
FROM ATEND_PACIENTE_UNIDADE a;

