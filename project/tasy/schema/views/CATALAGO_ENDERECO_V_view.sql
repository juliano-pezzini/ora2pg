-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW catalago_endereco_v (ds_medico, cd_medico, ds_tipo_complemento, ie_tipo_endereco, ds_email, nr_celular, nr_telefone, ds_fax, cd_cep, nr_endereco, nm_mae, dt_nascimento, cd_codigo, nm_pessoa, ds_endereco, ds_bairro, ds_municipio, cd_municipio_ibge, ds_tipo_pessoa, ie_tipo_pessoa, cd_pessoa_fisica, cd_cgc) AS select	substr(obter_desc_cargo(b.cd_cargo),1,255) ds_medico,
	to_char(b.cd_cargo)	cd_medico,
	(select		substr(z.ds_valor_dominio,1,254)
	FROM 		valor_dominio z
	where 		z.cd_dominio	= 8
	and		z.vl_dominio	= a.ie_tipo_complemento) ds_tipo_complemento,
	a.ie_tipo_complemento 			ie_tipo_endereco,
	a.ds_email 				ds_email,
	b.nr_telefone_celular			nr_celular,
	a.nr_ddd_telefone||a.nr_telefone 	nr_telefone,
	a.nr_ddd_fax||a.ds_fax 			ds_fax,
	a.cd_cep 				cd_cep,
	to_char(coalesce(a.nr_endereco, a.ds_compl_end)) nr_endereco,
	substr(obter_nome_pf(a.cd_pessoa_fisica_ref),1,100) nm_mae,
	b.dt_nascimento				dt_nascimento,
	b.cd_pessoa_fisica			cd_codigo,
	b.nm_pessoa_fisica			nm_pessoa,
	a.ds_endereco,
	a.ds_bairro,
	a.ds_municipio,
	a.cd_municipio_ibge,
	substr(pls_obter_desc_tipo_pf(b.cd_pessoa_fisica),1,255) ds_tipo_pessoa,
	'F' ie_tipo_pessoa,
	b.cd_pessoa_fisica,
	'' cd_cgc
from	pessoa_fisica		b,
	compl_pessoa_fisica	a
where	b.cd_pessoa_fisica	= a.cd_pessoa_fisica

union

select	''	ds_medico,
	''	cd_medico,
	(select		substr(z.ds_valor_dominio,1,254)
	from 		valor_dominio z
	where 		z.cd_dominio	= 1090
	and		z.vl_dominio	= a.ie_tipo_complemento) ds_tipo_complemento,
	CASE WHEN a.ie_tipo_complemento=1 THEN 9 WHEN a.ie_tipo_complemento=2 THEN 10 WHEN a.ie_tipo_complemento=3 THEN 11 WHEN a.ie_tipo_complemento=4 THEN 12 END 	ie_tipo_endereco,
	a.ds_email			ds_email,
	''			nr_celular,
	a.nr_ddd_telefone||a.nr_telefone 	nr_telefone,
	b.nr_ddd_fax||a.nr_fax		ds_fax,
	a.cd_cep 			cd_cep,
	a.nr_endereco  			nr_endereco,
	'' 				nm_mae,
	b.dt_validade_alvara_munic	dt_nascimento,
	b.cd_cgc 			cd_codigo,
	b.ds_razao_social		nm_pessoa,
	b.ds_endereco,
	b.ds_bairro,
	b.ds_municipio,
	b.cd_municipio_ibge,
	substr(pls_obter_desc_tipo_pj(b.cd_cgc),1,255) ds_tipo_pessoa,
	'J' ie_tipo_pessoa,
	'' cd_pessoa_fisica,
	b.cd_cgc
from	pessoa_juridica b,
	pessoa_juridica_compl a
where	b.cd_cgc = a.cd_cgc
order by nm_pessoa;

