-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW rentabilidade_conta_v (nr_atendimento, nr_interno_conta, nr_seq_proc_pacote, cd_convenio, cd_setor_atendimento, ie_proc_mat, cd_item, ds_item, dt_item, qt_item, vl_item, vl_original, ds_convenio, ds_setor_atendimento, cd_paciente, ie_tipo_atendimento, nm_paciente, nr_seq_protocolo, dt_mesano_referencia, cd_proced_pacote, ds_proced_pacote, cd_estabelecimento, nm_medico_executor, ie_emite_conta, ie_origem_proced, nr_seq_proc_interno, nr_seq_exame, vl_custo_operacional, vl_medico, vl_filme, ie_cancelamento) AS select		a.nr_atendimento,
		a.nr_interno_conta, 
		a.nr_seq_proc_pacote, 
		a.cd_convenio, 
		a.cd_setor_atendimento, 
		a.ie_proc_mat, 
		a.cd_item, 
		a.ds_item, 
		a.dt_item, 
		a.qt_item, 
		a.vl_item, 
		a.vl_original, 
		b.ds_convenio, 
		c.ds_setor_atendimento, 
		d.cd_pessoa_fisica cd_paciente, 
		d.ie_tipo_atendimento, 
		e.nm_pessoa_fisica nm_paciente, 
		a.nr_seq_protocolo, 
		a.dt_mesano_protocolo dt_mesano_referencia, 
		a.cd_item cd_proced_pacote, 
		a.ds_item ds_proced_pacote, 
		d.cd_estabelecimento, 
		substr(obter_nome_pf(a.CD_MEDICO_EXECUTOR),1,50) nm_medico_executor, 
		a.ie_emite_conta, 
		a.ie_origem_proced, 
		a.nr_seq_proc_interno, 
		a.nr_seq_exame, 
		a.vl_custo_operacional, 
		a.vl_medico, 
		a.vl_filme, 
		a.ie_cancelamento 
FROM		setor_atendimento c, 
		convenio b, 
		pessoa_fisica e, 
		atendimento_paciente d, 
		protocolo_convenio_item_v a 
where		a.cd_convenio			= b.cd_convenio 
and		a.cd_setor_atendimento		= c.cd_setor_atendimento 
and		a.nr_atendimento		= d.nr_atendimento 
and		d.cd_pessoa_fisica		= e.cd_pessoa_fisica;

