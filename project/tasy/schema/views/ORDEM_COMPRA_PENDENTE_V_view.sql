-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ordem_compra_pendente_v (nr_ordem_compra, nr_item_oci, cd_material, nr_sequencia, dt_prevista_entrega, qt_prevista_entrega, qt_real_entrega, qt_pendente) AS select	a.nr_ordem_compra,
	b.nr_item_oci,
	b.cd_material,
	c.nr_sequencia,
	c.dt_prevista_entrega,
	c.qt_prevista_entrega,
	coalesce(c.qt_real_entrega,0) qt_real_entrega,
	c.qt_prevista_entrega - coalesce(c.qt_real_entrega,0) qt_pendente
FROM	ordem_compra a,
	ordem_compra_item b,
	ordem_compra_item_entrega c
where	a.nr_ordem_compra = b.nr_ordem_compra
and	b.nr_ordem_compra = c.nr_ordem_compra
and	b.nr_item_oci = c.nr_item_oci
and	a.dt_baixa is null
and	c.qt_prevista_entrega > coalesce(c.qt_real_entrega,0)
and	c.dt_cancelamento is null;

