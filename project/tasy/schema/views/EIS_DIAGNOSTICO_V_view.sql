-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_diagnostico_v (dt_referencia, cd_estabelecimento, ie_diagnostico, qt_ocorrencia, qt_obito, dt_atualizacao, nm_usuario, cd_doenca, cd_categoria_doenca, cd_medico, cd_procedencia, ie_clinica, cd_convenio, ie_tipo_atendimento, cd_setor_atendimento, ie_tipo_diagnostico, nr_atendimento, ie_profissional, ie_sexo, qt_idade, nm_medico, ds_convenio, ds_procedencia, ds_doenca_cid, ds_categoria_cid, ds_tipo_atendimento, ds_clinica, ds_diagnostico, ds_setor_atendimento, ds_estabelecimento, cd_empresa, ds_tipo_diagnostico, cd_especialidade, qt_tempo_permanencia, ds_classe_prof, ie_classe_prof, ie_faixa_etaria) AS select	a.DT_REFERENCIA,a.CD_ESTABELECIMENTO,a.IE_DIAGNOSTICO,a.QT_OCORRENCIA,a.QT_OBITO,a.DT_ATUALIZACAO,a.NM_USUARIO,a.CD_DOENCA,a.CD_CATEGORIA_DOENCA,a.CD_MEDICO,a.CD_PROCEDENCIA,a.IE_CLINICA,a.CD_CONVENIO,a.IE_TIPO_ATENDIMENTO,a.CD_SETOR_ATENDIMENTO,a.IE_TIPO_DIAGNOSTICO,a.NR_ATENDIMENTO,a.IE_PROFISSIONAL,a.IE_SEXO,a.QT_IDADE,
	obter_nome_pessoa_fisica(a.cd_medico, null) nm_medico, 
	obter_nome_convenio(a.cd_convenio) ds_convenio, 
	obter_desc_procedencia(a.cd_procedencia) ds_procedencia, 
	substr(obter_desc_cid(a.cd_doenca),1,50) ds_doenca_cid, 
	obter_desc_categoria_cid(a.cd_categoria_doenca) ds_categoria_cid, 
	obter_valor_dominio(12, a.ie_tipo_atendimento) ds_tipo_atendimento, 
	obter_valor_dominio(17, a.ie_clinica) ds_clinica, 
	obter_valor_dominio(58, a.ie_diagnostico) ds_diagnostico, 
	substr(obter_nome_setor(a.cd_setor_atendimento),1,100) ds_setor_atendimento, 
	substr(obter_nome_estabelecimento(a.cd_estabelecimento),1,100) ds_estabelecimento, 
	obter_empresa_estab(a.cd_estabelecimento) cd_empresa, 
	substr(obter_valor_dominio(13, a.ie_tipo_diagnostico),1,200) ds_tipo_diagnostico, 
	(obter_especialidade_medico(a.cd_medico,'C'))::numeric  cd_especialidade, 
	Obter_Dias_Internacao(a.nr_atendimento) qt_tempo_permanencia, 
	SUBSTR(OBTER_VALOR_DOMINIO(1631,IE_PROFISSIONAL),1,255) ds_classe_prof, 
	coalesce(IE_PROFISSIONAL,'0') ie_classe_prof, 
	substr(eis_obter_faixa_etaria(qt_idade),1,50) ie_faixa_etaria 
FROM	Eis_Diagnostico a;

