-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW diagnostico_doenca_opcao_v (cd, expressao, numero, column_name, pri_key, nr_atendimento) AS (
        select
                1 cd,
                concat(trim(both substr(obter_desc_cid(CD_DOENCA),1,200)), ' - ' || obter_desc_expressao(941784)) expressao,
                1 numero,
                'IE_DIAG_REFERENCIA' column_name,
                concat(dt_diagnostico, '_'||cd_doenca ) as pri_key,
                nr_atendimento
        FROM DIAGNOSTICO_DOENCA where IE_DIAG_REFERENCIA = 'S' and dt_liberacao IS NOT NULL and dt_inativacao IS NULL


UNION ALL


        select
                1 cd,
                concat(trim(both substr(obter_desc_cid(CD_DOENCA),1,200)), ' - ' || obter_desc_expressao(857223)) expressao,
                1 numero,
                'IE_DIAG_TRATAMENTO' column_name,
                concat(dt_diagnostico, '_'||cd_doenca ) as pri_key,
                nr_atendimento
        from DIAGNOSTICO_DOENCA where IE_DIAG_TRATAMENTO = 'S' and dt_liberacao IS NOT NULL and dt_inativacao IS NULL

        
UNION ALL


        select
                1 cd,
                concat(trim(both substr(obter_desc_cid(CD_DOENCA),1,200)), ' - ' || obter_desc_expressao(856739)) expressao,
                1 numero,
                'IE_DIAG_ADMISSAO' column_name,
                concat(dt_diagnostico, '_'||cd_doenca ) as pri_key,
                nr_atendimento
        from DIAGNOSTICO_DOENCA where IE_DIAG_ADMISSAO = 'S' and dt_liberacao IS NOT NULL and dt_inativacao IS NULL


        
UNION ALL


        select
                1 cd,
                concat(trim(both substr(obter_desc_cid(CD_DOENCA),1,200)), ' - ' || obter_desc_expressao(941796)) expressao,
                1 numero,
                'IE_DIAG_ALTA' column_name,
                concat(dt_diagnostico, '_'||cd_doenca ) as pri_key,
                nr_atendimento
        from DIAGNOSTICO_DOENCA where IE_DIAG_ALTA = 'S' and dt_liberacao IS NOT NULL and dt_inativacao IS NULL

        
UNION ALL


        select
                1 cd,
                concat(trim(both substr(obter_desc_cid(CD_DOENCA),1,200)), ' - ' || obter_desc_expressao(941798)) expressao,
                1 numero,
                'IE_DIAG_CIRURGIA' column_name,
                concat(dt_diagnostico, '_'||cd_doenca ) as pri_key,
                nr_atendimento
        from DIAGNOSTICO_DOENCA where IE_DIAG_CIRURGIA = 'S' and dt_liberacao IS NOT NULL and dt_inativacao IS NULL

        
UNION ALL


        select
                1 cd,
                concat(trim(both substr(obter_desc_cid(CD_DOENCA),1,200)), ' - ' || obter_desc_expressao(941800)) expressao,
                1 numero,
                'IE_DIAG_OBITO' column_name,
                concat(dt_diagnostico, '_'||cd_doenca ) as pri_key,
                nr_atendimento
        from DIAGNOSTICO_DOENCA where IE_DIAG_OBITO = 'S' and dt_liberacao IS NOT NULL and dt_inativacao IS NULL

        
UNION ALL


        select
                1 cd,
                concat(trim(both substr(obter_desc_cid(CD_DOENCA),1,200)), ' - ' || obter_desc_expressao(287710)) expressao,
                1 numero,
                'IE_DIAG_PRE_CIR' column_name,
                concat(dt_diagnostico, '_'||cd_doenca ) as pri_key,
                nr_atendimento
        from DIAGNOSTICO_DOENCA where IE_DIAG_PRE_CIR = 'S' and dt_liberacao IS NOT NULL and dt_inativacao IS NULL

        
UNION ALL


        select
                1 cd,
                concat(trim(both substr(obter_desc_cid(CD_DOENCA),1,200)), ' - ' || obter_desc_expressao(941802)) expressao,
                1 numero,
                'IE_DIAG_PRINC_DEPART' column_name,
                concat(dt_diagnostico, '_'||cd_doenca ) as pri_key,
                nr_atendimento
        from DIAGNOSTICO_DOENCA where IE_DIAG_PRINC_DEPART = 'S' and dt_liberacao IS NOT NULL and dt_inativacao IS NULL

        
UNION ALL


        select
                1 cd,
                concat(trim(both substr(obter_desc_cid(CD_DOENCA),1,200)), ' - ' || obter_desc_expressao(856957)) expressao,
                1 numero,
                'IE_DIAG_PRINC_EPISODIO' column_name,
                concat(dt_diagnostico, '_'||cd_doenca ) as pri_key,
                nr_atendimento
        from DIAGNOSTICO_DOENCA where IE_DIAG_PRINC_EPISODIO = 'S' and dt_liberacao IS NOT NULL and dt_inativacao IS NULL

        
UNION ALL


        select
                1 cd,
                concat(trim(both substr(obter_desc_cid(CD_DOENCA),1,200)), ' - ' || obter_desc_expressao(941804)) expressao,
                1 numero,
                'IE_DIAG_TRAT_CERT' column_name,
                concat(dt_diagnostico, '_'||cd_doenca ) as pri_key,
                nr_atendimento
        from DIAGNOSTICO_DOENCA where IE_DIAG_TRAT_CERT = 'S' and dt_liberacao IS NOT NULL and dt_inativacao IS NULL
);

