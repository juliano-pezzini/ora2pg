-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW atend_categoria_convenio_v (nr_atendimento, cd_convenio, cd_categoria, cd_usuario_convenio, cd_empresa, cd_tipo_acomodacao, nr_doc_convenio, dt_inicio_vigencia, ds_convenio, ds_categoria, cd_plano_convenio) AS SELECT /*+ INDEX(C ATECACO_ATEPACI_FK_I) INDEX(T CATCONV_PK) INDEX(V CONVENI_PK) */       C.NR_ATENDIMENTO,
       C.CD_CONVENIO,
       C.CD_CATEGORIA,
       C.CD_USUARIO_CONVENIO,
       C.CD_EMPRESA,
       C.CD_TIPO_ACOMODACAO,
       C.NR_DOC_CONVENIO,
       C.DT_INICIO_VIGENCIA,
       V.DS_CONVENIO,
       T.DS_CATEGORIA,
	C.CD_PLANO_CONVENIO
FROM   CONVENIO V,
       CATEGORIA_CONVENIO T,
       ATEND_CATEGORIA_CONVENIO C
WHERE (C.DT_INICIO_VIGENCIA =
      (SELECT MAX(W.DT_INICIO_VIGENCIA)
       FROM ATEND_CATEGORIA_CONVENIO W
       WHERE W.NR_ATENDIMENTO  = C.NR_ATENDIMENTO) )
  AND (C.CD_CONVENIO           = V.CD_CONVENIO)
  AND (C.CD_CONVENIO           = T.CD_CONVENIO)
  AND (C.CD_CATEGORIA          = T.CD_CATEGORIA);

