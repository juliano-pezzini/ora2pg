-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_autoriz_ordem_serv_v50_v (cd_transacao, ie_tipo_registro, nr_sequencia, nr_seq_requisicao, nr_seq_guia, ie_tipo_cliente, cd_unimed_executora, cd_unimed_beneficiario, cd_unimed_solicitante, nr_seq_execucao, nr_seq_origem, nr_seq_solicitante, ds_mensagem, dt_validade, nr_versao, ie_tipo_tabela, cd_servico, ds_servico, qt_autorizado, ie_autorizado, cd_mens_espec_1, cd_mens_espec_2, cd_mens_espec_3, cd_mens_espec_4, cd_mens_espec_5, ds_mens_espec_1, ds_mens_espec_2, ds_mens_espec_3, ds_mens_espec_4, ds_mens_espec_5, ds_fim) AS select	00804				cd_transacao,
	1				ie_tipo_registro,
	nr_sequencia			nr_sequencia,
	nr_seq_requisicao		nr_seq_requisicao,
	nr_seq_guia			nr_seq_guia,
	CASE WHEN ie_tipo_cliente='U' THEN 'UNIMED' WHEN ie_tipo_cliente='P' THEN 'PORTAL' WHEN ie_tipo_cliente='R' THEN 'PRESTADOR' END  ie_tipo_cliente,
	cd_unimed_executora 		cd_unimed_executora,
	cd_unimed_beneficiario		cd_unimed_beneficiario,
	cd_unimed_solicitante		cd_unimed_solicitante,
	nr_seq_execucao   		nr_seq_execucao,
	nr_seq_origem    		nr_seq_origem,
	nr_transacao_solicitante	nr_seq_solicitante,
	null				ds_mensagem,
	dt_validade  			dt_validade,
	pls_obter_versao_scs		nr_versao,
	null  				ie_tipo_tabela,
	null    			cd_servico,
	null       			ds_servico,
	null     			qt_autorizado,
	null  				ie_autorizado,
	null				cd_mens_espec_1,
	null				cd_mens_espec_2,
	null				cd_mens_espec_3,
	null				cd_mens_espec_4,
	null				cd_mens_espec_5,
	null				ds_mens_espec_1,
	null				ds_mens_espec_2,
	null				ds_mens_espec_3,
	null				ds_mens_espec_4,
	null				ds_mens_espec_5,
	null				ds_fim
FROM	ptu_autorizacao_ordem_serv

union

select	null				cd_transacao,
	2				ie_tipo_registro,
	nr_sequencia			nr_sequencia,
	nr_seq_requisicao		nr_seq_requisicao,
	nr_seq_guia			nr_seq_guia,
	null  		      		ie_tipo_cliente,
	null 				cd_unimed_executora,
	cd_unimed_beneficiario		cd_unimed_beneficiario,
	null				cd_unimed_solicitante,
	null   				nr_seq_execucao,
	nr_seq_origem  			nr_seq_origem,
	nr_transacao_solicitante	nr_seq_solicitante,
	Elimina_Acentuacao(substr(replace(replace(ds_mensagem,chr(13),''),chr(10),''),1,999)) ds_mensagem,
	null  				dt_validade,
	null				nr_versao,
	null  				ie_tipo_tabela,
	null    			cd_servico,
	null       			ds_servico,
	null     			qt_autorizado,
	null  				ie_autorizado,
	null				cd_mens_espec_1,
	null				cd_mens_espec_2,
	null				cd_mens_espec_3,
	null				cd_mens_espec_4,
	null				cd_mens_espec_5,
	null				ds_mens_espec_1,
	null				ds_mens_espec_2,
	null				ds_mens_espec_3,
	null				ds_mens_espec_4,
	null				ds_mens_espec_5,
	null				ds_fim
from	ptu_autorizacao_ordem_serv

union

select	null				cd_transacao,
	3				ie_tipo_registro,
	nr_seq_aut_ord_serv		nr_sequencia,
	nr_seq_requisicao		nr_seq_requisicao,
	nr_seq_guia			nr_seq_guia,
	null	        		ie_tipo_cliente,
	null 				cd_unimed_executora,
	cd_unimed_beneficiario		cd_unimed_beneficiario,
	null				cd_unimed_solicitante,
	null   				nr_seq_execucao,
	nr_seq_origem  			nr_seq_origem,
	null				nr_seq_solicitante,
	null				ds_mensagem,
	null  				dt_validade,
	null				nr_versao,
	ie_tipo_tabela  		ie_tipo_tabela,
	cd_servico			cd_servico,
	Elimina_Acentuacao(ds_servico)	ds_servico,
	ptu_obter_qtd_env_itens_scs(qt_autorizado, null,'E') qt_autorizado,
	ie_autorizado			ie_autorizado,
	ptu_obter_cod_desc_inconst(nr_seq_guia,nr_seq_requisicao,coalesce(nr_seq_guia_proc, nr_seq_req_proc),coalesce(nr_seq_guia_mat, nr_seq_req_mat),1,'C') cd_mens_espec_1,
	ptu_obter_cod_desc_inconst(nr_seq_guia,nr_seq_requisicao,coalesce(nr_seq_guia_proc, nr_seq_req_proc),coalesce(nr_seq_guia_mat, nr_seq_req_mat),2,'C') cd_mens_espec_2,
	ptu_obter_cod_desc_inconst(nr_seq_guia,nr_seq_requisicao,coalesce(nr_seq_guia_proc, nr_seq_req_proc),coalesce(nr_seq_guia_mat, nr_seq_req_mat),3,'C') cd_mens_espec_3,
	ptu_obter_cod_desc_inconst(nr_seq_guia,nr_seq_requisicao,coalesce(nr_seq_guia_proc, nr_seq_req_proc),coalesce(nr_seq_guia_mat, nr_seq_req_mat),4,'C') cd_mens_espec_4,
	ptu_obter_cod_desc_inconst(nr_seq_guia,nr_seq_requisicao,coalesce(nr_seq_guia_proc, nr_seq_req_proc),coalesce(nr_seq_guia_mat, nr_seq_req_mat),5,'C') cd_mens_espec_5,
	Elimina_Acentuacao(ptu_obter_cod_desc_inconst(nr_seq_guia,nr_seq_requisicao,coalesce(nr_seq_guia_proc, nr_seq_req_proc),coalesce(nr_seq_guia_mat, nr_seq_req_mat),1,'D'))	ds_mens_espec_1,
	Elimina_Acentuacao(ptu_obter_cod_desc_inconst(nr_seq_guia,nr_seq_requisicao,coalesce(nr_seq_guia_proc, nr_seq_req_proc),coalesce(nr_seq_guia_mat, nr_seq_req_mat),2,'D'))	ds_mens_espec_2,
	Elimina_Acentuacao(ptu_obter_cod_desc_inconst(nr_seq_guia,nr_seq_requisicao,coalesce(nr_seq_guia_proc, nr_seq_req_proc),coalesce(nr_seq_guia_mat, nr_seq_req_mat),3,'D'))	ds_mens_espec_3,
	Elimina_Acentuacao(ptu_obter_cod_desc_inconst(nr_seq_guia,nr_seq_requisicao,coalesce(nr_seq_guia_proc, nr_seq_req_proc),coalesce(nr_seq_guia_mat, nr_seq_req_mat),4,'D'))	ds_mens_espec_4,
	Elimina_Acentuacao(ptu_obter_cod_desc_inconst(nr_seq_guia,nr_seq_requisicao,coalesce(nr_seq_guia_proc, nr_seq_req_proc),coalesce(nr_seq_guia_mat, nr_seq_req_mat),5,'D'))	ds_mens_espec_5,
	null				ds_fim
from	ptu_aut_ordem_serv_servico	b,
	ptu_autorizacao_ordem_serv	a
where	b.nr_seq_aut_ord_serv		= a.nr_sequencia

union

select	null				cd_transacao,
	4				ie_tipo_registro,
	nr_sequencia			nr_sequencia,
	nr_seq_requisicao		nr_seq_requisicao,
	nr_seq_guia			nr_seq_guia,
	null   		     		ie_tipo_cliente,
	null 				cd_unimed_executora,
	cd_unimed_beneficiario		cd_unimed_beneficiario,
	null				cd_unimed_solicitante,
	null   				nr_seq_execucao,
	nr_seq_origem  			nr_seq_origem,
	null				nr_seq_solicitante,
	null 				ds_mensagem,
	null  				dt_validade,
	null				nr_versao,
	null  				ie_tipo_tabela,
	null    			cd_servico,
	null       			ds_servico,
	null     			qt_autorizado,
	null  				ie_autorizado,
	null				cd_mens_espec_1,
	null				cd_mens_espec_2,
	null				cd_mens_espec_3,
	null				cd_mens_espec_4,
	null				cd_mens_espec_5,
	null				ds_mens_espec_1,
	null				ds_mens_espec_2,
	null				ds_mens_espec_3,
	null				ds_mens_espec_4,
	null				ds_mens_espec_5,
	'FIM$'				ds_fim
from	ptu_autorizacao_ordem_serv;

