-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_indicador_mapa_v (qt_total, dt_dieta, cd_dieta, cd_refeicao, cd_setor_atendimento, ds_convenio) AS select 		count(*) qt_total,
		a.dt_dieta dt_dieta,
		substr(obter_nome_dieta(a.cd_dieta),1,100) cd_dieta,
		substr(obter_valor_dominio(99,a.cd_refeicao),1,20) cd_refeicao,
		b.ds_setor_atendimento cd_setor_atendimento,
		substr(obter_nome_convenio(obter_convenio_atendimento(a.nr_atendimento)),1,100) ds_convenio
FROM		mapa_dieta a,
		setor_atendimento b
where		dt_liberacao is not null
and		a.cd_setor_atendimento = b.cd_setor_atendimento
group by		 dt_dieta,
		a.cd_dieta,
		a.cd_refeicao,
		b.ds_setor_atendimento,
		substr(obter_nome_convenio(obter_convenio_atendimento(a.nr_atendimento)),1,100);

