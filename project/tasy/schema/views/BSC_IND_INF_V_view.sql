-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW bsc_ind_inf_v (nr_seq_indicador, nm_indicador, nr_seq_inf, cd_estabelecimento, cd_empresa, cd_ano, cd_periodo, qt_meta, qt_real, qt_limite, qt_referencia, ie_fechado, ie_informado, nr_seq_result, dt_liberacao, ds_periodo, ds_tipo_periodo, ds_cor, ds_cor_fundo, ie_periodo, cd_classificacao, ie_regra_intervalo, qt_meta_consol, qt_limite_consol, qt_real_consol, ds_justificativa, nr_seq_tipo) AS select	c.nr_sequencia nr_seq_indicador,
	c.nm_indicador,
	b.nr_sequencia nr_seq_inf,
	b.cd_estabelecimento,
	b.cd_empresa,
	b.cd_ano,
	b.cd_periodo,
	b.qt_meta,
	b.qt_real,
	b.qt_limite,
	b.qt_referencia,
	b.ie_fechado,
	b.ie_informado,
	b.nr_seq_result,
	b.dt_liberacao,
	substr(bsc_obter_periodo_inf(b.nr_seq_indicador,null,b.cd_ano,b.cd_periodo),1,20) ds_periodo,
	substr(bsc_obter_desc_periodo(nr_seq_indicador),1,20) ds_tipo_periodo,
	substr(obter_descricao_padrao('BSC_CLASSIF_RESULT','DS_COR',b.nr_seq_result),1,30) ds_cor,
	substr(obter_descricao_padrao('BSC_CLASSIF_RESULT','DS_COR_FUNDO',b.nr_seq_result),1,30) ds_cor_fundo,
	c.ie_periodo,
	c.cd_classificacao,
	c.ie_regra_intervalo,
	bsc_obter_consolidado(c.nr_sequencia, b.nr_sequencia,'M') qt_meta_consol,
	bsc_obter_consolidado(c.nr_sequencia, b.nr_sequencia,'L') qt_limite_consol,
	bsc_obter_consolidado(c.nr_sequencia, b.nr_sequencia,'R') qt_real_consol,
	b.ds_justificativa,
	coalesce(c.nr_seq_tipo,0) nr_seq_tipo
FROM	bsc_indicador c,
	bsc_ind_inf b
where	b.nr_seq_indicador	= c.nr_sequencia;

