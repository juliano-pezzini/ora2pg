-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW material_faturamento_v (cd_material, ds_material, cd_simpro, ds_simpro, cd_laboratorio, cd_medicamento, ds_medicamento, cd_apresentacao, vl_preco) AS select	a.cd_material,
	a.ds_material,
	b.cd_simpro,
	c.ds_produto ds_simpro,
	'' cd_laboratorio,
	'' cd_medicamento,
	'' ds_medicamento,
	'' cd_apresentacao,
	Obter_Preco_simpro(b.cd_simpro) vl_preco
FROM	simpro_cadastro c,
	material_simpro b,
	material a
where	a.cd_material		= b.cd_material
and	b.cd_simpro		= c.cd_simpro
and	a.ie_tipo_material	= 1

union

select	a.cd_material,
	a.ds_material,
	(null)::numeric  cd_simpro,
	'' ds_simpro,
	b.cd_laboratorio,
	b.cd_medicamento,
	c.ds_medicamento,
	b.cd_apresentacao,
	obter_valor_brasindice(a.cd_material, 'C') vl_preco
from	brasindice_medicamento c,
	material_brasindice b,
	material a
where	a.cd_material		= b.cd_material
and	b.cd_medicamento	= c.cd_medicamento
and	a.ie_tipo_material	<> 1;

