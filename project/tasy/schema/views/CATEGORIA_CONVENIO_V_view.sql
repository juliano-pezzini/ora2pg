-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW categoria_convenio_v (cd_convenio, cd_categoria, ds_categoria, ie_ident_atend, ie_empresa, ie_situacao, cd_tipo_acomodacao, dt_atualizacao, nm_usuario, nr_acompanhante, cd_plano_padrao, qt_dieta_acomp, ie_lib_dieta, ie_idade_dieta, qt_idade_menores, qt_idade_maiores, ie_permite_gerar_pacote, ie_preco_custo, ds_reduzida, nr_seq_regra_acomp, nr_seq_apresentacao, ds_senha_web, cd_integracao, ds_convenio, ds_cat_convenio, ie_tipo_convenio, nr_seq_classificacao, ds_classificacao, ie_pais_conv) AS select  a.CD_CONVENIO,a.CD_CATEGORIA,a.DS_CATEGORIA,a.IE_IDENT_ATEND,a.IE_EMPRESA,a.IE_SITUACAO,a.CD_TIPO_ACOMODACAO,a.DT_ATUALIZACAO,a.NM_USUARIO,a.NR_ACOMPANHANTE,a.CD_PLANO_PADRAO,a.QT_DIETA_ACOMP,a.IE_LIB_DIETA,a.IE_IDADE_DIETA,a.QT_IDADE_MENORES,a.QT_IDADE_MAIORES,a.IE_PERMITE_GERAR_PACOTE,a.IE_PRECO_CUSTO,a.DS_REDUZIDA,a.NR_SEQ_REGRA_ACOMP,a.NR_SEQ_APRESENTACAO,a.DS_SENHA_WEB,a.CD_INTEGRACAO,
	b.ds_convenio,
	substr(b.ds_convenio || ' ' || a.ds_categoria,1,200) ds_cat_convenio,
	b.ie_tipo_convenio,
	somente_numero(Obter_Classif_Conv(b.cd_convenio, 'C')) nr_seq_classificacao,
	substr(Obter_Classif_Conv(b.cd_convenio, 'D'),1,100) ds_classificacao,
	CASE WHEN Obter_Se_Conv_Nacional(b.cd_convenio)='N' THEN  'Internacional' WHEN Obter_Se_Conv_Nacional(b.cd_convenio)='S' THEN  'Nacional'  ELSE 'NÃ£o Informado' END  ie_pais_conv
FROM 	convenio b,
	categoria_convenio a
where a.cd_convenio = b.cd_convenio;

