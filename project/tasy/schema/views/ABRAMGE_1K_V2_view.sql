-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW abramge_1k_v2 (ds_registro, tp_registro, ie_servico, nr_seq_protocolo, cd_origem, nr_lote, nr_interno_conta, nr_parcela, cd_convenio, nm_convenio, tp_prestador, cd_prestador, nm_prestador, dt_geracao, nr_remessa, cd_ans, ds_plano, dt_entrada, dt_alta, dt_inicio_cobranca, dt_fim_cobranca, cd_cid, cd_proc_principal, nr_protocolo, ie_tipo_nascimento, ie_aborto, ie_obito_materno, ie_atend_rn, ie_neonatal, ie_baixo_peso, ie_parto_cesario, ie_laudo_medico, ie_laudo_prorrog, dt_autorizacao, dt_validade_carteira, nr_prontuario, ie_tipo_docto, nr_doc_paciente, ie_tipo_internacao, cd_usuario_convenio, cd_acomodacao, ie_tipo_atendimento, ie_carater_inter, qt_nascidos_vivos, qt_nascidos_mortos, nr_seq_acidente, ie_faturamento, ie_tipo_consulta, dt_solicitacao, dt_validade_senha, nm_pessoa_autorizou, cd_autorizacao, dt_emissao, nm_titular, nr_declaracao_vivos, nr_declaracao_obito, cd_cid_obito, cd_cid2, cd_cid3, cd_cid4, nr_obito_precoce, nr_obito_tardio, ie_tipo_doenca, ie_tempo_doenca, cd_cns, cd_cnes, nr_seq_conselho, nr_crm, uf_crm, cd_cbos, tp_logradouro, ds_logradouro, nr_endereco, ds_complemento, ds_municipio, sg_uf, cd_ibge, cd_cep, nr_seq_conselho_solic, nr_crm_solic, uf_crm_solic, cd_cbos_solic, ie_tipo_saida, ie_tipo_guia, qt_prematuros, cd_cnes_solic, nm_contratado, nr_regime_internacao, nr_guia, cd_senha_autorizacao, ie_gestacao, ie_transtorno, ie_complicacao, cd_funcao_executor, cd_item, ds_item, ie_emergencia, ie_extra, dt_item, ie_funcao_medico, qt_item, vl_item, ie_cirurgia_multipla, ds_unidade_medida, cd_classif_item, nr_cpf_executor, nm_medico_executor, cd_crm_executor, nr_crm_executor, uf_crm_executor, cd_executor_operadora, cd_pacote, vl_pacote, ie_tipo_cirurgia, hr_inicial, hr_final, cd_edicao_amb, qt_item_autorizado, ie_tecnica, cd_barra_opm, nm_fabricante, qt_embalagem, cd_centro_custo, qt_solicitada, nr_cpf_medico, nr_guia_autoriz, cd_senha, qt_item_conta, vl_total_item, nm_paciente, cd_unid_atend, qt_diaria_enf, qt_diaria_uti, cd_ura, cd_cpf_exec, nm_medico_exec, cd_cpf_solic, nm_medico_solic, ds_indicacao_clinica, ds_observacao, nr_guia_autorizacao, nr_fatura, qt_conta_lote, vl_total_lote, nr_documento, qt_total_conta, vl_total_conta, nr_seq_item) AS select	'header			' 			ds_registro,
	0						tp_registro, 
	'CSMH'						ie_servico, 
	a.nr_seq_protocolo				nr_seq_protocolo, 
	0						cd_origem, 
	0						nr_lote, 
	0						nr_interno_conta, 
	0						nr_parcela, 
	somente_numero(coalesce(a.cd_regional,0))		cd_convenio, 
	substr(elimina_acentuacao(upper(a.nm_convenio)),1,30) nm_convenio, 
	'J'						tp_prestador, 
	a.cd_cgc_hospital				cd_prestador, 
	substr(elimina_acentuacao(upper(a.nm_hospital)),1,40) nm_prestador, 
	a.dt_remessa					dt_geracao, 
	a.nr_remessa					nr_remessa, 
	somente_numero(coalesce(b.cd_ans,0))			cd_ans, 
	' '						ds_plano, 
	LOCALTIMESTAMP						dt_entrada, 
	LOCALTIMESTAMP						dt_alta, 
	LOCALTIMESTAMP						dt_inicio_cobranca, 
	LOCALTIMESTAMP						dt_fim_cobranca, 
	' '						cd_cid, 
	0						cd_proc_principal, 
	0						nr_protocolo, 
	0						ie_tipo_nascimento, 
	' '						ie_aborto, 
	' '						ie_obito_materno, 
	' '						ie_atend_rn, 
	' '						ie_neonatal, 
	' '						ie_baixo_peso, 
	' '						ie_parto_cesario, 
	' '						ie_laudo_medico, 
	' '						ie_laudo_prorrog, 
	LOCALTIMESTAMP						dt_autorizacao, 
	LOCALTIMESTAMP						dt_validade_carteira, 
	0						nr_prontuario, 
	' '						ie_tipo_docto, 
	' '						nr_doc_paciente, 
	0						ie_tipo_internacao, 
	' '						cd_usuario_convenio, 
	0						cd_acomodacao, 
	0						ie_tipo_atendimento, 
	' '						ie_carater_inter, 
	0						qt_nascidos_vivos, 
	0						qt_nascidos_mortos, 
	0						nr_seq_acidente, 
	' '						ie_faturamento, 
	' '						ie_tipo_consulta, 
	LOCALTIMESTAMP						dt_solicitacao, 
	LOCALTIMESTAMP						dt_validade_senha, 
	' '						nm_pessoa_autorizou, 
	' '						cd_autorizacao, 
	LOCALTIMESTAMP						dt_emissao, 
	' '						nm_titular, 
	0						nr_declaracao_vivos, 
	0						nr_declaracao_obito, 
	' '						cd_cid_obito, 
	' '						cd_cid2, 
	' '						cd_cid3, 
	' '						cd_cid4, 
	0						nr_obito_precoce, 
	0						nr_obito_tardio, 
	' '						ie_tipo_doenca, 
	' '						ie_tempo_doenca, 
	0						cd_cns, 
	0						cd_cnes, 
	' '						nr_seq_conselho, 
	' '						nr_crm, 
	' '						uf_crm, 
	' '						cd_cbos, 
	' '						tp_logradouro, 
	' '						ds_logradouro, 
	0						nr_endereco, 
	' '						ds_complemento, 
	' '						ds_municipio, 
	' '						sg_uf, 
	0						cd_ibge, 
	0						cd_cep, 
	' '						nr_seq_conselho_solic,	 
	' '						nr_crm_solic, 
	' '						uf_crm_solic, 
	' '						cd_cbos_solic, 
	0						ie_tipo_saida, 
	' '						ie_tipo_guia, 
	0						qt_prematuros, 
	0						cd_cnes_solic, 
	' '						nm_contratado, 
	1						nr_regime_internacao, 
	0						nr_guia, 
	' '						cd_senha_autorizacao, 
	' '						ie_gestacao, 
	' '						ie_transtorno, 
	' '						ie_complicacao, 
	00						cd_funcao_executor, 
	' '						cd_item, 
	' '						ds_item, 
	' '						ie_emergencia, 
	' '						ie_extra, 
	LOCALTIMESTAMP						dt_item, 
	0						ie_funcao_medico, 
	0						qt_item, 
	0						vl_item, 
	0						ie_cirurgia_multipla, 
	' '						ds_unidade_medida, 
	0						cd_classif_item, 
	' '						nr_cpf_executor, 
	' '						nm_medico_executor, 
	' '						cd_crm_executor, 
	' '						nr_crm_executor,	 
	' '						uf_crm_executor, 
	' '						cd_executor_operadora, 
	0						cd_pacote, 
	0						vl_pacote, 
	0						ie_tipo_cirurgia, 
	LOCALTIMESTAMP						hr_inicial, 
	LOCALTIMESTAMP						hr_final, 
	' '						cd_edicao_amb, 
	0						qt_item_autorizado, 
	' '						ie_tecnica, 
	' '						cd_barra_opm, 
	' '						nm_fabricante, 
	0						qt_embalagem, 
	' '						cd_centro_custo, 
	0						qt_solicitada, 
	' '						nr_cpf_medico, 
	0						nr_guia_autoriz, 
	' '						cd_senha, 
	0						qt_item_conta, 
	0						vl_total_item, 
	' '						nm_paciente, 
	0						cd_unid_atend, 
	0						qt_diaria_enf, 
	0						qt_diaria_uti, 
	0						cd_ura, 
	' '						cd_cpf_exec, 
	' '						nm_medico_exec, 
	' '						cd_cpf_solic, 
	' '						nm_medico_solic, 
	' '						ds_indicacao_clinica, 
	' '						ds_observacao, 
	0						nr_guia_autorizacao, 
	0						nr_fatura, 
	0						qt_conta_lote, 
	0						vl_total_lote, 
	0						nr_documento, 
	0						qt_total_conta, 
	0						vl_total_conta, 
	0						nr_seq_item 
FROM	pessoa_juridica b, 
	w_interf_conta_header a 
where	a.cd_cgc_hospital	= b.cd_cgc 

union all
 
select	distinct 
	'cabecalho		' 			ds_registro, 
	1						tp_registro, 
	'CSMH'						ie_servico, 
	a.nr_seq_protocolo				nr_seq_protocolo, 
	0						cd_origem, 
	0						nr_lote, 
	a.nr_interno_conta				nr_interno_conta, 
	0						nr_parcela, 
	0						cd_convenio, 
	' '						nm_convenio, 
	' '						tp_prestador, 
	' '						cd_prestador, 
	' '						nm_prestador, 
	LOCALTIMESTAMP						dt_geracao, 
	0						nr_remessa, 
	0						cd_ans, 
	substr(obter_desc_plano(a.cd_convenio, a.cd_plano_convenio),1,40) ds_plano, 
	a.dt_entrada					dt_entrada, 
	a.dt_alta					dt_alta, 
	a.dt_periodo_inicial				dt_inicio_cobranca, 
	coalesce(a.dt_alta, a.dt_periodo_final)		dt_fim_cobranca, 
	a.cd_cid_principal				cd_cid, 
	somente_numero(coalesce(a.cd_proc_principal,0))	cd_proc_principal, 
	0						nr_protocolo, 
	0						ie_tipo_nascimento, 
	'N'						ie_aborto, 
	'N'						ie_obito_materno, 
	'N'						ie_atend_rn, 
	'N'						ie_neonatal, 
	'N'						ie_baixo_peso, 
	'N'						ie_parto_cesario, 
	'N'						ie_laudo_medico, 
	'N'						ie_laudo_prorrog, 
	b.dt_autorizacao				dt_autorizacao, 
	a.dt_validade_carteira				dt_validade_carteira, 
	a.nr_prontuario					nr_prontuario, 
	CASE WHEN a.nr_cpf_paciente IS NULL THEN  CASE WHEN a.nr_identidade IS NULL THEN  '  '  ELSE 'CI ' END   ELSE 'CPF' END  ie_tipo_docto, 
	coalesce(a.nr_cpf_paciente, somente_numero(a.nr_identidade)) nr_doc_paciente, 
	a.ie_clinica					ie_tipo_internacao, 
	a.cd_usuario_convenio				cd_usuario_convenio, 
	a.cd_tipo_acomodacao				cd_acomodacao, 
	a.ie_tipo_atendimento				ie_tipo_atendimento, 
	a.ie_carater_inter				ie_carater_inter, 
	0						qt_nascidos_vivos, 
	0						qt_nascidos_mortos, 
	c.nr_seq_tipo_acidente				nr_seq_acidente, 
	'T'						ie_faturamento, 
	'1'						ie_tipo_consulta, 
	b.dt_autorizacao				dt_solicitacao, 
	a.dt_validade_carteira				dt_validade_senha, 
	substr(b.nm_responsavel,1,70)			nm_pessoa_autorizou, 
	a.nr_doc_convenio				cd_autorizacao, 
	b.dt_autorizacao				dt_emissao, 
	substr(a.nm_paciente,1,70)			nm_titular, 
	0						nr_declaracao_vivos, 
	0						nr_declaracao_obito, 
	' '						cd_cid_obito, 
	' '						cd_cid2, 
	' '						cd_cid3, 
	' '						cd_cid4, 
	0						nr_obito_precoce, 
	0						nr_obito_tardio, 
	' '						ie_tipo_doenca, 
	' '						ie_tempo_doenca, 
	0						cd_cns, 
	f.cd_cnes					cd_cnes, 
	'CRM'						nr_seq_conselho, 
	a.nr_crm_medico_resp				nr_crm, 
	a.uf_crm_medico_resp				uf_crm, 
	' '						cd_cbos, 
	'081'						tp_logradouro, 
	substr(obter_compl_pf(a.cd_paciente,1,'EN'),1,50) ds_logradouro, 
	coalesce(somente_numero(substr(obter_compl_pf(a.cd_paciente,1,'NR'),1,4)),0) nr_endereco, 
	substr(obter_compl_pf(a.cd_paciente,1,'CO'),1,50) ds_complemento, 
	substr(obter_compl_pf(a.cd_paciente,1,'DM'),1,50) ds_municipio, 
	substr(obter_compl_pf(a.cd_paciente,1,'UF'),1,2) sg_uf, 
	coalesce(somente_numero(substr(obter_compl_pf(a.cd_paciente,1,'CDM'),1,10)),0) cd_ibge, 
	coalesce(somente_numero(substr(obter_compl_pf(a.cd_paciente,1,'CEP'),1,10)),0) cd_cep, 
	'CRM'						nr_seq_conselho_solic,	 
	b.nr_crm_solicitante				nr_crm_solic, 
	b.uf_crm_solicitante				uf_crm_solic, 
	' '						cd_cbos_solic, 
	a.cd_motivo_alta				ie_tipo_saida, 
	b.ie_tipo_guia					ie_tipo_guia, 
	0						qt_prematuros, 
	0						cd_cnes_solic, 
	substr(b.nm_medico_solicitante,1,70)		nm_contratado, 
	1						nr_regime_internacao, 
	coalesce(somente_numero(b.cd_autorizacao),0)		nr_guia, 
	b.cd_senha_guia					cd_senha_autorizacao, 
	CASE WHEN coalesce(c.nr_gestante_pre_natal,0)=0 THEN 'N'  ELSE 'S' END  ie_gestacao, 
	'N'						ie_transtorno, 
	'N'						ie_complicacao, 
	00						cd_funcao_executor, 
	' '						cd_item, 
	' '						ds_item, 
	' '						ie_emergencia, 
	' '						ie_extra, 
	LOCALTIMESTAMP						dt_item, 
	0						ie_funcao_medico, 
	0						qt_item, 
	0						vl_item, 
	0						ie_cirurgia_multipla, 
	' '						ds_unidade_medida, 
	0						cd_classif_item, 
	' '						nr_cpf_executor, 
	' '						nm_medico_executor, 
	' '						cd_crm_executor, 
	' '						nr_crm_executor,	 
	' '						uf_crm_executor, 
	' '						cd_executor_operadora, 
	0						cd_pacote, 
	0						vl_pacote, 
	0						ie_tipo_cirurgia, 
	LOCALTIMESTAMP						hr_inicial, 
	LOCALTIMESTAMP						hr_final, 
	' '						cd_edicao_amb, 
	0						qt_item_autorizado, 
	' '						ie_tecnica, 
	' '						cd_barra_opm, 
	' '						nm_fabricante, 
	0						qt_embalagem, 
	' '						cd_centro_custo, 
	0						qt_solicitada, 
	' '						nr_cpf_medico, 
	0						nr_guia_autoriz, 
	' '						cd_senha, 
	0						qt_item_conta, 
	0						vl_total_item, 
	' '						nm_paciente, 
	0						cd_unid_atend, 
	0						qt_diaria_enf, 
	0						qt_diaria_uti, 
	0						cd_ura, 
	' '						cd_cpf_exec, 
	' '						nm_medico_exec, 
	' '						cd_cpf_solic, 
	' '						nm_medico_solic, 
	' '						ds_indicacao_clinica, 
	' '						ds_observacao, 
	0						nr_guia_autorizacao, 
	0						nr_fatura, 
	0						qt_conta_lote, 
	0						vl_total_lote, 
	0						nr_documento, 
	0						qt_total_conta, 
	0						vl_total_conta, 
	0						nr_seq_item 
FROM sus_parametros f, estabelecimento d, atendimento_paciente c, w_interf_conta_cab a
LEFT OUTER JOIN w_interf_conta_autor b ON (a.nr_interno_conta = b.nr_interno_conta)
WHERE a.nr_atendimento	= c.nr_atendimento and c.cd_estabelecimento	= d.cd_estabelecimento and f.cd_estabelecimento	= d.cd_estabelecimento 
 
union all
 
select	'item da conta		' 			ds_registro, 
	2						tp_registro, 
	'CSMH'						ie_servico, 
	w.nr_seq_protocolo				nr_seq_protocolo, 
	0						cd_origem, 
	x.nr_remessa					nr_lote, 
	w.nr_interno_conta				nr_interno_conta, 
	0						nr_parcela, 
	0						cd_convenio, 
	' '						nm_convenio, 
	' '						tp_prestador, 
	' '						cd_prestador, 
	' '						nm_prestador, 
	LOCALTIMESTAMP						dt_geracao, 
	0						nr_remessa, 
	0						cd_ans, 
	' '						ds_plano, 
	LOCALTIMESTAMP						dt_entrada, 
	LOCALTIMESTAMP						dt_alta, 
	LOCALTIMESTAMP						dt_inicio_cobranca, 
	LOCALTIMESTAMP						dt_fim_cobranca, 
	' '						cd_cid, 
	0						cd_proc_principal, 
	0						nr_protocolo, 
	0						ie_tipo_nascimento, 
	' '						ie_aborto, 
	' '						ie_obito_materno, 
	' '						ie_atend_rn, 
	' '						ie_neonatal, 
	' '						ie_baixo_peso, 
	' '						ie_parto_cesario, 
	' '						ie_laudo_medico, 
	' '						ie_laudo_prorrog, 
	LOCALTIMESTAMP						dt_autorizacao, 
	LOCALTIMESTAMP						dt_validade_carteira, 
	0						nr_prontuario, 
	' '						ie_tipo_docto, 
	' '						nr_doc_paciente, 
	0						ie_tipo_internacao, 
	' '						cd_usuario_convenio, 
	0						cd_acomodacao, 
	0						ie_tipo_atendimento, 
	' '						ie_carater_inter, 
	0						qt_nascidos_vivos, 
	0						qt_nascidos_mortos, 
	0						nr_seq_acidente, 
	' '						ie_faturamento, 
	' '						ie_tipo_consulta, 
	LOCALTIMESTAMP						dt_solicitacao, 
	LOCALTIMESTAMP						dt_validade_senha, 
	' '						nm_pessoa_autorizou, 
	' '						cd_autorizacao, 
	LOCALTIMESTAMP						dt_emissao, 
	' '						nm_titular, 
	0						nr_declaracao_vivos, 
	0						nr_declaracao_obito, 
	' '						cd_cid_obito, 
	' '						cd_cid2, 
	' '						cd_cid3, 
	' '						cd_cid4, 
	0						nr_obito_precoce, 
	0						nr_obito_tardio, 
	' '						ie_tipo_doenca, 
	' '						ie_tempo_doenca, 
	0						cd_cns, 
	0						cd_cnes, 
	' '						nr_seq_conselho, 
	' '						nr_crm, 
	' '						uf_crm, 
	' '						cd_cbos, 
	' '						tp_logradouro, 
	' '						ds_logradouro, 
	0						nr_endereco, 
	' '						ds_complemento, 
	' '						ds_municipio, 
	' '						sg_uf, 
	0						cd_ibge, 
	0						cd_cep, 
	' '						nr_seq_conselho_solic,	 
	' '						nr_crm_solic, 
	' '						uf_crm_solic, 
	' '						cd_cbos_solic, 
	0						ie_tipo_saida, 
	' '						ie_tipo_guia, 
	0						qt_prematuros, 
	0						cd_cnes_solic, 
	' '						nm_contratado, 
	1						nr_regime_internacao, 
	0						nr_guia, 
	' '						cd_senha_autorizacao, 
	' '						ie_gestacao, 
	' '						ie_transtorno, 
	' '						ie_complicacao, 
	00						cd_funcao_executor, 
	c.cd_item_convenio				cd_item, 
	substr(elimina_acentuacao(upper(c.ds_item)),1,50) ds_item, 
	CASE WHEN w.ie_carater_inter='U' THEN 'S'  ELSE 'N' END 		ie_emergencia, 
	CASE WHEN c.pr_hora_extra=0 THEN 'N' WHEN c.pr_hora_extra=1 THEN 'N' WHEN c.pr_hora_extra IS NULL THEN 'N'  ELSE 'S' END  ie_extra, 
	c.dt_item					dt_item, 
	c.cd_funcao_executor				ie_funcao_medico, 
	coalesce(c.qt_item,0)				qt_item, 
	coalesce(c.vl_total_item,0)				vl_item, 
	0						ie_cirurgia_multipla, 
	c.cd_unidade_medida				ds_unidade_medida, 
	c.ie_tipo_item					cd_classif_item, 
	c.nr_cpf_executor				nr_cpf_executor, 
	substr(elimina_acentuacao(upper(c.nm_medico_executor)),1,70) nm_medico_executor, 
	'CRM'						cd_crm_executor, 
	c.nr_crm_executor				nr_crm_executor,	 
	c.uf_crm_executor				uf_crm_executor, 
	c.cd_medico_exec_conv				cd_executor_operadora, 
	0						cd_pacote, 
	0						vl_pacote, 
	CASE WHEN c.pr_via_acesso=100 THEN  1 WHEN c.pr_via_acesso=70 THEN  2  ELSE 3 END 	ie_tipo_cirurgia, 
	c.dt_item					hr_inicial, 
	c.dt_item					hr_final, 
	substr(obter_edicao_amb(e.cd_estabelecimento, w.cd_convenio, w.cd_categoria_convenio, f.dt_autorizacao),1,2) cd_edicao_amb, 
	0						qt_item_autorizado, 
	'C'						ie_tecnica, 
	' '						cd_barra_opm, 
	' '						nm_fabricante, 
	0						qt_embalagem, 
	' '						cd_centro_custo, 
	coalesce(f.qt_proc_solicitado,0)			qt_solicitada, 
	' '						nr_cpf_medico, 
	coalesce(somente_numero(f.cd_autorizacao),0)		nr_guia_autoriz, 
	w.cd_senha_guia					cd_senha, 
	0						qt_item_conta, 
	0						vl_total_item, 
	' '						nm_paciente, 
	0						cd_unid_atend, 
	0						qt_diaria_enf, 
	0						qt_diaria_uti, 
	0						cd_ura, 
	' '						cd_cpf_exec, 
	' '						nm_medico_exec, 
	' '						cd_cpf_solic, 
	' '						nm_medico_solic, 
	' '						ds_indicacao_clinica, 
	' '						ds_observacao, 
	0						nr_guia_autorizacao, 
	0						nr_fatura, 
	0						qt_conta_lote, 
	0						vl_total_lote, 
	0						nr_documento, 
	0						qt_total_conta, 
	0						vl_total_conta, 
	c.nr_sequencia					nr_seq_item 
FROM w_interf_conta_header x, atendimento_paciente e, w_interf_conta_item c, w_interf_conta_cab w
LEFT OUTER JOIN w_interf_conta_autor f ON (w.nr_interno_conta = f.nr_interno_conta)
WHERE e.nr_atendimento	= w.nr_atendimento  and w.nr_interno_conta	= c.nr_interno_conta and x.nr_seq_protocolo	= w.nr_seq_protocolo and c.ie_tipo_item		= 1 group by	c.nr_sequencia, 
		w.nr_seq_protocolo, 
		x.nr_remessa, 
		w.nr_interno_conta, 
		c.cd_item_convenio, 
		substr(elimina_acentuacao(upper(c.ds_item)),1,50), 
		CASE WHEN w.ie_carater_inter='U' THEN 'S'  ELSE 'N' END , 
		CASE WHEN c.pr_hora_extra=0 THEN 'N' WHEN c.pr_hora_extra=1 THEN 'N' WHEN c.pr_hora_extra IS NULL THEN 'N'  ELSE 'S' END , 
		c.dt_item, 
		c.cd_funcao_executor, 
		coalesce(c.qt_item,0), 
		coalesce(c.vl_total_item,0), 
		c.cd_unidade_medida, 
		c.ie_tipo_item, 
		c.nr_cpf_executor, 
		substr(elimina_acentuacao(upper(c.nm_medico_executor)),1,70), 
		c.nr_crm_executor, 
		c.uf_crm_executor, 
		c.cd_medico_exec_conv, 
		CASE WHEN c.pr_via_acesso=100 THEN  1 WHEN c.pr_via_acesso=70 THEN  2  ELSE 3 END , 
		c.dt_item, 
		substr(obter_edicao_amb(e.cd_estabelecimento, w.cd_convenio, w.cd_categoria_convenio, f.dt_autorizacao),1,2), 
		coalesce(f.qt_proc_solicitado,0), 
		coalesce(somente_numero(f.cd_autorizacao),0), 
		w.cd_senha_guia 

union all
 
select	'item da conta		' 			ds_registro, 
	2						tp_registro, 
	'CSMH'						ie_servico, 
	w.nr_seq_protocolo				nr_seq_protocolo, 
	0						cd_origem, 
	0						nr_lote, 
	w.nr_interno_conta				nr_interno_conta, 
	0						nr_parcela, 
	0						cd_convenio, 
	' '						nm_convenio, 
	' '						tp_prestador, 
	' '						cd_prestador, 
	' '						nm_prestador, 
	LOCALTIMESTAMP						dt_geracao, 
	0						nr_remessa, 
	0						cd_ans, 
	' '						ds_plano, 
	LOCALTIMESTAMP						dt_entrada, 
	LOCALTIMESTAMP						dt_alta, 
	LOCALTIMESTAMP						dt_inicio_cobranca, 
	LOCALTIMESTAMP						dt_fim_cobranca, 
	' '						cd_cid, 
	0						cd_proc_principal, 
	0						nr_protocolo, 
	0						ie_tipo_nascimento, 
	' '						ie_aborto, 
	' '						ie_obito_materno, 
	' '						ie_atend_rn, 
	' '						ie_neonatal, 
	' '						ie_baixo_peso, 
	' '						ie_parto_cesario, 
	' '						ie_laudo_medico, 
	' '						ie_laudo_prorrog, 
	LOCALTIMESTAMP						dt_autorizacao, 
	LOCALTIMESTAMP						dt_validade_carteira, 
	0						nr_prontuario, 
	' '						ie_tipo_docto, 
	' '						nr_doc_paciente, 
	0						ie_tipo_internacao, 
	' '						cd_usuario_convenio, 
	0						cd_acomodacao, 
	0						ie_tipo_atendimento, 
	' '						ie_carater_inter, 
	0						qt_nascidos_vivos, 
	0						qt_nascidos_mortos, 
	0						nr_seq_acidente, 
	' '						ie_faturamento, 
	' '						ie_tipo_consulta, 
	LOCALTIMESTAMP						dt_solicitacao, 
	LOCALTIMESTAMP						dt_validade_senha, 
	' '						nm_pessoa_autorizou, 
	' '						cd_autorizacao, 
	LOCALTIMESTAMP						dt_emissao, 
	' '						nm_titular, 
	0						nr_declaracao_vivos, 
	0						nr_declaracao_obito, 
	' '						cd_cid_obito, 
	' '						cd_cid2, 
	' '						cd_cid3, 
	' '						cd_cid4, 
	0						nr_obito_precoce, 
	0						nr_obito_tardio, 
	' '						ie_tipo_doenca, 
	' '						ie_tempo_doenca, 
	0						cd_cns, 
	0						cd_cnes, 
	' '						nr_seq_conselho, 
	' '						nr_crm, 
	' '						uf_crm, 
	' '						cd_cbos, 
	' '						tp_logradouro, 
	' '						ds_logradouro, 
	0						nr_endereco, 
	' '						ds_complemento, 
	' '						ds_municipio, 
	' '						sg_uf, 
	0						cd_ibge, 
	0						cd_cep, 
	' '						nr_seq_conselho_solic,	 
	' '						nr_crm_solic, 
	' '						uf_crm_solic, 
	' '						cd_cbos_solic, 
	0						ie_tipo_saida, 
	' '						ie_tipo_guia, 
	0						qt_prematuros, 
	0						cd_cnes_solic, 
	' '						nm_contratado, 
	1						nr_regime_internacao, 
	0						nr_guia, 
	' '						cd_senha_autorizacao, 
	' '						ie_gestacao, 
	' '						ie_transtorno, 
	' '						ie_complicacao, 
	00						cd_funcao_executor, 
	c.cd_item_convenio				cd_item, 
	substr(elimina_acentuacao(upper(c.ds_item)),1,50) ds_item, 
	CASE WHEN w.ie_carater_inter='U' THEN 'S'  ELSE 'N' END 		ie_emergencia, 
	CASE WHEN c.pr_hora_extra=0 THEN 'N' WHEN c.pr_hora_extra=1 THEN 'N' WHEN c.pr_hora_extra IS NULL THEN 'N'  ELSE 'S' END  ie_extra, 
	c.dt_item					dt_item, 
	c.cd_funcao_executor				ie_funcao_medico, 
	coalesce(c.qt_item,0)				qt_item, 
	coalesce(c.vl_total_item,0)				vl_item, 
	0						ie_cirurgia_multipla, 
	c.cd_unidade_medida				ds_unidade_medida, 
	c.ie_tipo_item					cd_classif_item, 
	c.nr_cpf_executor				nr_cpf_executor, 
	substr(elimina_acentuacao(upper(c.nm_medico_executor)),1,70) nm_medico_executor, 
	'CRM'						cd_crm_executor, 
	c.nr_crm_executor				nr_crm_executor,	 
	c.uf_crm_executor				uf_crm_executor, 
	c.cd_medico_exec_conv				cd_executor_operadora, 
	0						cd_pacote, 
	0						vl_pacote, 
	CASE WHEN c.pr_via_acesso=100 THEN  1 WHEN c.pr_via_acesso=70 THEN  2  ELSE 3 END 	ie_tipo_cirurgia, 
	c.dt_item					hr_inicial, 
	c.dt_item					hr_final, 
	substr(obter_edicao_amb(e.cd_estabelecimento, w.cd_convenio, w.cd_categoria_convenio, f.dt_autorizacao),1,2) cd_edicao_amb, 
	0						qt_item_autorizado, 
	'C'						ie_tecnica, 
	' '						cd_barra_opm, 
	' '						nm_fabricante, 
	0						qt_embalagem, 
	' '						cd_centro_custo, 
	coalesce(f.qt_proc_solicitado,0)			qt_solicitada, 
	' '						nr_cpf_medico, 
	coalesce(somente_numero(w.nr_doc_convenio),0)	nr_guia_autoriz, 
	w.cd_senha_guia					cd_senha, 
	0						qt_item_conta, 
	0						vl_total_item, 
	' '						nm_paciente, 
	0						cd_unid_atend, 
	0						qt_diaria_enf, 
	0						qt_diaria_uti, 
	0						cd_ura, 
	' '						cd_cpf_exec, 
	' '						nm_medico_exec, 
	' '						cd_cpf_solic, 
	' '						nm_medico_solic, 
	' '						ds_indicacao_clinica, 
	' '						ds_observacao, 
	0						nr_guia_autorizacao, 
	0						nr_fatura, 
	0						qt_conta_lote, 
	0						vl_total_lote, 
	0						nr_documento, 
	0						qt_total_conta, 
	0						vl_total_conta, 
	c.nr_sequencia					nr_seq_item 
FROM w_interf_conta_header x, atendimento_paciente e, w_interf_conta_item c, w_interf_conta_cab w
LEFT OUTER JOIN w_interf_conta_autor f ON (w.nr_interno_conta = f.nr_interno_conta)
WHERE e.nr_atendimento	= w.nr_atendimento  and w.nr_interno_conta	= c.nr_interno_conta and x.nr_seq_protocolo	= w.nr_seq_protocolo and c.ie_tipo_item		= 2 group by	c.nr_sequencia, 
		w.nr_seq_protocolo, 
		x.nr_remessa, 
		w.nr_interno_conta, 
		c.cd_item_convenio, 
		substr(elimina_acentuacao(upper(c.ds_item)),1,50), 
		CASE WHEN w.ie_carater_inter='U' THEN 'S'  ELSE 'N' END , 
		CASE WHEN c.pr_hora_extra=0 THEN 'N' WHEN c.pr_hora_extra=1 THEN 'N' WHEN c.pr_hora_extra IS NULL THEN 'N'  ELSE 'S' END , 
		c.dt_item, 
		c.cd_funcao_executor, 
		coalesce(c.qt_item,0), 
		coalesce(c.vl_total_item,0), 
		c.cd_unidade_medida, 
		c.ie_tipo_item, 
		c.nr_cpf_executor, 
		substr(elimina_acentuacao(upper(c.nm_medico_executor)),1,70), 
		c.nr_crm_executor, 
		c.uf_crm_executor, 
		c.cd_medico_exec_conv, 
		CASE WHEN c.pr_via_acesso=100 THEN  1 WHEN c.pr_via_acesso=70 THEN  2  ELSE 3 END , 
		c.dt_item, 
		substr(obter_edicao_amb(e.cd_estabelecimento, w.cd_convenio, w.cd_categoria_convenio, f.dt_autorizacao),1,2), 
		coalesce(f.qt_proc_solicitado,0), 
		coalesce(somente_numero(w.nr_doc_convenio),0), 
		w.cd_senha_guia 

union all
 
select	'total da conta		' 			ds_registro, 
	3						tp_registro, 
	'CSMH'						ie_servico, 
	c.nr_seq_protocolo				nr_seq_protocolo, 
	0						cd_origem, 
	0						nr_lote, 
	c.nr_interno_conta				nr_interno_conta, 
	0						nr_parcela, 
	0						cd_convenio, 
	' '						nm_convenio, 
	' '						tp_prestador, 
	' '						cd_prestador, 
	' '						nm_prestador, 
	LOCALTIMESTAMP						dt_geracao, 
	0						nr_remessa, 
	0						cd_ans, 
	' '						ds_plano, 
	LOCALTIMESTAMP						dt_entrada, 
	LOCALTIMESTAMP						dt_alta, 
	LOCALTIMESTAMP						dt_inicio_cobranca, 
	LOCALTIMESTAMP						dt_fim_cobranca, 
	' '						cd_cid, 
	0						cd_proc_principal, 
	0						nr_protocolo, 
	0						ie_tipo_nascimento, 
	' '						ie_aborto, 
	' '						ie_obito_materno, 
	' '						ie_atend_rn, 
	' '						ie_neonatal, 
	' '						ie_baixo_peso, 
	' '						ie_parto_cesario, 
	' '						ie_laudo_medico, 
	' '						ie_laudo_prorrog, 
	LOCALTIMESTAMP						dt_autorizacao, 
	LOCALTIMESTAMP						dt_validade_carteira, 
	0						nr_prontuario, 
	' '						ie_tipo_docto, 
	' '						nr_doc_paciente, 
	0						ie_tipo_internacao, 
	' '						cd_usuario_convenio, 
	0						cd_acomodacao, 
	0						ie_tipo_atendimento, 
	' '						ie_carater_inter, 
	0						qt_nascidos_vivos, 
	0						qt_nascidos_mortos, 
	0						nr_seq_acidente, 
	' '						ie_faturamento, 
	' '						ie_tipo_consulta, 
	LOCALTIMESTAMP						dt_solicitacao, 
	LOCALTIMESTAMP						dt_validade_senha, 
	' '						nm_pessoa_autorizou, 
	' '						cd_autorizacao, 
	LOCALTIMESTAMP						dt_emissao, 
	' '						nm_titular, 
	0						nr_declaracao_vivos, 
	0						nr_declaracao_obito, 
	' '						cd_cid_obito, 
	' '						cd_cid2, 
	' '						cd_cid3, 
	' '						cd_cid4, 
	0						nr_obito_precoce, 
	0						nr_obito_tardio, 
	' '						ie_tipo_doenca, 
	' '						ie_tempo_doenca, 
	0						cd_cns, 
	0						cd_cnes, 
	' '						nr_seq_conselho, 
	' '						nr_crm, 
	' '						uf_crm, 
	' '						cd_cbos, 
	' '						tp_logradouro, 
	' '						ds_logradouro, 
	0						nr_endereco, 
	' '						ds_complemento, 
	' '						ds_municipio, 
	' '						sg_uf, 
	0						cd_ibge, 
	0						cd_cep, 
	' '						nr_seq_conselho_solic,	 
	' '						nr_crm_solic, 
	' '						uf_crm_solic, 
	' '						cd_cbos_solic, 
	0						ie_tipo_saida, 
	' '						ie_tipo_guia, 
	0						qt_prematuros, 
	0						cd_cnes_solic, 
	' '						nm_contratado, 
	1						nr_regime_internacao, 
	0						nr_guia, 
	' '						cd_senha_autorizacao, 
	' '						ie_gestacao, 
	' '						ie_transtorno, 
	' '						ie_complicacao, 
	00						cd_funcao_executor, 
	' '						cd_item, 
	' '						ds_item, 
	' '						ie_emergencia, 
	' '						ie_extra, 
	LOCALTIMESTAMP						dt_item, 
	0						ie_funcao_medico, 
	0						qt_item, 
	0						vl_item, 
	0						ie_cirurgia_multipla, 
	' '						ds_unidade_medida, 
	0						cd_classif_item, 
	' '						nr_cpf_executor, 
	' '						nm_medico_executor, 
	' '						cd_crm_executor, 
	' '						nr_crm_executor,	 
	' '						uf_crm_executor, 
	' '						cd_executor_operadora, 
	0						cd_pacote, 
	0						vl_pacote, 
	0						ie_tipo_cirurgia, 
	LOCALTIMESTAMP						hr_inicial, 
	LOCALTIMESTAMP						hr_final, 
	' '						cd_edicao_amb, 
	0						qt_item_autorizado, 
	' '						ie_tecnica, 
	' '						cd_barra_opm, 
	' '						nm_fabricante, 
	0						qt_embalagem, 
	' '						cd_centro_custo, 
	0						qt_solicitada, 
	' '						nr_cpf_medico, 
	coalesce(somente_numero(b.cd_autorizacao),0)		nr_guia_autoriz, 
	' '						cd_senha, 
	coalesce(a.qt_item_conta,0)				qt_item_conta, 
	coalesce(a.vl_total_conta,0)				vl_total_item, 
	substr(elimina_acentuacao(upper(c.nm_paciente)),1,70) nm_paciente, 
	c.cd_setor_atendimento				cd_unid_atend, 
	coalesce(a.qt_diarias,0)				qt_diaria_enf, 
	0						qt_diaria_uti, 
	0						cd_ura, 
	c.nr_cpf_medico_resp				cd_cpf_exec, 
	substr(elimina_acentuacao(upper(c.nm_medico_resp)),1,40) nm_medico_exec, 
	coalesce(max(b.nr_cpf_solicitante),' ')		cd_cpf_solic, 
	coalesce(max(substr(elimina_acentuacao(upper(b.nm_medico_solicitante)),1,40)),' ') nm_medico_solic, 
	substr(obter_desc_cid(max(coalesce(c.cd_cid_principal,0))),1,100) ds_indicacao_clinica, 
	' '						ds_observacao, 
	coalesce(somente_numero(b.cd_autorizacao),0)		nr_guia_autorizacao, 
	0						nr_fatura, 
	0						qt_conta_lote, 
	0						vl_total_lote, 
	0						nr_documento, 
	0						qt_total_conta, 
	0						vl_total_conta, 
	a.nr_sequencia					nr_seq_item 
FROM w_interf_conta_total a, w_interf_conta_cab c
LEFT OUTER JOIN w_interf_conta_autor b ON (c.nr_interno_conta = b.nr_interno_conta)
WHERE c.nr_interno_conta	= a.nr_interno_conta  group by	a.nr_sequencia, 
		c.nr_seq_protocolo, 
		c.nr_interno_conta, 
		substr(elimina_acentuacao(upper(c.nm_paciente)),1,70), 
		coalesce(a.qt_item_conta,0), 
		coalesce(a.vl_total_conta,0), 
		c.cd_setor_atendimento, 
		coalesce(a.qt_diarias,0), 
		c.nr_cpf_medico_resp, 
		substr(elimina_acentuacao(upper(c.nm_medico_resp)),1,40), 
		coalesce(somente_numero(b.cd_autorizacao),0) 

union all
 
select	'fim do lote		' 			ds_registro, 
	4						tp_registro, 
	'CSMH'						ie_servico, 
	a.nr_seq_protocolo				nr_seq_protocolo, 
	0						cd_origem, 
	b.nr_remessa					nr_lote, 
	a.nr_interno_conta				nr_interno_conta, 
	0						nr_parcela, 
	0						cd_convenio, 
	' '						nm_convenio, 
	' '						tp_prestador, 
	' '						cd_prestador, 
	' '						nm_prestador, 
	LOCALTIMESTAMP						dt_geracao, 
	0						nr_remessa, 
	0						cd_ans, 
	' '						ds_plano, 
	LOCALTIMESTAMP						dt_entrada, 
	LOCALTIMESTAMP						dt_alta, 
	LOCALTIMESTAMP						dt_inicio_cobranca, 
	LOCALTIMESTAMP						dt_fim_cobranca, 
	' '						cd_cid, 
	0						cd_proc_principal, 
	0						nr_protocolo, 
	0						ie_tipo_nascimento, 
	' '						ie_aborto, 
	' '						ie_obito_materno, 
	' '						ie_atend_rn, 
	' '						ie_neonatal, 
	' '						ie_baixo_peso, 
	' '						ie_parto_cesario, 
	' '						ie_laudo_medico, 
	' '						ie_laudo_prorrog, 
	LOCALTIMESTAMP						dt_autorizacao, 
	LOCALTIMESTAMP						dt_validade_carteira, 
	0						nr_prontuario, 
	' '						ie_tipo_docto, 
	' '						nr_doc_paciente, 
	0						ie_tipo_internacao, 
	' '						cd_usuario_convenio, 
	0						cd_acomodacao, 
	0						ie_tipo_atendimento, 
	' '						ie_carater_inter, 
	0						qt_nascidos_vivos, 
	0						qt_nascidos_mortos, 
	0						nr_seq_acidente, 
	' '						ie_faturamento, 
	' '						ie_tipo_consulta, 
	LOCALTIMESTAMP						dt_solicitacao, 
	LOCALTIMESTAMP						dt_validade_senha, 
	' '						nm_pessoa_autorizou, 
	' '						cd_autorizacao, 
	LOCALTIMESTAMP						dt_emissao, 
	' '						nm_titular, 
	0						nr_declaracao_vivos, 
	0						nr_declaracao_obito, 
	' '						cd_cid_obito, 
	' '						cd_cid2, 
	' '						cd_cid3, 
	' '						cd_cid4, 
	0						nr_obito_precoce, 
	0						nr_obito_tardio, 
	' '						ie_tipo_doenca, 
	' '						ie_tempo_doenca, 
	0						cd_cns, 
	0						cd_cnes, 
	' '						nr_seq_conselho, 
	' '						nr_crm, 
	' '						uf_crm, 
	' '						cd_cbos, 
	' '						tp_logradouro, 
	' '						ds_logradouro, 
	0						nr_endereco, 
	' '						ds_complemento, 
	' '						ds_municipio, 
	' '						sg_uf, 
	0						cd_ibge, 
	0						cd_cep, 
	' '						nr_seq_conselho_solic,	 
	' '						nr_crm_solic, 
	' '						uf_crm_solic, 
	' '						cd_cbos_solic, 
	0						ie_tipo_saida, 
	' '						ie_tipo_guia, 
	0						qt_prematuros, 
	0						cd_cnes_solic, 
	' '						nm_contratado, 
	1						nr_regime_internacao, 
	0						nr_guia, 
	' '						cd_senha_autorizacao, 
	' '						ie_gestacao, 
	' '						ie_transtorno, 
	' '						ie_complicacao, 
	00						cd_funcao_executor, 
	' '						cd_item, 
	' '						ds_item, 
	' '						ie_emergencia, 
	' '						ie_extra, 
	LOCALTIMESTAMP						dt_item, 
	0						ie_funcao_medico, 
	0						qt_item, 
	0						vl_item, 
	0						ie_cirurgia_multipla, 
	' '						ds_unidade_medida, 
	0						cd_classif_item, 
	' '						nr_cpf_executor, 
	' '						nm_medico_executor, 
	' '						cd_crm_executor, 
	' '						nr_crm_executor,	 
	' '						uf_crm_executor, 
	' '						cd_executor_operadora, 
	0						cd_pacote, 
	0						vl_pacote, 
	0						ie_tipo_cirurgia, 
	LOCALTIMESTAMP						hr_inicial, 
	LOCALTIMESTAMP						hr_final, 
	' '						cd_edicao_amb, 
	0						qt_item_autorizado, 
	' '						ie_tecnica, 
	' '						cd_barra_opm, 
	' '						nm_fabricante, 
	0						qt_embalagem, 
	' '						cd_centro_custo, 
	0						qt_solicitada, 
	' '						nr_cpf_medico, 
	0						nr_guia_autoriz, 
	' '						cd_senha, 
	0						qt_item_conta, 
	0						vl_total_item, 
	' '						nm_paciente, 
	0						cd_unid_atend, 
	0						qt_diaria_enf, 
	0						qt_diaria_uti, 
	0						cd_ura, 
	' '						cd_cpf_exec, 
	' '						nm_medico_exec, 
	' '						cd_cpf_solic, 
	' '						nm_medico_solic, 
	' '						ds_indicacao_clinica, 
	' '						ds_observacao, 
	0						nr_guia_autorizacao, 
	a.nr_remessa					nr_fatura, 
	coalesce(sum(a.qt_item_conta),0)			qt_conta_lote, 
	coalesce(sum(a.vl_total_conta),0)			vl_total_lote, 
	0						nr_documento, 
	0						qt_total_conta, 
	0						vl_total_conta, 
	0						nr_seq_item 
from	w_interf_conta_header b, 
	w_interf_conta_total a 
where	a.nr_seq_protocolo	= b.nr_seq_protocolo 
group by	a.nr_seq_protocolo, 
		a.nr_interno_conta, 
		a.nr_remessa, 
		b.nr_remessa 

union all
 
select	'trailler		' 			ds_registro, 
	9						tp_registro, 
	'CSMH'						ie_servico, 
	a.nr_seq_protocolo				nr_seq_protocolo, 
	0						cd_origem, 
	9						nr_lote, 
	99999999					nr_interno_conta, 
	9						nr_parcela, 
	0						cd_convenio, 
	' '						nm_convenio, 
	' '						tp_prestador, 
	' '						cd_prestador, 
	' '						nm_prestador, 
	LOCALTIMESTAMP						dt_geracao, 
	0						nr_remessa, 
	0						cd_ans, 
	' '						ds_plano, 
	LOCALTIMESTAMP						dt_entrada, 
	LOCALTIMESTAMP						dt_alta, 
	LOCALTIMESTAMP						dt_inicio_cobranca, 
	LOCALTIMESTAMP						dt_fim_cobranca, 
	' '						cd_cid, 
	0						cd_proc_principal, 
	0						nr_protocolo, 
	0						ie_tipo_nascimento, 
	' '						ie_aborto, 
	' '						ie_obito_materno, 
	' '						ie_atend_rn, 
	' '						ie_neonatal, 
	' '						ie_baixo_peso, 
	' '						ie_parto_cesario, 
	' '						ie_laudo_medico, 
	' '						ie_laudo_prorrog, 
	LOCALTIMESTAMP						dt_autorizacao, 
	LOCALTIMESTAMP						dt_validade_carteira, 
	0						nr_prontuario, 
	' '						ie_tipo_docto, 
	' '						nr_doc_paciente, 
	0						ie_tipo_internacao, 
	' '						cd_usuario_convenio, 
	0						cd_acomodacao, 
	0						ie_tipo_atendimento, 
	' '						ie_carater_inter, 
	0						qt_nascidos_vivos, 
	0						qt_nascidos_mortos, 
	0						nr_seq_acidente, 
	' '						ie_faturamento, 
	' '						ie_tipo_consulta, 
	LOCALTIMESTAMP						dt_solicitacao, 
	LOCALTIMESTAMP						dt_validade_senha, 
	' '						nm_pessoa_autorizou, 
	' '						cd_autorizacao, 
	LOCALTIMESTAMP						dt_emissao, 
	' '						nm_titular, 
	0						nr_declaracao_vivos, 
	0						nr_declaracao_obito, 
	' '						cd_cid_obito, 
	' '						cd_cid2, 
	' '						cd_cid3, 
	' '						cd_cid4, 
	0						nr_obito_precoce, 
	0						nr_obito_tardio, 
	' '						ie_tipo_doenca, 
	' '						ie_tempo_doenca, 
	0						cd_cns, 
	0						cd_cnes, 
	' '						nr_seq_conselho, 
	' '						nr_crm, 
	' '						uf_crm, 
	' '						cd_cbos, 
	' '						tp_logradouro, 
	' '						ds_logradouro, 
	0						nr_endereco, 
	' '						ds_complemento, 
	' '						ds_municipio, 
	' '						sg_uf, 
	0						cd_ibge, 
	0						cd_cep, 
	' '						nr_seq_conselho_solic,	 
	' '						nr_crm_solic, 
	' '						uf_crm_solic, 
	' '						cd_cbos_solic, 
	0						ie_tipo_saida, 
	' '						ie_tipo_guia, 
	0						qt_prematuros, 
	0						cd_cnes_solic, 
	' '						nm_contratado, 
	1						nr_regime_internacao, 
	0						nr_guia, 
	' '						cd_senha_autorizacao, 
	' '						ie_gestacao, 
	' '						ie_transtorno, 
	' '						ie_complicacao, 
	00						cd_funcao_executor, 
	' '						cd_item, 
	' '						ds_item, 
	' '						ie_emergencia, 
	' '						ie_extra, 
	LOCALTIMESTAMP						dt_item, 
	0						ie_funcao_medico, 
	0						qt_item, 
	0						vl_item, 
	0						ie_cirurgia_multipla, 
	' '						ds_unidade_medida, 
	0						cd_classif_item, 
	' '						nr_cpf_executor, 
	' '						nm_medico_executor, 
	' '						cd_crm_executor, 
	' '						nr_crm_executor,	 
	' '						uf_crm_executor, 
	' '						cd_executor_operadora, 
	0						cd_pacote, 
	0						vl_pacote, 
	0						ie_tipo_cirurgia, 
	LOCALTIMESTAMP						hr_inicial, 
	LOCALTIMESTAMP						hr_final, 
	' '						cd_edicao_amb, 
	0						qt_item_autorizado, 
	' '						ie_tecnica, 
	' '						cd_barra_opm, 
	' '						nm_fabricante, 
	0						qt_embalagem, 
	' '						cd_centro_custo, 
	0						qt_solicitada, 
	' '						nr_cpf_medico, 
	0						nr_guia_autoriz, 
	' '						cd_senha, 
	0						qt_item_conta, 
	0						vl_total_item, 
	' '						nm_paciente, 
	0						cd_unid_atend, 
	0						qt_diaria_enf, 
	0						qt_diaria_uti, 
	0						cd_ura, 
	' '						cd_cpf_exec, 
	' '						nm_medico_exec, 
	' '						cd_cpf_solic, 
	' '						nm_medico_solic, 
	' '						ds_indicacao_clinica, 
	' '						ds_observacao, 
	0						nr_guia_autorizacao, 
	0						nr_fatura, 
	0						qt_conta_lote, 
	0						vl_total_lote, 
	9						nr_documento, 
	coalesce(sum(a.qt_total_conta),0)			qt_total_conta, 
	coalesce(sum(a.vl_total_conta),0)			vl_total_conta, 
	0						nr_seq_item 
from	w_interf_conta_trailler a 
group by	a.nr_seq_protocolo;

