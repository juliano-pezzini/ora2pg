-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pacientes_transf_painel_v (ds_convenio, ds_paciente, ds_medico, qtd_ui_uti, qtd_pa_ui_uti, dt_entrada_unidade) AS select	substr(a.ds_convenio,1,100) ds_convenio,
	substr(a.ds_paciente,1,100) ds_paciente,
	substr(a.ds_medico,1,100) ds_medico,
	(Select	Count(nr_atendimento)
	FROM 	PACIENTES_TRANSF_V b
	where	b.DT_ENTRADA_UNIDADE = a.DT_ENTRADA_UNIDADE
	and	b.ie_informacao = 'UI') qtd_UI_UTI,
	(Select	Count(nr_atendimento)
	from 	PACIENTES_TRANSF_V b
	where	b.DT_ENTRADA_UNIDADE = a.DT_ENTRADA_UNIDADE
	and 	b.ie_informacao = 'PA') qtd_PA_UI_UTI,
	dt_entrada_unidade
from 	PACIENTES_TRANSF_V a;

