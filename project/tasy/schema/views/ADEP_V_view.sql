-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW adep_v (cd_tipo_item, ie_tipo_item, ds_tipo_item, nr_atendimento, cd_paciente, nm_paciente, nr_prescricao, cd_prescritor, nm_prescritor, nr_seq_item, cd_item, ds_item, nr_seq_horario, nr_seq_execucao, dt_horario, dt_administracao, dt_suspensao, cd_executor, nm_executor, ie_execucao, ds_execucao) AS select	1 cd_tipo_item,
	'D' ie_tipo_item, 
	'Dieta oral' ds_tipo_item, 
	a.nr_atendimento, 
	a.cd_pessoa_fisica cd_paciente, 
	p.nm_pessoa_fisica nm_paciente, 
	a.nr_prescricao nr_prescricao, 
	a.cd_prescritor cd_prescritor, 
	t.nm_pessoa_fisica nm_prescritor, 
	0 nr_seq_item, 
	c.cd_refeicao cd_item, 
	r.ds_valor_dominio ds_item, 
	c.nr_sequencia nr_seq_horario, 
	d.nr_sequencia nr_seq_execucao, 
	c.dt_horario dt_horario, 
	c.dt_fim_horario dt_administracao, 
	c.dt_suspensao dt_suspensao, 
	d.cd_pessoa_fisica cd_executor, 
	l.nm_pessoa_fisica nm_executor, 
	d.ie_alteracao ie_execucao, 
	k.ds_valor_dominio ds_execucao 
FROM	valor_dominio k, 
	valor_dominio r, 
	pessoa_fisica l, 
	pessoa_fisica t, 
	pessoa_fisica p, 
	prescr_mat_alteracao d, 
	prescr_dieta_hor c, 
	prescr_medica a 
where	d.nr_seq_horario_dieta	= c.nr_sequencia 
and	c.nr_prescricao		= a.nr_prescricao 
and	a.cd_pessoa_fisica	= p.cd_pessoa_fisica 
and	a.cd_prescritor		= t.cd_pessoa_fisica 
and	d.cd_pessoa_fisica	= l.cd_pessoa_fisica 
and	c.cd_refeicao		= r.vl_dominio 
and	r.cd_dominio		= 99 
and	d.ie_alteracao		= k.vl_dominio 
and	k.cd_dominio		= 1620 
and	a.nr_atendimento is not null 
and	Obter_se_horario_liberado(c.dt_lib_horario, c.dt_horario) = 'S' 

union
 
select	2 cd_tipo_item, 
	'S' ie_tipo_item, 
	'Suplemento oral' ds_tipo_item, 
	a.nr_atendimento, 
	a.cd_pessoa_fisica cd_paciente, 
	p.nm_pessoa_fisica nm_paciente, 
	a.nr_prescricao nr_prescricao, 
	a.cd_prescritor cd_prescritor, 
	t.nm_pessoa_fisica nm_prescritor, 
	b.nr_sequencia nr_seq_item, 
	to_char(b.cd_material) cd_item, 
	m.ds_material ds_item, 
	c.nr_sequencia nr_seq_horario, 
	d.nr_sequencia nr_seq_execucao, 
	c.dt_horario dt_horario, 
	c.dt_fim_horario dt_administracao, 
	c.dt_suspensao dt_suspensao, 
	d.cd_pessoa_fisica cd_executor, 
	l.nm_pessoa_fisica nm_executor, 
	d.ie_alteracao ie_execucao, 
	k.ds_valor_dominio ds_execucao 
from	valor_dominio k, 
	pessoa_fisica l, 
	pessoa_fisica t, 
	pessoa_fisica p, 
	prescr_mat_alteracao d, 
	material m, 
	prescr_mat_hor c, 
	prescr_material b, 
	prescr_medica a 
where	d.nr_seq_horario	= c.nr_sequencia 
and	d.nr_seq_prescricao	= b.nr_sequencia 
and	d.nr_prescricao		= b.nr_prescricao 
and	c.nr_seq_material	= b.nr_sequencia 
and	c.nr_prescricao		= b.nr_prescricao 
and	a.cd_pessoa_fisica	= p.cd_pessoa_fisica 
and	a.cd_prescritor		= t.cd_pessoa_fisica 
and	d.cd_pessoa_fisica	= l.cd_pessoa_fisica 
and	b.cd_material		= m.cd_material 
and	d.ie_alteracao		= k.vl_dominio 
and	k.cd_dominio		= 1620 
and	b.ie_agrupador		= 12 
and	b.nr_prescricao		= a.nr_prescricao 
and	a.nr_atendimento is not null 
and	Obter_se_horario_liberado(c.dt_lib_horario, c.dt_horario) = 'S' 

union
 
select	3 cd_tipo_item, 
	'M' ie_tipo_item, 
	'Medicamentos' ds_tipo_item, 
	a.nr_atendimento, 
	a.cd_pessoa_fisica cd_paciente, 
	p.nm_pessoa_fisica nm_paciente, 
	a.nr_prescricao nr_prescricao, 
	a.cd_prescritor cd_prescritor, 
	t.nm_pessoa_fisica nm_prescritor, 
	b.nr_sequencia nr_seq_item, 
	to_char(b.cd_material) cd_item, 
	m.ds_material ds_item, 
	c.nr_sequencia nr_seq_horario, 
	d.nr_sequencia nr_seq_execucao, 
	c.dt_horario dt_horario, 
	c.dt_fim_horario dt_administracao, 
	c.dt_suspensao dt_suspensao, 
	d.cd_pessoa_fisica cd_executor, 
	l.nm_pessoa_fisica nm_executor, 
	d.ie_alteracao ie_execucao, 
	k.ds_valor_dominio ds_execucao 
from	valor_dominio k, 
	pessoa_fisica l, 
	pessoa_fisica t, 
	pessoa_fisica p, 
	prescr_mat_alteracao d, 
	material m, 
	prescr_mat_hor c, 
	prescr_material b, 
	prescr_medica a 
where	d.nr_seq_horario 	= c.nr_sequencia 
and	d.nr_seq_prescricao 	= b.nr_sequencia 
and	d.nr_prescricao 	= b.nr_prescricao 
and	c.nr_seq_material 	= b.nr_sequencia 
and	c.nr_prescricao 	= b.nr_prescricao 
and	a.cd_pessoa_fisica	= p.cd_pessoa_fisica 
and	a.cd_prescritor		= t.cd_pessoa_fisica 
and	d.cd_pessoa_fisica	= l.cd_pessoa_fisica 
and	b.cd_material		= m.cd_material 
and	d.ie_alteracao		= k.vl_dominio 
and	k.cd_dominio		= 1620 
and	b.ie_agrupador 		= 1 
and	b.nr_prescricao 	= a.nr_prescricao 
and	a.nr_atendimento is not null 
and	Obter_se_horario_liberado(c.dt_lib_horario, c.dt_horario) = 'S' 

union
 
select	4 cd_tipo_item, 
	'P' ie_tipo_item, 
	'Procedimentos' ds_tipo_item, 
	a.nr_atendimento, 
	a.cd_pessoa_fisica cd_paciente, 
	p.nm_pessoa_fisica nm_paciente, 
	a.nr_prescricao nr_prescricao, 
	a.cd_prescritor cd_prescritor, 
	t.nm_pessoa_fisica nm_prescritor, 
	b.nr_sequencia nr_seq_item, 
	to_char(b.cd_procedimento) cd_item, 
	substr(obter_desc_prescr_proc(b.cd_procedimento, b.ie_origem_proced, b.nr_seq_proc_interno),1,255) ds_item, 
	c.nr_sequencia nr_seq_horario, 
	d.nr_sequencia nr_seq_execucao, 
	c.dt_horario dt_horario, 
	c.dt_fim_horario dt_administracao, 
	c.dt_suspensao dt_suspensao, 
	d.cd_pessoa_fisica cd_executor, 
	l.nm_pessoa_fisica nm_executor, 
	d.ie_alteracao ie_execucao, 
	k.ds_valor_dominio ds_execucao 
from	valor_dominio k, 
	pessoa_fisica l, 
	pessoa_fisica t, 
	pessoa_fisica p, 
	prescr_mat_alteracao d, 
	prescr_proc_hor c, 
	prescr_procedimento b, 
	prescr_medica a 
where	d.nr_seq_horario_proc 	= c.nr_sequencia 
and	d.nr_seq_procedimento 	= b.nr_sequencia 
and	d.nr_prescricao 	= b.nr_prescricao 
and	c.nr_seq_procedimento 	= b.nr_sequencia 
and	c.nr_prescricao 	= b.nr_prescricao 
and	b.nr_prescricao 	= a.nr_prescricao 
and	a.cd_pessoa_fisica	= p.cd_pessoa_fisica 
and	a.cd_prescritor		= t.cd_pessoa_fisica 
and	d.cd_pessoa_fisica	= l.cd_pessoa_fisica 
and	d.ie_alteracao		= k.vl_dominio 
and	k.cd_dominio		= 1620 
and	a.nr_atendimento is not null 
and	Obter_se_horario_liberado(c.dt_lib_horario, c.dt_horario) = 'S' 

union
 
select	5 cd_tipo_item, 
	'R' ie_tipo_item, 
	'Recomendações' ds_tipo_item, 
	a.nr_atendimento, 
	a.cd_pessoa_fisica cd_paciente, 
	p.nm_pessoa_fisica nm_paciente, 
	a.nr_prescricao nr_prescricao, 
	a.cd_prescritor cd_prescritor, 
	t.nm_pessoa_fisica nm_prescritor, 
	b.nr_sequencia nr_seq_item, 
	to_char(b.cd_recomendacao) cd_item, 
	substr(obter_rec_prescricao(b.nr_sequencia, b.nr_prescricao),1,255) ds_item, 
	c.nr_sequencia nr_seq_horario, 
	d.nr_sequencia nr_seq_execucao, 
	c.dt_horario dt_horario, 
	c.dt_fim_horario dt_administracao, 
	c.dt_suspensao dt_suspensao, 
	d.cd_pessoa_fisica cd_executor, 
	l.nm_pessoa_fisica nm_executor, 
	d.ie_alteracao ie_execucao, 
	k.ds_valor_dominio ds_execucao 
from	valor_dominio k, 
	pessoa_fisica l, 
	pessoa_fisica t, 
	pessoa_fisica p, 
	prescr_mat_alteracao d, 
	prescr_rec_hor c, 
	prescr_recomendacao b, 
	prescr_medica a 
where	d.nr_seq_horario_rec 	= c.nr_sequencia 
and	d.nr_seq_recomendacao 	= b.nr_sequencia 
and	d.nr_prescricao 	= b.nr_prescricao 
and	c.nr_seq_recomendacao 	= b.nr_sequencia 
and	c.nr_prescricao 	= b.nr_prescricao 
and	b.nr_prescricao 	= a.nr_prescricao 
and	a.cd_pessoa_fisica	= p.cd_pessoa_fisica 
and	a.cd_prescritor		= t.cd_pessoa_fisica 
and	d.cd_pessoa_fisica	= l.cd_pessoa_fisica 
and	d.ie_alteracao		= k.vl_dominio 
and	k.cd_dominio		= 1620 
and	a.nr_atendimento is not null 
and	Obter_se_horario_liberado(c.dt_lib_horario, c.dt_horario) = 'S' 

union
 
select	6 cd_tipo_item, 
	'E' ie_tipo_item, 
	'SAE' ds_tipo_item, 
	a.nr_atendimento, 
	a.cd_pessoa_fisica cd_paciente, 
	p.nm_pessoa_fisica nm_paciente, 
	a.nr_sequencia nr_prescricao, 
	a.cd_prescritor cd_prescritor, 
	t.nm_pessoa_fisica nm_prescritor, 
	b.nr_sequencia nr_seq_item, 
	to_char(b.nr_seq_proc) cd_item, 
	substr(obter_desc_intervencoes(b.nr_seq_proc),1,255) ds_item, 
	c.nr_sequencia nr_seq_horario, 
	d.nr_sequencia nr_seq_execucao, 
	c.dt_horario dt_horario, 
	c.dt_fim_horario dt_administracao, 
	c.dt_suspensao dt_suspensao, 
	d.cd_pessoa_fisica cd_executor, 
	l.nm_pessoa_fisica nm_executor, 
	d.ie_alteracao ie_execucao, 
	k.ds_valor_dominio ds_execucao 
from	valor_dominio k, 
	pessoa_fisica l, 
	pessoa_fisica t, 
	pessoa_fisica p, 
	prescr_mat_alteracao d, 
	pe_prescr_proc_hor c, 
	pe_prescr_proc b, 
	pe_prescricao a 
where	d.nr_seq_horario_sae 	= c.nr_sequencia 
and	d.nr_seq_item_sae 	= b.nr_sequencia 
and	c.nr_seq_pe_proc 	= b.nr_sequencia 
and	b.nr_seq_prescr 	= a.nr_sequencia 
and	a.cd_pessoa_fisica	= p.cd_pessoa_fisica 
and	a.cd_prescritor		= t.cd_pessoa_fisica 
and	d.cd_pessoa_fisica	= l.cd_pessoa_fisica 
and	d.ie_alteracao		= k.vl_dominio 
and	k.cd_dominio		= 1620 
and	a.nr_atendimento is not null;

