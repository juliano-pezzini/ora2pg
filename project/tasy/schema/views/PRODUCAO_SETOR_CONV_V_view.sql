-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW producao_setor_conv_v (nr_atendimento, nr_interno_conta, nr_sequencia, ie_proc_mat, dt_conta, dt_item, cd_item, qt_item, vl_item, cd_convenio, cd_setor_atendimento, cd_motivo_exc_conta) AS select nr_atendimento,
	nr_interno_conta,
	nr_sequencia,
       1 ie_proc_mat,
       dt_conta,
       dt_procedimento      dt_item,
       cd_procedimento      cd_item,
       qt_procedimento      qt_item,
       vl_procedimento      vl_item,
       cd_convenio,
       cd_setor_atendimento,
	cd_motivo_exc_conta
FROM   procedimento_paciente a
where	coalesce(nr_seq_proc_pacote, 0) <> nr_sequencia

union

select nr_atendimento,
	nr_interno_conta,
	nr_sequencia,
       2 ie_proc_mat,
       dt_conta,
       dt_atendimento       dt_item,
       cd_material          cd_item,
       qt_material          qt_item,
       vl_material          vl_item,
       cd_convenio,
       cd_setor_atendimento,
	cd_motivo_exc_conta
from   material_atend_paciente
where	coalesce(nr_seq_proc_pacote, 0) <> nr_sequencia;

