-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW interf_tiss_v (ds_registro, tp_registro, ie_servico, nr_seq_protocolo, cd_origem, nr_lote, nr_interno_conta, nr_parcela, cd_convenio, nm_convenio, tp_prestador, cd_prestador, nm_prestador, dt_geracao, nr_remessa, cd_ans, ds_plano, cd_senha_atend, dt_entrada, dt_alta, dt_inicio_cobranca, dt_fim_cobranca, cd_cid, cd_proc_principal, nr_protocolo, ie_tipo_nascimento, ie_aborto, ie_obito_materno, ie_atend_corrente, ie_atend_rn, ie_neonatal, ie_baixo_peso, ie_parto_cesario, ie_laudo_medico, ie_laudo_prorrog, dt_autorizacao, dt_validade_carteira, nr_prontuario, ie_tipo_docto, nr_documento, ie_tipo_internacao, cd_usuario_convenio, cd_acomodacao, ie_atendimento, ie_carater_inter, qt_nascidos_vivos, qt_nascidos_mortos, nr_seq_acidente, ie_faturamento, ie_tipo_consulta, dt_solicitacao, dt_validade_senha, nm_pessoa_autorizou, cd_autorizacao, dt_emissao, nm_titular, nr_declaracao_vivos, nr_declaracao_obito, cd_cid_obito, cd_cid2, cd_cid3, cd_cid4, nr_obito_precoce, nr_obito_tardio, ie_tipo_doenca, ie_tempo_doenca, cd_cns, cd_cnes, cd_crm, nr_crm, uf_crm, cd_cbos, cd_cbos_espec, tp_logradouro, ds_logradouro, nr_endereco, ds_complemento, ds_municipio, sg_uf, cd_ibge, cd_cep, cd_crm_solic, nr_crm_solic, uf_crm_solic, cd_cbos_solic, ie_tipo_saida, ie_tipo_guia, qt_prematuros, cd_procedimento_sihsus, cd_item, ds_item, ie_emergencia, ie_extra, dt_item, ie_funcao_medico, qt_item, vl_item, ie_cirurgia_multipla, ds_unidade_medida, cd_classif_item, nr_cpf_executor, nm_medico_executor, cd_crm_executor, nr_crm_executor, uf_crm_executor, cd_executor_operadora, cd_senha, cd_pacote, vl_pacote, ie_tipo_cirurgia, hr_inicial, hr_final, cd_tabela, qt_item_autorizado, ie_tecnica, cd_barra_opm, nm_fabricante, qt_embalagem, cd_centro_custo, qt_item_conta, vl_total_item, nm_paciente, cd_unid_atend, qt_diaria_enf, qt_diaria_uti, cd_ura, cd_cpf_exec, nm_medico_exec, cd_cpf_solic, nm_medico_solic, ie_indicacao_clinica, nr_fatura, qt_conta_lote, vl_total_lote, qt_total_conta, vl_total_conta) AS SELECT	DISTINCT
	'HEADER		' 			DS_REGISTRO, 
	0            		TP_REGISTRO, 
	'TISS'         		IE_SERVICO, 
	A.NR_SEQ_PROTOCOLO			NR_SEQ_PROTOCOLO, 
	0					CD_ORIGEM, 
	0					NR_LOTE, 
	0			   		NR_INTERNO_CONTA, 
	0		      		NR_PARCELA, 
	A.CD_CONVENIO				CD_CONVENIO, 
	A.NM_CONVENIO				NM_CONVENIO, 
	CASE WHEN A.CD_CGC_HOSPITAL='' THEN 'F'  ELSE 'J' END 	TP_PRESTADOR, 
	A.CD_CGC_HOSPITAL			CD_PRESTADOR, 
	SUBSTR(A.NM_HOSPITAL,1,40)		NM_PRESTADOR, 
	A.DT_REMESSA				DT_GERACAO, 
	A.NR_REMESSA				NR_REMESSA, 
	B.CD_ANS				CD_ANS, 
	' '					DS_PLANO, 
	' '					CD_SENHA_ATEND, 
	LOCALTIMESTAMP					DT_ENTRADA, 
	LOCALTIMESTAMP					DT_ALTA, 
	LOCALTIMESTAMP					DT_INICIO_COBRANCA, 
	LOCALTIMESTAMP					DT_FIM_COBRANCA, 
	' '					CD_CID, 
	' '					CD_PROC_PRINCIPAL, 
	0					NR_PROTOCOLO, 
	' '					IE_TIPO_NASCIMENTO, 
	' '					IE_ABORTO, 
	0					IE_OBITO_MATERNO, 
	0					IE_ATEND_CORRENTE, 
	' '					IE_ATEND_RN, 
	' '					IE_NEONATAL, 
	' '					IE_BAIXO_PESO, 
	' '					IE_PARTO_CESARIO, 
	' '					IE_LAUDO_MEDICO, 
	' '					IE_LAUDO_PRORROG, 
	LOCALTIMESTAMP					DT_AUTORIZACAO, 
	LOCALTIMESTAMP					DT_VALIDADE_CARTEIRA, 
	0					NR_PRONTUARIO, 
	' '					IE_TIPO_DOCTO, 
	' '					NR_DOCUMENTO, 
	0					IE_TIPO_INTERNACAO, 
	' '					CD_USUARIO_CONVENIO, 
	0					CD_ACOMODACAO, 
	0					IE_ATENDIMENTO, 
	' '					IE_CARATER_INTER, 
	0					QT_NASCIDOS_VIVOS, 
	0					QT_NASCIDOS_MORTOS, 
	0					NR_SEQ_ACIDENTE, 
	' '					IE_FATURAMENTO, 
	' '					IE_TIPO_CONSULTA, 
	LOCALTIMESTAMP					DT_SOLICITACAO, 
	LOCALTIMESTAMP					DT_VALIDADE_SENHA, 
	' '					NM_PESSOA_AUTORIZOU, 
	' '					CD_AUTORIZACAO, 
	LOCALTIMESTAMP					DT_EMISSAO, 
	' '					NM_TITULAR, 
	0					NR_DECLARACAO_VIVOS, 
	0					NR_DECLARACAO_OBITO, 
	' '					CD_CID_OBITO, 
	' '					CD_CID2, 
	' '					CD_CID3, 
	' '					CD_CID4, 
	0					NR_OBITO_PRECOCE, 
	0					NR_OBITO_TARDIO, 
	' '					IE_TIPO_DOENCA, 
	' '					IE_TEMPO_DOENCA, 
	' '					cD_CNS, 
	0					CD_CNES, 
	' '					CD_CRM, 
	' '					NR_CRM, 
	' '		 			UF_CRM, 
	' '					CD_CBOS, 
	0					CD_CBOS_ESPEC, 
	' '					TP_LOGRADOURO, 
	' '					DS_LOGRADOURO, 
	' '					NR_ENDERECO, 
	' '					DS_COMPLEMENTO, 
	' '					DS_MUNICIPIO, 
	' '					SG_UF, 
	' '					CD_IBGE, 
	' '					CD_CEP, 
	' '					CD_CRM_SOLIC, 
	' '					NR_CRM_SOLIC, 
	' '					UF_CRM_SOLIC, 
	' '					CD_CBOS_SOLIC, 
	0					IE_TIPO_SAIDA, 
	' '					IE_TIPO_GUIA, 
	0					QT_PREMATUROS, 
	' '					CD_PROCEDIMENTO_SIHSUS, 
	0					CD_ITEM, 
	' '					DS_ITEM, 
	' '					IE_EMERGENCIA, 
	' '					IE_EXTRA, 
	LOCALTIMESTAMP					DT_ITEM, 
	0					IE_FUNCAO_MEDICO, 
	0					QT_ITEM, 
	0					VL_ITEM, 
	0					IE_CIRURGIA_MULTIPLA, 
	' '					DS_UNIDADE_MEDIDA, 
	0					CD_CLASSIF_ITEM, 
	' '					NR_CPF_EXECUTOR, 
	' '					NM_MEDICO_EXECUTOR, 
	' '					CD_CRM_EXECUTOR, 
	' '					NR_CRM_EXECUTOR, 
	' '					UF_CRM_EXECUTOR, 
	' '					CD_EXECUTOR_OPERADORA, 
	' '					CD_SENHA, 
	0					CD_PACOTE, 
	0					VL_PACOTE, 
	' '	 				IE_TIPO_CIRURGIA, 
	LOCALTIMESTAMP					HR_INICIAL, 
	LOCALTIMESTAMP					HR_FINAL, 
	' '					CD_TABELA, 
	0					QT_ITEM_AUTORIZADO, 
	' '					IE_TECNICA, 
	' '					CD_BARRA_OPM, 
	' '					NM_FABRICANTE, 
	0					QT_EMBALAGEM, 
	' '					CD_CENTRO_CUSTO, 
	0					QT_ITEM_CONTA, 
	0					VL_TOTAL_ITEM, 
	' '					NM_PACIENTE, 
	' '					CD_UNID_ATEND, 
	0					QT_DIARIA_ENF, 
	0					QT_DIARIA_UTI, 
	0					CD_URA, 
	' '					CD_CPF_EXEC, 
	' '					NM_MEDICO_EXEC, 
	' '					CD_CPF_SOLIC, 
	' '					NM_MEDICO_SOLIC, 
	' '					IE_INDICACAO_CLINICA, 
	' '					NR_FATURA, 
	0					QT_CONTA_LOTE, 
	0					VL_TOTAL_LOTE, 
	0					QT_TOTAL_CONTA, 
	0					VL_TOTAL_CONTA 
FROM	PESSOA_JURIDICA B, 
	W_INTERF_CONTA_HEADER A 
WHERE	A.CD_CGC_HOSPITAL	= B.CD_CGC 

UNION ALL
 
SELECT	DISTINCT 
	'CABECALHO	' 			DS_REGISTRO, 
	1            		TP_REGISTRO, 
	'TISS'         		IE_SERVICO, 
	A.NR_SEQ_PROTOCOLO			NR_SEQ_PROTOCOLO, 
	0					CD_ORIGEM, 
	0					NR_LOTE, 
	A.NR_INTERNO_CONTA	   		NR_INTERNO_CONTA, 
	1		      		NR_PARCELA, 
	0					CD_CONVENIO, 
	' '					NM_CONVENIO, 
	' '					TP_PRESTADOR, 
	' '					CD_PRESTADOR, 
	' '					NM_PRESTADOR, 
	LOCALTIMESTAMP					DT_GERACAO, 
	0					NR_REMESSA, 
	' '					CD_ANS, 
	SUBSTR(OBTER_DESC_PLANO(A.CD_CONVENIO, A.CD_PLANO_CONVENIO),1,40) DS_PLANO, 
	A.CD_SENHA_GUIA				CD_SENHA_ATEND, 
	A.DT_ENTRADA				DT_ENTRADA, 
	A.DT_ALTA				DT_ALTA, 
	A.DT_PERIODO_INICIAL			DT_INICIO_COBRANCA, 
	coalesce(A.DT_ALTA, A.DT_PERIODO_FINAL)	DT_FIM_COBRANCA, 
	A.CD_CID_PRINCIPAL			CD_CID, 
	CD_PROC_PRINCIPAL			CD_PROC_PRINCIPAL, 
	A.NR_SEQ_PROTOCOLO			NR_PROTOCOLO, 
	A.IE_TIPO_NASCIMENTO			IE_TIPO_NASCIMENTO, 
	'N'					IE_ABORTO, 
	0					IE_OBITO_MATERNO, 
	0					IE_ATEND_CORRENTE, 
	'N'					IE_ATEND_RN, 
	'N'					IE_NEONATAL, 
	'N'					IE_BAIXO_PESO, 
	'N'					IE_PARTO_CESARIO, 
	'N'					IE_LAUDO_MEDICO, 
	'N'					IE_LAUDO_PRORROG, 
	B.DT_AUTORIZACAO			DT_AUTORIZACAO, 
	A.DT_VALIDADE_CARTEIRA			DT_VALIDADE_CARTEIRA, 
	A.NR_PRONTUARIO				NR_PRONTUARIO, 
	' '					IE_TIPO_DOCTO, 
	' '					NR_DOCUMENTO, 
	A.IE_CLINICA				IE_TIPO_INTERNACAO, 
	A.CD_USUARIO_CONVENIO			CD_USUARIO_CONVENIO, 
	A.CD_TIPO_ACOMODACAO			CD_ACOMODACAO, 
	A.NR_ATENDIMENTO			IE_ATENDIMENTO, 
	A.IE_CARATER_INTER			IE_CARATER_INTER, 
	0					QT_NASCIDOS_VIVOS, 
	0					QT_NASCIDOS_MORTOS, 
	C.NR_SEQ_TIPO_ACIDENTE			NR_SEQ_ACIDENTE, 
	'F'					IE_FATURAMENTO, 
	'P'					IE_TIPO_CONSULTA, 
	B.DT_AUTORIZACAO			DT_SOLICITACAO, 
	A.DT_VALIDADE_CARTEIRA			DT_VALIDADE_SENHA, 
	B.NM_RESPONSAVEL			NM_PESSOA_AUTORIZOU, 
	A.NR_DOC_CONVENIO			CD_AUTORIZACAO, 
	LOCALTIMESTAMP					DT_EMISSAO, 
	A.NM_PACIENTE				NM_TITULAR, 
	0					NR_DECLARACAO_VIVOS, 
	CASE WHEN SUBSTR(OBTER_DECLARACAO_OBITO(A.NR_ATENDIMENTO),1,20)='' THEN  0  ELSE 1 END  NR_DECLARACAO_OBITO, 
	' '					CD_CID_OBITO, 
	' '					CD_CID2, 
	' '					CD_CID3, 
	' '					CD_CID4, 
	0					NR_OBITO_PRECOCE, 
	0					NR_OBITO_TARDIO, 
	' '					IE_TIPO_DOENCA, 
	' '					IE_TEMPO_DOENCA, 
	D.CD_CNS				cD_CNS, 
	E.CD_CNES				CD_CNES, 
	'CRM'					CD_CRM, 
	A.NR_CRM_MEDICO_RESP			NR_CRM, 
	A.UF_CRM_MEDICO_RESP			UF_CRM, 
	' '					CD_CBOS, 
	0					CD_CBOS_ESPEC, 
	'081'					TP_LOGRADOURO, 
	SUBSTR(OBTER_COMPL_PF(A.CD_PACIENTE,1,'EN'),1,50) DS_LOGRADOURO, 
	SUBSTR(OBTER_COMPL_PF(A.CD_PACIENTE,1,'NR'),1,4) NR_ENDERECO, 
	SUBSTR(OBTER_COMPL_PF(A.CD_PACIENTE,1,'CO'),1,50) DS_COMPLEMENTO, 
	SUBSTR(OBTER_COMPL_PF(A.CD_PACIENTE,1,'DM'),1,50) DS_MUNICIPIO, 
	SUBSTR(OBTER_COMPL_PF(A.CD_PACIENTE,1,'UF'),1,2) SG_UF, 
	SUBSTR(OBTER_COMPL_PF(A.CD_PACIENTE,1,'CDM'),1,10) CD_IBGE, 
	SUBSTR(OBTER_COMPL_PF(A.CD_PACIENTE,1,'CEP'),1,10) CD_CEP, 
	'CRM'					CD_CRM_SOLIC, 
	B.NR_CRM_SOLICITANTE			NR_CRM_SOLIC, 
	B.UF_CRM_SOLICITANTE			UF_CRM_SOLIC, 
	' '					CD_CBOS_SOLIC, 
	A.CD_MOTIVO_ALTA			IE_TIPO_SAIDA, 
	B.IE_TIPO_GUIA				IE_TIPO_GUIA, 
	0					QT_PREMATUROS, 
	' '					CD_PROCEDIMENTO_SIHSUS, 
	0					CD_ITEM, 
	' '					DS_ITEM, 
	' '					IE_EMERGENCIA, 
	' '					IE_EXTRA, 
	LOCALTIMESTAMP					DT_ITEM, 
	0					IE_FUNCAO_MEDICO, 
	0					QT_ITEM, 
	0					VL_ITEM, 
	0					IE_CIRURGIA_MULTIPLA, 
	' '					DS_UNIDADE_MEDIDA, 
	0					CD_CLASSIF_ITEM, 
	' '					NR_CPF_EXECUTOR, 
	' '					NM_MEDICO_EXECUTOR, 
	' '					CD_CRM_EXECUTOR, 
	' '					NR_CRM_EXECUTOR, 
	' '					UF_CRM_EXECUTOR, 
	' '					CD_EXECUTOR_OPERADORA, 
	' '					CD_SENHA, 
	0					CD_PACOTE, 
	0					VL_PACOTE, 
	' '	 				IE_TIPO_CIRURGIA, 
	LOCALTIMESTAMP					HR_INICIAL, 
	LOCALTIMESTAMP					HR_FINAL, 
	' '					CD_TABELA, 
	0					QT_ITEM_AUTORIZADO, 
	' '					IE_TECNICA, 
	' '					CD_BARRA_OPM, 
	' '					NM_FABRICANTE, 
	0					QT_EMBALAGEM, 
	' '					CD_CENTRO_CUSTO, 
	0					QT_ITEM_CONTA, 
	0					VL_TOTAL_ITEM, 
	' '					NM_PACIENTE, 
	' '					CD_UNID_ATEND, 
	0					QT_DIARIA_ENF, 
	0					QT_DIARIA_UTI, 
	0					CD_URA, 
	' '					CD_CPF_EXEC, 
	' '					NM_MEDICO_EXEC, 
	' '					CD_CPF_SOLIC, 
	' '					NM_MEDICO_SOLIC, 
	' '					IE_INDICACAO_CLINICA, 
	' '					NR_FATURA, 
	0					QT_CONTA_LOTE, 
	0					VL_TOTAL_LOTE, 
	0					QT_TOTAL_CONTA, 
	0					VL_TOTAL_CONTA 
FROM sus_parametros e, estabelecimento d, atendimento_paciente c, w_interf_conta_cab a
LEFT OUTER JOIN w_interf_conta_autor b ON (A.NR_INTERNO_CONTA = B.NR_INTERNO_CONTA)
WHERE A.NR_ATENDIMENTO	= C.NR_ATENDIMENTO AND C.CD_ESTABELECIMENTO	= D.CD_ESTABELECIMENTO AND E.CD_ESTABELECIMENTO	= D.CD_ESTABELECIMENTO 
 
UNION ALL
 
SELECT	DISTINCT 
	'ITEM DA CONTA	' 			DS_REGISTRO,	 
	2            		TP_REGISTRO, 
	'TISS'         		IE_SERVICO, 
	A.NR_SEQ_PROTOCOLO			NR_SEQ_PROTOCOLO, 
	0					CD_ORIGEM, 
	0					NR_LOTE, 
	A.NR_INTERNO_CONTA	   		NR_INTERNO_CONTA, 
	1		      		NR_PARCELA, 
	0					CD_CONVENIO, 
	' '					NM_CONVENIO, 
	' '					TP_PRESTADOR, 
	' '					CD_PRESTADOR, 
	' '					NM_PRESTADOR, 
	LOCALTIMESTAMP					DT_GERACAO, 
	0					NR_REMESSA, 
	' '					CD_ANS, 
	' '					DS_PLANO, 
	' '					CD_SENHA_ATEND, 
	LOCALTIMESTAMP					DT_ENTRADA, 
	LOCALTIMESTAMP					DT_ALTA, 
	LOCALTIMESTAMP					DT_INICIO_COBRANCA, 
	LOCALTIMESTAMP					DT_FIM_COBRANCA, 
	' '					CD_CID, 
	' '					CD_PROC_PRINCIPAL, 
	0					NR_PROTOCOLO, 
	' '					IE_TIPO_NASCIMENTO, 
	' '					IE_ABORTO, 
	0					IE_OBITO_MATERNO, 
	0					IE_ATEND_CORRENTE, 
	' '					IE_ATEND_RN, 
	' '					IE_NEONATAL, 
	' '					IE_BAIXO_PESO, 
	' '					IE_PARTO_CESARIO, 
	' '					IE_LAUDO_MEDICO, 
	' '					IE_LAUDO_PRORROG, 
	LOCALTIMESTAMP					DT_AUTORIZACAO, 
	LOCALTIMESTAMP					DT_VALIDADE_CARTEIRA, 
	0					NR_PRONTUARIO, 
	' '					IE_TIPO_DOCTO, 
	' '					NR_DOCUMENTO, 
	0					IE_TIPO_INTERNACAO, 
	' '					CD_USUARIO_CONVENIO, 
	0					CD_ACOMODACAO, 
	0					IE_ATENDIMENTO, 
	' '					IE_CARATER_INTER, 
	0					QT_NASCIDOS_VIVOS, 
	0					QT_NASCIDOS_MORTOS, 
	0					NR_SEQ_ACIDENTE, 
	' '					IE_FATURAMENTO, 
	' '					IE_TIPO_CONSULTA, 
	LOCALTIMESTAMP					DT_SOLICITACAO, 
	LOCALTIMESTAMP					DT_VALIDADE_SENHA, 
	' '					NM_PESSOA_AUTORIZOU, 
	' '					CD_AUTORIZACAO, 
	LOCALTIMESTAMP					DT_EMISSAO, 
	' '					NM_TITULAR, 
	0					NR_DECLARACAO_VIVOS, 
	0					NR_DECLARACAO_OBITO, 
	' '					CD_CID_OBITO, 
	' '					CD_CID2, 
	' '					CD_CID3, 
	' '					CD_CID4, 
	0					NR_OBITO_PRECOCE, 
	0					NR_OBITO_TARDIO, 
	' '					IE_TIPO_DOENCA, 
	' '					IE_TEMPO_DOENCA, 
	' '					cD_CNS, 
	0					CD_CNES, 
	' '					CD_CRM, 
	' '					NR_CRM, 
	' '		 			UF_CRM, 
	' '					CD_CBOS, 
	A.CD_ESPECIALIDADE			CD_CBOS_ESPEC, 
	' '					TP_LOGRADOURO, 
	' '					DS_LOGRADOURO, 
	' '					NR_ENDERECO, 
	' '					DS_COMPLEMENTO, 
	' '					DS_MUNICIPIO, 
	' '					SG_UF, 
	' '					CD_IBGE, 
	' '					CD_CEP, 
	' '					CD_CRM_SOLIC, 
	' '					NR_CRM_SOLIC, 
	' '					UF_CRM_SOLIC, 
	' '					CD_CBOS_SOLIC, 
	0					IE_TIPO_SAIDA, 
	' '					IE_TIPO_GUIA, 
	0					QT_PREMATUROS, 
	' '					CD_PROCEDIMENTO_SIHSUS, 
	A.CD_ITEM				CD_ITEM, 
	SUBSTR(OBTER_DESCRICAO_PROCEDIMENTO(A.CD_ITEM, A.IE_ORIGEM_PROCED),1,50) DS_ITEM, 
	CASE WHEN B.IE_CARATER_INTER='U' THEN 'S'  ELSE 'N' END 	IE_EMERGENCIA, 
	CASE WHEN A.PR_HORA_EXTRA=0 THEN 'N' WHEN A.PR_HORA_EXTRA=1 THEN 'N' WHEN A.PR_HORA_EXTRA IS NULL THEN 'N'  ELSE 'S' END  IE_EXTRA, 
	A.DT_ITEM				DT_ITEM, 
	A.CD_FUNCAO_EXECUTOR			IE_FUNCAO_MEDICO, 
	A.QT_ITEM				QT_ITEM, 
	A.VL_UNITARIO_ITEM			VL_ITEM, 
	0					IE_CIRURGIA_MULTIPLA, 
	A.CD_UNIDADE_MEDIDA			DS_UNIDADE_MEDIDA, 
	0					CD_CLASSIF_ITEM, 
	A.NR_CPF_EXECUTOR			NR_CPF_EXECUTOR, 
	A.NM_MEDICO_EXECUTOR			NM_MEDICO_EXECUTOR, 
	'CRM'					CD_CRM_EXECUTOR, 
	A.NR_CRM_EXECUTOR			NR_CRM_EXECUTOR, 
	A.UF_CRM_EXECUTOR			UF_CRM_EXECUTOR, 
	A.CD_MEDICO_EXEC_CONV			CD_EXECUTOR_OPERADORA, 
	A.CD_SENHA_GUIA				CD_SENHA, 
	0					CD_PACOTE, 
	0					VL_PACOTE, 
	A.IE_VIA_ACESSO				IE_TIPO_CIRURGIA, 
	A.DT_ITEM				HR_INICIAL, 
	A.DT_ITEM				HR_FINAL, 
	' '					CD_TABELA, 
	0					QT_ITEM_AUTORIZADO, 
	'C'					IE_TECNICA, 
	' '					CD_BARRA_OPM, 
	' '					NM_FABRICANTE, 
	0					QT_EMBALAGEM, 
	' '					CD_CENTRO_CUSTO, 
	0					QT_ITEM_CONTA, 
	0					VL_TOTAL_ITEM, 
	' '					NM_PACIENTE, 
	' '					CD_UNID_ATEND, 
	0					QT_DIARIA_ENF, 
	0					QT_DIARIA_UTI, 
	0					CD_URA, 
	' '					CD_CPF_EXEC, 
	' '					NM_MEDICO_EXEC, 
	' '					CD_CPF_SOLIC, 
	' '					NM_MEDICO_SOLIC, 
	' '					IE_INDICACAO_CLINICA, 
	' '					NR_FATURA, 
	0					QT_CONTA_LOTE, 
	0					VL_TOTAL_LOTE, 
	0					QT_TOTAL_CONTA, 
	0					VL_TOTAL_CONTA 
FROM	W_INTERF_CONTA_CAB B, 
	W_INTERF_CONTA_ITEM A 
WHERE	A.NR_INTERNO_CONTA	= B.NR_INTERNO_CONTA 
AND	A.IE_TIPO_ITEM	= 1 

UNION ALL
 
SELECT	DISTINCT 
	'TOTAL DA CONTA	' 			DS_REGISTRO, 
	3            		TP_REGISTRO, 
	'TISS'         		IE_SERVICO, 
	A.NR_SEQ_PROTOCOLO			NR_SEQ_PROTOCOLO, 
	0					CD_ORIGEM, 
	0					NR_LOTE, 
	A.NR_INTERNO_CONTA	   		NR_INTERNO_CONTA, 
	1		      		NR_PARCELA, 
	0					CD_CONVENIO, 
	' '					NM_CONVENIO, 
	' '					TP_PRESTADOR, 
	' '					CD_PRESTADOR, 
	' '					NM_PRESTADOR, 
	LOCALTIMESTAMP					DT_GERACAO, 
	0					NR_REMESSA, 
	' '					CD_ANS, 
	' '					DS_PLANO, 
	' '					CD_SENHA_ATEND, 
	LOCALTIMESTAMP					DT_ENTRADA, 
	LOCALTIMESTAMP					DT_ALTA, 
	LOCALTIMESTAMP					DT_INICIO_COBRANCA, 
	LOCALTIMESTAMP					DT_FIM_COBRANCA, 
	' '					CD_CID, 
	' '					CD_PROC_PRINCIPAL, 
	0					NR_PROTOCOLO, 
	' '					IE_TIPO_NASCIMENTO, 
	' '					IE_ABORTO, 
	0					IE_OBITO_MATERNO, 
	0					IE_ATEND_CORRENTE, 
	' '					IE_ATEND_RN, 
	' '					IE_NEONATAL, 
	' '					IE_BAIXO_PESO, 
	' '					IE_PARTO_CESARIO, 
	' '					IE_LAUDO_MEDICO, 
	' '					IE_LAUDO_PRORROG, 
	LOCALTIMESTAMP					DT_AUTORIZACAO, 
	LOCALTIMESTAMP					DT_VALIDADE_CARTEIRA, 
	0					NR_PRONTUARIO, 
	' '					IE_TIPO_DOCTO, 
	' '					NR_DOCUMENTO, 
	0					IE_TIPO_INTERNACAO, 
	' '					CD_USUARIO_CONVENIO, 
	0					CD_ACOMODACAO, 
	0					IE_ATENDIMENTO, 
	' '					IE_CARATER_INTER, 
	0					QT_NASCIDOS_VIVOS, 
	0					QT_NASCIDOS_MORTOS, 
	0					NR_SEQ_ACIDENTE, 
	' '					IE_FATURAMENTO, 
	' '					IE_TIPO_CONSULTA, 
	LOCALTIMESTAMP					DT_SOLICITACAO, 
	LOCALTIMESTAMP					DT_VALIDADE_SENHA, 
	' '					NM_PESSOA_AUTORIZOU, 
	' '					CD_AUTORIZACAO, 
	LOCALTIMESTAMP					DT_EMISSAO, 
	' '					NM_TITULAR, 
	0					NR_DECLARACAO_VIVOS, 
	0					NR_DECLARACAO_OBITO, 
	' '					CD_CID_OBITO, 
	' '					CD_CID2, 
	' '					CD_CID3, 
	' '					CD_CID4, 
	0					NR_OBITO_PRECOCE, 
	0					NR_OBITO_TARDIO, 
	' '					IE_TIPO_DOENCA, 
	' '					IE_TEMPO_DOENCA, 
	' '					cD_CNS, 
	0					CD_CNES, 
	' '					CD_CRM, 
	' '					NR_CRM, 
	' '		 			UF_CRM, 
	' '					CD_CBOS, 
	0					CD_CBOS_ESPEC, 
	' '					TP_LOGRADOURO, 
	' '					DS_LOGRADOURO, 
	' '					NR_ENDERECO, 
	' '					DS_COMPLEMENTO, 
	' '					DS_MUNICIPIO, 
	' '					SG_UF, 
	' '					CD_IBGE, 
	' '					CD_CEP, 
	' '					CD_CRM_SOLIC, 
	' '					NR_CRM_SOLIC, 
	' '					UF_CRM_SOLIC, 
	' '					CD_CBOS_SOLIC, 
	0					IE_TIPO_SAIDA, 
	' '					IE_TIPO_GUIA, 
	0					QT_PREMATUROS, 
	' '					CD_PROCEDIMENTO_SIHSUS, 
	0					CD_ITEM, 
	' '					DS_ITEM, 
	' '					IE_EMERGENCIA, 
	' '					IE_EXTRA, 
	LOCALTIMESTAMP					DT_ITEM, 
	0					IE_FUNCAO_MEDICO, 
	0					QT_ITEM, 
	0					VL_ITEM, 
	0					IE_CIRURGIA_MULTIPLA, 
	' '					DS_UNIDADE_MEDIDA, 
	0					CD_CLASSIF_ITEM, 
	' '					NR_CPF_EXECUTOR, 
	' '					NM_MEDICO_EXECUTOR, 
	' '					CD_CRM_EXECUTOR, 
	' '					NR_CRM_EXECUTOR, 
	' '					UF_CRM_EXECUTOR, 
	' '					CD_EXECUTOR_OPERADORA, 
	' '					CD_SENHA, 
	0					CD_PACOTE, 
	0					VL_PACOTE, 
	' '	 				IE_TIPO_CIRURGIA, 
	LOCALTIMESTAMP					HR_INICIAL, 
	LOCALTIMESTAMP					HR_FINAL, 
	' '					CD_TABELA, 
	0					QT_ITEM_AUTORIZADO, 
	' '					IE_TECNICA, 
	' '					CD_BARRA_OPM, 
	' '					NM_FABRICANTE, 
	0					QT_EMBALAGEM, 
	' '					CD_CENTRO_CUSTO, 
	SUM(A.QT_ITEM_CONTA)			QT_ITEM_CONTA, 
	SUM(A.VL_TOTAL_CONTA)			VL_TOTAL_ITEM, 
	SUBSTR(OBTER_PESSOA_ATENDIMENTO(A.NR_ATENDIMENTO,'N'),1,50) NM_PACIENTE, 
	SUBSTR(OBTER_SETOR_ATENDIMENTO(A.NR_ATENDIMENTO),1,4) CD_UNID_ATEND, 
	A.QT_DIARIAS				QT_DIARIA_ENF, 
	0					QT_DIARIA_UTI, 
	0					CD_URA, 
	C.CD_MEDICO_RESP			CD_CPF_EXEC, 
	C.NM_MEDICO_RESP			NM_MEDICO_EXEC, 
	B.CD_MEDICO_SOLICITANTE			CD_CPF_SOLIC, 
	B.NM_MEDICO_SOLICITANTE			NM_MEDICO_SOLIC, 
	' '					IE_INDICACAO_CLINICA, 
	' '					NR_FATURA, 
	0					QT_CONTA_LOTE, 
	0					VL_TOTAL_LOTE, 
	0					QT_TOTAL_CONTA, 
	0					VL_TOTAL_CONTA 
FROM w_interf_conta_cab c, w_interf_conta_total a
LEFT OUTER JOIN w_interf_conta_autor b ON (A.NR_INTERNO_CONTA = B.NR_INTERNO_CONTA)
WHERE A.NR_INTERNO_CONTA	= C.NR_INTERNO_CONTA GROUP BY	A.NR_SEQ_PROTOCOLO, 
		A.NR_INTERNO_CONTA, 
		SUBSTR(OBTER_PESSOA_ATENDIMENTO(A.NR_ATENDIMENTO,'N'),1,50), 
		SUBSTR(OBTER_SETOR_ATENDIMENTO(A.NR_ATENDIMENTO),1,4), 
		A.QT_DIARIAS, 
		C.CD_MEDICO_RESP, 
		C.NM_MEDICO_RESP, 
		B.CD_MEDICO_SOLICITANTE, 
		B.NM_MEDICO_SOLICITANTE		 

UNION ALL
 
SELECT	DISTINCT 
	'FIM DO LOTE	' 			DS_REGISTRO, 
	4            		TP_REGISTRO, 
	'TISS'         		IE_SERVICO, 
	A.NR_SEQ_PROTOCOLO			NR_SEQ_PROTOCOLO, 
	0					CD_ORIGEM, 
	0					NR_LOTE, 
	99999999		   		NR_INTERNO_CONTA, 
	99		      		NR_PARCELA, 
	0					CD_CONVENIO, 
	' '					NM_CONVENIO, 
	' '					TP_PRESTADOR, 
	' '					CD_PRESTADOR, 
	' '					NM_PRESTADOR, 
	LOCALTIMESTAMP					DT_GERACAO, 
	0					NR_REMESSA, 
	' '					CD_ANS, 
	' '					DS_PLANO, 
	' '					CD_SENHA_ATEND, 
	LOCALTIMESTAMP					DT_ENTRADA, 
	LOCALTIMESTAMP					DT_ALTA, 
	LOCALTIMESTAMP					DT_INICIO_COBRANCA, 
	LOCALTIMESTAMP					DT_FIM_COBRANCA, 
	' '					CD_CID, 
	' '					CD_PROC_PRINCIPAL, 
	0					NR_PROTOCOLO, 
	' '					IE_TIPO_NASCIMENTO, 
	' '					IE_ABORTO, 
	0					IE_OBITO_MATERNO, 
	0					IE_ATEND_CORRENTE, 
	' '					IE_ATEND_RN, 
	' '					IE_NEONATAL, 
	' '					IE_BAIXO_PESO, 
	' '					IE_PARTO_CESARIO, 
	' '					IE_LAUDO_MEDICO, 
	' '					IE_LAUDO_PRORROG, 
	LOCALTIMESTAMP					DT_AUTORIZACAO, 
	LOCALTIMESTAMP					DT_VALIDADE_CARTEIRA, 
	0					NR_PRONTUARIO, 
	' '					IE_TIPO_DOCTO, 
	' '					NR_DOCUMENTO, 
	0					IE_TIPO_INTERNACAO, 
	' '					CD_USUARIO_CONVENIO, 
	0					CD_ACOMODACAO, 
	0					IE_ATENDIMENTO, 
	' '					IE_CARATER_INTER, 
	0					QT_NASCIDOS_VIVOS, 
	0					QT_NASCIDOS_MORTOS, 
	0					NR_SEQ_ACIDENTE, 
	' '					IE_FATURAMENTO, 
	' '					IE_TIPO_CONSULTA, 
	LOCALTIMESTAMP					DT_SOLICITACAO, 
	LOCALTIMESTAMP					DT_VALIDADE_SENHA, 
	' '					NM_PESSOA_AUTORIZOU, 
	' '					CD_AUTORIZACAO, 
	LOCALTIMESTAMP					DT_EMISSAO, 
	' '					NM_TITULAR, 
	0					NR_DECLARACAO_VIVOS, 
	0					NR_DECLARACAO_OBITO, 
	' '					CD_CID_OBITO, 
	' '					CD_CID2, 
	' '					CD_CID3, 
	' '					CD_CID4, 
	0					NR_OBITO_PRECOCE, 
	0					NR_OBITO_TARDIO, 
	' '					IE_TIPO_DOENCA, 
	' '					IE_TEMPO_DOENCA, 
	' '					cD_CNS, 
	0					CD_CNES, 
	' '					CD_CRM, 
	' '					NR_CRM, 
	' '		 			UF_CRM, 
	' '					CD_CBOS, 
	0					CD_CBOS_ESPEC, 
	' '					TP_LOGRADOURO, 
	' '					DS_LOGRADOURO, 
	' '					NR_ENDERECO, 
	' '					DS_COMPLEMENTO, 
	' '					DS_MUNICIPIO, 
	' '					SG_UF, 
	' '					CD_IBGE, 
	' '					CD_CEP, 
	' '					CD_CRM_SOLIC, 
	' '					NR_CRM_SOLIC, 
	' '					UF_CRM_SOLIC, 
	' '					CD_CBOS_SOLIC, 
	0					IE_TIPO_SAIDA, 
	' '					IE_TIPO_GUIA, 
	0					QT_PREMATUROS, 
	' '					CD_PROCEDIMENTO_SIHSUS, 
	0					CD_ITEM, 
	' '					DS_ITEM, 
	' '					IE_EMERGENCIA, 
	' '					IE_EXTRA, 
	LOCALTIMESTAMP					DT_ITEM, 
	0					IE_FUNCAO_MEDICO, 
	0					QT_ITEM, 
	0					VL_ITEM, 
	0					IE_CIRURGIA_MULTIPLA, 
	' '					DS_UNIDADE_MEDIDA, 
	0					CD_CLASSIF_ITEM, 
	' '					NR_CPF_EXECUTOR, 
	' '					NM_MEDICO_EXECUTOR, 
	' '					CD_CRM_EXECUTOR, 
	' '					NR_CRM_EXECUTOR, 
	' '					UF_CRM_EXECUTOR, 
	' '					CD_EXECUTOR_OPERADORA, 
	' '					CD_SENHA, 
	0					CD_PACOTE, 
	0					VL_PACOTE, 
	' '	 				IE_TIPO_CIRURGIA, 
	LOCALTIMESTAMP					HR_INICIAL, 
	LOCALTIMESTAMP					HR_FINAL, 
	' '					CD_TABELA, 
	0					QT_ITEM_AUTORIZADO, 
	' '					IE_TECNICA, 
	' '					CD_BARRA_OPM, 
	' '					NM_FABRICANTE, 
	0					QT_EMBALAGEM, 
	' '					CD_CENTRO_CUSTO, 
	0					QT_ITEM_CONTA, 
	0					VL_TOTAL_ITEM, 
	' '					NM_PACIENTE, 
	' '					CD_UNID_ATEND, 
	0					QT_DIARIA_ENF, 
	0					QT_DIARIA_UTI, 
	0					CD_URA, 
	' '					CD_CPF_EXEC, 
	' '					NM_MEDICO_EXEC, 
	' '					CD_CPF_SOLIC, 
	' '					NM_MEDICO_SOLIC, 
	' '					IE_INDICACAO_CLINICA, 
	' '					NR_FATURA, 
	SUM(A.QT_ITEM_CONTA)			QT_CONTA_LOTE, 
	SUM(A.VL_TOTAL_CONTA)			VL_TOTAL_LOTE, 
	0					QT_TOTAL_CONTA, 
	0					VL_TOTAL_CONTA 
FROM	W_INTERF_CONTA_TOTAL A 
GROUP BY A.NR_SEQ_PROTOCOLO 

UNION ALL
 
SELECT	DISTINCT 
	'TRAILLER REMESSA' 			DS_REGISTRO, 
	9            		TP_REGISTRO, 
	'TISS'         		IE_SERVICO, 
	A.NR_SEQ_PROTOCOLO			NR_SEQ_PROTOCOLO, 
	0					CD_ORIGEM, 
	99999999				NR_LOTE, 
	99999999		   		NR_INTERNO_CONTA, 
	99		      		NR_PARCELA, 
	0					CD_CONVENIO, 
	' '					NM_CONVENIO, 
	' '					TP_PRESTADOR, 
	' '					CD_PRESTADOR, 
	' '					NM_PRESTADOR, 
	LOCALTIMESTAMP					DT_GERACAO, 
	0					NR_REMESSA, 
	' '					CD_ANS, 
	' '					DS_PLANO, 
	' '					CD_SENHA_ATEND, 
	LOCALTIMESTAMP					DT_ENTRADA, 
	LOCALTIMESTAMP					DT_ALTA, 
	LOCALTIMESTAMP					DT_INICIO_COBRANCA, 
	LOCALTIMESTAMP					DT_FIM_COBRANCA, 
	' '					CD_CID, 
	' '					CD_PROC_PRINCIPAL, 
	0					NR_PROTOCOLO, 
	' '					IE_TIPO_NASCIMENTO, 
	' '					IE_ABORTO, 
	0					IE_OBITO_MATERNO, 
	0					IE_ATEND_CORRENTE, 
	' '					IE_ATEND_RN, 
	' '					IE_NEONATAL, 
	' '					IE_BAIXO_PESO, 
	' '					IE_PARTO_CESARIO, 
	' '					IE_LAUDO_MEDICO, 
	' '					IE_LAUDO_PRORROG, 
	LOCALTIMESTAMP					DT_AUTORIZACAO, 
	LOCALTIMESTAMP					DT_VALIDADE_CARTEIRA, 
	0					NR_PRONTUARIO, 
	' '					IE_TIPO_DOCTO, 
	' '					NR_DOCUMENTO, 
	0					IE_TIPO_INTERNACAO, 
	' '					CD_USUARIO_CONVENIO, 
	0					CD_ACOMODACAO, 
	0					IE_ATENDIMENTO, 
	' '					IE_CARATER_INTER, 
	0					QT_NASCIDOS_VIVOS, 
	0					QT_NASCIDOS_MORTOS, 
	0					NR_SEQ_ACIDENTE, 
	' '					IE_FATURAMENTO, 
	' '					IE_TIPO_CONSULTA, 
	LOCALTIMESTAMP					DT_SOLICITACAO, 
	LOCALTIMESTAMP					DT_VALIDADE_SENHA, 
	' '					NM_PESSOA_AUTORIZOU, 
	' '					CD_AUTORIZACAO, 
	LOCALTIMESTAMP					DT_EMISSAO, 
	' '					NM_TITULAR, 
	0					NR_DECLARACAO_VIVOS, 
	0					NR_DECLARACAO_OBITO, 
	' '					CD_CID_OBITO, 
	' '					CD_CID2, 
	' '					CD_CID3, 
	' '					CD_CID4, 
	0					NR_OBITO_PRECOCE, 
	0					NR_OBITO_TARDIO, 
	' '					IE_TIPO_DOENCA, 
	' '					IE_TEMPO_DOENCA, 
	' '					cD_CNS, 
	0					CD_CNES, 
	' '					CD_CRM, 
	' '					NR_CRM, 
	' '		 			UF_CRM, 
	' '					CD_CBOS, 
	0					CD_CBOS_ESPEC, 
	' '					TP_LOGRADOURO, 
	' '					DS_LOGRADOURO, 
	' '					NR_ENDERECO, 
	' '					DS_COMPLEMENTO, 
	' '					DS_MUNICIPIO, 
	' '					SG_UF, 
	' '					CD_IBGE, 
	' '					CD_CEP, 
	' '					CD_CRM_SOLIC, 
	' '					NR_CRM_SOLIC, 
	' '					UF_CRM_SOLIC, 
	' '					CD_CBOS_SOLIC, 
	0					IE_TIPO_SAIDA, 
	' '					IE_TIPO_GUIA, 
	0					QT_PREMATUROS, 
	' '					CD_PROCEDIMENTO_SIHSUS, 
	0					CD_ITEM, 
	' '					DS_ITEM, 
	' '					IE_EMERGENCIA, 
	' '					IE_EXTRA, 
	LOCALTIMESTAMP					DT_ITEM, 
	0					IE_FUNCAO_MEDICO, 
	0					QT_ITEM, 
	0					VL_ITEM, 
	0					IE_CIRURGIA_MULTIPLA, 
	' '					DS_UNIDADE_MEDIDA, 
	0					CD_CLASSIF_ITEM, 
	' '					NR_CPF_EXECUTOR, 
	' '					NM_MEDICO_EXECUTOR, 
	' '					CD_CRM_EXECUTOR, 
	' '					NR_CRM_EXECUTOR, 
	' '					UF_CRM_EXECUTOR, 
	' '					CD_EXECUTOR_OPERADORA, 
	' '					CD_SENHA, 
	0					CD_PACOTE, 
	0					VL_PACOTE, 
	' '	 				IE_TIPO_CIRURGIA, 
	LOCALTIMESTAMP					HR_INICIAL, 
	LOCALTIMESTAMP					HR_FINAL, 
	' '					CD_TABELA, 
	0					QT_ITEM_AUTORIZADO, 
	' '					IE_TECNICA, 
	' '					CD_BARRA_OPM, 
	' '					NM_FABRICANTE, 
	0					QT_EMBALAGEM, 
	' '					CD_CENTRO_CUSTO, 
	0					QT_ITEM_CONTA, 
	0					VL_TOTAL_ITEM, 
	' '					NM_PACIENTE, 
	' '					CD_UNID_ATEND, 
	0					QT_DIARIA_ENF, 
	0					QT_DIARIA_UTI, 
	0					CD_URA, 
	' '					CD_CPF_EXEC, 
	' '					NM_MEDICO_EXEC, 
	' '					CD_CPF_SOLIC, 
	' '					NM_MEDICO_SOLIC, 
	' '					IE_INDICACAO_CLINICA, 
	' '					NR_FATURA, 
	0					QT_CONTA_LOTE, 
	0					VL_TOTAL_LOTE, 
	sum(A.QT_TOTAL_CONTA)			QT_TOTAL_CONTA, 
	sum(A.VL_TOTAL_CONTA)			VL_TOTAL_CONTA 
FROM	W_INTERF_CONTA_TRAILLER A 
GROUP BY A.NR_SEQ_PROTOCOLO;

