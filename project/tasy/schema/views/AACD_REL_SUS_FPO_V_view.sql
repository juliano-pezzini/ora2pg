-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW aacd_rel_sus_fpo_v (cd_procedimento, ds_procedimento, ds_complexidade, dt_competencia, qt_fisico, qt_resultado_fisico, qt_result_fisico_prot, vl_saldo_fisico, vl_orcamentario, vl_resul_orcamento, vl_resul_orc_prot, vl_saldo_orcament) AS SELECT a.cd_procedimento,
	SUBSTR(obter_desc_procedimento(a.cd_procedimento, a.ie_origem_proced ),1,255) ds_procedimento, 
	SUBSTR(obter_complexidade_proced(a.cd_procedimento,a.ie_origem_proced),1,50) ds_complexidade, 
	TRUNC(a.dt_competencia,'mm') dt_competencia, 
	a.qt_fisico, 
	sus_obter_resultado_fpo(a.nr_sequencia,1,'E') qt_resultado_fisico, 
	sus_obter_resultado_fpo(a.nr_sequencia,1,'P') qt_result_fisico_prot, 
	(a.qt_fisico - sus_obter_resultado_fpo(a.nr_sequencia,1,'E')) vl_saldo_fisico, 
	a.vl_orcamento vl_orcamentario, 
	sus_obter_resultado_fpo(a.nr_sequencia,2,'E') vl_resul_orcamento, 
	sus_obter_resultado_fpo(a.nr_sequencia,2,'P') vl_resul_orc_prot, 
	(a.vl_orcamento - sus_obter_resultado_fpo(a.nr_sequencia,2,'E')) vl_saldo_orcament 
FROM 	sus_fpo_regra a;

