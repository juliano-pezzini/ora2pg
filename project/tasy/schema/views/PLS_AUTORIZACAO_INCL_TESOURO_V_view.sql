-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_autorizacao_incl_tesouro_v (nr_seq_lote, nr_seq_pagador, cd_matricula_pag, ie_tipo_registro, ds_movimento, cd_consignatoria, ds_especie, cd_autenticidade, dt_referencia, vl_autorizado, dt_inicial, ie_status) AS select	nr_sequencia nr_seq_lote,
	null nr_seq_pagador,
	null cd_matricula_pag,
	1 ie_tipo_registro,
	'HAUT' ds_movimento,
	'GOV627' cd_consignatoria,
	null ds_especie,
	null cd_autenticidade,
	to_char(LOCALTIMESTAMP,'yyyymmdd') dt_referencia,
	null vl_autorizado,
	null dt_inicial,
	null ie_status
FROM	pls_lote_mov_benef

union all

select	a.nr_seq_lote,
	rpad(a.nr_seq_pagador,40,0) nr_seq_pagador,
	'D' || rpad(a.cd_matricula,12,0) cd_matricula_pag,
	2 ie_tipo_registro,
	null ds_movimento,
	null cd_consignatoria,
	rpad('MENSALIDADE',20,' ') ds_especie,
	lpad(0,10,0) cd_autenticidade,
	to_char(a.dt_contratacao,'yyyymmdd') dt_referencia,
	lpad(obter_Valor_sem_virgula(a.vl_preco_segurado),9,0) vl_autorizado,
	to_char(a.dt_contratacao,'yyyymmdd') dt_inicial,
	'A' ie_status
from	pls_movimentacao_benef		a;

