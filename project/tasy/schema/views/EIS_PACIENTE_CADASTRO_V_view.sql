-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_paciente_cadastro_v (cd_religiao, ie_sexo, ie_estado_civil, ie_grau_instrucao, ie_faixa_etaria, ds_municipio, ds_bairro, cd_municipio_ibge, ds_municipio_ibge, dt_atualizacao_pf) AS select	/*+ index (b PESFISI_PK) */	b.cd_religiao,
	b.ie_sexo,
	b.ie_estado_civil,
	b.ie_grau_instrucao,
	substr(obter_idade(b.dt_nascimento,LOCALTIMESTAMP,'E'),1,10) ie_faixa_etaria,
	initcap(f.ds_municipio) ds_municipio,
	initcap(f.ds_bairro) ds_bairro,
	f.cd_municipio_ibge,
	initcap(obter_desc_municipio_ibge(f.cd_municipio_ibge)) ds_municipio_ibge,
	b.dt_atualizacao dt_atualizacao_pf
FROM pessoa_fisica b
LEFT OUTER JOIN compl_pessoa_fisica f ON (b.cd_pessoa_fisica = f.cd_pessoa_fisica AND 1 = f.ie_tipo_complemento);

