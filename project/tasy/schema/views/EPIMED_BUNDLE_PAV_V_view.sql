-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW epimed_bundle_pav_v (answer_id, checklist_id, module_id, checklist_date, updatetimestamp, updatetimestampfilter, hospital_attendance_number, question_id, answer_value) AS SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 0
      THEN '1'
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 1
      THEN '2' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 2
      THEN '3' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 3
      THEN '4'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '1'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED01'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '1'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '1'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED01A'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '2'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '1'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED01B'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '3'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '1'QUESTION_ID,
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED01C'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '4'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '1'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED01D'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 0
      THEN '5' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 1
      THEN '6' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 2
      THEN '7' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 3
      THEN '8'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '2'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED02'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '5'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '2'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED02A'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '6'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '2'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED02B'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '7'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '2'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED02C'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '8'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '2'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED02D'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 0
      THEN '9' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 1
      THEN '10' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 2
      THEN '11' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 3
      THEN '12' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 4
      THEN '13'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '3'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED03'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '9'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '3'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED03A'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '10'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '3'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED03B'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '11'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '3'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED03C'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '12'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '3'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED03D'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '13'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '3'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED03E'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 0
      THEN '14' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 1
      THEN '15' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 2
      THEN '16' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 3
      THEN '17'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '4'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED04'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '14'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '4'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED04A'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '15'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '4'QUESTION_ID,
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED04B'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '16'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '4'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED04C'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '17'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '4'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED04D'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 0
      THEN '18' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 1
      THEN '19'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '5'QUESTION_ID,
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED05'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '18'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '5'QUESTION_ID,
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED05A'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '19'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '5'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED05B'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '20'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '6'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED06A'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '21'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '6'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED06B'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '22'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '6'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED06C'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '23'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '6'QUESTION_ID,
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED063'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '24'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '6'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED06E'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 0
      THEN '25'
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 1
      THEN '26' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 2
      THEN '27' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 3
      THEN '28'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '7'QUESTION_ID,
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED07'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '25'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '7'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED07A'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '26'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '7'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED07B'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '27'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '7'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED07C'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '28'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '7'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED07D'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 0
      THEN '29' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 1
      THEN '30'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '8'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED08'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '29'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '8'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED08A'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '30'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '8'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED08B'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '31'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '9'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED09A'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '32'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '9'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED09B'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '33'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '9'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED09C'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 0
      THEN '34' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 1
      THEN '35' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 2
      THEN '36' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 3
      THEN '37'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '10'QUESTION_ID,
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED10'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '34'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '10'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED10A'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '35'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '10'QUESTION_ID,
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED10B'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '36'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '10'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED10C'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '37'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '10'QUESTION_ID, 
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED10D'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 0
      THEN '38' 
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao,b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 1
      THEN '39'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '11'QUESTION_ID,
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED11'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '38'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '11'QUESTION_ID,
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED11A'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    )
  
UNION ALL

  SELECT DISTINCT(
    CASE
      WHEN obter_Resultado_Avaliacao(b.nr_seq_avaliacao, b.nr_seq_item ,a.nr_seq_tipo_avaliacao,a.nr_atendimento) = 'Sim'
      THEN '39'
    END )ANSWER_ID,
    a.nr_sequencia CHECKLIST_ID,
    '129' MODULE_ID,
    TO_CHAR(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') CHECKLIST_DATE,
    TO_CHAR(a.dt_avaliacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') updatetimestamp,
    to_date(a.dt_atualizacao) UPDATETIMESTAMPFILTER,
    a.nr_atendimento HOSPITAL_ATTENDANCE_NUMBER,
    '11'QUESTION_ID,
    NULL ANSWER_VALUE
  FROM MED_AVALIACAO_PACIENTE a,
    med_avaliacao_result b
  WHERE a.nr_sequencia = b.nr_seq_avaliacao
  AND a.dt_liberacao  IS NOT NULL
  AND b.nr_seq_item    =
    (SELECT nr_sequencia FROM MED_ITEM_AVALIAR WHERE DS_ALIAS = 'EPIMED11B'
    )
  AND obter_setor_atual_paciente(a.NR_ATENDIMENTO) IN (SELECT cd_setor_atendimento
    FROM SETOR_ATENDIMENTO
    WHERE IE_EPIMED = 'S'
    AND ie_situacao = 'A'
    )
  AND a.nr_sequencia =
    (SELECT MAX(x.nr_sequencia)
    FROM MED_AVALIACAO_PACIENTE x
    WHERE x.dt_liberacao IS NOT NULL
    AND x.ie_situacao     = 'A'
    AND x.nr_atendimento  = a.nr_atendimento
    );

