-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_consulta_benef_v40_v (ie_tipo_registro, cd_transacao, nr_sequencia, nr_seq_execucao, nr_seq_guia, ie_tipo_cliente, cd_unimed_executora, cd_unimed_beneficiario, cd_unimed, cd_usuario_plano, dt_nascimento, nm_beneficiario, sobrenome_beneficiario, ds_fim) AS select	1				ie_tipo_registro,
	00412				cd_transacao,
	nr_sequencia			nr_sequencia,
	nr_seq_execucao 		nr_seq_execucao,
	nr_seq_guia 			nr_seq_guia,
	CASE WHEN ie_tipo_cliente='U' THEN 'UNIMED' WHEN ie_tipo_cliente='P' THEN 'PORTAL' WHEN ie_tipo_cliente='R' THEN 'PRESTADOR' END  ie_tipo_cliente,
	cd_unimed_executora 		cd_unimed_executora,
	cd_unimed_beneficiario 		cd_unimed_beneficiario,
	cd_unimed 			cd_unimed,
	cd_usuario_plano 		cd_usuario_plano,
	dt_nascimento 			dt_nascimento,
	nm_beneficiario 		nm_beneficiario,
	sobrenome_beneficiario		sobrenome_beneficiario,
	null				ds_fim
FROM	ptu_consulta_beneficiario

union

select	2				ie_tipo_registro,
	null				cd_transacao,
	nr_sequencia			nr_sequencia,
	nr_seq_execucao 		nr_seq_execucao,
	nr_seq_guia 			nr_seq_guia,
	null 				ie_tipo_cliente,
	null 				cd_unimed_executora,
	null 				cd_unimed_beneficiario,
	null 				cd_unimed,
	null 				cd_usuario_plano,
	null				dt_nascimento,
	null		 		nm_beneficiario,
	null				sobrenome_beneficiario,
	'FIM$'				ds_fim
from	ptu_consulta_beneficiario;

