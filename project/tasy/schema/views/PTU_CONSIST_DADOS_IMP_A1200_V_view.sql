-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_consist_dados_imp_a1200_v (ie_inconsistencia, ds_inconsistencia, cd_item, nr_seq_ptu_pacote, ds_item, ds_tipo) AS select	'1' ie_inconsistencia,
	'Pacote não cadastrado.' ds_inconsistencia,
	b.cd_pacote cd_item,
	a.nr_sequencia nr_seq_ptu_pacote,
	b.nm_pacote ds_item,
	'Pacote' ds_tipo
FROM	ptu_pacote_reg	b,
	ptu_pacote	a
where	a.nr_sequencia	= b.nr_seq_pacote
and	b.cd_pacote is not null
and	a.dt_importacao	is not null
and	not exists (select	1
			from	pls_pacote x
			where	x.cd_procedimento	= b.cd_pacote)

union

select	'2' ie_inconsistencia,
	'Procedimento de pacote não cadastrado como procedimento próprio.' ds_inconsistencia,
	b.cd_pacote cd_item,
	a.nr_sequencia nr_seq_ptu_pacote,
	b.nm_pacote ds_item,
	'Pacote' ds_tipo
from	ptu_pacote_reg	b,
	ptu_pacote	a
where	a.nr_sequencia	= b.nr_seq_pacote
and	b.cd_pacote is not null
and	a.dt_importacao	is not null
and	not exists (select	1
			from	procedimento x
			where	x.cd_procedimento	= b.cd_pacote
			and	x.ie_origem_proced 	= 4)

union

select	'3' ie_inconsistencia,
	'Procedimento da composição não cadastrado como procedimento.' ds_inconsistencia,
	c.cd_servico cd_item,
	a.nr_sequencia nr_seq_ptu_pacote,
	c.ds_servico ds_item,
	CASE WHEN c.ie_tipo_item=1 THEN 'Taxa' WHEN c.ie_tipo_item=2 THEN 'Diárias' WHEN c.ie_tipo_item=3 THEN 'Gases' WHEN c.ie_tipo_item=4 THEN 'Materiais' WHEN c.ie_tipo_item=5 THEN 'Medicamentos' WHEN c.ie_tipo_item=6 THEN 'Procedimentos' WHEN c.ie_tipo_item=7 THEN 'OPME' END  ds_tipo
from	ptu_pacote_servico	c,
	ptu_pacote_reg		b,
	ptu_pacote		a
where	a.nr_sequencia	= b.nr_seq_pacote
and	b.nr_sequencia	= c.nr_seq_pacote_reg
and	a.dt_importacao	is not null
and	b.cd_pacote is not null
and	c.cd_servico is not null
and	c.ie_tipo_tabela in (0,1,4)
and	not exists (select	1
			from	procedimento x
			where	x.cd_procedimento	= c.cd_servico)

union

select	'4' ie_inconsistencia,
	'Material da composição não cadastrado como material.' ds_inconsistencia,
	c.cd_servico cd_item,
	a.nr_sequencia nr_seq_ptu_pacote,
	c.ds_servico ds_item,
	CASE WHEN c.ie_tipo_item=1 THEN 'Taxa' WHEN c.ie_tipo_item=2 THEN 'Diárias' WHEN c.ie_tipo_item=3 THEN 'Gases' WHEN c.ie_tipo_item=4 THEN 'Materiais' WHEN c.ie_tipo_item=5 THEN 'Medicamentos' WHEN c.ie_tipo_item=6 THEN 'Procedimentos' WHEN c.ie_tipo_item=7 THEN 'OPME' END  ds_tipo
from	ptu_pacote_servico	c,
	ptu_pacote_reg		b,
	ptu_pacote		a
where	a.nr_sequencia	= b.nr_seq_pacote
and	b.nr_sequencia	= c.nr_seq_pacote_reg
and	a.dt_importacao	is not null
and	b.cd_pacote is not null
and	c.cd_servico is not null
and	c.ie_tipo_tabela in (2,3)
and	not exists (select	1
			from	pls_material x
			where	x.cd_material_ops_number = c.cd_servico);

