-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW rothman_lab_results_v (nr_sequencia, idobx, identifier, text, nameofcodingsystem, observatopmvalue, units, valuetype, date_time_of_message) AS select	a.nr_sequencia,
		1 idObx,
		'BUN' identifier,
		'Urea Nitrogen' text,
		'GVLABLRR' NameOfCodingSystem,
		substr(subst_virgula_ponto_adic_zero(dividir(QT_UREIA,2.14)),1,30) observatopmValue,
		'mg/dl' units,
		'NM' valueType,
		 to_char(a.dT_UREIA,'yyyymmddhh24miss') date_time_of_message
FROM	escala_rothman a

union all

select	a.nr_sequencia,
		2 idObx,
		'CREA' identifier,
		'Creatinine' text,
		'GVLABLRR' NameOfCodingSystem,
		substr(subst_virgula_ponto_adic_zero(QT_CREATININA),1,30)  observatopmValue,
		'mg/dl' units,
		'NM' valueType,
		 to_char(a.dT_CREATININA,'yyyymmddhh24miss') date_time_of_message
from	escala_rothman a

union all

select	a.nr_sequencia,
		3 idObx,
		'WBCMOR' identifier,
		'WBC Morphology' text,
		'GVLABLRR' NameOfCodingSystem,
		substr(subst_virgula_ponto_adic_zero(dividir(QT_GLOB_BRANCOS,1000)),1,30)  observatopmValue,
		'10x3/ul' units,
		'NM' valueType,
		 to_char(a.dT_GLOB_BRANCOS,'yyyymmddhh24miss') date_time_of_message
from	escala_rothman a

union all

select	a.nr_sequencia,
		4 idObx,
		'HGB' identifier,
		'HGB' text,
		'GVLABLRR' NameOfCodingSystem,
		substr(subst_virgula_ponto_adic_zero(QT_GLOB_VERMELHOS),1,30)  observatopmValue,
		'10x6/ul' units,
		'NM' valueType,
		 to_char(a.dT_GLOB_VERMELHOS,'yyyymmddhh24miss') date_time_of_message
from	escala_rothman a

union all

select	a.nr_sequencia,
		5 idObx,
		'CL' identifier,
		'Chloride' text,
		'GVLABLRR' NameOfCodingSystem,
		substr(subst_virgula_ponto_adic_zero(QT_CLORO),1,30)  observatopmValue,
		'mEq/l' units,
		'NM' valueType,
		 to_char(a.DT_CLORO,'yyyymmddhh24miss') date_time_of_message
from	escala_rothman a

union all

select	a.nr_sequencia,
		6 idObx,
		'NA' identifier,
		'Sodium' text,
		'GVLABLRR' NameOfCodingSystem,
		substr(subst_virgula_ponto_adic_zero(QT_SODIO),1,30)  observatopmValue,
		'mEq/l' units,
		'NM' valueType,
		 to_char(a.dT_SODIO,'yyyymmddhh24miss') date_time_of_message
from	escala_rothman a

union all

select	a.nr_sequencia,
		7 idObx,
		'K' identifier,
		'Potassium' text,
		'GVLABLRR' NameOfCodingSystem,
		substr(subst_virgula_ponto_adic_zero(QT_POTASSIO_SERICO),1,30)  observatopmValue,
		'mEq/l' units,
		'NM' valueType,
		 to_char(a.dT_POTASSIO_SERICO,'yyyymmddhh24miss') date_time_of_message
from	escala_rothman a;

