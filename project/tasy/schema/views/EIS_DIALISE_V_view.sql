-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_dialise_v (cd_cid_direta, cd_cid_principal, cd_convenio, cd_empresa, cd_estabelecimento, cd_pessoa_fisica, dt_atualizacao, dt_atualizacao_nrec, dt_referencia, nm_usuario, nm_usuario_nrec, nr_seq_dialisador, nr_seq_unid_dialise, nr_seq_unid_dialise_atual, qt_acesso_adequado, qt_acesso_inadequado, qt_acessos_realizados, qt_agudos_fim_dia, qt_agudos_fim_mes_ant, qt_alta_agudo, qt_alta_cronico, qt_cateter_dl, qt_cronicos_fim_dia, qt_cronicos_fim_mes_ant, qt_culturas, qt_desistencia, qt_entrada_agudo, qt_entrada_cronico, qt_hd_hp, qt_hipertenso, qt_internados, qt_mes_atual, qt_novos_cateter_dl, qt_novos_permcatch, qt_obito_agudo, qt_obito_cronico_mais_90_dias, qt_obito_cronico_menos_90_dias, qt_pac_diabeticos, qt_pac_transito, qt_perdas_acessos, qt_perdas_dl, qt_perdas_permcath, qt_permcath, qt_pirogenia, qt_pressao_alta_pos, qt_pressao_alta_pre, qt_protese, qt_saida_tx, qt_sessoes_dialise, qt_sessoes_dialise_agudo, qt_sessoes_dialise_cronico, qt_sessoes_dialise_dia, qt_transferencia, qt_transfusoes, cd_setor_atendimento, ds_unid_dialise, ds_cid_morte, nm_pessoa_fisica, nm_empresa, nm_estabelecimento, ds_setor_atendimento, ds_convenio) AS select	a.CD_CID_DIRETA,
	a.CD_CID_PRINCIPAL, 
	a.CD_CONVENIO, 
	a.CD_EMPRESA, 
	a.CD_ESTABELECIMENTO, 
	a.CD_PESSOA_FISICA, 
	a.DT_ATUALIZACAO, 
	a.DT_ATUALIZACAO_NREC, 
	a.DT_REFERENCIA, 
	a.NM_USUARIO, 
	a.NM_USUARIO_NREC, 
	a.NR_SEQ_DIALISADOR, 
	a.NR_SEQ_UNID_DIALISE, 
	a.NR_SEQ_UNID_DIALISE_ATUAL, 
	a.QT_ACESSO_ADEQUADO, 
	a.QT_ACESSO_INADEQUADO, 
	a.QT_ACESSOS_REALIZADOS, 
	a.QT_AGUDOS_FIM_DIA, 
	a.QT_AGUDOS_FIM_MES_ANT, 
	a.QT_ALTA_AGUDO, 
	a.QT_ALTA_CRONICO, 
	a.QT_CATETER_DL, 
	a.QT_CRONICOS_FIM_DIA, 
	a.QT_CRONICOS_FIM_MES_ANT, 
	a.QT_CULTURAS, 
	a.QT_DESISTENCIA, 
	a.QT_ENTRADA_AGUDO, 
	a.QT_ENTRADA_CRONICO, 
	a.QT_HD_HP, 
	a.QT_HIPERTENSO, 
	a.QT_INTERNADOS, 
	a.QT_MES_ATUAL, 
	a.QT_NOVOS_CATETER_DL, 
	a.QT_NOVOS_PERMCATCH, 
	a.QT_OBITO_AGUDO, 
	a.QT_OBITO_CRONICO_MAIS_90_DIAS, 
	a.QT_OBITO_CRONICO_MENOS_90_DIAS, 
	a.QT_PAC_DIABETICOS, 
	a.QT_PAC_TRANSITO, 
	a.QT_PERDAS_ACESSOS, 
	a.QT_PERDAS_DL, 
	a.QT_PERDAS_PERMCATH, 
	a.QT_PERMCATH, 
	a.QT_PIROGENIA, 
	a.QT_PRESSAO_ALTA_POS, 
	a.QT_PRESSAO_ALTA_PRE, 
	a.QT_PROTESE, 
	a.QT_SAIDA_TX, 
	a.QT_SESSOES_DIALISE, 
	a.QT_SESSOES_DIALISE_AGUDO, 
	a.QT_SESSOES_DIALISE_CRONICO, 
	a.QT_SESSOES_DIALISE_DIA, 
	a.QT_TRANSFERENCIA, 
	a.QT_TRANSFUSOES, 
	(	select	d.cd_setor_atendimento 
		FROM	HD_DIALISE_DIALISADOR b, 
			hd_ponto_acesso c, 
			setor_atendimento d 
		where	a."NR_SEQ_DIALISADOR" = b.nr_sequencia 
		and	b.nr_seq_ponto_acesso = c.nr_sequencia 
		and	c.cd_setor_atendimento = d.cd_setor_atendimento) cd_setor_atendimento,	 
	substr(hd_obter_desc_unid_dialise(a.nr_seq_unid_dialise),1,80) ds_unid_dialise, 
	substr(obter_desc_cid_doenca(a.cd_cid_direta),1,240) ds_cid_morte, 
	substr(obter_nome_pf(a.cd_pessoa_fisica),1,254) nm_pessoa_fisica, 
	substr(obter_nome_empresa(a.cd_empresa),1,80) nm_empresa, 
	substr(obter_nome_estabelecimento(a.cd_estabelecimento),1,80) nm_estabelecimento, 
	(	select	d.ds_setor_atendimento 
		from	HD_DIALISE_DIALISADOR b, 
				hd_ponto_acesso c, 
				setor_atendimento d 
		where	a."NR_SEQ_DIALISADOR" = b.nr_sequencia 
		and		b.nr_seq_ponto_acesso = c.nr_sequencia 
		and		c.cd_setor_atendimento = d.cd_setor_atendimento) ds_setor_atendimento, 
	substr(OBTER_DESC_CONVENIO(a.cd_convenio),1,100) ds_convenio 
from	eis_dialise a;

