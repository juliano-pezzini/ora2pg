-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_retorno_movimentacao_v (tp_registro, nr_sequencia, cd_tipo_registro, nr_seq_retorno, cd_unimed_des, cd_unimed_ori, dt_geracao, ie_tipo_mov, dt_mov_ini, dt_mov_final, nr_seq_versao, ie_tipo_produto, cd_unimed, id_benef, cd_mens_erro, cd_unimed_cad, id_benef_cad, nr_via_carteira, dt_validade_carteira, qt_tot_r202, qt_tot_inclusao, qt_tot_exclusao, qt_tot_alteracao, qt_tot_transf_plano, qt_tot_recusado) AS select	1			tp_registro,
	1			nr_sequencia,
	'201'			cd_tipo_registro,
	nr_sequencia		nr_seq_retorno,
	cd_unimed_destino	cd_unimed_des,
	cd_unimed_origem	cd_unimed_ori,
	dt_geracao		dt_geracao,
	ie_tipo_mov		ie_tipo_mov,
	dt_mov_inicio		dt_mov_ini,
	dt_mov_fim		dt_mov_final,
	NULL			nr_seq_versao,
	' '		ie_tipo_produto,
	null			cd_unimed,
	null			id_benef,
	null			cd_mens_erro,
	null			cd_unimed_cad,
	null			id_benef_cad,
	null			nr_via_carteira,
	null			dt_validade_carteira,
	null			qt_tot_r202,
	null			qt_tot_inclusao,
	null			qt_tot_exclusao,
	null			qt_tot_alteracao,
	null			qt_tot_transf_plano,
	null			qt_tot_recusado
FROM	ptu_retorno_movimentacao

union

select	2			tp_registro,
	2			nr_sequencia,
	'202'			cd_tipo_registro,
	nr_seq_retorno_mov	nr_seq_retorno,
	null			cd_unimed_des,
	null			cd_unimed_ori,
	null			dt_geracao,
	null			ie_tipo_mov,
	null			dt_mov_ini,
	null			dt_mov_final,
	null			nr_seq_versao,
	null			ie_tipo_produto,
	cd_unimed		cd_unimed,
	cd_usuario_plano	id_benef,
	cd_inconsistencia	cd_mens_erro,
	cd_unimed_cad		cd_unimed_cad,
	cd_usuario_plano_cad	id_benef_cad,
	nr_via_carteira		nr_via_carteira,
	dt_validade_carteira	dt_validade_carteira,
	null			qt_tot_r202,
	null			qt_tot_inclusao,
	null			qt_tot_exclusao,
	null			qt_tot_alteracao,
	null			qt_tot_transf_plano,
	null			qt_tot_recusado
from	ptu_retorno_mov_benef

union

select	3			tp_registro,
	3			nr_sequencia,
	'209'			cd_tipo_registro,
	nr_sequencia		nr_seq_retorno,
	null			cd_unimed_des,
	null			cd_unimed_ori,
	null			dt_geracao,
	null			ie_tipo_mov,
	null			dt_mov_ini,
	null			dt_mov_final,
	null			nr_seq_versao,
	null			ie_tipo_produto,
	null			cd_unimed,
	null			id_benef,
	null			cd_mens_erro,
	null			cd_unimed_cad,
	null			id_benef_cad,
	null			nr_via_carteira,
	null			dt_validade_carteira,
	substr(obter_qt_registro_ptu_a200(nr_sequencia,'102'),1,10)		qt_tot_r202,
	substr(obter_qt_registro_ptu_a200(nr_sequencia,'QT_INCLUSAO'),1,10)	qt_tot_inclusao,
	substr(obter_qt_registro_ptu_a200(nr_sequencia,'QT_EXCLUSAO'),1,10)	qt_tot_exclusao,
	substr(obter_qt_registro_ptu_a200(nr_sequencia,'QT_ALTERADOS'),1,10)	qt_tot_alteracao,
	substr(obter_qt_registro_ptu_a200(nr_sequencia,'QT_PLANO'),1,10)	qt_tot_transf_plano,
	substr(obter_qt_registro_ptu_a200(nr_sequencia,'QT_RECUSADOS'),1,10)	qt_tot_recusado
from	ptu_retorno_movimentacao;

