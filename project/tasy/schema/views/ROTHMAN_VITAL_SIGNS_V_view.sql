-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW rothman_vital_signs_v (nr_sequencia, idobx, identifier, text, nameofcodingsystem, observatopmvalue, units, valuetype, date_time_of_message) AS select	a.nr_sequencia,
		1 idObx,
		'TEMPERATURE' identifier,
		'Temp' text,
		'ROTHMAN' NameOfCodingSystem,
		substr(subst_virgula_ponto_adic_zero(Converter_Fahrenheit(QT_TEMP)),1,30) observatopmValue,
		'Degrees Fahrenheit' units,
		'NM' valueType,
		 to_char(a.dt_TEMP,'yyyymmddhh24miss') date_time_of_message
FROM	escala_rothman a

union all

select	a.nr_sequencia,
		2 idObx,
		'SBP' identifier,
		'SBP' text,
		'ROTHMAN' NameOfCodingSystem,
		substr(subst_virgula_ponto_adic_zero(QT_PA_SISTOLICA),1,30)  observatopmValue,
		'mm/Hg' units,
		'NM' valueType,
		 to_char(a.dt_PA_SISTOLICA,'yyyymmddhh24miss') date_time_of_message
from	escala_rothman a

union all

select	a.nr_sequencia,
		3 idObx,
		'DBP' identifier,
		'DBP' text,
		'ROTHMAN' NameOfCodingSystem,
		substr(subst_virgula_ponto_adic_zero(QT_PA_DIASTOLICA),1,30)  observatopmValue,
		'mm/Hg' units,
		'NM' valueType,
		 to_char(a.dt_PA_DIASTOLICA,'yyyymmddhh24miss') date_time_of_message
from	escala_rothman a

union all

select	a.nr_sequencia,
		4 idObx,
		'HEARTRATE' identifier,
		'Pulse' text,
		'ROTHMAN' NameOfCodingSystem,
		substr(subst_virgula_ponto_adic_zero(QT_FREQ_CARDIACA),1,30)  observatopmValue,
		'Beats/Minute' units,
		'NM' valueType,
		 to_char(a.dT_FREQ_CARDIACA,'yyyymmddhh24miss') date_time_of_message
from	escala_rothman a

union all

select	a.nr_sequencia,
		5 idObx,
		'RESPIRATION' identifier,
		'Resp' text,
		'ROTHMAN' NameOfCodingSystem,
		substr(subst_virgula_ponto_adic_zero(QT_FREQ_RESP),1,30)  observatopmValue,
		'Beats/Minute' units,
		'NM' valueType,
		 to_char(a.dT_FREQ_RESP,'yyyymmddhh24miss') date_time_of_message
from	escala_rothman a

union all

select	a.nr_sequencia,
		6 idObx,
		'O2SAT' identifier,
		'SpO2' text,
		'ROTHMAN' NameOfCodingSystem,
		substr(subst_virgula_ponto_adic_zero(QT_SATURACAO_O2),1,30)  observatopmValue,
		'Beats/Minute' units,
		'NM' valueType,
		 to_char(a.dT_SATURACAO_O2,'yyyymmddhh24miss') date_time_of_message
from	escala_rothman a;

