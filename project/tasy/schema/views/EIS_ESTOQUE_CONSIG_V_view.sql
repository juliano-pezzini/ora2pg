-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_estoque_consig_v (cd_estabelecimento, cd_local_estoque, cd_fornecedor, cd_material, dt_mesano_referencia, qt_estoque, dt_atualizacao, nm_usuario, vl_estoque, vl_custo_medio, ie_bloqueio_inventario, vl_preco_ult_compra, dt_ult_compra, qt_ocor_invent_ok, qt_ocor_invent, qt_inventario, dt_mensal, cd_grupo_material, ds_grupo_material, cd_subgrupo_material, ds_subgrupo_material, cd_classe_material, ds_classe_material, ds_local_estoque, ds_fornecedor, ds_mesano, ds_material) AS select	a.CD_ESTABELECIMENTO,a.CD_LOCAL_ESTOQUE,a.CD_FORNECEDOR,a.CD_MATERIAL,a.DT_MESANO_REFERENCIA,a.QT_ESTOQUE,a.DT_ATUALIZACAO,a.NM_USUARIO,a.VL_ESTOQUE,a.VL_CUSTO_MEDIO,a.IE_BLOQUEIO_INVENTARIO,a.VL_PRECO_ULT_COMPRA,a.DT_ULT_COMPRA,a.QT_OCOR_INVENT_OK,a.QT_OCOR_INVENT,a.QT_INVENTARIO,
	trunc(a.dt_mesano_referencia, 'MONTH') dt_mensal,
	b.cd_grupo_material,
	b.ds_grupo_material,
	b.cd_subgrupo_material,
	b.ds_subgrupo_material,
	b.cd_classe_material,
	b.ds_classe_material,
	obter_desc_local_estoque(a.cd_local_estoque) ds_local_estoque,
	obter_razao_social(a.cd_fornecedor) ds_fornecedor,
	to_char(a.dt_mesano_referencia, 'mm/yyyy') ds_mesano,
	obter_desc_material(a.cd_material) ds_material
FROM 	estrutura_material_v b,
	fornecedor_mat_consignado a
where	a.cd_material	= b.cd_material;

