-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ccih_infeccoes_v2 (nr_ficha_ocorrencia, nr_atendimento, nm_paciente, dt_infeccao, ds_clinica, ds_topografia, nm_guerra, espec_medico, ds_setor, ds_diag) AS select	x.nr_ficha_ocorrencia,
	x.nr_atendimento, 
	substr(obter_nome_pf(obter_dados_atendimento(x.nr_atendimento, 'CP')),1,100) nm_paciente, 
	a.dt_infeccao, 
	substr(obter_nome_clinica(a.cd_clinica),1,100) ds_clinica, 
	substr(obter_desc_topografia(a.cd_topografia),1,100) ds_topografia, 
	substr(obter_nome_medico(x.cd_medico,'G'),1,100) nm_guerra, 
	substr(obter_especialidade_medico(x.cd_medico, 'D'),1,255) espec_medico, 
	substr(obter_nome_setor(obter_setor_atendimento(x.nr_atendimento)),1,100) ds_setor, 
	x.ds_diagnostico_int ds_diag 
FROM	cih_local_infeccao a, 
	cih_ficha_ocorrencia x 
where	1 = 1 
and	x.dt_cancelamento is null 
and	a.nr_ficha_ocorrencia		= x.nr_ficha_ocorrencia 
order by	3;

