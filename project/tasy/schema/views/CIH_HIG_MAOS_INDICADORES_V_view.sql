-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW cih_hig_maos_indicadores_v (nr_sequencia_higienizacao, ie_momento, ds_ie_momento, ie_categoria_profissional, ds_categoria_profissional, cd_profissional, nm_profissional, ie_sexo, ds_ie_sexo, ie_higienizou, dt_observacao, dt_mes_observacao, cd_observador_pf, nm_observador, nr_sequencia_material, ds_material, ie_tecnica, ie_turno, ds_ie_turno, cd_setor_atendimento, ds_setor_atendimento, vl_percentualdeadesao, nm_usuario, nr_seq_profissional, ds_profissional) AS SELECT
	nr_sequencia	 						AS nr_sequencia_higienizacao,
	ie_momento							AS ie_momento,
	SUBSTR(obter_valor_dominio(7445, ie_momento),1,255)		AS ds_ie_momento,
	ie_categoria_profissional		 			AS ie_categoria_profissional,
	SUBSTR(obter_valor_dominio(72, ie_categoria_profissional),1,255) 	AS ds_categoria_profissional,
	cd_profissional			   				AS cd_profissional,
	SUBSTR(obter_nome_pf(cd_profissional),1,255)			AS nm_profissional,
	ie_sexo								AS ie_sexo,
	SUBSTR(obter_valor_dominio(4, ie_sexo),1,255) 			AS ds_ie_sexo,
	ie_higienizou 		  					AS ie_higienizou,
	dt_observacao 							AS dt_observacao,
	extract(month FROM dt_observacao) 				AS dt_mes_observacao,
	cd_observador_pf 						AS cd_observador_pf,
	SUBSTR(obter_nome_pf(cd_observador_pf),1,255) 			AS nm_observador,
	nr_seq_material							AS nr_sequencia_material,
	SUBSTR(obter_material_higienizacao(nr_seq_material),1,255)	AS ds_material,
	ie_tecnica					  		AS ie_tecnica,
	ie_turno							AS ie_Turno,
	SUBSTR(obter_valor_dominio(5874, ie_turno),1,255) 		AS ds_ie_Turno,
	cd_setor_atendimento				 		AS cd_setor_atendimento,
	SUBSTR(obter_nome_setor(cd_setor_atendimento),1,255) 		AS ds_setor_atendimento,
	qt_informacao					 		AS vl_PercentualdeAdesao,
	nm_usuario,
	nr_seq_profissional			   				AS nr_seq_profissional,
	SUBSTR(obter_desc_cih_profissional(nr_seq_profissional),1,255)			AS ds_profissional
from	w_hig_maos_ind;

