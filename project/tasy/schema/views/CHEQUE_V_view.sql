-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW cheque_v (cd_banco, cd_agencia_bancaria, nr_cheque, dt_emissao, vl_cheque, dt_atualizacao, nm_usuario, cd_cgc_emitente, cd_cgc_destinatario, cd_pessoa_destinatario, ds_destinatario, dt_impressao, ie_situacao, cd_estabelecimento, nr_sequencia, nr_seq_lote, nr_seq_saldo_caixa, ds_observacao, nr_seq_conta_banco, dt_cancelamento, dt_compensacao, dt_vencimento, nr_talao, ds_utilizacao, nr_seq_trans_fin_emissao, nr_seq_trans_fin_comp, dt_pagamento, dt_prev_pagamento, ds_banco, ds_cod_banco, ds_emitente, ds_favorecido, cd_conta, cd_banco_estab, vl_cheque_estrang, vl_cotacao, cd_moeda) AS Select	a.CD_BANCO,
	a.CD_AGENCIA_BANCARIA, 
	a.NR_CHEQUE, 
	a.DT_EMISSAO, 
	a.VL_CHEQUE, 
	a.DT_ATUALIZACAO, 
	a.NM_USUARIO, 
	a.CD_CGC_EMITENTE, 
	a.CD_CGC_DESTINATARIO, 
	a.CD_PESSOA_DESTINATARIO, 
	a.DS_DESTINATARIO, 
	a.DT_IMPRESSAO, 
	a.IE_SITUACAO, 
	a.CD_ESTABELECIMENTO, 
	a.NR_SEQUENCIA, 
	a.NR_SEQ_LOTE, 
	a.NR_SEQ_SALDO_CAIXA, 
	a.DS_OBSERVACAO, 
	a.NR_SEQ_CONTA_BANCO, 
	a.DT_CANCELAMENTO, 
	a.DT_COMPENSACAO, 
	a.DT_VENCIMENTO, 
	a.NR_TALAO, 
	a.DS_UTILIZACAO, 
	a.NR_SEQ_TRANS_FIN_EMISSAO, 
	a.NR_SEQ_TRANS_FIN_COMP, 
	a.DT_PAGAMENTO, 
	a.DT_PREV_PAGAMENTO, 
	b.ds_banco, 
	b.cd_banco||' '||b.ds_banco ds_cod_banco, 
	d.ds_razao_social ds_emitente, 
	coalesce(a.ds_destinatario, coalesce(e.ds_razao_social, substr(obter_nome_pf(f.cd_pessoa_fisica),1,255))) ds_favorecido, 
	g.cd_conta, 
	coalesce(a.cd_banco, g.cd_banco) cd_banco_estab, 
	a.VL_CHEQUE_ESTRANG, 
	a.VL_COTACAO, 
	a.cd_moeda 
FROM pessoa_juridica d, banco b, cheque a
LEFT OUTER JOIN banco_estabelecimento g ON (a.nr_seq_conta_banco = g.nr_sequencia)
LEFT OUTER JOIN pessoa_juridica e ON (a.cd_cgc_destinatario = e.cd_cgc)
LEFT OUTER JOIN pessoa_fisica f ON (a.cd_pessoa_destinatario = f.cd_pessoa_fisica)
WHERE a.cd_banco		 	= b.cd_banco and a.cd_cgc_emitente     	= d.cd_cgc;

