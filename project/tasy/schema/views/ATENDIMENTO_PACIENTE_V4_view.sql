-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW atendimento_paciente_v4 (nr_atendimento, ie_tipo_atendimento, ds_tipo_atendimento, cd_departamento, ds_departamento, dt_entrada_paciente, dt_saida_paciente, nr_dias_paciente) AS select  a.nr_atendimento,
		a.ie_tipo_atendimento,
		coalesce(obter_descricao_dominio(12, a.ie_tipo_atendimento), obter_desc_expressao(309956)) ds_tipo_atendimento,
        obter_departamento_data(a.nr_atendimento, LOCALTIMESTAMP) cd_departamento,
        (select ds_departamento FROM departamento_medico where cd_departamento = obter_departamento_data(a.nr_atendimento, LOCALTIMESTAMP)) ds_departamento,
        a.dt_entrada dt_entrada_paciente,
        a.dt_saida_real dt_saida_paciente,
        obter_dias_entre_datas(a.dt_entrada, coalesce(a.dt_saida_real, LOCALTIMESTAMP)) nr_dias_paciente
from    atendimento_paciente a
where   a.ie_tipo_atendimento in (1, 8)
and     obter_departamento_data(a.nr_atendimento, LOCALTIMESTAMP) is not null;

