-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_ctb_orcamento_v (nr_seq_mes_ref, dt_referencia, cd_empresa, cd_estabelecimento, cd_grupo, cd_conta_contabil, cd_centro_custo, vl_original, vl_orcado, vl_realizado, vl_diferenca, ds_conta_contabil, ds_grupo, ds_centro_custo, ds_estabelecimento) AS select	a.nr_seq_mes_ref,
	d.dt_referencia,
	d.cd_empresa,
	a.cd_estabelecimento,
	b.cd_grupo,
	a.cd_conta_contabil,
	a.cd_centro_custo,
	a.vl_original,
	a.vl_orcado,
	a.vl_realizado,
	a.vl_orcado - a.vl_realizado vl_diferenca,
	b.ds_conta_contabil,
	c.ds_grupo,
	e.ds_centro_custo,
	substr(obter_nome_estabelecimento(a.cd_estabelecimento),1,255) ds_estabelecimento
FROM	ctb_orcamento a,
	conta_contabil b,
	ctb_grupo_conta c,
	ctb_mes_ref d,
	centro_custo e
where	a.cd_conta_contabil = b.cd_conta_contabil
and	b.cd_grupo = c.cd_grupo
and	a.nr_seq_mes_ref = d.nr_sequencia
and	a.cd_centro_custo = e.cd_centro_custo
and	c.ie_tipo in ('R','C','D');

