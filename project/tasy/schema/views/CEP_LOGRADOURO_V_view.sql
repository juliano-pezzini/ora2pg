-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW cep_logradouro_v (nm_localidade, cd_cep, nm_logradouro, ds_uf, ds_bairro, ds_complemento, ds_tipo_logradouro, ds_preposicao) AS select	a.nm_localidade,
	b.cd_cep,
	b.nm_logradouro,
	b.ds_uf,
	substr(OBTER_DESC_CEP_BAIRRO(cd_bairro_inicial,a.nr_sequencia),1,90) ds_bairro,
	b.ds_complemento,
	b.ds_tipo_logradouro,
	b.ds_preposicao
FROM	cep_loc a,
	cep_log b,
	funcao_parametro d
where	a.nr_sequencia = b.nr_seq_loc
and	d.cd_funcao = 0
and	d.nr_sequencia = 25
and	coalesce(d.vl_parametro, d.vl_parametro_padrao) = 'S'

union

select	b.nm_localidade,
	b.cd_logradouro,
	b.nm_logradouro,
	b.cd_unidade_federacao,
	b.nm_bairro,
	'',
	substr(obter_valor_dominio(1463,b.tp_logradouro),1,125) ds_tipo_logradouro,
	''
from	cep_logradouro b,
	funcao_parametro c
where	c.cd_funcao = 0
and	c.nr_sequencia = 25
and	coalesce(c.vl_parametro, c.vl_parametro_padrao) = 'N';

