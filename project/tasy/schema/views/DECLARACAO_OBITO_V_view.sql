-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW declaracao_obito_v (dt_obito, ie_utilizacao, nr_atendimento, nr_declaracao, dt_entrada, dt_alta, nm_paciente, dt_nascimento, cd_setor_obito, cd_estabelecimento, ds_setor_obito, ds_causa_morte, ds_cid_direta) AS Select a.dt_obito,
	a.ie_utilizacao, 
	a.nr_atendimento, 
	a.nr_declaracao, 
	b.dt_entrada, 
	b.dt_alta, 
	coalesce(c.nm_pessoa_fisica, coalesce(a.nm_paciente, 'Cancelado')) nm_paciente, 
	c.dt_nascimento, 
	b.cd_setor_obito, 
	b.cd_estabelecimento, 
	substr(obter_nome_setor(b.cd_setor_obito),1,100) ds_setor_obito, 
	substr(Obter_desc_causa_morte(c.cd_pessoa_fisica),1,255) ds_causa_morte, 
	substr(obter_desc_cid(a.CD_CID_DIRETA),1,255) ds_cid_direta 
FROM declaracao_obito a
LEFT OUTER JOIN atendimento_paciente b ON (a.nr_atendimento = b.nr_atendimento)
LEFT OUTER JOIN pessoa_fisica c ON (b.cd_pessoa_fisica = c.cd_pessoa_fisica);

