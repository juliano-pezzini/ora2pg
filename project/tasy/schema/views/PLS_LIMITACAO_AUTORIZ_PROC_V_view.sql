-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_limitacao_autoriz_proc_v (cd_procedimento, ds_estrutura, ds_origem_proc, qt_permitida, ds_periodo, nr_seq_contrato, nr_seq_plano, ie_periodo, ie_origem_proced, nr_seq_limitacao, ie_tipo_periodo, nr_seq_plano_contrato) AS select	cd_procedimento,
	ds_estrutura,
	ds_origem_proc,
	qt_permitida,
	ds_periodo,
	nr_seq_contrato,
	nr_seq_plano,
	ie_periodo,
	ie_origem_proced,
	nr_seq_limitacao,
	ie_tipo_periodo,
	NR_SEQ_PLANO_CONTRATO
FROM ( select	b.cd_procedimento,
		substr(f.ds_procedimento,1,255) ds_estrutura,
		substr(pls_obter_dados_cad_proc(b.nr_sequencia,'L','O'),1,255) ds_origem_proc,
		a.qt_permitida,
		substr(CASE WHEN a.ie_periodo='A' THEN 'Data adesão' WHEN a.ie_periodo='CO' THEN 'Ano contratual' WHEN a.ie_periodo='CA' THEN 'Ano calendário' WHEN a.ie_periodo='D' THEN 'Data da primeira utilização' END ,1,50) ds_periodo,
		a.nr_seq_contrato,
		a.nr_seq_plano,
		a.NR_SEQ_PLANO_CONTRATO,
		a.ie_periodo,
		f.ie_origem_proced,
		a.nr_sequencia nr_seq_limitacao,
		a.ie_tipo_periodo
	from	procedimento		f,
		pls_limitacao_proc	b,
		pls_limitacao		a
	where	a.nr_seq_tipo_limitacao = b.nr_seq_tipo_limitacao
	and	b.cd_procedimento = f.cd_procedimento
	and	b.ie_origem_proced = f.ie_origem_proced
	
union

	select	f.cd_procedimento,
		substr(f.ds_procedimento,1,255) ds_estrutura,
		substr(pls_obter_dados_cad_proc(b.nr_sequencia,'L','O'),1,255) ds_origem_proc,
		a.qt_permitida,
		substr(CASE WHEN a.ie_periodo='A' THEN 'Data adesão' WHEN a.ie_periodo='CO' THEN 'Ano contratual' WHEN a.ie_periodo='CA' THEN 'Ano calendário' WHEN a.ie_periodo='D' THEN 'Data da primeira utilização' END ,1,50) ds_periodo,
		a.nr_seq_contrato,
		a.nr_seq_plano,
		a.NR_SEQ_PLANO_CONTRATO,
		a.ie_periodo,
		f.ie_origem_proced,
		a.nr_sequencia nr_seq_limitacao,
		a.ie_tipo_periodo
	from	procedimento		f,
		grupo_proc		e,
		especialidade_proc	d,
		area_procedimento	c,
		pls_limitacao_proc	b,
		pls_limitacao		a
	where	a.nr_seq_tipo_limitacao = b.nr_seq_tipo_limitacao
	and	b.cd_area_procedimento = c.cd_area_procedimento
	and	c.cd_area_procedimento = d.cd_area_procedimento
	and	d.cd_especialidade = e.cd_especialidade
	and	e.cd_grupo_proc = f.cd_grupo_proc
	and	b.ie_origem_proced = f.ie_origem_proced
	
union

	select	f.cd_procedimento,
		substr(f.ds_procedimento,1,255) ds_estrutura,
		substr(pls_obter_dados_cad_proc(b.nr_sequencia,'L','O'),1,255) ds_origem_proc,
		a.qt_permitida,
		substr(CASE WHEN a.ie_periodo='A' THEN 'Data adesão' WHEN a.ie_periodo='CO' THEN 'Ano contratual' WHEN a.ie_periodo='CA' THEN 'Ano calendário' WHEN a.ie_periodo='D' THEN 'Data da primeira utilização' END ,1,50) ds_periodo,
		a.nr_seq_contrato,
		a.nr_seq_plano,
		a.NR_SEQ_PLANO_CONTRATO,
		a.ie_periodo,
		f.ie_origem_proced,
		a.nr_sequencia nr_seq_limitacao,
		a.ie_tipo_periodo
	from	procedimento		f,
		grupo_proc		e,
		especialidade_proc	d,
		pls_limitacao_proc	b,
		pls_limitacao		a
	where	a.nr_seq_tipo_limitacao = b.nr_seq_tipo_limitacao
	and	b.cd_especialidade = d.cd_especialidade
	and	d.cd_especialidade = e.cd_especialidade
	and	e.cd_grupo_proc = f.cd_grupo_proc
	and	b.ie_origem_proced = f.ie_origem_proced
	
union

	select	f.cd_procedimento,
		substr(f.ds_procedimento,1,255) ds_estrutura,
		substr(pls_obter_dados_cad_proc(b.nr_sequencia,'L','O'),1,255) ds_origem_proc,
		a.qt_permitida,
		substr(CASE WHEN a.ie_periodo='A' THEN 'Data adesão' WHEN a.ie_periodo='CO' THEN 'Ano contratual' WHEN a.ie_periodo='CA' THEN 'Ano calendário' WHEN a.ie_periodo='D' THEN 'Data da primeira utilização' END ,1,50) ds_periodo,
		a.nr_seq_contrato,
		a.nr_seq_plano,
		a.NR_SEQ_PLANO_CONTRATO,
		a.ie_periodo,
		f.ie_origem_proced,
		a.nr_sequencia nr_seq_limitacao,
		a.ie_tipo_periodo
	from	procedimento		f,
		grupo_proc		e,
		pls_limitacao_proc	b,
		pls_limitacao		a
	where	a.nr_seq_tipo_limitacao = b.nr_seq_tipo_limitacao
	and	b.cd_grupo_proc = e.cd_grupo_proc
	and	e.cd_grupo_proc = f.cd_grupo_proc
	and	b.ie_origem_proced = f.ie_origem_proced	) alias16;

