-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ctb_dmpl_movimento_v (nr_seq_dmpl, ds_linha, nr_seq_ordem, vl_1_coluna, vl_2_coluna, vl_3_coluna, vl_4_coluna, vl_5_coluna, vl_6_coluna, vl_7_coluna, vl_8_coluna, vl_9_coluna, vl_10_coluna, vl_11_coluna, vl_12_coluna, vl_13_coluna, vl_14_coluna, vl_15_coluna, vl_16_coluna, vl_17_coluna, vl_18_coluna, vl_19_coluna, vl_20_coluna, vl_21_coluna, vl_22_coluna, vl_23_coluna, vl_24_coluna, vl_25_coluna, vl_26_coluna, vl_27_coluna, vl_28_coluna, vl_29_coluna, vl_30_coluna, vl_31_coluna, vl_32_coluna, vl_33_coluna, vl_34_coluna, vl_35_coluna, vl_36_coluna, vl_37_coluna, vl_38_coluna, vl_39_coluna, vl_40_coluna, nr_seq_mutacao_pl) AS select	a.nr_seq_dmpl,
	a.ds_linha,
	CASE WHEN a.ie_linha='SA' THEN 1 WHEN a.ie_linha='MO' THEN 2 WHEN a.ie_linha='SF' THEN 3 END  nr_seq_ordem,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=1 THEN  a.vl_movimento END ),0) vl_1_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=2 THEN  a.vl_movimento END ),0) vl_2_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=3 THEN  a.vl_movimento END ),0) vl_3_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=4 THEN  a.vl_movimento END ),0) vl_4_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=5 THEN  a.vl_movimento END ),0) vl_5_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=6 THEN  a.vl_movimento END ),0) vl_6_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=7 THEN  a.vl_movimento END ),0) vl_7_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=8 THEN  a.vl_movimento END ),0) vl_8_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=9 THEN  a.vl_movimento END ),0) vl_9_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=10 THEN  a.vl_movimento END ),0) vl_10_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=11 THEN  a.vl_movimento END ),0) vl_11_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=12 THEN  a.vl_movimento END ),0) vl_12_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=13 THEN  a.vl_movimento END ),0) vl_13_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=14 THEN  a.vl_movimento END ),0) vl_14_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=15 THEN  a.vl_movimento END ),0) vl_15_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=16 THEN  a.vl_movimento END ),0) vl_16_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=17 THEN  a.vl_movimento END ),0) vl_17_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=18 THEN  a.vl_movimento END ),0) vl_18_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=19 THEN  a.vl_movimento END ),0) vl_19_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=20 THEN  a.vl_movimento END ),0) vl_20_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=21 THEN  a.vl_movimento END ),0) vl_21_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=22 THEN  a.vl_movimento END ),0) vl_22_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=23 THEN  a.vl_movimento END ),0) vl_23_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=24 THEN  a.vl_movimento END ),0) vl_24_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=25 THEN  a.vl_movimento END ),0) vl_25_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=26 THEN  a.vl_movimento END ),0) vl_26_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=27 THEN  a.vl_movimento END ),0) vl_27_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=28 THEN  a.vl_movimento END ),0) vl_28_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=29 THEN  a.vl_movimento END ),0) vl_29_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=30 THEN  a.vl_movimento END ),0) vl_30_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=31 THEN  a.vl_movimento END ),0) vl_31_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=32 THEN  a.vl_movimento END ),0) vl_32_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=33 THEN  a.vl_movimento END ),0) vl_33_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=34 THEN  a.vl_movimento END ),0) vl_34_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=35 THEN  a.vl_movimento END ),0) vl_35_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=36 THEN  a.vl_movimento END ),0) vl_36_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=37 THEN  a.vl_movimento END ),0) vl_37_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=38 THEN  a.vl_movimento END ),0) vl_38_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=39 THEN  a.vl_movimento END ),0) vl_39_coluna,
	coalesce(sum(CASE WHEN c.nr_seq_coluna=40 THEN  a.vl_movimento END ),0) vl_40_coluna,
	a.nr_seq_mutacao_pl
FROM 	ctb_dmpl_coluna c,
		ctb_dmpl_movimento a
where	a.nr_seq_dmpl	= c.nr_seq_dmpl
and		a.nr_seq_col	= c.nr_sequencia
group by a.ie_linha,
	  	 a.nr_seq_dmpl,
		 a.ds_linha,
		 a.nr_seq_mutacao_pl
order by nr_seq_ordem,ds_linha;

