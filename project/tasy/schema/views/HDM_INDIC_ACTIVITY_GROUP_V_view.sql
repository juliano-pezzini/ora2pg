-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW hdm_indic_activity_group_v (nr_day_of_week, nr_day, si_holiday, si_weekend, dt_day_scheduled, ds_day_of_week, nr_year, nr_month, nr_semester, nr_quarter, dt_month_scheduled, dt_day_begin, dt_day_end, nr_seq_dm_program, nr_seq_program, nm_program, nm_program_module, nr_seq_dm_group, nm_group, nm_group_class, nr_seq_turma, nm_responsability, nm_professional, nm_team, nm_episode_place, si_form, ds_form, si_type, ds_type, si_cancelled, ds_cancelled, si_confirmed, ds_confirmed, si_reason_cancel, ds_reason_cancel, si_status, ds_status, nr_seq_fact, qt_expected, qt_real, qt_individual_after, qt_exp_by_fact, qt_real_by_fact, qt_after_by_person, si_present, si_first_encounter, si_last_encounter, pr_conclusion, nr_seq_schedule, nr_dif_person, ds_unique) AS SELECT	/* Dados dia agendado */
	c.nr_day_of_week,
	c.nr_day,
	c.si_holiday,
	c.si_weekend,
	c.dt_complete_date dt_day_scheduled,
	c.ds_day_of_week,
	/* Dados mÃªs agendado */

	b.nr_year,
	b.nr_month,
	b.nr_semester,
	b.nr_quarter,
	b.dt_complete_date dt_month_scheduled,
	/* Dados dia inicio */

	z.dt_complete_date dt_day_begin,
	/* Dados dia end */

	y.dt_complete_date dt_day_end,
	/* Dados programa */

	e.nr_sequencia nr_seq_dm_program,
	e.nr_seq_program nr_seq_program,
	e.nm_program,
	e.nm_program_module nm_program_module,
	/* Dados grupo atividade */

	i.nr_sequencia nr_seq_dm_group,
	i.nm_group,
	i.nm_class nm_group_class,
	i.nr_seq_turma,
	/* Dados profissional*/

	p.nm_responsability,
	p.nm_professional,
	p.nm_team,
	/* Dados detalhe agendamento */

	h.nm_place nm_episode_place,
	h.si_form,
	h.ds_form,
	h.si_type,
	h.ds_type,
	h.si_cancelled,
	h.ds_cancelled,
	h.si_confirmed,
	h.ds_confirmed,
	h.si_reason_cancel,
	h.ds_reason_cancel,
	h.si_status,
	h.ds_status,
	/* Dados fato */

	a.nr_sequencia nr_seq_fact,
	a.qt_expected,
	a.qt_real,
	a.qt_individual_after,
	(a.qt_expected / COUNT(1) OVER (PARTITION BY a.nr_sequencia)) qt_exp_by_fact,
	(a.qt_real / COUNT(1) OVER (PARTITION BY a.nr_sequencia)) qt_real_by_fact,
	(a.qt_individual_after / COUNT(1) OVER (PARTITION BY a.nr_dif_person)) qt_after_by_person,
	a.si_present,
	a.si_first_encounter,
	a.si_last_encounter,
	a.pr_conclusion,
	a.nr_seq_schedule,
	a.nr_dif_person,
	a.ds_unique
FROM	hdm_indic_dm_program e,
	hdm_indic_dm_activ_group i,
	hdm_indic_dm_professional p,
	hdm_indic_ft_group_act_pr f,
	hdm_indic_ft_group_act_ag j,
	hdm_indic_ft_group_act_pf q,
	hdm_indic_dm_app_details h,
	hdm_indic_dm_day y,
	hdm_indic_dm_day z,
	hdm_indic_dm_day c,
	hdm_indic_dm_month b,
	hdm_indic_ft_group_act a
WHERE	1 = 1
AND	f.nr_seq_dimension = e.nr_sequencia
AND	j.nr_seq_dimension = i.nr_sequencia
AND	q.nr_seq_dimension = p.nr_sequencia
AND	a.nr_sequencia = f.nr_seq_fact
AND	a.nr_sequencia = j.nr_seq_fact
AND	a.nr_sequencia = q.nr_seq_fact
AND	a.nr_seq_app_detail = h.nr_sequencia
AND	b.nr_sequencia = a.nr_seq_month_scheduled
AND	c.nr_sequencia = a.nr_seq_day_scheduled
AND	z.nr_sequencia = a.nr_seq_day_begin
AND	y.nr_sequencia = a.nr_seq_day_end;

