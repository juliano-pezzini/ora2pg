-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_intercambio_a800_62_v (nr_seq_fatura, nr_sequencial, tp_registro, cd_registro, cd_unimed_destino, cd_unimed_origem, tp_documento, dt_geracao, dt_competencia, dt_cobranca_inicial, dt_cobranca_final, reservado_1, reservado_2, reservado_3, nr_documento, nr_doc_fiscal, dt_ven_doc, dt_emi_doc, vl_tot_doc, vl_tot_doc_liq, vl_ajuste_doc, nr_versao_transacao, vl_ir, cd_unimed, id_beneficiario, cd_filial, cd_familia, cd_dependencia, nm_beneficiario, dt_nascimento, cd_plano_intercambio, vl_mensalidade_original, vl_inscricao_original, vl_mensalidade_cobrado, vl_inscricao_cobrado, vl_ajuste_cobrado, cd_empresa_origem, qt_total_r802, vl_tot_mens_original, vl_tot_insc_original, vl_total_mensalidade, vl_total_inscricao, vl_total_ajuste, ie_cedente_sacado, cd_operadora_ans, nm_cedente_sacado, ds_endereco, ds_endereco_compl, ds_bairro, cd_cep, ds_cidade, sg_uf, cd_cnpj_cpf, cd_inscricao_estadual, nr_ddd, nr_telefone, nr_fax, nr_endereco, nr_linha, ds_linha, vl_item, nr_banco, cd_agencia_cedente, nr_nosso_numero, ds_uso_banco, ds_carteira, ds_especie, vl_documento, dt_documento, ie_especie_documento, ie_aceite, dt_processamento, ds_local_pagamento, ds_observacao_pagamento, ds_instrucao, ds_observacao, ds_linha_digitavel, cd_barras) AS select	nr_sequencia							nr_seq_fatura,
	1								nr_sequencial,
	tp_registro							tp_registro,
	'801'								cd_registro,
	lpad(cd_unimed_destino,4,'0')					cd_unimed_destino,
	lpad(cd_unimed_origem,4,'0')					cd_unimed_origem,
	'1'								tp_documento,
	dt_geracao							dt_geracao,
	dt_competencia							dt_competencia,
	LOCALTIMESTAMP								dt_cobranca_inicial,
	LOCALTIMESTAMP								dt_cobranca_final,
	' ' 								reservado_1,
	' ' 								reservado_2,
	' ' 								reservado_3,
	nr_documento							nr_documento,
	nr_documento							nr_doc_fiscal,
	dt_vencimento							dt_ven_doc,
	LOCALTIMESTAMP								dt_emi_doc,
	(replace(replace(campo_mascara(vl_total,2),',',''),'.',''))::numeric 		vl_tot_doc,
	(replace(replace(campo_mascara(vl_total_liq,2),',',''),'.',''))::numeric 	vl_tot_doc_liq,
	(replace(replace(campo_mascara(vl_ajuste,2),',',''),'.',''))::numeric 		vl_ajuste_doc,
	nr_versao_transacao						nr_versao_transacao,
	replace(replace(campo_mascara(vl_ir,2),',',''),'.','')		vl_ir,
	null								cd_unimed,
	null								id_beneficiario,
	null								cd_filial,
	null								cd_familia,
	null								cd_dependencia,
	null								nm_beneficiario,
	null								dt_nascimento,
	null								cd_plano_intercambio,
	null								vl_mensalidade_original,
	null								vl_inscricao_original,
	null								vl_mensalidade_cobrado,
	null								vl_inscricao_cobrado,
	null								vl_ajuste_cobrado,
	null								cd_empresa_origem,
	null								qt_total_r802,
	null								vl_tot_mens_original,
	null								vl_tot_insc_original,
	null								vl_total_mensalidade,
	null								vl_total_inscricao,
	null								vl_total_ajuste,
	null								ie_cedente_sacado,
	null								cd_operadora_ans,
	null								nm_cedente_sacado,
	null								ds_endereco,
	null								ds_endereco_compl,
	null								ds_bairro,
	null								cd_cep,
	null								ds_cidade,
	null								sg_uf,
	null								cd_cnpj_cpf,
	null								cd_inscricao_estadual,
	null								nr_ddd,
	null								nr_telefone,
	null								nr_fax,
	null								nr_endereco,
	null								nr_linha,
	null								ds_linha,
	null								vl_item,
	null								nr_banco,
	null								cd_agencia_cedente,
	null								nr_nosso_numero,
	null								ds_uso_banco,
	null								ds_carteira,
	null								ds_especie,
	null								vl_documento,
	null								dt_documento,
	null								ie_especie_documento,
	null								ie_aceite,
	null								dt_processamento,
	null								ds_local_pagamento,
	null								ds_observacao_pagamento,
	null								ds_instrucao,
	null								ds_observacao,
	null								ds_linha_digitavel,
	null								cd_barras
FROM	ptu_fatura_pre

union all

select	a.nr_sequencia							nr_seq_fatura,
	2								nr_sequencial,
	b.tp_registro							tp_registro,
	'802'								cd_registro,
	null								cd_unimed_destino,
	null								cd_unimed_origem,
	null								tp_documento,
	null								dt_geracao,
	null								dt_competencia,
	null								dt_cobranca_inicial,
	null								dt_cobranca_final,
	'0000' 								reservado_1,
	' ' 								reservado_2,
	' ' 								reservado_3,
	null								nr_documento,
	null								nr_doc_fiscal,
	null								dt_ven_doc,
	null								dt_emi_doc,
	null								vl_tot_doc,
	null								vl_tot_doc_liq,
	null								vl_ajuste_doc,
	null								nr_versao_transacao,
	null								vl_ir,
	b.cd_unimed							cd_unimed,
	lpad(b.id_beneficiario,13,'0')					id_beneficiario,
	b.cd_filial							cd_filial,
	b.cd_familia							cd_familia,
	b.cd_dependencia						cd_dependencia,
	b.nm_beneficiario						nm_beneficiario,
	b.dt_nascimento							dt_nascimento,
	b.cd_plano_intercambio						cd_plano_intercambio,
	replace(replace(campo_mascara(b.vl_mensalidade_original,2),',',''),'.','')	vl_mensalidade_original,
	replace(replace(campo_mascara(b.vl_inscricao_original,2),',',''),'.','')	vl_inscricao_original,
	replace(replace(campo_mascara(b.vl_mensalidade_cobrado,2),',',''),'.','')	vl_mensalidade_cobrado,
	replace(replace(campo_mascara(b.vl_inscricao_cobrado,2),',',''),'.','')		vl_inscricao_cobrado,
	replace(replace(campo_mascara(b.vl_ajuste_cobrado,2),',',''),'.','')	vl_ajuste_cobrado,
	b.cd_empresa_origem						cd_empresa_origem,
	null								qt_total_r802,
	null								vl_tot_mens_original,
	null								vl_tot_insc_original,
	null								vl_total_mensalidade,
	null								vl_total_inscricao,
	null								vl_total_ajuste,
	null								ie_cedente_sacado,
	null								cd_operadora_ans,
	null								nm_cedente_sacado,
	null								ds_endereco,
	null								ds_endereco_compl,
	null								ds_bairro,
	null								cd_cep,
	null								ds_cidade,
	null								sg_uf,
	null								cd_cnpj_cpf,
	null								cd_inscricao_estadual,
	null								nr_ddd,
	null								nr_telefone,
	null								nr_fax,
	null								nr_endereco,
	null								nr_linha,
	null								ds_linha,
	null								vl_item,
	null								nr_banco,
	null								cd_agencia_cedente,
	null								nr_nosso_numero,
	null								ds_uso_banco,
	null								ds_carteira,
	null								ds_especie,
	null								vl_documento,
	null								dt_documento,
	null								ie_especie_documento,
	null								ie_aceite,
	null								dt_processamento,
	null								ds_local_pagamento,
	null								ds_observacao_pagamento,
	null								ds_instrucao,
	null								ds_observacao,
	null								ds_linha_digitavel,
	null								cd_barras
from	ptu_fatura_pre_cobranca	b,
	ptu_fatura_pre		a
where	b.nr_seq_fatura		= a.nr_sequencia

union all

select	a.nr_sequencia							nr_seq_fatura,
	3								nr_sequencial,
	b.tp_registro							tp_registro,
	'809'								cd_registro,
	null								cd_unimed_destino,
	null								cd_unimed_origem,
	null								tp_documento,
	null								dt_geracao,
	null								dt_competencia,
	null								dt_cobranca_inicial,
	null								dt_cobranca_final,
	' ' 								reservado_1,
	' ' 								reservado_2,
	' ' 								reservado_3,
	null								nr_documento,
	null								nr_doc_fiscal,
	null								dt_ven_doc,
	null								dt_emi_doc,
	null								vl_tot_doc,
	null								vl_tot_doc_liq,
	null								vl_ajuste_doc,
	null								nr_versao_transacao,
	null								vl_ir,
	null								cd_unimed,
	null								id_beneficiario,
	null								cd_filial,
	null								cd_familia,
	null								cd_dependencia,
	null								nm_beneficiario,
	null								dt_nascimento,
	null								cd_plano_intercambio,
	null								vl_mensalidade_original,
	null								vl_inscricao_original,
	null								vl_mensalidade_cobrado,
	null								vl_inscricao_cobrado,
	null								vl_ajuste_cobrado,
	null								cd_empresa_origem,
	b.qt_total_r802							qt_total_r802,
	(replace(replace(campo_mascara(b.vl_tot_mens_original,2),',',''),'.',''))::numeric 	vl_tot_mens_original,
	(replace(replace(campo_mascara(b.vl_tot_insc_original,2),',',''),'.',''))::numeric 	vl_tot_insc_original,
	(replace(replace(campo_mascara(b.vl_total_mensalidade,2),',',''),'.',''))::numeric 	vl_total_mensalidade,
	(replace(replace(campo_mascara(b.vl_total_inscricao,2),',',''),'.',''))::numeric 	vl_total_inscricao,
	(replace(replace(campo_mascara(b.vl_total_ajuste,2),',',''),'.',''))::numeric 	vl_total_ajuste,
	null								ie_cedente_sacado,
	null								cd_operadora_ans,
	null								nm_cedente_sacado,
	null								ds_endereco,
	null								ds_endereco_compl,
	null								ds_bairro,
	null								cd_cep,
	null								ds_cidade,
	null								sg_uf,
	null								cd_cnpj_cpf,
	null								cd_inscricao_estadual,
	null								nr_ddd,
	null								nr_telefone,
	null								nr_fax,
	null								nr_endereco,
	null								nr_linha,
	null								ds_linha,
	null								vl_item,
	null								nr_banco,
	null								cd_agencia_cedente,
	null								nr_nosso_numero,
	null								ds_uso_banco,
	null								ds_carteira,
	null								ds_especie,
	null								vl_documento,
	null								dt_documento,
	null								ie_especie_documento,
	null								ie_aceite,
	null								dt_processamento,
	null								ds_local_pagamento,
	null								ds_observacao_pagamento,
	null								ds_instrucao,
	null								ds_observacao,
	null								ds_linha_digitavel,
	null								cd_barras
from	ptu_fatura_pre_total	b,
	ptu_fatura_pre		a
where	b.nr_seq_fatura		= a.nr_sequencia;

