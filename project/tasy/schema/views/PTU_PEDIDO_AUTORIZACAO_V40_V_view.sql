-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_pedido_autorizacao_v40_v (ie_tipo_registro, cd_transacao, nr_sequencia, nr_seq_requisicao, nr_seq_guia, ie_tipo_cliente, cd_unimed_exec, cd_unimed_benef, nr_ident_exec, cd_unimed, cd_usuario_plano, nr_via_cartao, cd_cid, ie_alto_custo, nm_prestador, cd_unimed_prest_req, cd_prestador_requisitante, cd_unimed_prestador, cd_prestador, cd_especialidade_medica, qt_dias_doenca, ie_urgencia_emergencia, dt_atendimento, nr_versao, ds_observacao, ds_indicacao_clinica, ds_biometria, tp_tabela, cd_procedimento, qt_procedimento, ds_opme, vl_procedimento, ds_fim) AS select	1					ie_tipo_registro,
	00600					cd_transacao,
	nr_sequencia				nr_sequencia,
	nr_seq_requisicao			nr_seq_requisicao,
	nr_seq_guia				nr_seq_guia,
	CASE WHEN ie_tipo_cliente='U' THEN 'UNIMED' WHEN ie_tipo_cliente='P' THEN 'PORTAL' WHEN ie_tipo_cliente='R' THEN 'PRESTADOR' END  ie_tipo_cliente,
	cd_unimed_executora			cd_unimed_exec,
	cd_unimed_beneficiario			cd_unimed_benef,
	nr_seq_execucao				nr_ident_exec,
	cd_unimed				cd_unimed,
	cd_usuario_plano			cd_usuario_plano,
	nr_via_cartao				nr_via_cartao,
	cd_doenca_cid				cd_cid,
	ie_alto_custo				ie_alto_custo,
	nm_prestador_alto_custo			nm_prestador,
	cd_unimed_prestador_req			cd_unimed_prest_req,
	nr_seq_prestador_req			cd_prestador_requisitante,
	cd_unimed_prestador			cd_unimed_prestador,
	nr_seq_prest_alto_custo			cd_prestador,
	substr(cd_especialidade,1,2)		cd_especialidade_medica,
	qt_dias_doenca				qt_dias_doenca,
	ie_urg_emerg				ie_urgencia_emergencia,
	dt_atendimento				dt_atendimento,
	nr_versao				nr_versao,
	null					ds_observacao,
	null 					ds_indicacao_clinica,
	null					ds_biometria,
	null					tp_tabela,
	null					cd_procedimento,
	null					qt_procedimento,
	null					ds_opme,
	null					vl_procedimento,
	''					ds_fim
FROM	ptu_pedido_autorizacao

union

select	2					ie_tipo_registro,
	null					cd_transacao,
	nr_sequencia				nr_sequencia,
	nr_seq_requisicao			nr_seq_requisicao,
	nr_seq_guia				nr_seq_guia,
	null					ie_tipo_cliente,
	null					cd_unimed_exec,
	null					cd_unimed_benef,
	null					nr_ident_exec,
	null					cd_unimed,
	null					cd_usuario_plano,
	null					nr_via_cartao,
	null					cd_cid,
	null					ie_alto_custo,
	null					nm_prestador,
	null					cd_unimed_prest_req,
	null					cd_prestador_requisitante,
	null					cd_unimed_prestador,
	null					cd_prestador,
	null					cd_especialidade_medica,
	null					qt_dias_doenca,
	null					ie_urgencia_emergencia,
	null					dt_atendimento,
	null					nr_versao,
	Elimina_Acentuacao(substr(replace(replace(ds_observacao,chr(13),''),chr(10),''),1,4000))	ds_observacao,
	Elimina_Acentuacao(substr(replace(replace(ds_ind_clinica,chr(13),''),chr(10),''),1,4000))	ds_indicacao_clinica,
	Elimina_Acentuacao(ds_biometria)	ds_biometria,
	null					tp_tabela,
	null					cd_procedimento,
	null					qt_procedimento,
	null					ds_opme,
	null					vl_procedimento,
	''					ds_fim
from	ptu_pedido_autorizacao

union

select	5					ie_tipo_registro,
	null					cd_transacao,
	nr_seq_pedido				nr_sequencia,
	nr_seq_requisicao			nr_seq_requisicao,
	nr_seq_guia				nr_seq_guia,
	null					ie_tipo_cliente,
	null					cd_unimed_exec,
	null					cd_unimed_benef,
	null					nr_ident_exec,
	null					cd_unimed,
	null					cd_usuario_plano,
	null					nr_via_cartao,
	null					cd_cid,
	null					ie_alto_custo,
	null					nm_prestador,
	null					cd_unimed_prest_req,
	null					cd_prestador_requisitante,
	null					cd_unimed_prestador,
	null					cd_prestador,
	null					cd_especialidade_medica,
	null					qt_dias_doenca,
	null					ie_urgencia_emergencia,
	null					dt_atendimento,
	null					nr_versao,
	null					ds_observacao,
	null					ds_indicacao_clinica,
	null					ds_biometria,
	ie_tipo_tabela				tp_tabela,
	coalesce(cd_servico_consersao,cd_servico)	cd_procedimento,
	qt_servico				qt_procedimento,
	Elimina_Acentuacao(ds_opme)		ds_opme,
	ptu_obter_valor_env_itens_scs(vl_servico) vl_procedimento,
	''					ds_fim
from	ptu_pedido_aut_servico b,
	ptu_pedido_autorizacao a
where	b.nr_seq_pedido	= a.nr_sequencia

union

select	6					ie_tipo_registro,
	null					cd_transacao,
	nr_sequencia				nr_sequencia,
	nr_seq_requisicao			nr_seq_requisicao,
	nr_seq_guia				nr_seq_guia,
	null					ie_tipo_cliente,
	null					cd_unimed_exec,
	null					cd_unimed_benef,
	null					nr_ident_exec,
	null					cd_unimed,
	null					cd_usuario_plano,
	null					nr_via_cartao,
	null					cd_cid,
	null					ie_alto_custo,
	null					nm_prestador,
	null					cd_unimed_prest_req,
	null					cd_prestador_requisitante,
	null					cd_unimed_prestador,
	null					cd_prestador,
	null					cd_especialidade_medica,
	null					qt_dias_doenca,
	null					ie_urgencia_emergencia,
	null					dt_atendimento,
	null					nr_versao,
	null					ds_observacao,
	null					ds_indicacao_clinica,
	null					ds_biometria,
	null					tp_tabela,
	null					cd_procedimento,
	null					qt_procedimento,
	''					ds_opme,
	null					vl_procedimento,
	'FIM$'					ds_fim
from	ptu_pedido_autorizacao;

