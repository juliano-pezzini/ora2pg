-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW resumo_agendamento_v (dt_agenda, ds_tipo, ds_agenda, cd_pessoa_fisica, nr_atendimento) AS select 	a.hr_inicio dt_agenda,
	c.ds_tipo ds_tipo,
	OBTER_DESC_AGENDA_NOVA(a.CD_AGENDA) ds_agenda ,
	a.cd_pessoa_fisica cd_pessoa_fisica,
	a.nr_atendimento nr_atendimento
FROM agenda_paciente a,
	agenda b,
	(select  OBTER_DESC_EXPRESSAO(317519, 'Agenda de Exames') ds_tipo ) c
where a.cd_agenda = b.cd_agenda
and b.cd_tipo_Agenda = 2
and a.cd_pessoa_fisica is not null

union all

select 	a.dt_agenda dt_agenda,
	c.ds_tipo ds_tipo,
	OBTER_DESC_AGENDA_NOVA(a.CD_AGENDA) ds_agenda ,
	a.cd_pessoa_fisica cd_pessoa_fisica,
	a.nr_atendimento nr_atendimento
from agenda_consulta a,
	agenda b,
	(select  OBTER_DESC_EXPRESSAO(308113, 'Agenda de Consultas') ds_tipo ) c
where a.cd_agenda = b.cd_agenda
and b.cd_tipo_Agenda in (3,4)
and a.cd_pessoa_fisica is not null

union all

select 	a.dt_agenda dt_agenda,
	c.ds_tipo ds_tipo,
	OBTER_DESC_AGENDA_NOVA(a.CD_AGENDA) ds_agenda ,
	a.cd_pessoa_fisica cd_pessoa_fisica,
	a.nr_atendimento nr_atendimento
from agenda_consulta a,
	agenda b,
	(select  OBTER_DESC_EXPRESSAO(308324, 'Agenda de Servicos') ds_tipo ) c
where a.cd_agenda = b.cd_agenda
and b.cd_tipo_Agenda = 5
and a.cd_pessoa_fisica is not null;

