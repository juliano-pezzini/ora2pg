-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW titulo_receber_liq_ctb_camb_v (nr_lote_contabil, nr_titulo, vl_transacao, nr_seq_trans_fin, dt_recebimento, nr_seq_conta_banco, ds_atributo, cd_centro_custo, nr_seq_caixa_rec, nr_seq_movto_trans_fin, nr_seq_trans_caixa, nr_seq_retorno, nr_seq_ret_item, ds_observacao, ie_acao, nr_adiantamento, nr_documento, nr_seq_baixa, cd_tipo_recebimento, cd_moeda, nr_bordero) AS select	a.nr_lote_contabil,
	a.nr_titulo,
	CASE WHEN a.ie_acao='I' THEN  a.vl_cambial_ativo  ELSE a.vl_cambial_ativo * -1 END  vl_transacao,
	a.nr_seq_trans_fin,
	a.dt_recebimento,
	a.nr_seq_conta_banco,
	'VL_CAMBIAL_ATIVO' ds_atributo,
	0 cd_centro_custo,
	a.nr_seq_caixa_rec,
	a.nr_seq_movto_trans_fin,
	a.nr_seq_trans_caixa,
	a.nr_seq_retorno,
	a.nr_seq_ret_item,
	a.ds_observacao,
	a.ie_acao,
	a.nr_adiantamento,
	a.nr_documento,
	a.nr_sequencia nr_seq_baixa,
	a.cd_tipo_recebimento,
	a.cd_moeda,
	a.nr_bordero
FROM 	titulo_receber_liq a
where 	a.vl_cambial_ativo <> 0
and	coalesce(ie_lib_caixa, 'S') = 'S'

union all

select	a.nr_lote_contabil,
	a.nr_titulo,
	CASE WHEN a.ie_acao='I' THEN  a.vl_cambial_passivo  ELSE a.vl_cambial_passivo * -1 END  vl_transacao,
	a.nr_seq_trans_fin,
	a.dt_recebimento,
	a.nr_seq_conta_banco,
	'VL_CAMBIAL_PASSIVO' ds_atributo,
	0 cd_centro_custo,
	a.nr_seq_caixa_rec,
	a.nr_seq_movto_trans_fin,
	a.nr_seq_trans_caixa,
	a.nr_seq_retorno,
	a.nr_seq_ret_item,
	a.ds_observacao,
	a.ie_acao,
	a.nr_adiantamento,
	a.nr_documento,
	a.nr_sequencia nr_seq_baixa,
	a.cd_tipo_recebimento,
	a.cd_moeda,
	a.nr_bordero
from 	titulo_receber_liq a
where 	a.vl_cambial_passivo <> 0
and	coalesce(ie_lib_caixa, 'S') = 'S';

