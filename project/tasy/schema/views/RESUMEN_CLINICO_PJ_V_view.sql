-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW resumen_clinico_pj_v (cd_versao_atual, ds_oid, nr_telefone, ds_email, cd_cgc, precinct_philips, county_philips, state_philips, postal_code_philips, precinct_atend, county_atend, state_atend, postal_code_atend, ds_oid_user_a, ds_oid_user_e, cd_clues_solic, ds_razao_social_solic, ds_oid_solic, cd_cgc_solicitante, nr_atendimento, cd_estabelecimento, cd_internacional, cd_internacional_atend, cd_estabelecimento_oid) AS SELECT (SELECT CD_VERSAO_ATUAL FROM APLICACAO_TASY WHERE CD_APLICACAO_TASY = 'Tasy') CD_VERSAO_ATUAL,
	   CO.DS_OID DS_OID,
	   PJ.NR_TELEFONE NR_TELEFONE,
	   PJ.DS_EMAIL DS_EMAIL,
	   PJ.CD_CGC CD_CGC,
	   ccph.cd_localidade precinct_philips,
	   ccph.cd_municipio county_philips,
  	   ccph.cd_estado state_philips,
  	   ccph.cd_postal postal_code_philips,
	   ccatend.cd_localidade precinct_atend,
	   ccatend.cd_municipio county_atend,
  	   ccatend.cd_estado state_atend,
  	   ccatend.cd_postal postal_code_atend,
	   (SELECT   DS_OID FROM 	CADASTRO_OID coua WHERE 	coua.CD_ESTABELECIMENTO = wheb_usuario_pck.get_cd_estabelecimento AND	IE_TIPO_OID = 'A') DS_OID_USER_A,
	   (SELECT   DS_OID FROM 	CADASTRO_OID coue WHERE 	coue.CD_ESTABELECIMENTO = wheb_usuario_pck.get_cd_estabelecimento AND	IE_TIPO_OID = 'E') DS_OID_USER_E,
	   pjso.cd_internacional cd_clues_solic,
  	   pjso.ds_razao_social ds_razao_social_solic,
  	   coso.ds_oid ds_oid_solic,
	   pjso.cd_cgc cd_cgc_solicitante,
	   ap.nr_atendimento nr_atendimento,
	   E.CD_ESTABELECIMENTO CD_ESTABELECIMENTO,
	   pj.cd_internacional CD_INTERNACIONAL,
	   pjap.CD_INTERNACIONAL CD_INTERNACIONAL_ATEND,
	   wheb_usuario_pck.get_cd_estabelecimento CD_ESTABELECIMENTO_OID
FROM   PESSOA_JURIDICA PJ,
	   CADASTRO_OID CO,
	   ESTABELECIMENTO E,
	   cat_clues ccph,
	   cat_clues ccatend,
	   atendimento_paciente ap,
	   estabelecimento eap,
	   pessoa_juridica pjap,
	   pessoa_juridica pjso,
	   estabelecimento eso,
	   cadastro_oid coso
WHERE  PJ.CD_CGC = '01950338000177' --PJ philips
AND	   E.CD_CGC= PJ.CD_CGC
AND	   CO.CD_ESTABELECIMENTO = E.CD_ESTABELECIMENTO
AND    pj.cd_internacional = ccph.cd_clues
AND	   pjap.CD_INTERNACIONAL = ccatend.cd_clues
AND    ap.cd_estabelecimento = eap.cd_estabelecimento
AND    eap.cd_cgc = pjap.cd_cgc
AND    pjso.cd_cgc = eso.cd_cgc
AND    eso.cd_estabelecimento = coso.cd_estabelecimento;

