-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW fanep_item_pendente_pep_v (nr_sequencia, ds_item, nr_seq_apres, nm_usuario, nr_atendimento, cd_perfil, dt_liberacao, dt_assinatura, cd_pessoa_fisica, nr_item, nr_projeto, ds_tipo_fk, ie_processo_assinado) AS SELECT f.nr_parecer nr_sequencia,
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		NULL nr_projeto, 
		'nr_parecer' ds_tipo_fk, 
		'' ie_processo_assinado 
	FROM parecer_medico_req f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_atendimento                  = f.nr_atendimento AND c.nr_parecer                    = f.nr_parecer AND c.nr_seq_perda_ganho                IS NULL AND c.nr_parecer                    IS NOT NULL AND c.nr_seq_anamnese                 IS NULL AND c.nr_seq_cta_pendencia               IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- Perda e Ganho 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		36671 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'LGP' ie_processo_assinado 
	FROM atendimento_perda_ganho f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_atendimento                  = f.nr_atendimento AND c.nr_seq_perda_ganho                = f.nr_sequencia AND c.nr_seq_perda_ganho                IS NOT NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_anamnese                 IS NULL AND c.nr_seq_cta_pendencia               IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- Anamnese 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		25172 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'' ie_processo_assinado 
	FROM anamnese_paciente f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_atendimento                  = f.nr_atendimento AND c.nr_seq_anamnese                  = f.nr_sequencia AND c.nr_seq_anamnese                 IS NOT NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.nr_seq_cta_pendencia               IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- Sinais Vitais 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		184 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'SV' ie_processo_assinado 
	FROM atendimento_sinal_vital f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_atendimento                  = f.nr_atendimento AND c.nr_seq_sinal_vital                = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_cta_pendencia               IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- SAE 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		25290 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'' ie_processo_assinado 
	FROM pe_prescricao f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_atendimento                  = f.nr_atendimento AND c.nr_seq_sae                    = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.nr_seq_cta_pendencia               IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NOT NULL AND c.nr_seq_sinal_vital                IS NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- CID Doencas 
	SELECT f.nr_seq_interno nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		NULL nr_projeto, 
		'nr_seq_interno' ds_tipo_fk, 
		'' ie_processo_assinado 
	FROM diagnostico_doenca f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_atendimento                  = f.nr_atendimento AND c.nr_seq_diag_doenca                = f.nr_seq_interno AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.nr_seq_cta_pendencia               IS NULL AND c.nr_seq_diag_doenca                IS NOT NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- Registro EHR 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		25187 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'T' ie_processo_assinado 
	FROM ehr_registro f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_atendimento                  = f.nr_atendimento AND c.nr_seq_ehr_reg                  = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.nr_seq_cta_pendencia               IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NOT NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- Loco Regional 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		NULL nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'' ie_processo_assinado 
	FROM can_loco_regional f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_atendimento                  = f.nr_atendimento AND c.nr_seq_loco_reg                  = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.nr_seq_cta_pendencia               IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NOT NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- Pendencia Conta 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		NULL dt_liberacao, 
		NULL dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		NULL nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'' ie_processo_assinado 
	FROM cta_pendencia f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica           = c.cd_pessoa_fisica AND c.nr_atendimento            = f.nr_atendimento AND c.nr_seq_cta_pendencia         = f.nr_sequencia AND c.nr_seq_anamnese           IS NULL AND c.nr_parecer             IS NULL AND c.nr_seq_perda_ganho         IS NULL AND c.nr_seq_cta_pendencia        IS NOT NULL AND c.nr_seq_diag_doenca         IS NULL AND c.nr_seq_ehr_reg           IS NULL AND c.nr_seq_loco_reg           IS NULL AND c.cd_evolucao             IS NULL AND c.nr_seq_sae             IS NULL AND c.nr_seq_sinal_vital         IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N') = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')    = 'F' 
	 
UNION
 --evolucao 
	SELECT f.cd_evolucao nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		183 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'EP' ie_processo_assinado 
	FROM evolucao_paciente f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.cd_evolucao                    = f.cd_evolucao AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NOT NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- posicao 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		50332 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'PLP' ie_processo_assinado 
	FROM posicao_cirurgia f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_posicao                  = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- pele 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		50334 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'PLPE' ie_processo_assinado 
	FROM pepo_pele f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_pele                    = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- curativo 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		50338 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'PLC' ie_processo_assinado 
	FROM pepo_curativo f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_curativo                  = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NULL AND c.nr_seq_curativo                 IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- incisao 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		50336 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'PLI' ie_processo_assinado 
	FROM incisao_cirurgia f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_incisao                  = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NULL AND c.nr_seq_curativo                 IS NULL AND c.nr_seq_incisao                  IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- aldrete 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		50658 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'LEA' ie_processo_assinado 
	FROM escala_aldrete f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_aldrete                  = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NULL AND c.nr_seq_curativo                 IS NULL AND c.nr_seq_incisao                  IS NULL AND c.nr_seq_aldrete                  IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- conjunto 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		50952 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'LCJ' ie_processo_assinado 
	FROM cm_conjunto_cont f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_conjunto                  = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NULL AND c.nr_seq_curativo                 IS NULL AND c.nr_seq_incisao                  IS NULL AND c.nr_seq_aldrete                  IS NULL AND c.nr_seq_conjunto                 IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- avaliacao 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		50672 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'LAV' ie_processo_assinado 
	FROM med_avaliacao_paciente f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_avaliacao                 = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NULL AND c.nr_seq_curativo                 IS NULL AND c.nr_seq_incisao                  IS NULL AND c.nr_seq_aldrete                  IS NULL AND c.nr_seq_conjunto                 IS NULL AND c.nr_seq_avaliacao                 IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- agentes anestesicos 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		51092 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'PLA' ie_processo_assinado 
	FROM cirurgia_agente_anestesico f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_cirur_agente                = f.nr_sequencia AND f.ie_tipo                      = 1 AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NULL AND c.nr_seq_curativo                 IS NULL AND c.nr_seq_incisao                  IS NULL AND c.nr_seq_aldrete                  IS NULL AND c.nr_seq_conjunto                 IS NULL AND c.nr_seq_avaliacao                 IS NULL AND c.nr_seq_cirur_agente               IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- Terapia hidroeletrolítica 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		51097 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'PLT' ie_processo_assinado 
	FROM cirurgia_agente_anestesico f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_cirur_agente                = f.nr_sequencia AND f.ie_tipo                      = 2 AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NULL AND c.nr_seq_curativo                 IS NULL AND c.nr_seq_incisao                  IS NULL AND c.nr_seq_aldrete                  IS NULL AND c.nr_seq_conjunto                 IS NULL AND c.nr_seq_avaliacao                 IS NULL AND c.nr_seq_cirur_agente               IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- Medicamentos 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		51095 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'PLM' ie_processo_assinado 
	FROM cirurgia_agente_anestesico f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_cirur_agente                = f.nr_sequencia AND f.ie_tipo                      = 3 AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NULL AND c.nr_seq_curativo                 IS NULL AND c.nr_seq_incisao                  IS NULL AND c.nr_seq_aldrete                  IS NULL AND c.nr_seq_conjunto                 IS NULL AND c.nr_seq_avaliacao                 IS NULL AND c.nr_seq_cirur_agente               IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- Materiais 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		51099 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'PLMT' ie_processo_assinado 
	FROM cirurgia_agente_anestesico f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_cirur_agente                = f.nr_sequencia AND f.ie_tipo                      = 4 AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NULL AND c.nr_seq_curativo                 IS NULL AND c.nr_seq_incisao                  IS NULL AND c.nr_seq_aldrete                  IS NULL AND c.nr_seq_conjunto                 IS NULL AND c.nr_seq_avaliacao                 IS NULL AND c.nr_seq_cirur_agente               IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- Hemoderivados 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		51101 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'PLH' ie_processo_assinado 
	FROM cirurgia_agente_anestesico f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_cirur_agente                = f.nr_sequencia AND f.ie_tipo                      = 5 AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NULL AND c.nr_seq_curativo                 IS NULL AND c.nr_seq_incisao                  IS NULL AND c.nr_seq_aldrete                  IS NULL AND c.nr_seq_conjunto                 IS NULL AND c.nr_seq_avaliacao                 IS NULL AND c.nr_seq_cirur_agente               IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- Tecnica Anestesica 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		44466 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'LTA' ie_processo_assinado 
	FROM cirurgia_tec_anestesica f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_tecnica_anest               = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NULL AND c.nr_seq_curativo                 IS NULL AND c.nr_seq_incisao                  IS NULL AND c.nr_seq_aldrete                  IS NULL AND c.nr_seq_conjunto                 IS NULL AND c.nr_seq_avaliacao                 IS NULL AND c.nr_seq_cirur_agente               IS NULL AND c.nr_seq_tecnica_anest               IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- Descricao Anestesica 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		44469 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'LDA' ie_processo_assinado 
	FROM anestesia_descricao f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_desc_anest                 = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NULL AND c.nr_seq_curativo                 IS NULL AND c.nr_seq_incisao                  IS NULL AND c.nr_seq_aldrete                  IS NULL AND c.nr_seq_conjunto                 IS NULL AND c.nr_seq_avaliacao                 IS NULL AND c.nr_seq_cirur_agente               IS NULL AND c.nr_seq_tecnica_anest               IS NULL AND c.nr_seq_desc_anest                IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- SV Monit Analgesia 
	SELECT f.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		25183 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'SVMA' ie_processo_assinado 
	FROM atend_aval_analgesia f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_atendimento                  = f.nr_atendimento AND c.nr_seq_atend_aval_analgesia            = f.nr_sequencia AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_cta_pendencia               IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_atend_aval_analgesia           IS NOT NULL AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 
	SELECT f.nr_sequencia, 
		'Escala Steward' ds_item, 
		coalesce(b.nr_seq_apresentacao,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		f.dt_liberacao dt_liberacao, 
		obter_data_assinatura_digital(f.nr_seq_assinatura) dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		50653 nr_projeto, 
		'nr_sequencia' ds_tipo_fk, 
		'LES' ie_processo_assinado 
	FROM escala_stewart f, pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica                 = c.cd_pessoa_fisica AND c.nr_seq_anamnese                 IS NULL AND c.nr_parecer                    IS NULL AND c.nr_seq_perda_ganho                IS NULL AND c.cd_evolucao                   IS NULL AND c.nr_seq_diag_doenca                IS NULL AND c.nr_seq_ehr_reg                  IS NULL AND c.nr_seq_loco_reg                 IS NULL AND c.nr_seq_sae                    IS NULL AND c.nr_seq_sinal_vital                IS NULL AND c.nr_seq_posicao                  IS NULL AND c.nr_seq_pele                   IS NULL AND c.nr_seq_curativo                 IS NULL AND c.nr_seq_incisao                  IS NULL AND c.nr_seq_aldrete                  IS NULL AND c.nr_seq_conjunto                 IS NULL AND c.nr_seq_avaliacao                 IS NULL AND c.nr_seq_cirur_agente               IS NULL AND c.nr_seq_tecnica_anest               IS NULL AND c.nr_seq_desc_anest                IS NULL AND c.nr_seq_escala                   = f.nr_sequencia AND c.nr_seq_escala                  IS NOT NULL AND ie_escala                      = '71' AND f.dt_liberacao                   IS NOT NULL AND obter_data_assinatura_digital(f.nr_seq_assinatura) IS NULL AND coalesce(c.ie_pendente_assinat_usuario,'N')       = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')          = 'F' 
	 
UNION
 -- Outras pendencias 
	SELECT c.nr_sequencia, 
		coalesce(b.ds_item_instituicao,a.ds_item_instituicao,obter_desc_expressao(a.cd_exp_desc_item,a.ds_item),c.ds_item) ds_item, 
		coalesce(b.NR_SEQ_APRESENTACAO,99999) nr_seq_apres, 
		c.nm_usuario, 
		c.nr_atendimento, 
		b.cd_perfil, 
		NULL dt_liberacao, 
		NULL dt_assinatura, 
		d.cd_pessoa_fisica, 
		coalesce(b.nr_seq_item_pepo, a.nr_sequencia) nr_item, 
		NULL, 
		'nr_sequencia' ds_tipo_fk, 
		'' ie_processo_assinado 
	FROM pessoa_fisica d, pep_item_pendente c
LEFT OUTER JOIN pepo_item a ON (c.nr_seq_item_pepo = a.nr_sequencia)
LEFT OUTER JOIN atendimento_paciente e ON (c.nr_atendimento = e.nr_atendimento)
LEFT OUTER JOIN perfil_item_pepo b ON (a.nr_sequencia = b.nr_seq_item_pepo)
WHERE d.cd_pessoa_fisica           = c.cd_pessoa_fisica AND c.nr_seq_anamnese           IS NULL AND c.nr_parecer             IS NULL AND c.nr_seq_perda_ganho         IS NULL AND c.nr_seq_cta_pendencia        IS NULL AND c.nr_seq_diag_doenca         IS NULL AND c.nr_seq_ehr_reg           IS NULL AND c.nr_seq_loco_reg           IS NULL AND c.nr_seq_sae             IS NULL AND c.cd_evolucao             IS NULL AND c.nr_seq_sinal_vital         IS NULL AND c.nr_seq_posicao           IS NULL AND c.nr_seq_pele             IS NULL AND c.nr_seq_curativo           IS NULL AND c.nr_seq_incisao           IS NULL AND c.nr_seq_aldrete           IS NULL AND c.nr_seq_conjunto           IS NULL AND c.nr_seq_avaliacao          IS NULL AND c.nr_seq_cirur_agente         IS NULL AND c.nr_seq_tecnica_anest        IS NULL AND c.nr_seq_desc_anest          IS NULL AND c.nr_seq_anamnese           IS NULL AND c.nr_seq_atend_aval_analgesia     IS NULL AND c.nr_prescricao            IS NULL AND ie_escala               <> '71' AND coalesce(c.ie_pendente_assinat_usuario,'N') = 'N' AND coalesce(c.IE_GERADO_FUNCAO_PEPO,'N')    = 'F' ORDER BY nr_seq_apres, 
		ds_item;

