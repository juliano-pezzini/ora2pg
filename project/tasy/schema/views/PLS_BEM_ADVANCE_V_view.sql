-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_bem_advance_v (tp_registro, nr_seq_lote, ds_branco, cd_usuario_plano, cd_plano, ds_descricao_plano, dt_inclusao_plano, ie_titularidade, nm_beneficiario, dt_nascimento, ie_sexo, nr_rg, nr_cpf, nm_municipio, sg_uf, ie_tipo_pessoa, dt_exclusao, ds_grupo_1, ds_grupo_2, ds_grupo_3, ds_grupo_4, ds_grupo_5, ds_grupo_6, ds_pessoa_juridica, nm_empresa, ds_endereco, nr_endereco, ds_complemento, ds_bairro, cd_cep, nr_fone_1, nr_fone_2, nr_fone_3, cd_matricula_ant, cd_motivo_baixa, cd_convenio, ie_tipo_movimento, nr_seq_arquivo, ds_observacao) AS select	1							tp_registro,
	f.nr_sequencia						nr_seq_lote,
	' '							ds_branco,
	coalesce(c.cd_usuario_plano_benef, c.cd_usuario_plano)	cd_usuario_plano,
	c.cd_plano						cd_plano,
	substr(pls_obter_dados_vinc_sca(c.nr_seq_vinculo_sca,'N'),1,255) ds_descricao_plano,
	c.dt_repasse						dt_inclusao_plano,
	CASE WHEN c.cd_dependencia='0' THEN 'T'  ELSE 'D' END 			ie_titularidade,
	c.nm_beneficiario					nm_beneficiario,
	c.dt_nascimento						dt_nascimento,
	c.ie_sexo						ie_sexo,
	c.nr_rg							nr_rg,
	c.cd_cgc_cpf						nr_cpf,
	a.nm_municipio						nm_municipio,
	a.sg_uf							sg_uf,
	CASE WHEN d.ie_tipo_pessoa=1 THEN 1 WHEN d.ie_tipo_pessoa=2 THEN 0 END 			ie_tipo_pessoa,
	c.dt_exclusao						dt_exclusao,
	' '							ds_grupo_1,
	' '							ds_grupo_2,
	' '							ds_grupo_3,
	' '							ds_grupo_4,
	' '							ds_grupo_5,
	' '							ds_grupo_6,
	' '							ds_pessoa_juridica,
	CASE WHEN d.ie_tipo_pessoa=1 THEN d.ds_razao_social WHEN d.ie_tipo_pessoa=2 THEN '' END 	nm_empresa,
	a.ds_endereco						ds_endereco,
	a.nr_endereco						nr_endereco,
	a.ds_complemento					ds_complemento,
	a.ds_bairro						ds_bairro,
	a.cd_cep						cd_cep,
	a.nr_fone						nr_fone_1,
	' '							nr_fone_2,
	' '							nr_fone_3,
	' '							cd_matricula_ant,
	' '							cd_motivo_baixa,
	' '							cd_convenio,
	c.ie_tipo_movimento					ie_tipo_movimento,
	1							nr_seq_arquivo,
	' '							ds_observacao
FROM	ptu_movimento_benef_compl	a,
	ptu_mov_produto_benef		c,
	ptu_mov_produto_empresa		d,
	ptu_movimentacao_produto	e,
	ptu_mov_produto_lote		f
where	a.nr_seq_beneficiario	= c.nr_sequencia
and	c.nr_seq_empresa	= d.nr_sequencia
and	d.nr_seq_mov_produto	= e.nr_sequencia
and	e.nr_seq_lote		= f.nr_sequencia
order by nm_beneficiario;

