-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_recurso_humano_ind_v (nr_sequencia, dt_atualizacao, nm_usuario, dt_atualizacao_nrec, nm_usuario_nrec, qt_empregado, ie_tipo_colaborador, cd_funcionario, nm_empresa, dt_referencia, nm_funcionario, cd_centro_custo, nm_centro_custo, ie_admitido, ie_demitido, ds_causa_demissao, ie_trabalhando, ie_ferias, ie_licensa_maternidade, ie_acidente_trabalho, ie_auxilio_doenca, ie_reajuste, vl_reajuste, ds_motivo_reajuste, vl_ferias, qt_hora_extra, vl_hora_extra, qt_hora_justificada, vl_hora_justificada, qt_hora_acidente_trab, vl_hora_acidente_trab, qt_hora_injustificada, vl_hora_injustificada, qt_hora_maternidade, vl_hora_maternidade, qt_hora_paternidade, vl_hora_paternidade, qt_hora_serv_militar, vl_hora_serv_militar, qt_hora_aux_doenca, vl_hora_aux_doenca, vl_salario_bruto, vl_salario_liquido, ds_tipo_contrato, qt_hora_trabalhada, cd_funcao, ds_funcao, ie_afastado, ie_aposentado_invalid, qt_admitido, qt_demitido, qt_colaborador, qt_ferias_mes, qt_trabalhando, qt_afastado, qt_licenca_maternidade, qt_acidente_trabalho, qt_auxilio_doenca, qt_aposentado_invalid) AS select	a.NR_SEQUENCIA,a.DT_ATUALIZACAO,a.NM_USUARIO,a.DT_ATUALIZACAO_NREC,a.NM_USUARIO_NREC,a.QT_EMPREGADO,a.IE_TIPO_COLABORADOR,a.CD_FUNCIONARIO,a.NM_EMPRESA,a.DT_REFERENCIA,a.NM_FUNCIONARIO,a.CD_CENTRO_CUSTO,a.NM_CENTRO_CUSTO,a.IE_ADMITIDO,a.IE_DEMITIDO,a.DS_CAUSA_DEMISSAO,a.IE_TRABALHANDO,a.IE_FERIAS,a.IE_LICENSA_MATERNIDADE,a.IE_ACIDENTE_TRABALHO,a.IE_AUXILIO_DOENCA,a.IE_REAJUSTE,a.VL_REAJUSTE,a.DS_MOTIVO_REAJUSTE,a.VL_FERIAS,a.QT_HORA_EXTRA,a.VL_HORA_EXTRA,a.QT_HORA_JUSTIFICADA,a.VL_HORA_JUSTIFICADA,a.QT_HORA_ACIDENTE_TRAB,a.VL_HORA_ACIDENTE_TRAB,a.QT_HORA_INJUSTIFICADA,a.VL_HORA_INJUSTIFICADA,a.QT_HORA_MATERNIDADE,a.VL_HORA_MATERNIDADE,a.QT_HORA_PATERNIDADE,a.VL_HORA_PATERNIDADE,a.QT_HORA_SERV_MILITAR,a.VL_HORA_SERV_MILITAR,a.QT_HORA_AUX_DOENCA,a.VL_HORA_AUX_DOENCA,a.VL_SALARIO_BRUTO,a.VL_SALARIO_LIQUIDO,a.DS_TIPO_CONTRATO,a.QT_HORA_TRABALHADA,a.CD_FUNCAO,a.DS_FUNCAO,a.IE_AFASTADO,a.IE_APOSENTADO_INVALID,
	CASE WHEN ie_admitido=1 THEN 1  ELSE 0 END  qt_admitido,
	CASE WHEN ie_demitido=1 THEN 1  ELSE 0 END  qt_demitido,
	coalesce(CASE WHEN ie_trabalhando=1 THEN 1  ELSE CASE WHEN ie_ferias=1 THEN 1  ELSE CASE WHEN ie_licensa_maternidade=1 THEN 1  ELSE CASE WHEN ie_acidente_trabalho=1 THEN 1  ELSE CASE WHEN ie_auxilio_doenca=1 THEN 1  ELSE CASE WHEN ie_aposentado_invalid=1 THEN 1 END  END  END  END  END  END ,0) qt_colaborador,
	CASE WHEN ie_ferias=1 THEN 1  ELSE 0 END  qt_ferias_mes,
	CASE WHEN ie_trabalhando=1 THEN 1  ELSE 0 END  qt_trabalhando,
	CASE WHEN ie_afastado=1 THEN 1  ELSE 0 END  qt_afastado,
	CASE WHEN ie_licensa_maternidade=1 THEN 1  ELSE 0 END  qt_licenca_maternidade,
	CASE WHEN ie_acidente_trabalho=1 THEN 1  ELSE 0 END  qt_acidente_trabalho,
	CASE WHEN ie_auxilio_doenca=1 THEN 1  ELSE 0 END  qt_auxilio_doenca,
	CASE WHEN ie_aposentado_invalid=1 THEN 1  ELSE 0 END  qt_aposentado_invalid
FROM	eis_recurso_humano a;

