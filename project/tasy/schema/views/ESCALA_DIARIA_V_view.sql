-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW escala_diaria_v (ds_periodo, ds_cargo, nm_profissional, dia1, dia2, dia3, dia4, dia5, dia6, dia7, dia8, dia9, dia10, dia11, dia12, dia13, dia14, dia15, dia16, dia17, dia18, dia19, dia20, dia21, dia22, dia23, dia24, dia25, dia26, dia27, dia28, dia29, dia30, dia31, dt_inicio, dt_fim, nr_seq_escala, nr_seq_grupo, nr_seq_classif, nr_sequencia, cd_pessoa_fisica, nm_usuario, mes, ano, ds_hora, qt_dia) AS select 	distinct
		to_char(d.dt_inicio,'hh24:mi')||'/'||to_char(d.dt_fim,'hh24:mi') ds_periodo, 
		substr(obter_dados_pf(d.cd_pessoa_fisica, 'CR'),1,150) ds_cargo, 
		substr(obter_nome_pf(d.cd_pessoa_fisica),1,100) nm_profissional, 
		substr(obter_se_prof_escala_plantao('01',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia1, 
		substr(obter_se_prof_escala_plantao('02',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia2, 
		substr(obter_se_prof_escala_plantao('03',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia3, 
		substr(obter_se_prof_escala_plantao('04',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia4, 
		substr(obter_se_prof_escala_plantao('05',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia5, 
		substr(obter_se_prof_escala_plantao('06',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia6, 
		substr(obter_se_prof_escala_plantao('07',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia7, 
		substr(obter_se_prof_escala_plantao('08',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia8, 
		substr(obter_se_prof_escala_plantao('09',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia9, 
		substr(obter_se_prof_escala_plantao('10',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia10, 
		substr(obter_se_prof_escala_plantao('11',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia11, 
		substr(obter_se_prof_escala_plantao('12',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia12, 
		substr(obter_se_prof_escala_plantao('13',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia13, 
		substr(obter_se_prof_escala_plantao('14',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia14, 
		substr(obter_se_prof_escala_plantao('15',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia15, 
		substr(obter_se_prof_escala_plantao('16',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia16, 
		substr(obter_se_prof_escala_plantao('17',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia17, 
		substr(obter_se_prof_escala_plantao('18',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia18, 
		substr(obter_se_prof_escala_plantao('19',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia19, 
		substr(obter_se_prof_escala_plantao('20',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia20, 
		substr(obter_se_prof_escala_plantao('21',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia21, 
		substr(obter_se_prof_escala_plantao('22',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia22, 
		substr(obter_se_prof_escala_plantao('23',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia23, 
		substr(obter_se_prof_escala_plantao('24',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia24, 
		substr(obter_se_prof_escala_plantao('25',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia25, 
		substr(obter_se_prof_escala_plantao('26',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia26, 
		substr(obter_se_prof_escala_plantao('27',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia27, 
		substr(obter_se_prof_escala_plantao('28',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia28, 
		substr(obter_se_prof_escala_plantao('29',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia29, 
		substr(obter_se_prof_escala_plantao('30',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia30, 
		substr(obter_se_prof_escala_plantao('31',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia31, 
		to_char(d.dt_inicio,'mm') dt_inicio, 
		to_char(d.dt_fim,'yyyy') dt_fim, 
		e.nr_sequencia nr_seq_escala, 
		g.nr_sequencia nr_seq_grupo, 
		c.nr_sequencia nr_seq_classif, 
  d.nr_seq_escala nr_sequencia, 
  d.cd_pessoa_fisica, 
  d.nm_usuario, 
  to_char(d.dt_inicio, 'mm') mes, 
  to_char(d.dt_inicio, 'yyyy') ano, 
  to_char(d.dt_inicio, 'hh24:mi') ds_hora, 
		31 qt_dia 
FROM	escala_diaria d, 
		escala_grupo g, 
		escala_classif c, 
		escala e 
where 	c.nr_sequencia = g.nr_seq_classif 
and 	g.nr_sequencia = e.nr_seq_grupo 
and		e.nr_sequencia = d.nr_seq_escala 
and 	d.cd_pessoa_fisica is not null 
and 	coalesce(obter_tipo_classif_escala(e.nr_sequencia),'P') = 'P' 
and		(obter_qt_dias_mes(to_date('01/'||to_char(d.dt_inicio,'mm')||'/'||to_char(d.dt_fim,'yyyy'),'dd/mm/yyyy')))::numeric  = 31 

union all
 
select 	distinct 
		to_char(d.dt_inicio,'hh24:mi')||'/'||to_char(d.dt_fim,'hh24:mi') ds_periodo, 
		substr(obter_dados_pf(f.cd_pessoa_fisica, 'CR'),1,150) ds_cargo, 
		substr(obter_nome_pf(f.cd_pessoa_fisica),1,100) nm_profissional, 
		substr(obter_se_prof_escala_plantao('01',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia1, 
		substr(obter_se_prof_escala_plantao('02',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia2, 
		substr(obter_se_prof_escala_plantao('03',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia3, 
		substr(obter_se_prof_escala_plantao('04',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia4, 
		substr(obter_se_prof_escala_plantao('05',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia5, 
		substr(obter_se_prof_escala_plantao('06',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia6, 
		substr(obter_se_prof_escala_plantao('07',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia7, 
		substr(obter_se_prof_escala_plantao('08',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia8, 
		substr(obter_se_prof_escala_plantao('09',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia9, 
		substr(obter_se_prof_escala_plantao('10',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia10, 
		substr(obter_se_prof_escala_plantao('11',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia11, 
		substr(obter_se_prof_escala_plantao('12',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia12, 
		substr(obter_se_prof_escala_plantao('13',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia13, 
		substr(obter_se_prof_escala_plantao('14',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia14, 
		substr(obter_se_prof_escala_plantao('15',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia15, 
		substr(obter_se_prof_escala_plantao('16',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia16, 
		substr(obter_se_prof_escala_plantao('17',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia17, 
		substr(obter_se_prof_escala_plantao('18',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia18, 
		substr(obter_se_prof_escala_plantao('19',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia19, 
		substr(obter_se_prof_escala_plantao('20',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia20, 
		substr(obter_se_prof_escala_plantao('21',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia21, 
		substr(obter_se_prof_escala_plantao('22',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia22, 
		substr(obter_se_prof_escala_plantao('23',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia23, 
		substr(obter_se_prof_escala_plantao('24',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia24, 
		substr(obter_se_prof_escala_plantao('25',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia25, 
		substr(obter_se_prof_escala_plantao('26',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia26, 
		substr(obter_se_prof_escala_plantao('27',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia27, 
		substr(obter_se_prof_escala_plantao('28',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia28, 
		substr(obter_se_prof_escala_plantao('29',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia29, 
		substr(obter_se_prof_escala_plantao('30',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia30, 
		substr(obter_se_prof_escala_plantao('31',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia31, 
		to_char(d.dt_inicio,'mm') dt_inicio, 
		to_char(d.dt_fim,'yyyy') dt_fim, 
		e.nr_sequencia nr_seq_escala, 
		g.nr_sequencia nr_seq_grupo, 
		c.nr_sequencia nr_seq_classif, 
  d.nr_seq_escala nr_sequencia, 
  d.cd_pessoa_fisica, 
  d.nm_usuario, 
  to_char(d.dt_inicio, 'mm') mes, 
  to_char(d.dt_inicio, 'yyyy') ano, 
  to_char(d.dt_inicio, 'hh24:mi') ds_hora, 
		31 qt_dia 
from	escala_diaria d, 
		escala_grupo g, 
		escala_classif c, 
		escala e, 
		ESCALA_DIARIA_ADIC f 
where 	c.nr_sequencia = g.nr_seq_classif 
and		f.nr_seq_escala_diaria = d.nr_sequencia 
and 	g.nr_sequencia = e.nr_seq_grupo 
and		e.nr_sequencia = d.nr_seq_escala 
and 	d.cd_pessoa_fisica is not null 
and 	coalesce(obter_tipo_classif_escala(e.nr_sequencia),'P') = 'P' 
and		(obter_qt_dias_mes(to_date('01/'||to_char(d.dt_inicio,'mm')||'/'||to_char(d.dt_fim,'yyyy'),'dd/mm/yyyy')))::numeric  = 31 
--alterado 
union
 
select 	distinct 
		to_char(d.dt_inicio,'hh24:mi')||'/'||to_char(d.dt_fim,'hh24:mi') ds_periodo, 
		substr(obter_dados_pf(d.cd_pessoa_fisica, 'CR'),1,150) ds_cargo, 
		substr(obter_nome_pf(d.cd_pessoa_fisica),1,100) nm_profissional, 
		substr(obter_se_prof_escala_plantao('01',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia1, 
		substr(obter_se_prof_escala_plantao('02',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia2, 
		substr(obter_se_prof_escala_plantao('03',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia3, 
		substr(obter_se_prof_escala_plantao('04',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia4, 
		substr(obter_se_prof_escala_plantao('05',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia5, 
		substr(obter_se_prof_escala_plantao('06',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia6, 
		substr(obter_se_prof_escala_plantao('07',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia7, 
		substr(obter_se_prof_escala_plantao('08',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia8, 
		substr(obter_se_prof_escala_plantao('09',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia9, 
		substr(obter_se_prof_escala_plantao('10',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia10, 
		substr(obter_se_prof_escala_plantao('11',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia11, 
		substr(obter_se_prof_escala_plantao('12',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia12, 
		substr(obter_se_prof_escala_plantao('13',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia13, 
		substr(obter_se_prof_escala_plantao('14',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia14, 
		substr(obter_se_prof_escala_plantao('15',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia15, 
		substr(obter_se_prof_escala_plantao('16',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia16, 
		substr(obter_se_prof_escala_plantao('17',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia17, 
		substr(obter_se_prof_escala_plantao('18',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia18, 
		substr(obter_se_prof_escala_plantao('19',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia19, 
		substr(obter_se_prof_escala_plantao('20',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia20, 
		substr(obter_se_prof_escala_plantao('21',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia21, 
		substr(obter_se_prof_escala_plantao('22',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia22, 
		substr(obter_se_prof_escala_plantao('23',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia23, 
		substr(obter_se_prof_escala_plantao('24',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia24, 
		substr(obter_se_prof_escala_plantao('25',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia25, 
		substr(obter_se_prof_escala_plantao('26',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia26, 
		substr(obter_se_prof_escala_plantao('27',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia27, 
		substr(obter_se_prof_escala_plantao('28',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia28, 
		substr(obter_se_prof_escala_plantao('29',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia29, 
		substr(obter_se_prof_escala_plantao('30',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia30, 
		'' dia31, 
		to_char(d.dt_inicio,'mm') dt_inicio, 
		to_char(d.dt_fim,'yyyy') dt_fim, 
		e.nr_sequencia nr_seq_escala, 
			g.nr_sequencia nr_seq_grupo, 
		c.nr_sequencia nr_seq_classif, 
  d.nr_seq_escala nr_sequencia, 
  d.cd_pessoa_fisica, 
  d.nm_usuario, 
  to_char(d.dt_inicio, 'mm') mes, 
  to_char(d.dt_inicio, 'yyyy') ano, 
  to_char(d.dt_inicio, 'hh24:mi') ds_hora, 
		30 qt_dia 
from	escala_diaria d, 
		escala_grupo g, 
		escala_classif c, 
		escala e 
where 	c.nr_sequencia = g.nr_seq_classif 
and 	g.nr_sequencia = e.nr_seq_grupo 
and		e.nr_sequencia = d.nr_seq_escala 
and 	d.cd_pessoa_fisica is not null 
and 	coalesce(obter_tipo_classif_escala(e.nr_sequencia),'P') = 'P' 
and		(obter_qt_dias_mes(to_date('01/'||to_char(d.dt_inicio,'mm')||'/'||to_char(d.dt_fim,'yyyy'),'dd/mm/yyyy')))::numeric  = 30 

union all
 
select 	distinct 
		to_char(d.dt_inicio,'hh24:mi')||'/'||to_char(d.dt_fim,'hh24:mi') ds_periodo, 
		substr(obter_dados_pf(f.cd_pessoa_fisica, 'CR'),1,150) ds_cargo, 
		substr(obter_nome_pf(f.cd_pessoa_fisica),1,100) nm_profissional, 
		substr(obter_se_prof_escala_plantao('01',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia1, 
		substr(obter_se_prof_escala_plantao('02',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia2, 
		substr(obter_se_prof_escala_plantao('03',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia3, 
		substr(obter_se_prof_escala_plantao('04',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia4, 
		substr(obter_se_prof_escala_plantao('05',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia5, 
		substr(obter_se_prof_escala_plantao('06',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia6, 
		substr(obter_se_prof_escala_plantao('07',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia7, 
		substr(obter_se_prof_escala_plantao('08',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia8, 
		substr(obter_se_prof_escala_plantao('09',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia9, 
		substr(obter_se_prof_escala_plantao('10',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia10, 
		substr(obter_se_prof_escala_plantao('11',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia11, 
		substr(obter_se_prof_escala_plantao('12',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia12, 
		substr(obter_se_prof_escala_plantao('13',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia13, 
		substr(obter_se_prof_escala_plantao('14',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia14, 
		substr(obter_se_prof_escala_plantao('15',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia15, 
		substr(obter_se_prof_escala_plantao('16',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia16, 
		substr(obter_se_prof_escala_plantao('17',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia17, 
		substr(obter_se_prof_escala_plantao('18',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia18, 
		substr(obter_se_prof_escala_plantao('19',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia19, 
		substr(obter_se_prof_escala_plantao('20',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia20, 
		substr(obter_se_prof_escala_plantao('21',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia21, 
		substr(obter_se_prof_escala_plantao('22',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia22, 
		substr(obter_se_prof_escala_plantao('23',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia23, 
		substr(obter_se_prof_escala_plantao('24',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia24, 
		substr(obter_se_prof_escala_plantao('25',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia25, 
		substr(obter_se_prof_escala_plantao('26',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia26, 
		substr(obter_se_prof_escala_plantao('27',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia27, 
		substr(obter_se_prof_escala_plantao('28',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia28, 
		substr(obter_se_prof_escala_plantao('29',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia29, 
		substr(obter_se_prof_escala_plantao('30',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia30, 
		'' dia31, 
		to_char(d.dt_inicio,'mm') dt_inicio, 
		to_char(d.dt_fim,'yyyy') dt_fim, 
		e.nr_sequencia nr_seq_escala, 
		g.nr_sequencia nr_seq_grupo, 
		c.nr_sequencia nr_seq_classif, 
  d.nr_seq_escala nr_sequencia, 
  d.cd_pessoa_fisica, 
  d.nm_usuario, 
  to_char(d.dt_inicio, 'mm') mes, 
  to_char(d.dt_inicio, 'yyyy') ano, 
  to_char(d.dt_inicio, 'hh24:mi') ds_hora, 
		30 qt_dia 
from	escala_diaria d, 
		escala_grupo g, 
		escala_classif c, 
		escala e, 
		ESCALA_DIARIA_ADIC f 
where 	c.nr_sequencia = g.nr_seq_classif 
and		f.nr_seq_escala_diaria = d.nr_sequencia 
and 	g.nr_sequencia = e.nr_seq_grupo 
and		e.nr_sequencia = d.nr_seq_escala 
and 	d.cd_pessoa_fisica is not null 
and 	coalesce(obter_tipo_classif_escala(e.nr_sequencia),'P') = 'P' 
and		(obter_qt_dias_mes(to_date('01/'||to_char(d.dt_inicio,'mm')||'/'||to_char(d.dt_fim,'yyyy'),'dd/mm/yyyy')))::numeric  = 30 

union
 
select 	distinct 
		to_char(d.dt_inicio,'hh24:mi')||'/'||to_char(d.dt_fim,'hh24:mi') ds_periodo, 
		substr(obter_dados_pf(d.cd_pessoa_fisica, 'CR'),1,150) ds_cargo, 
		substr(obter_nome_pf(d.cd_pessoa_fisica),1,100) nm_profissional, 
		substr(obter_se_prof_escala_plantao('01',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia1, 
		substr(obter_se_prof_escala_plantao('02',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia2, 
		substr(obter_se_prof_escala_plantao('03',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia3, 
		substr(obter_se_prof_escala_plantao('04',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia4, 
		substr(obter_se_prof_escala_plantao('05',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia5, 
		substr(obter_se_prof_escala_plantao('06',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia6, 
		substr(obter_se_prof_escala_plantao('07',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia7, 
		substr(obter_se_prof_escala_plantao('08',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia8, 
		substr(obter_se_prof_escala_plantao('09',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia9, 
		substr(obter_se_prof_escala_plantao('10',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia10, 
		substr(obter_se_prof_escala_plantao('11',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia11, 
		substr(obter_se_prof_escala_plantao('12',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia12, 
		substr(obter_se_prof_escala_plantao('13',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia13, 
		substr(obter_se_prof_escala_plantao('14',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia14, 
		substr(obter_se_prof_escala_plantao('15',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia15, 
		substr(obter_se_prof_escala_plantao('16',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia16, 
		substr(obter_se_prof_escala_plantao('17',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia17, 
		substr(obter_se_prof_escala_plantao('18',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia18, 
		substr(obter_se_prof_escala_plantao('19',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia19, 
		substr(obter_se_prof_escala_plantao('20',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia20, 
		substr(obter_se_prof_escala_plantao('21',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia21, 
		substr(obter_se_prof_escala_plantao('22',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia22, 
		substr(obter_se_prof_escala_plantao('23',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia23, 
		substr(obter_se_prof_escala_plantao('24',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia24, 
		substr(obter_se_prof_escala_plantao('25',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia25, 
		substr(obter_se_prof_escala_plantao('26',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia26, 
		substr(obter_se_prof_escala_plantao('27',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia27, 
		substr(obter_se_prof_escala_plantao('28',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia28, 
		substr(obter_se_prof_escala_plantao('29',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia29, 
		'' dia30, 
		'' dia31, 
		to_char(d.dt_inicio,'mm') dt_inicio, 
		to_char(d.dt_fim,'yyyy') dt_fim, 
		e.nr_sequencia nr_seq_escala, 
		g.nr_sequencia nr_seq_grupo, 
		c.nr_sequencia nr_seq_classif, 
  d.nr_seq_escala nr_sequencia, 
  d.cd_pessoa_fisica, 
  d.nm_usuario, 
  to_char(d.dt_inicio, 'mm') mes, 
  to_char(d.dt_inicio, 'yyyy') ano, 
  to_char(d.dt_inicio, 'hh24:mi') ds_hora, 
		29 qt_dia 
from	escala_diaria d, 
		escala_grupo g, 
		escala_classif c, 
		escala e 
where 	c.nr_sequencia = g.nr_seq_classif 
and 	g.nr_sequencia = e.nr_seq_grupo 
and		e.nr_sequencia = d.nr_seq_escala 
and 	d.cd_pessoa_fisica is not null 
and 	coalesce(obter_tipo_classif_escala(e.nr_sequencia),'P') = 'P' 
and		(obter_qt_dias_mes(to_date('01/'||to_char(d.dt_inicio,'mm')||'/'||to_char(d.dt_fim,'yyyy'),'dd/mm/yyyy')))::numeric  = 29 

union all
 
select 	distinct 
		to_char(d.dt_inicio,'hh24:mi')||'/'||to_char(d.dt_fim,'hh24:mi') ds_periodo, 
		substr(obter_dados_pf(f.cd_pessoa_fisica, 'CR'),1,150) ds_cargo, 
		substr(obter_nome_pf(f.cd_pessoa_fisica),1,100) nm_profissional, 
		substr(obter_se_prof_escala_plantao('01',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia1, 
		substr(obter_se_prof_escala_plantao('02',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia2, 
		substr(obter_se_prof_escala_plantao('03',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia3, 
		substr(obter_se_prof_escala_plantao('04',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia4, 
		substr(obter_se_prof_escala_plantao('05',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia5, 
		substr(obter_se_prof_escala_plantao('06',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia6, 
		substr(obter_se_prof_escala_plantao('07',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia7, 
		substr(obter_se_prof_escala_plantao('08',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia8, 
		substr(obter_se_prof_escala_plantao('09',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia9, 
		substr(obter_se_prof_escala_plantao('10',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia10, 
		substr(obter_se_prof_escala_plantao('11',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia11, 
		substr(obter_se_prof_escala_plantao('12',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia12, 
		substr(obter_se_prof_escala_plantao('13',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia13, 
		substr(obter_se_prof_escala_plantao('14',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia14, 
		substr(obter_se_prof_escala_plantao('15',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia15, 
		substr(obter_se_prof_escala_plantao('16',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia16, 
		substr(obter_se_prof_escala_plantao('17',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia17, 
		substr(obter_se_prof_escala_plantao('18',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia18, 
		substr(obter_se_prof_escala_plantao('19',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia19, 
		substr(obter_se_prof_escala_plantao('20',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia20, 
		substr(obter_se_prof_escala_plantao('21',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia21, 
		substr(obter_se_prof_escala_plantao('22',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia22, 
		substr(obter_se_prof_escala_plantao('23',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia23, 
		substr(obter_se_prof_escala_plantao('24',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia24, 
		substr(obter_se_prof_escala_plantao('25',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia25, 
		substr(obter_se_prof_escala_plantao('26',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia26, 
		substr(obter_se_prof_escala_plantao('27',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia27, 
		substr(obter_se_prof_escala_plantao('28',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia28, 
		substr(obter_se_prof_escala_plantao('29',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia29, 
		'' dia30, 
		'' dia31, 
		to_char(d.dt_inicio,'mm') dt_inicio, 
		to_char(d.dt_fim,'yyyy') dt_fim, 
		e.nr_sequencia nr_seq_escala, 
		g.nr_sequencia nr_seq_grupo, 
		c.nr_sequencia nr_seq_classif, 
  d.nr_seq_escala nr_sequencia, 
  d.cd_pessoa_fisica, 
  d.nm_usuario, 
  to_char(d.dt_inicio, 'mm') mes, 
  to_char(d.dt_inicio, 'yyyy') ano, 
  to_char(d.dt_inicio, 'hh24:mi') ds_hora, 
		29 qt_dia 
from	escala_diaria d, 
		escala_grupo g, 
		escala_classif c, 
		escala e, 
		escala_diaria_Adic f 
where 	c.nr_sequencia = g.nr_seq_classif 
and 	g.nr_sequencia = e.nr_seq_grupo 
and		e.nr_sequencia = d.nr_seq_escala 
and		d.nr_sequencia = f.nr_seq_escala_diaria 
and 	d.cd_pessoa_fisica is not null 
and 	coalesce(obter_tipo_classif_escala(e.nr_sequencia),'P') = 'P' 
and		(obter_qt_dias_mes(to_date('01/'||to_char(d.dt_inicio,'mm')||'/'||to_char(d.dt_fim,'yyyy'),'dd/mm/yyyy')))::numeric  = 29 

union
 
select 	distinct 
		to_char(d.dt_inicio,'hh24:mi')||'/'||to_char(d.dt_fim,'hh24:mi') ds_periodo, 
		substr(obter_dados_pf(d.cd_pessoa_fisica, 'CR'),1,150) ds_cargo, 
		substr(obter_nome_pf(d.cd_pessoa_fisica),1,100) nm_profissional, 
		substr(obter_se_prof_escala_plantao('01',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia1, 
		substr(obter_se_prof_escala_plantao('02',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia2, 
		substr(obter_se_prof_escala_plantao('03',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia3, 
		substr(obter_se_prof_escala_plantao('04',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia4, 
		substr(obter_se_prof_escala_plantao('05',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia5, 
		substr(obter_se_prof_escala_plantao('06',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia6, 
		substr(obter_se_prof_escala_plantao('07',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia7, 
		substr(obter_se_prof_escala_plantao('08',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia8, 
		substr(obter_se_prof_escala_plantao('09',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia9, 
		substr(obter_se_prof_escala_plantao('10',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia10, 
		substr(obter_se_prof_escala_plantao('11',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia11, 
		substr(obter_se_prof_escala_plantao('12',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia12, 
		substr(obter_se_prof_escala_plantao('13',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia13, 
		substr(obter_se_prof_escala_plantao('14',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia14, 
		substr(obter_se_prof_escala_plantao('15',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia15, 
		substr(obter_se_prof_escala_plantao('16',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia16, 
		substr(obter_se_prof_escala_plantao('17',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia17, 
		substr(obter_se_prof_escala_plantao('18',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia18, 
		substr(obter_se_prof_escala_plantao('19',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia19, 
		substr(obter_se_prof_escala_plantao('20',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia20, 
		substr(obter_se_prof_escala_plantao('21',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia21, 
		substr(obter_se_prof_escala_plantao('22',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia22, 
		substr(obter_se_prof_escala_plantao('23',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia23, 
		substr(obter_se_prof_escala_plantao('24',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia24, 
		substr(obter_se_prof_escala_plantao('25',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia25, 
		substr(obter_se_prof_escala_plantao('26',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia26, 
		substr(obter_se_prof_escala_plantao('27',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia27, 
		substr(obter_se_prof_escala_plantao('28',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),d.cd_pessoa_fisica,e.nr_sequencia,'N', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia28, 
		'' dia29, 
		'' dia30, 
		'' dia31, 
		to_char(d.dt_inicio,'mm') dt_inicio, 
		to_char(d.dt_fim,'yyyy') dt_fim, 
		e.nr_sequencia nr_seq_escala, 
		g.nr_sequencia nr_seq_grupo, 
		c.nr_sequencia nr_seq_classif, 
  d.nr_seq_escala nr_sequencia, 
  d.cd_pessoa_fisica, 
  d.nm_usuario, 
  to_char(d.dt_inicio, 'mm') mes, 
  to_char(d.dt_inicio, 'yyyy') ano, 
  to_char(d.dt_inicio, 'hh24:mi') ds_hora, 
		28 qt_dia 
from	escala_diaria d, 
		escala_grupo g, 
		escala_classif c, 
		escala e 
where 	c.nr_sequencia = g.nr_seq_classif 
and 	g.nr_sequencia = e.nr_seq_grupo 
and		e.nr_sequencia = d.nr_seq_escala 
and 	d.cd_pessoa_fisica is not null 
and 	coalesce(obter_tipo_classif_escala(e.nr_sequencia),'P') = 'P' 
and		(obter_qt_dias_mes(to_date('01/'||to_char(d.dt_inicio,'mm')||'/'||to_char(d.dt_fim,'yyyy'),'dd/mm/yyyy')))::numeric  = 28 

union all
 
select 	distinct 
		to_char(d.dt_inicio,'hh24:mi')||'/'||to_char(d.dt_fim,'hh24:mi') ds_periodo, 
		substr(obter_dados_pf(f.cd_pessoa_fisica, 'CR'),1,150) ds_cargo, 
		substr(obter_nome_pf(f.cd_pessoa_fisica),1,100) nm_profissional, 
		substr(obter_se_prof_escala_plantao('01',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia1, 
		substr(obter_se_prof_escala_plantao('02',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia2, 
		substr(obter_se_prof_escala_plantao('03',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia3, 
		substr(obter_se_prof_escala_plantao('04',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia4, 
		substr(obter_se_prof_escala_plantao('05',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia5, 
		substr(obter_se_prof_escala_plantao('06',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia6, 
		substr(obter_se_prof_escala_plantao('07',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia7, 
		substr(obter_se_prof_escala_plantao('08',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia8, 
		substr(obter_se_prof_escala_plantao('09',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia9, 
		substr(obter_se_prof_escala_plantao('10',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia10, 
		substr(obter_se_prof_escala_plantao('11',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia11, 
		substr(obter_se_prof_escala_plantao('12',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia12, 
		substr(obter_se_prof_escala_plantao('13',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia13, 
		substr(obter_se_prof_escala_plantao('14',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia14, 
		substr(obter_se_prof_escala_plantao('15',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia15, 
		substr(obter_se_prof_escala_plantao('16',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia16, 
		substr(obter_se_prof_escala_plantao('17',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia17, 
		substr(obter_se_prof_escala_plantao('18',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia18, 
		substr(obter_se_prof_escala_plantao('19',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia19, 
		substr(obter_se_prof_escala_plantao('20',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia20, 
		substr(obter_se_prof_escala_plantao('21',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia21, 
		substr(obter_se_prof_escala_plantao('22',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia22, 
		substr(obter_se_prof_escala_plantao('23',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia23, 
		substr(obter_se_prof_escala_plantao('24',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia24, 
		substr(obter_se_prof_escala_plantao('25',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia25, 
		substr(obter_se_prof_escala_plantao('26',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia26, 
		substr(obter_se_prof_escala_plantao('27',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia27, 
		substr(obter_se_prof_escala_plantao('28',to_char(d.dt_inicio,'mm'),to_char(d.dt_fim,'yyyy'),f.cd_pessoa_fisica,e.nr_sequencia,'S', to_char(d.dt_inicio,'hh24:mi'),to_char(d.dt_fim,'hh24:mi')),1,25) dia28, 
		'' dia29, 
		'' dia30, 
		'' dia31, 
		to_char(d.dt_inicio,'mm') dt_inicio, 
		to_char(d.dt_fim,'yyyy') dt_fim, 
		e.nr_sequencia nr_seq_escala, 
		g.nr_sequencia nr_seq_grupo, 
		c.nr_sequencia nr_seq_classif, 
  d.nr_seq_escala nr_sequencia, 
  d.cd_pessoa_fisica, 
  d.nm_usuario, 
  to_char(d.dt_inicio, 'mm') mes, 
  to_char(d.dt_inicio, 'yyyy') ano, 
  to_char(d.dt_inicio, 'hh24:mi') ds_hora, 
		28 qt_dia 
from	escala_diaria d, 
		escala_grupo g, 
		escala_classif c, 
		escala e, 
		escala_diaria_adic f 
where 	c.nr_sequencia = g.nr_seq_classif 
and 	g.nr_sequencia = e.nr_seq_grupo 
and		e.nr_sequencia = d.nr_seq_escala 
and		d.nr_sequencia = f.nr_seq_escala_diaria 
and 	d.cd_pessoa_fisica is not null 
and 	coalesce(obter_tipo_classif_escala(e.nr_sequencia),'P') = 'P' 
and		(obter_qt_dias_mes(to_date('01/'||to_char(d.dt_inicio,'mm')||'/'||to_char(d.dt_fim,'yyyy'),'dd/mm/yyyy')))::numeric  = 28 
order by 1;

