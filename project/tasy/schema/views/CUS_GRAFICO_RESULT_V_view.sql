-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW cus_grafico_result_v (vl_mes, ds_mes, ie_ordem, dt_referencia, nm_usuario, ie_classif_conta, dt_mes, ie_emite_perc) AS select	vl_mes_atual vl_mes,
	to_char(dt_referencia,'mon/yyyy') ds_mes,
	01 ie_ordem,
	dt_referencia,
	nm_usuario,
	ie_classif_conta,
	dt_referencia dt_mes,
	ie_emite_perc
FROM	w_cus_grafico_result

union

select	vl_mes_1 vl_mes,
	to_char(add_months(dt_referencia,-1),'mon/yyyy') ds_mes,
	02 ie_ordem,
	dt_referencia,
	nm_usuario,
	ie_classif_conta,
	add_months(dt_referencia,-1) dt_mes,
	ie_emite_perc
from	w_cus_grafico_result

union

select	vl_mes_2 vl_mes,
	to_char(add_months(dt_referencia,-2),'mon/yyyy') ds_mes,
	03 ie_ordem,
	dt_referencia,
	nm_usuario,
	ie_classif_conta,
	add_months(dt_referencia,-2) dt_mes,
	ie_emite_perc
from	w_cus_grafico_result

union

select	vl_mes_3 vl_mes,
	to_char(add_months(dt_referencia,-3),'mon/yyyy') ds_mes,
	04 ie_ordem,
	dt_referencia,
	nm_usuario,
	ie_classif_conta,
	add_months(dt_referencia,-3) dt_mes,
	ie_emite_perc
from	w_cus_grafico_result

union

select	vl_mes_4 vl_mes,
	to_char(add_months(dt_referencia,-4),'mon/yyyy') ds_mes,
	05 ie_ordem,
	dt_referencia,
	nm_usuario,
	ie_classif_conta,
	add_months(dt_referencia,-4) dt_mes,
	ie_emite_perc
from	w_cus_grafico_result

union

select	vl_mes_5 vl_mes,
	to_char(add_months(dt_referencia,-5),'mon/yyyy') ds_mes,
	06 ie_ordem,
	dt_referencia,
	nm_usuario,
	ie_classif_conta,
	add_months(dt_referencia,-5) dt_mes,
	ie_emite_perc
from	w_cus_grafico_result

union

select	vl_mes_6 vl_mes,
	to_char(add_months(dt_referencia,-6),'mon/yyyy') ds_mes,
	07 ie_ordem,
	dt_referencia,
	nm_usuario,
	ie_classif_conta,
	add_months(dt_referencia,-6) dt_mes,
	ie_emite_perc
from	w_cus_grafico_result

union

select	vl_mes_7 vl_mes,
	to_char(add_months(dt_referencia,-7),'mon/yyyy') ds_mes,
	08 ie_ordem,
	dt_referencia,
	nm_usuario,
	ie_classif_conta,
	add_months(dt_referencia,-7) dt_mes,
	ie_emite_perc
from	w_cus_grafico_result

union

select	vl_mes_8 vl_mes,
	to_char(add_months(dt_referencia,-8),'mon/yyyy') ds_mes,
	09 ie_ordem,
	dt_referencia,
	nm_usuario,
	ie_classif_conta,
	add_months(dt_referencia,-8) dt_mes,
	ie_emite_perc
from	w_cus_grafico_result

union

select	vl_mes_9 vl_mes,
	to_char(add_months(dt_referencia,-9),'mon/yyyy') ds_mes,
	10 ie_ordem,
	dt_referencia,
	nm_usuario,
	ie_classif_conta,
	add_months(dt_referencia,-9) dt_mes,
	ie_emite_perc
from	w_cus_grafico_result

union

select	vl_mes_10 vl_mes,
	to_char(add_months(dt_referencia,-10),'mon/yyyy') ds_mes,
	11 ie_ordem,
	dt_referencia,
	nm_usuario,
	ie_classif_conta,
	add_months(dt_referencia,-10) dt_mes,
	ie_emite_perc
from	w_cus_grafico_result

union

select	vl_mes_11 vl_mes,
	to_char(add_months(dt_referencia,-11),'mon/yyyy') ds_mes,
	12 ie_ordem,
	dt_referencia,
	nm_usuario,
	ie_classif_conta,
	add_months(dt_referencia,-11) dt_mes,
	ie_emite_perc
from	w_cus_grafico_result

union

select	vl_mes_12 vl_mes,
	to_char(add_months(dt_referencia,-12),'mon/yyyy') ds_mes,
	13 ie_ordem,
	dt_referencia,
	nm_usuario,
	ie_classif_conta,
	add_months(dt_referencia,-12) dt_mes,
	ie_emite_perc
from	w_cus_grafico_result;

