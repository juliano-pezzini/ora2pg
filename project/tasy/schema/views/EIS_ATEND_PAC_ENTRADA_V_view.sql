-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_atend_pac_entrada_v (dt_entrada, nr_atendimento, cd_estabelecimento, dt_alta, nr_atend_original, ie_tipo_atendimento, ie_clinica, ie_carater_inter_sus, cd_procedencia, cd_medico_resp, cd_medico_referido, cd_motivo_alta, cd_pessoa_indic, cd_pessoa_juridica_indic, cd_empresa, nr_seq_forma_chegada, nr_seq_tipo_acidente, nr_seq_classificacao, nr_seq_classif_medico, nr_seq_queixa, nr_seq_indicacao, nm_usuario_intern, nm_usuario_atend, nm_usuario_alta, dt_nascimento, cd_pessoa_fisica, cd_religiao, ie_sexo, ie_estado_civil, ie_grau_instrucao, ie_fluencia_portugues, nr_seq_cor_pele, nr_cep_cidade_nasc, cd_convenio, cd_categoria, cd_plano_convenio, cd_convenio_glosa, cd_categoria_glosa, cd_setor_atendimento, cd_unidade_basica, cd_unidade_compl, nm_usuario_int, nm_usuario_inter_up, ds_usuario_internacao, nm_usuario_atend_up, ds_usuario_atend, nm_usuario_alta_up, ds_usuario_alta, dt_dia_entrada, dt_dia_alta, dt_mes_entrada, dt_ano_entrada, ds_hora, cd_hora, ds_dia_semana, ds_dia_mes, ds_hora_intervalo, cd_hora_intervalo, ds_hora_alta, cd_hora_alta, nr_dias_internado, nr_dias_internado_number, nr_primeiro_atend, ie_atendimento, ds_atendimento, ds_tipo_atendimento, ds_clinica, ds_carater_inter, ds_procedencia, nm_medico, nm_medico_referido, ds_motivo_alta, nm_pessoa_indic, nm_pj_indic, ds_estabelecimento, cd_empresa_atend, nm_empresa_atend, ds_forma_chegada, ds_tipo_acidente, ds_classificacao, ds_classif_medico, ds_queixa, cd_idade, ds_tipo_indicacao, ie_faixa_etaria, ds_idade, ds_religiao, ds_sexo, ds_estado_civil, ds_grau_instrucao, ds_fluencia_portugues, ds_cor_pele, ds_cidade_natal, ds_bairro, ds_nacionalidade, ds_municipio, cd_municipio_ibge, ds_municipio_ibge, ds_municipio_estado_ibge, cd_doenca_cid, ds_diagnostico, cd_especialidade, ds_especialidade, cd_retorno, ds_retorno, ds_dia_turno, cd_turno, ds_turno, ds_motivo_transf, ds_hospital_destino, cd_tipo_historico, ds_tipo_historico, nr_seq_agrupamento, ds_agrupamento, cd_procedimento, ds_procedimento, ie_proced_origem, nm_procedimento_up, ds_lado, ds_interna_proc, ds_microregiao, ds_convenio, cd_tipo_convenio, ds_tipo_convenio, ds_categoria, ds_tipo_acomodacao, ie_tipo_guia, ds_tipo_guia, ds_plano, ds_convenio_glosa, ds_categoria_glosa, cd_categoria_cid, ds_categoria_cid, ds_setor_atendimento, cd_classif_setor, ds_classif_setor, ds_unidade, cd_setor_entrada, ds_setor_entrada, ie_atend_cancelado, ds_atend_cancelado, ie_trat_conta_rn) AS select	a.dt_entrada,
	a.nr_atendimento, 
	a.cd_estabelecimento, 
	a.dt_alta, 
	a.nr_atend_original, 
	a.ie_tipo_atendimento, 
	a.ie_clinica, 
	a.ie_carater_inter_sus, 
	a.cd_procedencia, 
	a.cd_medico_resp, 
	a.cd_medico_referido, 
	a.cd_motivo_alta, 
	a.cd_pessoa_indic, 
	a.cd_pessoa_juridica_indic, 
	a.cd_empresa, 
	a.nr_seq_forma_chegada, 
	a.nr_seq_tipo_acidente, 
	a.nr_seq_classificacao, 
	a.nr_seq_classif_medico, 
	a.nr_seq_queixa, 
	a.nr_seq_indicacao, 
	a.nm_usuario_intern, 
	a.nm_usuario_atend, 
	a.nm_usuario_alta, 
	a.dt_nascimento, 
	a.cd_pessoa_fisica, 
	a.cd_religiao, 
	a.ie_sexo, 
	a.ie_estado_civil, 
	a.ie_grau_instrucao, 
	a.ie_fluencia_portugues, 
	a.nr_seq_cor_pele, 
	a.nr_cep_cidade_nasc, 
	a.cd_convenio, 
	a.cd_categoria, 
	a.cd_plano_convenio, 
	a.cd_convenio_glosa, 
	a.cd_categoria_glosa, 
	a.cd_setor_atendimento, 
	a.cd_unidade_basica, 
	a.cd_unidade_compl, 
	a.nm_usuario_int, 
	a.nm_usuario_inter_up, 
	a.ds_usuario_internacao, 
	a.nm_usuario_atend_up, 
	a.ds_usuario_atend, 
	a.nm_usuario_alta_up, 
	a.ds_usuario_alta, 
	a.dt_dia_entrada, 
	a.dt_dia_alta, 
	a.dt_mes_entrada, 
	a.dt_ano_entrada, 
	a.ds_hora, 
	a.cd_hora, 
	a.ds_dia_semana, 
	a.ds_dia_mes, 
	a.ds_hora_intervalo, 
	a.cd_hora_intervalo, 
	a.ds_hora_alta, 
	a.cd_hora_alta, 
	a.nr_dias_internado, 
	a.nr_dias_internado_number, 
	a.nr_primeiro_atend, 
	a.ie_atendimento, 
	substr(obter_valor_dominio(1536,CASE WHEN coalesce(a.nr_atend_original,0)=0 THEN 'N'  ELSE 'O' END ),1,254) ds_atendimento,
	substr(obter_valor_dominio(12, a.ie_tipo_atendimento),1,254) ds_tipo_atendimento,
	substr(obter_valor_dominio(17, a.ie_clinica),1,254) ds_clinica,
	a.ds_carater_inter, 
	a.ds_procedencia, 
	a.nm_medico, 
	a.nm_medico_referido, 
	a.ds_motivo_alta, 
	a.nm_pessoa_indic, 
	a.nm_pj_indic, 
	a.ds_estabelecimento, 
	a.cd_empresa_atend,
	a.nm_empresa_atend, 
	a.ds_forma_chegada, 
	a.ds_tipo_acidente, 
	a.ds_classificacao, 
	a.ds_classif_medico, 
	a.ds_queixa,
	a.cd_idade, 
	a.ds_tipo_indicacao, 
	a.ie_faixa_etaria, 
	a.ds_idade, 
	a.ds_religiao,
	substr(obter_valor_dominio(4, a.ie_sexo),1,254) ds_sexo,
	substr(obter_valor_dominio(5, a.ie_estado_civil),1,254) ds_estado_civil,
	substr(obter_valor_dominio(10, a.ie_grau_instrucao),1,254) ds_grau_instrucao,
	substr(obter_valor_dominio(1343,a.ie_fluencia_portugues),1,100) ds_fluencia_portugues,
	a.ds_cor_pele, 
	a.ds_cidade_natal, 
	a.ds_bairro, 
	a.ds_nacionalidade, 
	a.ds_municipio, 
	a.cd_municipio_ibge, 
	a.ds_municipio_ibge, 
	a.ds_municipio_estado_ibge, 
	a.cd_doenca_cid, 
	a.ds_diagnostico, 
	a.cd_especialidade, 
	a.ds_especialidade, 
	a.cd_retorno, 
	a.ds_retorno, 
	a.ds_dia_turno, 
	a.cd_turno, 
	a.ds_turno, 
	a.ds_motivo_transf, 
	a.ds_hospital_destino, 
	a.cd_tipo_historico, 
	a.ds_tipo_historico, 
	a.nr_seq_agrupamento, 
	a.ds_agrupamento, 
	a.cd_procedimento, 
	a.ds_procedimento, 
	a.ie_proced_origem, 
	a.nm_procedimento_up, 
	a.ds_lado, 
	a.ds_interna_proc, 
	a.ds_microregiao, 
	a.ds_convenio, 
	a.cd_tipo_convenio, 
	a.ds_tipo_convenio, 
	a.ds_categoria, 
	a.ds_tipo_acomodacao, 
	a.ie_tipo_guia, 
	substr(obter_valor_dominio(1031,obter_tipo_guia_convenio(a.nr_atendimento)),1,254) ds_tipo_guia,
	a.ds_plano, 
	a.ds_convenio_glosa, 
	a.ds_categoria_glosa, 
	a.cd_categoria_cid, 
	a.ds_categoria_cid, 
	a.ds_setor_atendimento, 
	a.cd_classif_setor, 
	substr(obter_valor_dominio(1,obter_classif_setor(a.cd_setor_atendimento)),1,100) ds_classif_setor,
	a.ds_unidade, 
	a.cd_setor_entrada, 
	a.ds_setor_entrada, 
	a.ie_atend_cancelado, 
	substr(obter_valor_dominio(5727,CASE WHEN b.dt_cancelamento IS NULL THEN 'N'  ELSE 'C' END ),1,255) ds_atend_cancelado,
	b.ie_trat_conta_rn
FROM	eis_atend_pac_entrada a,
	atendimento_paciente b
where	a.nr_atendimento = b.nr_atendimento;

