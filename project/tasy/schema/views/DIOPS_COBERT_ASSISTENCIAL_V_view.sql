-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW diops_cobert_assistencial_v (nr_procedimento, nr_origem, ds_plano, vl_evento, nr_seq_periodo) AS select	0 nr_procedimento,
	0 nr_origem,
	ds_plano ds_plano,
	vl_consulta_rp vl_evento,
	nr_seq_periodo nr_seq_periodo
FROM	diops_fin_cob_assist
where	vl_consulta_rp <> 0

union all

select	0 nr_procedimento,
	1 nr_origem,
	ds_plano ds_plano,
	vl_consulta_rc vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_consulta_rc <> 0

union all

select	0 nr_procedimento,
	2 nr_origem,
	ds_plano ds_plano,
	vl_consulta_re vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_consulta_re <> 0

union all

select	0 nr_procedimento,
	3 nr_origem,
	ds_plano ds_plano,
	vl_consulta_ie vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_consulta_ie <> 0

union all

select	0 nr_procedimento,
	4 nr_origem,
	ds_plano ds_plano,
	vl_consulta_op vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_consulta_op <> 0

union all

select	0 nr_procedimento,
	5 nr_origem,
	a.ds_plano ds_plano,
	a.vl_consulta_corresp vl_evento,
	a.nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist a,
        diops_periodo b
where	vl_consulta_corresp <> 0
and     a.nr_seq_periodo = b.nr_sequencia
and     b.dt_periodo_inicial < to_date('01/01/2019', 'dd/mm/yyyy')

union all

select	0 nr_procedimento,
	6 nr_origem,
	a.ds_plano ds_plano,
	a.vl_consulta_corresp vl_evento,
	a.nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist a,
        diops_periodo b
where	vl_consulta_corresp <> 0
and     a.nr_seq_periodo = b.nr_sequencia
and     b.dt_periodo_inicial >= to_date('01/01/2019', 'dd/mm/yyyy')

union all

select	1 nr_procedimento,
	0 nr_origem,
	ds_plano ds_plano,
	vl_exame_rp vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_exame_rp <> 0

union all

select	1 nr_procedimento,
	1 nr_origem,
	ds_plano ds_plano,
	vl_exame_rc vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_exame_rc <> 0

union all

select	1 nr_procedimento,
	2 nr_origem,
	ds_plano ds_plano,
	vl_exame_re vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_exame_re <> 0

union all

select	1 nr_procedimento,
	3 nr_origem,
	ds_plano ds_plano,
	vl_exame_ie vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_exame_ie <> 0

union all

select	1 nr_procedimento,
	4 nr_origem,
	ds_plano ds_plano,
	vl_exame_op vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_exame_op <> 0

union all

select	1 nr_procedimento,
	5 nr_origem,
	a.ds_plano ds_plano,
	a.vl_exame_corresp vl_evento,
	a.nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist a,
        diops_periodo b
where	vl_exame_corresp <> 0
and     a.nr_seq_periodo = b.nr_sequencia
and     b.dt_periodo_inicial < to_date('01/01/2019', 'dd/mm/yyyy')

union all

select	1 nr_procedimento,
	6 nr_origem,
	a.ds_plano ds_plano,
	a.vl_exame_corresp vl_evento,
	a.nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist a,
        diops_periodo b
where	vl_exame_corresp <> 0
and     a.nr_seq_periodo = b.nr_sequencia
and     b.dt_periodo_inicial >= to_date('01/01/2019', 'dd/mm/yyyy')

union all

select	2 nr_procedimento,
	0 nr_origem,
	ds_plano ds_plano,
	vl_terapia_rp vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_terapia_rp <> 0

union all

select	2 nr_procedimento,
	1 nr_origem,
	ds_plano ds_plano,
	vl_terapia_rc vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_terapia_rc <> 0

union all

select	2 nr_procedimento,
	2 nr_origem,
	ds_plano ds_plano,
	vl_terapia_re vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_terapia_re <> 0

union all

select	2 nr_procedimento,
	3 nr_origem,
	ds_plano ds_plano,
	vl_terapia_ie vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_terapia_ie <> 0

union all

select	2 nr_procedimento,
	4 nr_origem,
	ds_plano ds_plano,
	vl_terapia_op vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_terapia_op <> 0

union all

select	2 nr_procedimento,
	5 nr_origem,
	a.ds_plano ds_plano,
	a.vl_terapia_corresp vl_evento,
	a.nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist a,
        diops_periodo b
where	vl_terapia_corresp <> 0
and     a.nr_seq_periodo = b.nr_sequencia
and     b.dt_periodo_inicial < to_date('01/01/2019', 'dd/mm/yyyy')

union all

select	2 nr_procedimento,
	6 nr_origem,
	a.ds_plano ds_plano,
	a.vl_terapia_corresp vl_evento,
	a.nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist a,
        diops_periodo b
where	vl_terapia_corresp <> 0
and     a.nr_seq_periodo = b.nr_sequencia
and     b.dt_periodo_inicial >= to_date('01/01/2019', 'dd/mm/yyyy')

union all

select	3 nr_procedimento,
	0 nr_origem,
	ds_plano ds_plano,
	vl_intern_rp vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_intern_rp <> 0

union all

select	3 nr_procedimento,
	1 nr_origem,
	ds_plano ds_plano,
	vl_intern_rc vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_intern_rc <> 0

union all

select	3 nr_procedimento,
	2 nr_origem,
	ds_plano ds_plano,
	vl_intern_re vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_intern_re <> 0

union all

select	3 nr_procedimento,
	3 nr_origem,
	ds_plano ds_plano,
	vl_intern_ie vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_intern_ie <> 0

union all

select	3 nr_procedimento,
	4 nr_origem,
	ds_plano ds_plano,
	vl_intern_op vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_intern_op <> 0

union all

select	3 nr_procedimento,
	5 nr_origem,
	a.ds_plano ds_plano,
	a.vl_intern_corresp vl_evento,
	a.nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist a,
        diops_periodo b
where	vl_intern_corresp <> 0
and     a.nr_seq_periodo = b.nr_sequencia
and     b.dt_periodo_inicial < to_date('01/01/2019', 'dd/mm/yyyy')

union all

select	3 nr_procedimento,
	6 nr_origem,
	a.ds_plano ds_plano,
	a.vl_intern_corresp vl_evento,
	a.nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist a,
        diops_periodo b
where	vl_intern_corresp <> 0
and     a.nr_seq_periodo = b.nr_sequencia
and     b.dt_periodo_inicial >= to_date('01/01/2019', 'dd/mm/yyyy')

union all

select	4 nr_procedimento,
	0 nr_origem,
	ds_plano ds_plano,
	vl_atendimento_rp vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_atendimento_rp <> 0

union all

select	4 nr_procedimento,
	1 nr_origem,
	ds_plano ds_plano,
	vl_atendimento_rc vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_atendimento_rc <> 0

union all

select	4 nr_procedimento,
	2 nr_origem,
	ds_plano ds_plano,
	vl_atendimento_re vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_atendimento_re <> 0

union all

select	4 nr_procedimento,
	3 nr_origem,
	ds_plano ds_plano,
	vl_atendimento_ie vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_atendimento_ie <> 0

union all

select	4 nr_procedimento,
	4 nr_origem,
	ds_plano ds_plano,
	vl_atendimento_op vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_atendimento_op <> 0

union all

select	4 nr_procedimento,
	5 nr_origem,
	a.ds_plano ds_plano,
	a.vl_atendimento_corresp vl_evento,
	a.nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist a,
        diops_periodo b
where	vl_atendimento_corresp <> 0
and     a.nr_seq_periodo = b.nr_sequencia
and     b.dt_periodo_inicial < to_date('01/01/2019', 'dd/mm/yyyy')

union all

select	4 nr_procedimento,
	6 nr_origem,
	a.ds_plano ds_plano,
	a.vl_atendimento_corresp vl_evento,
	a.nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist a,
        diops_periodo b
where	vl_atendimento_corresp <> 0
and     a.nr_seq_periodo = b.nr_sequencia
and     b.dt_periodo_inicial >= to_date('01/01/2019', 'dd/mm/yyyy')

union all

select	5 nr_procedimento,
	0 nr_origem,
	ds_plano ds_plano,
	vl_despesas_rp vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_despesas_rp <> 0

union all

select	5 nr_procedimento,
	1 nr_origem,
	ds_plano ds_plano,
	vl_despesas_rc vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_despesas_rc <> 0

union all

select	5 nr_procedimento,
	2 nr_origem,
	ds_plano ds_plano,
	vl_despesas_re vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_despesas_re <> 0

union all

select	5 nr_procedimento,
	3 nr_origem,
	ds_plano ds_plano,
	vl_despesas_ie vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_despesas_ie <> 0

union all

select	5 nr_procedimento,
	4 nr_origem,
	ds_plano ds_plano,
	vl_despesas_op vl_evento,
	nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist
where	vl_despesas_op <> 0

union all

select	5 nr_procedimento,
	5 nr_origem,
	a.ds_plano ds_plano,
	a.vl_despesas_corresp vl_evento,
	a.nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist a,
        diops_periodo b
where	vl_despesas_corresp <> 0
and     a.nr_seq_periodo = b.nr_sequencia
and     b.dt_periodo_inicial < to_date('01/01/2019', 'dd/mm/yyyy')

union all

select	5 nr_procedimento,
	6 nr_origem,
	a.ds_plano ds_plano,
	a.vl_despesas_corresp vl_evento,
	a.nr_seq_periodo nr_seq_periodo
from	diops_fin_cob_assist a,
        diops_periodo b
where	vl_despesas_corresp <> 0
and     a.nr_seq_periodo = b.nr_sequencia
and     b.dt_periodo_inicial >= to_date('01/01/2019', 'dd/mm/yyyy');

