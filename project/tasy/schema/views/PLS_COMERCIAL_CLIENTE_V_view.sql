-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_comercial_cliente_v (nr_sequencia, ie_tipo_cliente, cd_cliente, nm_cliente, ie_classificacao, ie_status) AS select	a.nr_sequencia,
	'PF' ie_tipo_cliente,
	b.cd_pessoa_fisica cd_cliente,
	b.nm_pessoa_fisica nm_cliente,
	a.ie_classificacao,
	a.ie_status
FROM	pls_comercial_cliente a,
	pessoa_fisica b
where	a.cd_pessoa_fisica	= b.cd_pessoa_fisica
and	a.cd_cgc is null

union

select	a.nr_sequencia,
	'PJ' ie_tipo_cliente,
	b.cd_cgc cd_cliente,
	b.ds_razao_social nm_cliente,
	a.ie_classificacao,
	a.ie_status
from	pls_comercial_cliente a,
	pessoa_juridica b
where	a.cd_cgc	= b.cd_cgc
and	a.cd_pessoa_fisica is null;

