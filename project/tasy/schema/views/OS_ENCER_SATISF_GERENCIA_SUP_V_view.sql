-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW os_encer_satisf_gerencia_sup_v (nr_sequencia, dt_fim_real, nr_seq_gerencia_sup, nr_seq_grupo_sup, nr_seq_localizacao, cd_funcao, nr_seq_gerencia_insatisf, ie_grau_satisfacao, nr_seq_gerencia_grupo, ie_situacao) AS select  a.nr_sequencia,
	a.dt_fim_real,
	coalesce(a.nr_seq_gerencia_insatisf, b.nr_seq_gerencia_sup) nr_seq_gerencia_sup,
	a.nr_seq_grupo_sup,
	a.nr_seq_localizacao,
	a.cd_funcao,
	a.nr_seq_gerencia_insatisf,
	a.ie_grau_satisfacao,
	b.nr_seq_gerencia_sup nr_seq_gerencia_grupo,
	b.ie_situacao
FROM	man_ordem_servico a,
	grupo_suporte b
where	a.nr_seq_grupo_sup = b.nr_sequencia
and	a.ie_status_ordem = 3
and	a.ie_grau_satisfacao in ('E','O','B','P','R')
and	exists (	select	1
			from	man_ordem_serv_estagio c,
				man_estagio_processo d
			where	c.nr_seq_estagio = d.nr_sequencia
			and	c.nr_seq_ordem = a.nr_sequencia
			and	d.ie_suporte = 'S'
		);

