-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_fat_pend_periodo_v (ds_dias, nr_dias, vl_fatura, dt_inicio, dt_fim) AS select	'30 dias' ds_dias,
	30 nr_dias,
	sum(vl_pos_estab) + sum(vl_pos_estab_taxa) vl_fatura,
	trunc(LOCALTIMESTAMP,'dd')-60 dt_inicio,
	fim_dia(LOCALTIMESTAMP)-30 dt_fim
FROM	w_pls_monit_fin_cta_fat
where	nr_dias	= 30

union

select	'60 dias' ds_dias,
	60 nr_dias,
	sum(vl_pos_estab) + sum(vl_pos_estab_taxa) vl_fatura,
	trunc(LOCALTIMESTAMP, 'dd')-90 dt_inicio,
	fim_dia(LOCALTIMESTAMP)-60 dt_fim
from	w_pls_monit_fin_cta_fat
where	nr_dias	= 60

union all

select	'90 dias' ds_dias,
	90 nr_dias,
	sum(vl_pos_estab) + sum(vl_pos_estab_taxa) vl_fatura,
	trunc(LOCALTIMESTAMP, 'dd')-120 dt_inicio,
	fim_dia(LOCALTIMESTAMP)-90 dt_fim
from	w_pls_monit_fin_cta_fat
where	nr_dias	= 90

union all

select	'120 dias' ds_dias,
	120 nr_dias,
	sum(vl_pos_estab) + sum(vl_pos_estab_taxa) vl_fatura,
	trunc(LOCALTIMESTAMP,'dd')-180 dt_inicio,
	fim_dia(LOCALTIMESTAMP)-120 dt_fim
from	w_pls_monit_fin_cta_fat
where	nr_dias	= 120

union all

select	'180 dias' ds_dias,
	180 nr_dias,
	sum(vl_pos_estab) + sum(vl_pos_estab_taxa) vl_fatura,
	trunc(LOCALTIMESTAMP, 'dd')-300 dt_inicio,
	fim_dia(LOCALTIMESTAMP)-180 dt_fim
from	w_pls_monit_fin_cta_fat
where	nr_dias	= 180;

