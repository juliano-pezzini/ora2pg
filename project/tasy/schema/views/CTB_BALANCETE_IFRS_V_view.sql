-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ctb_balancete_ifrs_v (cd_empresa, cd_estabelecimento, nr_seq_conta_ifrs, nr_seq_mes_ref, cd_classificacao, ds_conta_apres, ie_tipo, vl_debito, vl_credito, vl_saldo, vl_movimento, vl_saldo_encerr, vl_movimento_encerr, vl_saldo_ant, dt_referencia, ie_nivel, dt_inicio_vigencia, dt_fim_vigencia) AS select
	c.cd_empresa,
	a.cd_estabelecimento,
	a.nr_seq_conta_ifrs,
	a.nr_seq_mes_ref,
	coalesce(c.cd_classificacao, a.cd_classificacao) cd_classificacao,
	substr(c.ds_conta,1,255) ds_conta_apres,
	c.ie_tipo,
	a.vl_debito,
	a.vl_credito,
	a.vl_saldo,
	a.vl_movimento,
	a.vl_saldo - a.vl_encerramento vl_saldo_encerr,
	a.vl_movimento - a.vl_encerramento vl_movimento_encerr,
	a.vl_saldo - a.vl_movimento vl_saldo_ant,
	d.dt_referencia,
        a.nr_nivel_conta ie_nivel,
        c.dt_inicio_vigencia,
        c.dt_fim_vigencia
FROM	ctb_plano_conta_ifrs c,
	ctb_mes_ref d,
	ctb_saldo_ifrs a
where	a.nr_seq_conta_ifrs	= c.nr_sequencia
and	d.nr_sequencia		= a.nr_seq_mes_ref
and	d.cd_empresa		= c.cd_empresa;

