-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW gestao_populacional_pac_v (ds_pessoa, ds_idade, ds_sexo, cd_pessoa_fisica, ie_tipo, nr_sequencia, nm_usuario) AS Select obter_nome_social_pf(a.cd_pessoa_fisica) ds_pessoa,
       Obter_idade_pf(a.cd_pessoa_fisica,LOCALTIMESTAMP,'D') ds_idade,
       Obter_sexo_pf(a.cd_pessoa_fisica,'D') ds_sexo,
       a.cd_pessoa_fisica cd_pessoa_fisica,
	   'R' ie_tipo,
	   d.nr_sequencia nr_sequencia,
	   a.nm_usuario nm_usuario
FROM   w_gestao_ocupacional_pac a,
       w_gestao_ocupacional_resid b,
       w_gestao_ocupacional_micro c,
       w_gestao_ocupacional d
where  a.cd_domicilio = b.cd_domicilio
and    b.nr_seq_micro_reg = c.nr_seq_micro_reg
and    c.nr_seq_regiao = d.nr_seq_regiao
and    b.nm_usuario = a.nm_usuario
and    c.nm_usuario = d.nm_usuario

union all

Select obter_nome_social_pf(a.cd_pessoa_fisica) ds_pessoa,
       Obter_idade_pf(a.cd_pessoa_fisica,LOCALTIMESTAMP,'D') ds_idade,
       Obter_sexo_pf(a.cd_pessoa_fisica,'D') ds_sexo,
       a.cd_pessoa_fisica cd_pessoa_fisica,
	   'M' ie_tipo,
	   c.nr_sequencia nr_sequencia,
	   a.nm_usuario nm_usuario
from   w_gestao_ocupacional_pac a,
       w_gestao_ocupacional_resid b,
       w_gestao_ocupacional_micro c
where  a.cd_domicilio = b.cd_domicilio
and    b.nr_seq_micro_reg = c.nr_seq_micro_reg
and    b.nm_usuario = a.nm_usuario
and    c.nm_usuario = b.nm_usuario

union all

Select obter_nome_social_pf(a.cd_pessoa_fisica) ds_pessoa,
       Obter_idade_pf(a.cd_pessoa_fisica,LOCALTIMESTAMP,'D') ds_idade,
       Obter_sexo_pf(a.cd_pessoa_fisica,'D') ds_sexo,
       a.cd_pessoa_fisica cd_pessoa_fisica,
	   'C' ie_tipo,
	   b.nr_sequencia nr_sequencia,
	   a.nm_usuario nm_usuario
from   w_gestao_ocupacional_pac a,
       w_gestao_ocupacional_resid b
where  a.cd_domicilio = b.cd_domicilio
and    b.nm_usuario = a.nm_usuario
order by ds_pessoa;

