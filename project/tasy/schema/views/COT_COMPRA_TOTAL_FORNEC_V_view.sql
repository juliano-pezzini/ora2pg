-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW cot_compra_total_fornec_v (cd_material, qt_fornecedor, vl_tot_fornecedor1, vl_tot_fornecedor2, vl_tot_fornecedor3, vl_tot_fornecedor4, vl_tot_fornecedor5, vl_tot_fornecedor6, vl_tot_fornecedor7, vl_tot_fornecedor8, vl_tot_fornecedor9, vl_tot_fornecedor10, vl_tot_fornecedor11, vl_tot_fornecedor12, vl_tot_fornecedor13, vl_tot_fornecedor14, vl_tot_fornecedor15, vl_tot_fornecedor16, vl_tot_fornecedor17, vl_tot_fornecedor18, vl_tot_fornecedor19, vl_tot_fornecedor20, vl_tot_fornecedor21, vl_fornecedor1, vl_fornecedor2, vl_fornecedor3, vl_fornecedor4, vl_fornecedor5, vl_fornecedor6, vl_fornecedor7, vl_fornecedor8, vl_fornecedor9, vl_fornecedor10, vl_fornecedor11, vl_fornecedor12, vl_fornecedor13, vl_fornecedor14, vl_fornecedor15, vl_fornecedor16, vl_fornecedor17, vl_fornecedor18, vl_fornecedor19, vl_fornecedor20, vl_fornecedor21) AS select	cd_material,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) qt_fornecedor,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'V')),0) vl_tot_fornecedor1,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,2,'V')),0) vl_tot_fornecedor2,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,3,'V')),0) vl_tot_fornecedor3,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,4,'V')),0) vl_tot_fornecedor4,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,5,'V')),0) vl_tot_fornecedor5,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,6,'V')),0) vl_tot_fornecedor6,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,7,'V')),0) vl_tot_fornecedor7,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,8,'V')),0) vl_tot_fornecedor8,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,9,'V')),0) vl_tot_fornecedor9,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,10,'V')),0) vl_tot_fornecedor10,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,11,'V')),0) vl_tot_fornecedor11,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,12,'V')),0) vl_tot_fornecedor12,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,13,'V')),0) vl_tot_fornecedor13,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,14,'V')),0) vl_tot_fornecedor14,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,15,'V')),0) vl_tot_fornecedor15,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,16,'V')),0) vl_tot_fornecedor16,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,17,'V')),0) vl_tot_fornecedor17,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,18,'V')),0) vl_tot_fornecedor18,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,19,'V')),0) vl_tot_fornecedor19,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,20,'V')),0) vl_tot_fornecedor20,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'Q')),0) * coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,21,'V')),0) vl_tot_fornecedor21,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,1,'V')),0) vl_fornecedor1,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,2,'V')),0) vl_fornecedor2,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,3,'V')),0) vl_fornecedor3,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,4,'V')),0) vl_fornecedor4,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,5,'V')),0) vl_fornecedor5,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,6,'V')),0) vl_fornecedor6,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,7,'V')),0) vl_fornecedor7,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,8,'V')),0) vl_fornecedor8,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,9,'V')),0) vl_fornecedor9,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,10,'V')),0) vl_fornecedor10,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,11,'V')),0) vl_fornecedor11,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,12,'V')),0) vl_fornecedor12,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,13,'V')),0) vl_fornecedor13,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,14,'V')),0) vl_fornecedor14,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,15,'V')),0) vl_fornecedor15,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,16,'V')),0) vl_fornecedor16,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,17,'V')),0) vl_fornecedor17,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,18,'V')),0) vl_fornecedor18,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,19,'V')),0) vl_fornecedor19,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,20,'V')),0) vl_fornecedor20,
	coalesce(max(obter_dados_w_cotacao_item(nr_sequencia,21,'V')),0) vl_fornecedor21
FROM	w_cotacao_item
group by	cd_material;

