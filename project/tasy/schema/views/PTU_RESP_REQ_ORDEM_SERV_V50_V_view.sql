-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_resp_req_ordem_serv_v50_v (ie_tipo_registro, cd_transacao, nr_sequencia, nr_seq_requisicao, nr_seq_guia, ie_tipo_cliente, cd_unimed_executora, cd_unimed_beneficiario, cd_unimed_solic, nr_seq_execucao, cd_unimed, cd_usuario_plano, nr_seq_origem, nm_prest_alto_custo, nr_versao, ds_observacao, cd_servico, qt_servico_aut, ie_status_requisicao, ie_tipo_tabela, cd_mens_erro_1, cd_mens_erro_2, cd_mens_erro_3, cd_mens_erro_4, cd_mens_erro_5, ds_mens_espec_1, ds_mens_espec_2, ds_mens_espec_3, ds_mens_espec_4, ds_mens_espec_5, ds_fim) AS select	1        		ie_tipo_registro,
	00807			cd_transacao,
	nr_sequencia            nr_sequencia,
	nr_seq_requisicao	nr_seq_requisicao,
	nr_seq_guia		nr_seq_guia,
	CASE WHEN ie_tipo_cliente='U' THEN 'UNIMED' WHEN ie_tipo_cliente='P' THEN 'PORTAL' WHEN ie_tipo_cliente='R' THEN 'PRESTADOR' END  ie_tipo_cliente,
	cd_unimed_executora     cd_unimed_executora,
	cd_unimed_beneficiario	cd_unimed_beneficiario,
	cd_unimed_solicitante   cd_unimed_solic,
	nr_seq_execucao         nr_seq_execucao,
	cd_unimed               cd_unimed,
	cd_usuario_plano        cd_usuario_plano,
	nr_seq_origem           nr_seq_origem,
	Elimina_Acentuacao(nm_prest_alto_custo) nm_prest_alto_custo,
	pls_obter_versao_scs	nr_versao,
	null			ds_observacao,
	null			cd_servico,
	null			qt_servico_aut,
	null			ie_status_requisicao,
	null               	ie_tipo_tabela,
	null			cd_mens_erro_1,
	null			cd_mens_erro_2,
	null			cd_mens_erro_3,
	null			cd_mens_erro_4,
	null			cd_mens_erro_5,
	null			ds_mens_espec_1,
	null			ds_mens_espec_2,
	null			ds_mens_espec_3,
	null			ds_mens_espec_4,
	null			ds_mens_espec_5,
	null			ds_fim
FROM	ptu_resposta_req_ord_serv

union

select  2			ie_tipo_registro,
	null			cd_transacao,
	nr_sequencia            nr_sequencia,
	nr_seq_requisicao       nr_seq_requisicao,
	nr_seq_guia             nr_seq_guia,
	null			ie_tipo_cliente,
	null			cd_unimed_executora,
	null			cd_unimed_beneficiario,
	null			cd_unimed_solic,
	nr_seq_execucao		nr_seq_execucao,
	null			cd_unimed,
	null			cd_usuario_plano,
	nr_seq_origem           nr_seq_origem,
	null			nm_prest_alto_custo,
	null			nr_versao,
	Elimina_Acentuacao(ds_observacao) ds_observacao,
	null			cd_servico,
	null			qt_servico_aut,
	null			ie_status_requisicao,
	null			ie_tipo_tabela,
	null			cd_mens_erro_1,
	null			cd_mens_erro_2,
	null			cd_mens_erro_3,
	null			cd_mens_erro_4,
	null			cd_mens_erro_5,
	null			ds_mens_espec_1,
	null			ds_mens_espec_2,
	null			ds_mens_espec_3,
	null			ds_mens_espec_4,
	null			ds_mens_espec_5,
	null			ds_fim
from 	ptu_resposta_req_ord_serv

union

select  3			ie_tipo_registro,
	null			cd_transacao,
	nr_seq_resp_req_ord     nr_sequencia,
	nr_seq_requisicao       nr_seq_requisicao,
	nr_seq_guia             nr_seq_guia,
	null			ie_tipo_cliente,
	null			cd_unimed_executora,
	null			cd_unimed_beneficiario,
	null			cd_unimed_solic,
	nr_seq_execucao		nr_seq_execucao,
	null			cd_unimed,
	null			cd_usuario_plano,
	nr_seq_origem           nr_seq_origem,
	null			nm_prest_alto_custo,
	null			nr_versao,
	null			ds_observacao,
	cd_servico              cd_servico,
	ptu_obter_qtd_env_itens_scs(qt_servico_aut,null,'E') qt_servico_aut,
	ie_status_requisicao    ie_status_requisicao,
	ie_tipo_tabela          ie_tipo_tabela,
	(	select	y.cd_inconsistencia
		from	ptu_intercambio_consist x,
			ptu_inconsistencia y
		where	y.nr_sequencia  	= x.nr_seq_inconsistencia
		and	x.nr_seq_ordem_serv	= a.nr_sequencia
		and (x.nr_seq_procedimento	= b.nr_sequencia
		or	x.nr_seq_material  	= b.nr_sequencia)
		and	cd_transacao    	= '00807') cd_mens_erro_1,
	0			cd_mens_erro_2,
	0			cd_mens_erro_3,
	0			cd_mens_erro_4,
	0			cd_mens_erro_5,
	Elimina_Acentuacao(ptu_obter_desc_msg_negativa((	select	y.cd_inconsistencia
					from	ptu_intercambio_consist x,
						ptu_inconsistencia y
					where	y.nr_sequencia		= x.nr_seq_inconsistencia
					and	x.nr_seq_ordem_serv	= a.nr_sequencia
					and (x.nr_seq_procedimento  = b.nr_sequencia
					or	x.nr_seq_material  	= a.nr_sequencia)
					and	cd_transacao    	= '00807'))) ds_mens_espec_1,
	' '			ds_mens_espec_2,
	' '			ds_mens_espec_3,
	' '			ds_mens_espec_4,
	' '			ds_mens_espec_5,
	null			ds_fim
from	ptu_resposta_req_servico  b,
	ptu_resposta_req_ord_serv  a
where	a.nr_sequencia  = b.nr_seq_resp_req_ord

union

select	4			ie_tipo_registro,
	null			cd_transacao,
	nr_sequencia            nr_sequencia,
	nr_seq_requisicao       nr_seq_requisicao,
	nr_seq_guia             nr_seq_guia,
	null			ie_tipo_cliente,
	null			cd_unimed_executora,
	null			cd_unimed_beneficiario,
	null			cd_unimed_solic,
	nr_seq_execucao		nr_seq_execucao,
	null			cd_unimed,
	null			cd_usuario_plano,
	nr_seq_origem           nr_seq_origem,
	null			nm_prest_alto_custo,
	null			nr_versao,
	null			ds_observacao,
	null			cd_servico,
	null			qt_servico_aut,
	null			ie_status_requisicao,
	null			ie_tipo_tabela,
	null			cd_mens_erro_1,
	null			cd_mens_erro_2,
	null			cd_mens_erro_3,
	null			cd_mens_erro_4,
	null			cd_mens_erro_5,
	null			ds_mens_espec_1,
	null			ds_mens_espec_2,
	null			ds_mens_espec_3,
	null			ds_mens_espec_4,
	null			ds_mens_espec_5,
	'FIM$'        		ds_fim
from  ptu_resposta_req_ord_serv;

