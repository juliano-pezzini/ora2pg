-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pessoa_fisica_integracao_v (cd_pessoa_fisica, nm_pessoa_fisica, ie_tipo_pessoa, nr_cpf, ie_sexo, dt_nascimento, nr_identidade, nr_prontuario, cd_nacionalidade, dt_obito, nr_crm, uf_crm, nr_seq_conselho, sg_conselho, dt_atualizacao, cd_cep, ds_endereco, nr_endereco, ds_complemento, ds_bairro, ds_municipio, sg_estado, ds_email, nr_ddi_telefone, nr_ddd_telefone, nr_telefone, nr_ddi_fax, nr_ddd_fax, ds_fax, ds_fone_adic, nm_usuario_pf, ds_fonetica) AS select  a.cd_pessoa_fisica,
        a.nm_pessoa_fisica,
	a.ie_tipo_pessoa,
        	a.nr_cpf,
	a.ie_sexo,
	a.dt_nascimento,
	a.nr_identidade,
	a.nr_prontuario,
	a.cd_nacionalidade,
	a.dt_obito,
	b.nr_crm,
	b.uf_crm,
	a.nr_seq_conselho,
	c.sg_conselho,
	a.dt_atualizacao,
	p.cd_cep,
	p.ds_endereco,
	p.nr_endereco,
	p.ds_complemento,
	p.ds_bairro,
	p.ds_municipio,
	p.sg_estado,
	p.ds_email,
	p.nr_ddi_telefone,
	p.nr_ddd_telefone,
	p.nr_telefone,
	p.nr_ddi_fax,
	p.nr_ddd_fax,
	p.ds_fax,
	p.ds_fone_adic,
	(select	max(nm_usuario)
	 FROM 	usuario
	 where 	cd_pessoa_fisica = a.cd_pessoa_fisica) nm_usuario_pf,
	a.ds_fonetica
FROM pessoa_fisica a
LEFT OUTER JOIN medico b ON (a.cd_pessoa_fisica = b.cd_pessoa_fisica)
LEFT OUTER JOIN conselho_profissional c ON (a.nr_seq_conselho = c.nr_sequencia)
LEFT OUTER JOIN compl_pessoa_fisica p ON (a.cd_pessoa_fisica = p.cd_pessoa_fisica AND 1 = p.ie_tipo_complemento);

