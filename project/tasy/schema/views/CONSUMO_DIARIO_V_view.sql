-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW consumo_diario_v (cd_material_estoque, cd_estabelecimento, dt_mesano_referencia, cd_centro_custo, cd_local_estoque, cd_operacao_estoque, dt_processo, qt_dia1, qt_dia2, qt_dia3, qt_dia4, qt_dia5, qt_dia6, qt_dia7, qt_dia8, qt_dia9, qt_dia10, qt_dia11, qt_dia12, qt_dia13, qt_dia14, qt_dia15, qt_dia16, qt_dia17, qt_dia18, qt_dia19, qt_dia20, qt_dia21, qt_dia22, qt_dia23, qt_dia24, qt_dia25, qt_dia26, qt_dia27, qt_dia28, qt_dia29, qt_dia30, qt_dia31, vl_dia1, vl_dia2, vl_dia3, vl_dia4, vl_dia5, vl_dia6, vl_dia7, vl_dia8, vl_dia9, vl_dia10, vl_dia11, vl_dia12, vl_dia13, vl_dia14, vl_dia15, vl_dia16, vl_dia17, vl_dia18, vl_dia19, vl_dia20, vl_dia21, vl_dia22, vl_dia23, vl_dia24, vl_dia25, vl_dia26, vl_dia27, vl_dia28, vl_dia29, vl_dia30, vl_dia31) AS select	x.cd_material_estoque,
	x.cd_estabelecimento,
	x.dt_mesano_referencia,
	x.cd_centro_custo,
	x.cd_local_estoque,
	x.cd_operacao_estoque,
	trunc(x.dt_processo,'dd') dt_processo,
	coalesce(sum(x.qt_dia1),0) qt_dia1,
	coalesce(sum(x.qt_dia2),0) qt_dia2,
	coalesce(sum(x.qt_dia3),0) qt_dia3,
	coalesce(sum(x.qt_dia4),0) qt_dia4,
	coalesce(sum(x.qt_dia5),0) qt_dia5,
	coalesce(sum(x.qt_dia6),0) qt_dia6,
	coalesce(sum(x.qt_dia7),0) qt_dia7,
	coalesce(sum(x.qt_dia8),0) qt_dia8,
	coalesce(sum(x.qt_dia9),0) qt_dia9,
	coalesce(sum(x.qt_dia10),0) qt_dia10,
	coalesce(sum(x.qt_dia11),0) qt_dia11,
	coalesce(sum(x.qt_dia12),0) qt_dia12,
	coalesce(sum(x.qt_dia13),0) qt_dia13,
	coalesce(sum(x.qt_dia14),0) qt_dia14,
	coalesce(sum(x.qt_dia15),0) qt_dia15,
	coalesce(sum(x.qt_dia16),0) qt_dia16,
	coalesce(sum(x.qt_dia17),0) qt_dia17,
	coalesce(sum(x.qt_dia18),0) qt_dia18,
	coalesce(sum(x.qt_dia19),0) qt_dia19,
	coalesce(sum(x.qt_dia20),0) qt_dia20,
	coalesce(sum(x.qt_dia21),0) qt_dia21,
	coalesce(sum(x.qt_dia22),0) qt_dia22,
	coalesce(sum(x.qt_dia23),0) qt_dia23,
	coalesce(sum(x.qt_dia24),0) qt_dia24,
	coalesce(sum(x.qt_dia25),0) qt_dia25,
	coalesce(sum(x.qt_dia26),0) qt_dia26,
	coalesce(sum(x.qt_dia27),0) qt_dia27,
	coalesce(sum(x.qt_dia28),0) qt_dia28,
	coalesce(sum(x.qt_dia29),0) qt_dia29,
	coalesce(sum(x.qt_dia30),0) qt_dia30,
	coalesce(sum(x.qt_dia31),0) qt_dia31,
	coalesce(sum(x.vl_dia1),0) vl_dia1,
	coalesce(sum(x.vl_dia2),0) vl_dia2,
	coalesce(sum(x.vl_dia3),0) vl_dia3,
	coalesce(sum(x.vl_dia4),0) vl_dia4,
	coalesce(sum(x.vl_dia5),0) vl_dia5,
	coalesce(sum(x.vl_dia6),0) vl_dia6,
	coalesce(sum(x.vl_dia7),0) vl_dia7,
	coalesce(sum(x.vl_dia8),0) vl_dia8,
	coalesce(sum(x.vl_dia9),0) vl_dia9,
	coalesce(sum(x.vl_dia10),0) vl_dia10,
	coalesce(sum(x.vl_dia11),0) vl_dia11,
	coalesce(sum(x.vl_dia12),0) vl_dia12,
	coalesce(sum(x.vl_dia13),0) vl_dia13,
	coalesce(sum(x.vl_dia14),0) vl_dia14,
	coalesce(sum(x.vl_dia15),0) vl_dia15,
	coalesce(sum(x.vl_dia16),0) vl_dia16,
	coalesce(sum(x.vl_dia17),0) vl_dia17,
	coalesce(sum(x.vl_dia18),0) vl_dia18,
	coalesce(sum(x.vl_dia19),0) vl_dia19,
	coalesce(sum(x.vl_dia20),0) vl_dia20,
	coalesce(sum(x.vl_dia21),0) vl_dia21,
	coalesce(sum(x.vl_dia22),0) vl_dia22,
	coalesce(sum(x.vl_dia23),0) vl_dia23,
	coalesce(sum(x.vl_dia24),0) vl_dia24,
	coalesce(sum(x.vl_dia25),0) vl_dia25,
	coalesce(sum(x.vl_dia26),0) vl_dia26,
	coalesce(sum(x.vl_dia27),0) vl_dia27,
	coalesce(sum(x.vl_dia28),0) vl_dia28,
	coalesce(sum(x.vl_dia29),0) vl_dia29,
	coalesce(sum(x.vl_dia30),0) vl_dia30,
	coalesce(sum(x.vl_dia31),0) vl_dia31
FROM (
select	m.cd_material_estoque,
	m.cd_estabelecimento,
	m.dt_mesano_referencia,
	m.cd_centro_custo,
	m.cd_local_estoque,
	m.dt_processo,
	m.cd_operacao_estoque,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='01' THEN m.qt_consumo  ELSE 0 END ) qt_dia1,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='02' THEN m.qt_consumo  ELSE 0 END ) qt_dia2,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='03' THEN m.qt_consumo  ELSE 0 END ) qt_dia3,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='04' THEN m.qt_consumo  ELSE 0 END ) qt_dia4,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='05' THEN m.qt_consumo  ELSE 0 END ) qt_dia5,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='06' THEN m.qt_consumo  ELSE 0 END ) qt_dia6,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='07' THEN m.qt_consumo  ELSE 0 END ) qt_dia7,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='08' THEN m.qt_consumo  ELSE 0 END ) qt_dia8,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='09' THEN m.qt_consumo  ELSE 0 END ) qt_dia9,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='10' THEN m.qt_consumo  ELSE 0 END ) qt_dia10,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='11' THEN m.qt_consumo  ELSE 0 END ) qt_dia11,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='12' THEN m.qt_consumo  ELSE 0 END ) qt_dia12,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='13' THEN m.qt_consumo  ELSE 0 END ) qt_dia13,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='14' THEN m.qt_consumo  ELSE 0 END ) qt_dia14,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='15' THEN m.qt_consumo  ELSE 0 END ) qt_dia15,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='16' THEN m.qt_consumo  ELSE 0 END ) qt_dia16,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='17' THEN m.qt_consumo  ELSE 0 END ) qt_dia17,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='18' THEN m.qt_consumo  ELSE 0 END ) qt_dia18,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='19' THEN m.qt_consumo  ELSE 0 END ) qt_dia19,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='20' THEN m.qt_consumo  ELSE 0 END ) qt_dia20,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='21' THEN m.qt_consumo  ELSE 0 END ) qt_dia21,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='22' THEN m.qt_consumo  ELSE 0 END ) qt_dia22,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='23' THEN m.qt_consumo  ELSE 0 END ) qt_dia23,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='24' THEN m.qt_consumo  ELSE 0 END ) qt_dia24,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='25' THEN m.qt_consumo  ELSE 0 END ) qt_dia25,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='26' THEN m.qt_consumo  ELSE 0 END ) qt_dia26,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='27' THEN m.qt_consumo  ELSE 0 END ) qt_dia27,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='28' THEN m.qt_consumo  ELSE 0 END ) qt_dia28,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='29' THEN m.qt_consumo  ELSE 0 END ) qt_dia29,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='30' THEN m.qt_consumo  ELSE 0 END ) qt_dia30,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='31' THEN m.qt_consumo  ELSE 0 END ) qt_dia31,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='01' THEN v.vl_consumo  ELSE 0 END ) vl_dia1,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='02' THEN v.vl_consumo  ELSE 0 END ) vl_dia2,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='03' THEN v.vl_consumo  ELSE 0 END ) vl_dia3,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='04' THEN v.vl_consumo  ELSE 0 END ) vl_dia4,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='05' THEN v.vl_consumo  ELSE 0 END ) vl_dia5,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='06' THEN v.vl_consumo  ELSE 0 END ) vl_dia6,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='07' THEN v.vl_consumo  ELSE 0 END ) vl_dia7,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='08' THEN v.vl_consumo  ELSE 0 END ) vl_dia8,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='09' THEN v.vl_consumo  ELSE 0 END ) vl_dia9,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='10' THEN v.vl_consumo  ELSE 0 END ) vl_dia10,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='11' THEN v.vl_consumo  ELSE 0 END ) vl_dia11,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='12' THEN v.vl_consumo  ELSE 0 END ) vl_dia12,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='13' THEN v.vl_consumo  ELSE 0 END ) vl_dia13,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='14' THEN v.vl_consumo  ELSE 0 END ) vl_dia14,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='15' THEN v.vl_consumo  ELSE 0 END ) vl_dia15,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='16' THEN v.vl_consumo  ELSE 0 END ) vl_dia16,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='17' THEN v.vl_consumo  ELSE 0 END ) vl_dia17,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='18' THEN v.vl_consumo  ELSE 0 END ) vl_dia18,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='19' THEN v.vl_consumo  ELSE 0 END ) vl_dia19,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='20' THEN v.vl_consumo  ELSE 0 END ) vl_dia20,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='21' THEN v.vl_consumo  ELSE 0 END ) vl_dia21,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='22' THEN v.vl_consumo  ELSE 0 END ) vl_dia22,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='23' THEN v.vl_consumo  ELSE 0 END ) vl_dia23,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='24' THEN v.vl_consumo  ELSE 0 END ) vl_dia24,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='25' THEN v.vl_consumo  ELSE 0 END ) vl_dia25,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='26' THEN v.vl_consumo  ELSE 0 END ) vl_dia26,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='27' THEN v.vl_consumo  ELSE 0 END ) vl_dia27,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='28' THEN v.vl_consumo  ELSE 0 END ) vl_dia28,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='29' THEN v.vl_consumo  ELSE 0 END ) vl_dia29,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='30' THEN v.vl_consumo  ELSE 0 END ) vl_dia30,
	sum(CASE WHEN to_char(m.dt_processo,'DD')='31' THEN v.vl_consumo  ELSE 0 END ) vl_dia31
from	movimento_estoque_v m,
	movimento_estoque_v2 v
where	m.nr_movimento_estoque = v.nr_movimento_estoque
and	m.dt_processo is not null
group by	m.dt_processo,
	m.cd_material_estoque,
	m.cd_estabelecimento,
	m.dt_mesano_referencia,
	m.cd_centro_custo,
	m.cd_local_estoque,
	m.cd_operacao_estoque) x
group by	x.cd_material_estoque,
	x.cd_estabelecimento,
	x.dt_mesano_referencia,
	x.cd_centro_custo,
	x.cd_local_estoque,
	x.cd_operacao_estoque,
	x.dt_processo;

