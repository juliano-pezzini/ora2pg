-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW scs_treinamento_philips_v2_v (dt_atividade, dt_fim_atividade, qt_minuto, qt_minutos_calculados, qt_horas_calculadas, ds_classificacao_funcao, nr_seq_grupo_funcao, ds_grupo, nr_seq_funcao, ds_atividade_funcao, nm_usuario_exec, ds_usuario_exec, cd_cargo_executor, ds_cargo_executor, cd_setor_executor, ds_setor_executor, nr_sequencia, nr_seq_ordem_serv) AS SELECT a.DT_ATIVIDADE Data Inicio Atividade,
    a.DT_FIM_ATIVIDADE Data Fim Atividade, 
    a.QT_MINUTO Tempo em Minutos, 
    round(((a.DT_FIM_ATIVIDADE-a.DT_ATIVIDADE)::numeric ) * 1440) Minutos Calculados, 
    round((a.QT_MINUTO/60)::numeric,4) Horas Calculadas, 
    CASE WHEN b.NR_SEQ_GRUPO_FUNCAO=2 THEN 'CB' WHEN b.NR_SEQ_GRUPO_FUNCAO=4 THEN 'CB' WHEN b.NR_SEQ_GRUPO_FUNCAO=6 THEN 'CB' WHEN b.NR_SEQ_GRUPO_FUNCAO=11 THEN 'CB' WHEN b.NR_SEQ_GRUPO_FUNCAO=7 THEN 'SUPT' WHEN b.NR_SEQ_GRUPO_FUNCAO=8 THEN 'SUPT' WHEN b.NR_SEQ_GRUPO_FUNCAO=9 THEN 'SUPT' WHEN b.NR_SEQ_GRUPO_FUNCAO=10 THEN 'ETTE' WHEN b.NR_SEQ_GRUPO_FUNCAO=5 THEN 'ADM' WHEN b.NR_SEQ_GRUPO_FUNCAO=13 THEN 'ADM' END  Classificação Atividade, 
    b.NR_SEQ_GRUPO_FUNCAO Código Grupo Atividade Função, 
    c.DS_GRUPO Descri Grupo Atividade Função, 
    a.NR_SEQ_FUNCAO Código Atividade Função, 
    substr(obter_desc_tipo_funcao(a.nr_seq_funcao),1,225) Descrição Atividade Função, 
    a.NM_USUARIO_EXEC Login Executor, 
    obter_nome_usuario(a.nm_usuario_exec) Nome Usuário Executor, 
    SubStr(obter_dados_usuario_opcao(a.nm_usuario_exec,'R'),1,255) Código Cargo, 
    SubStr(obter_cargo_usuario(a.nm_usuario_exec),1,255) Descrição Cargo, 
    SubStr(obter_dados_usuario_opcao(a.nm_usuario_exec,'S'),1,255) Código Setor, 
    SubStr(obter_dados_usuario_opcao(a.nm_usuario_exec,'DS'),1,255) Descrição Setor, 
    a.NR_SEQUENCIA, 
    a.NR_SEQ_ORDEM_SERV 
FROM MAN_ORDEM_SERV_ATIV a, 
   man_tipo_funcao b, 
   man_grupo_funcao c 
WHERE a.nr_seq_funcao = b.nr_sequencia 
AND  b.nr_seq_grupo_funcao = c.nr_sequencia;

