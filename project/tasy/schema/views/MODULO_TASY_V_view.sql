-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW modulo_tasy_v (nr_sequencia, cd_aplicacao_tasy, nm_modulo, dt_atualizacao, nm_usuario, nr_seq_superior, nr_seq_apresent, dt_atualizacao_nrec, nm_usuario_nrec, cd_exp_modulo, nivel, ds_modulo) AS WITH RECURSIVE cte AS (
SELECT A.NR_SEQUENCIA,A.CD_APLICACAO_TASY,A.NM_MODULO,A.DT_ATUALIZACAO,A.NM_USUARIO,A.NR_SEQ_SUPERIOR,A.NR_SEQ_APRESENT,A.DT_ATUALIZACAO_NREC,A.NM_USUARIO_NREC,A.CD_EXP_MODULO,1 NIVEL,substr(Lpad(' ',3*(1-1)) || obter_desc_expressao(A.cd_exp_modulo, A.nm_modulo), 1, 60) ds_modulo
 FROM MODULO_TASY A WHERE A.NR_SEQ_SUPERIOR IS NULL
  UNION ALL
SELECT A.NR_SEQUENCIA,A.CD_APLICACAO_TASY,A.NM_MODULO,A.DT_ATUALIZACAO,A.NM_USUARIO,A.NR_SEQ_SUPERIOR,A.NR_SEQ_APRESENT,A.DT_ATUALIZACAO_NREC,A.NM_USUARIO_NREC,A.CD_EXP_MODULO,(c.level+1) NIVEL,substr(Lpad(' ',3*((c.level+1)-1)) || obter_desc_expressao(A.cd_exp_modulo, A.nm_modulo), 1, 60) ds_modulo
 FROM MODULO_TASY A JOIN cte c ON (c.NR_SEQUENCIA = A.NR_SEQ_SUPERIOR)

) SELECT * FROM cte;


