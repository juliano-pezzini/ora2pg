-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ind_treinamento_philips_v (ds_classif, ds_grupo, ds_tipo_funcao, qt_minuto, qt_horas, dt_atividade, nm_usuario_exec, nr_seq_funcao, cd_grupo) AS select	'Produtivas' ds_classif,
         c.ds_grupo,
        substr(obter_desc_tipo_funcao(a.nr_seq_funcao),1,100) ds_tipo_funcao,
	      a.qt_minuto,
	      ((a.qt_minuto)/60) qt_horas,
        a.dt_atividade,
        a.nm_usuario_exec,
        a.nr_seq_funcao,
        c.nr_sequencia cd_grupo
FROM	  man_ordem_servico_v v,
	      man_ordem_serv_ativ a,
        man_tipo_funcao b,
        man_grupo_funcao c
where	  v.nr_sequencia    = a.nr_seq_ordem_serv
AND     a.nr_seq_funcao = b.nr_sequencia
AND     b.nr_seq_grupo_funcao = c.nr_sequencia
AND     c.nr_sequencia IN (2,4,6,11)

UNION ALL

select	'Apoio' ds_classif,
         c.ds_grupo,
        substr(obter_desc_tipo_funcao(a.nr_seq_funcao),1,100) ds_tipo_funcao,
	     a.qt_minuto,
	      ((a.qt_minuto)/60) qt_horas,
         a.dt_atividade,
         a.nm_usuario_exec,
         a.nr_seq_funcao,
        c.nr_sequencia cd_grupo
from	man_ordem_servico_v v,
	    man_ordem_serv_ativ a,
      man_tipo_funcao b,
      man_grupo_funcao c
where	v.nr_sequencia    = a.nr_seq_ordem_serv
AND   a.nr_seq_funcao = b.nr_sequencia
AND     b.nr_seq_grupo_funcao = c.nr_sequencia
AND   c.nr_sequencia IN (7,8,9)

UNION ALL

select	'Treinamento - Capacita??o do Instrutor' ds_classif,
        c.ds_grupo,
        substr(obter_desc_tipo_funcao(a.nr_seq_funcao),1,100) ds_tipo_funcao,
        a.qt_minuto,
	      ((a.qt_minuto)/60) qt_horas,
        a.dt_atividade,
        a.nm_usuario_exec,
        a.nr_seq_funcao,
        c.nr_sequencia cd_grupo
from	man_ordem_servico_v v,
	    man_ordem_serv_ativ a,
      man_tipo_funcao b,
      man_grupo_funcao c
where	v.nr_sequencia    = a.nr_seq_ordem_serv
AND   a.nr_seq_funcao = b.nr_sequencia
AND     b.nr_seq_grupo_funcao = c.nr_sequencia
AND   c.nr_sequencia IN (10)

UNION ALL

select	'Administrativo' ds_classif,
        c.ds_grupo,
        substr(obter_desc_tipo_funcao(a.nr_seq_funcao),1,100) ds_tipo_funcao,
	       a.qt_minuto,
	      ((a.qt_minuto)/60) qt_horas,
        a.dt_atividade,
        a.nm_usuario_exec,
        a.nr_seq_funcao,
        c.nr_sequencia cd_grupo
from	man_ordem_servico_v v,
	    man_ordem_serv_ativ a,
      man_tipo_funcao b,
      man_grupo_funcao c
where	v.nr_sequencia    = a.nr_seq_ordem_serv
AND   a.nr_seq_funcao = b.nr_sequencia
AND     b.nr_seq_grupo_funcao = c.nr_sequencia
AND   c.nr_sequencia IN (5,13)
ORDER BY 1;

