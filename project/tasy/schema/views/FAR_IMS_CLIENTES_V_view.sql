-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW far_ims_clientes_v (tp_registro, fixo_1, cd_ims, ds_razao_social, cd_cgc, dt_inicial, dt_final, dt_arquivo, fixo_2, ds_branco, cd_interno_ims, cd_pessoa_fisica, cd_documento, ds_flag, nm_fantasia, ds_flag_endereco, ds_endereco, ds_complemento, cd_cep, ds_cidade, sg_estado, nr_telefone, ds_fax, dt_cadastro, ds_email, ds_url, qt_registro) AS select	'1' tp_registro,
	'0' fixo_1,
	'????'cd_ims,
	substr(obter_razao_social(obter_cgc_estabelecimento(1)),1,30) ds_razao_social,
	substr(obter_cgc_estabelecimento(1),1,14) cd_cgc,
	to_char(LOCALTIMESTAMP,'ddmmyyyy') dt_inicial,
	to_char(LOCALTIMESTAMP,'ddmmyyyy') dt_final,
	to_char(LOCALTIMESTAMP,'ddmmyyyy') dt_arquivo,
	'1' fixo_2,
	'                                                                                                                                                                                                                                                                               'ds_branco,
	'imsbrcli1' cd_interno_ims,
	'' cd_pessoa_fisica,
	'' cd_documento,
	'' ds_flag,
	'' nm_fantasia,
	'' ds_flag_endereco,
	'' ds_endereco,
	'' ds_complemento,
	'' cd_cep,
	'' ds_cidade,
	'' sg_estado,
	'' nr_telefone,
	'' ds_fax,
	'' dt_cadastro,
	'' ds_email,
	'' ds_url,
	'' qt_registro


union all

select	'2' tp_registro,
	'0' fixo_1,
	'????'cd_ims,
	substr(a.nm_pessoa_fisica,1,40) ds_razao_social,
	'' cd_cgc,
	to_char(LOCALTIMESTAMP,'ddmmyyyy') dt_inicial,
	to_char(LOCALTIMESTAMP,'ddmmyyyy') dt_final,
	to_char(LOCALTIMESTAMP,'ddmmyyyy') dt_arquivo,
	'1' fixo_2,
	'     'ds_branco,
	'C' cd_interno_ims,
	lpad(a.cd_pessoa_fisica,14,0) cd_pessoa_fisica,
	lpad(a.nr_cpf,14,0) cd_documento,
	'2' ds_flag,
	substr(a.nm_pessoa_fisica,1,40) nm_fantasia,
	'1' ds_flag_endereco,
	substr(c.ds_endereco ||', '|| c.nr_endereco,1,70) ds_endereco,
	substr(c.ds_complemento,1,20) ds_complemento,
	c.cd_cep,
	substr(c.ds_municipio,1,30) ds_cidade,
	c.sg_estado,
	c.nr_telefone,
	substr(c.ds_fax,1,20) ds_fax,
	to_char(a.dt_atualizacao_nrec,'ddmmyyyy') dt_cadastro,
	substr(c.ds_email,1,35) ds_email,
	substr(c.ds_email,1,35) ds_url,
	'' qt_registro
from	pessoa_fisica a,
	compl_pessoa_fisica c
where	a.cd_pessoa_fisica = c.cd_pessoa_fisica
and	c.ie_tipo_complemento = 1

union all

select	'3' tp_registro,
	'0' fixo_1,
	'????'cd_ims,
	'' ds_razao_social,
	'' cd_cgc,
	to_char(LOCALTIMESTAMP,'ddmmyyyy') dt_inicial,
	to_char(LOCALTIMESTAMP,'ddmmyyyy') dt_final,
	to_char(LOCALTIMESTAMP,'ddmmyyyy') dt_arquivo,
	'' fixo_2,
	'                                                                                                                                                                                                                                                                                                                                            'ds_branco,
	'imsbrcli3' cd_interno_ims,
	'' cd_pessoa_fisica,
	'' cd_documento,
	'' ds_flag,
	'' nm_fantasia,
	'' ds_flag_endereco,
	'' ds_endereco,
	'' ds_complemento,
	'' cd_cep,
	'' ds_cidade,
	'' sg_estado,
	'' nr_telefone,
	'' ds_fax,
	'' dt_cadastro,
	'' ds_email,
	'' ds_url,
	'000000000' qt_registro
 LIMIT 199;

