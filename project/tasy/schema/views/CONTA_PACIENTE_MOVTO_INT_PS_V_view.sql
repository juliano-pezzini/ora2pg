-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW conta_paciente_movto_int_ps_v (ie_emite_conta, nr_atendimento, nr_sequencia, cd_setor_atendimento, cd_unidade_basica, cd_unidade_compl, cd_unidade, dt_entrada_unidade, cd_tipo_acomodacao, dt_saida_unidade, nr_atend_dia, ds_observacao, nm_usuario_original, dt_saida_interno, ie_passagem_setor, nr_acompanhante, nr_seq_interno, ds_setor_atendimento, nm_unidade, cd_classif_setor, ds_classif_setor, ds_tipo_acomodacao, nr_interno_conta) AS SELECT '203' IE_EMITE_CONTA,
	 A.NR_ATENDIMENTO,
	 A.NR_SEQUENCIA,
       A.CD_SETOR_ATENDIMENTO,
	 A.CD_UNIDADE_BASICA,
	 A.CD_UNIDADE_COMPL,
      (A.CD_UNIDADE_BASICA || '/' || A.CD_UNIDADE_COMPL) cd_unidade,
       A.DT_ENTRADA_UNIDADE,
	 A.CD_TIPO_ACOMODACAO,
       A.DT_SAIDA_UNIDADE,
	 A.NR_ATEND_DIA,
       A.DS_OBSERVACAO,
	 A.NM_USUARIO_ORIGINAL,
	 A.DT_SAIDA_INTERNO,
	 A.IE_PASSAGEM_SETOR,
	 A.NR_ACOMPANHANTE,
	 A.NR_SEQ_INTERNO,
       B.DS_SETOR_ATENDIMENTO,
      (B.NM_UNIDADE_BASICA || '/'||B.NM_UNIDADE_COMPL)   nm_unidade,
       B.CD_CLASSIF_SETOR,
	 OBTER_VALOR_DOMINIO(1,B.CD_CLASSIF_SETOR) DS_CLASSIF_SETOR,
       C.DS_TIPO_ACOMODACAO,
	 D.NR_INTERNO_CONTA
FROM  TIPO_ACOMODACAO C,
	SETOR_ATENDIMENTO B,
	ATEND_PACIENTE_UNIDADE A,
	CONTA_PACIENTE D
WHERE A.CD_SETOR_ATENDIMENTO = B.CD_SETOR_ATENDIMENTO
  AND A.CD_TIPO_ACOMODACAO   = C.CD_TIPO_ACOMODACAO
  AND A.NR_ATENDIMENTO = D.NR_ATENDIMENTO
  and B.cd_classif_setor in (1,3);

