-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW reg_test_case_validation_v (ds_area, crs_id, nr_customer_requirement, ds_customer_requirement, ds_crs_title, nr_seq_caso_teste, usuario_criacao, ds_caso_teste, ds_pre_condicao, nr_ordenacao, nr_seq_acao_teste, ds_passo, ds_funcionalidade, ds_resultado, cd_versao, nr_seq_revisao, ie_tipo_revisao, dt_revisao, ct_validation_id, ds_tc, ds_titulo, ds_titulo_formatado) AS select  distinct
        r.ds_area
        ,r.Crs_Id
        ,r.Nr_Customer_Requirement
        ,r.Ds_Customer_Requirement
        ,r.Ds_Crs_Title
        ,t.Nr_Sequencia nr_seq_caso_teste
        ,CASE WHEN Obter_Nome_Usuario(t.Nm_Usuario_Nrec) IS NULL THEN 'WHEB:'||t.Nm_Usuario_Nrec  ELSE Obter_Nome_Usuario(t.Nm_Usuario_Nrec) END   USUARIO_CRIACAO
        ,t.Ds_Descricao ds_caso_teste
        ,t.Ds_Pre_Condicao
        ,a.Nr_Ordenacao
        ,a.Nr_Sequencia nr_seq_acao_teste
        ,a.Ds_Passo
        ,a.Ds_Funcionalidade
        ,a.Ds_Resultado
        ,t.Cd_Versao
        ,t.Nr_Seq_Revisao
        ,t.Ie_Tipo_Revisao
        ,t.Dt_Revisao
        ,'TASY_VTC_'||t.Nr_Sequencia CT_VALIDATION_ID
        ,'TASY_VTC_'||t.Nr_Sequencia||' - '||  t.Ds_Descricao ds_tc
        ,'TASY_VTC_'||t.Nr_Sequencia||' - '||  t.Ds_Descricao || chr(13)  || 'Pre condition: ' || t.Ds_Pre_Condicao ds_titulo
        ,Obter_DS_Formatada_Regulatorio( 'TASY_VTC_'||t.Nr_Sequencia||' - '||  t.Ds_Descricao || chr(13)  || 'Pre condition: ' || t.Ds_Pre_Condicao, t.ie_tipo_revisao) ds_titulo_formatado
FROM    Reg_Caso_Teste t,
        reg_acao_teste a,
        ( select  distinct v.Crs_Id
                  ,v.Nr_Customer_Requirement
                  ,v.Ds_Customer_Requirement
                  ,v.Ds_Crs_Title
                  ,v.ds_area
           from   Reg_Product_Requirement_v v ) r;

