-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW bft_encounter_movement_v (point_of_care, external_department_id, department_name, department_id, room_id, bed_id, movement_id, department_admit_date, department_exit_date, monitored_bed, encounter_id, patient_id, medical_department_id, medical_department_name) AS SELECT  Obter_point_of_care(a.cd_setor_atendimento,a.cd_unidade_basica,a.cd_unidade_compl) point_of_care,
	b.cd_setor_externo external_department_id,
	b.ds_setor_atendimento department_name,
 	b.cd_setor_atendimento department_id,
	a.cd_unidade_basica room_id,
	trim(both a.cd_unidade_compl) bed_id,
     	a.nr_seq_interno movement_id,
	a.dt_entrada_unidade department_admit_date,
	a.dt_saida_unidade department_exit_date,
	c.ie_leito_monitorado monitored_bed,
	a.NR_ATENDIMENTO encounter_id,
    OBTER_PESSOA_ATENDIMENTO(a.NR_ATENDIMENTO , 'C') patient_id,
	a.cd_departamento medical_department_id,
	obter_nome_departamento_medico(a.cd_departamento) medical_department_name
FROM	atend_paciente_unidade a,
        setor_atendimento b,
        unidade_atendimento c
where	a.cd_setor_atendimento = b.cd_setor_atendimento
and     a.cd_setor_atendimento = c.cd_setor_atendimento
and     a.cd_unidade_basica    = c.cd_unidade_basica
and     a.cd_unidade_compl     = c.cd_unidade_compl;

