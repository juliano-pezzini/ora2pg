-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW bft_vaccine_v (encounter_id, vaccine_code, vaccine_description, dose, dose_desc, release_date, adverse_reaction, notes, doctor_code, doctor_given_name, doctor_last_name, doctor_middle_name) AS select	a.nr_atendimento encounter_id,
	a.nr_seq_vacina vaccine_code,
	b.ds_vacina vaccine_description,
	a.ie_dose dose,
	substr(obter_valor_dominio_idioma(1018,a.ie_dose,wheb_usuario_pck.get_nr_seq_idioma),1,255) dose_desc,
	a.dt_liberacao release_date,
	a.ds_reacao_adversa adverse_reaction,
	a.ds_observacao notes,
	coalesce(a.cd_profissional, a.nm_usuario) doctor_code,
	obter_dados_pf(coalesce(a.cd_profissional, a.nm_usuario),'PNG') doctor_given_name,
	obter_dados_pf(coalesce(a.cd_profissional, a.nm_usuario),'PNL') doctor_last_name,
	obter_dados_pf(coalesce(a.cd_profissional, a.nm_usuario),'PNM') doctor_middle_name
FROM	paciente_vacina a, vacina b
where	a.nr_seq_vacina = b.nr_sequencia
and	a.dt_liberacao is not null
and	a.dt_inativacao is null;

