-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_tributo_v (cd_tributo, ds_tributo, ie_tipo_tributo, cd_retencao, ie_gerar_titulo_pagar, ie_situacao, ie_vencimento, ie_apuracao_piso, ie_restringe_estab, ie_baixa_titulo, ie_corpo_item, ie_repasse_titulo, ie_pf_pj, cd_estabelecimento, nr_ordem) AS select	a.cd_tributo,
	a.ds_tributo,
	a.ie_tipo_tributo,
	a.cd_retencao,
	a.ie_gerar_titulo_pagar,
	a.ie_situacao,
	a.ie_vencimento,
	coalesce(a.ie_apuracao_piso, 'N') ie_apuracao_piso,
	coalesce(a.ie_restringe_estab, 'N') ie_restringe_estab,
	coalesce(a.ie_baixa_titulo, 'N') ie_baixa_titulo,
	a.ie_corpo_item,
	a.ie_repasse_titulo,
	a.ie_pf_pj,
	coalesce(a.cd_estabelecimento, -1) cd_estabelecimento,
	CASE WHEN a.ie_tipo_tributo='INSS' THEN  1 WHEN a.ie_tipo_tributo='IR' THEN  2  ELSE 3 END  nr_ordem
FROM	tributo a
where	exists (	select	1
		from	tributo_conta_pagar b
		where	b.cd_tributo = a.cd_tributo
		and	b.ie_producao_medica in ('A', 'S'));

