-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_movto_contab_mensalidade_v (ds_status, ie_status, nr_seq_item_mensalidade, cd_conta_rec, cd_conta_deb, cd_conta_ato_cooperado, cd_conta_ato_auxiliar, cd_conta_ato_nao_coop, cd_classif_cred, cd_classif_deb, cd_classif_cooperado, cd_classif_ato_auxiliar, cd_classif_nao_cooperado, nr_seq_esquema, nr_seq_esquema_rec, nr_sequencia, ds_tipo_item, ds_conta_cred, ds_conta_deb, ds_conta_ato_cooperado, ds_conta_ato_auxiliar, ds_conta_ato_nao_coop, nr_seq_mensalidade_seg, nr_seq_atualizacao, ds_tipo_movimento) AS select	substr((select	ds_valor_dominio
		FROM 	valor_dominio
		where 	cd_dominio	= 5260
		and	vl_dominio	= a.ie_status),1,255) ds_status,
	a.ie_status,
	a.nr_seq_item_mensalidade,
	b.cd_conta_rec,
	b.cd_conta_deb,
	b.cd_conta_ato_cooperado,
	b.cd_conta_ato_auxiliar,
	b.cd_conta_ato_nao_coop,
	b.cd_classif_cred,
	b.cd_classif_deb,
	b.cd_classif_cooperado,
	b.cd_classif_ato_auxiliar,
	b.cd_classif_nao_cooperado,
	b.nr_seq_esquema,
	b.nr_seq_esquema_rec,
	a.nr_sequencia,
	substr((select	ds_valor_dominio
		from 	valor_dominio
		where 	cd_dominio	= 1930
		and	vl_dominio	= b.ie_tipo_item),1,255) ds_tipo_item,
	substr((select	ds_conta_contabil
		from	conta_contabil
		where	cd_conta_contabil = b.cd_conta_rec),1,255) ds_conta_cred,
	substr((select	ds_conta_contabil
		from	conta_contabil
		where	cd_conta_contabil = b.cd_conta_deb),1,255) ds_conta_deb,
	substr((select	ds_conta_contabil
		from	conta_contabil
		where	cd_conta_contabil = b.cd_conta_ato_cooperado),1,255) ds_conta_ato_cooperado,
	substr((select	ds_conta_contabil
		from	conta_contabil
		where	cd_conta_contabil = b.cd_conta_ato_auxiliar),1,255) ds_conta_ato_auxiliar,
	substr((select	ds_conta_contabil
		from	conta_contabil
		where	cd_conta_contabil = b.cd_conta_ato_nao_coop),1,255) ds_conta_ato_nao_coop,
	b.nr_seq_mensalidade_seg,
	a.nr_seq_atualizacao,
	substr(CASE WHEN a.ie_tipo_movimento=1 THEN obter_desc_expressao(755504) WHEN a.ie_tipo_movimento=2 THEN obter_desc_expressao(725608) END ,1,255) ds_tipo_movimento
from	pls_movimento_contabil		a,
	pls_mensalidade_seg_item	b
where	a.nr_seq_item_mensalidade	= b.nr_sequencia
and	b.ie_tipo_item not in ('3', '6', '7')

union all

select	substr((select	ds_valor_dominio
		from 	valor_dominio
		where 	cd_dominio	= 5260
		and	vl_dominio	= a.ie_status),1,255) ds_status,
	a.ie_status,
	a.nr_seq_item_mensalidade,
	c.cd_conta_cred,
	c.cd_conta_deb,
	null cd_conta_ato_cooperado,
	null cd_conta_ato_auxiliar,
	null cd_conta_ato_nao_coop,
	c.cd_classif_cred,
	c.cd_classif_deb,
	null cd_classif_cooperado,
	null cd_classif_ato_auxiliar,
	null cd_classif_nao_cooperado,
	b.nr_seq_esquema,
	b.nr_seq_esquema_rec,
	a.nr_sequencia,
	substr((select	ds_valor_dominio
		from 	valor_dominio
		where 	cd_dominio	= 1930
		and	vl_dominio	= b.ie_tipo_item),1,255) ds_tipo_item,
	substr((select	ds_conta_contabil
		from	conta_contabil
		where	cd_conta_contabil = c.cd_conta_cred),1,255) ds_conta_cred,
	substr((select	ds_conta_contabil
		from	conta_contabil
		where	cd_conta_contabil = c.cd_conta_deb),1,255) ds_conta_deb,
	null ds_conta_ato_cooperado,
	null ds_conta_ato_auxiliar,
	null ds_conta_ato_nao_coop,
	b.nr_seq_mensalidade_seg,
	a.nr_seq_atualizacao,
	substr(CASE WHEN a.ie_tipo_movimento=1 THEN obter_desc_expressao(755504) WHEN a.ie_tipo_movimento=2 THEN obter_desc_expressao(725608) END ,1,255) ds_tipo_movimento
from	pls_conta_coparticipacao	c,
	pls_movimento_contabil		a,
	pls_mensalidade_seg_item	b
where	b.nr_sequencia	= a.nr_seq_item_mensalidade
and	c.nr_seq_conta	= b.nr_seq_conta
and	c.nr_sequencia	= a.nr_seq_conta_copartic
and	b.ie_tipo_item = '3'

union all

select	substr((select	ds_valor_dominio
		from 	valor_dominio
		where 	cd_dominio	= 5260
		and	vl_dominio	= a.ie_status),1,255) ds_status,
	a.ie_status,
	a.nr_seq_item_mensalidade,
	c.cd_conta_cred,
	c.cd_conta_deb,
	null cd_conta_ato_cooperado,
	null cd_conta_ato_auxiliar,
	null cd_conta_ato_nao_coop,
	c.cd_classif_cred,
	c.cd_classif_deb,
	null cd_classif_cooperado,
	null cd_classif_ato_auxiliar,
	null cd_classif_nao_cooperado,
	b.nr_seq_esquema,
	b.nr_seq_esquema_rec,
	a.nr_sequencia,
	substr((select	ds_valor_dominio
		from 	valor_dominio
		where 	cd_dominio	= 1930
		and	vl_dominio	= b.ie_tipo_item),1,255) ds_tipo_item,
	substr((select	ds_conta_contabil
		from	conta_contabil
		where	cd_conta_contabil = c.cd_conta_cred),1,255) ds_conta_cred,
	substr((select	ds_conta_contabil
		from	conta_contabil
		where	cd_conta_contabil = c.cd_conta_deb),1,255) ds_conta_deb,
	null ds_conta_ato_cooperado,
	null ds_conta_ato_auxiliar,
	null ds_conta_ato_nao_coop,
	b.nr_seq_mensalidade_seg,
	a.nr_seq_atualizacao,
	substr(CASE WHEN a.ie_tipo_movimento=1 THEN obter_desc_expressao(755504) WHEN a.ie_tipo_movimento=2 THEN obter_desc_expressao(725608) END ,1,255) ds_tipo_movimento
from	pls_conta_pos_estabelecido	c,
	pls_movimento_contabil		a,
	pls_mensalidade_seg_item	b
where	b.nr_sequencia	= a.nr_seq_item_mensalidade
and	c.nr_seq_conta	= b.nr_seq_conta
and	c.nr_sequencia	= a.nr_seq_conta_pos_estab
and	b.ie_tipo_item in ('6', '7');

