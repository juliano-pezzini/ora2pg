-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW titulo_receber_vencto_v (dt_vencimento, cd_estabelecimento, cd_convenio, ds_convenio, vl_total_convenio, vl_vencer_quinze, vl_vencer_trinta, vl_vencer_sessenta, vl_vencer_noventa, vl_vencer_acima_nov, vl_vencido_quinze, vl_vencido_trinta, vl_vencido_sessenta, vl_vencido_noventa, vl_vencido_acima_nov, vl_total_vencer, vl_total_vencido) AS select	a.dt_vencimento,
	a.cd_estabelecimento, 
	CASE WHEN ie_convenio_tit_rec='P' THEN  CASE WHEN ie_origem_titulo='O' THEN  cd_cgc  ELSE cd_convenio END   ELSE cd_convenio END  cd_convenio, 
	CASE WHEN ie_convenio_tit_rec='P' THEN  CASE WHEN ie_origem_titulo='O' THEN  obter_nome_pf_pj(null, cd_cgc)  ELSE obter_nome_convenio(a.cd_convenio) END   ELSE obter_nome_convenio(a.cd_convenio) END  ds_convenio, 
	sum(a.vl_saldo_titulo) vl_total_convenio, 
	sum(CASE WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=1 THEN  a.vl_saldo_titulo  ELSE 0 END ) vl_vencer_quinze, 
	sum(CASE WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=2 THEN  a.vl_saldo_titulo  ELSE 0 END ) vl_vencer_trinta, 
	sum(CASE WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=3 THEN  a.vl_saldo_titulo  ELSE 0 END ) vl_vencer_sessenta, 
	sum(CASE WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=4 THEN  a.vl_saldo_titulo  ELSE 0 END ) vl_vencer_noventa, 
	sum(CASE WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=5 THEN  a.vl_saldo_titulo  ELSE 0 END ) vl_vencer_acima_nov, 
	sum(CASE WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=6 THEN  a.vl_saldo_titulo  ELSE 0 END ) vl_vencido_quinze, 
	sum(CASE WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=7 THEN  a.vl_saldo_titulo  ELSE 0 END ) vl_vencido_trinta, 
	sum(CASE WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=8 THEN  a.vl_saldo_titulo  ELSE 0 END ) vl_vencido_Sessenta, 
	sum(CASE WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=9 THEN  a.vl_saldo_titulo  ELSE 0 END ) vl_vencido_Noventa, 
	sum(CASE WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=10 THEN  a.vl_saldo_titulo  ELSE 0 END ) vl_vencido_Acima_Nov, 
	sum(CASE WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=1 THEN  a.vl_saldo_titulo WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=2 THEN  a.vl_saldo_titulo WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=3 THEN  a.vl_saldo_titulo WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=4 THEN  a.vl_saldo_titulo WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=5 THEN  a.vl_saldo_titulo  ELSE 0 END ) vl_total_vencer, 
	sum(CASE WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=6 THEN  a.vl_saldo_titulo WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=7 THEN  a.vl_saldo_titulo WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=8 THEN  a.vl_saldo_titulo WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=9 THEN  a.vl_saldo_titulo WHEN EIS_OBTER_TIPO_VENCTO_TITULO(a.nr_titulo, a.dt_vencimento)=10 THEN  a.vl_saldo_titulo  ELSE 0 END ) vl_total_Vencido 
FROM	titulo_receber_v a, 
	eis_parametro 
group by a.dt_vencimento, 
	a.cd_estabelecimento, 
	CASE WHEN ie_convenio_tit_rec='P' THEN  CASE WHEN ie_origem_titulo='O' THEN  cd_cgc  ELSE cd_convenio END   ELSE cd_convenio END , 
	CASE WHEN ie_convenio_tit_rec='P' THEN  CASE WHEN ie_origem_titulo='O' THEN  obter_nome_pf_pj(null, cd_cgc)  ELSE obter_nome_convenio(a.cd_convenio) END   ELSE obter_nome_convenio(a.cd_convenio) END;

