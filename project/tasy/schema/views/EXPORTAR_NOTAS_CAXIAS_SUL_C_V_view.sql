-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW exportar_notas_caxias_sul_c_v (tp_registro, cnpj_contribuinte, periodo_emissao, nr_funcionarios, vl_folha_pagamento, vl_faturamento_total, nm_responsavel, cpf_responsavel, nr_telefone, ie_entrada_saida, cd_especie, cd_serie_nota, nr_nota_fiscal, ie_situacao, cd_cpf_cnpj_prestador, cd_cpf_cnpj_tomador, dt_emissao, vl_total_nota, vl_deducoes, vl_aliquota, ie_iss_retido, cd_atividade, cd_estabelecimento, ie_tipo_nota, cd_operacao_nf, cd_natureza_operacao, cd_cgc_emitente, cd_serie_nf) AS select 	1 tp_registro,
	substr(cd_cgc,1,15) cnpj_contribuinte, 
	'' periodo_emissao, 
	'' nr_funcionarios, 
	'' vl_folha_pagamento, 
	'' vl_faturamento_total, 
	'' nm_responsavel, 
	'' cpf_responsavel, 
	'' nr_telefone, 
	'' ie_entrada_saida, 
	'' cd_especie, 
	'' cd_serie_nota, 
	'' nr_nota_fiscal, 
	'' ie_situacao, 
	'' cd_cpf_cnpj_prestador, 
	'' cd_cpf_cnpj_tomador, 
	'' dt_emissao, 
	'' vl_total_nota, 
	'' vl_deducoes, 
	'' vl_aliquota, 
	'' ie_iss_retido, 
	'' cd_atividade,  
	cd_estabelecimento, 
    '' ie_tipo_nota, 
	0 cd_operacao_nf, 
	0 cd_natureza_operacao, 
	'' cd_cgc_emitente, 
	'' cd_serie_nf 
FROM  estabelecimento 

union all
 
select 	2 tp_registro, 
	'' cnpj_contribuinte, 
	'' periodo_emissao, 
	'' nr_funcionarios, 
	'' vl_folha_pagamento, 
	'' vl_faturamento_total, 
	'' nm_responsavel, 
	'' cpf_responsavel, 
	'' nr_telefone, 
	'' ie_entrada_saida, 
	'' cd_especie, 
	'' cd_serie_nota, 
	'' nr_nota_fiscal, 
	'' ie_situacao, 
	'' cd_cpf_cnpj_prestador, 
	'' cd_cpf_cnpj_tomador, 
	'' dt_emissao, 
	'' vl_total_nota, 
	'' vl_deducoes, 
	'' vl_aliquota, 
	'' ie_iss_retido, 
	'' cd_atividade,  
	cd_estabelecimento, 
    '' ie_tipo_nota, 
	0 cd_operacao_nf, 
	0 cd_natureza_operacao, 
	'' cd_cgc_emitente, 
	'' cd_serie_nf 
from  estabelecimento 

union all
 
select 	3 tp_registro, 
	'' cnpj_contribuinte, 
	'' periodo_emissao, 
	'0' nr_funcionarios,    
	'' vl_folha_pagamento, 
	'' vl_faturamento_total, 
	'' nm_responsavel, 
	'' cpf_responsavel, 
	'' nr_telefone, 
	'' ie_entrada_saida, 
	'' cd_especie, 
	'' cd_serie_nota, 
	'' nr_nota_fiscal, 
	'' ie_situacao, 
	'' cd_cpf_cnpj_prestador, 
	'' cd_cpf_cnpj_tomador, 
	'' dt_emissao, 
	'' vl_total_nota, 
	'' vl_deducoes, 
	'' vl_aliquota, 
	'' ie_iss_retido, 
	'' cd_atividade,    
	cd_estabelecimento, 
    '' ie_tipo_nota, 
	0 cd_operacao_nf, 
	0 cd_natureza_operacao, 
	'' cd_cgc_emitente, 
	'' cd_serie_nf 
from  estabelecimento 

union all
 
select 	4 tp_registro, 
	'' cnpj_contribuinte, 
	'' periodo_emissao, 
	'' nr_funcionarios,    
	'0' vl_folha_pagamento, 
	'' vl_faturamento_total, 
	'' nm_responsavel, 
	'' cpf_responsavel, 
	'' nr_telefone, 
	'' ie_entrada_saida, 
	'' cd_especie, 
	'' cd_serie_nota, 
	'' nr_nota_fiscal, 
	'' ie_situacao, 
	'' cd_cpf_cnpj_prestador, 
	'' cd_cpf_cnpj_tomador, 
	'' dt_emissao, 
	'' vl_total_nota, 
	'' vl_deducoes, 
	'' vl_aliquota, 
	'' ie_iss_retido, 
	'' cd_atividade,    
	cd_estabelecimento, 
    '' ie_tipo_nota, 
	0 cd_operacao_nf, 
	0 cd_natureza_operacao, 
	'' cd_cgc_emitente, 
	'' cd_serie_nf	 
from  estabelecimento 

union all
 
select 	5 tp_registro, 
	'' cnpj_contribuinte, 
	'' periodo_emissao, 
	'' nr_funcionarios,    
	'' vl_folha_pagamento, 
	'0' vl_faturamento_total, 
	'' nm_responsavel, 
	'' cpf_responsavel, 
	'' nr_telefone, 
	'' ie_entrada_saida, 
	'' cd_especie, 
	'' cd_serie_nota, 
	'' nr_nota_fiscal, 
	'' ie_situacao, 
	'' cd_cpf_cnpj_prestador, 
	'' cd_cpf_cnpj_tomador, 
	'' dt_emissao, 
	'' vl_total_nota, 
	'' vl_deducoes, 
	'' vl_aliquota, 
	'' ie_iss_retido, 
	'' cd_atividade,    
	cd_estabelecimento, 
    '' ie_tipo_nota, 
	0 cd_operacao_nf, 
	0 cd_natureza_operacao, 
	'' cd_cgc_emitente, 
	'' cd_serie_nf 
from  estabelecimento 

union all
 
select 	6 tp_registro, 
	'' cnpj_contribuinte, 
	'' periodo_emissao, 
	'' nr_funcionarios,    
	'' vl_folha_pagamento, 
	'' vl_faturamento_total, 
	substr(obter_nome_pf(cd_pf_resp_tecnico),1,255) nm_responsavel, 
	'' cpf_responsavel, 
	'' nr_telefone, 
	'' ie_entrada_saida, 
	'' cd_especie, 
	'' cd_serie_nota, 
	'' nr_nota_fiscal, 
	'' ie_situacao, 
	'' cd_cpf_cnpj_prestador, 
	'' cd_cpf_cnpj_tomador, 
	'' dt_emissao, 
	'' vl_total_nota, 
   	'' vl_deducoes, 
	'' vl_aliquota, 
	'' ie_iss_retido, 
	'' cd_atividade,   
	cd_estabelecimento, 
    '' ie_tipo_nota, 
	0 cd_operacao_nf, 
	0 cd_natureza_operacao, 
	'' cd_cgc_emitente, 
	'' cd_serie_nf 
from  pessoa_juridica j, 
    estabelecimento e 
where e.cd_cgc = j.cd_cgc 

union all
 
select 	7 tp_registro, 
	'' cnpj_contribuinte, 
	'' periodo_emissao, 
	'' nr_funcionarios,    
	'' vl_folha_pagamento, 
	'' vl_faturamento_total, 
	'' nm_responsavel, 
	obter_dados_pf(cd_pf_resp_tecnico,'CPF')cpf_responsavel, 
	'' nr_telefone, 
	'' ie_entrada_saida, 
	'' cd_especie, 
   	'' cd_serie_nota, 
	'' nr_nota_fiscal, 
	'' ie_situacao, 
	'' cd_cpf_cnpj_prestador, 
	'' cd_cpf_cnpj_tomador, 
	'' dt_emissao, 
	'' vl_total_nota, 
	'' vl_deducoes, 
	'' vl_aliquota, 
	'' ie_iss_retido, 
	'' cd_atividade,   
	cd_estabelecimento, 
    '' ie_tipo_nota, 
	0 cd_operacao_nf, 
	0 cd_natureza_operacao, 
	'' cd_cgc_emitente, 
	'' cd_serie_nf 
from  pessoa_juridica j, 
    estabelecimento e 
where e.cd_cgc = j.cd_cgc 

union all
 
select	8 tp_registro, 
	'' cnpj_contribuinte, 
	'' periodo_emissao, 
	'' nr_funcionarios,    
	'' vl_folha_pagamento, 
	'' vl_faturamento_total, 
	'' nm_responsavel, 
	'' cpf_responsavel, 
	obter_dados_pf_pj(null,obter_cgc_estabelecimento(cd_estabelecimento),'T') nr_telefone, 
	'' ie_entrada_saida, 
	'' cd_especie, 
	'' cd_serie_nota, 
	'' nr_nota_fiscal, 
	'' ie_situacao, 
	'' cd_cpf_cnpj_prestador, 
	'' cd_cpf_cnpj_tomador, 
	'' dt_emissao, 
	'' vl_total_nota, 
	'' vl_deducoes, 
	'' vl_aliquota, 
	'' ie_iss_retido, 
	'' cd_atividade, 
	cd_estabelecimento, 
    '' ie_tipo_nota, 
	0 cd_operacao_nf, 
	0 cd_natureza_operacao, 
	'' cd_cgc_emitente, 
	'' cd_serie_nf 
from  estabelecimento;

