-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_ocupacao_hosp_pf_v (dt_referencia, cd_setor_atendimento, cd_unidade_basica, cd_unidade_compl, cd_unidade, ie_situacao, nr_pacientes, nr_obitos, nr_admissoes, nr_altas, ie_clinica, cd_convenio, cd_tipo_acomodacao, ds_convenio, ds_tipo_acomodacao, nm_paciente, cd_pessoa_fisica, nr_prontuario) AS SELECT 	A.DT_REFERENCIA,
 		A.CD_SETOR_ATENDIMENTO,
 		A.CD_UNIDADE_BASICA,
 		A.CD_UNIDADE_COMPL,
 		A.CD_UNIDADE_BASICA || ' ' || A.CD_UNIDADE_COMPL cd_unidade,
  		A.IE_SITUACAO,
 		A.NR_PACIENTES,
 		A.NR_OBITOS,
 		A.NR_ADMISSOES,
 		A.NR_ALTAS,
 		A.IE_CLINICA,
 		A.CD_CONVENIO,
 		A.CD_TIPO_ACOMODACAO,
        	V.DS_CONVENIO,
        	T.DS_TIPO_ACOMODACAO,
        	P.nm_pessoa_fisica nm_paciente,
		P.cd_pessoa_fisica,
		P.nr_prontuario
 FROM 	CONVENIO V,
      	TIPO_ACOMODACAO T,
      	PESSOA_FISICA P,
      	EIS_OCUPACAO_HOSPITALAR A
 WHERE 	 A.CD_PESSOA_FISICA   = P.CD_PESSOA_FISICA
      AND A.CD_CONVENIO        = V.CD_CONVENIO
      AND A.CD_TIPO_ACOMODACAO = T.CD_TIPO_ACOMODACAO;

