-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW w_eis_queda_distr_grav_v (cd_setor_queda, ds_setor_queda, dt_evento, cd_empresa, cd_estabelecimento, ds_unidade, ie_gravidade, ds_gravidade, nr_seq_local_queda, ds_local, nr_atendimento) AS select	distinct
	e.cd_setor_queda,
	substr(obter_nome_setor(e.cd_setor_queda),1,255) ds_Setor_Queda,
	b.dt_evento,
	f.cd_empresa,
	a.cd_estabelecimento,
	obter_unidade_atendimento(b.nr_atendimento,'A','U') ds_unidade,
	e.ie_gravidade,
	substr(obter_valor_dominio(4776,IE_GRAVIDADE),1,255) ds_gravidade,
	e.nr_seq_local_queda,
	substr(Obter_desc_result_queda(e.nr_seq_local_queda,'L'),1,80) ds_local,
	b.nr_atendimento
FROM	qua_evento_paciente b,
	QUEDA_FICHA_OCORRENCIA e,
	estabelecimento f,
	atendimento_paciente a
where	e.nr_seq_evento = b.nr_sequencia
and	a.nr_atendimento = b.nr_atendimento
and	b.dt_inativacao is null
and	a.cd_estabelecimento = f.cd_estabelecimento;

