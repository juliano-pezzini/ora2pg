-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW fluxo_caixa_diops_v (vl_realizado, ds_conta_estrut, cd_conta_apres, dt_referencia, ie_periodo, ie_ordem) AS select	/*01*/
	sum(a.vl_fluxo) vl_realizado,
	'Saldo Inicial' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	1 ie_ordem
FROM	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (250)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*03*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(+) Recebimento de Planos Saúde' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	3 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (261,266,268)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*04*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(+) Resgate de Aplicações Financeiras' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	4 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (299)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*05*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(+) Recebimento de Juros de Aplicações Financeiras' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	5 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (298)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*06*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(+) Outros Recebimentos Operacionais' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	6 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (274,313)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*07*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento a Fornecedores/Prestadores de Serviço de Saúde' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	7 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (323,354,367)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*08*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Comissões' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	8 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (0)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*09*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Pessoal' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	9 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (334)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*10*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Pró-Labore' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	10 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (329,330,331,332)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*11*/
	sum(CASE WHEN a.ie_classif_fluxo='p' THEN CASE WHEN a.cd_conta_financ=342 THEN a.vl_fluxo * -1  ELSE a.vl_fluxo END   ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Serviços Terceiros' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	11 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (342,351)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*12*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Tributos' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	12 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (379)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*13*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Contingências (Cíveis/Trabalhistas/Tributárias)' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	13 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (399)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*14*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Aluguel' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	14 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (370)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*15*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Promoção/Publicidade' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	15 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (376)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*16*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Aplicações Financeiras' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	16 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (421)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*17*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Outros Pagamentos Operacionais' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	17 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (333,351,431,436)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*18*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'Caixa Líquido das Atividades Operacionais' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	18 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (261,266,268,299,298,274,313,323,354,367,334,329,330,331,332,342,351,379,399,370,376,421,333,351,431,436)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*20*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(+) Recebimento de Venda de Ativo Imobilizado - Hospitalar' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	20 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (286)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*21*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(+) Recebimento de Venda de Ativo Imobilizado - Outros' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	21 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (0)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*22*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(+) Recebimento de Venda de Investimentos' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	22 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (291)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*23*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(+) Recebimento de Dividendos' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	23 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (0)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*24*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(+) Outros Recebimentos das Atividades de Investimento' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	24 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (0)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*25*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Aquisição de Ativo Imobilizado - Hospitalar' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	25 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (409)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*26*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Aquisição de Ativo Imobilizado - Outros' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	26 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (410)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*27*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento Relativos ao Ativo Intangível' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	27 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (411)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*28*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Aquisição de Participação em Outras Empresas' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	28 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (412)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*29*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Outros Pagamentos das Atividade de Investimento' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	29 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (413)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*30*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'Caixa Líquido das Atividades de Investimentos' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	30 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (286,291,409,410,411,412,413)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*32*/
	SUM(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(+) Integralização de Capital em Dinheiro' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	32 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (294)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*33*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(+) Recebimento - Empréstimos/Financiamentos' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	33 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (295,296)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*34*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(+) Títulos  Descontados' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	34 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (297)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*35*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(+) Outros Recebimentos da Atividade de Financiamento' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	35 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (300)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*36*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Juros - Empréstimos/Financiamentos/Leasing' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	36 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (416,417,418)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*37*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Amortização - Empréstimos/Financiamentos/Leasing' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	37 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (419,420)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*38*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Pagamento de Participação nos Resultados' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	38 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (423,424)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*39*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'(-) Outros Pagamentos da Atividade de Financiamento' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	39 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (422,425)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*40*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'Caixa Líquido das Atividades de Financiamento' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	40 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (294,295,296,297,300,416,417,418,419,420,423,424,422,425,444)
group by a.dt_referencia,
	a.ie_periodo

union

select	/*41*/
	sum(CASE WHEN a.ie_classif_fluxo='P' THEN a.vl_fluxo  ELSE 0 END ) vl_realizado,
	'Saldo Final' ds_conta_estrut,
	min(b.cd_conta_apres) cd_conta_apres,
	a.dt_referencia,
	a.ie_periodo,
	41 ie_ordem
from	conta_financeira_v b,
	fluxo_caixa a
where	a.cd_conta_financ = b.cd_conta_financ
and	a.cd_conta_financ  in (444)
group by a.dt_referencia,
	a.ie_periodo;

