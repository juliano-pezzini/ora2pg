-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW tws_w_pls_utilizacao_benef_v (nr_sequencia, dt_atualizacao, nr_seq_segurado, ds_procedimento, cd_procedimento, dt_realizacao, ds_prestador, nr_cpf, cd_cgc, ds_cbo, ds_municipio, vl_utilizacao, qt_utilizacao, ie_grupo_ans, nr_id_transacao) AS select nr_sequencia,
dt_atualizacao,
nr_seq_segurado,
substr(CASE WHEN cd_procedimento IS NULL THEN pls_obter_desc_material(nr_seq_material)  ELSE obter_desc_procedimento(cd_procedimento,ie_origem_proced) END ,1,255) ds_procedimento,
cd_procedimento,
dt_realizacao,
ds_prestador,
nr_cpf,
cd_cgc,
substr(cd_cbo||' - '||coalesce(pls_obter_desc_cbos(nr_seq_cbo_saude),'CBO desconhecido'),1,50)ds_cbo,
substr(obter_desc_municipio_ibge(cd_municipio_ibge),1,255)ds_municipio,
vl_utilizacao,
qt_utilizacao,
ie_grupo_ans,
nr_id_transacao
FROM w_pls_utilizacao_benef;

