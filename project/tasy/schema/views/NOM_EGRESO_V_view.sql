-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW nom_egreso_v (nr_sequencia, nm_usuario, dt_atualizacao, nm_usuario_nrec, dt_atualizacao_nrec, nr_atendimento, nm_medico, nr_folio, dt_alta, dt_entrada, qt_dias_estadia, ie_tipo_serv_mx, qt_horas_laboratorio, qt_horas_expulsao, qt_horas_recuperacao, qt_horas_terap_intensiva, qt_horas_terap_intermediaria, cd_procedencia, cd_cie10_afec_inicial, ds_codigo_prof, nr_seq_tipo_acidente, cd_lugar_acc, cd_derechohabiencia, cd_motivo_alta, cd_clues_estab_proced, cd_clues_estab_referido, cd_cie10_afec_principal, cd_cie10_causa_externa, ie_primeira_subsequente, ie_infecao_intra_hosp, ie_tipo_uni_psiq, ie_serv_psiq_cont, ie_serv_psiq_par, cd_serv_entrada_mx, cd_serv_sec_mx, cd_serv_ter_mx, cd_serv_alta_mx, cd_estado_unid_medica, cd_jurisdicao_unid_medica, cd_municipio_unid_medica, cd_localidade_unid_medica, cd_tipo_unid_medica, cd_clues_estab_saude, nr_seq_person_name, ie_tipo_idade, qt_idade, ie_sexo, qt_altura_cm, cd_curp, ie_indigina, ie_fala_lingua_indigena, cd_lingua_indigena, ie_fala_espanhol, qt_peso_kg, nr_spss, nr_spss_dv, cd_estado_res_hab, cd_municipio_res_hab, cd_localidade_res_hab, nr_prontuario, cd_cie10_afec_comorbidade, cd_sistema_ant_proc, cd_tipo_anestesia, ie_sala_cirurgia, nr_hora_duracao_real, nr_min_duracao_real, ds_codigo_prof_cirur, ie_envio_ministerio_publico, nr_declaracao_obito, cd_cie10_causa_1, cd_cie10_causa_2, cd_cie10_causa_3, cd_cie10_causa_4, cd_cie10_causa_5, cd_cie10_causa_6, cd_cie10_causa_basica, ie_unid_tempo_causa_1, qt_tempo_causa_1, ie_unid_tempo_causa_2, qt_tempo_causa_2, ie_unid_tempo_causa_3, qt_tempo_causa_3, ie_unid_tempo_causa_4, qt_tempo_causa_4, ie_unid_tempo_causa_5, qt_tempo_causa_5, ie_unid_tempo_causa_6, qt_tempo_causa_6, qt_gestacoes, qt_partos, qt_abortos, ie_possui_nascimentos, ie_tipo_atend_obstetrica, qt_semanas_gestacao, qt_feto, ds_metodos_contrac, ie_nascimento_hosp, ie_tipo_nascimento, nr_seq_nascimento, qt_peso_prod, ie_sexo_prod, cd_cond_nascto_prod, nr_dnv, ie_situacao_rn, qt_apgar_quinto_min, ie_massag_cardiaca, qt_estadia_nasc_vivo, nr_afec_comorbidade) AS select	nr_sequencia,
		nm_usuario,		 	
		dt_atualizacao,
		nm_usuario_nrec,
		dt_atualizacao_nrec,
		nr_atendimento,
		rpad(nm_medico_cirurgiao,250) nm_medico,
		nr_folio,
		dt_alta,
		dt_entrada,
		qt_dias_estadia,
		ie_tipo_serv_mx,
		lpad(coalesce(qt_horas_laboratorio,0), 3) qt_horas_laboratorio,
		lpad(coalesce(qt_horas_expulsao,0), 3) qt_horas_expulsao,		
		lpad(coalesce(qt_horas_recuperacao,0), 3) qt_horas_recuperacao,
		lpad(coalesce(qt_horas_terap_intensiva,0), 4) qt_horas_terap_intensiva,
		lpad(coalesce(qt_horas_terap_intermediaria,0), 4) qt_horas_terap_intermediaria,
		cd_procedencia,
		rpad(coalesce(cd_cie10_afec_inicial,'    '),4) cd_cie10_afec_inicial,
		rpad(ds_codigo_prof,15) ds_codigo_prof,	
		coalesce(nr_seq_tipo_acidente,' ') nr_seq_tipo_acidente,
		coalesce(cd_lugar_acc, ' ')cd_lugar_acc,
		rpad(coalesce(cd_derechohabiencia,'9'),2) cd_derechohabiencia,
		cd_motivo_alta,
		rpad(coalesce(cd_clues_estab_proced, ' '),11) cd_clues_estab_proced,
		cd_clues_estab_referido,
		rpad(coalesce(cd_cie10_afec_principal,' '),4) cd_cie10_afec_principal,
		rpad(coalesce(cd_cie10_causa_externa,' '),4) cd_cie10_causa_externa,
		ie_primeira_subsequente,
		ie_infecao_intra_hosp,
		rpad(coalesce(ie_tipo_uni_psiq,'   '),3) ie_tipo_uni_psiq,
		coalesce(ie_serv_psiq_cont, 0) ie_serv_psiq_cont,
		coalesce(ie_serv_psiq_par, 0) ie_serv_psiq_par,
		rpad(coalesce(cd_serv_entrada_mx, '   '),3) cd_serv_entrada_mx,
		rpad(coalesce(cd_serv_sec_mx, '   '),3) cd_serv_sec_mx,
		rpad(coalesce(cd_serv_ter_mx, '    '),3) cd_serv_ter_mx,
		rpad(coalesce(cd_serv_alta_mx, '   '),3) cd_serv_alta_mx,
		rpad(cd_estado_unid_medica,2) cd_estado_unid_medica,
		rpad(cd_jurisdicao_unid_medica,2) cd_jurisdicao_unid_medica,
		rpad(cd_municipio_unid_medica,3) cd_municipio_unid_medica,
		rpad(cd_localidade_unid_medica,4) cd_localidade_unid_medica,
		cd_tipo_unid_medica,
		rpad(cd_clues_estab_saude, 11) cd_clues_estab_saude,
		nr_seq_person_name,
		ie_tipo_idade,
		qt_idade,		
		ie_sexo,			
		coalesce(qt_altura_cm,999) qt_altura_cm,
		rpad(coalesce(cd_curp, ' '), 18) cd_curp,		
		ie_indigina,
		ie_fala_lingua_indigena,
		cd_lingua_indigena,
		ie_fala_espanhol,
		coalesce(qt_peso_kg,999) qt_peso_kg,
		coalesce(nr_spss, '9999999999') nr_spss,
		coalesce(nr_spss_dv, '99') nr_spss_dv,
		rpad(coalesce(cd_estado_res_hab, '  '), 2) cd_estado_res_hab,
		rpad(coalesce(cd_municipio_res_hab, '   '), 3) cd_municipio_res_hab,
		rpad(coalesce(cd_localidade_res_hab, '    '), 4) cd_localidade_res_hab,
		rpad(nr_prontuario,13) nr_prontuario,
		rpad(coalesce(cd_cie10_afec_comorbidade,'    '),4) cd_cie10_afec_comorbidade,
		rpad(coalesce(cd_sistema_ant_proc, ' '), 4) cd_sistema_ant_proc,
		coalesce(cd_tipo_anestesia, ' ') cd_tipo_anestesia,
		coalesce(ie_sala_cirurgia, ' ') ie_sala_cirurgia, 
		lpad(coalesce(nr_hora_duracao_real,0), 2,0) nr_hora_duracao_real,
		lpad(coalesce(nr_min_duracao_real,0), 2,0) nr_min_duracao_real,
		ds_codigo_prof_cirur,
		ie_envio_ministerio_publico,
		nr_declaracao_obito,
		cd_cie10_causa_1,
		cd_cie10_causa_2,
		cd_cie10_causa_3,
		cd_cie10_causa_4,
		cd_cie10_causa_5,
		cd_cie10_causa_6,
		cd_cie10_causa_basica,
		ie_unid_tempo_causa_1,
		qt_tempo_causa_1,
		ie_unid_tempo_causa_2,
		qt_tempo_causa_2,
		ie_unid_tempo_causa_3,
		qt_tempo_causa_3,
		ie_unid_tempo_causa_4,
		qt_tempo_causa_4,
		ie_unid_tempo_causa_5,
		qt_tempo_causa_5,
		ie_unid_tempo_causa_6,
		qt_tempo_causa_6,
		coalesce(qt_gestacoes,0) qt_gestacoes,
		coalesce(qt_partos,0) qt_partos,
		coalesce(qt_abortos,0) qt_abortos,
		coalesce(ie_possui_nascimentos,0) ie_possui_nascimentos,
		coalesce(ie_tipo_atend_obstetrica,' ') ie_tipo_atend_obstetrica,
		lpad(coalesce(qt_semanas_gestacao,00),2,0) qt_semanas_gestacao,
		coalesce(qt_feto,0) qt_feto,	
		coalesce(ds_metodos_contrac,' ') ds_metodos_contrac,
		coalesce(ie_nascimento_hosp,'9') ie_nascimento_hosp,
		ie_tipo_nascimento,
		nr_seq_nascimento,
		trunc(coalesce(qt_peso_prod,'9999')) qt_peso_prod,
		ie_sexo_prod,
		cd_cond_nascto_prod,
		nr_dnv,
		ie_situacao_rn,
		lpad(qt_apgar_quinto_min,2,0) qt_apgar_quinto_min,
		ie_massag_cardiaca,
		lpad(qt_estadia_nasc_vivo,3,0) qt_estadia_nasc_vivo,
		coalesce(nr_afec_comorbidade,1) nr_afec_comorbidade
FROM	nom_egreso;

