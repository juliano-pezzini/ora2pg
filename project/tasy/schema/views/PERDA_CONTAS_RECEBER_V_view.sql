-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW perda_contas_receber_v (nr_sequencia, dt_atualizacao, nm_usuario, dt_atualizacao_nrec, nm_usuario_nrec, dt_perda, cd_estabelecimento, nr_titulo, nr_seq_cheque, nr_seq_baixa, vl_perdas, vl_saldo, dt_liquidacao, cd_pessoa_fisica, cd_cgc, nr_seq_motivo_perda, ie_tipo_perda, nr_seq_produto, nr_seq_subgrupo_prod, nr_seq_grupo_prod, nr_seq_trans_fin, ds_trans_fin, cd_conta_financ) AS select	a.nr_sequencia,
	a.dt_atualizacao, 
	a.nm_usuario, 
	a.dt_atualizacao_nrec, 
	a.nm_usuario_nrec, 
	a.dt_perda, 
	a.cd_estabelecimento, 
	a.nr_titulo, 
	a.nr_seq_cheque, 
	a.nr_seq_baixa, 
	a.vl_perdas, 
	a.vl_saldo, 
	a.dt_liquidacao, 
	a.cd_pessoa_fisica, 
	a.cd_cgc, 
	a.nr_seq_motivo_perda, 
	a.ie_tipo_perda, 
	coalesce((obter_prod_financ(a.nr_sequencia,'PR','P'))::numeric ,99999) nr_seq_produto, 
	coalesce((obter_prod_financ(a.nr_sequencia,'PR','S'))::numeric ,99999) nr_seq_subgrupo_prod, 
	coalesce(a.nr_seq_grupo_prod,99999) nr_seq_grupo_prod, 
	(obter_dados_perda_cre(a.nr_sequencia,'TF'))::numeric  nr_seq_trans_fin, 
	substr(obter_dados_perda_cre(a.nr_sequencia,'DTF'),1,255) ds_trans_fin, 
	coalesce((obter_dados_titulo_receber(a.nr_titulo, 'CF'))::numeric ,99999) cd_conta_financ 
FROM	perda_contas_receber a;

