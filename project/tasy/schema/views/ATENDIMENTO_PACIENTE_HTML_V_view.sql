-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW atendimento_paciente_html_v (nr_atendimento, cd_pessoa_fisica, cd_medico_resp, cd_convenio, ds_convenio, dt_alta_interno, dt_alta, nr_doc_convenio, cd_estabelecimento, ie_com_alta, nm_paciente, nm_medico) AS SELECT a.nr_atendimento,
 a.CD_PESSOA_FISICA, 
 a.CD_MEDICO_RESP, 
 b.CD_CONVENIO, 
 d.DS_CONVENIO, 
 a.DT_ALTA_INTERNO, 
 a.DT_ALTA, 
 b.NR_DOC_CONVENIO, 
 a.CD_ESTABELECIMENTO, 
 CASE WHEN a.DT_ALTA IS NULL THEN 'N'  ELSE 'S' END  ie_com_alta, 
 SUBSTR(OBTER_NOME_PF(a.CD_PESSOA_FISICA), 
 1, 
 255) NM_PACIENTE, 
 SUBSTR(OBTER_NOME_PF(a.CD_MEDICO_RESP),1,255) NM_MEDICO 
FROM convenio d, 
 atend_categoria_convenio b, 
 atendimento_paciente a 
WHERE a.nr_atendimento = b.nr_atendimento 
AND b.nr_seq_interno = obter_atecaco_atendimento(a.nr_atendimento) 
AND b.cd_convenio = d.cd_convenio;

