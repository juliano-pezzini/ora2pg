-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_mov_benef_operadora_v (ie_tipo_reg, nr_seq_mov_operadora, nr_seq_lote, dt_referencia, dt_geracao_lote, nr_seq_regra, ie_tipo_movimento, dt_movimento_inicial, dt_movimento_final, cd_cooperativa_destino, cd_cooperativa_origem, nr_contrato, dt_contrato, dt_rescisao_contrato, ds_razao_social, nm_fantasia, cd_empresa, cd_cnpj, nr_ddi_telefone, nr_ddd_telefone, nr_telefone, nr_inscricao_municipal, nr_inscricao_estadual, ds_email, nm_pessoa_contato, cd_cep, ds_endereco, nr_endereco_contrato, ds_complemento, ds_bairro, cd_tipo_logradouro, cd_municipio_ibge, sg_estado, nr_seq_contrato, nr_seq_intercambio, nr_seq_plano, nr_protocolo_ans, cd_operadora_ans, ie_abrangencia, ie_regulamentacao, ie_tipo_contratacao, cd_segmentacao, nr_seq_segurado, cd_plano_origem, ds_plano_origem, cd_plano_intercambio, cd_usuario_plano, dt_validade_carteira, nr_via_carteira, nm_beneficiario, nm_abreviado, nm_social, nm_social_abreviado, dt_nascimento, ie_sexo, nr_cpf, nr_identidade, ds_orgao_emissor_ci, sg_emissora_ci, ie_estado_civil, nm_mae, nr_pis_pasep, nr_cartao_nac_sus, cd_familia, cd_matricula_estipulante, ie_nascido_plano, cd_dependencia, cd_titular, dt_inclusao_operadora, dt_contratacao, dt_rescisao_benef, cd_motivo_rescisao, dt_compartilhamento, dt_fim_compartilhamento, ie_tipo_complemento, cd_tipo_cobertura, dt_fim_carencia, cd_tipo_produto, ds_produto, nr_endereco_benef, ie_tipo_repasse) AS select	1 ie_tipo_reg, --Cabeçalho
	a.nr_sequencia nr_seq_mov_operadora,
	b.nr_sequencia nr_seq_lote,
	to_char(b.dt_referencia,'ddmmyyyy') dt_referencia,
	to_char(b.dt_geracao_lote,'ddmmyyyy') dt_geracao_lote,
	b.nr_seq_regra,
	b.ie_tipo_movimento,
	to_char(b.dt_movimento_inicial,'ddmmyyyy') dt_movimento_inicial,
	to_char(b.dt_movimento_final,'ddmmyyyy') dt_movimento_final,
	c.cd_cooperativa cd_cooperativa_destino,
	pls_obter_cd_cooperativa(b.cd_estabelecimento) cd_cooperativa_origem,
	null nr_contrato,
	null dt_contrato,
	null dt_rescisao_contrato,
	null ds_razao_social,
	null nm_fantasia,
	null cd_empresa,
	null cd_cnpj,
	null nr_ddi_telefone,
	null nr_ddd_telefone,
	null nr_telefone,
	null nr_inscricao_municipal,
	null nr_inscricao_estadual,
	null ds_email,
	null nm_pessoa_contato,
	null cd_cep,
	null ds_endereco,
	null nr_endereco_contrato,
	null ds_complemento,
	null ds_bairro,
	null cd_tipo_logradouro,
	null cd_municipio_ibge,
	null sg_estado,
	null nr_seq_contrato,
	null nr_seq_intercambio,
	null nr_seq_plano,
	null nr_protocolo_ans,
	null cd_operadora_ans,
	null ie_abrangencia,
	null ie_regulamentacao,
	null ie_tipo_contratacao,
	null cd_segmentacao,
	null nr_seq_segurado,
	null cd_plano_origem,
	null ds_plano_origem,
	null cd_plano_intercambio,
	null cd_usuario_plano,
	null dt_validade_carteira,
	null nr_via_carteira,
	null nm_beneficiario,
	null nm_abreviado,
	null nm_social,
	null nm_social_abreviado,
	null dt_nascimento,
	null ie_sexo,
	null nr_cpf,
	null nr_identidade,
	null ds_orgao_emissor_ci,
	null sg_emissora_ci,
	null ie_estado_civil,
	null nm_mae,
	null nr_pis_pasep,
	null nr_cartao_nac_sus,
	null cd_familia,
	null cd_matricula_estipulante,
	null ie_nascido_plano,
	null cd_dependencia,
	null cd_titular,
	null dt_inclusao_operadora,
	null dt_contratacao,
	null dt_rescisao_benef,
	null cd_motivo_rescisao,
	null dt_compartilhamento,
	null dt_fim_compartilhamento,
	null ie_tipo_complemento,
	null cd_tipo_cobertura,
	null dt_fim_carencia,
	null cd_tipo_produto,
	null ds_produto,
	null nr_endereco_benef,
	null ie_tipo_repasse
FROM	pls_mov_benef_operadora	a,
	pls_mov_benef_lote	b,
	pls_congenere		c
where	b.nr_sequencia		= a.nr_seq_lote
and	c.nr_sequencia		= a.nr_seq_congenere

union

select	2 ie_tipo_reg, --Contrato
	a.nr_sequencia nr_seq_mov_operadora,
	a.nr_seq_lote,
	null dt_referencia,
	null dt_geracao_lote,
	null nr_seq_regra,
	null ie_tipo_movimento,
	null dt_movimento_inicial,
	null dt_movimento_final,
	null cd_cooperativa_destino,
	null cd_cooperativa_origem,
	c.nr_contrato,
	to_char(c.dt_contrato,'ddmmyyyy') dt_contrato,
	to_char(c.dt_rescisao,'ddmmyyyy') dt_rescisao_contrato,
	c.ds_razao_social,
	c.nm_fantasia,
	c.cd_empresa,
	c.cd_cnpj,
	c.nr_ddi_telefone,
	c.nr_ddd_telefone,
	c.nr_telefone,
	c.nr_inscricao_municipal,
	c.nr_inscricao_estadual,
	c.ds_email,
	c.nm_pessoa_contato,
	c.cd_cep,
	c.ds_endereco,
	c.nr_endereco nr_endereco_contrato,
	c.ds_complemento,
	c.ds_bairro,
	c.cd_tipo_logradouro,
	c.cd_municipio_ibge,
	c.sg_estado,
	c.nr_seq_contrato,
	c.nr_seq_intercambio,
	null nr_seq_plano,
	null nr_protocolo_ans,
	null cd_operadora_ans,
	null ie_abrangencia,
	null ie_regulamentacao,
	null ie_tipo_contratacao,
	null cd_segmentacao,
	null nr_seq_segurado,
	null cd_plano_origem,
	null ds_plano_origem,
	null cd_plano_intercambio,
	null cd_usuario_plano,
	null dt_validade_carteira,
	null nr_via_carteira,
	null nm_beneficiario,
	null nm_abreviado,
	null nm_social,
	null nm_social_abreviado,
	null dt_nascimento,
	null ie_sexo,
	null nr_cpf,
	null nr_identidade,
	null ds_orgao_emissor_ci,
	null sg_emissora_ci,
	null ie_estado_civil,
	null nm_mae,
	null nr_pis_pasep,
	null nr_cartao_nac_sus,
	null cd_familia,
	null cd_matricula_estipulante,
	null ie_nascido_plano,
	null cd_dependencia,
	null cd_titular,
	null dt_inclusao_operadora,
	null dt_contratacao,
	null dt_rescisao_benef,
	null cd_motivo_rescisao,
	null dt_compartilhamento,
	null dt_fim_compartilhamento,
	null ie_tipo_complemento,
	null cd_tipo_cobertura,
	null dt_fim_carencia,
	null cd_tipo_produto,
	null ds_produto,
	null nr_endereco_benef,
	null ie_tipo_repasse
from	pls_mov_benef_operadora	a,
	pls_mov_benef_contrato	c
where	a.nr_sequencia	= c.nr_seq_mov_operadora

union

select	3 ie_tipo_reg, --Produto
	a.nr_sequencia nr_seq_mov_operadora,
	a.nr_seq_lote,
	null dt_referencia,
	null dt_geracao_lote,
	null nr_seq_regra,
	null ie_tipo_movimento,
	null dt_movimento_inicial,
	null dt_movimento_final,
	null cd_cooperativa_destino,
	null cd_cooperativa_origem,
	c.nr_contrato,
	null dt_contrato,
	null dt_rescisao_contrato,
	null ds_razao_social,
	null nm_fantasia,
	c.cd_empresa,
	c.cd_cnpj,
	null nr_ddi_telefone,
	null nr_ddd_telefone,
	null nr_telefone,
	null nr_inscricao_municipal,
	null nr_inscricao_estadual,
	null ds_email,
	null nm_pessoa_contato,
	null cd_cep,
	null ds_endereco,
	null nr_endereco_contrato,
	null ds_complemento,
	null ds_bairro,
	null cd_tipo_logradouro,
	null cd_municipio_ibge,
	null sg_estado,
	null nr_seq_contrato,
	null nr_seq_intercambio,
	d.nr_seq_plano,
	d.nr_protocolo_ans,
	d.cd_operadora_ans,
	d.ie_abrangencia,
	d.ie_regulamentacao,
	d.ie_tipo_contratacao,
	d.cd_segmentacao,
	null nr_seq_segurado,
	d.cd_plano_origem,
	d.ds_plano_origem,
	d.cd_plano_intercambio,
	null cd_usuario_plano,
	null dt_validade_carteira,
	null nr_via_carteira,
	null nm_beneficiario,
	null nm_abreviado,
	null nm_social,
	null nm_social_abreviado,
	null dt_nascimento,
	null ie_sexo,
	null nr_cpf,
	null nr_identidade,
	null ds_orgao_emissor_ci,
	null sg_emissora_ci,
	null ie_estado_civil,
	null nm_mae,
	null nr_pis_pasep,
	null nr_cartao_nac_sus,
	null cd_familia,
	null cd_matricula_estipulante,
	null ie_nascido_plano,
	null cd_dependencia,
	null cd_titular,
	null dt_inclusao_operadora,
	null dt_contratacao,
	null dt_rescisao_benef,
	null cd_motivo_rescisao,
	null dt_compartilhamento,
	null dt_fim_compartilhamento,
	null ie_tipo_complemento,
	null cd_tipo_cobertura,
	null dt_fim_carencia,
	null cd_tipo_produto,
	null ds_produto,
	null nr_endereco_benef,
	null ie_tipo_repasse
from	pls_mov_benef_operadora	a,
	pls_mov_benef_contrato	c,
	pls_mov_benef_plano	d
where	a.nr_sequencia	= c.nr_seq_mov_operadora
and	c.nr_sequencia	= d.nr_seq_mov_contrato

union

select	4 ie_tipo_reg, --Beneficiário
	a.nr_sequencia nr_seq_mov_operadora,
	a.nr_seq_lote,
	null dt_referencia,
	null dt_geracao_lote,
	null nr_seq_regra,
	null ie_tipo_movimento,
	null dt_movimento_inicial,
	null dt_movimento_final,
	null cd_cooperativa_destino,
	null cd_cooperativa_origem,
	c.nr_contrato,
	null dt_contrato,
	null dt_rescisao_contrato,
	null ds_razao_social,
	null nm_fantasia,
	c.cd_empresa,
	c.cd_cnpj,
	null nr_ddi_telefone,
	null nr_ddd_telefone,
	null nr_telefone,
	null nr_inscricao_municipal,
	null nr_inscricao_estadual,
	null ds_email,
	null nm_pessoa_contato,
	null cd_cep,
	null ds_endereco,
	null nr_endereco_contrato,
	null ds_complemento,
	null ds_bairro,
	null cd_tipo_logradouro,
	null cd_municipio_ibge,
	null sg_estado,
	null nr_seq_contrato,
	null nr_seq_intercambio,
	null nr_seq_plano,
	null nr_protocolo_ans,
	null cd_operadora_ans,
	null ie_abrangencia,
	null ie_regulamentacao,
	null ie_tipo_contratacao,
	null cd_segmentacao,
	e.nr_seq_segurado,
	d.cd_plano_origem,
	null ds_plano_origem,
	d.cd_plano_intercambio,
	e.cd_usuario_plano,
	to_char(e.dt_validade_carteira,'ddmmyyyy') dt_validade_carteira,
	e.nr_via_carteira,
	e.nm_beneficiario,
	e.nm_abreviado,
	e.nm_social,
	e.nm_social_abreviado,
	to_char(e.dt_nascimento,'ddmmyyyy') dt_nascimento,
	e.ie_sexo,
	e.nr_cpf,
	e.nr_identidade,
	e.ds_orgao_emissor_ci,
	e.sg_emissora_ci,
	e.ie_estado_civil,
	e.nm_mae,
	e.nr_pis_pasep,
	e.nr_cartao_nac_sus,
	e.cd_familia,
	e.cd_matricula_estipulante,
	e.ie_nascido_plano,
	e.cd_dependencia,
	e.cd_titular,
	to_char(e.dt_inclusao_operadora,'ddmmyyyy') dt_inclusao_operadora,
	to_char(e.dt_contratacao,'ddmmyyyy') dt_contratacao,
	to_char(e.dt_rescisao,'ddmmyyyy') dt_rescisao_benef,
	e.cd_motivo_rescisao,
	to_char(e.dt_compartilhamento,'ddmmyyyy') dt_compartilhamento,
	to_char(e.dt_fim_compartilhamento,'ddmmyyyy') dt_fim_compartilhamento,
	null ie_tipo_complemento,
	null cd_tipo_cobertura,
	null dt_fim_carencia,
	null cd_tipo_produto,
	null ds_produto,
	null nr_endereco_benef,
	e.ie_tipo_repasse
from	pls_mov_benef_operadora	a,
	pls_mov_benef_contrato	c,
	pls_mov_benef_plano	d,
	pls_mov_benef_segurado	e
where	a.nr_sequencia	= c.nr_seq_mov_operadora
and	c.nr_sequencia	= d.nr_seq_mov_contrato
and	c.nr_sequencia	= e.nr_seq_mov_contrato

union

select	5 ie_tipo_reg, --Complemento
	a.nr_sequencia nr_seq_mov_operadora,
	a.nr_seq_lote,
	null dt_referencia,
	null dt_geracao_lote,
	null nr_seq_regra,
	null ie_tipo_movimento,
	null dt_movimento_inicial,
	null dt_movimento_final,
	null cd_cooperativa_destino,
	null cd_cooperativa_origem,
	c.nr_contrato,
	null dt_contrato,
	null dt_rescisao_contrato,
	null ds_razao_social,
	null nm_fantasia,
	null cd_empresa,
	null cd_cnpj,
	f.nr_ddi_telefone,
	f.nr_ddd_telefone,
	f.nr_telefone,
	null nr_inscricao_municipal,
	null nr_inscricao_estadual,
	f.ds_email,
	null nm_pessoa_contato,
	f.cd_cep,
	f.ds_endereco,
	null nr_endereco_contrato,
	f.ds_complemento,
	f.ds_bairro,
	null cd_tipo_logradouro,
	f.cd_municipio_ibge,
	f.sg_estado,
	null nr_seq_contrato,
	null nr_seq_intercambio,
	null nr_seq_plano,
	null nr_protocolo_ans,
	null cd_operadora_ans,
	null ie_abrangencia,
	null ie_regulamentacao,
	null ie_tipo_contratacao,
	null cd_segmentacao,
	null nr_seq_segurado,
	null cd_plano_origem,
	null ds_plano_origem,
	null cd_plano_intercambio,
	e.cd_usuario_plano,
	null dt_validade_carteira,
	null nr_via_carteira,
	null nm_beneficiario,
	null nm_abreviado,
	null nm_social,
	null nm_social_abreviado,
	null dt_nascimento,
	null ie_sexo,
	null nr_cpf,
	null nr_identidade,
	null ds_orgao_emissor_ci,
	null sg_emissora_ci,
	null ie_estado_civil,
	null nm_mae,
	null nr_pis_pasep,
	null nr_cartao_nac_sus,
	null cd_familia,
	null cd_matricula_estipulante,
	null ie_nascido_plano,
	null cd_dependencia,
	null cd_titular,
	null dt_inclusao_operadora,
	null dt_contratacao,
	null dt_rescisao_benef,
	null cd_motivo_rescisao,
	null dt_compartilhamento,
	null dt_fim_compartilhamento,
	f.ie_tipo_complemento,
	null cd_tipo_cobertura,
	null dt_fim_carencia,
	null cd_tipo_produto,
	null ds_produto,
	f.nr_endereco nr_endereco_benef,
	e.ie_tipo_repasse
from	pls_mov_benef_operadora	a,
	pls_mov_benef_contrato	c,
	pls_mov_benef_plano	d,
	pls_mov_benef_segurado	e,
	pls_mov_benef_seg_compl	f
where	a.nr_sequencia	= c.nr_seq_mov_operadora
and	c.nr_sequencia	= d.nr_seq_mov_contrato
and	c.nr_sequencia	= e.nr_seq_mov_contrato
and	e.nr_sequencia	= f.nr_seq_mov_segurado

union

select	6 ie_tipo_reg, --Carência
	a.nr_sequencia nr_seq_mov_operadora,
	a.nr_seq_lote,
	null dt_referencia,
	null dt_geracao_lote,
	null nr_seq_regra,
	null ie_tipo_movimento,
	null dt_movimento_inicial,
	null dt_movimento_final,
	null cd_cooperativa_destino,
	null cd_cooperativa_origem,
	null nr_contrato,
	null dt_contrato,
	null dt_rescisao_contrato,
	null ds_razao_social,
	null nm_fantasia,
	null cd_empresa,
	null cd_cnpj,
	null nr_ddi_telefone,
	null nr_ddd_telefone,
	null nr_telefone,
	null nr_inscricao_municipal,
	null nr_inscricao_estadual,
	null ds_email,
	null nm_pessoa_contato,
	null cd_cep,
	null ds_endereco,
	null nr_endereco_contrato,
	null ds_complemento,
	null ds_bairro,
	null cd_tipo_logradouro,
	null cd_municipio_ibge,
	null sg_estado,
	null nr_seq_contrato,
	null nr_seq_intercambio,
	null nr_seq_plano,
	null nr_protocolo_ans,
	null cd_operadora_ans,
	null ie_abrangencia,
	null ie_regulamentacao,
	null ie_tipo_contratacao,
	null cd_segmentacao,
	null nr_seq_segurado,
	null cd_plano_origem,
	null ds_plano_origem,
	null cd_plano_intercambio,
	e.cd_usuario_plano,
	null dt_validade_carteira,
	null nr_via_carteira,
	null nm_beneficiario,
	null nm_abreviado,
	null nm_social,
	null nm_social_abreviado,
	null dt_nascimento,
	null ie_sexo,
	null nr_cpf,
	null nr_identidade,
	null ds_orgao_emissor_ci,
	null sg_emissora_ci,
	null ie_estado_civil,
	null nm_mae,
	null nr_pis_pasep,
	null nr_cartao_nac_sus,
	null cd_familia,
	null cd_matricula_estipulante,
	null ie_nascido_plano,
	null cd_dependencia,
	null cd_titular,
	null dt_inclusao_operadora,
	null dt_contratacao,
	null dt_rescisao_benef,
	null cd_motivo_rescisao,
	null dt_compartilhamento,
	null dt_fim_compartilhamento,
	null ie_tipo_complemento,
	g.cd_tipo_cobertura,
	to_char(g.dt_fim_carencia,'ddmmyyyy') dt_fim_carencia,
	null cd_tipo_produto,
	null ds_produto,
	null nr_endereco_benef,
	e.ie_tipo_repasse
from	pls_mov_benef_operadora		a,
	pls_mov_benef_contrato		c,
	pls_mov_benef_plano		d,
	pls_mov_benef_segurado		e,
	pls_mov_benef_seg_carencia	g
where	a.nr_sequencia	= c.nr_seq_mov_operadora
and	c.nr_sequencia	= d.nr_seq_mov_contrato
and	c.nr_sequencia	= e.nr_seq_mov_contrato
and	e.nr_sequencia	= g.nr_seq_mov_segurado

union

select	7 ie_tipo_reg, --SCA
	a.nr_sequencia nr_seq_mov_operadora,
	a.nr_seq_lote,
	null dt_referencia,
	null dt_geracao_lote,
	null nr_seq_regra,
	null ie_tipo_movimento,
	null dt_movimento_inicial,
	null dt_movimento_final,
	null cd_cooperativa_destino,
	null cd_cooperativa_origem,
	null nr_contrato,
	null dt_contrato,
	null dt_rescisao_contrato,
	null ds_razao_social,
	null nm_fantasia,
	null cd_empresa,
	null cd_cnpj,
	null nr_ddi_telefone,
	null nr_ddd_telefone,
	null nr_telefone,
	null nr_inscricao_municipal,
	null nr_inscricao_estadual,
	null ds_email,
	null nm_pessoa_contato,
	null cd_cep,
	null ds_endereco,
	null nr_endereco_contrato,
	null ds_complemento,
	null ds_bairro,
	null cd_tipo_logradouro,
	null cd_municipio_ibge,
	null sg_estado,
	null nr_seq_contrato,
	null nr_seq_intercambio,
	null nr_seq_plano,
	null nr_protocolo_ans,
	null cd_operadora_ans,
	null ie_abrangencia,
	null ie_regulamentacao,
	null ie_tipo_contratacao,
	null cd_segmentacao,
	null nr_seq_segurado,
	null cd_plano_origem,
	null ds_plano_origem,
	null cd_plano_intercambio,
	e.cd_usuario_plano,
	null dt_validade_carteira,
	null nr_via_carteira,
	null nm_beneficiario,
	null nm_abreviado,
	null nm_social,
	null nm_social_abreviado,
	null dt_nascimento,
	null ie_sexo,
	null nr_cpf,
	null nr_identidade,
	null ds_orgao_emissor_ci,
	null sg_emissora_ci,
	null ie_estado_civil,
	null nm_mae,
	null nr_pis_pasep,
	null nr_cartao_nac_sus,
	null cd_familia,
	null cd_matricula_estipulante,
	null ie_nascido_plano,
	null cd_dependencia,
	null cd_titular,
	null dt_inclusao_operadora,
	null dt_contratacao,
	null dt_rescisao_benef,
	null cd_motivo_rescisao,
	null dt_compartilhamento,
	null dt_fim_compartilhamento,
	null ie_tipo_complemento,
	null cd_tipo_cobertura,
	null dt_fim_carencia,
	h.cd_tipo_produto,
	h.ds_produto,
	null nr_endereco_benef,
	e.ie_tipo_repasse
from	pls_mov_benef_operadora	a,
	pls_mov_benef_contrato	c,
	pls_mov_benef_plano	d,
	pls_mov_benef_segurado	e,
	pls_mov_benef_seg_sca	h
where	a.nr_sequencia	= c.nr_seq_mov_operadora
and	c.nr_sequencia	= d.nr_seq_mov_contrato
and	c.nr_sequencia	= e.nr_seq_mov_contrato
and	e.nr_sequencia	= h.nr_seq_mov_segurado;

