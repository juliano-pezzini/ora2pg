-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW w_eis_complex_dini_v (nr_sequencia, dt_avaliacao, setor, ds_setor_atendimento, ds_item, qt_score, qt_pontuacao, ds_gradacao, ie_sexo, ds_sexo, ie_faixa_etaria, cd_estabelecimento, ds_estabelecimento, ds_unidade) AS select distinct
	a.nr_sequencia,
	trunc(a.dt_avaliacao) dt_avaliacao,
	b.cd_setor_atendimento setor,
	obter_nome_setor(b.cd_setor_atendimento) ds_setor_atendimento,
	wheb_mensagem_pck.GET_TEXTO(1061920) ds_item,
	coalesce(a.qt_pontuacao,0) qt_score,
	coalesce(a.ie_atividade,0) qt_pontuacao,
	substr(Obter_result_dini('S',qt_pontuacao),1,100) ds_gradacao,
	c.ie_sexo ie_sexo,
	obter_valor_dominio(4,c.ie_sexo) ds_sexo,
	SUBSTR(obter_idade(c.dt_nascimento,coalesce(c.dt_obito,LOCALTIMESTAMP),'E'),1,10) ie_faixa_etaria,
	b.cd_estabelecimento,
	obter_nome_estabelecimento(b.cd_estabelecimento) ds_estabelecimento,
	obter_unidade_atendimento(a.nr_atendimento,'A','U') ds_unidade
FROM	escala_dini a,
	resumo_atendimento_paciente_v b,
	pessoa_fisica c
where	a.nr_atendimento = b.nr_atendimento
and	b.cd_pessoa_fisica = c.cd_pessoa_fisica
and	a.dt_inativacao is null

union all

select distinct
	a.nr_sequencia,
	trunc(a.dt_avaliacao) dt_avaliacao,
	b.cd_setor_atendimento setor,
	obter_nome_setor(b.cd_setor_atendimento) ds_setor_atendimento,
	wheb_mensagem_pck.GET_TEXTO(1061910) ds_item,
	coalesce(a.qt_pontuacao,0) qt_score,
	coalesce(a.ie_interv_controles,0) qt_pontuacao,
	substr(Obter_result_dini('S',qt_pontuacao),1,100) ds_gradacao,
	c.ie_sexo ie_sexo,
	obter_valor_dominio(4,c.ie_sexo) ds_sexo,
	SUBSTR(obter_idade(c.dt_nascimento,coalesce(c.dt_obito,LOCALTIMESTAMP),'E'),1,10) ie_faixa_etaria,
	b.cd_estabelecimento,
	obter_nome_estabelecimento(b.cd_estabelecimento) ds_estabelecimento,
	obter_unidade_atendimento(a.nr_atendimento,'A','U') ds_unidade
from	escala_dini a,
	resumo_atendimento_paciente_v b,
	pessoa_fisica c
where	a.nr_atendimento = b.nr_atendimento
and	b.cd_pessoa_fisica = c.cd_pessoa_fisica
and	a.dt_inativacao is null

union all

select distinct
	a.nr_sequencia,
	trunc(a.dt_avaliacao) dt_avaliacao,
	b.cd_setor_atendimento setor,
	obter_nome_setor(b.cd_setor_atendimento) ds_setor_atendimento,
	wheb_mensagem_pck.GET_TEXTO(1061919) ds_item,
	coalesce(a.qt_pontuacao,0) qt_score,
	coalesce(a.ie_oxigenacao,0) qt_pontuacao,
	substr(Obter_result_dini('S',qt_pontuacao),1,100) ds_gradacao,
	c.ie_sexo ie_sexo,
	obter_valor_dominio(4,c.ie_sexo) ds_sexo,
	SUBSTR(obter_idade(c.dt_nascimento,coalesce(c.dt_obito,LOCALTIMESTAMP),'E'),1,10) ie_faixa_etaria,
	b.cd_estabelecimento,
	obter_nome_estabelecimento(b.cd_estabelecimento) ds_estabelecimento,
	obter_unidade_atendimento(a.nr_atendimento,'A','U') ds_unidade
from	escala_dini a,
	resumo_atendimento_paciente_v b,
	pessoa_fisica c
where	a.nr_atendimento = b.nr_atendimento
and	b.cd_pessoa_fisica = c.cd_pessoa_fisica
and	a.dt_inativacao is null

union all

select distinct
	a.nr_sequencia,
	trunc(a.dt_avaliacao) dt_avaliacao,
	b.cd_setor_atendimento setor,
	obter_nome_setor(b.cd_setor_atendimento) ds_setor_atendimento,
	wheb_mensagem_pck.GET_TEXTO(1061916) ds_item,
	coalesce(a.qt_pontuacao,0) qt_score,
	coalesce(a.ie_terapeutica_medic,0) qt_pontuacao,
	substr(Obter_result_dini('S',qt_pontuacao),1,100) ds_gradacao,
	c.ie_sexo ie_sexo,
	obter_valor_dominio(4,c.ie_sexo) ds_sexo,
	SUBSTR(obter_idade(c.dt_nascimento,coalesce(c.dt_obito,LOCALTIMESTAMP),'E'),1,10) ie_faixa_etaria,
	b.cd_estabelecimento,
	obter_nome_estabelecimento(b.cd_estabelecimento) ds_estabelecimento,
	obter_unidade_atendimento(a.nr_atendimento,'A','U') ds_unidade
from	escala_dini a,
	resumo_atendimento_paciente_v b,
	pessoa_fisica c
where	a.nr_atendimento = b.nr_atendimento
and	b.cd_pessoa_fisica = c.cd_pessoa_fisica
and	a.dt_inativacao is null

union all

select distinct
	a.nr_sequencia,
	trunc(a.dt_avaliacao) dt_avaliacao,
	b.cd_setor_atendimento setor,
	obter_nome_setor(b.cd_setor_atendimento) ds_setor_atendimento,
	wheb_mensagem_pck.GET_TEXTO(1061914) ds_item,
	coalesce(a.qt_pontuacao,0) qt_score,
	coalesce(a.ie_integridade_mucosa,0) qt_pontuacao,
	substr(Obter_result_dini('S',qt_pontuacao),1,100) ds_gradacao,
	c.ie_sexo ie_sexo,
	obter_valor_dominio(4,c.ie_sexo) ds_sexo,
	SUBSTR(obter_idade(c.dt_nascimento,coalesce(c.dt_obito,LOCALTIMESTAMP),'E'),1,10) ie_faixa_etaria,
	b.cd_estabelecimento,
	obter_nome_estabelecimento(b.cd_estabelecimento) ds_estabelecimento,
	obter_unidade_atendimento(a.nr_atendimento,'A','U') ds_unidade
from	escala_dini a,
	resumo_atendimento_paciente_v b,
	pessoa_fisica c
where	a.nr_atendimento = b.nr_atendimento
and	b.cd_pessoa_fisica = c.cd_pessoa_fisica
and	a.dt_inativacao is null

union all

select distinct
	a.nr_sequencia,
	trunc(a.dt_avaliacao) dt_avaliacao,
	b.cd_setor_atendimento setor,
	obter_nome_setor(b.cd_setor_atendimento) ds_setor_atendimento,
	wheb_mensagem_pck.GET_TEXTO(1061911) ds_item,
	coalesce(a.qt_pontuacao,0) qt_score,
	coalesce(a.ie_alimentacao_hidrat,0) qt_pontuacao,
	substr(Obter_result_dini('S',qt_pontuacao),1,100) ds_gradacao,
	c.ie_sexo ie_sexo,
	obter_valor_dominio(4,c.ie_sexo) ds_sexo,
	SUBSTR(obter_idade(c.dt_nascimento,coalesce(c.dt_obito,LOCALTIMESTAMP),'E'),1,10) ie_faixa_etaria,
	b.cd_estabelecimento,
	obter_nome_estabelecimento(b.cd_estabelecimento) ds_estabelecimento,
	obter_unidade_atendimento(a.nr_atendimento,'A','U') ds_unidade
from	escala_dini a,
	resumo_atendimento_paciente_v b,
	pessoa_fisica c
where	a.nr_atendimento = b.nr_atendimento
and	b.cd_pessoa_fisica = c.cd_pessoa_fisica
and	a.dt_inativacao is null

union all

select distinct
	a.nr_sequencia,
	trunc(a.dt_avaliacao) dt_avaliacao,
	b.cd_setor_atendimento setor,
	obter_nome_setor(b.cd_setor_atendimento) ds_setor_atendimento,
	wheb_mensagem_pck.GET_TEXTO(1061915) ds_item,
	coalesce(a.qt_pontuacao,0) qt_score,
	coalesce(a.ie_eliminacoes,0) qt_pontuacao,
	substr(Obter_result_dini('S',qt_pontuacao),1,100) ds_gradacao,
	c.ie_sexo ie_sexo,
	obter_valor_dominio(4,c.ie_sexo) ds_sexo,
	SUBSTR(obter_idade(c.dt_nascimento,coalesce(c.dt_obito,LOCALTIMESTAMP),'E'),1,10) ie_faixa_etaria,
	b.cd_estabelecimento,
	obter_nome_estabelecimento(b.cd_estabelecimento) ds_estabelecimento,
	obter_unidade_atendimento(a.nr_atendimento,'A','U') ds_unidade
from	escala_dini a,
	resumo_atendimento_paciente_v b,
	pessoa_fisica c
where	a.nr_atendimento = b.nr_atendimento
and	b.cd_pessoa_fisica = c.cd_pessoa_fisica
and	a.dt_inativacao is null

union all

select distinct
	a.nr_sequencia,
	trunc(a.dt_avaliacao) dt_avaliacao,
	b.cd_setor_atendimento setor,
	obter_nome_setor(b.cd_setor_atendimento) ds_setor_atendimento,
	wheb_mensagem_pck.GET_TEXTO(1061918) ds_item,
	coalesce(a.qt_pontuacao,0) qt_score,
	coalesce(a.ie_higiene_corporal,0) qt_pontuacao,
	substr(Obter_result_dini('S',qt_pontuacao),1,100) ds_gradacao,
	c.ie_sexo ie_sexo,
	obter_valor_dominio(4,c.ie_sexo) ds_sexo,
	SUBSTR(obter_idade(c.dt_nascimento,coalesce(c.dt_obito,LOCALTIMESTAMP),'E'),1,10) ie_faixa_etaria,
	b.cd_estabelecimento,
	obter_nome_estabelecimento(b.cd_estabelecimento) ds_estabelecimento,
	obter_unidade_atendimento(a.nr_atendimento,'A','U') ds_unidade
from	escala_dini a,
	resumo_atendimento_paciente_v b,
	pessoa_fisica c
where	a.nr_atendimento = b.nr_atendimento
and	b.cd_pessoa_fisica = c.cd_pessoa_fisica
and	a.dt_inativacao is null

union all

select distinct
	a.nr_sequencia,
	trunc(a.dt_avaliacao) dt_avaliacao,
	b.cd_setor_atendimento setor,
	obter_nome_setor(b.cd_setor_atendimento) ds_setor_atendimento,
	wheb_mensagem_pck.GET_TEXTO(1061912) ds_item,
	coalesce(a.qt_pontuacao,0) qt_score,
	coalesce(a.ie_mobilidade,0) qt_pontuacao,
	substr(Obter_result_dini('S',qt_pontuacao),1,100) ds_gradacao,
	c.ie_sexo ie_sexo,
	obter_valor_dominio(4,c.ie_sexo) ds_sexo,
	SUBSTR(obter_idade(c.dt_nascimento,coalesce(c.dt_obito,LOCALTIMESTAMP),'E'),1,10) ie_faixa_etaria,
	b.cd_estabelecimento,
	obter_nome_estabelecimento(b.cd_estabelecimento) ds_estabelecimento,
	obter_unidade_atendimento(a.nr_atendimento,'A','U') ds_unidade
from	escala_dini a,
	resumo_atendimento_paciente_v b,
	pessoa_fisica c
where	a.nr_atendimento = b.nr_atendimento
and	b.cd_pessoa_fisica = c.cd_pessoa_fisica
and	a.dt_inativacao is null

union all

select distinct
	a.nr_sequencia,
	trunc(a.dt_avaliacao) dt_avaliacao,
	b.cd_setor_atendimento setor,
	obter_nome_setor(b.cd_setor_atendimento) ds_setor_atendimento,
	wheb_mensagem_pck.GET_TEXTO(1061917) ds_item,
	coalesce(a.qt_pontuacao,0) qt_score,
	coalesce(a.ie_part_acompanhante,0) qt_pontuacao,
	substr(Obter_result_dini('S',qt_pontuacao),1,100) ds_gradacao,
	c.ie_sexo ie_sexo,
	obter_valor_dominio(4,c.ie_sexo) ds_sexo,
	SUBSTR(obter_idade(c.dt_nascimento,coalesce(c.dt_obito,LOCALTIMESTAMP),'E'),1,10) ie_faixa_etaria,
	b.cd_estabelecimento,
	obter_nome_estabelecimento(b.cd_estabelecimento) ds_estabelecimento,
	obter_unidade_atendimento(a.nr_atendimento,'A','U') ds_unidade
from	escala_dini a,
	resumo_atendimento_paciente_v b,
	pessoa_fisica c
where	a.nr_atendimento = b.nr_atendimento
and	b.cd_pessoa_fisica = c.cd_pessoa_fisica
and	a.dt_inativacao is null

union all

select distinct
	a.nr_sequencia,
	trunc(a.dt_avaliacao) dt_avaliacao,
	b.cd_setor_atendimento setor,
	obter_nome_setor(b.cd_setor_atendimento) ds_setor_atendimento,
	wheb_mensagem_pck.GET_TEXTO(1061913) ds_item,
	coalesce(a.qt_pontuacao,0) qt_score,
	coalesce(a.ie_rede_apoio_suporte,0) qt_pontuacao,
	substr(Obter_result_dini('S',qt_pontuacao),1,100) ds_gradacao,
	c.ie_sexo ie_sexo,
	obter_valor_dominio(4,c.ie_sexo) ds_sexo,
	SUBSTR(obter_idade(c.dt_nascimento,coalesce(c.dt_obito,LOCALTIMESTAMP),'E'),1,10) ie_faixa_etaria,
	b.cd_estabelecimento,
	obter_nome_estabelecimento(b.cd_estabelecimento) ds_estabelecimento,
	obter_unidade_atendimento(a.nr_atendimento,'A','U') ds_unidade
from	escala_dini a,
	resumo_atendimento_paciente_v b,
	pessoa_fisica c
where	a.nr_atendimento = b.nr_atendimento
and	b.cd_pessoa_fisica = c.cd_pessoa_fisica
and	a.dt_inativacao is null;

