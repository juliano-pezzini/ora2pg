-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW interface_apac_v (tp_registro, ie_identificacao, dt_competencia, qt_apac_gravada, nr_controle, ds_razao_social, ie_sigla_apac, cd_cgc, nm_orgao_destino_apac, ie_orgao_destino_apac, dt_geracao, ie_fim_registro, uf_unidade, cd_unidade_apac, nr_apac, dt_emissao_apac, dt_inicio_vigencia, dt_final_vigencia, cd_tipo_atendimento, ie_tipo_apac, cd_cpf_paciente, nm_paciente, uf_nacionalidade, nm_mae, ds_endereco, nr_endereco, ds_complemento, cd_cep, cd_municipio, dt_nascimento, ie_sexo, ds_variavel, cd_cpf_solicitante, nm_solicitante, ds_procedimentos, cd_motivo_cobranca, dt_ocorrencia, cd_cpf_diretor_clinico, nm_diretor_clinico, ie_continuacao, ds_notas) AS select	1 tp_registro,
		ie_identificacao,
		dt_competencia,
		qt_apac_gravada,
		nr_controle,
		ds_razao_social,
		ie_sigla_apac,
		cd_cgc,
		nm_orgao_destino_apac,
		ie_orgao_destino_apac,
		dt_geracao,
		ie_fim_registro,
		' ' uf_unidade,
		0 cd_unidade_apac,
		0 nr_apac,
		LOCALTIMESTAMP dt_emissao_apac,
		LOCALTIMESTAMP dt_inicio_vigencia,
		LOCALTIMESTAMP dt_final_vigencia,
		0 cd_tipo_atendimento,
		0 ie_tipo_apac,
		0 cd_cpf_paciente,
		' ' nm_paciente,
		' ' uf_nacionalidade,
		' ' nm_mae,
		' ' ds_endereco,
		' ' nr_endereco,
		' ' ds_complemento,
		0 cd_cep,
		0 cd_municipio,
		LOCALTIMESTAMP dt_nascimento,
		' ' ie_sexo,
		' ' ds_variavel,
		0 cd_cpf_solicitante,
		' ' nm_solicitante,
		' ' ds_procedimentos,
		0 cd_motivo_cobranca,
		LOCALTIMESTAMP dt_ocorrencia,
		0 cd_cpf_diretor_clinico,
		' ' nm_diretor_clinico,
		0 ie_continuacao,
		' ' ds_notas
FROM	w_interf_apac_cab

UNION

select	2 tp_registro,
		' ' ie_identificacao,
		LOCALTIMESTAMP dt_competencia,
		0 qt_apac_gravada,
		0 nr_controle,
		' ' ds_razao_social,
		' ' ie_sigla_apac,
		' ' cd_cgc,
		' ' nm_orgao_destino_apac,
		' ' ie_orgao_destino_apac,
		LOCALTIMESTAMP dt_geracao,
		' 'ie_fim_registro,
		uf_unidade,
		cd_unidade_apac,
		nr_apac,
		dt_emissao_apac,
		dt_inicio_vigencia,
		dt_final_vigencia,
		cd_tipo_atendimento,
		ie_tipo_apac,
		cd_cpf_paciente,
		nm_paciente,
		uf_nacionalidade,
		nm_mae,
		ds_endereco,
		nr_endereco,
		ds_complemento,
		cd_cep,
		cd_municipio,
		dt_nascimento,
		ie_sexo,
		ds_variavel,
		cd_cpf_solicitante,
		nm_solicitante,
		ds_procedimentos,
		cd_motivo_cobranca,
		dt_ocorrencia,
		cd_cpf_diretor_clinico,
		nm_diretor_clinico,
		ie_continuacao,
		ds_notas
from	w_interf_apac_det
order by tp_registro,nr_apac,ie_continuacao;

