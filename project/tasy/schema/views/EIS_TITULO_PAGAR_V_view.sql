-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_titulo_pagar_v (nr_titulo, cd_estabelecimento, dt_atualizacao, nm_usuario, dt_emissao, dt_vencimento_original, dt_vencimento_atual, vl_titulo, vl_saldo_titulo, vl_saldo_juros, vl_saldo_multa, cd_moeda, tx_juros, tx_multa, cd_tipo_taxa_juro, cd_tipo_taxa_multa, tx_desc_antecipacao, dt_limite_antecipacao, vl_dia_antecipacao, cd_tipo_taxa_antecipacao, ie_situacao, ie_origem_titulo, ie_tipo_titulo, nr_seq_nota_fiscal, cd_pessoa_fisica, cd_cgc, nr_documento, nr_bloqueto, dt_liquidacao, nr_lote_contabil, ds_observacao_titulo, nr_bordero, vl_bordero, vl_juros_bordero, vl_multa_bordero, vl_desconto_bordero, ie_desconto_dia, nr_titulo_original, nr_parcelas, nr_total_parcelas, dt_contabil, vl_ir, nr_seq_trans_fin_baixa, dt_liberacao, nm_usuario_lib, nr_seq_rpa, nr_repasse_terceiro, nr_nosso_numero, vl_imposto_munic, vl_inss, nr_seq_trans_fin_contab, nr_seq_tributo, vl_out_desp_bordero, ds_compl_contab, dt_inclusao, nm_usuario_orig, dt_integracao_externa, ie_status_tributo, nr_lote_transf_trib, nr_adiant_pago, nr_seq_contrato, cd_tributo, cd_variacao, ie_periodicidade, cd_estab_financeiro, nr_titulo_externo, vl_bloq_associado, vl_bloq_juros, vl_bloq_desc, ie_pls, nr_seq_prot_conta, cd_tipo_baixa_neg, cd_darf, cd_banco_portador, nr_seq_reembolso, vl_outros_acrescimos, nr_seq_lote_res_pls, nr_adiant_rec, nr_seq_adiant_dev, nr_titulo_transf, ie_bloqueto, nr_seq_proj_rec, nr_seq_processo, nr_seq_taxa_saude, nr_seq_lote_audit, nr_seq_provisao, nr_seq_distribuicao, nr_seq_proj_gpi, nr_seq_etapa_gpi, nr_seq_lote_audit_hist, nr_seq_nota_credito, nr_seq_lote_empresa, nr_seq_classe, nr_seq_bordero_nc, nr_seq_pls_pag_prest, nr_seq_conta_gpi, nr_seq_pls_lote_camara, nr_conta, vl_outras_ded_bordero, dt_ultima_devolucao, nr_seq_lote_enc_contas, nr_bloqueto_leitura, nr_seq_ctb_tributo, nr_seq_tit_rec_trib, nr_titulo_dest, nr_seq_trib_presu, nr_seq_segurado_mens, ie_status, nr_seq_pls_lote_contest, nr_seq_pls_lote_disc, ie_tipo_pagamento, nr_seq_grupo_prod, vl_outras_despesas, nr_lote_contabil_curto_prazo, nr_seq_tf_curto_prazo, nr_seq_pls_venc_trib, nr_sistema_ant, nr_seq_orc_item_gpi, nr_ordem_compra, nr_solic_compra, nr_seq_nota_debito, nr_seq_nota_deb_conclusao, cd_conta_contabil, nr_seq_proc_gru, nr_seq_seg_rescisao, nr_seq_conta_bco, vl_titulo_estrang, vl_cotacao, qt_min_usuario_lib, nr_seq_parc_emprest, ie_integra_unimed, nr_seq_pagador, cd_empresa, ie_tipo_fornec, ds_fornec, ds_situacao, ds_tipo_titulo, ie_tipo_pessoa, ds_tipo_pessoa, vl_indicador, qt_prazo_pagamento) AS Select	a.NR_TITULO,a.CD_ESTABELECIMENTO,a.DT_ATUALIZACAO,a.NM_USUARIO,a.DT_EMISSAO,a.DT_VENCIMENTO_ORIGINAL,a.DT_VENCIMENTO_ATUAL,a.VL_TITULO,a.VL_SALDO_TITULO,a.VL_SALDO_JUROS,a.VL_SALDO_MULTA,a.CD_MOEDA,a.TX_JUROS,a.TX_MULTA,a.CD_TIPO_TAXA_JURO,a.CD_TIPO_TAXA_MULTA,a.TX_DESC_ANTECIPACAO,a.DT_LIMITE_ANTECIPACAO,a.VL_DIA_ANTECIPACAO,a.CD_TIPO_TAXA_ANTECIPACAO,a.IE_SITUACAO,a.IE_ORIGEM_TITULO,a.IE_TIPO_TITULO,a.NR_SEQ_NOTA_FISCAL,a.CD_PESSOA_FISICA,a.CD_CGC,a.NR_DOCUMENTO,a.NR_BLOQUETO,a.DT_LIQUIDACAO,a.NR_LOTE_CONTABIL,a.DS_OBSERVACAO_TITULO,a.NR_BORDERO,a.VL_BORDERO,a.VL_JUROS_BORDERO,a.VL_MULTA_BORDERO,a.VL_DESCONTO_BORDERO,a.IE_DESCONTO_DIA,a.NR_TITULO_ORIGINAL,a.NR_PARCELAS,a.NR_TOTAL_PARCELAS,a.DT_CONTABIL,a.VL_IR,a.NR_SEQ_TRANS_FIN_BAIXA,a.DT_LIBERACAO,a.NM_USUARIO_LIB,a.NR_SEQ_RPA,a.NR_REPASSE_TERCEIRO,a.NR_NOSSO_NUMERO,a.VL_IMPOSTO_MUNIC,a.VL_INSS,a.NR_SEQ_TRANS_FIN_CONTAB,a.NR_SEQ_TRIBUTO,a.VL_OUT_DESP_BORDERO,a.DS_COMPL_CONTAB,a.DT_INCLUSAO,a.NM_USUARIO_ORIG,a.DT_INTEGRACAO_EXTERNA,a.IE_STATUS_TRIBUTO,a.NR_LOTE_TRANSF_TRIB,a.NR_ADIANT_PAGO,a.NR_SEQ_CONTRATO,a.CD_TRIBUTO,a.CD_VARIACAO,a.IE_PERIODICIDADE,a.CD_ESTAB_FINANCEIRO,a.NR_TITULO_EXTERNO,a.VL_BLOQ_ASSOCIADO,a.VL_BLOQ_JUROS,a.VL_BLOQ_DESC,a.IE_PLS,a.NR_SEQ_PROT_CONTA,a.CD_TIPO_BAIXA_NEG,a.CD_DARF,a.CD_BANCO_PORTADOR,a.NR_SEQ_REEMBOLSO,a.VL_OUTROS_ACRESCIMOS,a.NR_SEQ_LOTE_RES_PLS,a.NR_ADIANT_REC,a.NR_SEQ_ADIANT_DEV,a.NR_TITULO_TRANSF,a.IE_BLOQUETO,a.NR_SEQ_PROJ_REC,a.NR_SEQ_PROCESSO,a.NR_SEQ_TAXA_SAUDE,a.NR_SEQ_LOTE_AUDIT,a.NR_SEQ_PROVISAO,a.NR_SEQ_DISTRIBUICAO,a.NR_SEQ_PROJ_GPI,a.NR_SEQ_ETAPA_GPI,a.NR_SEQ_LOTE_AUDIT_HIST,a.NR_SEQ_NOTA_CREDITO,a.NR_SEQ_LOTE_EMPRESA,a.NR_SEQ_CLASSE,a.NR_SEQ_BORDERO_NC,a.NR_SEQ_PLS_PAG_PREST,a.NR_SEQ_CONTA_GPI,a.NR_SEQ_PLS_LOTE_CAMARA,a.NR_CONTA,a.VL_OUTRAS_DED_BORDERO,a.DT_ULTIMA_DEVOLUCAO,a.NR_SEQ_LOTE_ENC_CONTAS,a.NR_BLOQUETO_LEITURA,a.NR_SEQ_CTB_TRIBUTO,a.NR_SEQ_TIT_REC_TRIB,a.NR_TITULO_DEST,a.NR_SEQ_TRIB_PRESU,a.NR_SEQ_SEGURADO_MENS,a.IE_STATUS,a.NR_SEQ_PLS_LOTE_CONTEST,a.NR_SEQ_PLS_LOTE_DISC,a.IE_TIPO_PAGAMENTO,a.NR_SEQ_GRUPO_PROD,a.VL_OUTRAS_DESPESAS,a.NR_LOTE_CONTABIL_CURTO_PRAZO,a.NR_SEQ_TF_CURTO_PRAZO,a.NR_SEQ_PLS_VENC_TRIB,a.NR_SISTEMA_ANT,a.NR_SEQ_ORC_ITEM_GPI,a.NR_ORDEM_COMPRA,a.NR_SOLIC_COMPRA,a.NR_SEQ_NOTA_DEBITO,a.NR_SEQ_NOTA_DEB_CONCLUSAO,a.CD_CONTA_CONTABIL,a.NR_SEQ_PROC_GRU,a.NR_SEQ_SEG_RESCISAO,a.NR_SEQ_CONTA_BCO,a.VL_TITULO_ESTRANG,a.VL_COTACAO,a.QT_MIN_USUARIO_LIB,a.NR_SEQ_PARC_EMPREST,a.IE_INTEGRA_UNIMED,a.NR_SEQ_PAGADOR,
	obter_empresa_estab(a.cd_estabelecimento) cd_empresa, 
	CASE WHEN a.cd_pessoa_fisica IS NULL THEN 'Pessoa jurídica'  ELSE 'Pessoa física' END  ie_tipo_fornec, 
	substr(obter_nome_pf_pj(a.cd_pessoa_fisica,a.cd_cgc),1,80) ds_fornec, 
	substr(obter_valor_dominio(501,a.ie_situacao),1,100) ds_situacao, 
	substr(obter_valor_dominio(502,a.ie_tipo_titulo),1,100) ds_tipo_titulo, 
	substr(obter_dados_pf_pj(a.cd_pessoa_fisica,a.cd_cgc,'TP'),1,100) ie_tipo_pessoa, 
	substr(obter_dados_pf_pj(a.cd_pessoa_fisica,a.cd_cgc,'TPD'),1,100) ds_tipo_pessoa, 
	CASE WHEN IE_SITUACAO='A' THEN VL_SALDO_TITULO WHEN IE_SITUACAO='L' THEN VL_TITULO  ELSE VL_TITULO END  vl_indicador, 
	(obter_dias_entre_datas(a.dt_emissao,a.dt_liquidacao))::numeric  qt_prazo_pagamento 
FROM	TITULO_PAGAR a;

