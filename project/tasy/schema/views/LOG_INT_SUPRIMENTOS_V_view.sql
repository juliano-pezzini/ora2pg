-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW log_int_suprimentos_v (nr_sequencia, nr_documento, ie_envio_recebe, ie_tipo_docto, ie_status_integracao, ds_dominio, dt_integracao, ds_tipo_docto) AS select 	a.nr_sequencia,
	a.nr_movimento_estoque nr_documento,
  	ie_envio_recebe,
	'M' ie_tipo_docto,
	ie_status_integracao,
	obter_valor_dominio(7520,ie_status_integracao) ds_dominio,
	dt_integracao,
	substr(obter_desc_expressao(293627,'Movimentação de estoques'),1,255) ds_tipo_docto
FROM	w_movimento_estoque a

union all

select	a.nr_sequencia,
	a.nr_documento_externo nr_documento,
	'R' ie_envio_recebe,
	'O' ie_tipo_docto,
	ie_status_integracao,
	obter_valor_dominio(7520,ie_status_integracao) ds_dominio,
	dt_atualizacao dt_integracao,
	substr(obter_desc_expressao(294850,'Ordem de compra'),1,255) ds_tipo_docto
from	w_ordem_compra a

union all

select	a.nr_sequencia,
	a.nr_requisicao nr_documento,
	'R' ie_envio_recebe,
	'R' ie_tipo_docto,
	ie_status_integracao,
	obter_valor_dominio(7520,ie_status_integracao) ds_dominio,
	dt_atualizacao dt_integracao,
	substr(obter_desc_expressao(307685,'Requisição de materiais'),1,255) ds_tipo_docto
from	sup_int_requisicao a;

