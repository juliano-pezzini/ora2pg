-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW painel_os_v (tp_reg, ds_status, qt1, qt2, qt3, qt4, qt5, qt6, qt7, qt8, qt9, qt10, qt11, qt12, qt13, qt14, qt15, qt16, qt17, qt18, qt19, qt20, qt21, qt22, qt23, qt24, qt25, qt26, qt27, qt28, qt29, qt30, qt31, ie_dia_util1, ie_dia_util2, ie_dia_util3, ie_dia_util4, ie_dia_util5, ie_dia_util6, ie_dia_util7, ie_dia_util8, ie_dia_util9, ie_dia_util10, ie_dia_util11, ie_dia_util12, ie_dia_util13, ie_dia_util14, ie_dia_util15, ie_dia_util16, ie_dia_util17, ie_dia_util18, ie_dia_util19, ie_dia_util20, ie_dia_util21, ie_dia_util22, ie_dia_util23, ie_dia_util24, ie_dia_util25, ie_dia_util26, ie_dia_util27, ie_dia_util28, ie_dia_util29, ie_dia_util30, ie_dia_util31, nm_usuario, ie_sintetico, ie_status, nr_seq_tipo, ie_tipo_campo, pr_atraso, qt_total_os, qt_total_atras) AS select 1 tp_reg,
       'DATAS' ds_status,
       max('1') qt1,
       max('2') qt2,
       max('3') qt3,
       max('4')qt4,
       max('5')qt5,
       max('6')qt6,
       max('7') qt7,
       max('8') qt8,
       max('9') qt9,
       max('10') qt10,
       max('11') qt11,
       max('12') qt12,
       max('13') qt13,
       max('14') qt14,
       max('15') qt15,
       max('16') qt16,
       max('17') qt17,
       max('18') qt18,
       max('19') qt19,
       max('20') qt20,
       max('21') qt21,
       max('22') qt22,
       max('23') qt23,
       max('24') qt24,
       max('25') qt25,
       max('26') qt26,
       max('27') qt27,
       max('28') qt28,
       max(CASE WHEN to_char(last_day(dt_ordem),'dd')='28' THEN ''  ELSE '29' END ) qt29,
       max(CASE WHEN to_char(last_day(dt_ordem),'dd')='28' THEN '' WHEN to_char(last_day(dt_ordem),'dd')='29' THEN ''  ELSE '30' END ) qt30,
       max(CASE WHEN to_char(last_day(dt_ordem),'dd')='28' THEN '' WHEN to_char(last_day(dt_ordem),'dd')='29' THEN '' WHEN to_char(last_day(dt_ordem),'dd')='30' THEN ''  ELSE '31' END ) qt31,
       max('S') ie_dia_util1,
       max('S') ie_dia_util2,
       max('S') ie_dia_util3,
       max('S') ie_dia_util4,
       max('S') ie_dia_util5,
       max('S') ie_dia_util6,
       max('S') ie_dia_util7,
       max('S') ie_dia_util8,
       max('S') ie_dia_util9,
       max('S') ie_dia_util10,
       max('S') ie_dia_util11,
       max('S') ie_dia_util12,
       max('S') ie_dia_util13,
       max('S') ie_dia_util14,
       max('S') ie_dia_util15,
       max('S') ie_dia_util16,
       max('S') ie_dia_util17,
       max('S') ie_dia_util18,
       max('S') ie_dia_util19,
       max('S') ie_dia_util20,
       max('S') ie_dia_util21,
       max('S') ie_dia_util22,
       max('S') ie_dia_util23,
       max('S') ie_dia_util24,
       max('S') ie_dia_util25,
       max('S') ie_dia_util26,
       max('S') ie_dia_util27,
       max('S') ie_dia_util28,
       max('S') ie_dia_util29,
       max('S') ie_dia_util30,
       max('S') ie_dia_util31,
       nm_usuario nm_usuario,
       'S' ie_sintetico,
       '' ie_status,
       999 nr_seq_tipo,
	ie_tipo_campo,
	0 pr_atraso,
	0 qt_total_os,
	0 qt_total_atras
FROM   w_painel_os
group by nm_usuario, ie_tipo_campo

union

select 2 tp_reg,
       'TOTAL O.S' ds_status,
       CASE WHEN sum(qt_ordem)=0 THEN ''  ELSE sum(qt_ordem) END qt1,
       CASE WHEN sum(qt_ordem2)=0 THEN ''  ELSE sum(qt_ordem2) END qt2,
       CASE WHEN sum(qt_ordem3)=0 THEN ''  ELSE sum(qt_ordem3) END qt3,
       CASE WHEN sum(qt_ordem4)=0 THEN ''  ELSE sum(qt_ordem4) END qt4,
       CASE WHEN sum(qt_ordem5)=0 THEN ''  ELSE sum(qt_ordem5) END qt5,
       CASE WHEN sum(qt_ordem6)=0 THEN ''  ELSE sum(qt_ordem6) END qt6,
       CASE WHEN sum(qt_ordem7)=0 THEN ''  ELSE sum(qt_ordem7) END qt7,
       CASE WHEN sum(qt_ordem8)=0 THEN ''  ELSE sum(qt_ordem8) END qt8,
       CASE WHEN sum(qt_ordem9)=0 THEN ''  ELSE sum(qt_ordem9) END qt9,
       CASE WHEN sum(qt_ordem10)=0 THEN ''  ELSE sum(qt_ordem10) END qt10,
       CASE WHEN sum(qt_ordem11)=0 THEN ''  ELSE sum(qt_ordem11) END qt11,
       CASE WHEN sum(qt_ordem12)=0 THEN ''  ELSE sum(qt_ordem12) END qt12,
       CASE WHEN sum(qt_ordem13)=0 THEN ''  ELSE sum(qt_ordem13) END qt13,
       CASE WHEN sum(qt_ordem14)=0 THEN ''  ELSE sum(qt_ordem14) END qt14,
       CASE WHEN sum(qt_ordem15)=0 THEN ''  ELSE sum(qt_ordem15) END qt15,
       CASE WHEN sum(qt_ordem16)=0 THEN ''  ELSE sum(qt_ordem16) END qt16,
       CASE WHEN sum(qt_ordem17)=0 THEN ''  ELSE sum(qt_ordem17) END qt17,
       CASE WHEN sum(qt_ordem18)=0 THEN ''  ELSE sum(qt_ordem18) END qt18,
       CASE WHEN sum(qt_ordem19)=0 THEN ''  ELSE sum(qt_ordem19) END qt19,
       CASE WHEN sum(qt_ordem20)=0 THEN ''  ELSE sum(qt_ordem20) END qt20,
       CASE WHEN sum(qt_ordem21)=0 THEN ''  ELSE sum(qt_ordem21) END qt21,
       CASE WHEN sum(qt_ordem22)=0 THEN ''  ELSE sum(qt_ordem22) END qt22,
       CASE WHEN sum(qt_ordem23)=0 THEN ''  ELSE sum(qt_ordem23) END qt23,
       CASE WHEN sum(qt_ordem24)=0 THEN ''  ELSE sum(qt_ordem24) END qt24,
       CASE WHEN sum(qt_ordem25)=0 THEN ''  ELSE sum(qt_ordem25) END qt25,
       CASE WHEN sum(qt_ordem26)=0 THEN ''  ELSE sum(qt_ordem26) END qt26,
       CASE WHEN sum(qt_ordem27)=0 THEN ''  ELSE sum(qt_ordem27) END qt27,
       CASE WHEN sum(qt_ordem28)=0 THEN ''  ELSE sum(qt_ordem28) END qt28,
       CASE WHEN sum(qt_ordem29)=0 THEN ''  ELSE sum(qt_ordem29) END qt29,
       CASE WHEN sum(qt_ordem30)=0 THEN ''  ELSE sum(qt_ordem30) END qt30,
       CASE WHEN sum(qt_ordem31)=0 THEN ''  ELSE sum(qt_ordem31) END qt31,
       max('S') ie_dia_util1,
       max('S') ie_dia_util2,
       max('S') ie_dia_util3,
       max('S') ie_dia_util4,
       max('S') ie_dia_util5,
       max('S') ie_dia_util6,
       max('S') ie_dia_util7,
       max('S') ie_dia_util8,
       max('S') ie_dia_util9,
       max('S') ie_dia_util10,
       max('S') ie_dia_util11,
       max('S') ie_dia_util12,
       max('S') ie_dia_util13,
       max('S') ie_dia_util14,
       max('S') ie_dia_util15,
       max('S') ie_dia_util16,
       max('S') ie_dia_util17,
       max('S') ie_dia_util18,
       max('S') ie_dia_util19,
       max('S') ie_dia_util20,
       max('S') ie_dia_util21,
       max('S') ie_dia_util22,
       max('S') ie_dia_util23,
       max('S') ie_dia_util24,
       max('S') ie_dia_util25,
       max('S') ie_dia_util26,
       max('S') ie_dia_util27,
       max('S') ie_dia_util28,
       max('S') ie_dia_util29,
       max('S') ie_dia_util30,
       max('S') ie_dia_util31,
       nm_usuario nm_usuario,
       'S' ie_sintetico,
       '' ie_status,
       999 nr_seq_tipo,
       ie_tipo_campo,
       dividir(sum(qt_atrasada) ,sum(qt_total_status)) * 100 pr_atraso,
       sum(qt_total_os) qt_total_os,
       sum(qt_total_atras) qt_total_atras
from   w_painel_os
group by nm_usuario, ie_tipo_campo

union

select 3 tp_reg,
       Upper(CASE WHEN ie_status=1 THEN 'Aberta' WHEN ie_status=2 THEN  'Processo' WHEN ie_status=3 THEN 'Encerrada' END ) ds_status,
       CASE WHEN sum(qt_ordem)=0 THEN ''  ELSE sum(qt_ordem) END qt1,
       CASE WHEN sum(qt_ordem2)=0 THEN ''  ELSE sum(qt_ordem2) END qt2,
       CASE WHEN sum(qt_ordem3)=0 THEN ''  ELSE sum(qt_ordem3) END qt3,
       CASE WHEN sum(qt_ordem4)=0 THEN ''  ELSE sum(qt_ordem4) END qt4,
       CASE WHEN sum(qt_ordem5)=0 THEN ''  ELSE sum(qt_ordem5) END qt5,
       CASE WHEN sum(qt_ordem6)=0 THEN ''  ELSE sum(qt_ordem6) END qt6,
       CASE WHEN sum(qt_ordem7)=0 THEN ''  ELSE sum(qt_ordem7) END qt7,
       CASE WHEN sum(qt_ordem8)=0 THEN ''  ELSE sum(qt_ordem8) END qt8,
       CASE WHEN sum(qt_ordem9)=0 THEN ''  ELSE sum(qt_ordem9) END qt9,
       CASE WHEN sum(qt_ordem10)=0 THEN ''  ELSE sum(qt_ordem10) END qt10,
       CASE WHEN sum(qt_ordem11)=0 THEN ''  ELSE sum(qt_ordem11) END qt11,
       CASE WHEN sum(qt_ordem12)=0 THEN ''  ELSE sum(qt_ordem12) END qt12,
       CASE WHEN sum(qt_ordem13)=0 THEN ''  ELSE sum(qt_ordem13) END qt13,
       CASE WHEN sum(qt_ordem14)=0 THEN ''  ELSE sum(qt_ordem14) END qt14,
       CASE WHEN sum(qt_ordem15)=0 THEN ''  ELSE sum(qt_ordem15) END qt15,
       CASE WHEN sum(qt_ordem16)=0 THEN ''  ELSE sum(qt_ordem16) END qt16,
       CASE WHEN sum(qt_ordem17)=0 THEN ''  ELSE sum(qt_ordem17) END qt17,
       CASE WHEN sum(qt_ordem18)=0 THEN ''  ELSE sum(qt_ordem18) END qt18,
       CASE WHEN sum(qt_ordem19)=0 THEN ''  ELSE sum(qt_ordem19) END qt19,
       CASE WHEN sum(qt_ordem20)=0 THEN ''  ELSE sum(qt_ordem20) END qt20,
       CASE WHEN sum(qt_ordem21)=0 THEN ''  ELSE sum(qt_ordem21) END qt21,
       CASE WHEN sum(qt_ordem22)=0 THEN ''  ELSE sum(qt_ordem22) END qt22,
       CASE WHEN sum(qt_ordem23)=0 THEN ''  ELSE sum(qt_ordem23) END qt23,
       CASE WHEN sum(qt_ordem24)=0 THEN ''  ELSE sum(qt_ordem24) END qt24,
       CASE WHEN sum(qt_ordem25)=0 THEN ''  ELSE sum(qt_ordem25) END qt25,
       CASE WHEN sum(qt_ordem26)=0 THEN ''  ELSE sum(qt_ordem26) END qt26,
       CASE WHEN sum(qt_ordem27)=0 THEN ''  ELSE sum(qt_ordem27) END qt27,
       CASE WHEN sum(qt_ordem28)=0 THEN ''  ELSE sum(qt_ordem28) END qt28,
       CASE WHEN sum(qt_ordem29)=0 THEN ''  ELSE sum(qt_ordem29) END qt29,
       CASE WHEN sum(qt_ordem30)=0 THEN ''  ELSE sum(qt_ordem30) END qt30,
       CASE WHEN sum(qt_ordem31)=0 THEN ''  ELSE sum(qt_ordem31) END qt31,
       max('S') ie_dia_util1,
       max('S') ie_dia_util2,
       max('S') ie_dia_util3,
       max('S') ie_dia_util4,
       max('S') ie_dia_util5,
       max('S') ie_dia_util6,
       max('S') ie_dia_util7,
       max('S') ie_dia_util8,
       max('S') ie_dia_util9,
       max('S') ie_dia_util10,
       max('S') ie_dia_util11,
       max('S') ie_dia_util12,
       max('S') ie_dia_util13,
       max('S') ie_dia_util14,
       max('S') ie_dia_util15,
       max('S') ie_dia_util16,
       max('S') ie_dia_util17,
       max('S') ie_dia_util18,
       max('S') ie_dia_util19,
       max('S') ie_dia_util20,
       max('S') ie_dia_util21,
       max('S') ie_dia_util22,
       max('S') ie_dia_util23,
       max('S') ie_dia_util24,
       max('S') ie_dia_util25,
       max('S') ie_dia_util26,
       max('S') ie_dia_util27,
       max('S') ie_dia_util28,
       max('S') ie_dia_util29,
       max('S') ie_dia_util30,
       max('S') ie_dia_util31,
       nm_usuario nm_usuario,
       'S' ie_sintetico,
       ie_status ie_status,
       999 nr_seq_tipo,
       ie_tipo_campo,
       dividir(sum(qt_atrasada) ,sum(qt_total_status)) * 100 pr_atraso,
       sum(qt_total_os) qt_total_os,
       sum(qt_total_atras) qt_total_atras
from   w_painel_os
where  ie_status = 1
group by 3, ie_status, nm_usuario, ie_tipo_campo

union

select distinct 4 tp_reg,
       '   ' || CASE WHEN nr_seq_tipo_ordem=999 THEN  'Não informado'  ELSE CASE WHEN max(ie_tipo_campo)='TC' THEN substr(MAN_OBTER_DESC_TIPO_ORDEM_SERV(nr_seq_tipo_ordem),1,100) WHEN max(ie_tipo_campo)='TD' THEN substr(obter_valor_dominio(1091,nr_seq_tipo_ordem),1,100) WHEN max(ie_tipo_campo)='EP' THEN substr(obter_desc_estagio_proc(nr_seq_tipo_ordem),1,100)  ELSE '' END  END  ds_status,
       CASE WHEN sum(qt_ordem)=0 THEN ''  ELSE sum(qt_ordem) END qt1,
       CASE WHEN sum(qt_ordem2)=0 THEN ''  ELSE sum(qt_ordem2) END qt2,
       CASE WHEN sum(qt_ordem3)=0 THEN ''  ELSE sum(qt_ordem3) END qt3,
       CASE WHEN sum(qt_ordem4)=0 THEN ''  ELSE sum(qt_ordem4) END qt4,
       CASE WHEN sum(qt_ordem5)=0 THEN ''  ELSE sum(qt_ordem5) END qt5,
       CASE WHEN sum(qt_ordem6)=0 THEN ''  ELSE sum(qt_ordem6) END qt6,
       CASE WHEN sum(qt_ordem7)=0 THEN ''  ELSE sum(qt_ordem7) END qt7,
       CASE WHEN sum(qt_ordem8)=0 THEN ''  ELSE sum(qt_ordem8) END qt8,
       CASE WHEN sum(qt_ordem9)=0 THEN ''  ELSE sum(qt_ordem9) END qt9,
       CASE WHEN sum(qt_ordem10)=0 THEN ''  ELSE sum(qt_ordem10) END qt10,
       CASE WHEN sum(qt_ordem11)=0 THEN ''  ELSE sum(qt_ordem11) END qt11,
       CASE WHEN sum(qt_ordem12)=0 THEN ''  ELSE sum(qt_ordem12) END qt12,
       CASE WHEN sum(qt_ordem13)=0 THEN ''  ELSE sum(qt_ordem13) END qt13,
       CASE WHEN sum(qt_ordem14)=0 THEN ''  ELSE sum(qt_ordem14) END qt14,
       CASE WHEN sum(qt_ordem15)=0 THEN ''  ELSE sum(qt_ordem15) END qt15,
       CASE WHEN sum(qt_ordem16)=0 THEN ''  ELSE sum(qt_ordem16) END qt16,
       CASE WHEN sum(qt_ordem17)=0 THEN ''  ELSE sum(qt_ordem17) END qt17,
       CASE WHEN sum(qt_ordem18)=0 THEN ''  ELSE sum(qt_ordem18) END qt18,
       CASE WHEN sum(qt_ordem19)=0 THEN ''  ELSE sum(qt_ordem19) END qt19,
       CASE WHEN sum(qt_ordem20)=0 THEN ''  ELSE sum(qt_ordem20) END qt20,
       CASE WHEN sum(qt_ordem21)=0 THEN ''  ELSE sum(qt_ordem21) END qt21,
       CASE WHEN sum(qt_ordem22)=0 THEN ''  ELSE sum(qt_ordem22) END qt22,
       CASE WHEN sum(qt_ordem23)=0 THEN ''  ELSE sum(qt_ordem23) END qt23,
       CASE WHEN sum(qt_ordem24)=0 THEN ''  ELSE sum(qt_ordem24) END qt24,
       CASE WHEN sum(qt_ordem25)=0 THEN ''  ELSE sum(qt_ordem25) END qt25,
       CASE WHEN sum(qt_ordem26)=0 THEN ''  ELSE sum(qt_ordem26) END qt26,
       CASE WHEN sum(qt_ordem27)=0 THEN ''  ELSE sum(qt_ordem27) END qt27,
       CASE WHEN sum(qt_ordem28)=0 THEN ''  ELSE sum(qt_ordem28) END qt28,
       CASE WHEN sum(qt_ordem29)=0 THEN ''  ELSE sum(qt_ordem29) END qt29,
       CASE WHEN sum(qt_ordem30)=0 THEN ''  ELSE sum(qt_ordem30) END qt30,
       CASE WHEN sum(qt_ordem31)=0 THEN ''  ELSE sum(qt_ordem31) END qt31,
       max(ie_dia_util1) ie_dia_util1,
       max(ie_dia_util2) ie_dia_util2,
       max(ie_dia_util3) ie_dia_util3,
       max(ie_dia_util4) ie_dia_util4,
       max(ie_dia_util5) ie_dia_util5,
       max(ie_dia_util6) ie_dia_util6,
       max(ie_dia_util7) ie_dia_util7,
       max(ie_dia_util8) ie_dia_util8,
       max(ie_dia_util9) ie_dia_util9,
       max(ie_dia_util10) ie_dia_util10,
       max(ie_dia_util11) ie_dia_util11,
       max(ie_dia_util12) ie_dia_util12,
       max(ie_dia_util13) ie_dia_util13,
       max(ie_dia_util14) ie_dia_util14,
       max(ie_dia_util15) ie_dia_util15,
       max(ie_dia_util16) ie_dia_util16,
       max(ie_dia_util17) ie_dia_util17,
       max(ie_dia_util18) ie_dia_util18,
       max(ie_dia_util19) ie_dia_util19,
       max(ie_dia_util20) ie_dia_util20,
       max(ie_dia_util21) ie_dia_util21,
       max(ie_dia_util22) ie_dia_util22,
       max(ie_dia_util23) ie_dia_util23,
       max(ie_dia_util24) ie_dia_util24,
       max(ie_dia_util25) ie_dia_util25,
       max(ie_dia_util26) ie_dia_util26,
       max(ie_dia_util27) ie_dia_util27,
       max(ie_dia_util28) ie_dia_util28,
       max(ie_dia_util29) ie_dia_util29,
       max(ie_dia_util30) ie_dia_util30,
       max(ie_dia_util31) ie_dia_util31,
       nm_usuario nm_usuario,
       '' ie_sintetico,
       ie_status ie_status,
       nr_seq_tipo_ordem nr_seq_tipo,
       ie_tipo_campo,
       sum(pr_atraso) pr_atraso,
       sum(qt_total_os) qt_total_os,
       sum(qt_total_atras) qt_total_atras
from   w_painel_os
where  ie_status = 1
group by 4, nr_seq_tipo_ordem, ie_status, nm_usuario, ie_tipo_campo

union

select distinct 5 tp_reg,
       upper(CASE WHEN ie_status=1 THEN 'Aberta' WHEN ie_status=2 THEN  'Processo' WHEN ie_status=3 THEN 'Encerrada' END ) ds_status,
       CASE WHEN sum(qt_ordem)=0 THEN ''  ELSE sum(qt_ordem) END qt1,
       CASE WHEN sum(qt_ordem2)=0 THEN ''  ELSE sum(qt_ordem2) END qt2,
       CASE WHEN sum(qt_ordem3)=0 THEN ''  ELSE sum(qt_ordem3) END qt3,
       CASE WHEN sum(qt_ordem4)=0 THEN ''  ELSE sum(qt_ordem4) END qt4,
       CASE WHEN sum(qt_ordem5)=0 THEN ''  ELSE sum(qt_ordem5) END qt5,
       CASE WHEN sum(qt_ordem6)=0 THEN ''  ELSE sum(qt_ordem6) END qt6,
       CASE WHEN sum(qt_ordem7)=0 THEN ''  ELSE sum(qt_ordem7) END qt7,
       CASE WHEN sum(qt_ordem8)=0 THEN ''  ELSE sum(qt_ordem8) END qt8,
       CASE WHEN sum(qt_ordem9)=0 THEN ''  ELSE sum(qt_ordem9) END qt9,
       CASE WHEN sum(qt_ordem10)=0 THEN ''  ELSE sum(qt_ordem10) END qt10,
       CASE WHEN sum(qt_ordem11)=0 THEN ''  ELSE sum(qt_ordem11) END qt11,
       CASE WHEN sum(qt_ordem12)=0 THEN ''  ELSE sum(qt_ordem12) END qt12,
       CASE WHEN sum(qt_ordem13)=0 THEN ''  ELSE sum(qt_ordem13) END qt13,
       CASE WHEN sum(qt_ordem14)=0 THEN ''  ELSE sum(qt_ordem14) END qt14,
       CASE WHEN sum(qt_ordem15)=0 THEN ''  ELSE sum(qt_ordem15) END qt15,
       CASE WHEN sum(qt_ordem16)=0 THEN ''  ELSE sum(qt_ordem16) END qt16,
       CASE WHEN sum(qt_ordem17)=0 THEN ''  ELSE sum(qt_ordem17) END qt17,
       CASE WHEN sum(qt_ordem18)=0 THEN ''  ELSE sum(qt_ordem18) END qt18,
       CASE WHEN sum(qt_ordem19)=0 THEN ''  ELSE sum(qt_ordem19) END qt19,
       CASE WHEN sum(qt_ordem20)=0 THEN ''  ELSE sum(qt_ordem20) END qt20,
       CASE WHEN sum(qt_ordem21)=0 THEN ''  ELSE sum(qt_ordem21) END qt21,
       CASE WHEN sum(qt_ordem22)=0 THEN ''  ELSE sum(qt_ordem22) END qt22,
       CASE WHEN sum(qt_ordem23)=0 THEN ''  ELSE sum(qt_ordem23) END qt23,
       CASE WHEN sum(qt_ordem24)=0 THEN ''  ELSE sum(qt_ordem24) END qt24,
       CASE WHEN sum(qt_ordem25)=0 THEN ''  ELSE sum(qt_ordem25) END qt25,
       CASE WHEN sum(qt_ordem26)=0 THEN ''  ELSE sum(qt_ordem26) END qt26,
       CASE WHEN sum(qt_ordem27)=0 THEN ''  ELSE sum(qt_ordem27) END qt27,
       CASE WHEN sum(qt_ordem28)=0 THEN ''  ELSE sum(qt_ordem28) END qt28,
       CASE WHEN sum(qt_ordem29)=0 THEN ''  ELSE sum(qt_ordem29) END qt29,
       CASE WHEN sum(qt_ordem30)=0 THEN ''  ELSE sum(qt_ordem30) END qt30,
       CASE WHEN sum(qt_ordem31)=0 THEN ''  ELSE sum(qt_ordem31) END qt31,
       max('S') ie_dia_util1,
       max('S') ie_dia_util2,
       max('S') ie_dia_util3,
       max('S') ie_dia_util4,
       max('S') ie_dia_util5,
       max('S') ie_dia_util6,
       max('S') ie_dia_util7,
       max('S') ie_dia_util8,
       max('S') ie_dia_util9,
       max('S') ie_dia_util10,
       max('S') ie_dia_util11,
       max('S') ie_dia_util12,
       max('S') ie_dia_util13,
       max('S') ie_dia_util14,
       max('S') ie_dia_util15,
       max('S') ie_dia_util16,
       max('S') ie_dia_util17,
       max('S') ie_dia_util18,
       max('S') ie_dia_util19,
       max('S') ie_dia_util20,
       max('S') ie_dia_util21,
       max('S') ie_dia_util22,
       max('S') ie_dia_util23,
       max('S') ie_dia_util24,
       max('S') ie_dia_util25,
       max('S') ie_dia_util26,
       max('S') ie_dia_util27,
       max('S') ie_dia_util28,
       max('S') ie_dia_util29,
       max('S') ie_dia_util30,
       max('S') ie_dia_util31,
       nm_usuario nm_usuario,
       'S' ie_sintetico,
       ie_status ie_status,
       999 nr_seq_tipo,
       ie_tipo_campo,
       dividir(sum(qt_atrasada) ,sum(qt_total_status)) * 100 pr_atraso,
       sum(qt_total_os) qt_total_os,
       sum(qt_total_atras) qt_total_atras
from   w_painel_os
where  ie_status = 2
group by 5, ie_status, nm_usuario, ie_tipo_campo

union

select distinct 6 tp_reg,
      '   ' || CASE WHEN nr_seq_tipo_ordem=999 THEN  'Não informado'  ELSE CASE WHEN max(ie_tipo_campo)='TC' THEN substr(MAN_OBTER_DESC_TIPO_ORDEM_SERV(nr_seq_tipo_ordem),1,100) WHEN max(ie_tipo_campo)='TD' THEN substr(obter_valor_dominio(1091,nr_seq_tipo_ordem),1,100) WHEN max(ie_tipo_campo)='EP' THEN substr(obter_desc_estagio_proc(nr_seq_tipo_ordem),1,100)  ELSE '' END  END  ds_status,
      CASE WHEN sum(qt_ordem)=0 THEN ''  ELSE sum(qt_ordem) END qt1,
       CASE WHEN sum(qt_ordem2)=0 THEN ''  ELSE sum(qt_ordem2) END qt2,
       CASE WHEN sum(qt_ordem3)=0 THEN ''  ELSE sum(qt_ordem3) END qt3,
       CASE WHEN sum(qt_ordem4)=0 THEN ''  ELSE sum(qt_ordem4) END qt4,
       CASE WHEN sum(qt_ordem5)=0 THEN ''  ELSE sum(qt_ordem5) END qt5,
       CASE WHEN sum(qt_ordem6)=0 THEN ''  ELSE sum(qt_ordem6) END qt6,
       CASE WHEN sum(qt_ordem7)=0 THEN ''  ELSE sum(qt_ordem7) END qt7,
       CASE WHEN sum(qt_ordem8)=0 THEN ''  ELSE sum(qt_ordem8) END qt8,
       CASE WHEN sum(qt_ordem9)=0 THEN ''  ELSE sum(qt_ordem9) END qt9,
       CASE WHEN sum(qt_ordem10)=0 THEN ''  ELSE sum(qt_ordem10) END qt10,
       CASE WHEN sum(qt_ordem11)=0 THEN ''  ELSE sum(qt_ordem11) END qt11,
       CASE WHEN sum(qt_ordem12)=0 THEN ''  ELSE sum(qt_ordem12) END qt12,
       CASE WHEN sum(qt_ordem13)=0 THEN ''  ELSE sum(qt_ordem13) END qt13,
       CASE WHEN sum(qt_ordem14)=0 THEN ''  ELSE sum(qt_ordem14) END qt14,
       CASE WHEN sum(qt_ordem15)=0 THEN ''  ELSE sum(qt_ordem15) END qt15,
       CASE WHEN sum(qt_ordem16)=0 THEN ''  ELSE sum(qt_ordem16) END qt16,
       CASE WHEN sum(qt_ordem17)=0 THEN ''  ELSE sum(qt_ordem17) END qt17,
       CASE WHEN sum(qt_ordem18)=0 THEN ''  ELSE sum(qt_ordem18) END qt18,
       CASE WHEN sum(qt_ordem19)=0 THEN ''  ELSE sum(qt_ordem19) END qt19,
       CASE WHEN sum(qt_ordem20)=0 THEN ''  ELSE sum(qt_ordem20) END qt20,
       CASE WHEN sum(qt_ordem21)=0 THEN ''  ELSE sum(qt_ordem21) END qt21,
       CASE WHEN sum(qt_ordem22)=0 THEN ''  ELSE sum(qt_ordem22) END qt22,
       CASE WHEN sum(qt_ordem23)=0 THEN ''  ELSE sum(qt_ordem23) END qt23,
       CASE WHEN sum(qt_ordem24)=0 THEN ''  ELSE sum(qt_ordem24) END qt24,
       CASE WHEN sum(qt_ordem25)=0 THEN ''  ELSE sum(qt_ordem25) END qt25,
       CASE WHEN sum(qt_ordem26)=0 THEN ''  ELSE sum(qt_ordem26) END qt26,
       CASE WHEN sum(qt_ordem27)=0 THEN ''  ELSE sum(qt_ordem27) END qt27,
       CASE WHEN sum(qt_ordem28)=0 THEN ''  ELSE sum(qt_ordem28) END qt28,
       CASE WHEN sum(qt_ordem29)=0 THEN ''  ELSE sum(qt_ordem29) END qt29,
       CASE WHEN sum(qt_ordem30)=0 THEN ''  ELSE sum(qt_ordem30) END qt30,
       CASE WHEN sum(qt_ordem31)=0 THEN ''  ELSE sum(qt_ordem31) END qt31,
       max(ie_dia_util1) ie_dia_util1,
       max(ie_dia_util2) ie_dia_util2,
       max(ie_dia_util3) ie_dia_util3,
       max(ie_dia_util4) ie_dia_util4,
       max(ie_dia_util5) ie_dia_util5,
       max(ie_dia_util6) ie_dia_util6,
       max(ie_dia_util7) ie_dia_util7,
       max(ie_dia_util8) ie_dia_util8,
       max(ie_dia_util9) ie_dia_util9,
       max(ie_dia_util10) ie_dia_util10,
       max(ie_dia_util11) ie_dia_util11,
       max(ie_dia_util12) ie_dia_util12,
       max(ie_dia_util13) ie_dia_util13,
       max(ie_dia_util14) ie_dia_util14,
       max(ie_dia_util15) ie_dia_util15,
       max(ie_dia_util16) ie_dia_util16,
       max(ie_dia_util17) ie_dia_util17,
       max(ie_dia_util18) ie_dia_util18,
       max(ie_dia_util19) ie_dia_util19,
       max(ie_dia_util20) ie_dia_util20,
       max(ie_dia_util21) ie_dia_util21,
       max(ie_dia_util22) ie_dia_util22,
       max(ie_dia_util23) ie_dia_util23,
       max(ie_dia_util24) ie_dia_util24,
       max(ie_dia_util25) ie_dia_util25,
       max(ie_dia_util26) ie_dia_util26,
       max(ie_dia_util27) ie_dia_util27,
       max(ie_dia_util28) ie_dia_util28,
       max(ie_dia_util29) ie_dia_util29,
       max(ie_dia_util30) ie_dia_util30,
       max(ie_dia_util31) ie_dia_util31,
       nm_usuario nm_usuario,
       '' ie_sintetico,
       ie_status ie_status,
       nr_seq_tipo_ordem nr_seq_tipo,
       ie_tipo_campo,
       sum(pr_atraso) pr_atraso,
       sum(qt_total_os) qt_total_os,
       sum(qt_total_atras) qt_total_atras
from   w_painel_os
where  ie_status = 2
group by 6, nr_seq_tipo_ordem, ie_status, nm_usuario, ie_tipo_campo

union

select distinct 7 tp_reg,
       upper(CASE WHEN ie_status=1 THEN 'Aberta' WHEN ie_status=2 THEN  'Processo' WHEN ie_status=3 THEN 'Encerrada' END ) ds_status,
       CASE WHEN sum(qt_ordem)=0 THEN ''  ELSE sum(qt_ordem) END qt1,
       CASE WHEN sum(qt_ordem2)=0 THEN ''  ELSE sum(qt_ordem2) END qt2,
       CASE WHEN sum(qt_ordem3)=0 THEN ''  ELSE sum(qt_ordem3) END qt3,
       CASE WHEN sum(qt_ordem4)=0 THEN ''  ELSE sum(qt_ordem4) END qt4,
       CASE WHEN sum(qt_ordem5)=0 THEN ''  ELSE sum(qt_ordem5) END qt5,
       CASE WHEN sum(qt_ordem6)=0 THEN ''  ELSE sum(qt_ordem6) END qt6,
       CASE WHEN sum(qt_ordem7)=0 THEN ''  ELSE sum(qt_ordem7) END qt7,
       CASE WHEN sum(qt_ordem8)=0 THEN ''  ELSE sum(qt_ordem8) END qt8,
       CASE WHEN sum(qt_ordem9)=0 THEN ''  ELSE sum(qt_ordem9) END qt9,
       CASE WHEN sum(qt_ordem10)=0 THEN ''  ELSE sum(qt_ordem10) END qt10,
       CASE WHEN sum(qt_ordem11)=0 THEN ''  ELSE sum(qt_ordem11) END qt11,
       CASE WHEN sum(qt_ordem12)=0 THEN ''  ELSE sum(qt_ordem12) END qt12,
       CASE WHEN sum(qt_ordem13)=0 THEN ''  ELSE sum(qt_ordem13) END qt13,
       CASE WHEN sum(qt_ordem14)=0 THEN ''  ELSE sum(qt_ordem14) END qt14,
       CASE WHEN sum(qt_ordem15)=0 THEN ''  ELSE sum(qt_ordem15) END qt15,
       CASE WHEN sum(qt_ordem16)=0 THEN ''  ELSE sum(qt_ordem16) END qt16,
       CASE WHEN sum(qt_ordem17)=0 THEN ''  ELSE sum(qt_ordem17) END qt17,
       CASE WHEN sum(qt_ordem18)=0 THEN ''  ELSE sum(qt_ordem18) END qt18,
       CASE WHEN sum(qt_ordem19)=0 THEN ''  ELSE sum(qt_ordem19) END qt19,
       CASE WHEN sum(qt_ordem20)=0 THEN ''  ELSE sum(qt_ordem20) END qt20,
       CASE WHEN sum(qt_ordem21)=0 THEN ''  ELSE sum(qt_ordem21) END qt21,
       CASE WHEN sum(qt_ordem22)=0 THEN ''  ELSE sum(qt_ordem22) END qt22,
       CASE WHEN sum(qt_ordem23)=0 THEN ''  ELSE sum(qt_ordem23) END qt23,
       CASE WHEN sum(qt_ordem24)=0 THEN ''  ELSE sum(qt_ordem24) END qt24,
       CASE WHEN sum(qt_ordem25)=0 THEN ''  ELSE sum(qt_ordem25) END qt25,
       CASE WHEN sum(qt_ordem26)=0 THEN ''  ELSE sum(qt_ordem26) END qt26,
       CASE WHEN sum(qt_ordem27)=0 THEN ''  ELSE sum(qt_ordem27) END qt27,
       CASE WHEN sum(qt_ordem28)=0 THEN ''  ELSE sum(qt_ordem28) END qt28,
       CASE WHEN sum(qt_ordem29)=0 THEN ''  ELSE sum(qt_ordem29) END qt29,
       CASE WHEN sum(qt_ordem30)=0 THEN ''  ELSE sum(qt_ordem30) END qt30,
       CASE WHEN sum(qt_ordem31)=0 THEN ''  ELSE sum(qt_ordem31) END qt31,
       max('S') ie_dia_util1,
       max('S') ie_dia_util2,
       max('S') ie_dia_util3,
       max('S') ie_dia_util4,
       max('S') ie_dia_util5,
       max('S') ie_dia_util6,
       max('S') ie_dia_util7,
       max('S') ie_dia_util8,
       max('S') ie_dia_util9,
       max('S') ie_dia_util10,
       max('S') ie_dia_util11,
       max('S') ie_dia_util12,
       max('S') ie_dia_util13,
       max('S') ie_dia_util14,
       max('S') ie_dia_util15,
       max('S') ie_dia_util16,
       max('S') ie_dia_util17,
       max('S') ie_dia_util18,
       max('S') ie_dia_util19,
       max('S') ie_dia_util20,
       max('S') ie_dia_util21,
       max('S') ie_dia_util22,
       max('S') ie_dia_util23,
       max('S') ie_dia_util24,
       max('S') ie_dia_util25,
       max('S') ie_dia_util26,
       max('S') ie_dia_util27,
       max('S') ie_dia_util28,
       max('S') ie_dia_util29,
       max('S') ie_dia_util30,
       max('S') ie_dia_util31,
       nm_usuario nm_usuario,
       'S' ie_sintetico,
       ie_status ie_status,
       999 nr_seq_tipo,
       ie_tipo_campo,
       dividir(sum(qt_atrasada) ,sum(qt_total_status)) * 100 pr_atraso,
       sum(qt_total_os) qt_total_os,
       sum(qt_total_atras) qt_total_atras
from   w_painel_os
where  ie_status = 3
group by 7, ie_status, nm_usuario, ie_tipo_campo

union

select distinct 8 tp_reg,
       '   ' || CASE WHEN nr_seq_tipo_ordem=999 THEN  'Não informado'  ELSE CASE WHEN max(ie_tipo_campo)='TC' THEN substr(MAN_OBTER_DESC_TIPO_ORDEM_SERV(nr_seq_tipo_ordem),1,100) WHEN max(ie_tipo_campo)='TD' THEN substr(obter_valor_dominio(1091,nr_seq_tipo_ordem),1,100) WHEN max(ie_tipo_campo)='EP' THEN substr(obter_desc_estagio_proc(nr_seq_tipo_ordem),1,100)  ELSE '' END  END  ds_status,
       CASE WHEN sum(qt_ordem)=0 THEN ''  ELSE sum(qt_ordem) END qt1,
       CASE WHEN sum(qt_ordem2)=0 THEN ''  ELSE sum(qt_ordem2) END qt2,
       CASE WHEN sum(qt_ordem3)=0 THEN ''  ELSE sum(qt_ordem3) END qt3,
       CASE WHEN sum(qt_ordem4)=0 THEN ''  ELSE sum(qt_ordem4) END qt4,
       CASE WHEN sum(qt_ordem5)=0 THEN ''  ELSE sum(qt_ordem5) END qt5,
       CASE WHEN sum(qt_ordem6)=0 THEN ''  ELSE sum(qt_ordem6) END qt6,
       CASE WHEN sum(qt_ordem7)=0 THEN ''  ELSE sum(qt_ordem7) END qt7,
       CASE WHEN sum(qt_ordem8)=0 THEN ''  ELSE sum(qt_ordem8) END qt8,
       CASE WHEN sum(qt_ordem9)=0 THEN ''  ELSE sum(qt_ordem9) END qt9,
       CASE WHEN sum(qt_ordem10)=0 THEN ''  ELSE sum(qt_ordem10) END qt10,
       CASE WHEN sum(qt_ordem11)=0 THEN ''  ELSE sum(qt_ordem11) END qt11,
       CASE WHEN sum(qt_ordem12)=0 THEN ''  ELSE sum(qt_ordem12) END qt12,
       CASE WHEN sum(qt_ordem13)=0 THEN ''  ELSE sum(qt_ordem13) END qt13,
       CASE WHEN sum(qt_ordem14)=0 THEN ''  ELSE sum(qt_ordem14) END qt14,
       CASE WHEN sum(qt_ordem15)=0 THEN ''  ELSE sum(qt_ordem15) END qt15,
       CASE WHEN sum(qt_ordem16)=0 THEN ''  ELSE sum(qt_ordem16) END qt16,
       CASE WHEN sum(qt_ordem17)=0 THEN ''  ELSE sum(qt_ordem17) END qt17,
       CASE WHEN sum(qt_ordem18)=0 THEN ''  ELSE sum(qt_ordem18) END qt18,
       CASE WHEN sum(qt_ordem19)=0 THEN ''  ELSE sum(qt_ordem19) END qt19,
       CASE WHEN sum(qt_ordem20)=0 THEN ''  ELSE sum(qt_ordem20) END qt20,
       CASE WHEN sum(qt_ordem21)=0 THEN ''  ELSE sum(qt_ordem21) END qt21,
       CASE WHEN sum(qt_ordem22)=0 THEN ''  ELSE sum(qt_ordem22) END qt22,
       CASE WHEN sum(qt_ordem23)=0 THEN ''  ELSE sum(qt_ordem23) END qt23,
       CASE WHEN sum(qt_ordem24)=0 THEN ''  ELSE sum(qt_ordem24) END qt24,
       CASE WHEN sum(qt_ordem25)=0 THEN ''  ELSE sum(qt_ordem25) END qt25,
       CASE WHEN sum(qt_ordem26)=0 THEN ''  ELSE sum(qt_ordem26) END qt26,
       CASE WHEN sum(qt_ordem27)=0 THEN ''  ELSE sum(qt_ordem27) END qt27,
       CASE WHEN sum(qt_ordem28)=0 THEN ''  ELSE sum(qt_ordem28) END qt28,
       CASE WHEN sum(qt_ordem29)=0 THEN ''  ELSE sum(qt_ordem29) END qt29,
       CASE WHEN sum(qt_ordem30)=0 THEN ''  ELSE sum(qt_ordem30) END qt30,
       CASE WHEN sum(qt_ordem31)=0 THEN ''  ELSE sum(qt_ordem31) END qt31,
       max(ie_dia_util1) ie_dia_util1,
       max(ie_dia_util2) ie_dia_util2,
       max(ie_dia_util3) ie_dia_util3,
       max(ie_dia_util4) ie_dia_util4,
       max(ie_dia_util5) ie_dia_util5,
       max(ie_dia_util6) ie_dia_util6,
       max(ie_dia_util7) ie_dia_util7,
       max(ie_dia_util8) ie_dia_util8,
       max(ie_dia_util9) ie_dia_util9,
       max(ie_dia_util10) ie_dia_util10,
       max(ie_dia_util11) ie_dia_util11,
       max(ie_dia_util12) ie_dia_util12,
       max(ie_dia_util13) ie_dia_util13,
       max(ie_dia_util14) ie_dia_util14,
       max(ie_dia_util15) ie_dia_util15,
       max(ie_dia_util16) ie_dia_util16,
       max(ie_dia_util17) ie_dia_util17,
       max(ie_dia_util18) ie_dia_util18,
       max(ie_dia_util19) ie_dia_util19,
       max(ie_dia_util20) ie_dia_util20,
       max(ie_dia_util21) ie_dia_util21,
       max(ie_dia_util22) ie_dia_util22,
       max(ie_dia_util23) ie_dia_util23,
       max(ie_dia_util24) ie_dia_util24,
       max(ie_dia_util25) ie_dia_util25,
       max(ie_dia_util26) ie_dia_util26,
       max(ie_dia_util27) ie_dia_util27,
       max(ie_dia_util28) ie_dia_util28,
       max(ie_dia_util29) ie_dia_util29,
       max(ie_dia_util30) ie_dia_util30,
       max(ie_dia_util31) ie_dia_util31,
       nm_usuario nm_usuario,
       '' ie_sintetico,
       ie_status ie_status,
       nr_seq_tipo_ordem nr_seq_tipo,
       ie_tipo_campo,
       sum(pr_atraso) pr_atraso,
       sum(qt_total_os) qt_total_os,
       sum(qt_total_atras) qt_total_atras
from   w_painel_os
where  ie_status = 3
group by 8,nr_seq_tipo_ordem,ie_status, nm_usuario, ie_tipo_campo
order by 1,2;

