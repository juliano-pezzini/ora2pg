-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW trans_financ_auto_complete_v (nr_sequencia, cd_estabelecimento, cd_empresa, ds_transacao, ds_trans_cod, ie_acao, cd_transacao, ie_situacao) AS select	nr_sequencia,
		cd_estabelecimento,
		cd_empresa,
		ds_transacao,
		cd_transacao || ' - ' || ds_transacao ds_trans_cod,
		ie_acao,
		cd_transacao,
		ie_situacao
FROM	transacao_financeira
where	coalesce(ie_banco,'N') <> 'N'
and		ie_situacao = 'A'
and		coalesce(ie_controle_banc, 'S') = 'S'

union all

select	nr_sequencia,
		cd_estabelecimento,
		cd_empresa,
		ds_transacao,
		cd_transacao || ' - ' || ds_transacao ds_trans_cod,
		ie_acao,
		cd_transacao,
		ie_situacao
from	transacao_financeira a
where	coalesce(ie_banco,'N') <> 'N'
and		ie_situacao = 'I'
and		coalesce(ie_controle_banc, 'S') = 'S'
and		exists (	select	1
				from	banco_saldo x,
						movto_trans_financ y
				where	x.nr_sequencia = y.nr_seq_saldo_banco
				and		y.nr_seq_trans_financ = a.nr_sequencia);

