-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW muster_12_v (nr_atendimento, diagnose1, diagnose2, diagnose3, diagnose4, einschrankungen1, einschrankungen2, einschrankungen3, vo_erst, folge, unfall, vo_vom1, vo_vom2, vo_vom3, vo_vom4, vo_vom5, vo_vom6, vo_bis1, vo_bis2, vo_bis3, vo_bis4, vo_bis5, vo_bis6, mg_praparate1, mg_praparate2, mg_praparate3, medikamentenbox, mb_tgl, mb_wtl, mb_mtl, mb_vom, mb_bis, medikamentengabe, mg_tgl, mg_wtl, mg_mtl, mg_vom, mg_bis, injektionen, herrichten, intramuskular, subkutan, vb_tgl, vb_wtl, vb_mtl, vb_vom, vb_bis, bl_erst, insulintherapie, bl_tgl, bl_wtl, bl_mtl, bl_vom, bl_bis, rechts, links, beidseits, anziehen, ausziehen, kt_tgl, kt_wtl, kt_mtl, kt_vom, kt_bis, anlegen, abnehmen, kv_tgl, kv_wtl, kv_mtl, kv_vom, kv_bis, stutzende, st_art, st_tgl, st_wtl, st_mtl, st_vom, st_bis, ws_praparate1, ws_praparate2, wundart, dekubitusbehandlung, dk_lokalisation, dk_grobe, dk_grad, dk_tgl, dk_wtl, dk_mtl, dk_vom, dk_bis, wundverbande, chronisch, wb_lokalisation, wb_grobe, wb_tgl, wb_wtl, wb_mtl, wb_vom, wb_bis, sonstige1, sg1_tgl, sg1_wtl, sg1_mtl, sg1_vom, sg1_bis, sonstige2, sg2_tgl, sg2_wtl, sg2_mtl, sg2_vom, sg2_bis, anleitung, anzahl, ut_nach, kk_nach, grundpflege, gp_tgl, gp_wtl, gp_mtl, gp_vom, gp_bis, hauswirtschaftliche, hs_tgl, hs_wtl, hs_mtl, hs_vom, hs_bis, weitere1, weitere2, weitere3, weitere4, nr_sequencia) AS select	a.nr_atendimento as nr_atendimento,
	a.cd_cid_doenca diagnose1,
	a.cd_cid_doenca2 diagnose2,
	a.cd_cid_doenca3 diagnose3,
	a.cd_cid_doenca4 diagnose4,
	obter_quebra_linha(a.ds_restricoes, 75, 1) einschrankungen1,
	obter_quebra_linha(a.ds_restricoes, 75, 2) einschrankungen2,
	obter_quebra_linha(a.ds_restricoes, 75, 3) einschrankungen3,
	CASE WHEN a.ie_primeira_prescr='S' THEN  'X'  ELSE ' ' END  vo_erst,
	CASE WHEN a.ie_primeira_prescr='F' THEN  'X'  ELSE ' ' END  folge,
	CASE WHEN a.ie_acidente='S' THEN  'X'  ELSE ' ' END  unfall,
	substr(to_char(a.dt_inicio,'ddmmyy'),1,1) vo_vom1,
	substr(to_char(a.dt_inicio,'ddmmyy'),2,1) vo_vom2,
	substr(to_char(a.dt_inicio,'ddmmyy'),3,1) vo_vom3,
	substr(to_char(a.dt_inicio,'ddmmyy'),4,1) vo_vom4,
	substr(to_char(a.dt_inicio,'ddmmyy'),5,1) vo_vom5,
	substr(to_char(a.dt_inicio,'ddmmyy'),6,1) vo_vom6,
	substr(to_char(a.dt_fim,'ddmmyy'),1,1) vo_bis1,
	substr(to_char(a.dt_fim,'ddmmyy'),2,1) vo_bis2,
	substr(to_char(a.dt_fim,'ddmmyy'),3,1) vo_bis3,
	substr(to_char(a.dt_fim,'ddmmyy'),4,1) vo_bis4,
	substr(to_char(a.dt_fim,'ddmmyy'),5,1) vo_bis5,
	substr(to_char(a.dt_fim,'ddmmyy'),6,1) vo_bis6,
	obter_quebra_linha(a.ds_dispensacao_medic, 50, 1) mg_praparate1,
	obter_quebra_linha(a.ds_dispensacao_medic, 50, 2) || obter_quebra_linha(a.ds_dispensacao_medic, 50, 3) mg_praparate2,
	obter_quebra_linha(a.ds_dispensacao_medic, 50, 4) || obter_quebra_linha(a.ds_dispensacao_medic, 50, 5) mg_praparate3,
	CASE WHEN a.ie_preparo_caixa='S' THEN  'X'  ELSE ' ' END  medikamentenbox,
	coalesce(a.qt_frequencia_caixa, '') mb_tgl,
	coalesce(a.qt_freq_caixa_semanal, '') mb_wtl,
	coalesce(a.qt_freq_caixa_mensal, '') mb_mtl,
	to_char(a.dt_de_caixa, 'dd.mm.yy') mb_vom,
	to_char(a.dt_ate_caixa, 'dd.mm.yy') mb_bis,
	CASE WHEN a.ie_dispensacao='S' THEN  'X'  ELSE ' ' END  medikamentengabe,
	coalesce(a.qt_frequencia_disp, '') mg_tgl,
	coalesce(a.qt_freq_disp_semanal, '') mg_wtl,
	coalesce(a.qt_freq_disp_mensal, '') mg_mtl,
	to_char(a.dt_de_disp, 'dd.mm.yy') mg_vom,
	to_char(a.dt_ate_disp, 'dd.mm.yy') mg_bis,
	CASE WHEN a.ie_via_aplicacao='0' THEN  'X'  ELSE ' ' END  injektionen,
	CASE WHEN a.ie_via_aplicacao='1' THEN  'X'  ELSE ' ' END  herrichten,
	CASE WHEN a.ie_via_aplicacao='2' THEN  'X'  ELSE ' ' END  intramuskular,
	CASE WHEN a.ie_via_aplicacao='3' THEN  'X'  ELSE ' ' END  subkutan,
	coalesce(a.qt_frequencia_aplic, '') vb_tgl,
	coalesce(a.qt_freq_aplic_semanal, '') vb_wtl,
	coalesce(a.qt_freq_aplic_mensal, '') vb_mtl,
	to_char(a.dt_de_aplic, 'dd.mm.yy') vb_vom,
	to_char(a.dt_ate_aplic, 'dd.mm.yy') vb_bis,
	CASE WHEN a.ie_controle_glicose='S' THEN  'X'  ELSE ' ' END  bl_erst,
	CASE WHEN a.ie_insulina_intensiva='S' THEN  'X'  ELSE ' ' END  insulintherapie,
	coalesce(a.qt_frequencia_glicose, '') bl_tgl,
	coalesce(a.qt_freq_glicose_semanal, '') bl_wtl,
	coalesce(a.qt_freq_glicose_mensal, '') bl_mtl,
	to_char(a.dt_de_glicose, 'dd.mm.yy') bl_vom,
	to_char(a.dt_ate_glicose, 'dd.mm.yy') bl_bis,
	CASE WHEN a.ie_lado='0' THEN  'X'  ELSE ' ' END  rechts,
	CASE WHEN a.ie_lado='1' THEN  'X'  ELSE ' ' END  links,
	CASE WHEN a.ie_lado='2' THEN  'X'  ELSE ' ' END  beidseits,
	CASE WHEN a.ie_colocar_meia='S' THEN  'X'  ELSE ' ' END  anziehen,
	CASE WHEN a.ie_retirar_meia='S' THEN  'X'  ELSE ' ' END  ausziehen,
	coalesce(a.qt_frequencia_meia, '') kt_tgl,
	coalesce(a.qt_freq_meia_semanal, '') kt_wtl,
	coalesce(a.qt_freq_meia_mensal, '') kt_mtl,
	to_char(a.dt_de_meia, 'dd.mm.yy') kt_vom,
	to_char(a.dt_ate_meia, 'dd.mm.yy') kt_bis,
	CASE WHEN a.ie_colocar_bandagem='S' THEN  'X'  ELSE ' ' END  anlegen,
	CASE WHEN a.ie_colocar_bandagem='S' THEN  'X'  ELSE ' ' END  abnehmen,
	coalesce(a.qt_frequencia_bandagem, '') kv_tgl,
	coalesce(a.qt_freq_bandagem_semanal, '') kv_wtl,
	coalesce(a.qt_freq_bandagem_mensal, '') kv_mtl,
	to_char(a.dt_de_bandagem, 'dd.mm.yy') kv_vom,
	to_char(a.dt_ate_bandagem, 'dd.mm.yy') kv_bis,
	CASE WHEN a.ie_bandagem_suporte='S' THEN  'X'  ELSE ' ' END  stutzende,
	substr(a.ds_tipo_band_suporte, 1, 41) st_art,
	coalesce(a.qt_frequencia_suporte, '') st_tgl,
	coalesce(a.qt_freq_suporte_semanal, '') st_wtl,
	coalesce(a.qt_freq_suporte_semanal, '') st_mtl,
	to_char(a.dt_de_suporte, 'dd.mm.yy') st_vom,
	to_char(a.dt_ate_bandagem, 'dd.mm.yy') st_bis,
	obter_quebra_linha(a.ds_tratamento_ferida, 60, 1) ws_praparate1,
	obter_quebra_linha(a.ds_tratamento_ferida, 60, 2) || obter_quebra_linha(a.ds_tratamento_ferida, 60, 3) ws_praparate2,
  obter_quebra_linha(a.ds_ferida, 60, 1) wundart,
	CASE WHEN a.ie_tratamento_decubito='S' THEN  'X'  ELSE ' ' END  dekubitusbehandlung,
	substr(a.ds_localizacao_decubito, 1, 26) dk_lokalisation,
	substr(a.ds_tamanho_decubito, 1, 17) dk_grobe,
	substr(a.ds_grau_decubito, 1, 17) dk_grad,
	coalesce(a.qt_frequencia_decubito, '') dk_tgl,
	coalesce(a.qt_freq_decubito_semanal, '') dk_wtl,
	coalesce(a.qt_freq_decubito_mensal, '') dk_mtl,
	to_char(a.dt_de_decubito, 'dd.mm.yy') dk_vom,
	to_char(a.dt_ate_decubito, 'dd.mm.yy') dk_bis,
	CASE WHEN a.ie_outros_curativos='S' THEN  'X'  ELSE ' ' END  wundverbande,
	CASE WHEN a.ie_ferida_cronica='S' THEN  'X'  ELSE ' ' END  chronisch,
  substr(a.ds_localizacao_curativos, 1, 26) wb_lokalisation,
	substr(a.ds_tamanho_curativos, 1, 17) wb_grobe,
	coalesce(a.qt_frequencia_curativos, '') wb_tgl,
	coalesce(a.qt_freq_curativos_semanal, '') wb_wtl,
	coalesce(a.qt_freq_curativos_mensal, '') wb_mtl,
	to_char(a.dt_de_curativos, 'dd.mm.yy') wb_vom,
	to_char(a.dt_ate_curativos, 'dd.mm.yy') wb_bis,
	substr(a.ds_medida_trat, 1, 93) sonstige1,
	coalesce(a.qt_frequencia_trat, '') sg1_tgl,
	coalesce(a.qt_freq_trat_semanal, '') sg1_wtl,
	coalesce(a.qt_freq_trat_mensal, '') sg1_mtl,
	to_char(a.dt_de_trat, 'dd.mm.yy') sg1_vom,
	to_char(a.dt_ate_trat, 'dd.mm.yy') sg1_bis,
	substr(a.ds_medida_trat2, 1, 93) sonstige2,
	coalesce(a.qt_frequencia_trat2, '') sg2_tgl,
	coalesce(a.qt_freq_trat2_semanal, '') sg2_wtl,
	coalesce(a.qt_freq_trat2_mensal, '') sg2_mtl,
	to_char(a.dt_de_trat2, 'dd.mm.yy') sg2_vom,
	to_char(a.dt_ate_trat2, 'dd.mm.yy') sg2_bis,
	substr(a.ds_instrucoes, 1, 93) anleitung,
	substr(a.ds_instrucoes, 1, 26) anzahl,
	CASE WHEN a.ie_apos_tratamento='S' THEN  'X'  ELSE ' ' END  ut_nach,
	CASE WHEN a.ie_apos_internacao='S' THEN  'X'  ELSE ' ' END  kk_nach,
	CASE WHEN a.ie_tratamento_normal='S' THEN  'X'  ELSE ' ' END  grundpflege,
	coalesce(a.qt_frequencia_cuidado_diario, '') gp_tgl,
	coalesce(a.qt_freq_cuidado_diario_semanal, '') gp_wtl,
	coalesce(a.qt_freq_cuidado_diario_mensal, '') gp_mtl,
	to_char(a.dt_de_basico, 'dd.mm.yy') gp_vom,
	to_char(a.dt_ate_basico, 'dd.mm.yy') gp_bis,
	CASE WHEN a.ie_home_care='S' THEN  'X'  ELSE ' ' END  hauswirtschaftliche,
	coalesce(a.qt_frequencia_cuidado, '') hs_tgl,
	coalesce(a.qt_freq_cuidado_semanal, '') hs_wtl,
	coalesce(a.qt_freq_cuidado_mensal, '') hs_mtl,
	to_char(a.dt_de_hc, 'dd.mm.yy') hs_vom,
	to_char(a.dt_ate_hc, 'dd.mm.yy') hs_bis,
	obter_quebra_linha(a.ds_observacao, 75, 1) weitere1,
	obter_quebra_linha(a.ds_observacao, 75, 2) weitere2,
	obter_quebra_linha(a.ds_observacao, 75, 3) weitere3,
	obter_quebra_linha(a.ds_observacao, 75, 4) weitere4,
	a.nr_sequencia
FROM 	formulario_home_care a,
	atendimento_paciente b,
	pessoa_fisica c,
	pessoa_fisica d
where	a.nr_atendimento = b.nr_atendimento
and	b.cd_pessoa_fisica = c.cd_pessoa_fisica
and	b.cd_medico_resp = d.cd_pessoa_fisica;

