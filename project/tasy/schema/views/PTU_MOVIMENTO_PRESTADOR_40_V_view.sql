-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_movimento_prestador_40_v (tp_registro, ie_ordem, ie_ordem_2, nr_sequencia, cd_tipo_registro, cd_unimed_des, cd_unimed_ori, dt_geracao, nr_versao_trans, sg_cons_diretor_tecnico, sg_uf_cons_diretor_tecnico, ie_tipo_rede_min, ie_tipo_prestador, cd_prestador, cd_cgc_cpf402, cd_insc_est, nr_crm, cd_uf_crm, nm_prestador, nm_fantasia, ie_tipo_vinculo, dt_inclusao_uni, dt_exclusao_uni, ie_tipo_contratualizacao, ie_tipo_class_estabelecimento, ie_categoria_diferente, ie_acidente_trabalho, ie_urgencia_emergencia, dt_inicio_serv, dt_inicio_contrato, nr_registro_ans, nm_diretor_tecnico, nr_crm_diretor_tec, ie_tipo_disponibilidade, ie_tabela_propria, cd_perfil_assist_hosp, ie_tipo_produto, ie_guia_medico, ie_registro_cert1, ie_registro_atua1, ie_registro_cert2, ie_registro_atua2, reservado, ie_tipo_endereco, ds_endereco, nr_endereco, ds_complemento, ds_bairro, cd_municipio, nr_cep, nr_ddd, nr_fone_1, nr_fone_2, nr_fax, ds_email, ds_endereco_web, cd_cnes, nr_leitos_totais, nr_leito_contrato, nr_leitos_psiquiatria, nr_uti_adulto, nr_uti_neonatal, nr_uti_pediatria, cd_cgc_cpf, cd_grupo_servico, cd_rede, nm_rede, qt_tot_r402, qt_tot_r403, qt_tot_r404, qt_tot_r405, nr_seq_movimento, nr_seq_endereco, cd_espec_1, cd_atua_1, cd_espec_2, cd_atua_2, reservado7, nr_seq_prestador, ie_guia_medico_espec_1, ie_guia_medico_espec_2, ie_guia_medico_atua_1, ie_guia_medico_atua_2, nr_leitos_intermed, ie_filial, cd_imposto, vl_imposto, ie_prest_acred, ds_inst_acred, ie_nivel_acred, ie_particip_notivisa, ie_particip_qualiss_ans, nr_leitos_hosp_dia, nr_rce_espec_1, nr_rce_espec_2, qt_tot_r407, qt_tot_r408) AS select	/* + CHOOSE */
	1				tp_registro, 
	1				ie_ordem, 
	1				ie_ordem_2, 
	1				nr_sequencia, 
	'401'				cd_tipo_registro, 
	cd_unimed_destino		cd_unimed_des, 
	cd_unimed_origem		cd_unimed_ori, 
	dt_geracao			dt_geracao, 
	18				nr_versao_trans, 
	null				sg_cons_diretor_tecnico, 
	null				sg_uf_cons_diretor_tecnico,	 
	null				ie_tipo_rede_min, 
	null				ie_tipo_prestador, 
	null				cd_prestador, 
	null				cd_cgc_cpf402, 
	null				cd_insc_est, 
	null				nr_crm, 
	null				cd_uf_crm, 
	null				nm_prestador, 
	null				nm_fantasia, 
	null				ie_tipo_vinculo, 
	null				dt_inclusao_uni, 
	null				dt_exclusao_uni, 
	null				ie_tipo_contratualizacao, 
	null				ie_tipo_class_estabelecimento, 
	null				ie_categoria_diferente, 
	null				ie_acidente_trabalho, 
	null				ie_urgencia_emergencia, 
	null				dt_inicio_serv, 
	null				dt_inicio_contrato, 
	null				nr_registro_ans, 
	null				nm_diretor_tecnico, 
	null				nr_crm_diretor_tec, 
	null				ie_tipo_disponibilidade, 
	null				ie_tabela_propria, 
	null				cd_perfil_assist_hosp, 
	null				ie_tipo_produto, 
	null				ie_guia_medico, 
	null				ie_registro_cert1, 
	null				ie_registro_atua1, 
	null				ie_registro_cert2, 
	null				ie_registro_atua2, 
	null				reservado, 
	null				ie_tipo_endereco, 
	null				ds_endereco, 
	null				nr_endereco, 
	null				ds_complemento, 
	null				ds_bairro, 
	null				cd_municipio, 
	null				nr_cep, 
	null				nr_ddd, 
	null				nr_fone_1, 
	null				nr_fone_2, 
	null				nr_fax, 
	null				ds_email, 
	null				ds_endereco_web, 
	null				cd_cnes, 
	null				nr_leitos_totais, 
	null				nr_leito_contrato, 
	null				nr_leitos_psiquiatria, 
	null				nr_uti_adulto, 
	null				nr_uti_neonatal, 
	null				nr_uti_pediatria, 
	null				cd_cgc_cpf, 
	null				cd_grupo_servico, 
	null				cd_rede, 
	null				nm_rede, 
	null				qt_tot_r402, 
	null				qt_tot_r403, 
	null				qt_tot_r404, 
	null				qt_tot_r405, 
	nr_sequencia			nr_seq_movimento, 
	0				nr_seq_endereco, 
	null				cd_espec_1, 
	null				cd_atua_1, 
	null				cd_espec_2, 
	null				cd_atua_2, 
	null				reservado7, 
	0				nr_seq_prestador, 
	null				ie_guia_medico_espec_1, 
	null				ie_guia_medico_espec_2, 
	null				ie_guia_medico_atua_1, 
	null				ie_guia_medico_atua_2, 
	null				nr_leitos_intermed, 
	null				ie_filial, 
	null				cd_imposto, 
	null				vl_imposto, 
	null				ie_prest_acred, 
	null				ds_inst_acred, 
	null				ie_nivel_acred, 
	null 				ie_particip_notivisa, 
	null				ie_particip_qualiss_ans, 
	null				nr_leitos_hosp_dia, 
	null				nr_rce_espec_1, 
	null				nr_rce_espec_2, 
	null				qt_tot_r407, 
	null				qt_tot_r408 
FROM	ptu_movimento_prestador 

union all
	 
select	2				tp_registro, 
	2				ie_ordem, 
	3				ie_ordem_2, 
	2				nr_sequencia, 
	'402'				cd_tipo_registro, 
	null				cd_unimed_des, 
	null				cd_unimed_ori, 
	null				dt_geracao, 
	null				nr_versao_trans, 
	rpad(substr(obter_conselho_profissional(a.nr_seq_conselho,'S'),1,255),12,' ') sg_cons_diretor_tecnico, 
	lpad(a.sg_uf_cons_diretor_tecnico,2,' ')	sg_uf_cons_diretor_tecnico,	 
	coalesce(a.ie_tipo_rede_min,'0')		ie_tipo_rede_min, 
	lpad(a.ie_tipo_prestador,2,'0')		ie_tipo_prestador, 
	lpad(a.cd_prestador,8,'0')		cd_prestador, 
	null				cd_cgc_cpf402, 
	lpad(coalesce(a.nr_insc_estadual,'0'),20,'0')		cd_insc_est, 
	lpad(coalesce(a.nr_crm,'0'),8,'0')			nr_crm, 
	rpad(coalesce(a.uf_crm,' '),2,' ')			cd_uf_crm, 
	rpad(trim(both substr(elimina_acentuacao(a.nm_prestador),1,40)),40,' ')			nm_prestador, 
	rpad(substr(elimina_acentuacao(a.nm_fantasia),1,40),40,' ')			nm_fantasia, 
	lpad(a.ie_tipo_vinculo,1,'0')		ie_tipo_vinculo, 
	a.dt_inclusao			dt_inclusao_uni, 
	a.dt_exclusao			dt_exclusao_uni, 
	lpad(a.ie_tipo_contratualizacao,1,' ')	ie_tipo_contratualizacao, 
	lpad(a.ie_tipo_classif_estab,1,' ')		ie_tipo_class_estabelecimento, 
	lpad(a.ie_categoria_dif,1,' ')		ie_categoria_diferente, 
	lpad(a.ie_acidente_trabalho,1,' ')		ie_acidente_trabalho, 
	lpad(a.ie_urgencia_emerg,1,' ')		ie_urgencia_emergencia, 
	a.dt_inicio_servico		dt_inicio_serv, 
	a.dt_inicio_contrato		dt_inicio_contrato, 
	lpad(a.nr_registro_ans,6,' ')		nr_registro_ans, 
	rpad(a.nm_diretor_tecnico,40,' ')		nm_diretor_tecnico, 
	rpad(a.nr_cons_diretor_tecnico,15,' ')	nr_crm_diretor_tec, 
	lpad(a.ie_tipo_disponibilidade,1,'0')	ie_tipo_disponibilidade, 
	lpad(a.ie_tabela_propria,1,' ')		ie_tabela_propria, 
	lpad(a.ie_perfil_assistencial,2,'0')	cd_perfil_assist_hosp, 
	lpad(a.ie_tipo_produto,1,'0')		ie_tipo_produto, 
	CASE WHEN a.ie_tipo_prestador=1 THEN lpad(null,1,' ')  ELSE a.ie_guia_medico END 		ie_guia_medico, 
	lpad(substr(obter_ptu_especialidade_rce(a.nr_sequencia, 1,'IE_RCE_F'),1,1),1,' ')	ie_registro_cert1, 
	lpad(substr(obter_ptu_especialidade_rce(a.nr_sequencia, 1,'IE_ATUA_F'),1,1),1,' ')		ie_registro_atua1, 
	lpad(substr(obter_ptu_especialidade_rce(a.nr_sequencia, 2,'IE_RCE_F'),1,1),1,' ')		ie_registro_cert2, 
	lpad(substr(obter_ptu_especialidade_rce(a.nr_sequencia, 2,'IE_ATUA_F'),1,1),1,' ')		ie_registro_atua2, 
	' '				reservado, 
	null				ie_tipo_endereco, 
	null				ds_endereco, 
	null				nr_endereco, 
	null				ds_complemento, 
	null				ds_bairro, 
	null				cd_municipio, 
	null				nr_cep, 
	null				nr_ddd, 
	null				nr_fone_1, 
	null				nr_fone_2, 
	null				nr_fax, 
	null				ds_email, 
	null				ds_endereco_web, 
	null				cd_cnes, 
	null				nr_leitos_totais, 
	null				nr_leito_contrato, 
	null				nr_leitos_psiquiatria, 
	null				nr_uti_adulto, 
	null				nr_uti_neonatal, 
	null				nr_uti_pediatria, 
	lpad(a.cd_cgc_cpf,15,'0')	cd_cgc_cpf, 
	null				cd_grupo_servico, 
	null				cd_rede, 
	null				nm_rede, 
	null				qt_tot_r402, 
	null				qt_tot_r403, 
	null				qt_tot_r404, 
	null				qt_tot_r405, 
	a.nr_seq_movimento		nr_seq_movimento, 
	0				nr_seq_endereco, 
	CASE WHEN a.ie_tipo_prestador=1 THEN substr(obter_ptu_especialidade_rce(a.nr_sequencia, 1,'CD_ESPEC'),1,2)  ELSE '00' END  cd_espec_1, 
	CASE WHEN a.ie_tipo_prestador=1 THEN lpad(obter_ptu_especialidade_rce(a.nr_sequencia, 1,'CD_ATUA'),2,' ')  ELSE '00' END  cd_atua_1, 
	CASE WHEN a.ie_tipo_prestador=1 THEN substr(obter_ptu_especialidade_rce(a.nr_sequencia, 2,'CD_ESPEC'),1,2)  ELSE '00' END  cd_espec_2, 
	CASE WHEN a.ie_tipo_prestador=1 THEN lpad(obter_ptu_especialidade_rce(a.nr_sequencia, 2,'CD_ATUA'),2,' ')  ELSE '00' END  cd_atua_2, 
	' '				reservado7, 
	a.nr_sequencia			nr_seq_prestador, 
	lpad(substr(obter_ptu_especialidade_rce(a.nr_sequencia, 1,'IE_GUIA_ESPEC'),1,1),1,'N')		ie_guia_medico_espec_1, 
	lpad(substr(obter_ptu_especialidade_rce(a.nr_sequencia, 2,'IE_GUIA_ESPEC'),1,1),1,'N')		ie_guia_medico_espec_2, 
	lpad(substr(obter_ptu_especialidade_rce(a.nr_sequencia, 1,'IE_GUIA_ATUA'),1,1),1,' ')		ie_guia_medico_atua_1, 
	lpad(substr(obter_ptu_especialidade_rce(a.nr_sequencia, 2,'IE_GUIA_ATUA'),1,1),1,' ')		ie_guia_medico_atua_2, 
	null				nr_leitos_intermed, 
	null				ie_filial, 
	null				cd_imposto, 
	null				vl_imposto, 
	CASE WHEN a.ie_tipo_prestador=1 THEN ' ' 				  WHEN a.ie_tipo_prestador=5 THEN ' ' 				  WHEN a.ie_tipo_prestador=7 THEN ' '  ELSE CASE WHEN a.ie_instituicao_acred_ptu IS NULL THEN  'N'  ELSE 'S' END  END  ie_prest_acred, 
	null ds_inst_acred, --nvl(a.ie_instituicao_acred_ptu,'   ')	ds_inst_acred, 
	null ie_nivel_acred, --nvl(a.ie_nivel_acreditacao_ptu,'0')	ie_nivel_acred 
	coalesce(a.ie_notivisa,'N') ie_particip_notivisa, 
	coalesce(a.ie_particip_qualiss_ans,'N'), 
	null				nr_leitos_hosp_dia, 
	lpad(substr(obter_ptu_especialidade_rce(a.nr_sequencia, 1,'NR_RCE'),1,10),10,0)	nr_rce_espec_1, 
	lpad(substr(obter_ptu_especialidade_rce(a.nr_sequencia, 2,'NR_RCE'),1,10),10,0)	nr_rce_espec_2, 
	null				qt_tot_r407, 
	null				qt_tot_r408 
from	ptu_prestador		a 

union all
 
select	3				tp_registro, 
	2				ie_ordem, 
	3				ie_ordem_2, 
	3				nr_sequencia, 
	'403'				cd_tipo_registro, 
	null				cd_unimed_des, 
	null				cd_unimed_ori, 
	null				dt_geracao, 
	null				nr_versao_trans, 
	null				sg_cons_diretor_tecnico, 
	null				sg_uf_cons_diretor_tecnico,	 
	null				ie_tipo_rede_min, 
	null				ie_tipo_prestador, 
	null				cd_prestador, 
	null				cd_cgc_cpf402, 
	null				cd_insc_est, 
	null				nr_crm, 
	null				cd_uf_crm, 
	null				nm_prestador, 
	null				nm_fantasia, 
	null				ie_tipo_vinculo, 
	null				dt_inclusao_uni, 
	null				dt_exclusao_uni, 
	null				ie_tipo_contratualizacao, 
	null				ie_tipo_class_estabelecimento, 
	null				ie_categoria_diferente, 
	null				ie_acidente_trabalho, 
	null				ie_urgencia_emergencia, 
	null				dt_inicio_serv, 
	null				dt_inicio_contrato, 
	null				nr_registro_ans, 
	null				nm_diretor_tecnico, 
	null				nr_crm_diretor_tec, 
	null				ie_tipo_disponibilidade, 
	null				ie_tabela_propria, 
	null				cd_perfil_assist_hosp, 
	null				ie_tipo_produto, 
	null				ie_guia_medico, 
	null				ie_registro_cert1, 
	null				ie_registro_atua1, 
	null				ie_registro_cert2, 
	null				ie_registro_atua2, 
	null				reservado, 
	b.ie_tipo_endereco		ie_tipo_endereco, 
	substr(elimina_acentuacao(b.ds_endereco),1,40)			ds_endereco, 
	b.nr_endereco			nr_endereco, 
	substr(elimina_acentuacao(b.ds_complemento),1,15)		ds_complemento, 
	substr(elimina_acentuacao(b.ds_bairro),1,30)			ds_bairro, 
	lpad(b.cd_municipio_ibge,6,'0') || calcula_digito('MODULO10',lpad(b.cd_municipio_ibge,6,'0'))	cd_municipio, 
	b.cd_cep			nr_cep, 
	b.nr_ddd			nr_ddd, 
	b.nr_telefone			nr_fone_1, 
	b.nr_telefone_dois		nr_fone_2, 
	b.nr_fax			nr_fax, 
	substr(elimina_acentuacao(b.ds_email),1,40)			ds_email, 
	substr(elimina_acentuacao(b.ds_endereco_web),1,50)		ds_endereco_web, 
	substr(elimina_acentuacao(b.cd_cnes),1,7)			cd_cnes, 
	b.nr_leitos_totais		nr_leitos_totais, 
	b.nr_leitos_contrat		nr_leito_contrato, 
	b.nr_leitos_psiquiatria		nr_leitos_psiquiatria, 
	b.nr_uti_adulto			nr_uti_adulto, 
	b.nr_uti_neonatal		nr_uti_neonatal, 
	b.nr_uti_pediatria		nr_uti_pediatria, 
	a.cd_cgc_cpf			cd_cgc_cpf, 
	null				cd_grupo_servico, 
	null				cd_rede, 
	null				nm_rede, 
	null				qt_tot_r402, 
	null				qt_tot_r403, 
	null				qt_tot_r404, 
	null				qt_tot_r405, 
	a.nr_seq_movimento		nr_seq_movimento, 
	b.nr_sequencia			nr_seq_endereco, 
	null				cd_espec_1, 
	null				cd_atua_1, 
	null				cd_espec_2, 
	null				cd_atua_2, 
	null				reservado7, 
	a.nr_sequencia			nr_seq_prestador, 
	null				ie_guia_medico_espec_1, 
	null				ie_guia_medico_espec_2, 
	null				ie_guia_medico_atua_1, 
	null				ie_guia_medico_atua_2, 
	b.nr_leitos_intermed		nr_leitos_intermed, 
	'N'				ie_filial, 
	null				cd_imposto, 
	null				vl_imposto, 
	null				ie_prest_acred, 
	null				ds_inst_acred, 
	null				ie_nivel_acred, 
	null 				ie_particip_notivisa, 
	null				ie_particip_qualiss_ans, 
	b.nr_leitos_hosp_dia, 
	null				nr_rce_espec_1, 
	null				nr_rce_espec_2, 
	null				qt_tot_r407, 
	null				qt_tot_r408 
from	ptu_prestador_endereco		b, 
	ptu_prestador			a 
where	b.nr_seq_prestador	= a.nr_sequencia 

union all
 
select	4				tp_registro, 
	2				ie_ordem, 
	4				ie_ordem_2, 
	4				nr_sequencia, 
	'404'				cd_tipo_registro, 
	null				cd_unimed_des, 
	null				cd_unimed_ori, 
	null				dt_geracao, 
	null				nr_versao_trans, 
	null				sg_cons_diretor_tecnico, 
	null				sg_uf_cons_diretor_tecnico,	 
	null				ie_tipo_rede_min, 
	null				ie_tipo_prestador, 
	null				cd_prestador, 
	null				cd_cgc_cpf402, 
	null				cd_insc_est, 
	null				nr_crm, 
	null				cd_uf_crm, 
	null				nm_prestador, 
	null				nm_fantasia, 
	null				ie_tipo_vinculo, 
	null				dt_inclusao_uni, 
	null				dt_exclusao_uni, 
	null				ie_tipo_contratualizacao, 
	null				ie_tipo_class_estabelecimento, 
	null				ie_categoria_diferente, 
	null				ie_acidente_trabalho, 
	null				ie_urgencia_emergencia, 
	null				dt_inicio_serv, 
	null				dt_inicio_contrato, 
	null				nr_registro_ans, 
	null				nm_diretor_tecnico, 
	null				nr_crm_diretor_tec, 
	null				ie_tipo_disponibilidade, 
	null				ie_tabela_propria, 
	null				cd_perfil_assist_hosp, 
	null				ie_tipo_produto, 
	null				ie_guia_medico, 
	null				ie_registro_cert1, 
	null				ie_registro_atua1, 
	null				ie_registro_cert2, 
	null				ie_registro_atua2, 
	null				reservado, 
	null				ie_tipo_endereco, 
	null				ds_endereco, 
	null				nr_endereco, 
	null				ds_complemento, 
	null				ds_bairro, 
	null				cd_municipio, 
	null				nr_cep, 
	null				nr_ddd, 
	null				nr_fone_1, 
	null				nr_fone_2, 
	null				nr_fax, 
	null				ds_email, 
	null				ds_endereco_web, 
	null				cd_cnes, 
	null				nr_leitos_totais, 
	null				nr_leito_contrato, 
	null				nr_leitos_psiquiatria, 
	null				nr_uti_adulto, 
	null				nr_uti_neonatal, 
	null				nr_uti_pediatria, 
	null				cd_cgc_cpf, 
	b.cd_grupo_servico		cd_grupo_servico, 
	null				cd_rede, 
	null				nm_rede, 
	null				qt_tot_r402, 
	null				qt_tot_r403, 
	null				qt_tot_r404, 
	null				qt_tot_r405, 
	a.nr_seq_movimento		nr_seq_movimento, 
	b.nr_seq_endereco +1		nr_seq_endereco, 
	null				cd_espec_1, 
	null				cd_atua_1, 
	null				cd_espec_2, 
	null				cd_atua_2, 
	null				reservado7, 
	a.nr_sequencia			nr_seq_prestador, 
	null				ie_guia_medico_espec_1, 
	null				ie_guia_medico_espec_2, 
	null				ie_guia_medico_atua_1, 
	null				ie_guia_medico_atua_2, 
	null				nr_leitos_intermed, 
	null				ie_filial, 
	null				cd_imposto, 
	null				vl_imposto, 
	null				ie_prest_acred, 
	null				ds_inst_acred, 
	null				ie_nivel_acred, 
	null				ie_particip_notivisa, 
	null				ie_particip_qualiss_ans, 
	null				nr_leitos_hosp_dia, 
	null				nr_rce_espec_1, 
	null				nr_rce_espec_2, 
	null				qt_tot_r407, 
	null				qt_tot_r408 
from	ptu_prestador			a, 
	ptu_prestador_grupo_serv	b, 
	ptu_prestador_endereco		c 
where	b.nr_seq_endereco	= c.nr_sequencia 
and	c.nr_seq_prestador	= a.nr_sequencia 

union all
 
select	5				tp_registro, 
	2				ie_ordem, 
	5				ie_ordem_2, 
	5				nr_sequencia, 
	'405'				cd_tipo_registro, 
	null				cd_unimed_des, 
	null				cd_unimed_ori, 
	null				dt_geracao, 
	null				nr_versao_trans, 
	null				sg_cons_diretor_tecnico, 
	null				sg_uf_cons_diretor_tecnico,	 
	null				ie_tipo_rede_min, 
	null				ie_tipo_prestador, 
	null				cd_prestador, 
	null				cd_cgc_cpf402, 
	null				cd_insc_est, 
	null				nr_crm, 
	null				cd_uf_crm, 
	null				nm_prestador, 
	null				nm_fantasia, 
	null				ie_tipo_vinculo, 
	null				dt_inclusao_uni, 
	null				dt_exclusao_uni, 
	null				ie_tipo_contratualizacao, 
	null				ie_tipo_class_estabelecimento, 
	null				ie_categoria_diferente, 
	null				ie_acidente_trabalho, 
	null				ie_urgencia_emergencia, 
	null				dt_inicio_serv, 
	null				dt_inicio_contrato, 
	null				nr_registro_ans, 
	null				nm_diretor_tecnico, 
	null				nr_crm_diretor_tec, 
	null				ie_tipo_disponibilidade, 
	null				ie_tabela_propria, 
	null				cd_perfil_assist_hosp, 
	null				ie_tipo_produto, 
	null				ie_guia_medico, 
	null				ie_registro_cert1, 
	null				ie_registro_atua1, 
	null				ie_registro_cert2, 
	null				ie_registro_atua2, 
	null				reservado, 
	null				ie_tipo_endereco, 
	null				ds_endereco, 
	null				nr_endereco, 
	null				ds_complemento, 
	null				ds_bairro, 
	null				cd_municipio, 
	null				nr_cep, 
	null				nr_ddd, 
	null				nr_fone_1, 
	null				nr_fone_2, 
	null				nr_fax, 
	null				ds_email, 
	null				ds_endereco_web, 
	null				cd_cnes, 
	null				nr_leitos_totais, 
	null				nr_leito_contrato, 
	null				nr_leitos_psiquiatria, 
	null				nr_uti_adulto, 
	null				nr_uti_neonatal, 
	null				nr_uti_pediatria, 
	null				cd_cgc_cpf, 
	null				cd_grupo_servico, 
	substr(elimina_acentuacao(b.cd_rede),1,5)			cd_rede, 
	substr(elimina_acentuacao(b.nm_rede),1,40)			nm_rede, 
	null				qt_tot_r402, 
	null				qt_tot_r403, 
	null				qt_tot_r404, 
	null				qt_tot_r405, 
	a.nr_seq_movimento		nr_seq_movimento, 
	9999999				nr_seq_endereco, 
	null				cd_espec_1, 
	null				cd_atua_1, 
	null				cd_espec_2, 
	null				cd_atua_2, 
	null				reservado7, 
	a.nr_sequencia			nr_seq_prestador, 
	null				ie_guia_medico_espec_1, 
	null				ie_guia_medico_espec_2, 
	null				ie_guia_medico_atua_1, 
	null				ie_guia_medico_atua_2, 
	null				nr_leitos_intermed, 
	null				ie_filial, 
	null				cd_imposto, 
	null				vl_imposto, 
	null				ie_prest_acred, 
	null				ds_inst_acred, 
	null				ie_nivel_acred, 
	null				ie_particip_notivisa, 
	null				ie_particip_qualiss_ans, 
	null				nr_leitos_hosp_dia, 
	null				nr_rce_espec_1, 
	null				nr_rce_espec_2, 
	null				qt_tot_r407, 
	null				qt_tot_r408 
from	ptu_prestador_rede_ref	b, 
	ptu_prestador		a 
where	b.nr_seq_prestador	= a.nr_sequencia 

union all
 
select	6				tp_registro, 
	2				ie_ordem, 
	6				ie_ordem_2, 
	6				nr_sequencia, 
	'408'				cd_tipo_registro, 
	null				cd_unimed_des, 
	null				cd_unimed_ori, 
	null				dt_geracao, 
	null				nr_versao_trans, 
	null				sg_cons_diretor_tecnico, 
	null				sg_uf_cons_diretor_tecnico,	 
	null				ie_tipo_rede_min, 
	null				ie_tipo_prestador, 
	null				cd_prestador, 
	null				cd_cgc_cpf402, 
	null				cd_insc_est, 
	null				nr_crm, 
	null				cd_uf_crm, 
	null				nm_prestador, 
	null				nm_fantasia, 
	null				ie_tipo_vinculo, 
	null				dt_inclusao_uni, 
	null				dt_exclusao_uni, 
	null				ie_tipo_contratualizacao, 
	null				ie_tipo_class_estabelecimento, 
	null				ie_categoria_diferente, 
	null				ie_acidente_trabalho, 
	null				ie_urgencia_emergencia, 
	null				dt_inicio_serv, 
	null				dt_inicio_contrato, 
	null				nr_registro_ans, 
	null				nm_diretor_tecnico, 
	null				nr_crm_diretor_tec, 
	null				ie_tipo_disponibilidade, 
	null				ie_tabela_propria, 
	null				cd_perfil_assist_hosp, 
	null				ie_tipo_produto, 
	null				ie_guia_medico, 
	null				ie_registro_cert1, 
	null				ie_registro_atua1, 
	null				ie_registro_cert2, 
	null				ie_registro_atua2, 
	null				reservado, 
	null				ie_tipo_endereco, 
	null				ds_endereco, 
	null				nr_endereco, 
	null				ds_complemento, 
	null				ds_bairro, 
	null				cd_municipio, 
	null				nr_cep, 
	null				nr_ddd, 
	null				nr_fone_1, 
	null				nr_fone_2, 
	null				nr_fax, 
	null				ds_email, 
	null				ds_endereco_web, 
	null				cd_cnes, 
	null				nr_leitos_totais, 
	null				nr_leito_contrato, 
	null				nr_leitos_psiquiatria, 
	null				nr_uti_adulto, 
	null				nr_uti_neonatal, 
	null				nr_uti_pediatria, 
	null				cd_cgc_cpf, 
	null				cd_grupo_servico, 
	null				cd_rede, 
	null				nm_rede, 
	null				qt_tot_r402, 
	null				qt_tot_r403, 
	null				qt_tot_r404, 
	null				qt_tot_r405, 
	a.nr_seq_movimento		nr_seq_movimento, 
	99999999			nr_seq_endereco, 
	null				cd_espec_1, 
	null				cd_atua_1, 
	null				cd_espec_2, 
	null				cd_atua_2, 
	null				reservado7, 
	a.nr_sequencia			nr_seq_prestador, 
	null				ie_guia_medico_espec_1, 
	null				ie_guia_medico_espec_2, 
	null				ie_guia_medico_atua_1, 
	null				ie_guia_medico_atua_2, 
	null				nr_leitos_intermed, 
	null				ie_filial, 
	null				cd_imposto, 
	null				vl_imposto, 
	null				ie_prest_acred, 
	coalesce(a.ie_instituicao_acred_ptu,'   ')	ds_inst_acred, 
	coalesce(a.ie_nivel_acreditacao_ptu,'0') ie_nivel_acred, 
	null				ie_particip_notivisa, 
	null				ie_particip_qualiss_ans, 
	null				nr_leitos_hosp_dia, 
	null				nr_rce_espec_1, 
	null				nr_rce_espec_2, 
	null				qt_tot_r407, 
	null				qt_tot_r408 
from	ptu_prestador		a 
where	(CASE WHEN a.ie_instituicao_acred_ptu IS NOT NULL THEN 'S' ELSE 'N' END) = 'S' 

union all
 
select	7				tp_registro, 
	99999999			ie_ordem, 
	7				ie_ordem_2, 
	999999				nr_sequencia, 
	'409'				cd_tipo_registro, 
	null				cd_unimed_des, 
	null				cd_unimed_ori, 
	null				dt_geracao, 
	null				nr_versao_trans, 
	null				sg_cons_diretor_tecnico, 
	null				sg_uf_cons_diretor_tecnico,	 
	null				ie_tipo_rede_min, 
	null				ie_tipo_prestador, 
	null				cd_prestador, 
	null				cd_cgc_cpf402, 
	null				cd_insc_est, 
	null				nr_crm, 
	null				cd_uf_crm, 
	null				nm_prestador, 
	null				nm_fantasia, 
	null				ie_tipo_vinculo, 
	null				dt_inclusao_uni, 
	null				dt_exclusao_uni, 
	null				ie_tipo_contratualizacao, 
	null				ie_tipo_class_estabelecimento, 
	null				ie_categoria_diferente, 
	null				ie_acidente_trabalho, 
	null				ie_urgencia_emergencia, 
	null				dt_inicio_serv, 
	null				dt_inicio_contrato, 
	null				nr_registro_ans, 
	null				nm_diretor_tecnico, 
	null				nr_crm_diretor_tec, 
	null				ie_tipo_disponibilidade, 
	null				ie_tabela_propria, 
	null				cd_perfil_assist_hosp, 
	null				ie_tipo_produto, 
	null				ie_guia_medico, 
	null				ie_registro_cert1, 
	null				ie_registro_atua1, 
	null				ie_registro_cert2, 
	null				ie_registro_atua2, 
	null				reservado, 
	null				ie_tipo_endereco, 
	null				ds_endereco, 
	null				nr_endereco, 
	null				ds_complemento, 
	null				ds_bairro, 
	null				cd_municipio, 
	null				nr_cep, 
	null				nr_ddd, 
	null				nr_fone_1, 
	null				nr_fone_2, 
	null				nr_fax, 
	null				ds_email, 
	null				ds_endereco_web, 
	null				cd_cnes, 
	null				nr_leitos_totais, 
	null				nr_leito_contrato, 
	null				nr_leitos_psiquiatria, 
	null				nr_uti_adulto, 
	null				nr_uti_neonatal, 
	null				nr_uti_pediatria, 
	null				cd_cgc_cpf, 
	null				cd_grupo_servico, 
	null				cd_rede, 
	null				nm_rede, 
	substr(obter_qt_registro_ptu_a400(nr_sequencia,'402'),1,7)	qt_tot_r402, 
	substr(obter_qt_registro_ptu_a400(nr_sequencia,'403'),1,7)	qt_tot_r403, 
	substr(obter_qt_registro_ptu_a400(nr_sequencia,'404'),1,7)	qt_tot_r404, 
	substr(obter_qt_registro_ptu_a400(nr_sequencia,'405'),1,7)	qt_tot_r405, 
	nr_sequencia			nr_seq_movimento, 
	99999999			nr_seq_endereco, 
	null				cd_espec_1, 
	null				cd_atua_1, 
	null				cd_espec_2, 
	null				cd_atua_2, 
	null				reservado7, 
	99999999			nr_seq_prestador, 
	null				ie_guia_medico_espec_1, 
	null				ie_guia_medico_espec_2, 
	null				ie_guia_medico_atua_1, 
	null				ie_guia_medico_atua_2, 
	null				nr_leitos_intermed, 
	null				ie_filial, 
	null				cd_imposto, 
	null				vl_imposto, 
	null				ie_prest_acred, 
	null				ds_inst_acred, 
	null				ie_nivel_acred, 
	null				ie_particip_notivisa, 
	null				ie_particip_qualiss_ans, 
	null				nr_leitos_hosp_dia, 
	null				nr_rce_espec_1, 
	null				nr_rce_espec_2, 
	substr(obter_qt_registro_ptu_a400(nr_sequencia,'407'),1,7)				qt_tot_r407, 
	substr(obter_qt_registro_ptu_a400(nr_sequencia,'408'),1,7)	qt_tot_r408 
from	ptu_movimento_prestador;

