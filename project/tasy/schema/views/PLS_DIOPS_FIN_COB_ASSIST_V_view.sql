-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_diops_fin_cob_assist_v (ie_sequencia, nr_sequencia, ds_tipo, vl_consulta, vl_exame, vl_terapia, vl_internacao, vl_atendimento, vl_demais_desp, vl_total) AS select	1 ie_sequencia,
	nr_sequencia,
	'Rede Própria' ds_tipo,
	vl_consulta_rp vl_consulta,
	vl_exame_rp vl_exame,
	vl_terapia_rp vl_terapia,
	vl_intern_rp vl_internacao,
	vl_atendimento_rp vl_atendimento,
	vl_despesas_rp vl_demais_desp,
	(coalesce(vl_consulta_rp,0) + coalesce(vl_exame_rp,0) + coalesce(vl_terapia_rp,0) + coalesce(vl_intern_rp,0) + coalesce(vl_atendimento_rp,0) + coalesce(vl_despesas_rp,0)) vl_total
FROM	diops_fin_cob_assist

union all

select	2 ie_sequencia,
	nr_sequencia,
	'Rede Contratada' ds_tipo,
	vl_consulta_rc vl_consulta,
	vl_exame_rc vl_exame,
	vl_terapia_rc vl_terapia,
	vl_intern_rc vl_internacao,
	vl_atendimento_rc vl_atendimento,
	vl_despesas_rc vl_demais_desp,
	(coalesce(vl_consulta_rc,0) + coalesce(vl_exame_rc,0) + coalesce(vl_terapia_rc,0) + coalesce(vl_intern_rc,0) + coalesce(vl_atendimento_rc,0) + coalesce(vl_despesas_rc,0)) vl_total
from	diops_fin_cob_assist

union all

select	3 ie_sequencia,
	nr_sequencia,
	'Reembolso' ds_tipo,
	vl_consulta_re vl_consulta,
	vl_exame_re vl_exame,
	vl_terapia_re vl_terapia,
	vl_intern_re vl_internacao,
	vl_atendimento_re vl_atendimento,
	vl_despesas_re vl_demais_desp,
	(coalesce(vl_consulta_re,0) + coalesce(vl_exame_re,0) + coalesce(vl_terapia_re,0) + coalesce(vl_intern_re,0) + coalesce(vl_atendimento_re,0) + coalesce(vl_despesas_re,0)) vl_total
from	diops_fin_cob_assist
where	ie_tipo_quadro <> 13

union all

select	4 ie_sequencia,
	nr_sequencia,
	'Intercâmbio Eventual' ds_tipo,
	vl_consulta_ie vl_consulta,
	vl_exame_ie vl_exame,
	vl_terapia_ie vl_terapia,
	vl_intern_ie vl_internacao,
	vl_atendimento_ie vl_atendimento,
	vl_despesas_ie vl_demais_desp,
	(coalesce(vl_consulta_ie,0) + coalesce(vl_exame_ie,0) + coalesce(vl_terapia_ie,0) + coalesce(vl_intern_ie,0) + coalesce(vl_atendimento_ie,0) + coalesce(vl_despesas_ie,0)) vl_total
from	diops_fin_cob_assist

union all

select	5 ie_sequencia,
	nr_sequencia,
	'TOTAL' ds_tipo,
	(vl_consulta_rp + vl_consulta_rc + vl_consulta_re + vl_consulta_ie) vl_consulta,
	(vl_exame_rp + vl_exame_rc + vl_exame_re + vl_exame_ie) vl_exame,
	(vl_terapia_rp + vl_terapia_rc + vl_terapia_re + vl_terapia_ie) vl_terapia,
	(vl_intern_rp + vl_intern_rc + vl_intern_re + vl_intern_ie) vl_internacao,
	(vl_atendimento_rp + vl_atendimento_rc + vl_atendimento_re + vl_atendimento_ie) vl_atendimento,
	(vl_despesas_rp + vl_despesas_rc + vl_despesas_re + vl_despesas_ie) vl_demais_desp,
	((coalesce(vl_consulta_rp,0) + coalesce(vl_consulta_rc,0) + coalesce(vl_consulta_re,0) + coalesce(vl_consulta_ie,0)) +
	(coalesce(vl_exame_rp,0) + coalesce(vl_exame_rc,0) + coalesce(vl_exame_re,0) + coalesce(vl_exame_ie,0)) +
	(coalesce(vl_terapia_rp,0) + coalesce(vl_terapia_rc,0) + coalesce(vl_terapia_re,0) + coalesce(vl_terapia_ie,0)) +
	(coalesce(vl_intern_rp,0) + coalesce(vl_intern_rc,0) + coalesce(vl_intern_re,0) + coalesce(vl_intern_ie,0)) +
	(coalesce(vl_atendimento_rp,0) + coalesce(vl_atendimento_rc,0) + coalesce(vl_atendimento_re,0) + coalesce(vl_atendimento_ie,0)) +
	(coalesce(vl_despesas_rp,0) + coalesce(vl_despesas_rc,0) + coalesce(vl_despesas_re,0) + coalesce(vl_despesas_ie,0))) vl_total
from	diops_fin_cob_assist

union all

select	6 ie_sequencia,
	a.nr_sequencia,
	'Outras Formas de Pagamento' ds_tipo,
	a.vl_consulta_op vl_consulta,
	a.vl_exame_op vl_exame,
	a.vl_terapia_op vl_terapia,
	a.vl_intern_op vl_internacao,
	a.vl_atendimento_op vl_atendimento,
	a.vl_despesas_op vl_demais_desp,
	(coalesce(a.vl_consulta_op,0) + coalesce(a.vl_exame_op,0) + coalesce(a.vl_terapia_op,0) + coalesce(a.vl_intern_op,0) + coalesce(a.vl_atendimento_op,0) + coalesce(a.vl_despesas_op,0)) vl_total
from	diops_fin_cob_assist	a,
	diops_periodo		p
where	p.nr_sequencia	= a.nr_seq_periodo
and	p.dt_periodo_final >= pkg_date_utils.get_dateTime(2016, 01, 01)
and	p.dt_periodo_final < pkg_date_utils.get_dateTime(2019, 01, 01)
and	a.ie_tipo_quadro <> 13

union all

select	7 ie_sequencia,
	a.nr_sequencia,
	'Atendimento em Corresponsabilidade' ds_tipo,
	a.vl_consulta_corresp vl_consulta,
	a.vl_exame_corresp vl_exame,
	a.vl_terapia_corresp vl_terapia,
	a.vl_intern_corresp vl_internacao,
	a.vl_atendimento_corresp vl_atendimento,
	a.vl_despesas_corresp vl_demais_desp,
	(coalesce(a.vl_consulta_corresp,0) + coalesce(a.vl_exame_corresp,0) + coalesce(a.vl_terapia_corresp,0) + coalesce(a.vl_intern_corresp,0) + coalesce(a.vl_atendimento_corresp,0) + coalesce(a.vl_despesas_corresp,0)) vl_total
from	diops_fin_cob_assist	a,
	diops_periodo		p
where	p.nr_sequencia	= a.nr_seq_periodo
and	p.dt_periodo_inicial >= pkg_date_utils.get_dateTime(2018, 01, 01)
and	p.dt_periodo_inicial < pkg_date_utils.get_dateTime(2019, 01, 01)
and 	a.ie_tipo_quadro <> 13

union all

select 	8 ie_sequencia,
	a.nr_sequencia,
	'Corresponsabilidade Cedida' ds_tipo,
	a.vl_consulta_corresp vl_consulta,
	a.vl_exame_corresp vl_exame,
	a.vl_terapia_corresp vl_terapia,
	a.vl_intern_corresp vl_internacao,
	a.vl_atendimento_corresp vl_atendimento,
	a.vl_despesas_corresp vl_demais_desp,
	(coalesce(a.vl_consulta_corresp,0) + coalesce(a.vl_exame_corresp,0) + coalesce(a.vl_terapia_corresp,0) + coalesce(a.vl_intern_corresp,0) + coalesce(a.vl_atendimento_corresp,0) + coalesce(a.vl_despesas_corresp,0)) vl_total
from	diops_fin_cob_assist	a,
	diops_periodo		p
where	p.nr_sequencia	= a.nr_seq_periodo
and	p.dt_periodo_inicial >= pkg_date_utils.get_dateTime(2019, 01, 01)
and	a.ie_tipo_quadro <> 13
order by ie_sequencia;

