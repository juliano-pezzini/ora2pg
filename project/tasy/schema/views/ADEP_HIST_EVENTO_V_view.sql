-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW adep_hist_evento_v (nr_seq_apresent, ie_tipo_item, ds_tipo_item, ds_tipo_item_plural, nr_atendimento, nr_prescricao, nr_seq_item, nr_seq_horario, cd_item, ds_item, nr_seq_evento, ie_evento, ds_evento, dt_evento, dt_real_evento, cd_pessoa_evento, nm_pessoa_evento) AS select	1 nr_seq_apresent,
	'D' ie_tipo_item, 
	'Dieta oral' ds_tipo_item, 
	'Dietas orais' ds_tipo_item_plural, 
	d.nr_atendimento, 
	d.nr_prescricao, 
	null nr_seq_item, 
	d.nr_seq_horario_dieta nr_seq_horario, 
	d.cd_item, 
	substr(obter_valor_dominio(99,d.cd_item),1,240) ds_item, 
	d.nr_sequencia nr_seq_evento, 
	d.ie_alteracao ie_evento, 
	substr(obter_valor_dominio(1620,d.ie_alteracao),1,240) ds_evento, 
	d.dt_alteracao dt_evento, 
	d.dt_atualizacao_nrec dt_real_evento, 
	d.cd_pessoa_fisica cd_pessoa_evento, 
	substr(obter_nome_pf(d.cd_pessoa_fisica),1,60) nm_pessoa_evento 
FROM	prescr_mat_alteracao d 
where	d.ie_tipo_item = 'D' 

union
 
select	2 nr_seq_apresent, 
	'S' ie_tipo_item, 
	'Suplemento oral' ds_tipo_item, 
	'Suplementos orais' ds_tipo_item_plural, 
	d.nr_atendimento, 
	d.nr_prescricao, 
	d.nr_seq_prescricao nr_seq_item, 
	d.nr_seq_horario nr_seq_horario, 
	d.cd_item, 
	substr(obter_desc_material(d.cd_item),1,240) ds_item, 
	d.nr_sequencia nr_seq_evento, 
	d.ie_alteracao ie_evento, 
	substr(obter_valor_dominio(1620,d.ie_alteracao),1,240) ds_evento, 
	d.dt_alteracao dt_evento, 
	d.dt_atualizacao_nrec dt_real_evento, 
	d.cd_pessoa_fisica cd_pessoa_evento, 
	substr(obter_nome_pf(d.cd_pessoa_fisica),1,60) nm_pessoa_evento 
from	prescr_mat_alteracao d 
where	d.ie_tipo_item = 'S' 

union
 
select	3 nr_seq_apresent, 
	'M' ie_tipo_item, 
	'Medicamento' ds_tipo_item, 
	'Medicamentos' ds_tipo_item_plural, 
	d.nr_atendimento, 
	d.nr_prescricao, 
	d.nr_seq_prescricao nr_seq_item, 
	d.nr_seq_horario nr_seq_horario, 
	d.cd_item, 
	substr(obter_desc_material(d.cd_item),1,240) ds_item, 
	d.nr_sequencia nr_seq_evento, 
	d.ie_alteracao ie_evento, 
	substr(obter_valor_dominio(1620,d.ie_alteracao),1,240) ds_evento, 
	d.dt_alteracao dt_evento, 
	d.dt_atualizacao_nrec dt_real_evento, 
	d.cd_pessoa_fisica cd_pessoa_evento, 
	substr(obter_nome_pf(d.cd_pessoa_fisica),1,60) nm_pessoa_evento 
from	prescr_mat_alteracao d 
where	d.ie_tipo_item = 'M' 

union
 
select	4 nr_seq_apresent, 
	'MAT' ie_tipo_item, 
	'Material' ds_tipo_item, 
	'Materiais' ds_tipo_item_plural, 
	d.nr_atendimento, 
	d.nr_prescricao, 
	d.nr_seq_prescricao nr_seq_item, 
	d.nr_seq_horario nr_seq_horario, 
	d.cd_item, 
	substr(obter_desc_material(d.cd_item),1,240) ds_item, 
	d.nr_sequencia nr_seq_evento, 
	d.ie_alteracao ie_evento, 
	substr(obter_valor_dominio(1620,d.ie_alteracao),1,240) ds_evento, 
	d.dt_alteracao dt_evento, 
	d.dt_atualizacao_nrec dt_real_evento, 
	d.cd_pessoa_fisica cd_pessoa_evento, 
	substr(obter_nome_pf(d.cd_pessoa_fisica),1,60) nm_pessoa_evento 
from	prescr_mat_alteracao d 
where	d.ie_tipo_item = 'MAT' 

union
 
select	5 nr_seq_apresent, 
	'P' ie_tipo_item, 
	'Procedimento' ds_tipo_item, 
	'Procedimentos' ds_tipo_item_plural, 
	d.nr_atendimento, 
	d.nr_prescricao, 
	d.nr_seq_procedimento nr_seq_item, 
	d.nr_seq_horario_proc nr_seq_horario, 
	d.cd_item, 
	substr(obter_desc_prescr_proc(obter_proc_prescr(d.nr_prescricao,d.nr_seq_procedimento), obter_origem_proc_prescr(d.nr_prescricao,d.nr_seq_procedimento), obter_tab_int_proc_prescr(d.nr_prescricao,d.nr_seq_procedimento)),1,240) ds_item, 
	d.nr_sequencia nr_seq_evento, 
	d.ie_alteracao ie_evento, 
	substr(obter_valor_dominio(1620,d.ie_alteracao),1,240) ds_evento, 
	d.dt_alteracao dt_evento, 
	d.dt_atualizacao_nrec dt_real_evento, 
	d.cd_pessoa_fisica cd_pessoa_evento, 
	substr(obter_nome_pf(d.cd_pessoa_fisica),1,60) nm_pessoa_evento 
from	prescr_mat_alteracao d 
where	d.ie_tipo_item = 'P' 

union
 
select	6 nr_seq_apresent, 
	'R' ie_tipo_item, 
	'Recomendação' ds_tipo_item, 
	'Recomendações' ds_tipo_item_plural, 
	d.nr_atendimento, 
	d.nr_prescricao, 
	d.nr_seq_recomendacao nr_seq_item, 
	d.nr_seq_horario_rec nr_seq_horario, 
	d.cd_item, 
	substr(obter_rec_prescricao(d.nr_seq_recomendacao, d.nr_prescricao),1,240) ds_item, 
	d.nr_sequencia nr_seq_evento, 
	d.ie_alteracao ie_evento, 
	substr(obter_valor_dominio(1620,d.ie_alteracao),1,240) ds_evento, 
	d.dt_alteracao dt_evento, 
	d.dt_atualizacao_nrec dt_real_evento, 
	d.cd_pessoa_fisica cd_pessoa_evento, 
	substr(obter_nome_pf(d.cd_pessoa_fisica),1,60) nm_pessoa_evento 
from	prescr_mat_alteracao d 
where	d.ie_tipo_item = 'R' 

union
 
select	7 nr_seq_apresent, 
	'E' ie_tipo_item, 
	'SAE' ds_tipo_item, 
	'SAE' ds_tipo_item_plural, 
	d.nr_atendimento, 
	d.nr_prescricao, 
	d.nr_seq_item_sae nr_seq_item, 
	d.nr_seq_horario_sae nr_seq_horario, 
	d.cd_item, 
	substr(obter_desc_intervencoes(d.cd_item),1,240) ds_item, 
	d.nr_sequencia nr_seq_evento, 
	d.ie_alteracao ie_evento, 
	substr(obter_valor_dominio(1620,d.ie_alteracao),1,240) ds_evento, 
	d.dt_alteracao dt_evento, 
	d.dt_atualizacao_nrec dt_real_evento, 
	d.cd_pessoa_fisica cd_pessoa_evento, 
	substr(obter_nome_pf(d.cd_pessoa_fisica),1,60) nm_pessoa_evento 
from	prescr_mat_alteracao d 
where	d.ie_tipo_item = 'E';

