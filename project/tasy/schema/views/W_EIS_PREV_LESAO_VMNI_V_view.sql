-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW w_eis_prev_lesao_vmni_v (dt_monitorizacao, setor, nr_sequencia, ds_setor_atendimento, nr_atendimento, ds_unid, ds_estabelecimento, ds_turno, turno) AS select distinct
	a.dt_monitorizacao,	 
	a.cd_setor_atendimento setor, 
	a.nr_sequencia,	 
	obter_nome_setor(a.cd_setor_atendimento) ds_setor_atendimento,		 
	a.nr_atendimento, 
	obter_unidade_atendimento(a.nr_atendimento,'A','U') ds_unid, 
	obter_dados_Atendimento(a.nr_atendimento, 'EST') ds_estabelecimento, 
	Obter_Turno_Atendimento(a.dt_monitorizacao,obter_dados_Atendimento(a.nr_atendimento, 'EST'),'D') ds_turno, 
	Obter_Turno_Atendimento(a.dt_monitorizacao,obter_dados_Atendimento(a.nr_atendimento, 'EST'),'C') turno 
FROM	atendimento_monit_resp a 
where	a.dt_inativacao is null 
and	a.ie_respiracao = 'VMNI' 
and (obter_se_tempo_VMNI(a.nr_sequencia,72) > 0);

