-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW sus_bpa_unificado_v (tp_registro, nr_seq_protocolo, ds_registro, dt_mesano_referencia, qt_linhas, qt_folha_bpa, cd_dominio, nm_orgao_responsavel, cd_orgao_responsavel, cd_cgc_responsavel, nm_orgao_destino, ie_orgao_destino, ds_versao, cd_ups, dt_competencia, cd_cns_medico_exec, cd_cbo, dt_procedimento, nr_folha_bpa, nr_linha_folha, cd_procedimento, cd_cns_paciente, ie_sexo_pac, cd_municipio_ibge, cd_cid_proc, nr_idade_pac, qt_procedimento, cd_carater_atendimento, ds_autorizacao, ds_origem_informacao, nm_paciente, dt_nascimento, ie_tipo_bpa) AS select	1 tp_registro,
	nr_seq_protocolo,
	ds_registro,
	dt_mesano_referencia,
	qt_linhas,
	qt_folha_bpa,
	cd_dominio,
	nm_orgao_responsavel,
	cd_orgao_responsavel,
	cd_cgc_responsavel,
	nm_orgao_destino,
	ie_orgao_destino,
	ds_versao,
	cd_ups,
	dt_competencia,
	cd_cns_medico_exec,
	cd_cbo,
	dt_procedimento,
	nr_folha_bpa,
	nr_linha_folha,
	cd_procedimento,
	cd_cns_paciente,
	ie_sexo_pac,
	cd_municipio_ibge,
	cd_cid_proc,
	nr_idade_pac,
	qt_procedimento,
	cd_carater_atendimento,
	ds_autorizacao,
	ds_origem_informacao,
	nm_paciente,
	dt_nascimento,
	ie_tipo_bpa
FROM	w_susbpa_interf
where	ie_cabecalho = 'C'

union

select	2 tp_registro,
	nr_seq_protocolo,
	ds_registro,
	dt_mesano_referencia,
	qt_linhas,
	qt_folha_bpa,
	cd_dominio,
	nm_orgao_responsavel,
	cd_orgao_responsavel,
	cd_cgc_responsavel,
	nm_orgao_destino,
	ie_orgao_destino,
	ds_versao,
	cd_ups,
	dt_competencia,
	cd_cns_medico_exec,
	cd_cbo,
	dt_procedimento,
	nr_folha_bpa,
	nr_linha_folha,
	cd_procedimento,
	cd_cns_paciente,
	ie_sexo_pac,
	cd_municipio_ibge,
	cd_cid_proc,
	nr_idade_pac,
	qt_procedimento,
	cd_carater_atendimento,
	ds_autorizacao,
	ds_origem_informacao,
	nm_paciente,
	dt_nascimento,
	ie_tipo_bpa
from	w_susbpa_interf
where	ie_cabecalho = 'P'
order by nr_linha_folha;

