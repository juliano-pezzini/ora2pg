-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_perda_material_v (dt_referencia, ie_periodo, cd_estabelecimento, cd_setor_atendimento, cd_local_estoque, cd_centro_custo, cd_grupo_material, cd_subgrupo_material, cd_classe_material, cd_material, ie_tipo_perda, ie_curva_abc, ie_padronizado, ie_consignado, qt_perda, pr_perda, vl_perda, vl_consumo, dt_atualizacao, nm_usuario, ds_consignado, ds_tipo_perda, ds_setor_atendimento, ds_local_estoque, ds_centro_custo, ds_grupo_material, ds_subgrupo_material, ds_classe_material, ds_material) AS select	a.dt_referencia,
	a.ie_periodo,
	a.cd_estabelecimento,
	a.cd_setor_atendimento,
	a.cd_local_estoque,
	a.cd_centro_custo,
	a.cd_grupo_material,
	a.cd_subgrupo_material,
	a.cd_classe_material,
	a.cd_material,
	a.ie_tipo_perda,
	a.ie_curva_abc,
	a.ie_padronizado,
	a.ie_consignado,
	a.qt_perda,
	a.pr_perda,
	a.vl_perda,
	a.vl_consumo,
	a.dt_atualizacao,
	a.nm_usuario,
	substr(CASE WHEN ie_consignado='S' THEN 'Consignado'  ELSE 'NÃ£o consignado' END ,1,60) ds_consignado,
	substr(CASE WHEN coalesce(a.ie_tipo_perda,'X')='X' THEN 'Consumo sem perda'  ELSE obter_valor_dominio(1952, a.ie_tipo_perda) END ,1,60) ds_tipo_perda,
	substr(obter_nome_setor(a.cd_setor_atendimento),1,100) ds_setor_atendimento,
	substr(obter_desc_local_estoque(a.cd_local_estoque),1,40) ds_local_estoque,
	substr(CASE WHEN a.cd_centro_custo IS NULL THEN 'Sem centro de custo informado'  ELSE obter_desc_centro_custo(a.cd_centro_custo) END ,1,40) ds_centro_custo,
	substr(obter_desc_grupo_mat(a.cd_grupo_material),1,60) ds_grupo_material,
	substr(obter_desc_subgrupo_mat(a.cd_subgrupo_material),1,60) ds_subgrupo_material,
	substr(obter_desc_classe_mat(a.cd_classe_material),1,60) ds_classe_material,
	substr(obter_desc_material(a.cd_material),1,100) ds_material
FROM	eis_perda_material a;

