-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW lab_prescr_medica_v (nr_atendimento, nm_paciente, dt_nascimento, ie_sexo, ds_idade, ds_tipo_atendimento, ds_convenio, dt_entrada, nm_unidade, cd_unidade, nm_medico, dt_entrada_unidade, dt_entrega, dt_prescricao, cd_setor_entrega, cd_setor_atendimento, cd_medico, nm_medico_prescr, ds_setor_entrega, ds_setor_atendimento) AS select 	a.nr_atendimento,
	a.nm_paciente,
	a.dt_nascimento,
	a.ie_sexo,
	a.ds_idade,
	a.ds_tipo_atendimento,
	a.ds_convenio,
	a.dt_entrada,
	a.nm_unidade,
	a.cd_unidade,
	a.nm_medico,
	b.dt_entrada_unidade,
	b.dt_entrega,
	b.dt_prescricao,
	b.cd_setor_entrega,
	b.cd_setor_atendimento,
	b.cd_medico,
	substr(obter_nome_medico(b.cd_medico, 'PS'),1,200) nm_medico_prescr,
	substr(obter_nome_setor(b.cd_setor_entrega),1,100) ds_setor_entrega,
	substr(obter_nome_setor(b.cd_setor_atendimento),1,100) ds_setor_atendimento
FROM 	atendimento_paciente_v a,
	prescr_medica b
where 	a.nr_atendimento	= b.nr_atendimento;

