-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW w_eis_distr_conduta_flebite_v (ds_setor_atendimento, ds_unidade, ie_faixa_etaria, qt_prescrito, ds_grau, nr_atendimento, nr_seq_superior, ds_conduta, dt_atualizacao_nrec, ie_escala, nr_seq_escala) AS SELECT	DISTINCT	
	SUBSTR(obter_nome_setor(Obter_Setor_Atendimento(b.nr_Atendimento)),1,255) ds_Setor_Atendimento,	 
	obter_unidade_atendimento(b.nr_atendimento,'A','U') ds_unidade, 
	SUBSTR(obter_idade(obter_data_nascto_pf(b.cd_pessoa_fisica),LOCALTIMESTAMP,'E'),1,10) ie_faixa_etaria, 
	SUBSTR(obter_desc_resultados_flebite(NULL,a.nr_sequencia,NULL,'PP'),1,2) qt_prescrito, 
	SUBSTR('Grau '||coalesce((obter_desc_resultados_flebite(NULL,b.nr_seq_escala,NULL,'FG')),'n√£o informado'),1,80) ds_grau,	 
	b.nr_atendimento, 
	a.nr_seq_superior, 
	c.ds_regra ds_conduta, 
	b.dt_atualizacao_nrec, 
	b.ie_escala, 
	b.nr_seq_escala 
FROM	gqa_pend_pac_acao a, 
	gqa_pendencia_pac b, 
	gqa_pendencia_regra c 
where	a.nr_seq_proc is not null 
and	a.nr_seq_pend_pac = b.nr_sequencia 
and	b.nr_seq_pend_regra = c.nr_sequencia 
and (c.nr_seq_escala = 92) 
and	a.nr_seq_superior is not null 
and	  a.nr_seq_proc = (	select 	c.nr_seq_proc 
	  			from	gqa_pend_pac_acao c 
				where	c.nr_sequencia = a.nr_seq_superior);

