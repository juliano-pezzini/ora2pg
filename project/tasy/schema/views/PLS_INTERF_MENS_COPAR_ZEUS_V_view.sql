-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_interf_mens_copar_zeus_v (nr_cpf, vl_coparticipacao, vl_mensalidade, nm_usuario) AS select	obter_cgc_cpf_editado(coalesce(e.nr_cpf,'00000000000')) || ';' nr_cpf,
	lpad(replace(campo_mascara_virgula(b.vl_coparticipacao),'.',''),11,'0')	|| ';' vl_coparticipacao,
	lpad(replace(campo_mascara_virgula(b.vl_mensalidade - b.vl_coparticipacao),'.',''),11,'0') || ';' vl_mensalidade,
	a.nm_usuario			nm_usuario
FROM	pls_segurado			d,
	pls_segurado			c, 
	pls_mensalidade_segurado	b,
	W_PLS_INTERFACE_MENS		a,
	pessoa_fisica			e
where	d.nr_seq_titular		= c.nr_sequencia
and	b.nr_seq_segurado		= d.nr_sequencia
and	a.NR_SEQ_MENSALIDADE_SEG	= b.nr_sequencia
and	e.cd_pessoa_fisica		= c.cd_pessoa_fisica
and	d.nr_seq_titular is not null;

