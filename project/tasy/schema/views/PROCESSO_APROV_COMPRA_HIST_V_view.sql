-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW processo_aprov_compra_hist_v (nr_sequencia, dt_atualizacao, nm_usuario, dt_atualizacao_nrec, nm_usuario_nrec, nr_seq_aprov_compra, nr_seq_proc_aprov, nr_documento, ie_tipo_documento, ds_tipo_documento, valor_total, ie_status, cd_pessoa_solicitante, nm_solicitante) AS select NR_SEQUENCIA,
	  DT_ATUALIZACAO, 
	  NM_USUARIO, 
	  DT_ATUALIZACAO_NREC, 
	  NM_USUARIO_NREC, 
	  NR_SEQ_APROV_COMPRA, 
	  NR_SEQ_PROC_APROV, 
	  NR_DOCUMENTO, 
	  IE_TIPO_DOCUMENTO, 
	  DS_TIPO_DOCUMENTO, 
	  VL_TOTAL_COMPRA VALOR_TOTAL, 
	  CASE WHEN IE_STATUS='A' THEN  'APPROVED' WHEN IE_STATUS='B' THEN  'SETTLED' WHEN IE_STATUS='E' THEN  'FORWARDED' WHEN IE_STATUS='R' THEN  'DISAPPROVED' WHEN IE_STATUS='P' THEN  'PENDING'  ELSE 'NO_STATUS' END  IE_STATUS, /* CUIDADO ENUM */
 
	  CD_PESSOA_SOLICITANTE, 
	  obter_nome_pf(CD_PESSOA_SOLICITANTE) NM_SOLICITANTE 
FROM  PROCESSO_APROV_COMPRA_HIST 
order by DT_ATUALIZACAO desc;

