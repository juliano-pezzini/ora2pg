-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW nota_fiscal_item_v (nr_sequencia, cd_material, nr_item_nf, cd_conta_contabil, cd_centro_custo, vl_frete, vl_seguro, vl_despesa_acessoria, vl_total_item_nf) AS SELECT
	NR_SEQUENCIA,
	CD_MATERIAL,
	NR_ITEM_NF,
	CD_CONTA_CONTABIL,
	CD_CENTRO_CUSTO,
	coalesce(VL_FRETE,0) VL_FRETE,
 	coalesce(VL_SEGURO,0) VL_SEGURO,
	coalesce(VL_DESPESA_ACESSORIA,0) VL_DESPESA_ACESSORIA,
	SUM(coalesce(VL_TOTAL_ITEM_NF,0) - coalesce(VL_DESCONTO,0) - 		coalesce(VL_DESCONTO_RATEIO,0))
	VL_TOTAL_ITEM_NF
 FROM NOTA_FISCAL_ITEM
GROUP BY
	NR_SEQUENCIA,
	CD_MATERIAL,
	NR_ITEM_NF,
	CD_CONTA_CONTABIL,
	CD_CENTRO_CUSTO,
	VL_FRETE,
	VL_SEGURO,
	VL_DESPESA_ACESSORIA;

