-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW contrato_v (nr_sequencia, cd_cgc_contratado, nr_seq_tipo_contrato, ds_objeto_contrato, ie_renovacao, dt_atualizacao, nm_usuario, ie_situacao, dt_inicio, dt_fim, qt_dias_rescisao, cd_contrato, ie_prazo_contrato, nm_contato, cd_pessoa_resp, vl_total_contrato, ds_atribuicao, ie_pagar_receber, cd_pessoa_negoc, nm_pessoa_negoc, nm_responsavel, ds_razao_social, ds_tipo_contrato, ds_renovacao, ds_contratado, cd_estabelecimento) AS select 	a.nr_sequencia,
	a.cd_cgc_contratado, 
	a.nr_seq_tipo_contrato, 
	a.ds_objeto_contrato, 
	a.ie_renovacao, 
	a.dt_atualizacao, 
	a.nm_usuario, 
	a.ie_situacao, 
	a.dt_inicio, 
	a.dt_fim, 
	a.qt_dias_rescisao, 
	a.cd_contrato, 
	a.ie_prazo_contrato, 
	a.nm_contato, 
	a.cd_pessoa_resp, 
	a.vl_total_contrato, 
	a.ds_atribuicao, 
	a.ie_pagar_receber, 
	a.cd_pessoa_negoc, 
	b.nm_pessoa_fisica nm_pessoa_negoc, 
	substr(c.nm_pessoa_fisica,1,20) nm_responsavel, 
	d.ds_razao_social, 
	e.ds_tipo_contrato, 
	substr(f.ds_valor_dominio,1,30) ds_renovacao, 
	substr(obter_nome_pf_pj(a.cd_pessoa_contratada,a.cd_cgc_contratado),1,60) ds_contratado, 
	a.cd_estabelecimento 
FROM valor_dominio f, tipo_contrato e, pessoa_fisica c
LEFT OUTER JOIN compl_pessoa_fisica g ON (c.cd_pessoa_fisica = g.cd_pessoa_fisica AND 2 = g.ie_tipo_complemento)
, contrato a
LEFT OUTER JOIN pessoa_juridica d ON (a.cd_cgc_contratado = d.cd_cgc)
LEFT OUTER JOIN pessoa_fisica b ON (a.cd_pessoa_negoc = b.cd_pessoa_fisica)
LEFT OUTER JOIN pessoa_fisica c ON (a.cd_pessoa_resp = c.cd_pessoa_fisica)
WHERE a.nr_seq_tipo_contrato = e.nr_sequencia and f.cd_dominio = 1061 and a.ie_renovacao = f.vl_dominio;

