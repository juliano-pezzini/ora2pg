-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW tabela_custo_acesso_v (nr_sequencia, cd_empresa, cd_estabelecimento, cd_tabela_custo, cd_tipo_tabela_custo, nr_seq_grupo_emp, ie_nivel_acesso) AS select	a.nr_sequencia,
	a.cd_empresa,
	a.cd_estabelecimento,
	a.cd_tabela_custo,
	a.cd_tipo_tabela_custo,
	a.nr_seq_grupo_emp,
	1 ie_nivel_acesso
FROM	tabela_custo a
where	a.cd_estabelecimento is not null
and	a.nr_seq_grupo_emp is null

union all

select	a.nr_sequencia,
	a.cd_empresa,
	b.cd_estabelecimento,
	a.cd_tabela_custo,
	a.cd_tipo_tabela_custo,
	a.nr_seq_grupo_emp,
	2 ie_nivel_acesso
from	empresa e,
	estabelecimento b,
	tabela_custo a
where	a.cd_estabelecimento is null
and	a.nr_seq_grupo_emp is null
and	a.cd_empresa is not null
and	a.cd_empresa	= b.cd_empresa
and	e.cd_empresa	= a.cd_empresa
and	b.ie_situacao	= 'A'
and	e.ie_situacao	= 'A'

union all

select	a.nr_sequencia,
	ge.cd_empresa,
	b.cd_estabelecimento,
	a.cd_tabela_custo,
	a.cd_tipo_tabela_custo,
	a.nr_seq_grupo_emp,
	3 ie_nivel_acesso
from	grupo_empresa_v ge,
	empresa e,
	estabelecimento b,
	tabela_custo a
where	a.cd_estabelecimento is null
and	a.nr_seq_grupo_emp is not null
and	ge.nr_seq_grupo_empresa	= a.nr_seq_grupo_emp
and	ge.cd_empresa	= e.cd_empresa
and	e.cd_empresa	= b.cd_empresa
and	b.ie_situacao	= 'A'
and	e.ie_situacao	= 'A';

