-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW tws_mensalidade_benef_v (nr_seq_mensalidade, nr_titulo, dt_referencia, dt_mesano_referencia, vl_mensalidade, vl_coparticipacao, dt_vencimento, dt_pagamento_previsto, nr_seq_segurado, nr_seq_titular, dt_referencia_lote, ie_situacao, nr_seq_pagador, ds_mensagem_quitacao, ds_observacao, vl_mensalidade_total, vl_coparticipacao_total, ds_link_nf, nr_nota_fiscal, nr_seq_nota_fiscal) AS select	a.nr_sequencia nr_seq_mensalidade,
	e.nr_titulo,
	a.dt_referencia,
	b.dt_mesano_referencia,
	b.vl_mensalidade,
	b.vl_coparticipacao,
	e.dt_vencimento,
	e.dt_pagamento_previsto,
	c.nr_sequencia nr_seq_segurado,
	c.nr_seq_titular,
	d.dt_mesano_referencia dt_referencia_lote,
	e.ie_situacao,
	a.nr_seq_pagador,
	a.ds_mensagem_quitacao,
	a.ds_observacao,
	a.vl_mensalidade vl_mensalidade_total,
	a.vl_coparticipacao vl_coparticipacao_total,
	nf.ds_link_rps ds_link_nf,
	nf.nr_nota_fiscal,
	nf.nr_sequencia nr_seq_nota_fiscal
FROM titulo_receber e, pls_lote_mensalidade d, pls_segurado c, pls_mensalidade_segurado b, pls_mensalidade a
LEFT OUTER JOIN nota_fiscal nf ON (a.nr_sequencia = nf.nr_seq_mensalidade)
WHERE b.nr_seq_mensalidade	= a.nr_sequencia and b.nr_seq_segurado	= c.nr_sequencia and d.nr_sequencia		= a.nr_seq_lote and e.nr_seq_mensalidade	= a.nr_sequencia  and ((d.ie_visualizar_portal = 'S') or (d.ie_visualizar_portal is null)) and e.ie_situacao in ('1','2','4','6') and a.ie_cancelamento is null;

