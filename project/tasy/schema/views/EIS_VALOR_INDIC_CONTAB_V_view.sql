-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_valor_indic_contab_v (nr_seq_indicador, cd_empresa, cd_estabelecimento, dt_ano, ds_ano, vl_janeiro, vl_fevereiro, vl_marco, vl_abril, vl_maio, vl_junho, vl_julho, vl_agosto, vl_setembro, vl_outubro, vl_novembro, vl_dezembro) AS select	nr_seq_indicador,
	cd_empresa,
	cd_estabelecimento,
	trunc(dt_referencia, 'year') dt_ano,
	to_char(trunc(dt_referencia, 'year'), 'yyyy') ds_ano,
	sum(CASE WHEN to_char(dt_referencia, 'mm')='01' THEN  vl_indicador  ELSE 0 END ) vl_janeiro,
	sum(CASE WHEN to_char(dt_referencia, 'mm')='02' THEN  vl_indicador  ELSE 0 END ) vl_fevereiro,
	sum(CASE WHEN to_char(dt_referencia, 'mm')='03' THEN  vl_indicador  ELSE 0 END ) vl_marco,
	sum(CASE WHEN to_char(dt_referencia, 'mm')='04' THEN  vl_indicador  ELSE 0 END ) vl_abril,
	sum(CASE WHEN to_char(dt_referencia, 'mm')='05' THEN  vl_indicador  ELSE 0 END ) vl_maio,
	sum(CASE WHEN to_char(dt_referencia, 'mm')='06' THEN  vl_indicador  ELSE 0 END ) vl_junho,
	sum(CASE WHEN to_char(dt_referencia, 'mm')='07' THEN  vl_indicador  ELSE 0 END ) vl_julho,
	sum(CASE WHEN to_char(dt_referencia, 'mm')='08' THEN  vl_indicador  ELSE 0 END ) vl_agosto,
	sum(CASE WHEN to_char(dt_referencia, 'mm')='09' THEN  vl_indicador  ELSE 0 END ) vl_setembro,
	sum(CASE WHEN to_char(dt_referencia, 'mm')='10' THEN  vl_indicador  ELSE 0 END ) vl_outubro,
	sum(CASE WHEN to_char(dt_referencia, 'mm')='11' THEN  vl_indicador  ELSE 0 END ) vl_novembro,
	sum(CASE WHEN to_char(dt_referencia, 'mm')='12' THEN  vl_indicador  ELSE 0 END ) vl_dezembro
FROM	EIS_VALOR_INDIC_CONTAB
group by
	nr_seq_indicador,
	cd_empresa,
	cd_estabelecimento,
	trunc(dt_referencia, 'year'),
	to_char(trunc(dt_referencia, 'year'), 'yyyy');

