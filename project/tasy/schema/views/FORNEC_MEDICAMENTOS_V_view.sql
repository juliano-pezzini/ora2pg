-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW fornec_medicamentos_v (cd_material, ds_material, vl_preco_venda, vl_total_item_nf, dt_emissao, cd_cgc_fornecedor, cd_cgc, ds_razao_social, qt_total_medicamento) AS select distinct
	a.cd_material cd_material,
	upper(trim(both a.ds_material)) ds_material,
	b.vl_preco_venda vl_preco_venda,
	d.vl_total_item_nf vl_total_item_nf,
	e.DT_EMISSAO dt_emissao,
	b.cd_cgc_fornecedor cd_cgc_fornecedor,
	c.cd_cgc,
	upper(trim(both coalesce(c.nm_fantasia, c.ds_razao_social))) ds_razao_social,
	1 qt_total_medicamento
FROM
	material a,
	preco_material b,
	pessoa_juridica c,
	nota_fiscal_item d,
  	nota_fiscal e
where a.cd_material = b.cd_material
	and b.cd_cgc_fornecedor = c.cd_cgc
	and b.nr_item_nf = d.nr_item_nf
	and e.nr_sequencia = d.nr_sequencia;

