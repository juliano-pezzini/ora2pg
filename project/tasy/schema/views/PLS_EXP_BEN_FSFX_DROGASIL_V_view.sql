-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_exp_ben_fsfx_drogasil_v (ie_tipo, ie_contrato, cd_matricula, nm_beneficiario, nr_cpf, nr_identidade, dt_nascimento, ds_orgao_emissor_ci, ie_sexo, ie_estado_civil, ds_endereco, ds_complemento, ds_bairro, ds_municipio, sg_estado, cd_cep, nr_ddd_telefone, nr_telefone, nr_seq_lote, ie_tipo_complemento, ie_tipo_telefone) AS select	'1' ie_tipo,
	'Contrato' ie_contrato,
	'Matrícula'cd_matricula,
	'Nome' nm_beneficiario,
	'CPF' nr_cpf,
	'RG' nr_identidade,
	'Nascimento' dt_nascimento,
	'UF RG' ds_orgao_emissor_ci,
	'Sexo' ie_sexo,
	'Estado civil' ie_estado_civil,
	'Endereço' ds_endereco,
	'Complemento' ds_complemento,
	'Bairro' ds_bairro,
	'Cidade' ds_municipio,
	'UF' sg_estado,
	'CEP' cd_cep,
	'DDD' nr_ddd_telefone,
	'Telefone' nr_telefone,
	nr_sequencia nr_seq_lote,
	'Tipo de Endereço' ie_tipo_complemento,
	'Tipo do Telefone' ie_tipo_telefone
FROM 	pls_lote_mov_benef

union all

select	'2' ie_tipo,
	' 'ie_contrato,
	substr((select translate(upper(x.cd_usuario_plano),',./-ABCDEFGHIJKLMNOPQRSTUVWXYZÇ',' ') from pls_segurado_carteira x where x.nr_seq_segurado = d.nr_sequencia),1,17) cd_matricula ,
	a.nm_beneficiario,
	lpad(a.nr_cpf,11,'0')nr_cpf,
	'00000000000'nr_identidade,
	'01/05/1980' dt_nascimento,
	'00' ds_orgao_emissor_ci,
	a.ie_sexo,
	CASE WHEN a.ie_estado_civil='1' THEN 'S' WHEN a.ie_estado_civil='2' THEN 'C' WHEN a.ie_estado_civil='3' THEN 'R' WHEN a.ie_estado_civil='4' THEN 'D' WHEN a.ie_estado_civil='5' THEN 'V' WHEN a.ie_estado_civil='6' THEN 'P' WHEN a.ie_estado_civil='7' THEN 'M' WHEN a.ie_estado_civil='9' THEN 'O' END ie_estado_civil,
	' Av. Ana Costa, 258 'ds_endereco,
	'Loja 1'ds_complemento,
	'Vila Mathias'ds_bairro,
	'Santos'ds_municipio,
	'SP'sg_estado,
	'11060000'cd_cep,
	'13'nr_ddd_telefone,
	'33263000'nr_telefone,
	nr_seq_lote,
	'C' ie_tipo_complemento,
	'C' ie_tipo_telefone
FROM compl_pessoa_fisica f, pessoa_fisica c, pls_lote_mov_benef b, pls_movimentacao_benef a, pls_segurado d
LEFT OUTER JOIN pls_segurado_compl g ON (d.nr_sequencia = g.nr_seq_segurado)
WHERE b.nr_sequencia		= a.nr_seq_lote and a.nr_seq_segurado	= d.nr_sequencia and d.cd_pessoa_fisica	= c.cd_pessoa_fisica and c.cd_pessoa_fisica	= f.cd_pessoa_fisica  and f.ie_tipo_complemento 	= '1';

