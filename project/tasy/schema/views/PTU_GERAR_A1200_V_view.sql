-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_gerar_a1200_v (nr_seq_pacote, tp_registro, nr_sequencia, cd_tipo_registro, cd_estabelecimento_pacote, cd_unimed_origem_pacote, dt_atualizacao_pacote, dt_geracao_pacote, ie_tipo_carga_pacote, ie_tipo_informacao_pacote, nm_usuario_pacote, nr_seq_pacote_ptu, nr_versao_transacao_pacote, cd_especialidade_reg, cd_pacote_reg, cd_prestador_reg, cd_unimed_prestador_reg, ds_observacao_reg, dt_atualizacao_reg, dt_negociacao_reg, dt_publicacao_reg, ie_tipo_acomodacao_reg, ie_tipo_informacao_reg, ie_tipo_pacote_reg, nm_pacote_reg, nm_prestador_reg, nm_usuario_reg, nr_seq_pacote_reg, nr_seq_reg, ds_obs_reg, cd_servico_serv, dt_atualizacao_serv, ie_honorario_serv, ie_principal_serv, ie_tipo_item_serv, ie_tipo_participacao_serv, ie_tipo_tabela_serv, nm_usuario_serv, nr_seq_pacote_reg_serv, nr_seq_servico, qt_servico_serv, vl_servico_serv) AS Select 	nr_sequencia		nr_seq_pacote,
	1			tp_registro,
	1			nr_sequencia,
	'201'			cd_tipo_registro,
	cd_estabelecimento 	cd_estabelecimento_pacote,
	cd_unimed_origem        cd_unimed_origem_pacote,
	dt_atualizacao          dt_atualizacao_pacote,
	dt_geracao              dt_geracao_pacote,
	ie_tipo_carga           ie_tipo_carga_pacote,
	ie_tipo_informacao      ie_tipo_informacao_pacote,
	nm_usuario		nm_usuario_pacote,
	nr_sequencia		nr_seq_pacote_ptu,
	'01'			nr_versao_transacao_pacote,
	null        		cd_especialidade_reg,
	null               	cd_pacote_reg,
	null		        cd_prestador_reg,
	null 			cd_unimed_prestador_reg,
	null		        ds_observacao_reg,
	null			dt_atualizacao_reg,
	null		        dt_negociacao_reg,
	null			dt_publicacao_reg,
	null			ie_tipo_acomodacao_reg,
	null			ie_tipo_informacao_reg,
	null			ie_tipo_pacote_reg,
	null			nm_pacote_reg,
	null		        nm_prestador_reg,
	null		        nm_usuario_reg,
	null		        nr_seq_pacote_reg,
	null		        nr_seq_reg,
	null			ds_obs_reg,
	null			cd_servico_serv,
	null		        dt_atualizacao_serv,
	null		        ie_honorario_serv,
	null		        ie_principal_serv,
	null		        ie_tipo_item_serv,
	null			ie_tipo_participacao_serv,
	null 		        ie_tipo_tabela_serv,
	null		        nm_usuario_serv,
	null		        nr_seq_pacote_reg_serv,
	null 		        nr_seq_servico,
	null		        qt_servico_serv,
	null 		        vl_servico_serv
FROM 	ptu_Pacote

union

select 	nr_seq_pacote		nr_seq_pacote,
	2			tp_registro,
	2			nr_sequencia,
	'202'			cd_tipo_registro,
	null			cd_estabelecimento_pacote,
	null			cd_unimed_origem_pacote,
	null			dt_atualizacao_pacote,
	null			dt_geracao_pacote,
	null			ie_tipo_carga_pacote,
	null			ie_tipo_informacao_pacote,
	null			nm_usuario_pacote,
	null			nr_seq_pacote,
	null			nr_versao_transacao_pacote,
	cd_especialidade        cd_especialidade_reg,
	cd_pacote               cd_pacote_reg,
	cd_prestador            cd_prestador_reg,
	cd_unimed_prestador 	cd_unimed_prestador_reg,
	ds_observacao           ds_observacao_reg,
	dt_atualizacao          dt_atualizacao_reg,
	dt_negociacao           dt_negociacao_reg,
	dt_publicacao		dt_publicacao_reg,
	ie_tipo_acomodacao      ie_tipo_acomodacao_reg,
	ie_tipo_informacao	ie_tipo_informacao_reg,
	ie_tipo_pacote		ie_tipo_pacote_reg,
	nm_pacote		nm_pacote_reg,
	nm_prestador            nm_prestador_reg,
	nm_usuario              nm_usuario_reg,
	nr_seq_pacote           nr_seq_pacote_reg,
	nr_sequencia            nr_seq_reg,
	null			ds_obs_reg,
	null			cd_servico_serv,
	null		        dt_atualizacao_serv,
	null		        ie_honorario_serv,
	null		        ie_principal_serv,
	null		        ie_tipo_item_serv,
	null			ie_tipo_participacao_serv,
	null 		        ie_tipo_tabela_serv,
	null		        nm_usuario_serv,
	null		        nr_seq_pacote_reg_serv,
	null 		        nr_seq_servico,
	null		        qt_servico_serv,
	null 		        vl_servico_serv
from 	ptu_pacote_reg

union

select	nr_seq_pacote		nr_seq_pacote,
	3			tp_registro,
	3			nr_sequencia,
	'203'			cd_tipo_registro,
	null			cd_estabelecimento_pacote,
	null			cd_unimed_origem_pacote,
	null			dt_atualizacao_pacote,
	null			dt_geracao_pacote,
	null			ie_tipo_carga_pacote,
	null			ie_tipo_informacao_pacote,
	null			nm_usuario_pacote,
	null			nr_seq_pacote,
	null			nr_versao_transacao_pacote,
	null        		cd_especialidade_reg,
	cd_pacote             	cd_pacote_reg,
	null		        cd_prestador_reg,
	null 			cd_unimed_prestador_reg,
	null		        ds_observacao_reg,
	null			dt_atualizacao_reg,
	null		        dt_negociacao_reg,
	null			dt_publicacao_reg,
	null			ie_tipo_acomodacao_reg,
	null			ie_tipo_informacao_reg,
	null			ie_tipo_pacote_reg,
	null			nm_pacote_reg,
	null		        nm_prestador_reg,
	null		        nm_usuario_reg,
	null		        nr_seq_pacote_reg,
	nr_sequencia		nr_seq_reg,
	ds_observacao		ds_obs_reg,
	null			cd_servico_serv,
	null		        dt_atualizacao_serv,
	null		        ie_honorario_serv,
	null		        ie_principal_serv,
	null		        ie_tipo_item_serv,
	null			ie_tipo_participacao_serv,
	null 		        ie_tipo_tabela_serv,
	null		        nm_usuario_serv,
	null		        nr_seq_pacote_reg_serv,
	null 		        nr_seq_servico,
	null		        qt_servico_serv,
	null 		        vl_servico_serv
from 	ptu_pacote_reg

union

select	b.nr_seq_pacote		nr_seq_pacote,
	4			tp_registro,
	4			nr_sequencia,
	'204'			cd_tipo_registro,
	null			cd_estabelecimento_pacote,
	null			cd_unimed_origem_pacote,
	null			dt_atualizacao_pacote,
	null			dt_geracao_pacote,
	null			ie_tipo_carga_pacote,
	null			ie_tipo_informacao_pacote,
	null			nm_usuario_pacote,
	null			nr_seq_pacote,
	null			nr_versao_transacao_pacote,
	null        		cd_especialidade_reg,
	null               	cd_pacote_reg,
	null		        cd_prestador_reg,
	null 			cd_unimed_prestador_reg,
	null		        ds_observacao_reg,
	null			dt_atualizacao_reg,
	null		        dt_negociacao_reg,
	null			dt_publicacao_reg,
	null			ie_tipo_acomodacao_reg,
	null			ie_tipo_informacao_reg,
	null			ie_tipo_pacote_reg,
	null			nm_pacote_reg,
	null		        nm_prestador_reg,
	null		        nm_usuario_reg,
	null		        nr_seq_pacote_reg,
	b.nr_sequencia		nr_seq_reg,
	null			ds_obs_reg,
	a.cd_servico		cd_servico_serv,
	a.dt_atualizacao        dt_atualizacao_serv,
	a.ie_honorario          ie_honorario_serv,
	a.ie_principal          ie_principal_serv,
	a.ie_tipo_item          ie_tipo_item_serv,
	a.ie_tipo_participacao	ie_tipo_participacao_serv,
	a.ie_tipo_tabela        ie_tipo_tabela_serv,
	a.nm_usuario            nm_usuario_serv,
	a.nr_seq_pacote_reg     nr_seq_pacote_reg_serv,
	a.nr_sequencia          nr_seq_servico,
	a.qt_servico            qt_servico_serv,
	(a.vl_servico*100)      vl_servico_serv --jjung OS 524834 - O campo vl_servico não pode ser grava do no arquivo com vígula, conforme manual do PTU 4.1,  verificado com Vagner - UL
from 	ptu_pacote_servico	a,
	ptu_pacote_reg		b
where	a.nr_seq_pacote_reg	= b.nr_sequencia;

