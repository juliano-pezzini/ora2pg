-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW dashboard_v (ds_dimensao, ds_agrupamento, ie_order, dt_referencia, vl_periodo, vl_periodo_1, vl_periodo_2, vl_periodo_3, vl_periodo_4, vl_periodo_5, vl_periodo_6, vl_periodo_7, vl_periodo_8, vl_periodo_9, vl_periodo_10, vl_periodo_11, vl_periodo_12, vl_periodo_13, vl_periodo_14, vl_periodo_15, vl_periodo_16, vl_periodo_17, vl_periodo_18, vl_periodo_19, vl_periodo_20, vl_periodo_21, vl_periodo_22, vl_periodo_23, vl_periodo_24, vl_periodo_25, vl_periodo_26, vl_periodo_27, vl_periodo_28, vl_periodo_29, vl_periodo_30, vl_periodo_31, vl_periodo_32, vl_periodo_33, vl_periodo_34, vl_periodo_35, vl_periodo_36, vl_periodo_37, vl_periodo_38, vl_periodo_39, vl_periodo_40, vl_periodo_41, vl_periodo_42, vl_periodo_43, vl_periodo_44, vl_periodo_45, vl_periodo_46, vl_periodo_47, vl_periodo_48, vl_periodo_49, vl_periodo_50, vl_periodo_51, vl_periodo_52, vl_periodo_53, vl_periodo_54, vl_periodo_55, vl_periodo_56, vl_periodo_57, vl_periodo_58, vl_periodo_59, vl_periodo_60, vl_periodo_61, vl_periodo_62, vl_periodo_63, vl_periodo_64, vl_periodo_65, vl_periodo_66, vl_periodo_67, nr_semana, nr_semana_1, nr_semana_2, nr_semana_3, nr_semana_4, nr_semana_5, nr_semana_6, nr_semana_7, nr_semana_8, nr_semana_9, nr_semana_10, nr_semana_11, nr_semana_12, nr_semana_13, nr_semana_14, nr_semana_15, nr_semana_16, nr_semana_17, nr_semana_18, nr_semana_19, nr_semana_20, nr_semana_21, nr_semana_22, nr_semana_23, nr_semana_24, nr_semana_25, nr_semana_26, nr_semana_27, nr_semana_28, nr_semana_29, nr_semana_30, nr_semana_31, nr_semana_32, nr_semana_33, nr_semana_34, nr_semana_35, nr_semana_36, nr_semana_37, nr_semana_38, nr_semana_39, nr_semana_40, nr_semana_41, nr_semana_42, nr_semana_43, nr_semana_44, nr_semana_45, nr_semana_46, nr_semana_47, nr_semana_48, nr_semana_49, nr_semana_50, nr_semana_51, nr_semana_52, nr_semana_53, nr_semana_54, nr_semana_55, nr_mes_1, nr_mes_2, nr_mes_3, nr_mes_4, nr_mes_5, nr_mes_6, nr_mes_7, nr_mes_8, nr_mes_9, nr_mes_10, nr_mes_11, nr_mes_12, nm_usuario) AS select substr(obter_valor_dominio(8138,a.ie_dimensao),1,255)              ds_dimensao,
       substr(obter_desc_expressao(b.cd_exp_agrup),1,255)                 ds_agrupamento,
       CASE WHEN a.ie_dimensao='PP' THEN 1 WHEN a.ie_dimensao='PR' THEN 2 WHEN a.ie_dimensao='HP' THEN 3 WHEN a.ie_dimensao='HR' THEN 4 WHEN a.ie_dimensao='RA' THEN 5 END            ie_order,
       a.dt_referencia                                                    dt_referencia,
       sum(case when a.nr_seq_apresentacao =  1 then a.vl_periodo else null end) vl_periodo,
       sum(case when a.nr_seq_apresentacao =  2 then a.vl_periodo else null end) vl_periodo_1,
       sum(case when a.nr_seq_apresentacao =  3 then a.vl_periodo else null end) vl_periodo_2,
       sum(case when a.nr_seq_apresentacao =  4 then a.vl_periodo else null end) vl_periodo_3,
       sum(case when a.nr_seq_apresentacao =  5 then a.vl_periodo else null end) vl_periodo_4,
       sum(case when a.nr_seq_apresentacao =  6 then a.vl_periodo else null end) vl_periodo_5,
       sum(case when a.nr_seq_apresentacao =  7 then a.vl_periodo else null end) vl_periodo_6,
       sum(case when a.nr_seq_apresentacao =  8 then a.vl_periodo else null end) vl_periodo_7,
       sum(case when a.nr_seq_apresentacao =  9 then a.vl_periodo else null end) vl_periodo_8,
       sum(case when a.nr_seq_apresentacao = 10 then a.vl_periodo else null end) vl_periodo_9,
       sum(case when a.nr_seq_apresentacao = 11 then a.vl_periodo else null end) vl_periodo_10,
       sum(case when a.nr_seq_apresentacao = 12 then a.vl_periodo else null end) vl_periodo_11,
       sum(case when a.nr_seq_apresentacao = 13 then a.vl_periodo else null end) vl_periodo_12,
       sum(case when a.nr_seq_apresentacao = 14 then a.vl_periodo else null end) vl_periodo_13,
       sum(case when a.nr_seq_apresentacao = 15 then a.vl_periodo else null end) vl_periodo_14,
       sum(case when a.nr_seq_apresentacao = 16 then a.vl_periodo else null end) vl_periodo_15,
       sum(case when a.nr_seq_apresentacao = 17 then a.vl_periodo else null end) vl_periodo_16,
       sum(case when a.nr_seq_apresentacao = 18 then a.vl_periodo else null end) vl_periodo_17,
       sum(case when a.nr_seq_apresentacao = 19 then a.vl_periodo else null end) vl_periodo_18,
       sum(case when a.nr_seq_apresentacao = 20 then a.vl_periodo else null end) vl_periodo_19,
       sum(case when a.nr_seq_apresentacao = 21 then a.vl_periodo else null end) vl_periodo_20,
       sum(case when a.nr_seq_apresentacao = 22 then a.vl_periodo else null end) vl_periodo_21,
       sum(case when a.nr_seq_apresentacao = 23 then a.vl_periodo else null end) vl_periodo_22,
       sum(case when a.nr_seq_apresentacao = 24 then a.vl_periodo else null end) vl_periodo_23,
       sum(case when a.nr_seq_apresentacao = 25 then a.vl_periodo else null end) vl_periodo_24,
       sum(case when a.nr_seq_apresentacao = 26 then a.vl_periodo else null end) vl_periodo_25,
       sum(case when a.nr_seq_apresentacao = 27 then a.vl_periodo else null end) vl_periodo_26,
       sum(case when a.nr_seq_apresentacao = 28 then a.vl_periodo else null end) vl_periodo_27,
       sum(case when a.nr_seq_apresentacao = 29 then a.vl_periodo else null end) vl_periodo_28,
       sum(case when a.nr_seq_apresentacao = 30 then a.vl_periodo else null end) vl_periodo_29,
       sum(case when a.nr_seq_apresentacao = 31 then a.vl_periodo else null end) vl_periodo_30,
       sum(case when a.nr_seq_apresentacao = 32 then a.vl_periodo else null end) vl_periodo_31,
       sum(case when a.nr_seq_apresentacao = 33 then a.vl_periodo else null end) vl_periodo_32,
       sum(case when a.nr_seq_apresentacao = 34 then a.vl_periodo else null end) vl_periodo_33,
       sum(case when a.nr_seq_apresentacao = 35 then a.vl_periodo else null end) vl_periodo_34,
       sum(case when a.nr_seq_apresentacao = 36 then a.vl_periodo else null end) vl_periodo_35,
       sum(case when a.nr_seq_apresentacao = 37 then a.vl_periodo else null end) vl_periodo_36,
       sum(case when a.nr_seq_apresentacao = 38 then a.vl_periodo else null end) vl_periodo_37,
       sum(case when a.nr_seq_apresentacao = 39 then a.vl_periodo else null end) vl_periodo_38,
       sum(case when a.nr_seq_apresentacao = 40 then a.vl_periodo else null end) vl_periodo_39,
       sum(case when a.nr_seq_apresentacao = 41 then a.vl_periodo else null end) vl_periodo_40,
       sum(case when a.nr_seq_apresentacao = 42 then a.vl_periodo else null end) vl_periodo_41,
       sum(case when a.nr_seq_apresentacao = 43 then a.vl_periodo else null end) vl_periodo_42,
       sum(case when a.nr_seq_apresentacao = 44 then a.vl_periodo else null end) vl_periodo_43,
       sum(case when a.nr_seq_apresentacao = 45 then a.vl_periodo else null end) vl_periodo_44,
       sum(case when a.nr_seq_apresentacao = 46 then a.vl_periodo else null end) vl_periodo_45,
       sum(case when a.nr_seq_apresentacao = 47 then a.vl_periodo else null end) vl_periodo_46,
       sum(case when a.nr_seq_apresentacao = 48 then a.vl_periodo else null end) vl_periodo_47,
       sum(case when a.nr_seq_apresentacao = 49 then a.vl_periodo else null end) vl_periodo_48,
       sum(case when a.nr_seq_apresentacao = 50 then a.vl_periodo else null end) vl_periodo_49,
       sum(case when a.nr_seq_apresentacao = 51 then a.vl_periodo else null end) vl_periodo_50,
       sum(case when a.nr_seq_apresentacao = 52 then a.vl_periodo else null end) vl_periodo_51,
       sum(case when a.nr_seq_apresentacao = 53 then a.vl_periodo else null end) vl_periodo_52,
       sum(case when a.nr_seq_apresentacao = 54 then a.vl_periodo else null end) vl_periodo_53,
       sum(case when a.nr_seq_apresentacao = 55 then a.vl_periodo else null end) vl_periodo_54,
       sum(case when a.nr_seq_apresentacao = 56 then a.vl_periodo else null end) vl_periodo_55,
       sum(case when a.nr_seq_apresentacao = 57 then a.vl_periodo else null end) vl_periodo_56,
       sum(case when a.nr_seq_apresentacao = 58 then a.vl_periodo else null end) vl_periodo_57,
       sum(case when a.nr_seq_apresentacao = 59 then a.vl_periodo else null end) vl_periodo_58,
       sum(case when a.nr_seq_apresentacao = 60 then a.vl_periodo else null end) vl_periodo_59,
       sum(case when a.nr_seq_apresentacao = 61 then a.vl_periodo else null end) vl_periodo_60,
       sum(case when a.nr_seq_apresentacao = 62 then a.vl_periodo else null end) vl_periodo_61,
       sum(case when a.nr_seq_apresentacao = 63 then a.vl_periodo else null end) vl_periodo_62,
       sum(case when a.nr_seq_apresentacao = 64 then a.vl_periodo else null end) vl_periodo_63,
       sum(case when a.nr_seq_apresentacao = 65 then a.vl_periodo else null end) vl_periodo_64,
       sum(case when a.nr_seq_apresentacao = 66 then a.vl_periodo else null end) vl_periodo_65,
       sum(case when a.nr_seq_apresentacao = 67 then a.vl_periodo else null end) vl_periodo_66,
       sum(case when a.nr_seq_apresentacao = 68 then a.vl_periodo else null end) vl_periodo_67,
       sum(case when a.nr_seq_apresentacao =  1 then to_char(a.dt_periodo, 'ww') else null end) nr_semana,
       sum(case when a.nr_seq_apresentacao =  2 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_1,
       sum(case when a.nr_seq_apresentacao =  3 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_2,
       sum(case when a.nr_seq_apresentacao =  4 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_3,
       sum(case when a.nr_seq_apresentacao =  5 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_4,
       sum(case when a.nr_seq_apresentacao =  6 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_5,
       sum(case when a.nr_seq_apresentacao =  7 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_6,
       sum(case when a.nr_seq_apresentacao =  8 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_7,
       sum(case when a.nr_seq_apresentacao =  9 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_8,
       sum(case when a.nr_seq_apresentacao = 10 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_9,
       sum(case when a.nr_seq_apresentacao = 11 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_10,
       sum(case when a.nr_seq_apresentacao = 12 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_11,
       sum(case when a.nr_seq_apresentacao = 13 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_12,
       sum(case when a.nr_seq_apresentacao = 14 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_13,
       sum(case when a.nr_seq_apresentacao = 15 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_14,
       sum(case when a.nr_seq_apresentacao = 16 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_15,
       sum(case when a.nr_seq_apresentacao = 17 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_16,
       sum(case when a.nr_seq_apresentacao = 18 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_17,
       sum(case when a.nr_seq_apresentacao = 19 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_18,
       sum(case when a.nr_seq_apresentacao = 20 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_19,
       sum(case when a.nr_seq_apresentacao = 21 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_20,
       sum(case when a.nr_seq_apresentacao = 22 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_21,
       sum(case when a.nr_seq_apresentacao = 23 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_22,
       sum(case when a.nr_seq_apresentacao = 24 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_23,
       sum(case when a.nr_seq_apresentacao = 25 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_24,
       sum(case when a.nr_seq_apresentacao = 26 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_25,
       sum(case when a.nr_seq_apresentacao = 27 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_26,
       sum(case when a.nr_seq_apresentacao = 28 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_27,
       sum(case when a.nr_seq_apresentacao = 29 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_28,
       sum(case when a.nr_seq_apresentacao = 30 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_29,
       sum(case when a.nr_seq_apresentacao = 31 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_30,
       sum(case when a.nr_seq_apresentacao = 32 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_31,
       sum(case when a.nr_seq_apresentacao = 33 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_32,
       sum(case when a.nr_seq_apresentacao = 34 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_33,
       sum(case when a.nr_seq_apresentacao = 35 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_34,
       sum(case when a.nr_seq_apresentacao = 36 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_35,
       sum(case when a.nr_seq_apresentacao = 37 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_36,
       sum(case when a.nr_seq_apresentacao = 38 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_37,
       sum(case when a.nr_seq_apresentacao = 39 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_38,
       sum(case when a.nr_seq_apresentacao = 40 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_39,
       sum(case when a.nr_seq_apresentacao = 41 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_40,
       sum(case when a.nr_seq_apresentacao = 42 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_41,
       sum(case when a.nr_seq_apresentacao = 43 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_42,
       sum(case when a.nr_seq_apresentacao = 44 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_43,
       sum(case when a.nr_seq_apresentacao = 45 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_44,
       sum(case when a.nr_seq_apresentacao = 46 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_45,
       sum(case when a.nr_seq_apresentacao = 47 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_46,
       sum(case when a.nr_seq_apresentacao = 48 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_47,
       sum(case when a.nr_seq_apresentacao = 49 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_48,
       sum(case when a.nr_seq_apresentacao = 50 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_49,
       sum(case when a.nr_seq_apresentacao = 51 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_50,
       sum(case when a.nr_seq_apresentacao = 52 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_51,
       sum(case when a.nr_seq_apresentacao = 53 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_52,
       sum(case when a.nr_seq_apresentacao = 54 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_53,
       sum(case when a.nr_seq_apresentacao = 55 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_54,
       sum(case when a.nr_seq_apresentacao = 56 then to_char(a.dt_periodo, 'ww') else null end) nr_semana_55,
       sum(case when a.nr_seq_apresentacao = 57 then to_char(a.dt_periodo, 'mm') else null end) nr_mes_1,
       sum(case when a.nr_seq_apresentacao = 58 then to_char(a.dt_periodo, 'mm') else null end) nr_mes_2,
       sum(case when a.nr_seq_apresentacao = 59 then to_char(a.dt_periodo, 'mm') else null end) nr_mes_3,
       sum(case when a.nr_seq_apresentacao = 60 then to_char(a.dt_periodo, 'mm') else null end) nr_mes_4,
       sum(case when a.nr_seq_apresentacao = 61 then to_char(a.dt_periodo, 'mm') else null end) nr_mes_5,
       sum(case when a.nr_seq_apresentacao = 62 then to_char(a.dt_periodo, 'mm') else null end) nr_mes_6,
       sum(case when a.nr_seq_apresentacao = 63 then to_char(a.dt_periodo, 'mm') else null end) nr_mes_7,
       sum(case when a.nr_seq_apresentacao = 64 then to_char(a.dt_periodo, 'mm') else null end) nr_mes_8,
       sum(case when a.nr_seq_apresentacao = 65 then to_char(a.dt_periodo, 'mm') else null end) nr_mes_9,
       sum(case when a.nr_seq_apresentacao = 66 then to_char(a.dt_periodo, 'mm') else null end) nr_mes_10,
       sum(case when a.nr_seq_apresentacao = 67 then to_char(a.dt_periodo, 'mm') else null end) nr_mes_11,
       sum(case when a.nr_seq_apresentacao = 68 then to_char(a.dt_periodo, 'mm') else null end) nr_mes_12,
       a.nm_usuario                                                                        nm_usuario
FROM funcoes_html5_over_semana a
LEFT OUTER JOIN agrupamento_funcoes_html5 b ON (a.nr_seq_agrupamento = b.nr_sequencia) group BY substr(obter_valor_dominio(8138,a.ie_dimensao),1,255),
       substr(obter_desc_expressao(b.cd_exp_agrup),1,255),
       CASE WHEN a.ie_dimensao='PP' THEN 1 WHEN a.ie_dimensao='PR' THEN 2 WHEN a.ie_dimensao='HP' THEN 3 WHEN a.ie_dimensao='HR' THEN 4 WHEN a.ie_dimensao='RA' THEN 5 END ,
       a.dt_referencia,
       a.nm_usuario;

