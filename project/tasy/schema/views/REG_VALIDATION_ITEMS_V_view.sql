-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW reg_validation_items_v (nr_seq_acao_teste, ie_validation_type, ds_detail, ds_name, ds_job, ds_department, nr_ciclo, nr_order, nr_seq_cycle, ie_result, ds_test_case_item, ds_result, ds_evidence_path, dt_execution, ie_severity, pr_aderencia, nr_sequencia, nm_curto, ds_title, ds_descricao_cr, ds_rationale, ds_descricao, ds_pre_condicao, nr_tempo_estimado) AS SELECT	ac.nr_sequencia nr_seq_acao_teste,
	p.ie_validation_type, 
	p.ds_detail, 
	p.ds_name, 
	p.ds_job, 
	p.ds_department, 
	p.nr_ciclo, 
	ac.nr_ordenacao nr_order, 
	pi.nr_seq_cycle, 
	pi.ie_result, 
	ac.ds_passo ds_test_case_item, 
	ac.ds_resultado ds_result, 
	pi.ds_evidence_path, 
	pi.dt_execution, 
	pi.ie_severity, 
	(SELECT	((select count(b.nr_sequencia) 
		 FROM REG_VALIDATION_PEND_ITEM b 
		 where b.ie_result = 'P' 
		 AND b.nr_seq_pend_tc = a.nr_seq_pend_tc) /	 
		COUNT(A.NR_SEQUENCIA)) pr_aderencia 
	FROM 	REG_VALIDATION_PEND_ITEM A 
	where 	a.ie_result <> 'B' 
	and	a.nr_seq_pend_tc = pi.nr_seq_pend_tc 
	group by nr_seq_pend_tc) pr_aderencia, 
	cr.nr_sequencia, 
	cr.nm_curto, 
	cr.ds_title, 
	cr.ds_descricao_cr, 
	cr.ds_rationale, 
	tc.ds_descricao, 
	tc.ds_pre_condicao, 
	tc.nr_tempo_estimado 
FROM reg_caso_teste tc, reg_validation_people p, reg_customer_requirement cr, reg_acao_teste ac, reg_validation_pend_item pi
LEFT OUTER JOIN reg_validation_so_pend so ON (pi.nr_sequencia = so.nr_seq_validation_item)
WHERE pi.nr_seq_pend_tc = p.nr_seq_ct_validation AND pi.nr_seq_cycle = p.nr_ciclo  AND ac.nr_sequencia = pi.nr_seq_pend_item AND tc.nr_sequencia = ac.nr_seq_caso_teste AND tc.nr_seq_customer = cr.nr_sequencia;

