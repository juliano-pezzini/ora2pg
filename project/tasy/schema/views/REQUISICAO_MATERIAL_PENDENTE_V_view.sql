-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW requisicao_material_pendente_v (nr_requisicao, nr_sequencia, cd_estabelecimento, cd_material, qt_material_requisitada, qt_material_atendida, vl_material, dt_atualizacao, nm_usuario, cd_unidade_medida, dt_atendimento, cd_pessoa_recebe, cd_pessoa_atende, ie_acao, cd_motivo_baixa, qt_estoque, cd_unidade_medida_estoque, cd_conta_contabil, cd_material_req, nr_seq_lote_fornec, cd_cgc_fornecedor, ds_observacao, ie_geracao, nr_seq_cor_exec, vl_preco_venda, nm_usuario_retirada, cd_material_lido, ds_justificativa, nr_seq_etapa_gpi, nr_documento_externo, nr_item_docto_externo, nr_seq_aprovacao, dt_aprov_item, nm_usuario_aprov, vl_unit_previsto, dt_reprovacao, cd_local_estoque, dt_solicitacao_requisicao, dt_liberacao, dt_aprovacao, dt_emissao_loc_estoque, cd_centro_custo, cd_local_estoque_destino, cd_pessoa_requisitante, cd_pessoa_solicitante, cd_setor_atendimento, nm_usuario_req, ds_obs, ds_local_estoque, cd_operacao_estoque, ds_operacao, nm_pessoa_fisica, ds_material, cd_unidade_medida_consumo, qt_conv_estoque_consumo, ds_pessoa_requisitante, ds_pessoa_solicitante, dt_compra) AS SELECT /*INDEX (C ITEREQM_I1) */
	c.nr_requisicao, 
	c.nr_sequencia, 
	c.cd_estabelecimento, 
	c.cd_material, 
	c.qt_material_requisitada, 
	c.qt_material_atendida, 
	c.vl_material, 
	c.dt_atualizacao, 
	c.nm_usuario, 
	c.cd_unidade_medida, 
	c.dt_atendimento, 
	c.cd_pessoa_recebe, 
	c.cd_pessoa_atende, 
	c.ie_acao, 
	c.cd_motivo_baixa, 
	c.qt_estoque, 
	c.cd_unidade_medida_estoque, 
	c.cd_conta_contabil, 
	c.cd_material_req, 
	c.nr_seq_lote_fornec, 
	c.cd_cgc_fornecedor, 
	c.ds_observacao, 
	c.ie_geracao, 
	c.nr_seq_cor_exec, 
	c.vl_preco_venda, 
	c.nm_usuario_retirada, 
	c.cd_material_lido, 
	c.ds_justificativa, 
	c.nr_seq_etapa_gpi, 
	c.nr_documento_externo, 
	c.nr_item_docto_externo, 
	c.nr_seq_aprovacao, 
	c.dt_aprovacao dt_aprov_item, 
	c.nm_usuario_aprov, 
	c.vl_unit_previsto, 
	c.dt_reprovacao, 
	d.cd_local_estoque, 
	b.dt_solicitacao_requisicao, 
	b.dt_liberacao, 
	b.dt_aprovacao, 
	b.dt_emissao_loc_estoque, 
	b.cd_centro_custo , 
	b.cd_local_estoque_destino, 
	b.cd_pessoa_requisitante, 
	b.cd_pessoa_solicitante, 
	b.cd_setor_atendimento, 
	b.nm_usuario nm_usuario_req, 
	b.ds_observacao ds_obs, 
	d.ds_local_estoque , 
	o.cd_operacao_estoque, 
	o.ds_operacao , 
	s.nm_pessoa_fisica, 
	a.ds_material, 
	substr(obter_dados_material_estab(c.cd_material,c.cd_estabelecimento,'UMS'),1,30) cd_unidade_medida_consumo, 
	a.qt_conv_estoque_consumo, 
	substr(obter_nome_pf(b.cd_pessoa_requisitante),1,100) ds_pessoa_requisitante, 
	substr(obter_nome_pf(b.cd_pessoa_solicitante),1,100) ds_pessoa_solicitante, 
	b.dt_compra 
FROM	material a , 
	operacao_estoque o , 
	pessoa_fisica s, 
	local_estoque d , 
	requisicao_material b, 
	item_requisicao_material c, 
	sup_motivo_baixa_req e 
where	b.nr_requisicao		= c.nr_requisicao 
and	a.cd_material		= c.cd_material 
and	d.cd_estabelecimento	= b.cd_estabelecimento 
and	b.cd_operacao_estoque	= o.cd_operacao_estoque 
and	b.cd_pessoa_requisitante	= s.cd_pessoa_fisica 
and	d.cd_local_estoque		= b.cd_local_estoque 
and	c.cd_motivo_baixa		= e.nr_sequencia 
and	e.cd_motivo_baixa		= 0;

