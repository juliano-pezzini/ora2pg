-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW unimed_campinas_v (cd_executante, cd_convenio, tp_local, nr_atendimento, nr_interno_conta, ie_emite_conta) AS Select substr(Obter_Valor_Conv_Estab(b.cd_convenio_parametro,b.cd_estabelecimento,'CD_REGIONAL'),1,15) cd_executante,		
	b.cd_convenio_parametro cd_convenio, 
	CASE WHEN a.ie_tipo_atendimento=1 THEN '21'  ELSE '22' END  tp_local, 
	a.nr_atendimento, 
	b.nr_interno_conta, 
	'62' ie_emite_conta 
FROM 	atendimento_paciente a, 
	conta_paciente b 
where 	a.nr_atendimento = b.nr_atendimento;

