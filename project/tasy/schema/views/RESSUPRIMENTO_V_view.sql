-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ressuprimento_v (ie_tipo_ressuprimento, ds_grupo_material, cd_grupo_material, cd_subgrupo_material, ds_material_comercial, cd_material_comercial, cd_unidade_medida_estoque, qt_estoque, qt_estoque_minimo, qt_ponto_pedido, qt_estoque_maximo, qt_consumo_mensal, qt_ordem_compra, qt_cotacao_compra, qt_solic_compra, ie_curva_abc, ie_curva_abc_grupo, nr_ordem_compra, dt_entrega_ordem, qt_dia_estoque_minimo, qt_dia_interv_ressup, qt_dia_ressup_forn, vl_excedente, qt_cons_prev_mes, cd_material, ds_material, ie_cons_prev_mes, cd_estabelecimento) AS select 	0 ie_tipo_ressuprimento,
		a.ds_grupo_material,
		a.cd_grupo_material,
		a.cd_subgrupo_material,
       	a.ds_material_comercial,
       	a.cd_material_comercial,
       	a.cd_unidade_medida_estoque,
       	a.qt_estoque,
       	a.qt_estoque_minimo,
       	a.qt_ponto_pedido,
       	a.qt_estoque_maximo,
       	a.qt_consumo_mensal,
       	a.qt_ordem_compra,
       	a.qt_cotacao_compra,
       	a.qt_solic_compra,
       	a.ie_curva_abc,
       	a.ie_curva_abc_grupo,
       	a.nr_ordem_compra,
       	a.dt_entrega_ordem,
       	a.qt_dia_estoque_minimo,
       	a.qt_dia_interv_ressup,
       	a.qt_dia_ressup_forn,
       	a.vl_excedente,
		a.qt_cons_prev_mes,
       	a.cd_material,
       	a.ds_material,
		a.IE_CONS_PREV_MES,
		a.cd_estabelecimento
FROM   	material_Ressuprimento_v a
where  	qt_estoque <= qt_estoque_minimo

union

select		1 ie_tipo_ressuprimento,
		a.ds_grupo_material,
		a.cd_grupo_material,
		a.cd_subgrupo_material,
       	a.ds_material_comercial,
       	a.cd_material_comercial,
       	a.cd_unidade_medida_estoque,
       	a.qt_estoque,
       	a.qt_estoque_minimo,
       	a.qt_ponto_pedido,
       	a.qt_estoque_maximo,
       	a.qt_consumo_mensal,
       	a.qt_ordem_compra,
       	a.qt_cotacao_compra,
       	a.qt_solic_compra,
       	a.ie_curva_abc,
       	a.ie_curva_abc_grupo,
       	a.nr_ordem_compra,
       	a.dt_entrega_ordem,
       	a.qt_dia_estoque_minimo,
       	a.qt_dia_interv_ressup,
       	a.qt_dia_ressup_forn,
       	a.vl_excedente,
		a.qt_cons_prev_mes,
        	a.cd_material,
       	a.ds_material,
		a.IE_CONS_PREV_MES,
		a.cd_estabelecimento
from   	material_Ressuprimento_v a
where  	qt_estoque > qt_estoque_minimo
and    	qt_estoque <= qt_ponto_pedido

union

select		2 ie_tipo_ressuprimento,
		a.ds_grupo_material,
		a.cd_grupo_material,
		a.cd_subgrupo_material,
       	a.ds_material_comercial,
       	a.cd_material_comercial,
       	a.cd_unidade_medida_estoque,
       	a.qt_estoque,
       	a.qt_estoque_minimo,
       	a.qt_ponto_pedido,
       	a.qt_estoque_maximo,
       	a.qt_consumo_mensal,
       	a.qt_ordem_compra,
       	a.qt_cotacao_compra,
       	a.qt_solic_compra,
       	a.ie_curva_abc,
       	a.ie_curva_abc_grupo,
       	a.nr_ordem_compra,
       	a.dt_entrega_ordem,
       	a.qt_dia_estoque_minimo,
       	a.qt_dia_interv_ressup,
       	a.qt_dia_ressup_forn,
       	a.vl_excedente,
		a.qt_cons_prev_mes,
       	a.cd_material,
       	a.ds_material,
		a.IE_CONS_PREV_MES,
		a.cd_estabelecimento
from   	material_Ressuprimento_v a
where  	qt_estoque > qt_estoque_maximo

union

select		3 ie_tipo_ressuprimento,
		a.ds_grupo_material,
		a.cd_grupo_material,
		a.cd_subgrupo_material,
       	a.ds_material_comercial,
       	a.cd_material_comercial,
       	a.cd_unidade_medida_estoque,
       	a.qt_estoque,
       	a.qt_estoque_minimo,
       	a.qt_ponto_pedido,
       	a.qt_estoque_maximo,
       	a.qt_consumo_mensal,
       	a.qt_ordem_compra,
       	a.qt_cotacao_compra,
       	a.qt_solic_compra,
       	a.ie_curva_abc,
       	a.ie_curva_abc_grupo,
       	a.nr_ordem_compra,
       	a.dt_entrega_ordem,
       	a.qt_dia_estoque_minimo,
       	a.qt_dia_interv_ressup,
       	a.qt_dia_ressup_forn,
       	a.vl_excedente,
		a.qt_cons_prev_mes,
       	a.cd_material,
       	a.ds_material,
		a.IE_CONS_PREV_MES,
		a.cd_estabelecimento
from   	material_Ressuprimento_v a
where  	a.IE_CONS_PREV_MES = 'S';

