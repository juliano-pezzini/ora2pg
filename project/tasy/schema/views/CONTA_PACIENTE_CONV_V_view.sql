-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW conta_paciente_conv_v (dt_entrada_unidade, nr_atendimento, ie_proc_mat, dt_conta, dt_ent_unidade, dt_item, cd_item, cd_item_convenio, qt_item, vl_item, vl_medico, vl_anestesista, vl_filme, vl_auxiliares, vl_custo_operacional, dt_acerto_conta, dt_acerto_convenio, cd_convenio, cd_categoria, cd_setor_atendimento, ie_cobra_pf_pj, nr_interno_conta, nm_usuario, dt_atualizacao, nr_prescricao, dt_prescricao, nr_sequencia_prescricao, cd_medico_executor, cd_procedimento_princ, nr_cirurgia, ie_valor_informado, cd_situacao_glosa, tx_procedimento, ds_item, tp_item, cd_classe_item, ds_classe_item, cd_subgrupo_item, ds_subgrupo_item, cd_grupo_item, ds_grupo_item, ds_unidade, cd_motivo_exc_conta, vl_unitario, nr_doc_convenio, nr_sequencia, ie_origem_proced, nr_seq_proc_pacote, vl_original, qt_porte_anestesico, tx_hora_extra, nr_seq_protocolo, nr_seq_protocolo_sel, ie_status_acerto, ie_emite_conta, ie_emite_conta_honor, ie_responsavel_credito, vl_medico_conta, ie_tipo_guia, ie_cancelamento, nr_seq_atepacu, nr_seq_proc_princ, ds_compl_motivo_excon, ds_proc_interno, ds_proc_int_ou_orig, cd_cgc_prestador, cd_motivo_ajuste, nm_usuario_original, ie_auditoria, ds_observacao, ds_exame, cd_setor_paciente, cd_estabelecimento, cd_conta_contabil, nr_seq_grupo_rec, cd_senha, dt_mesano_referencia, cd_tipo_procedimento, nr_seq_proc_interno, nr_seq_cor_exec, cd_procedimento_tuss, cd_local_estoque, ds_item_convenio, ds_unidade_medida, cd_grupo_convenio) AS select	a.DT_ENTRADA_UNIDADE,a.NR_ATENDIMENTO,a.IE_PROC_MAT,a.DT_CONTA,a.DT_ENT_UNIDADE,a.DT_ITEM,a.CD_ITEM,a.CD_ITEM_CONVENIO,a.QT_ITEM,a.VL_ITEM,a.VL_MEDICO,a.VL_ANESTESISTA,a.VL_FILME,a.VL_AUXILIARES,a.VL_CUSTO_OPERACIONAL,a.DT_ACERTO_CONTA,a.DT_ACERTO_CONVENIO,a.CD_CONVENIO,a.CD_CATEGORIA,a.CD_SETOR_ATENDIMENTO,a.IE_COBRA_PF_PJ,a.NR_INTERNO_CONTA,a.NM_USUARIO,a.DT_ATUALIZACAO,a.NR_PRESCRICAO,a.DT_PRESCRICAO,a.NR_SEQUENCIA_PRESCRICAO,a.CD_MEDICO_EXECUTOR,a.CD_PROCEDIMENTO_PRINC,a.NR_CIRURGIA,a.IE_VALOR_INFORMADO,a.CD_SITUACAO_GLOSA,a.TX_PROCEDIMENTO,a.DS_ITEM,a.TP_ITEM,a.CD_CLASSE_ITEM,a.DS_CLASSE_ITEM,a.CD_SUBGRUPO_ITEM,a.DS_SUBGRUPO_ITEM,a.CD_GRUPO_ITEM,a.DS_GRUPO_ITEM,a.DS_UNIDADE,a.CD_MOTIVO_EXC_CONTA,a.VL_UNITARIO,a.NR_DOC_CONVENIO,a.NR_SEQUENCIA,a.IE_ORIGEM_PROCED,a.NR_SEQ_PROC_PACOTE,a.VL_ORIGINAL,a.QT_PORTE_ANESTESICO,a.TX_HORA_EXTRA,a.NR_SEQ_PROTOCOLO,a.NR_SEQ_PROTOCOLO_SEL,a.IE_STATUS_ACERTO,a.IE_EMITE_CONTA,a.IE_EMITE_CONTA_HONOR,a.IE_RESPONSAVEL_CREDITO,a.VL_MEDICO_CONTA,a.IE_TIPO_GUIA,a.IE_CANCELAMENTO,a.NR_SEQ_ATEPACU,a.NR_SEQ_PROC_PRINC,a.DS_COMPL_MOTIVO_EXCON,a.DS_PROC_INTERNO,a.DS_PROC_INT_OU_ORIG,a.CD_CGC_PRESTADOR,a.CD_MOTIVO_AJUSTE,a.NM_USUARIO_ORIGINAL,a.IE_AUDITORIA,a.DS_OBSERVACAO,a.DS_EXAME,a.CD_SETOR_PACIENTE,a.CD_ESTABELECIMENTO,a.CD_CONTA_CONTABIL,a.NR_SEQ_GRUPO_REC,a.CD_SENHA,a.DT_MESANO_REFERENCIA,a.CD_TIPO_PROCEDIMENTO,a.NR_SEQ_PROC_INTERNO,a.NR_SEQ_COR_EXEC,a.CD_PROCEDIMENTO_TUSS,a.CD_LOCAL_ESTOQUE,
		Obter_Nome_Item_Convenio(a.cd_convenio,a.ie_proc_mat,a.cd_item, 
						a.ie_origem_proced,'N', null, null, null, null) ds_item_convenio, 
		coalesce(b.cd_unidade_convenio,a.ds_unidade) ds_unidade_medida, 
		Obter_Grupo_Item_Convenio(a.cd_convenio,a.ie_proc_mat,a.cd_item, 
						a.ie_origem_proced, null, null, null) cd_grupo_convenio 
FROM conta_paciente_v a
LEFT OUTER JOIN conversao_unidade_medida b ON (a.cd_convenio = b.cd_convenio AND a.ds_unidade = b.cd_unidade_medida);

