-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ficha_financeira_dependente_v (cd, seq, compl, ds, cd_pessoa, code) AS SELECT a.cd_pessoa_fisica_ref cd,
 a.cd_pessoa_fisica_ref seq, 
 a.ie_tipo_complemento compl, 
 SUBSTR(obter_nome_pf(a.cd_pessoa_fisica_ref),1,100) ds, 
 a.cd_pessoa_fisica cd_pessoa, 
 2 code --Conjuje 
FROM compl_pessoa_fisica a 
WHERE a.cd_pessoa_fisica_ref IS NOT NULL 
AND a.IE_TIPO_COMPLEMENTO  = 6 

UNION ALL
 
SELECT a.cd_pessoa_fisica_ref cd, 
 a.cd_pessoa_fisica_ref seq, 
 a.ie_tipo_complemento compl, 
 SUBSTR(obter_nome_pf(a.cd_pessoa_fisica_ref),1,100) ds, 
 a.cd_pessoa_fisica cd_pessoa, 
 2.1	code --Pai 
FROM compl_pessoa_fisica a 
WHERE a.cd_pessoa_fisica_ref IS NOT NULL 
AND a.IE_TIPO_COMPLEMENTO  = 1 

UNION ALL
 
SELECT a.cd_pessoa_fisica_ref cd, 
 a.cd_pessoa_fisica_ref seq, 
 a.ie_tipo_complemento compl, 
 SUBSTR(obter_nome_pf(a.cd_pessoa_fisica_ref),1,100) ds, 
 a.cd_pessoa_fisica cd_pessoa, 
 2.2 code --Mae 
FROM compl_pessoa_fisica a 
WHERE a.cd_pessoa_fisica_ref IS NOT NULL 
AND a.IE_TIPO_COMPLEMENTO  = 5 

UNION ALL
 
SELECT a.cd_pessoa_fisica_ref cd, 
 a.cd_pessoa_fisica_ref seq, 
 a.ie_tipo_complemento compl, 
 SUBSTR(obter_nome_pf(a.cd_pessoa_fisica_ref),1,100) ds, 
 a.cd_pessoa_fisica cd_pessoa, 
 null code 
FROM compl_pessoa_fisica a 
WHERE a.cd_pessoa_fisica_ref IS NOT NULL 
AND a.IE_TIPO_COMPLEMENTO  not in (1,5,6);

