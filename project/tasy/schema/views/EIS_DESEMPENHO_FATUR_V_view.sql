-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_desempenho_fatur_v (dt_referencia, cd_estabelecimento, cd_convenio, ie_tipo_atendimento, ie_complexidade, hr_fechamento, qt_conta, qt_minuto, nm_usuario_fecha, ie_etapa, nm_usuario_conta, dt_fechamento, cd_setor_usuario, vl_conta, ds_conv, qt_atend, cd_responsavel, cd_medico_resp, nr_seq_etapa, ie_tipo_protocolo, cd_categoria, qt_conta_hora, qt_conta_dia, ds_convenio, ds_tipo_atendimento, ds_complexidade, ds_etapa, ds_setor_usuario, nm_responsavel, nm_medico_resp, ds_etapa_conta, ds_tipo_protocolo) AS select	a.DT_REFERENCIA,a.CD_ESTABELECIMENTO,a.CD_CONVENIO,a.IE_TIPO_ATENDIMENTO,a.IE_COMPLEXIDADE,a.HR_FECHAMENTO,a.QT_CONTA,a.QT_MINUTO,a.NM_USUARIO_FECHA,a.IE_ETAPA,a.NM_USUARIO_CONTA,a.DT_FECHAMENTO,a.CD_SETOR_USUARIO,a.VL_CONTA,a.DS_CONV,a.QT_ATEND,a.CD_RESPONSAVEL,a.CD_MEDICO_RESP,a.NR_SEQ_ETAPA,a.IE_TIPO_PROTOCOLO,a.CD_CATEGORIA,
	dividir(dividir(a.qt_minuto, 60), a.qt_conta) qt_conta_hora, 
	dividir(dividir(a.qt_minuto, 1440), a.qt_conta) qt_conta_dia, 
	coalesce(ds_conv, obter_nome_convenio(a.cd_convenio)) ds_convenio, 
	obter_valor_dominio(12, a.ie_tipo_atendimento) ds_tipo_atendimento, 
	obter_valor_dominio(1074, a.ie_complexidade) ds_complexidade, 
	obter_valor_dominio(1417, a.ie_etapa) ds_etapa, 
	substr(obter_nome_setor(a.cd_setor_usuario),1,120) ds_setor_usuario, 
	coalesce(substr(obter_nome_pf(a.cd_responsavel),1,60),'N達o informado') nm_responsavel, 
	coalesce(substr(obter_nome_pf(a.cd_medico_resp),1,60),'N達o informado') nm_medico_resp, 
	coalesce(substr(obter_descricao_etapa(a.nr_seq_etapa),1,60) ,'N達o informado') ds_etapa_conta, 
	coalesce(substr(obter_valor_dominio(73,a.ie_tipo_protocolo),1,120),'N達o informado') ds_tipo_protocolo 
FROM	eis_desempenho_fatur a;

