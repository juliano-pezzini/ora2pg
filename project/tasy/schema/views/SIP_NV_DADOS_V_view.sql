-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW sip_nv_dados_v (nr_sequencia, cd_procedimento, ie_origem_proced, ie_tipo_despesa, nr_seq_material, nr_seq_conta_proc, nr_seq_conta_mat, nr_seq_conta, qt_proc_mat, nr_seq_lote_sip, ie_tipo_protocolo, nr_seq_segurado, cd_guia_referencia, ie_tipo_atendimento, nr_documento, ie_glosa_conta, ie_glosa_item, ie_tipo_guia, nr_seq_prestador_exec, nr_seq_cbo_saude, cd_doenca_dig, cd_categoria_cid, nr_seq_tipo_atendimento, nr_seq_clinica, ie_regime_internacao, ie_sexo, qt_idade, qt_idade_mes, qt_idade_dia, qt_nasc_vivos_total, qt_horas_atendimento) AS select	a.nr_sequencia,
	CASE WHEN a.ie_tipo_despesa=4 THEN  a.cd_procedimento_pct  ELSE a.cd_procedimento END  cd_procedimento,
	CASE WHEN a.ie_tipo_despesa=4 THEN  a.ie_origem_proced_pct  ELSE a.ie_origem_proced END  ie_origem_proced,
	a.ie_tipo_despesa,
	a.nr_seq_material,
	a.nr_seq_conta_proc,
	a.nr_seq_conta_mat,
	a.nr_seq_conta,
	a.qt_proc_mat,
	a.nr_seq_lote_sip,
	a.ie_tipo_protocolo,
	a.nr_seq_segurado,
	a.cd_guia_referencia,
	a.ie_tipo_atendimento,
	a.nr_documento,
	a.ie_glosa_conta,
	a.ie_glosa_item,
	a.ie_tipo_guia,
	a.nr_seq_prestador_exec,
	a.nr_seq_cbo_saude,
	a.cd_doenca_dig,
	a.cd_categoria_cid,
	a.nr_seq_tipo_atendimento,
	a.nr_seq_clinica,
	a.ie_regime_internacao,
	a.ie_sexo,
	a.qt_idade,
	a.qt_idade_mes,
	a.qt_idade_dia,
	a.qt_nasc_vivos_total,
	a.qt_horas_atendimento
FROM	sip_nv_dados	a;

