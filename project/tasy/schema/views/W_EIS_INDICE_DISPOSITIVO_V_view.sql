-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW w_eis_indice_dispositivo_v (cd_setor, ds_setor_atendimento, dt_evento, ds_unidade, ie_faixa_etaria, ds_dispositivo, nr_disp, nr_atendimento) AS select	distinct
	b.cd_setor_atendimento cd_setor, 
	substr(obter_nome_setor(b.cd_setor_atendimento),1,255) ds_Setor_Atendimento,	 
	b.dt_evento, 
	obter_unidade_atendimento(b.nr_atendimento,'A','U') ds_unidade, 
	substr(obter_idade(obter_data_nascto_pf(b.cd_pessoa_fisica),LOCALTIMESTAMP,'E'),1,10) ie_faixa_etaria, 
	substr(obter_descricao_padrao('DISPOSITIVO','DS_DISPOSITIVO',c.nr_seq_dispositivo),1,255)ds_dispositivo, 
	c.nr_seq_dispositivo nr_disp,	 
	b.nr_atendimento 
FROM	qua_evento_paciente b, 
		qua_tipo_evento d, 
		qua_evento f, 
		atend_pac_dispositivo c	 
where	b.dt_inativacao is null 
and	c.nr_sequencia = b.nr_seq_disp_pac 
and	d.ie_tipo_evento = 'RD' 
and	d.nr_sequencia = f.nr_Seq_tipo 
and	b.nr_Seq_evento = f.nr_sequencia;

