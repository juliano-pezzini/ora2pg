-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_resumo_desconto_folha_v (dt_remessa_retorno, vl_comissao, vl_titulos) AS select	dt_remessa_retorno,
	sum(vl_comissao) vl_comissao,
	sum(vl_titulos)	 vl_titulos
FROM (
select	trunc(a.dt_remessa_retorno,'month') dt_remessa_retorno,
	sum(a.vl_comissao_empresa) vl_comissao,
	0			   vl_titulos
from	cobranca_escritural	a,
	pls_desc_empresa	b
where	a.nr_seq_empresa = b.nr_sequencia
group by	trunc(a.dt_remessa_retorno,'month')

union

select	trunc(d.dt_remessa_retorno,'month') dt_remessa_retorno,
	0		 vl_comissao,
	sum(vl_cobranca) vl_titulos
from	titulo_receber_cobr	a,
	titulo_receber		b,
	pls_desc_empresa	c,
	cobranca_escritural	d
where	a.nr_titulo 	  = b.nr_titulo
and	c.nr_sequencia    = d.nr_seq_empresa
and	a.nr_seq_cobranca = d.nr_sequencia
group by	trunc(d.dt_remessa_retorno,'month')
) alias8
group by dt_remessa_retorno;

