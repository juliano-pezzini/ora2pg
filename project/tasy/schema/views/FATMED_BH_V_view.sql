-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW fatmed_bh_v (nr_seq_protocolo, cd_convenio, tp_registro, ie_disquete, cd_tipo_registro, nr_lote, cd_prestador, nr_protocolo, dt_inicio_protocolo, dt_fim_protocolo, nr_seq_conta, ie_tipo_prestador, cd_cgc, nm_prestador, dt_remessa, nr_seq_remessa, nr_reg_remessa, nm_paciente, ie_sexo, dt_nascimento, cd_cliente, nr_conta, ie_tipo_paciente, cd_tipo_atendimento, cd_classe_atendimento, dt_item, cd_cid, nr_crm, sg_uf_crm, nm_medico_requisitante, cd_medico_requisitante, dt_requisicao, nr_guia, dt_guia, nm_responsavel_guia, cd_proced_guia, ds_proced_guia, qt_proced_guia, nr_seqproc_guia, nr_seq_item, ds_item, cd_item, qt_item, qt_gus, cd_cgc_convenio, nr_prontuario, cd_plano, cd_dependente, dt_validade_carteira, nr_identidade, cd_tipo_acomodacao, dt_entrada, dt_alta, cd_motivo_alta, tp_guia, cd_medico_convenio, ie_funcao_medico, qt_porte_anestesico, cd_grupo_gasto, ds_unidade_medida, qt_ch, vl_unitario_ch, vl_unitario, vl_item, pr_funcao_partic, ie_via_acesso, pr_via_acesso, pr_hora_extra, ie_local_medicado, cd_brasindice, cd_item_convenio, cd_procedimento_ref, cd_proc_ref_conv, cd_senha, ds_espaco, ds_zeros, cd_item_bras_proc, dt_alta_alfa, hr_alta_alfa) AS SELECT	a.NR_SEQ_PROTOCOLO,a.CD_CONVENIO CD_CONVENIO,0 TP_REGISTRO,
      	'FATOU' IE_DISQUETE,0 CD_TIPO_REGISTRO,0 NR_LOTE,a.CD_INTERNO CD_PRESTADOR, 
		nr_protocolo, dt_inicio_protocolo, dt_fim_protocolo, 
      	0 NR_SEQ_CONTA,'J' IE_TIPO_PRESTADOR,a.cd_cgc_hospital CD_CGC, 
      	a.nm_hospital			NM_PRESTADOR, 
      	a.dt_remessa			DT_REMESSA, 
      	a.nr_remessa			NR_SEQ_REMESSA, 
      	1 NR_REG_REMESSA,'' NM_PACIENTE,'' IE_SEXO,LOCALTIMESTAMP DT_NASCIMENTO, 
      	'' CD_CLIENTE,0 NR_CONTA,'' IE_TIPO_PACIENTE,0 CD_TIPO_ATENDIMENTO, 
      	'' CD_CLASSE_ATENDIMENTO,LOCALTIMESTAMP DT_ITEM,'' CD_CID,'' NR_CRM, 
      	'' SG_UF_CRM, '' NM_MEDICO_REQUISITANTE,'' CD_MEDICO_REQUISITANTE, 
      	LOCALTIMESTAMP DT_REQUISICAO,'' NR_GUIA,LOCALTIMESTAMP DT_GUIA, 
		'' NM_RESPONSAVEL_GUIA,'' CD_PROCED_GUIA,'' DS_PROCED_GUIA, 
		0 QT_PROCED_GUIA,1 NR_SEQPROC_GUIA,0 NR_SEQ_ITEM, '' DS_ITEM, 
      	0 CD_ITEM,0 QT_ITEM,0 QT_GUS,a.CD_CGC_convenio CD_CGC_CONVENIO,0 NR_PRONTUARIO, 
		'' CD_PLANO,0 CD_DEPENDENTE,LOCALTIMESTAMP DT_VALIDADE_CARTEIRA, 
		'' NR_IDENTIDADE,0 CD_TIPO_ACOMODACAO,LOCALTIMESTAMP DT_ENTRADA,LOCALTIMESTAMP DT_ALTA, 
		0 CD_MOTIVO_ALTA,'' TP_GUIA,'' CD_MEDICO_CONVENIO,'' IE_FUNCAO_MEDICO, 
		'' QT_PORTE_ANESTESICO,'' CD_GRUPO_GASTO,'' DS_UNIDADE_MEDIDA, 
		0 QT_CH,0 VL_UNITARIO_CH,0 VL_UNITARIO,0 VL_ITEM,0 PR_FUNCAO_PARTIC, 
		'0' IE_VIA_ACESSO,0 PR_VIA_ACESSO,0 PR_HORA_EXTRA,' ' IE_LOCAL_MEDICADO, 
		'' CD_BRASINDICE,'' CD_ITEM_CONVENIO,0 CD_PROCEDIMENTO_REF, 
		'' CD_PROC_REF_CONV, '' CD_SENHA, 
		'                  ' ds_espaco, 
		'00000000000000000000000000000000000' ds_zeros, 
		'' cd_item_bras_proc, '' dt_alta_alfa, '' hr_alta_alfa 
FROM 	w_interf_conta_header a 

union all
 
SELECT   	a.NR_SEQ_PROTOCOLO,a.CD_CONVENIO CD_CONVENIO,1 TP_REGISTRO, 
      	'FATOU' IE_DISQUETE,1 CD_TIPO_REGISTRO,1 NR_LOTE,a.CD_INTERNO CD_PRESTADOR, 
		'0', LOCALTIMESTAMP, LOCALTIMESTAMP, 
      	0               NR_SEQ_CONTA, 
      	''              IE_TIPO_PRESTADOR, 
      	a.cd_cgc_hospital       CD_CGC, 
      	''              NM_PRESTADOR, 
      	LOCALTIMESTAMP         	DT_REMESSA, 
      	a.nr_remessa    		NR_SEQ_REMESSA, 
      	0               NR_REG_REMESSA, 
      	a.nm_paciente			NM_PACIENTE, 
      	a.IE_SEXO, 
      	a.DT_NASCIMENTO, 
      	a.cd_usuario_convenio		CD_CLIENTE, 
      	a.NR_INTERNO_CONTA      NR_CONTA, 
		a.ie_tipo_paciente		IE_TIPO_PACIENTE, 
      	a.ie_tipo_atendimento		CD_TIPO_ATENDIMENTO, 
		a.cd_classe_atendimento		CD_CLASSE_ATENDIMENTO, 
      	LOCALTIMESTAMP         	DT_ITEM, 
      	a.cd_cid_principal      CD_CID, 
      	a.nr_crm_medico_resp     NR_CRM, 
      	a.uf_crm_medico_resp     SG_UF_CRM, 
      	a.nm_medico_resp   		NM_MEDICO_REQUISITANTE, 
		a.cd_conv_medico_resp		CD_MEDICO_REQUISITANTE, 
      	LOCALTIMESTAMP            DT_REQUISICAO, 
      	''              NR_GUIA, 
      	LOCALTIMESTAMP         	DT_GUIA, 
		''					NM_RESPONSAVEL_GUIA, 
		''					CD_PROCED_GUIA, 
		''					DS_PROCED_GUIA, 
		0					QT_PROCED_GUIA,		 
		1					NR_SEQPROC_GUIA,		 
      	0               NR_SEQ_ITEM, 
      	''              DS_ITEM, 
      	0               CD_ITEM, 
      	0               QT_ITEM, 
      	0               QT_GUS, 
		a.cd_cgc_convenio			CD_CGC_CONVENIO, 
		a.NR_PRONTUARIO			NR_PRONTUARIO, 
		a.cd_plano_convenio		CD_PLANO, 
		coalesce(a.cd_dependente,1)		CD_DEPENDENTE, 
		a.dt_validade_carteira		DT_VALIDADE_CARTEIRA, 
		a.NR_IDENTIDADE			NR_IDENTIDADE, 
		a.cd_tipo_acomodacao		CD_TIPO_ACOMODACAO, 
		a.DT_ENTRADA			DT_ENTRADA, 
		a.dt_alta			dt_alta, 
		a.CD_MOTIVO_ALTA			CD_MOTIVO_ALTA, 
		''					TP_GUIA, 
		''					CD_MEDICO_CONVENIO, 
		''					IE_FUNCAO_MEDICO, 
		''					QT_PORTE_ANESTESICO, 
		''					CD_GRUPO_GASTO, 
		''					DS_UNIDADE_MEDIDA, 
		0					QT_CH, 
		0					VL_UNITARIO_CH, 
		0					VL_UNITARIO, 
		0					VL_ITEM, 
		0					PR_FUNCAO_PARTIC, 
		''					IE_VIA_ACESSO, 
		0					PR_VIA_ACESSO, 
		0					PR_HORA_EXTRA, 
		''					IE_LOCAL_MEDICADO, 
		'' CD_BRASINDICE,'' CD_ITEM_CONVENIO,0 CD_PROCEDIMENTO_REF, 
		'' CD_PROC_REF_CONV, ''	CD_SENHA, 
		'                  ' ds_espaco, 
		'00000000000000000000000000000000000' ds_zeros, 
		'' cd_item_bras_proc, 
		CASE WHEN obter_atepacu_paciente(a.nr_atendimento,'IA')=0 THEN  			'00000000'  ELSE to_char(a.dt_alta,'ddmmyyyy') END  dt_alta_alfa, 
		CASE WHEN obter_atepacu_paciente(a.nr_atendimento,'IA')=0 THEN  			'000000'  ELSE to_char(a.dt_alta,'hh24miss') END  hr_alta_alfa 
from		w_interf_conta_cab a 

union all
 
SELECT   	a.NR_SEQ_PROTOCOLO,a.CD_CONVENIO CD_CONVENIO,3 TP_REGISTRO, 
      	'FATOU' IE_DISQUETE,3 CD_TIPO_REGISTRO,1 NR_LOTE,a.CD_INTERNO CD_PRESTADOR, 
      	'0', LOCALTIMESTAMP, LOCALTIMESTAMP, 
		0               NR_SEQ_CONTA, 
      	''              IE_TIPO_PRESTADOR, 
      	a.cd_cgc_hospital       CD_CGC, 
      	''              NM_PRESTADOR, 
      	LOCALTIMESTAMP         	DT_REMESSA, 
      	a.nr_remessa			NR_SEQ_REMESSA, 
      	0               NR_REG_REMESSA, 
      	''              NM_PACIENTE, 
      	''              IE_SEXO, 
      	LOCALTIMESTAMP         	DT_NASCIMENTO, 
      	''              CD_CLIENTE, 
      	a.nr_interno_conta		NR_CONTA, 
      	''              IE_TIPO_PACIENTE, 
      	0               CD_TIPO_ATENDIMENTO, 
      	''              CD_CLASSE_ATENDIMENTO, 
      	LOCALTIMESTAMP         	DT_ITEM, 
      	''              CD_CID, 
      	''              NR_CRM, 
      	''              SG_UF_CRM, 
      	''              NM_MEDICO_REQUISITANTE, 
      	''              CD_MEDICO_REQUISITANTE, 
      	LOCALTIMESTAMP            DT_REQUISICAO, 
      	a.cd_autorizacao       	NR_GUIA, 
      	a.DT_AUTORIZACAO  		DT_GUIA, 
		a.NM_RESPONSAVEL			NM_RESPONSAVEL_GUIA, 
		to_char(a.cd_procedimento_solic)	CD_PROCED_GUIA, 
		a.ds_proc_convenio_solic	DS_PROCED_GUIA, 
		a.qt_proc_solicitado		QT_PROCED_GUIA, 
		a.nr_seq_registro			NR_SEQPROC_GUIA,		 
      	0               NR_SEQ_ITEM, 
      	''              DS_ITEM, 
      	0               CD_ITEM, 
      	0               QT_ITEM, 
      	0               QT_GUS, 
		a.cd_cgc_convenio			CD_CGC_CONVENIO, 
		0					NR_PRONTUARIO, 
		''					CD_PLANO, 
		0					CD_DEPENDENTE, 
		LOCALTIMESTAMP				DT_VALIDADE_CARTEIRA, 
		''					NR_IDENTIDADE, 
		0					CD_TIPO_ACOMODACAO, 
		LOCALTIMESTAMP				DT_ENTRADA, 
		LOCALTIMESTAMP				DT_ALTA, 
		0					CD_MOTIVO_ALTA, 
		a.IE_TIPO_GUIA			TP_GUIA, 
		''					CD_MEDICO_CONVENIO, 
		''					IE_FUNCAO_MEDICO, 
		''					QT_PORTE_ANESTESICO, 
		''					CD_GRUPO_GASTO, 
		''					DS_UNIDADE_MEDIDA, 
		0					QT_CH, 
		0					VL_UNITARIO_CH, 
		0					VL_UNITARIO, 
		0					VL_ITEM, 
		0					PR_FUNCAO_PARTIC, 
		''					IE_VIA_ACESSO, 
		0					PR_VIA_ACESSO, 
		0					PR_HORA_EXTRA, 
		''					IE_LOCAL_MEDICADO, 
		''					CD_BRASINDICE, 
		''					CD_ITEM_CONVENIO, 
		0					CD_PROCEDIMENTO_REF, 
		'' 					CD_PROC_REF_CONV, 
		a.CD_SENHA				CD_SENHA, 
		'                  ' ds_espaco, 
		'00000000000000000000000000000000000' ds_zeros, 
		'' cd_item_bras_proc, 
		'' dt_alta_alfa, 
		'' hr_alta_alfa 
from		w_interf_conta_autor a 

union all
 
SELECT	a.NR_SEQ_PROTOCOLO,a.CD_CONVENIO CD_CONVENIO,4 TP_REGISTRO, 
      	'FATOU' IE_DISQUETE,4 CD_TIPO_REGISTRO,1 NR_LOTE,a.CD_INTERNO CD_PRESTADOR, 
		'0', LOCALTIMESTAMP, LOCALTIMESTAMP, 
      	0               NR_SEQ_CONTA, 
      	''              IE_TIPO_PRESTADOR, 
      	a.cd_cgc_hospital       CD_CGC, 
      	''              NM_PRESTADOR, 
      	LOCALTIMESTAMP         	DT_REMESSA, 
      	a.nr_remessa			NR_SEQ_REMESSA, 
      	0               NR_REG_REMESSA, 
      	''              NM_PACIENTE, 
      	''              IE_SEXO, 
      	LOCALTIMESTAMP         	DT_NASCIMENTO, 
      	''              CD_CLIENTE, 
      	a.nr_interno_conta      NR_CONTA, 
      	''              IE_TIPO_PACIENTE, 
      	0               CD_TIPO_ATENDIMENTO, 
      	''              CD_CLASSE_ATENDIMENTO, 
      	max(a.DT_ITEM)        	DT_ITEM, 
      	''              CD_CID, 
      	''              NR_CRM, 
      	''              SG_UF_CRM, 
      	''              NM_MEDICO_REQUISITANTE, 
      	''              CD_MEDICO_REQUISITANTE, 
      	LOCALTIMESTAMP            DT_REQUISICAO, 
      	''              NR_GUIA, 
      	LOCALTIMESTAMP         	DT_GUIA, 
		''					NM_RESPONSAVEL_GUIA, 
		''					CD_PROCED_GUIA, 
		''					DS_PROCED_GUIA, 
		0					QT_PROCED_GUIA,		 
		1					NR_SEQPROC_GUIA,		 
      	1               NR_SEQ_ITEM, 
      	a.ds_item				DS_ITEM, 
      	a.CD_ITEM      		CD_ITEM, 
      	sum(a.QT_ITEM)        QT_ITEM, 
      	0               QT_GUS, 
		a.cd_cgc_convenio			CD_CGC_CONVENIO, 
		0					NR_PRONTUARIO, 
		''					CD_PLANO, 
		0					CD_DEPENDENTE, 
		LOCALTIMESTAMP				DT_VALIDADE_CARTEIRA, 
		''					NR_IDENTIDADE, 
		0					CD_TIPO_ACOMODACAO, 
		LOCALTIMESTAMP				DT_ENTRADA, 
		LOCALTIMESTAMP				DT_ALTA, 
		0					CD_MOTIVO_ALTA, 
		''					TP_GUIA, 
		a.cd_medico_exec_conv		CD_MEDICO_CONVENIO, 
		to_char(a.cd_funcao_executor)	IE_FUNCAO_MEDICO, 
		to_char(a.nr_PORTE_ANESTESICO) QT_PORTE_ANESTESICO, 
		a.cd_grupo_gasto			CD_GRUPO_GASTO, 
		a.cd_UNIDADE_MEDIDA		DS_UNIDADE_MEDIDA, 
		sum(a.qt_ch_item)			QT_CH, 
		CASE WHEN sum(a.qt_ch_item)=0 THEN 0  ELSE sum(a.vl_total_item) / sum(a.qt_ch_item) END 	VL_UNITARIO_CH, 
		CASE WHEN sum(a.qt_item)=0 THEN 0  ELSE sum(a.vl_total_item) / sum(a.qt_item) END  VL_UNITARIO, 
		sum(a.VL_total_ITEM)		VL_ITEM, 
		(a.pr_funcao_participante/100)	PR_FUNCAO_PARTIC, 
		CASE WHEN obter_se_proc_cirurgico(a.cd_item, a.ie_origem_proced, 0)='S' THEN  a.ie_via_acesso  ELSE ' ' END  IE_VIA_ACESSO, 
		CASE WHEN a.pr_via_acesso IS NULL THEN  0  ELSE a.pr_via_acesso/100 END  PR_VIA_ACESSO, 
		CASE WHEN a.pr_hora_extra=1 THEN 0 WHEN a.pr_hora_extra=0 THEN 0  ELSE (a.pr_hora_extra * 100 - 100) END  PR_HORA_EXTRA, 
		CASE WHEN a.ie_tipo_item=1 THEN  ''  ELSE a.cd_classif_setor END  IE_LOCAL_MEDICADO, 
		a.cd_brasindice			CD_BRASINDICE, 
		a.cd_item_convenio		CD_ITEM_CONVENIO, 
		a.cd_procedimento_ref		CD_PROCEDIMENTO_REF, 
		CASE WHEN cd_medico_executor IS NULL THEN  a.CD_PROC_REF_CONV  ELSE ' ' END  cd_proc_ref_conv, 
		''					CD_SENHA, 
		'                  ' ds_espaco, 
		'00000000000000000000000000000000000' ds_zeros, 
		CASE WHEN ie_tipo_item=1 THEN  cd_item_convenio  ELSE coalesce(cd_brasindice, cd_item_convenio) END  cd_item_bras_proc, 
		'' dt_alta_alfa, 
		'' hr_alta_alfa 
from		w_interf_conta_item a 
where		coalesce(a.vl_total_item,0) <> 0 
group by	a.NR_SEQ_PROTOCOLO, 
		a.CD_CONVENIO, 
      	a.CD_INTERNO, 
      	a.cd_cgc_hospital, 
      	a.nr_remessa, 
      	a.nr_interno_conta, 
      	a.ds_item, 
      	a.CD_ITEM, 
		a.cd_cgc_convenio, 
		a.cd_medico_exec_conv, 
		to_char(a.cd_funcao_executor), 
		to_char(a.nr_PORTE_ANESTESICO), 
		a.cd_grupo_gasto, 
		a.cd_UNIDADE_MEDIDA, 
		a.pr_funcao_participante, 
		CASE WHEN a.cd_classif_setor=2 THEN  			CASE WHEN cd_medico_executor IS NULL THEN a.ie_via_acesso  ELSE ' ' END   ELSE ' ' END , 
		CASE WHEN a.pr_via_acesso IS NULL THEN  0  ELSE a.pr_via_acesso/100 END , 
		CASE WHEN a.pr_hora_extra=1 THEN 0 WHEN a.pr_hora_extra=0 THEN 0  ELSE (a.pr_hora_extra * 100 - 100) END , 
		CASE WHEN a.ie_tipo_item=1 THEN  ''  ELSE a.cd_classif_setor END , 
		a.cd_brasindice, 
		a.cd_item_convenio, 
		CASE WHEN obter_se_proc_cirurgico(a.cd_item, a.ie_origem_proced, 0)='S' THEN  a.ie_via_acesso  ELSE ' ' END , 
		a.cd_procedimento_ref, 
		CASE WHEN cd_medico_executor IS NULL THEN  a.CD_PROC_REF_CONV  ELSE ' ' END , 
		CASE WHEN ie_tipo_item=1 THEN  cd_item_convenio  ELSE coalesce(cd_brasindice, cd_item_convenio) END  

union all
 
SELECT   	a.NR_SEQ_PROTOCOLO,a.CD_CONVENIO CD_CONVENIO,5 TP_REGISTRO, 
      	'FATOU' IE_DISQUETE,5 CD_TIPO_REGISTRO,1 NR_LOTE,a.CD_INTERNO CD_PRESTADOR, 
		'0', LOCALTIMESTAMP, LOCALTIMESTAMP,   
	   	0               NR_SEQ_CONTA, 
      	''              IE_TIPO_PRESTADOR, 
      	a.cd_cgc_hospital       CD_CGC, 
      	''              NM_PRESTADOR, 
      	LOCALTIMESTAMP         	DT_REMESSA, 
      	a.nr_remessa			NR_SEQ_REMESSA, 
      	0               NR_REG_REMESSA, 
      	''              NM_PACIENTE, 
      	''              IE_SEXO, 
      	LOCALTIMESTAMP         	DT_NASCIMENTO, 
      	''              CD_CLIENTE, 
      	a.NR_INTERNO_CONTA	   NR_CONTA, 
      	''              IE_TIPO_PACIENTE, 
      	0               CD_TIPO_ATENDIMENTO, 
      	''              CD_CLASSE_ATENDIMENTO, 
      	LOCALTIMESTAMP         	DT_ITEM, 
      	''              CD_CID, 
      	''              NR_CRM, 
      	''              SG_UF_CRM, 
      	''              NM_MEDICO_REQUISITANTE, 
      	''              CD_MEDICO_REQUISITANTE, 
      	LOCALTIMESTAMP            DT_REQUISICAO, 
      	''              NR_GUIA, 
      	LOCALTIMESTAMP         	DT_GUIA, 
		''					NM_RESPONSAVEL_GUIA, 
		''					CD_PROCED_GUIA, 
		''					DS_PROCED_GUIA, 
		0					QT_PROCED_GUIA,		 
		0					NR_SEQPROC_GUIA,		 
      	0               NR_SEQ_ITEM, 
      	''              DS_ITEM, 
      	0               CD_ITEM, 
      	0               QT_ITEM, 
      	0               QT_GUS, 
		a.cd_cgc_convenio			CD_CGC_CONVENIO, 
		0					NR_PRONTUARIO, 
		''					CD_PLANO, 
		0					CD_DEPENDENTE, 
		LOCALTIMESTAMP				DT_VALIDADE_CARTEIRA, 
		''					NR_IDENTIDADE, 
		0					CD_TIPO_ACOMODACAO, 
		LOCALTIMESTAMP				DT_ENTRADA, 
		LOCALTIMESTAMP				DT_ALTA, 
		0					CD_MOTIVO_ALTA, 
		''					TP_GUIA, 
		''					CD_MEDICO_CONVENIO, 
		''					IE_FUNCAO_MEDICO, 
		''					QT_PORTE_ANESTESICO, 
		''					CD_GRUPO_GASTO, 
		''					DS_UNIDADE_MEDIDA, 
		0					QT_CH, 
		0					VL_UNITARIO_CH, 
		0					VL_UNITARIO, 
		a.vl_total_conta			VL_ITEM, 
		0					PR_FUNCAO_PARTIC, 
		''					IE_VIA_ACESSO, 
		0					PR_VIA_ACESSO, 
		0					PR_HORA_EXTRA, 
		''					IE_LOCAL_MEDICADO, 
		''					CD_BRASINDICE, 
		''					CD_ITEM_CONVENIO, 
		0					CD_PROCEDIMENTO_REF, 
		'' 					CD_PROC_REF_CONV, 
		''					CD_SENHA, 
		'                  ' ds_espaco, 
		'00000000000000000000000000000000000' ds_zeros, 
		'' cd_item_bras_proc, 
		'' dt_alta_alfa, 
		'' hr_alta_alfa 
from		w_interf_conta_total a 

union all
 
SELECT   	a.NR_SEQ_PROTOCOLO,a.CD_CONVENIO CD_CONVENIO,6 TP_REGISTRO, 
      	'FATOU' IE_DISQUETE,6 CD_TIPO_REGISTRO,1 NR_LOTE,a.CD_INTERNO CD_PRESTADOR, 
		'0', LOCALTIMESTAMP, LOCALTIMESTAMP, 
      	0               NR_SEQ_CONTA, 
      	''              IE_TIPO_PRESTADOR, 
      	a.cd_cgc_hospital       CD_CGC, 
      	''              NM_PRESTADOR, 
      	LOCALTIMESTAMP         	DT_REMESSA, 
      	a.nr_remessa    		NR_SEQ_REMESSA, 
      	0               NR_REG_REMESSA, 
      	''              NM_PACIENTE, 
      	''              IE_SEXO, 
      	LOCALTIMESTAMP         	DT_NASCIMENTO, 
      	''              CD_CLIENTE, 
      	99999999				NR_CONTA, 
      	''              IE_TIPO_PACIENTE, 
      	0               CD_TIPO_ATENDIMENTO, 
      	''              CD_CLASSE_ATENDIMENTO, 
      	LOCALTIMESTAMP         	DT_ITEM, 
      	''              CD_CID, 
      	''              NR_CRM, 
      	''              SG_UF_CRM, 
      	''              NM_MEDICO_REQUISITANTE, 
      	''              CD_MEDICO_REQUISITANTE, 
      	LOCALTIMESTAMP            DT_REQUISICAO, 
      	''              NR_GUIA, 
      	LOCALTIMESTAMP         	DT_GUIA, 
		''					NM_RESPONSAVEL_GUIA, 
		''					CD_PROCED_GUIA, 
		''					DS_PROCED_GUIA, 
		0					QT_PROCED_GUIA,		 
		0					NR_SEQPROC_GUIA,		 
      	0               NR_SEQ_ITEM, 
      	''              DS_ITEM, 
      	0               CD_ITEM, 
      	0               QT_ITEM, 
      	a.qt_total_conta 			QT_GUS, 
		a.cd_cgc_convenio			CD_CGC_CONVENIO, 
		0					NR_PRONTUARIO, 
		''					CD_PLANO, 
		0					CD_DEPENDENTE, 
		LOCALTIMESTAMP				DT_VALIDADE_CARTEIRA, 
		''					NR_IDENTIDADE, 
		0					CD_TIPO_ACOMODACAO, 
		LOCALTIMESTAMP				DT_ENTRADA, 
		LOCALTIMESTAMP				DT_ALTA, 
		0					CD_MOTIVO_ALTA, 
		''					TP_GUIA, 
		''					CD_MEDICO_CONVENIO, 
		''					IE_FUNCAO_MEDICO, '' QT_PORTE_ANESTESICO, 
		''					CD_GRUPO_GASTO, 
		''					DS_UNIDADE_MEDIDA, 
		0					QT_CH, 
		0					VL_UNITARIO_CH, 
		0					VL_UNITARIO, 
		a.vl_total_conta			VL_ITEM, 
		0					PR_FUNCAO_PARTIC, 
		''					IE_VIA_ACESSO, 
		0					PR_VIA_ACESSO, 
		0					PR_HORA_EXTRA, 
		''					IE_LOCAL_MEDICADO, 
		''					CD_BRASINDICE, 
		''					CD_ITEM_CONVENIO, 
		0					CD_PROCEDIMENTO_REF, 
		'' 					CD_PROC_REF_CONV,	 
		''					CD_SENHA, 
		'                  ' ds_espaco, 
		'00000000000000000000000000000000000' ds_zeros, 
		'' cd_item_bras_proc, 
		'' dt_alta_alfa, 
		'' hr_alta_alfa 
from		w_interf_conta_trailler a 

union all
 
SELECT   	a.NR_SEQ_PROTOCOLO,a.CD_CONVENIO CD_CONVENIO,9 TP_REGISTRO, 
      	'FATOU' IE_DISQUETE,9 CD_TIPO_REGISTRO,9999 NR_LOTE,a.CD_INTERNO CD_PRESTADOR, 
		'0', LOCALTIMESTAMP, LOCALTIMESTAMP, 
      	0               NR_SEQ_CONTA, 
      	''              IE_TIPO_PRESTADOR, 
      	a.cd_cgc_hospital       CD_CGC, 
      	''              NM_PRESTADOR, 
      	LOCALTIMESTAMP         	DT_REMESSA, 
      	a.nr_remessa    		NR_SEQ_REMESSA, 
      	0               NR_REG_REMESSA, 
      	''              NM_PACIENTE, 
      	''              IE_SEXO, 
      	LOCALTIMESTAMP         	DT_NASCIMENTO, 
      	''              CD_CLIENTE, 
      	99999999				NR_CONTA, 
      	''              IE_TIPO_PACIENTE, 
      	0               CD_TIPO_ATENDIMENTO, 
      	''              CD_CLASSE_ATENDIMENTO, 
      	LOCALTIMESTAMP         	DT_ITEM, 
      	''              CD_CID, 
      	''              NR_CRM, 
      	''              SG_UF_CRM, 
      	''              NM_MEDICO_REQUISITANTE, 
      	''              CD_MEDICO_REQUISITANTE, 
      	LOCALTIMESTAMP            DT_REQUISICAO, 
      	''              NR_GUIA, 
      	LOCALTIMESTAMP         	DT_GUIA, 
		''					NM_RESPONSAVEL_GUIA, 
		''					CD_PROCED_GUIA, 
		''					DS_PROCED_GUIA, 
		0					QT_PROCED_GUIA,		 
		0					NR_SEQPROC_GUIA,		 
      	0               NR_SEQ_ITEM, 
      	''              DS_ITEM, 
      	0               CD_ITEM, 
      	0               QT_ITEM, 
      	a.qt_total_conta 			QT_GUS, 
		a.cd_cgc_convenio			CD_CGC_CONVENIO, 
		0					NR_PRONTUARIO, 
		''					CD_PLANO, 
		0					CD_DEPENDENTE, 
		LOCALTIMESTAMP				DT_VALIDADE_CARTEIRA, 
		''					NR_IDENTIDADE, 
		0					CD_TIPO_ACOMODACAO, 
		LOCALTIMESTAMP				DT_ENTRADA, 
		LOCALTIMESTAMP				DT_ALTA, 
		0					CD_MOTIVO_ALTA, 
		''					TP_GUIA, 
		''					CD_MEDICO_CONVENIO, 
		''					IE_FUNCAO_MEDICO, 
		''					QT_PORTE_ANESTESICO, 
		''					CD_GRUPO_GASTO, 
		''					DS_UNIDADE_MEDIDA, 
		0					QT_CH, 
		0					VL_UNITARIO_CH, 
		0					VL_UNITARIO, 
		a.vl_total_conta			VL_ITEM, 
		0					PR_FUNCAO_PARTIC, 
		''					IE_VIA_ACESSO, 
		0					PR_VIA_ACESSO, 
		0					PR_HORA_EXTRA, 
		''					IE_LOCAL_MEDICADO, 
		''					CD_BRASINDICE, 
		''					CD_ITEM_CONVENIO, 
		0					CD_PROCEDIMENTO_REF, 
		'' 					CD_PROC_REF_CONV, 
		''					CD_SENHA, 
		'                  ' ds_espaco, 
		'00000000000000000000000000000000000' ds_zeros, 
		'' cd_item_bras_proc, 
		'' dt_alta_alfa, 
		'' hr_alta_alfa 
from		w_interf_conta_trailler a;

