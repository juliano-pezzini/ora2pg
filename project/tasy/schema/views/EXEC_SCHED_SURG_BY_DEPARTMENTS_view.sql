-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW exec_sched_surg_by_departments (nr_surgery, nm_patient, nr_attention, ds_surgery_room, nm_surgeon, dt_surgery_start, dt_sch_formatted_surgery, cd_departm_schd_surg, ds_departm_schd_surg, cd_departm_perf_surg, ds_departm_perf_surg) AS select a.nr_cirurgia nr_surgery,
       get_main_and_addit_data_surg('GPN', null, a.nr_atendimento) nm_patient,
       a.nr_atendimento nr_attention,
       obter_sala_cirurgia(a.nr_cirurgia) ds_surgery_room,
       obter_nome_pf(a.cd_medico_cirurgiao) nm_surgeon,
       a.dt_inicio_real dt_surgery_start,
       get_main_and_addit_data_surg('GFSSD', a.nr_cirurgia, null) dt_sch_formatted_surgery,
       get_main_and_addit_data_surg('CDSS', a.nr_cirurgia, null) cd_departm_schd_surg,
       get_main_and_addit_data_surg('DDSS', a.nr_cirurgia, null) ds_departm_schd_surg,
       get_main_and_addit_data_surg('CDPS', a.nr_cirurgia, null) cd_departm_perf_surg,
       get_main_and_addit_data_surg('DDPS', a.nr_cirurgia, null) ds_departm_perf_surg
FROM   cirurgia a;

