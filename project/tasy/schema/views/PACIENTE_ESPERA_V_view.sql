-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW paciente_espera_v (nr_sequencia, cd_pessoa_fisica, nr_prioridade, dt_inclusao, dt_atualizacao, nm_usuario, cd_convenio, cd_setor_atendimento, cd_unidade_basica, cd_unidade_compl, ie_clinica, cd_medico, ie_situacao, cd_procedimento, ie_origem_proced, dt_prevista_internacao, cd_tipo_acomodacao, ds_observacao, nr_atendimento, cd_cid_doenca, cd_especialidade_medica, nr_motivo_cancel, nr_seq_proc_interno, qt_tempo_incapacidade, nr_seq_agenda, ds_tempo_incapacidade, nr_seq_atend_futuro, nr_seq_tipo_deficiencia, ie_pendente, nr_seq_motivo_pend_fila, dt_apto, ie_protocolo_gerenciado, cd_procedencia, dt_inicio_preparo, dt_coleta, dt_retorno, cd_estabelecimento, nr_ddi, nm_paciente, dt_nascimento, nr_telefone_celular, ds_convenio, ds_setor_atendimento, nm_medico, ds_clinica, ds_procedimento, ds_tipo_acomodacao) AS select  a.NR_SEQUENCIA,a.CD_PESSOA_FISICA,a.NR_PRIORIDADE,a.DT_INCLUSAO,a.DT_ATUALIZACAO,a.NM_USUARIO,a.CD_CONVENIO,a.CD_SETOR_ATENDIMENTO,a.CD_UNIDADE_BASICA,a.CD_UNIDADE_COMPL,a.IE_CLINICA,a.CD_MEDICO,a.IE_SITUACAO,a.CD_PROCEDIMENTO,a.IE_ORIGEM_PROCED,a.DT_PREVISTA_INTERNACAO,a.CD_TIPO_ACOMODACAO,a.DS_OBSERVACAO,a.NR_ATENDIMENTO,a.CD_CID_DOENCA,a.CD_ESPECIALIDADE_MEDICA,a.NR_MOTIVO_CANCEL,a.NR_SEQ_PROC_INTERNO,a.QT_TEMPO_INCAPACIDADE,a.NR_SEQ_AGENDA,a.DS_TEMPO_INCAPACIDADE,a.NR_SEQ_ATEND_FUTURO,a.NR_SEQ_TIPO_DEFICIENCIA,a.IE_PENDENTE,a.NR_SEQ_MOTIVO_PEND_FILA,a.DT_APTO,a.IE_PROTOCOLO_GERENCIADO,a.CD_PROCEDENCIA,a.DT_INICIO_PREPARO,a.DT_COLETA,a.DT_RETORNO,a.CD_ESTABELECIMENTO,a.NR_DDI,
	  b.nm_pessoa_fisica nm_paciente, 
     b.dt_nascimento, 
     b.nr_telefone_celular, 
     c.ds_convenio, 
     d.ds_setor_atendimento, 
     obter_nome_medico(a.cd_medico,'N') nm_medico, 
     obter_valor_dominio(17 ,a.ie_clinica) ds_clinica, 
	  e.ds_procedimento, 
	  t.ds_tipo_acomodacao 
FROM pessoa_fisica b, paciente_espera a
LEFT OUTER JOIN convenio c ON (a.cd_convenio = c.cd_convenio)
LEFT OUTER JOIN setor_atendimento d ON (a.cd_setor_atendimento = d.cd_setor_atendimento)
LEFT OUTER JOIN procedimento e ON (a.cd_procedimento = e.cd_procedimento AND a.ie_origem_proced = e.ie_origem_proced)
LEFT OUTER JOIN tipo_acomodacao t ON (a.cd_tipo_acomodacao = t.cd_tipo_acomodacao)
WHERE a.cd_pessoa_fisica      = b.cd_pessoa_fisica;

