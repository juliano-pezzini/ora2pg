-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW display_conditions_v (dt_atualizacao, tipo, ds_tipo, cd_tipo, cd_cargo, ds_cargo, cd_setor, ds_setor, cd_convenio, ds_convenio, dt_cancelado, nr_atendimento, cd_pessoa_fisica, nm_usuario) AS select  dt_atualizacao,
    'MED_AVALIACAO_PACIENTE' tipo,
    obter_desc_expressao(284113) ds_tipo,
    7 cd_tipo,
    obter_cargo_usuario(nm_usuario, 'C') cd_cargo, 
    obter_cargo_usuario(nm_usuario, 'D') ds_cargo, 
    obter_setor_atendimento(nr_atendimento) cd_setor,
    obter_ds_descricao_setor(obter_setor_atendimento(nr_atendimento)) ds_setor,
    obter_convenio_atendimento(nr_atendimento) cd_convenio, 
    Obter_desc_convenio(obter_convenio_atendimento(nr_atendimento)) ds_convenio, 
    DT_INATIVACAO dt_cancelado,
    nr_atendimento, 
    CD_PESSOA_FISICA,
    NM_USUARIO
FROM    med_avaliacao_paciente

union
 
select dt_atualizacao,
    'ANAMNESE_PACIENTE' tipo,
    obter_desc_expressao(893500) ds_tipo, 
    83 cd_tipo,
    obter_cargo_usuario(nm_usuario, 'C') cd_cargo, 
    obter_cargo_usuario(nm_usuario, 'D') ds_cargo, 
    obter_setor_atendimento(nr_atendimento) cd_setor,
    obter_ds_descricao_setor(obter_setor_atendimento(nr_atendimento)) ds_setor,
    obter_convenio_atendimento(nr_atendimento) cd_convenio, 
    Obter_desc_convenio(obter_convenio_atendimento(nr_atendimento)) ds_convenio, 
    DT_INATIVACAO dt_cancelado,
    nr_atendimento, 
    CD_PESSOA_FISICA,
    NM_USUARIO    
    from anamnese_paciente

union
 
SELECT dt_atualizacao,
    'SAN_TRANSFUSAO' tipo,
    obter_desc_expressao(310507) ds_tipo, 
    133 cd_tipo,
    obter_cargo_usuario(nm_usuario, 'C') cd_cargo, 
    obter_cargo_usuario(nm_usuario, 'D') ds_cargo, 
    obter_setor_atendimento(nr_atendimento) cd_setor,
    obter_ds_descricao_setor(obter_setor_atendimento(nr_atendimento)) ds_setor,
    obter_convenio_atendimento(nr_atendimento) cd_convenio, 
    Obter_desc_convenio(obter_convenio_atendimento(nr_atendimento)) ds_convenio, 
    DT_CANCELAMENTO dt_cancelado,
    nr_atendimento, 
    CD_PESSOA_FISICA,
    NM_USUARIO 
FROM    SAN_TRANSFUSAO

union

SELECT dt_atualizacao,
    'EVOLUCAO_PACIENTE' tipo,
    obter_desc_expressao(792013) ds_tipo, 
    5 cd_tipo,
    obter_cargo_usuario(nm_usuario, 'C') cd_cargo, 
    obter_cargo_usuario(nm_usuario, 'D') ds_cargo, 
    obter_setor_atendimento(nr_atendimento) cd_setor,
    obter_ds_descricao_setor(obter_setor_atendimento(nr_atendimento)) ds_setor,
    obter_convenio_atendimento(nr_atendimento) cd_convenio, 
    Obter_desc_convenio(obter_convenio_atendimento(nr_atendimento)) ds_convenio, 
    DT_INATIVACAO dt_cancelado,
    nr_atendimento, 
    CD_PESSOA_FISICA,
    NM_USUARIO 
FROM    EVOLUCAO_PACIENTE

union
 
SELECT dt_atualizacao,
    'PEP_PAC_CI' tipo,
    obter_desc_expressao(285718) ds_tipo, 
    398 cd_tipo,
    obter_cargo_usuario(nm_usuario, 'C') cd_cargo, 
    obter_cargo_usuario(nm_usuario, 'D') ds_cargo, 
    obter_setor_atendimento(nr_atendimento) cd_setor,
    obter_ds_descricao_setor(obter_setor_atendimento(nr_atendimento)) ds_setor,
    obter_convenio_atendimento(nr_atendimento) cd_convenio, 
    Obter_desc_convenio(obter_convenio_atendimento(nr_atendimento)) ds_convenio, 
    DT_INATIVACAO dt_cancelado,
    nr_atendimento, 
    CD_PESSOA_FISICA,
    NM_USUARIO 
FROM    PEP_PAC_CI

union

SELECT dt_atualizacao,
    'QUA_EVENTO_PACIENTE' tipo,
    obter_desc_expressao(285718) ds_tipo, 
    273 cd_tipo,
    obter_cargo_usuario(nm_usuario, 'C') cd_cargo, 
    obter_cargo_usuario(nm_usuario, 'D') ds_cargo, 
    obter_setor_atendimento(nr_atendimento) cd_setor,
    obter_ds_descricao_setor(obter_setor_atendimento(nr_atendimento)) ds_setor,
    obter_convenio_atendimento(nr_atendimento) cd_convenio, 
    Obter_desc_convenio(obter_convenio_atendimento(nr_atendimento)) ds_convenio, 
    DT_INATIVACAO dt_cancelado,
    nr_atendimento, 
    CD_PESSOA_FISICA,
    NM_USUARIO 
FROM    QUA_EVENTO_PACIENTE

union

SELECT dt_atualizacao,
    'PEDIDO_EXAME_EXTERNO' tipo,
    obter_desc_expressao(754654) ds_tipo, 
    395 cd_tipo,
    obter_cargo_usuario(nm_usuario, 'C') cd_cargo, 
    obter_cargo_usuario(nm_usuario, 'D') ds_cargo, 
    obter_setor_atendimento(nr_atendimento) cd_setor,
    obter_ds_descricao_setor(obter_setor_atendimento(nr_atendimento)) ds_setor,
    obter_convenio_atendimento(nr_atendimento) cd_convenio, 
    Obter_desc_convenio(obter_convenio_atendimento(nr_atendimento)) ds_convenio, 
    DT_INATIVACAO dt_cancelado,
    nr_atendimento, 
    CD_PESSOA_FISICA,
    NM_USUARIO 
FROM    PEDIDO_EXAME_EXTERNO

union

SELECT dt_atualizacao,
    'SOLIC_TRANSF_EXTERNA' tipo,
    obter_desc_expressao(314618) ds_tipo, 
    1014 cd_tipo,
    obter_cargo_usuario(nm_usuario, 'C') cd_cargo, 
    obter_cargo_usuario(nm_usuario, 'D') ds_cargo, 
    obter_setor_atendimento(nr_atendimento) cd_setor,
    obter_ds_descricao_setor(obter_setor_atendimento(nr_atendimento)) ds_setor,
    obter_convenio_atendimento(nr_atendimento) cd_convenio, 
    Obter_desc_convenio(obter_convenio_atendimento(nr_atendimento)) ds_convenio, 
    null dt_cancelado,
    nr_atendimento, 
    OBTER_PESSOA_ATENDIMENTO(nr_atendimento, 'C') CD_PESSOA_FISICA,
    NM_USUARIO 
FROM    SOLIC_TRANSF_EXTERNA

union
 
SELECT dt_atualizacao,
    'PARECER_MEDICO_REQ' tipo,
    obter_desc_expressao(295288) ds_tipo, 
    51 cd_tipo,
    obter_cargo_usuario(nm_usuario, 'C') cd_cargo, 
    obter_cargo_usuario(nm_usuario, 'D') ds_cargo, 
    obter_setor_atendimento(nr_atendimento) cd_setor,
    obter_ds_descricao_setor(obter_setor_atendimento(nr_atendimento)) ds_setor,
    obter_convenio_atendimento(nr_atendimento) cd_convenio, 
    Obter_desc_convenio(obter_convenio_atendimento(nr_atendimento)) ds_convenio, 
    DT_INATIVACAO dt_cancelado,
    nr_atendimento, 
    CD_PESSOA_FISICA,
    NM_USUARIO 
FROM    PARECER_MEDICO_REQ

union
 
SELECT dt_atualizacao,
    'AVAL_NUTRICAO' tipo,
    obter_desc_expressao(738760) ds_tipo, 
    1496 cd_tipo,
    obter_cargo_usuario(nm_usuario, 'C') cd_cargo, 
    obter_cargo_usuario(nm_usuario, 'D') ds_cargo, 
    obter_setor_atendimento(nr_atendimento) cd_setor,
    obter_ds_descricao_setor(obter_setor_atendimento(nr_atendimento)) ds_setor,
    obter_convenio_atendimento(nr_atendimento) cd_convenio, 
    Obter_desc_convenio(obter_convenio_atendimento(nr_atendimento)) ds_convenio, 
    DT_INATIVACAO dt_cancelado,
    nr_atendimento, 
    CD_PESSOA_FISICA,
    NM_USUARIO 
FROM    AVAL_NUTRICAO

union
 
SELECT dt_atualizacao,
    'ATEND_ENCAMINHAMENTO' tipo,
    obter_desc_expressao(317061) ds_tipo, 
    1511 cd_tipo,
    obter_cargo_usuario(nm_usuario, 'C') cd_cargo, 
    obter_cargo_usuario(nm_usuario, 'D') ds_cargo, 
    obter_setor_atendimento(nr_atendimento) cd_setor,
    obter_ds_descricao_setor(obter_setor_atendimento(nr_atendimento)) ds_setor,
    obter_convenio_atendimento(nr_atendimento) cd_convenio, 
    Obter_desc_convenio(obter_convenio_atendimento(nr_atendimento)) ds_convenio, 
    DT_INATIVACAO dt_cancelado,
    nr_atendimento, 
    CD_PESSOA_FISICA,
    NM_USUARIO 
FROM    ATEND_ENCAMINHAMENTO

union

SELECT dt_atualizacao,
    'NASCIMENTO' tipo,
    obter_desc_expressao(293972) ds_tipo, 
    364 cd_tipo,
    obter_cargo_usuario(nm_usuario, 'C') cd_cargo, 
    obter_cargo_usuario(nm_usuario, 'D') ds_cargo, 
    obter_setor_atendimento(nr_atendimento) cd_setor,
    obter_ds_descricao_setor(obter_setor_atendimento(nr_atendimento)) ds_setor,
    obter_convenio_atendimento(nr_atendimento) cd_convenio, 
    Obter_desc_convenio(obter_convenio_atendimento(nr_atendimento)) ds_convenio, 
    DT_INATIVACAO dt_cancelado,
    nr_atendimento, 
    CD_PESSOA_FISICA,
    NM_USUARIO 
FROM    NASCIMENTO

union
 
SELECT dt_atualizacao,
    'DIAGNOSTICO_DOENCA' tipo,
    obter_desc_expressao(303710) ds_tipo, 
    1 cd_tipo,
    obter_cargo_usuario(nm_usuario, 'C') cd_cargo, 
    obter_cargo_usuario(nm_usuario, 'D') ds_cargo, 
    obter_setor_atendimento(nr_atendimento) cd_setor,
    obter_ds_descricao_setor(obter_setor_atendimento(nr_atendimento)) ds_setor,
    obter_convenio_atendimento(nr_atendimento) cd_convenio, 
    Obter_desc_convenio(obter_convenio_atendimento(nr_atendimento)) ds_convenio, 
    DT_INATIVACAO dt_cancelado,
    nr_atendimento, 
    OBTER_PESSOA_ATENDIMENTO(nr_atendimento, 'C') CD_PESSOA_FISICA,
    NM_USUARIO 
FROM    DIAGNOSTICO_DOENCA;

