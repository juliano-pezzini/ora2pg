-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW titulo_receber_liq_contab_v (nr_lote_contabil, nr_titulo, vl_transacao, nr_seq_trans_fin, dt_recebimento, nr_seq_conta_banco, ds_atributo, cd_centro_custo, nr_seq_caixa_rec, nr_seq_movto_trans_fin, nr_seq_trans_caixa, nr_documento, nr_seq_baixa, cd_tipo_recebimento, cd_moeda) AS select	a.nr_lote_contabil,
	a.nr_titulo,
	CASE WHEN a.ie_acao='I' THEN  a.vl_recebido  ELSE a.vl_recebido * -1 END  vl_transacao,
	a.nr_seq_trans_fin,
	a.dt_recebimento,
	a.nr_seq_conta_banco,
	'VL_RECEBIDO' ds_atributo,
	0 cd_centro_custo,
	a.nr_seq_caixa_rec,
	a.nr_seq_movto_trans_fin,
	a.nr_seq_trans_caixa,
	a.nr_documento,
	a.nr_sequencia nr_seq_baixa,
	a.cd_tipo_recebimento,
	a.cd_moeda
FROM 	titulo_receber_liq a
where 	a.vl_recebido <> 0
and	coalesce(ie_lib_caixa, 'S') = 'S'

union all

select	a.nr_lote_contabil,
	a.nr_titulo,
	CASE WHEN a.ie_acao='I' THEN  a.vl_descontos  ELSE a.vl_descontos * -1 END   vl_transacao,
	a.nr_seq_trans_fin,
	a.dt_recebimento,
	a.nr_seq_conta_banco,
	'VL_DESCONTOS' ds_atributo,
	0 cd_centro_custo,
	a.nr_seq_caixa_rec,
	a.nr_seq_movto_trans_fin,
	a.nr_seq_trans_caixa,
	a.nr_documento,
	a.nr_sequencia nr_seq_baixa,
	a.cd_tipo_recebimento,
	a.cd_moeda
from 	titulo_receber_liq a
where 	a.vl_descontos <> 0
and	coalesce(ie_lib_caixa, 'S') = 'S'

union all

select	a.nr_lote_contabil,
	a.nr_titulo,
	CASE WHEN a.ie_acao='I' THEN  a.vl_juros  ELSE a.vl_juros * -1 END   vl_transacao,
	a.nr_seq_trans_fin,
	a.dt_recebimento,
	a.nr_seq_conta_banco,
	'VL_JUROS',
	0 cd_centro_custo,
	a.nr_seq_caixa_rec,
	a.nr_seq_movto_trans_fin,
	a.nr_seq_trans_caixa,
	a.nr_documento,
	a.nr_sequencia nr_seq_baixa,
	a.cd_tipo_recebimento,
	a.cd_moeda
from 	titulo_receber_liq a
where 	a.vl_juros <> 0
and	a.nr_seq_trans_fin	is not null
and	coalesce(ie_lib_caixa, 'S') = 'S'

union all

select	a.nr_lote_contabil,
	a.nr_titulo,
	CASE WHEN a.ie_acao='I' THEN  a.vl_multa  ELSE a.vl_multa * -1 END   vl_transacao,
	a.nr_seq_trans_fin,
	a.dt_recebimento,
	a.nr_seq_conta_banco,
	'VL_MULTA' ds_atributo,
	0 cd_centro_custo,
	a.nr_seq_caixa_rec,
	a.nr_seq_movto_trans_fin,
	a.nr_seq_trans_caixa,
	a.nr_documento,
	a.nr_sequencia nr_seq_baixa,
	a.cd_tipo_recebimento,
	a.cd_moeda
from 	titulo_receber_liq a
where 	a.vl_multa <> 0
and	coalesce(ie_lib_caixa, 'S')	= 'S'

union all

select	a.nr_lote_contabil,
	a.nr_titulo,
	CASE WHEN a.ie_acao='I' THEN  a.vl_despesa_bancaria  ELSE a.vl_despesa_bancaria * -1 END   vl_transacao,
	a.nr_seq_trans_fin,
	a.dt_recebimento,
	a.nr_seq_conta_banco,
	'VL_DESPESA_BANCARIA' ds_atributo,
	0 cd_centro_custo,
	a.nr_seq_caixa_rec,
	a.nr_seq_movto_trans_fin,
	a.nr_seq_trans_caixa,
	a.nr_documento,
	a.nr_sequencia nr_seq_baixa,
	a.cd_tipo_recebimento,
	a.cd_moeda
from 	titulo_receber_liq a
where 	a.vl_despesa_bancaria	<> 0
and	coalesce(ie_lib_caixa, 'S') = 'S'

union all

select	a.nr_lote_contabil,
	a.nr_titulo,
	CASE WHEN a.ie_acao='I' THEN  a.vl_glosa  ELSE a.vl_glosa * -1 END   vl_transacao,
	a.nr_seq_trans_fin,
	a.dt_recebimento,
	a.nr_seq_conta_banco,
	'VL_GLOSA' ds_atributo,
	0 cd_centro_custo,
	a.nr_seq_caixa_rec,
	a.nr_seq_movto_trans_fin,
	a.nr_seq_trans_caixa,
	a.nr_documento,
	a.nr_sequencia nr_seq_baixa,
	a.cd_tipo_recebimento,
	a.cd_moeda
from 	titulo_receber_liq a
where 	a.vl_glosa <> 0
and	coalesce(ie_lib_caixa, 'S') = 'S'

union	all

select	a.nr_lote_contabil,
	a.nr_titulo,
	CASE WHEN a.ie_acao='I' THEN  a.vl_rec_maior  ELSE a.vl_rec_maior * -1 END  vl_transacao,
	a.nr_seq_trans_fin,
	a.dt_recebimento,
	a.nr_seq_conta_banco,
	'VL_REC_MAIOR' ds_atributo,
	0 cd_centro_custo,
	a.nr_seq_caixa_rec,
	a.nr_seq_movto_trans_fin,
	a.nr_seq_trans_caixa,
	a.nr_documento,
	a.nr_sequencia nr_seq_baixa,
	a.cd_tipo_recebimento,
	a.cd_moeda
from 	titulo_receber_liq a
where 	a.vl_rec_maior		<> 0
and	coalesce(ie_lib_caixa, 'S') = 'S'

union all

select	a.nr_lote_contabil,
	a.nr_titulo,
	CASE WHEN a.ie_acao='I' THEN  a.vl_recebido  ELSE a.vl_recebido * -1 END  vl_transacao,
	a.nr_seq_trans_fin,
	a.dt_recebimento,
	a.nr_seq_conta_banco,
	'VL_RECEBIDO_TESOURARIA' ds_atributo,
	0 cd_centro_custo,
	a.nr_seq_caixa_rec,
	a.nr_seq_movto_trans_fin,
	a.nr_seq_trans_caixa,
	a.nr_documento,
	a.nr_sequencia nr_seq_baixa,
	a.cd_tipo_recebimento,
	a.cd_moeda
from 	titulo_receber_liq a
where 	a.vl_recebido <> 0
and	coalesce(ie_lib_caixa, 'S') = 'S'

union all

select	a.nr_lote_contabil,
	a.nr_titulo,
	CASE WHEN a.ie_acao='I' THEN  a.vl_recebido  ELSE a.vl_recebido * -1 END  vl_transacao,
	a.nr_seq_trans_fin,
	a.dt_recebimento,
	a.nr_seq_conta_banco,
	'VL_RECEBIDO_CB' ds_atributo,
	0 cd_centro_custo,
	a.nr_seq_caixa_rec,
	a.nr_seq_movto_trans_fin,
	a.nr_seq_trans_caixa,
	a.nr_documento,
	a.nr_sequencia nr_seq_baixa,
	a.cd_tipo_recebimento,
	a.cd_moeda
from 	titulo_receber_liq a
where 	a.vl_recebido <> 0
and	coalesce(ie_lib_caixa, 'S') = 'S'

union all

select	a.nr_lote_contabil,
	a.nr_titulo,
	a.vl_recebido + a.vl_juros + a.vl_multa + a.vl_descontos vl_transacao,
	a.nr_seq_trans_fin,
	a.dt_recebimento,
	a.nr_seq_conta_banco,
	'VL_ORIGINAL_BAIXA' ds_atributo,
	0 cd_centro_custo,
	a.nr_seq_caixa_rec,
	a.nr_seq_movto_trans_fin,
	a.nr_seq_trans_caixa,
	a.nr_documento,
	a.nr_sequencia nr_seq_baixa,
	a.cd_tipo_recebimento,
	a.cd_moeda
from 	titulo_receber_liq a
where 	a.vl_recebido <> 0
and	coalesce(ie_lib_caixa, 'S') = 'S'

union all

select	nr_lote_contabil,
	nr_titulo,
	vl_transacao,
	nr_seq_trans_fin,
	dt_recebimento,
	nr_seq_conta_banco,
	ds_atributo,
	cd_centro_custo,
	nr_seq_caixa_rec,
	nr_seq_movto_trans_fin,
	nr_seq_trans_caixa,
	nr_documento,
	nr_seq_baixa,
	cd_tipo_recebimento,
	cd_moeda
from	titulo_receber_liq_ctb_camb_v;

