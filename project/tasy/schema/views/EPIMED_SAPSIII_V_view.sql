-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW epimed_sapsiii_v (visit_id, unitadmissiondatetime, updatetimestamp, saps3_id, saps3_value, saps3_code, saps3_campo) AS SELECT  to_char(a.VISIT_ID) VISIT_ID,
        (EPIMED_obter_data_entrada(a.VISIT_ID)) unitadmissiondatetime,
        (UPDATETIMESTAMP),
		to_char(SAPS3_ID) SAPS3_ID,		
        to_char(1) SAPS3_VALUE,
        to_char(SAPS3_CODE) SAPS3_CODE,
		SAPS3_CAMPO
FROM  	(select  a.NR_ATENDIMENTO VISIT_ID, a.NR_SEQUENCIA  SAPS3_ID, to_char(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') UPDATETIMESTAMP, IE_CARDIOLOGICA SAPS3_CODE, 'IE_CARDIOLOGICA' SAPS3_CAMPO from	ESCALA_SAPS3 a where a.nr_sequencia = (select max(nr_sequencia) from ESCALA_SAPS3 b where a.nr_atendimento = b.Nr_atendimento)) a
where 	SAPS3_CODE <> '0'

union all

SELECT  to_char(a.VISIT_ID) VISIT_ID,
        (EPIMED_obter_data_entrada(a.VISIT_ID)) unitadmissiondatetime,
        (UPDATETIMESTAMP),
		to_char(SAPS3_ID) SAPS3_ID,		
        to_char(1) SAPS3_VALUE,
        to_char(SAPS3_CODE) SAPS3_CODE,
		SAPS3_CAMPO
FROM  (select  a.NR_ATENDIMENTO VISIT_ID, a.NR_SEQUENCIA  SAPS3_ID, to_char(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') UPDATETIMESTAMP, IE_HEPATICO SAPS3_CODE, 'IE_HEPATICO' SAPS3_CAMPO from	ESCALA_SAPS3 a where a.nr_sequencia = (select max(nr_sequencia) from ESCALA_SAPS3 b where a.nr_atendimento = b.Nr_atendimento)) a

union all

SELECT  to_char(a.VISIT_ID) VISIT_ID,
        (EPIMED_obter_data_entrada(a.VISIT_ID)) unitadmissiondatetime,
        (UPDATETIMESTAMP),
		to_char(SAPS3_ID) SAPS3_ID,		
        to_char(1) SAPS3_VALUE,
        to_char(SAPS3_CODE) SAPS3_CODE,
		SAPS3_CAMPO
FROM  (select  a.NR_ATENDIMENTO VISIT_ID, a.NR_SEQUENCIA  SAPS3_ID, to_char(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') UPDATETIMESTAMP, IE_ABDOMEM SAPS3_CODE, 'IE_ABDOMEM' SAPS3_CAMPO from	ESCALA_SAPS3 a where a.nr_sequencia = (select max(nr_sequencia) from ESCALA_SAPS3 b where a.nr_atendimento = b.Nr_atendimento)) a
where 	SAPS3_CODE <> '0'

union all

SELECT  to_char(a.VISIT_ID) VISIT_ID,
        (EPIMED_obter_data_entrada(a.VISIT_ID)) unitadmissiondatetime,
        (UPDATETIMESTAMP),
		to_char(SAPS3_ID) SAPS3_ID,		
        to_char(1) SAPS3_VALUE,
        to_char(SAPS3_CODE) SAPS3_CODE,
		SAPS3_CAMPO
FROM  (select  a.NR_ATENDIMENTO VISIT_ID, a.NR_SEQUENCIA SAPS3_ID, to_char(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') UPDATETIMESTAMP, IE_NEUROLOGICA SAPS3_CODE, 'IE_NEUROLOGICA' SAPS3_CAMPO from	ESCALA_SAPS3 a where a.nr_sequencia = (select max(nr_sequencia) from ESCALA_SAPS3 b where a.nr_atendimento = b.Nr_atendimento)) a
where 	SAPS3_CODE <> '0'

union all

SELECT  to_char(a.VISIT_ID) VISIT_ID,
        (EPIMED_obter_data_entrada(a.VISIT_ID)) unitadmissiondatetime,
        (UPDATETIMESTAMP),
		to_char(SAPS3_ID) SAPS3_ID,		
        to_char(1) SAPS3_VALUE,
        to_char(SAPS3_CODE) SAPS3_CODE,
		SAPS3_CAMPO
FROM  (select  a.NR_ATENDIMENTO VISIT_ID, a.NR_SEQUENCIA  SAPS3_ID, to_char(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') UPDATETIMESTAMP, IE_TIPO_OPERACAO SAPS3_CODE, 'IE_TIPO_OPERACAO' SAPS3_CAMPO from	ESCALA_SAPS3 a where a.nr_sequencia = (select max(nr_sequencia) from ESCALA_SAPS3 b where a.nr_atendimento = b.Nr_atendimento)) a
where 	SAPS3_CODE <> '0'

union all

SELECT  to_char(a.VISIT_ID) VISIT_ID,
        (EPIMED_obter_data_entrada(a.VISIT_ID)) unitadmissiondatetime,
        (UPDATETIMESTAMP),
		to_char(SAPS3_ID) SAPS3_ID,		
        to_char(1) SAPS3_VALUE,
        to_char(SAPS3_CODE) SAPS3_CODE,
		SAPS3_CAMPO
FROM  (select  a.NR_ATENDIMENTO VISIT_ID, a.NR_SEQUENCIA  SAPS3_ID, to_char(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') UPDATETIMESTAMP, IE_INFEC_NOSOCOMIAL SAPS3_CODE, 'IE_INFEC_NOSOCOMIAL' SAPS3_CAMPO from	ESCALA_SAPS3 a where a.nr_sequencia = (select max(nr_sequencia) from ESCALA_SAPS3 b where a.nr_atendimento = b.Nr_atendimento)) a
where 	SAPS3_CODE <> '0'

union all

SELECT  to_char(a.VISIT_ID) VISIT_ID,
        (EPIMED_obter_data_entrada(a.VISIT_ID)) unitadmissiondatetime,
        (UPDATETIMESTAMP),
		to_char(SAPS3_ID) SAPS3_ID,		
        to_char(1) SAPS3_VALUE,
        to_char(SAPS3_CODE) SAPS3_CODE,
		SAPS3_CAMPO
FROM  (select  a.NR_ATENDIMENTO VISIT_ID, a.NR_SEQUENCIA  SAPS3_ID, to_char(a.dt_atualizacao, 'YYYY-MM-DD"T"HH24:MI:SS."000"') UPDATETIMESTAMP, IE_INFEC_RESP SAPS3_CODE, 'IE_INFEC_RESP' SAPS3_CAMPO from	ESCALA_SAPS3 a where a.nr_sequencia = (select max(nr_sequencia) from ESCALA_SAPS3 b where a.nr_atendimento = b.Nr_atendimento)) a
where 	SAPS3_CODE <> '0';

