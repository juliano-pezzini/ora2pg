-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_implantes_v (dt_ano, ds_nome_beneficiario, ds_nome_prestador, ds_cidade, ds_medico_executor, ds_especialidade_medico, ds_fornecedor, vl_cobrado, vl_liberado, dt_mes_competencia, ie_tipo_despesa) AS select	to_char(a.dt_mes_competencia,'YYYY') dt_ano,
	substr(pls_obter_dados_segurado(b.nr_seq_segurado,'N'),1,255) ds_nome_beneficiario, 
	substr(pls_obter_dados_prestador(a.nr_seq_prestador,'N'),1,255) ds_nome_prestador, 
	substr(pls_obter_dados_prestador(a.nr_seq_prestador,'MA'),1,255) ds_cidade, 
	substr(obter_nome_pf_pj(b.cd_medico_executor,null),1,255) ds_medico_executor, 
	substr(pls_obter_espec_cbos(b.nr_sequencia),1,255) ds_especialidade_medico, 
	substr(pls_obter_dados_prestador(c.nr_seq_prest_fornec,'N'),1,255) ds_fornecedor, 
	c.vl_material_imp vl_cobrado, 
	c.vl_liberado vl_liberado, 
	a.dt_mes_competencia, 
	c.ie_tipo_despesa 
FROM	pls_conta_mat c, 
	pls_conta b, 
	pls_protocolo_conta a 
where	a.nr_sequencia	= b.nr_seq_protocolo 
and	c.nr_seq_conta	= b.nr_sequencia;

