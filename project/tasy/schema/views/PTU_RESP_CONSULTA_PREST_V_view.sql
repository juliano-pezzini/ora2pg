-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_resp_consulta_prest_v (ie_tipo_registro, cd_transacao, nr_sequencia, nr_seq_requisicao, nr_seq_guia, ie_tipo_cliente, cd_unimed_executora, nr_seq_execucao, cd_unimed_beneficiario, ie_confirmacao, cd_mens_erro, nr_seq_origem, cd_unimed_prestador, ie_alto_custo, nm_prestador, cd_prestador, cd_especialidade, ds_fim) AS select	1				ie_tipo_registro,
	00319				cd_transacao,
	nr_sequencia			nr_sequencia,
	nr_seq_requisicao		nr_seq_requisicao,
	nr_seq_guia			nr_seq_guia,
	CASE WHEN ie_tipo_cliente='U' THEN 'UNIMED' WHEN ie_tipo_cliente='P' THEN 'PORTAL' WHEN ie_tipo_cliente='R' THEN 'PRESTADOR' END  ie_tipo_cliente,
	cd_unimed_executora  		cd_unimed_executora,
	nr_seq_execucao  		nr_seq_execucao,
	cd_unimed_beneficiario		cd_unimed_beneficiario,
	ie_confirmacao  		ie_confirmacao,
	ptu_obter_inconsist_trans(null,null,nr_seq_origem,'00319',1,null,null) cd_mens_erro,
	nr_seq_origem 			nr_seq_origem,
	null				cd_unimed_prestador,
	null				ie_alto_custo,
	null				nm_prestador,
	null				cd_prestador,
	null				cd_especialidade,
	null				ds_fim
FROM	ptu_resp_consulta_prest

union

select	2				ie_tipo_registro,
	null				cd_transacao,
	nr_seq_resp_prest		nr_sequencia,
	nr_seq_requisicao		nr_seq_requisicao,
	nr_seq_guia			nr_seq_guia,
	null 				ie_tipo_cliente,
	null  				cd_unimed_executora,
	null  				nr_seq_execucao,
	null				cd_unimed_beneficiario,
	null		  		ie_confirmacao,
	null				cd_mens_erro,
	nr_seq_origem	 		nr_seq_origem,
	cd_unimed_prestador		cd_unimed_prestador,
	ie_alto_custo			ie_alto_custo,
	Elimina_Acentuacao(nm_prestador) nm_prestador,
	cd_prestador			cd_prestador,
	cd_especialidade		cd_especialidade,
	null				ds_fim
from	ptu_resp_nomes_prest	b,
	ptu_resp_consulta_prest	a
where	a.nr_sequencia	= b.nr_seq_resp_prest

union

select	3				ie_tipo_registro,
	null				cd_transacao,
	nr_sequencia			nr_sequencia,
	nr_seq_requisicao		nr_seq_requisicao,
	nr_seq_guia			nr_seq_guia,
	null 				ie_tipo_cliente,
	null  				cd_unimed_executora,
	null  				nr_seq_execucao,
	null				cd_unimed_beneficiario,
	null		  		ie_confirmacao,
	null				cd_mens_erro,
	nr_seq_origem			nr_seq_origem,
	null				cd_unimed_prestador,
	null				ie_alto_custo,
	null				nm_prestador,
	null				cd_prestador,
	null				cd_especialidade,
	'FIM$'				ds_fim
from	ptu_resp_consulta_prest;

