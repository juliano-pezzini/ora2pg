-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_corresp_cedida_v (dt_mes, nr_seq_periodo, ie_campo) AS select	distinct dt_mes,
		nr_seq_periodo,
		ie_campo
FROM (
	select	trunc(add_months(p.dt_periodo_final, -35),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N35' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -34),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N34' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -33),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N33' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -32),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N32' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -31),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N31' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -30),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N30' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -29),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N29' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -28),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N28' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -27),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N27' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -26),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N26' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -25),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N25' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -24),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N24' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -23),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N23' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -22),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N22' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -21),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N21' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -20),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N20' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -19),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N19' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -18),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N18' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -17),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N17' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -16),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N16' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -15),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N15' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -14),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N14' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -13),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N13' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -12),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N12' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -11),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N11' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -10),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N10' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -9),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N9' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -8),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N8' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -7),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N7' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -6),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N6' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -5),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N5' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all
	
	select	trunc(add_months(p.dt_periodo_final, -4),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N4' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all
	
	select	trunc(add_months(p.dt_periodo_final, -3),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N3' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all
	
	select	trunc(add_months(p.dt_periodo_final, -2),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N2' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(add_months(p.dt_periodo_final, -1),'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N1' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo
	
union all

	select	trunc(p.dt_periodo_final,'month') dt_mes,
		p.nr_sequencia nr_seq_periodo,
		'N' ie_campo
	from	diops_movto_corresp_cedida		m,
		diops_periodo		p
	where	p.nr_sequencia	= m.nr_seq_periodo) alias71
order by dt_mes desc;

