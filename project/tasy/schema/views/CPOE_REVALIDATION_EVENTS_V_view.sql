-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW cpoe_revalidation_events_v (nr_sequencia, nr_seq_assinatura_rev, nr_atendimento, nm_usuario_nrec, nm_usuario, dt_validacao, dt_envio_comunicado, dt_atualizacao_nrec, dt_atualizacao, ds_stack, cd_medico_anterior, cd_medico, nr_seq_cpoe, ie_tipo_item) AS select	nr_sequencia,
		nr_seq_assinatura_rev,
		nr_atendimento,
		nm_usuario_nrec,
		nm_usuario,
		dt_validacao,
		dt_envio_comunicado,
		dt_atualizacao_nrec,
		dt_atualizacao,
		ds_stack,
		cd_medico_anterior,
		cd_medico,
		nr_seq_diet nr_seq_cpoe,
		'N' ie_tipo_item
	FROM 	cpoe_revalidation_events
	where	nr_seq_diet is not null
	
union all

	select	nr_sequencia,
		nr_seq_assinatura_rev,
		nr_atendimento,
		nm_usuario_nrec,
		nm_usuario,
		dt_validacao,
		dt_envio_comunicado,
		dt_atualizacao_nrec,
		dt_atualizacao,
		ds_stack,
		cd_medico_anterior,
		cd_medico,
		nr_seq_hemotherapy nr_seq_cpoe,
		'H' ie_tipo_item
	from 	cpoe_revalidation_events 
	where	nr_seq_hemotherapy is not null
	
union all

	select	nr_sequencia,
		nr_seq_assinatura_rev,
		nr_atendimento,
		nm_usuario_nrec,
		nm_usuario,
		dt_validacao,
		dt_envio_comunicado,
		dt_atualizacao_nrec,
		dt_atualizacao,
		ds_stack,
		cd_medico_anterior,
		cd_medico,
		nr_seq_dialysis nr_seq_cpoe,
		'D' ie_tipo_item
	from 	cpoe_revalidation_events 
	where	nr_seq_dialysis is not null
	
union all

	select	nr_sequencia,
		nr_seq_assinatura_rev,
		nr_atendimento,
		nm_usuario_nrec,
		nm_usuario,
		dt_validacao,
		dt_envio_comunicado,
		dt_atualizacao_nrec,
		dt_atualizacao,
		ds_stack,
		cd_medico_anterior,
		cd_medico,
		nr_seq_gasotherapy nr_seq_cpoe,
		'G' ie_tipo_item
	from 	cpoe_revalidation_events 
	where	nr_seq_gasotherapy is not null
	
union all

	select	nr_sequencia,
		nr_seq_assinatura_rev,
		nr_atendimento,
		nm_usuario_nrec,
		nm_usuario,
		dt_validacao,
		dt_envio_comunicado,
		dt_atualizacao_nrec,
		dt_atualizacao,
		ds_stack,
		cd_medico_anterior,
		cd_medico,
		nr_seq_material nr_seq_cpoe,
		'M' ie_tipo_item
	from 	cpoe_revalidation_events 
	where	nr_seq_material is not null
	
union all

	select	nr_sequencia,
		nr_seq_assinatura_rev,
		nr_atendimento,
		nm_usuario_nrec,
		nm_usuario,
		dt_validacao,
		dt_envio_comunicado,
		dt_atualizacao_nrec,
		dt_atualizacao,
		ds_stack,
		cd_medico_anterior,
		cd_medico,
		nr_seq_exam nr_seq_cpoe,
		'P' ie_tipo_item
	from 	cpoe_revalidation_events 
	where	nr_seq_exam is not null
	
union all

	select	nr_sequencia,
		nr_seq_assinatura_rev,
		nr_atendimento,
		nm_usuario_nrec,
		nm_usuario,
		dt_validacao,
		dt_envio_comunicado,
		dt_atualizacao_nrec,
		dt_atualizacao,
		ds_stack,
		cd_medico_anterior,
		cd_medico,
		nr_seq_recomendation nr_seq_cpoe,
		'R' ie_tipo_item
	from 	cpoe_revalidation_events 
	where	nr_seq_recomendation is not null;

