-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pre_faturamento_faturamento_v (dt_referencia, cd_convenio, dt_atualizacao, nm_usuario, cd_setor_receita, cd_setor_atendimento, cd_especialiadade, cd_conta_contabil, cd_material, cd_unidade_medida, ie_origem_proced, cd_procedimento, nr_seq_grupo_rec, cd_estrutura_conta, ie_diaria, qt_resumo, vl_medico, nr_seq_conta_financ, vl_auxiliares, vl_custo_operacional, vl_anestesista, vl_materiais, vl_procedimento, vl_material, vl_medico_fora_conta, vl_sadt_fora_conta, vl_repasse_terceiro, vl_custo, nr_interno_conta, cd_estabelecimento, vl_total_medico, vl_diaria, vl_proced, vl_item, vl_total_receita, ie_periodo, ie_tipo_atendimento, ie_protocolo, ie_proc_mat, vl_imposto, ie_complexidade, dt_receita, vl_desconto, ie_pacote, vl_original, cd_categoria, vl_hospital, qt_dia_internacao, dt_entrega, vl_repasse_calc, qt_atendimento, qt_conta, vl_faturado) AS select	a.dt_referencia dt_referencia,
	a.cd_convenio cd_convenio,
	a.dt_atualizacao dt_atualizacao,
	a.nm_usuario nm_usuario,
	a.cd_setor_receita cd_setor_receita,
	a.cd_setor_atendimento cd_setor_atendimento,
	a.cd_especialidade cd_especialiadade,
	a.cd_conta_contabil cd_conta_contabil,
	a.cd_material cd_material,
	a.cd_unidade_medida cd_unidade_medida,
	a.ie_origem_proced ie_origem_proced,
	a.cd_procedimento cd_procedimento,
	a.nr_seq_grupo_rec nr_seq_grupo_rec,
	a.cd_estrutura_conta cd_estrutura_conta,
	a.ie_diaria ie_diaria,
	a.qt_resumo qt_resumo,
	a.vl_medico vl_medico,
	a.nr_seq_conta_financ nr_seq_conta_financ,
	a.vl_auxiliares vl_auxiliares,
	a.vl_custo_operacional vl_custo_operacional,
	a.vl_anestesista vl_anestesista,
	a.vl_materiais vl_materiais,
	a.vl_procedimento vl_procedimento,
	a.vl_material vl_material,
	a.vl_medico_fora_conta vl_medico_fora_conta,
	a.vl_sadt_fora_conta vl_sadt_fora_conta,
	a.vl_repasse_terceiro vl_repasse_terceiro,
	a.vl_custo vl_custo,
	a.nr_interno_conta nr_interno_conta,
	a.cd_estabelecimento cd_estabelecimento,
	(a.vl_medico + a.vl_anestesista + a.vl_auxiliares) vl_total_medico,
	(CASE WHEN a.ie_diaria='S' THEN  a.vl_procedimento  ELSE 0 END ) vl_diaria,
	(CASE WHEN a.ie_diaria='S' THEN  0  ELSE (a.vl_materiais + a.vl_custo_operacional) END ) vl_proced,
	(a.vl_materiais + a.vl_custo_operacional + a.vl_material) vl_item,
	(a.vl_procedimento + a.vl_material) vl_total_receita,
	null ie_periodo,
	0 ie_tipo_atendimento,
	null ie_protocolo,
	null ie_proc_mat,
	0 vl_imposto,
	null ie_complexidade,
	LOCALTIMESTAMP dt_receita,
	0 vl_desconto,
	null ie_pacote,
	0 vl_original,
	null cd_categoria,
	0 vl_hospital,
	0 qt_dia_internacao,
	LOCALTIMESTAMP dt_entrega,
	0 vl_repasse_calc,
	0 qt_atendimento,
	0 qt_conta,
	0 vl_faturado
FROM	pre_faturamento a

union

select	b.dt_referencia dt_referencia,
	b.cd_convenio cd_convenio,
	LOCALTIMESTAMP dt_atualizacao,
	null nm_usuario,
	0 cd_setor_receita,
	b.cd_setor_atendimento cd_setor_atendimento,
	b.cd_especialidade cd_especialidade,
	b.cd_conta_contabil,
	0 cd_material,
	null cd_unidade_medida,
	0 ie_origem_proced,
	0 cd_procedimento,
	b.nr_seq_grupo_rec,
	b.cd_estrutura_conta,
	null ie_diaria,
	0 qt_resumo,
	0 vl_medico,
	b.nr_seq_conta_financ nr_seq_conta_financ,
	0 vl_auxiliares,
	0 vl_custo_operacional,
	0 vl_anestesista,
	0 vl_materiais,
	b.vl_procedimento vl_procedimento,
	b.vl_material vl_material,
	0 vl_medico_fora_conta,
	0 vl_sadt_fora_conta,
	b.vl_terceiro vl_repasse_tereceiro,
	b.vl_custo,
	0 nr_interno_conta,
	b.cd_estabelecimento cd_estabelecimento,
	0 vl_total_medico,
	0 vl_diaria,
	0 vl_proced,
	0 vl_item,
	0 vl_total_receita,
	b.ie_periodo ie_periodo,
	b.ie_tipo_atendimento ie_tipo_atendimento,
	b.ie_protocolo ie_protocolo,
	b.ie_proc_mat ie_proc_mat,
	b.vl_imposto vl_imposto,
	b.ie_complexidade ie_complexidade,
	b.dt_receita dt_receita,
	b.vl_desconto vl_desconto,
	b.ie_pacote ie_pacote,
	b.vl_original vl_original,
	b.cd_categoria cd_categoria,
	b.vl_hospital vl_hospital,
	b.qt_dia_internacao qt_dia_internacao,
	b.dt_entrega dt_entrega,
	b.vl_repasse_calc vl_repasse_calc,
	b.qt_atendimento qt_atendimento,
	b.qt_conta qt_conta,
	(b.vl_procedimento + b.vl_material) vl_faturado
from	eis_resultado b;

