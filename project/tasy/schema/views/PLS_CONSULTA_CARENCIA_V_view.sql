-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_consulta_carencia_v (ie_origem, nr_seq_tipo_carencia, ds_carencia, qt_dias, dt_inicio_vigencia, ie_mes_posterior, nr_seq_contrato, nr_seq_segurado, nr_seq_plano, nr_seq_pessoa_proposta) AS select	'Contrato'ie_origem,
	nr_seq_tipo_carencia,
	substr(obter_descricao_padrao('PLS_TIPO_CARENCIA','DS_CARENCIA',nr_seq_tipo_carencia),1,255) ds_carencia,
	qt_dias,
	to_char(dt_inicio_vigencia,'dd/mm/yyyy') dt_inicio_vigencia,
	coalesce(ie_mes_posterior,'N') ie_mes_posterior,
	nr_seq_contrato,
	null nr_seq_segurado,
	null nr_seq_plano,
	null nr_seq_pessoa_proposta
FROM	pls_carencia
where	nr_seq_segurado is null
and	nr_seq_plano is null
and	nr_seq_pessoa_proposta is null

union

select	'Beneficiário' ie_origem,
	nr_seq_tipo_carencia,
	substr(obter_descricao_padrao('PLS_TIPO_CARENCIA','DS_CARENCIA',nr_seq_tipo_carencia),1,255) ds_carencia,
	qt_dias,
	to_char(dt_inicio_vigencia,'dd/mm/yyyy') dt_inicio_vigencia,
	coalesce(ie_mes_posterior,'N') ie_mes_posterior,
	null nr_seq_contrato,
	nr_seq_segurado,
	null nr_seq_plano,
	null nr_seq_pessoa_proposta
from	pls_carencia
where	nr_seq_contrato is null
and	nr_seq_plano is null
and	nr_seq_pessoa_proposta is null

union

select	'Produto' ie_origem,
	nr_seq_tipo_carencia,
	substr(obter_descricao_padrao('PLS_TIPO_CARENCIA','DS_CARENCIA',nr_seq_tipo_carencia),1,255) ds_carencia,
	qt_dias,
	to_char(dt_inicio_vigencia,'dd/mm/yyyy') dt_inicio_vigencia,
	coalesce(ie_mes_posterior,'N') ie_mes_posterior,
	null nr_seq_contrato,
	null nr_seq_segurado,
	nr_seq_plano,
	null nr_seq_pessoa_proposta
from	pls_carencia
where	nr_seq_segurado is null
and	nr_seq_contrato is null
and	nr_seq_pessoa_proposta is null

union

select	'Beneficiário da proposta' ie_origem,
	nr_seq_tipo_carencia,
	substr(obter_descricao_padrao('PLS_TIPO_CARENCIA','DS_CARENCIA',nr_seq_tipo_carencia),1,255) ds_carencia,
	qt_dias,
	to_char(dt_inicio_vigencia,'dd/mm/yyyy') dt_inicio_vigencia,
	coalesce(ie_mes_posterior,'N') ie_mes_posterior,
	null nr_seq_contrato,
	null nr_seq_segurado,
	null nr_seq_plano,
	nr_seq_pessoa_proposta
from	pls_carencia
where	nr_seq_segurado is null
and	nr_seq_plano is null
and	nr_seq_contrato is null;

