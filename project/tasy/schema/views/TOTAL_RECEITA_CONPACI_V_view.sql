-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW total_receita_conpaci_v (vl_pendente, vl_conta, nr_atendimento, ie_proc_mat, ds_conta_receita) AS SELECT SUM(CASE WHEN NR_INTERNO_CONTA IS NULL THEN  VL_ITEM  ELSE 0 END ) VL_PENDENTE,
       SUM(CASE WHEN NR_INTERNO_CONTA IS NULL THEN  0  ELSE VL_ITEM END ) VL_CONTA,
       NR_ATENDIMENTO,
       IE_PROC_MAT,
       DS_CONTA_RECEITA
FROM   RECEITA_CONTA_PACIENTE_V
WHERE (CD_MOTIVO_EXC_CONTA IS NULL)
  AND (DT_ACERTO_CONVENIO  IS NULL)
GROUP  BY NR_ATENDIMENTO, IE_PROC_MAT, DS_CONTA_RECEITA

Union

SELECT SUM(CASE WHEN NR_INTERNO_CONTA IS NULL THEN  VL_ITEM  ELSE 0 END ) VL_PENDENTE,
       SUM(CASE WHEN NR_INTERNO_CONTA IS NULL THEN  0  ELSE VL_ITEM END ) VL_CONTA,
       NR_ATENDIMENTO,
       9 IE_PROC_MAT,
       'Total Geral' DS_CONTA_RECEITA
FROM   RECEITA_CONTA_PACIENTE_V
WHERE (CD_MOTIVO_EXC_CONTA IS NULL)
  AND (DT_ACERTO_CONVENIO  IS NULL)
GROUP  BY NR_ATENDIMENTO, 9, 'Total Geral';

