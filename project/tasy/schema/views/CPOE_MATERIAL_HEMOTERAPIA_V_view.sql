-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW cpoe_material_hemoterapia_v (nr_seq_hemo, nr_atendimento, cd_material, qt_dose, ie_via_aplicacao, cd_unidade_medida, cd_mat_recons, qt_dose_recons, cd_unid_med_recons, cd_mat_dil, qt_dose_dil, cd_unid_med_dil, cd_intervalo, ie_administracao, dt_inicio, hr_prim_horario, ie_urgencia, ds_horarios, ds_obser_hemo, dt_liberacao, cd_pessoa_fisica, nr_agrupamento, cd_setor_atendimento, ie_motivo_prescricao) AS select	nr_sequencia	nr_seq_hemo,
		nr_atendimento,
		cd_mat_hem1	cd_material,
		qt_dose_hem1	qt_dose,
		ie_via_mat_hem1	ie_via_aplicacao,
		cd_unid_medida_dose_hem1	cd_unidade_medida,
		cd_mat_recons1	cd_mat_recons,
		qt_dose_rec1	qt_dose_recons,
		cd_unid_med_rec1	cd_unid_med_recons,
		cd_mat_dil1	cd_mat_dil,
		qt_dose_dil1	qt_dose_dil,
		cd_unid_med_dose_dil1	cd_unid_med_dil,
		coalesce(cd_interv_hem1,cd_intervalo)	cd_intervalo,
		ie_adm_mat_hem1	ie_administracao,
		dt_inicio_hem1	dt_inicio,
		hr_prim_hor_hem1	hr_prim_horario,
		coalesce(ie_urgencia_mat_hem1,ie_urgencia)	ie_urgencia,
		coalesce(ds_hor_hem1,ds_horarios)	ds_horarios,
		ds_observacao_mat1	ds_obser_hemo,
		dt_liberacao,
		cd_pessoa_fisica,
		1 nr_agrupamento,
		cd_setor_atendimento,
		ie_motivo_prescricao
FROM	cpoe_hemoterapia
where	cd_mat_hem1 is not null

union all

select	nr_sequencia	nr_seq_hemo,
		nr_atendimento,
		cd_mat_hem2	cd_material,
		qt_dose_hem2	qt_dose,
		ie_via_mat_hem2	ie_via_aplicacao,
		cd_unid_medida_dose_hem2	cd_unidade_medida,
		cd_mat_recons2	cd_mat_recons,
		qt_dose_rec2	qt_dose_recons,
		cd_unid_med_rec2	cd_unid_med_recons,
		cd_mat_dil2	cd_mat_dil,
		qt_dose_dil2	qt_dose_dil,
		cd_unid_med_dose_dil2	cd_unid_med_dil,
		coalesce(cd_interv_hem2,cd_intervalo)	cd_intervalo,
		ie_adm_mat_hem2	ie_administracao,
		dt_inicio_hem2	dt_inicio,
		hr_prim_hor_hem2	hr_prim_horario,
		coalesce(ie_urgencia_mat_hem2,ie_urgencia)	ie_urgencia,
		coalesce(ds_hor_hem2,ds_horarios)	ds_horarios,
		ds_observacao_mat2	ds_obser_hemo,
		dt_liberacao,
		cd_pessoa_fisica,
		2 nr_agrupamento,
		cd_setor_atendimento,
		ie_motivo_prescricao
from	cpoe_hemoterapia
where	cd_mat_hem2 is not null

union all

select	nr_sequencia	nr_seq_hemo,
		nr_atendimento,
		cd_mat_hem3	cd_material,
		qt_dose_hem3	qt_dose,
		ie_via_mat_hem3	ie_via_aplicacao,
		cd_unid_medida_dose_hem3	cd_unidade_medida,
		cd_mat_recons3	cd_mat_recons,
		qt_dose_rec3	qt_dose_recons,
		cd_unid_med_rec3	cd_unid_med_recons,
		cd_mat_dil3	cd_mat_dil,
		qt_dose_dil3	qt_dose_dil,
		cd_unid_med_dose_dil3	cd_unid_med_dil,
		coalesce(cd_interv_hem3,cd_intervalo)	cd_intervalo,
		ie_adm_mat_hem3	ie_administracao,
		dt_inicio_hem3	dt_inicio,
		hr_prim_hor_hem3	hr_prim_horario,
		coalesce(ie_urgencia_mat_hem3,ie_urgencia)	ie_urgencia,
		coalesce(ds_hor_hem3,ds_horarios)	ds_horarios,
		DS_OBSERVACAO_MAT3	ds_obser_hemo,
		dt_liberacao,
		cd_pessoa_fisica,
		3 nr_agrupamento,
		cd_setor_atendimento,
		ie_motivo_prescricao
from	cpoe_hemoterapia
where	cd_mat_hem3 is not null

union all

select	nr_sequencia	nr_seq_hemo,
		nr_atendimento,
		cd_mat_hem4	cd_material,
		qt_dose_hem4	qt_dose,
		ie_via_mat_hem4	ie_via_aplicacao,
		cd_unid_medida_dose_hem4	cd_unidade_medida,
		cd_mat_recons4	cd_mat_recons,
		qt_dose_rec4	qt_dose_recons,
		cd_unid_med_rec4	cd_unid_med_recons,
		cd_mat_dil4	cd_mat_dil,
		qt_dose_dil4	qt_dose_dil,
		cd_unid_med_dose_dil4	cd_unid_med_dil,
		coalesce(cd_interv_hem4,cd_intervalo)	cd_intervalo,
		ie_adm_mat_hem4	ie_administracao,
		dt_inicio_hem4	dt_inicio,
		hr_prim_hor_hem4	hr_prim_horario,
		coalesce(ie_urgencia_mat_hem4,ie_urgencia)	ie_urgencia,
		coalesce(ds_hor_hem4,ds_horarios)	ds_horarios,
		ds_observacao_mat4	ds_obser_hemo,
		dt_liberacao,
		cd_pessoa_fisica,
		4 nr_agrupamento,
		cd_setor_atendimento,
		ie_motivo_prescricao
from	cpoe_hemoterapia
where	cd_mat_hem4 is not null

union all

select	nr_sequencia	nr_seq_hemo,
		nr_atendimento,
		cd_mat_hem5	cd_material,
		qt_dose_hem5	qt_dose,
		ie_via_mat_hem5	ie_via_aplicacao,
		cd_unid_medida_dose_hem5	cd_unidade_medida,
		cd_mat_recons5	cd_mat_recons,
		qt_dose_rec5	qt_dose_recons,
		cd_unid_med_rec5	cd_unid_med_recons,
		cd_mat_dil5	cd_mat_dil,
		qt_dose_dil5	qt_dose_dil,
		cd_unid_med_dose_dil5	cd_unid_med_dil,
		coalesce(cd_interv_hem5,cd_intervalo)	cd_intervalo,
		ie_adm_mat_hem5	ie_administracao,
		dt_inicio_hem5	dt_inicio,
		hr_prim_hor_hem5	hr_prim_horario,
		coalesce(ie_urgencia_mat_hem5,ie_urgencia)	ie_urgencia,
		coalesce(ds_hor_hem5,ds_horarios)	ds_horarios,
		ds_observacao_mat5	ds_obser_hemo,
		dt_liberacao,
		cd_pessoa_fisica,
		5 nr_agrupamento,
		cd_setor_atendimento,
		ie_motivo_prescricao
from	cpoe_hemoterapia
where	cd_mat_hem5 is not null;

