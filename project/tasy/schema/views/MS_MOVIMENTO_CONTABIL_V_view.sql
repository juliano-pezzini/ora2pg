-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ms_movimento_contabil_v (nr_lote_contabil, dt_movimento, vl_movimento, ds_compl_historico, cd_classificacao_debito, cd_classificacao_credito, cd_centro_custo_debito, cd_centro_custo_credito, ds_microsiga, ds_microsiga_m, ds_microsiga_f) AS SELECT 	x.nr_lote_contabil,
	m.dt_movimento,
	coalesce(t.vl_movimento,m.vl_movimento) VL_movimento,
	m.ds_compl_historico,
	m.CD_CLASSIF_DEBITO CD_CLASSIFICACAO_DEBITO,
	m.CD_CLASSIF_CREDITO CD_CLASSIFICACAO_CREDITO,
	CASE WHEN m.cd_conta_credito IS NULL THEN  t.cd_centro_custo  ELSE 0 END  cd_centro_custo_debito,
	CASE WHEN m.cd_conta_debito IS NULL THEN  t.cd_centro_custo  ELSE 0 END  cd_centro_custo_credito,
	'003' ds_microsiga,
	'00000000000000000' ds_microsiga_m,
	'00000000000000000' ds_microsiga_f
FROM lote_contabil x, historico_padrao h, conta_contabil b, ctb_movimento m
LEFT OUTER JOIN ctb_movto_centro_custo t ON (m.NR_SEQUENCIA = t.nr_seq_movimento)
LEFT OUTER JOIN centro_custo c ON (t.cd_centro_custo = c.cd_centro_custo)
WHERE coalesce(m.cd_conta_credito,m.CD_CONTA_DEBITO)  = b.cd_conta_contabil AND m.cd_historico = h.cd_historico AND m.nr_lote_contabil = x.nr_lote_contabil;

