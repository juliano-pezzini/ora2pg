-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW statistic_birth_xml ("ns3:artdergeburt", "ns3:artderlage", "ns3:artderbeendigungdergeburt", "ns3:koerperlaenge", "ns3:wochen", "ns3:tage", "ns3:medeinleitunggeburt", birth_inlc_st, live_birth, "ns3:datumderletztengeburt", smoking, mother_height, mother_weight_begine, mother_weight_end, "ns3:institution", "ns3:abteilung", "ns3:familienname", "ns3:vorname", "ns3:plz", "ns3:ort", "ns3:strasse", "ns3:nummer", "ns3:email", "ns3:telnr", "ns3:min1", "ns3:min5", "ns3:min10", "ns3:geburtsgewicht", "ns3:nabelschnurphwert", nr_atendimento) AS SELECT
        ''                          			ns3:ArtDerGeburt,
        epc.nr_seq_pos_birth        			ns3:ArtDerLage,
        epc.nr_seq_typ_del          			ns3:ArtDerBeendigungDerGeburt,
        epc.qt_body_length          			ns3:Koerperlaenge,
        epc.dt_weeks                			ns3:Wochen,
        epc.dt_days                 			ns3:Tage,
        epc.ie_initiation_birth_yes             ns3:MedEinleitungGeburt,
        ( nm_live_birth + nm_still_birth ) 		birth_inlc_st,
        epc.nm_live_birth       				live_birth,
        epc.dt_ult_parto        				ns3:DatumDerLetztenGeburt,
        d.ie_tabagismo          				smoking,
        999 									mother_height,
        999 									mother_weight_begine,
        999 									mother_weight_end,
        mdb.ds_institution      				ns3:Institution,
        mdb.ds_department       				ns3:Abteilung,
        mdb.nm_mw_last_name     				ns3:Familienname,
        mdb.nm_mw_first_name    				ns3:Vorname,
        mdb.cd_postal_code      				ns3:Plz,
        mdb.ds_city             				ns3:Ort,
        mdb.ds_street_name      				ns3:Strasse,
        mdb.nr_street_number    				ns3:Nummer,
        mdb.ds_mw_email         				ns3:Email,
        mdb.nm_mw_phone         				ns3:TelNr,
        epc.qt_apgar_one_min    				ns3:Min1,
        epc.qt_apgar_five_min   				ns3:Min5,
        epc.qt_apgar_ten_min    				ns3:Min10,
        epc.qt_gram             				ns3:Geburtsgewicht,
        epc.qt_ph_level         				ns3:NabelschnurPhWert,
        epc.nr_atendimento
    FROM
        epc_psm_data           epc
        INNER JOIN atendimento_paciente   ap ON ap.nr_atendimento = epc.nr_atendimento
        INNER JOIN master_data_birth      mdb ON mdb.cd_estabelecimento = ap.cd_estabelecimento
        LEFT JOIN parto                  d ON d.nr_atendimento = epc.nr_atendimento;

