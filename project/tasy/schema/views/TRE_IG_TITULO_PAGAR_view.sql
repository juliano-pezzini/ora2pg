-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW tre_ig_titulo_pagar (nr_titulo, cd_estabelecimento, desc_estabelecimento, cd_pessoa_fisica, cd_cgc, nm_pessoa_titulo, codigo_credor, ds_tipo_pessoa, vl_titulo, vl_saldo_titulo, dt_vencimento_atual, ie_tipo_titulo, ie_desc_tipo_titulo, nr_seq_classe, ds_nr_seq_classe, ie_situacao, ie_desc_situacao, ie_origem_titulo, desc_ie_origem_titulo) AS SELECT  NR_TITULO,
        CD_ESTABELECIMENTO,
        SUBSTR(obter_nome_estabelecimento(CD_ESTABELECIMENTO),1,255) DESC_ESTABELECIMENTO,
        CD_PESSOA_FISICA,
        CD_CGC,
        Obter_nome_pf_pj(null, cd_cgc) || Obter_nome_pf_pj(cd_pessoa_fisica,null) NM_PESSOA_TITULO,
        cd_pessoa_fisica || cd_cgc CODIGO_CREDOR,
        Upper(SubStr(CASE WHEN CD_PESSOA_FISICA IS NULL THEN 'Jurídica'  ELSE 'Física' END ,1,255)) DS_TIPO_PESSOA,
        VL_TITULO,
        VL_SALDO_TITULO,
        DT_VENCIMENTO_ATUAL,
        IE_TIPO_TITULO,
        SUBSTR(OBTER_DESCRICAO_DOMINIO(502,IE_TIPO_TITULO),1,255) IE_DESC_TIPO_TITULO,
        NR_SEQ_CLASSE,
        Upper(SUBSTR(OBTER_DESCRICAO_PADRAO('CLASSE_TITULO_PAGAR','DS_CLASSE',NR_SEQ_CLASSE),1,255)) DS_NR_SEQ_CLASSE,
        IE_SITUACAO,
        SUBSTR(OBTER_DESCRICAO_DOMINIO(501,IE_SITUACAO),1,255) IE_DESC_SITUACAO,
        IE_ORIGEM_TITULO,
        SUBSTR(OBTER_DESCRICAO_DOMINIO(500,IE_ORIGEM_TITULO),1,255) DESC_IE_ORIGEM_TITULO
FROM    TITULO_PAGAR
ORDER BY NR_TITULO DESC;

