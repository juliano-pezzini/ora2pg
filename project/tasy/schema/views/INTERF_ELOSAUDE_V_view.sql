-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW interf_elosaude_v (tp_registro, nr_seq_protocolo, cd_cgc_prestador, cd_usuario_convenio, nm_beneficiario, nr_documento, dt_atendimento, ie_tipo_prestador, nm_prestador, ds_especialidade, cd_servico, ds_servico, nm_medico_solic, qt_item, vl_chs, vl_real, vl_filme, vl_uco, hr_execucao, dt_internacao, dt_alta, ie_tipo_ato, cd_cid, ie_via_acesso, hr_entrada, hr_alta, ie_participacao, cd_dente, cd_face_dente) AS SELECT	1						tp_registro,
	a.nr_seq_protocolo				nr_seq_protocolo,
	c.cd_cgc_hospital				cd_cgc_prestador,
	a.cd_usuario_convenio				cd_usuario_convenio,
	substr(a.nm_paciente,1,50)			nm_beneficiario,
	d.cd_autorizacao				nr_documento,
	a.dt_entrada					dt_atendimento,
	substr(obter_interf_tipo_prestador(b.cd_medico_executor, b.cd_cgc_prestador, b.cd_setor_atendimento, c.cd_cgc_hospital),1,2) ie_tipo_prestador,
	upper(substr(c.nm_hospital,1,50))		nm_prestador,
	substr(obter_desc_espec_medica(b.cd_especialidade),1,20) ds_especialidade,
	b.cd_item					cd_servico,
	b.ds_item					ds_servico,
	substr(a.nm_medico_resp,1,50)			nm_medico_solic,
	b.qt_item					qt_item,
	b.vl_unitario_ch				vl_chs,
	b.vl_total_item					vl_real,
	b.vl_filme					vl_filme,
	b.vl_custo_oper					vl_uco,
	b.dt_item					hr_execucao,
	a.dt_entrada					dt_internacao,
	a.dt_alta					dt_alta,
	CASE WHEN a.ie_tipo_atendimento=1 THEN  'I' WHEN a.ie_tipo_atendimento=7 THEN  'E' END 	ie_tipo_ato,
	a.cd_cid_principal				cd_cid,
	b.ie_via_acesso					ie_via_acesso,
	a.dt_entrada					hr_entrada,
	a.dt_alta					hr_alta,
	CASE WHEN b.cd_funcao_executor=1 THEN  'C' WHEN b.cd_funcao_executor=0 THEN  'M' WHEN b.cd_funcao_executor=9 THEN  'P' WHEN b.cd_funcao_executor=10 THEN  'S' WHEN b.cd_funcao_executor=11 THEN  'T' WHEN b.cd_funcao_executor=3 THEN  'A' WHEN b.cd_funcao_executor=5 THEN  'I' END  ie_participacao,
	' '						cd_dente,
	' '						cd_face_dente
FROM	conta_paciente d,
	w_interf_conta_header c,
	w_interf_conta_item b,
	w_interf_conta_cab a
where	a.nr_interno_conta	= b.nr_interno_conta
and	a.nr_seq_protocolo	= b.nr_seq_protocolo
and	a.nr_seq_protocolo	= c.nr_seq_protocolo
and	a.nr_interno_conta	= d.nr_interno_conta
order by	d.cd_autorizacao,
		b.cd_item,
		b.ds_item;

