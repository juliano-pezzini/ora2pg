-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW sl_chelist_item_v (ordem, ds_item_padrao, nr_seq_grupo, nr_seq_checklist, nr_seq_item_checklist, ie_resultado, ds_item, ds_grupo, ds_observacao, ie_nao_aplica, dt_atualizacao_nrec, ds_resultado, ie_result_item, ie_aplicacao_checklist, nr_seq_apres_grupo, nr_seq_apres_item) AS select distinct
		 1 ordem,
		 a.ds_grupo ds_item_padrao,
		 a.nr_sequencia nr_seq_grupo,
		 c.NR_SEQ_CHECKLIST NR_SEQ_CHECKLIST,
		 null nr_seq_item_checklist,
		 null IE_RESULTADO,
		 null DS_ITEM,
		 a.ds_grupo ds_grupo,
		 null ds_observacao,
		 null ie_nao_aplica,
		 c.dt_atualizacao_nrec dt_atualizacao_nrec,
		null ds_resultado,
		null ie_result_item,
		a.ie_aplicacao_checklist ie_aplicacao_checklist,
		a.nr_seq_apresentacao nr_seq_apres_grupo,
		a.nr_sequencia nr_seq_apres_item
FROM 	SL_CHECK_LIST_UNID_ITEM c,
		SL_ITEM_CHECK_LIST b,
		SL_GRUPO_CHECK_LIST a
where 	c.NR_SEQ_ITEM_CHECK_LIST = b.nr_sequencia
and 	b.NR_SEQ_GRUPO_CHECK_LIST = a.nr_sequencia
and coalesce(a.ie_situacao, 'A') = 'A'
and coalesce(b.ie_situacao, 'A') = 'A'

union

select distinct
		 2 ordem,
		 '       ' || b.DS_ITEM ds_item_padrao,
		 a.nr_sequencia nr_seq_grupo,
		 c.NR_SEQ_CHECKLIST NR_SEQ_CHECKLIST,
		 c.nr_sequencia nr_seq_item_checklist,
		 IE_RESULTADO IE_RESULTADO,
		 b.DS_ITEM,
		 a.ds_grupo ds_grupo,
		 c.ds_observacao,
		 c.ie_nao_aplica,
		 c.dt_atualizacao_nrec dt_atualizacao_nrec,
		SUBSTR(UPPER(OBTER_DESC_EXPRESSAO(CASE WHEN IE_RESULTADO='S' THEN 319619 WHEN IE_RESULTADO='N' THEN  319618 WHEN IE_RESULTADO='P' THEN  295406 END )), 1, 255) ds_resultado,
		c.ie_result_item,
		a.ie_aplicacao_checklist ie_aplicacao_checklist,
		a.nr_seq_apresentacao nr_seq_apres_grupo,
		b.nr_seq_apresentacao nr_seq_apres_item
from 	SL_CHECK_LIST_UNID_ITEM c,
		SL_ITEM_CHECK_LIST b,
		SL_GRUPO_CHECK_LIST a
where 	c.NR_SEQ_ITEM_CHECK_LIST = b.nr_sequencia
and 	b.NR_SEQ_GRUPO_CHECK_LIST = a.nr_sequencia
and coalesce(a.ie_situacao, 'A') = 'A'
and coalesce(b.ie_situacao, 'A') = 'A';

