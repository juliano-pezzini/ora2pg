-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_pac_nivel_aten_v (ds_sexo, ds_tipo_sangue, ds_estado_civil, ds_escolaridade, cd_escolaridade, ds_bairro, ds_municipio, ds_cid, ds_obito, ds_primeira_consulta, ds_ultima_consulta, cd_pessoa_fisica, dt_primeira_consulta, cd_medico) AS select	substr(obter_valor_dominio(4, obter_dados_pf(a.cd_pessoa_fisica,'SE')),1,200) ds_sexo,
		substr(obter_dados_pf(a.cd_pessoa_fisica,'TS')||obter_dados_pf(a.cd_pessoa_fisica,'RH'),1,200) ds_tipo_sangue, 
		substr(obter_valor_dominio(5, obter_dados_pf(a.cd_pessoa_fisica,'EC')),1,200) ds_estado_civil, 
		substr(obter_dados_pf(a.cd_pessoa_fisica,'GI'),1,200) ds_escolaridade, 
		substr(obter_dados_pf(a.cd_pessoa_fisica,'CGI'),1,200) cd_escolaridade, 
		substr(obter_compl_pf(a.cd_pessoa_fisica,1,'B'),1,200) ds_bairro, 
		substr(obter_compl_pf(a.cd_pessoa_fisica,1,'CI'),1,200) ds_municipio,		 
		substr(Obter_CID10_Paciente(a.cd_pessoa_fisica, wheb_usuario_pck.get_nm_usuario) ,1,200) ds_cid, 
		substr(CASE WHEN obter_se_paciente_em_obito(a.cd_pessoa_fisica)='S' THEN obter_desc_expressao(719927,'Sim')  ELSE obter_desc_expressao(327114,'NÃ£o') END ,1,200) ds_obito, 
		to_char(trunc(a.dt_primeira_consulta, 'Year'), 'yyyy') ds_primeira_consulta, 
		to_char(trunc(a.dt_ultima_consulta, 'Year'), 'yyyy') ds_ultima_consulta, 
		cd_pessoa_fisica, 
		dt_primeira_consulta, 
		cd_medico 
FROM	med_cliente a 
where	1 = 1;

