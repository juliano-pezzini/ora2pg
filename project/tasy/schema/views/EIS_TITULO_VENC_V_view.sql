-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_titulo_venc_v (dt_referencia, cd_estabelecimento, cd_convenio, ds_convenio, vl_total_convenio, vl_vencer_quinze, vl_vencer_trinta, vl_vencer_sessenta, vl_vencer_noventa, vl_vencer_centoevinte, vl_vencer_acima_centoevinte, vl_vencido_quinze, vl_vencido_trinta, vl_vencido_sessenta, vl_vencido_noventa, vl_vencido_centoevinte, vl_vencido_acima_centoevinte, vl_total_vencer, vl_total_vencido, ie_baixa_parcial) AS select	dt_referencia,
	cd_estabelecimento,
	CASE WHEN ie_convenio_tit_rec='P' THEN  CASE WHEN ie_origem_tit_rec='O' THEN  cd_cgc  ELSE cd_convenio END   ELSE cd_convenio END  cd_convenio,
	CASE WHEN ie_convenio_tit_rec='P' THEN  CASE WHEN ie_origem_tit_rec='O' THEN  ds_razao_social  ELSE ds_convenio END   ELSE ds_convenio END  ds_convenio,
	sum(vl_vencimento) vl_total_convenio,
	sum(CASE WHEN ie_tipo_vencimento=1 THEN vl_vencimento  ELSE 0 END ) vl_vencer_quinze,
	sum(CASE WHEN ie_tipo_vencimento=2 THEN vl_vencimento  ELSE 0 END ) vl_vencer_trinta,
	sum(CASE WHEN ie_tipo_vencimento=3 THEN vl_vencimento  ELSE 0 END ) vl_vencer_sessenta,
	sum(CASE WHEN ie_tipo_vencimento=4 THEN vl_vencimento  ELSE 0 END ) vl_vencer_noventa,
	sum(CASE WHEN ie_tipo_vencimento=5 THEN vl_vencimento  ELSE 0 END ) vl_vencer_centoevinte,
	sum(CASE WHEN ie_tipo_vencimento=11 THEN vl_vencimento  ELSE 0 END ) vl_vencer_acima_centoevinte,
	/*sum(decode(ie_tipo_vencimento,5,vl_vencimento,
	                              11,vl_vencimento, 0)) vl_vencer_acima_nov,*/
	sum(CASE WHEN ie_tipo_vencimento=6 THEN vl_vencimento  ELSE 0 END ) vl_vencido_quinze,
	sum(CASE WHEN ie_tipo_vencimento=7 THEN vl_vencimento  ELSE 0 END ) vl_vencido_trinta,
	sum(CASE WHEN ie_tipo_vencimento=8 THEN vl_vencimento  ELSE 0 END ) vl_vencido_Sessenta,
	sum(CASE WHEN ie_tipo_vencimento=9 THEN vl_vencimento  ELSE 0 END ) vl_vencido_Noventa,
	sum(CASE WHEN ie_tipo_vencimento=10 THEN vl_vencimento  ELSE 0 END ) vl_vencido_centoevinte,
	sum(CASE WHEN ie_tipo_vencimento=12 THEN vl_vencimento  ELSE 0 END ) vl_vencido_acima_centoevinte,
	/*sum(decode(ie_tipo_vencimento,10,vl_vencimento,
	                              12,vl_vencimento, 0)) vl_vencido_Acima_Nov,*/
	sum(CASE WHEN ie_tipo_vencimento=1 THEN vl_vencimento WHEN ie_tipo_vencimento=2 THEN vl_vencimento WHEN ie_tipo_vencimento=3 THEN vl_vencimento WHEN ie_tipo_vencimento=4 THEN vl_vencimento WHEN ie_tipo_vencimento=5 THEN vl_vencimento WHEN ie_tipo_vencimento=11 THEN vl_vencimento  ELSE 0 END ) vl_total_vencer,
	sum(CASE WHEN ie_tipo_vencimento=6 THEN vl_vencimento WHEN ie_tipo_vencimento=7 THEN vl_vencimento WHEN ie_tipo_vencimento=8 THEN vl_vencimento WHEN ie_tipo_vencimento=9 THEN vl_vencimento WHEN ie_tipo_vencimento=10 THEN vl_vencimento WHEN ie_tipo_vencimento=12 THEN vl_vencimento  ELSE 0 END ) vl_total_Vencido,
	ie_baixa_parcial
FROM	eis_titulo_vencimento
group by dt_referencia,
	CASE WHEN ie_convenio_tit_rec='P' THEN  CASE WHEN ie_origem_tit_rec='O' THEN  cd_cgc  ELSE cd_convenio END   ELSE cd_convenio END ,
	CASE WHEN ie_convenio_tit_rec='P' THEN  CASE WHEN ie_origem_tit_rec='O' THEN  ds_razao_social  ELSE ds_convenio END   ELSE ds_convenio END ,
	cd_estabelecimento,
	ie_baixa_parcial;

