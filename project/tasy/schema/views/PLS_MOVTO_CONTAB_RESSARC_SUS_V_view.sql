-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_movto_contab_ressarc_sus_v (ie_status, nr_seq_processo_conta_comp, nr_seq_processo_conta, cd_conta_cred, cd_conta_deb, cd_classif_cred, cd_classif_deb, nr_seq_esquema, nr_sequencia, ds_conta_glosa, nr_seq_atualizacao) AS select	a.ie_status,
	a.nr_seq_processo_conta_comp,
	null nr_seq_processo_conta,
	b.cd_conta_cred_prov cd_conta_cred,
	b.cd_conta_deb_prov cd_conta_deb,
	b.cd_classif_cred_prov cd_classif_cred,
	b.cd_classif_deb_prov cd_classif_deb,
	b.nr_seq_esquema_prov nr_seq_esquema,
	a.nr_sequencia,
	'Provisão' ds_conta_glosa,
	a.nr_seq_atualizacao
FROM	pls_movimento_contabil		a,
	pls_processo_contas_comp	b
where	a.nr_seq_processo_conta_comp	= b.nr_sequencia
and	ie_conta_glosa	= 'PR'

union all

select	a.ie_status,
	a.nr_seq_processo_conta_comp,
	null nr_seq_processo_conta,
	b.cd_conta_cred_ajuste,
	b.cd_conta_deb_ajuste,
	b.cd_classif_cred_ajuste,
	b.cd_classif_deb_ajuste,
	b.nr_seq_esquema_ajuste,
	a.nr_sequencia,
	'Ajuste - Acréscimo' ds_conta_glosa,
	a.nr_seq_atualizacao
from	pls_movimento_contabil		a,
	pls_processo_contas_comp	b
where	a.nr_seq_processo_conta_comp	= b.nr_sequencia
and	ie_conta_glosa	= 'AC'

union all

select	a.ie_status,
	a.nr_seq_processo_conta_comp,
	null nr_seq_processo_conta,
	b.cd_conta_cred_ajuste,
	b.cd_conta_deb_ajuste,
	b.cd_classif_cred_ajuste,
	b.cd_classif_deb_ajuste,
	b.nr_seq_esquema_ajuste,
	a.nr_sequencia,
	'Ajuste - Decréscimo' ds_conta_glosa,
	a.nr_seq_atualizacao
from	pls_movimento_contabil		a,
	pls_processo_contas_comp	b
where	a.nr_seq_processo_conta_comp	= b.nr_sequencia
and	ie_conta_glosa	= 'DC'

union all

select	a.ie_status,
	null nr_seq_processo_conta_comp,
	a.nr_seq_processo_conta,
	b.cd_conta_deferido_cred,
	b.cd_conta_deferido_deb,
	b.cd_classif_deferido_cred,
	b.cd_classif_deferido_deb,
	b.nr_seq_esquema_def,
	a.nr_sequencia,
	'Deferido' ds_conta_glosa,
	a.nr_seq_atualizacao
from	pls_movimento_contabil	a,
	pls_processo_conta	b
where	a.nr_seq_processo_conta	= b.nr_sequencia
and	ie_conta_glosa	= 'DF'

union all

select	a.ie_status,
	null nr_seq_processo_conta_comp,
	a.nr_seq_processo_conta,
	b.cd_conta_cred,
	b.cd_conta_deb,
	b.cd_classif_cred,
	b.cd_classif_deb,
	b.nr_seq_esquema_ressarc,
	a.nr_sequencia,
	'Pago' ds_conta_glosa,
	a.nr_seq_atualizacao
from	pls_movimento_contabil	a,
	pls_processo_conta	b
where	a.nr_seq_processo_conta	= b.nr_sequencia
and	ie_conta_glosa	= 'RE';

