-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_conta_pos_cab_v (nr_sequencia, dt_atualizacao, nm_usuario, dt_atualizacao_nrec, nm_usuario_nrec, dt_autorizacao, dt_validade_senha, dt_emissao, ie_tipo_doenca, cd_senha_imp, nr_seq_protocolo, ie_status, vl_procedimentos, vl_diarias, vl_taxas, vl_materiais, vl_medicamentos, vl_gases, vl_total, vl_cobrado, vl_opm, vl_saldo, vl_glosa, nr_seq_guia, vl_coparticipacao, ds_observacao, ie_aborto, ie_atend_rn_sala_parto, ie_baixo_peso, ie_complicacao_neonatal, ie_complicacao_puerperio, nr_seq_grau_partic, ie_gestacao, ie_obito, ie_parto_cesaria, ie_parto_normal, ie_transtorno, ie_tipo_faturamento, nr_seq_prot_conta, cd_estabelecimento, cd_conta_deb, nr_seq_regra_ctb_cred, nr_seq_regra_ctb_deb, cd_conta_cred, cd_historico, cd_conta_glosa_cred, cd_conta_glosa_deb, nr_seq_plano, ie_tipo_plano, ie_tipo_beneficiario, qt_diarias_sip, nr_seq_conta_referencia, vl_pacotes, vl_total_beneficiario, sg_conselho_exec, sg_conselho_solic, cd_ans, cd_cnes, ie_obito_mulher, qt_obito_precoce, qt_obito_tardio, qt_nasc_vivos, qt_nasc_vivos_termo, qt_nasc_mortos, qt_nasc_vivos_prematuros, nr_crm_exec, uf_crm_exec, nr_seq_cbo_saude, ie_tipo_documento, nr_documento, dt_documento, cd_pessoa_fisica, cd_cgc, nr_seq_lote_pgto, nr_seq_competencia, ie_cobranca_prevista, nr_seq_participante, nr_seq_serv_pre_pagto, ie_tipo_conta, ie_estagio_complemento, ds_indicacao_clinica, dt_entrada_uti, dt_saida_uti, dt_cirurgia, vl_pagamento_medico, nr_seq_honorario_crit, nr_seq_prest_pgto_medico, nr_seq_conselho_solic, nr_seq_conselho_exec, ie_glosa, vl_adic_procedimento, vl_adic_co, vl_adic_materiais, ie_exige_autorizacao, vl_liberado_ptu, nr_seq_analise, nm_recem_nascido, dt_nascimento, nr_seq_cbo_saude_solic, ie_tipo_partic_prof, dt_lib_complemento, dt_hora_emissao, nr_seq_atendimento, nr_seq_regra_compl, nr_seq_motivo_cancel, ie_cobranca_previa_servico, ie_tipo_gat, dt_fim_tratamento, ie_status_fat, dt_inicio_consistencia, dt_fim_consistencia, nr_seq_tipo_conta, ie_reabertura_compl, nr_seq_protocolo_origem, nr_seq_regra_conta_auto, dt_inicio_geracao_conta, dt_fim_geracao_conta, cd_guia_pesquisa, cd_guia_ref_pesquisa, cd_guia_prest_pesquisa, cd_doenca_dig, cd_sistema_ant, ie_tipo_acomodacao_ptu, ie_internado, nr_seq_discussao, cd_guia, cd_senha, ie_tipo_guia, nr_seq_clinica, dt_alta, dt_entrada, nr_seq_fatura, cd_excecao, cd_cooperativa, dt_atendimento, nr_seq_segurado, cd_medico_solicitante, cd_medico_executor, ie_indicacao_acidente, ie_carater_internacao, nr_seq_tipo_acomodacao, ie_regime_internacao, nr_seq_prestador, cd_guia_prestador, nr_seq_tipo_atendimento, cd_guia_referencia, nr_seq_saida_consulta, nr_seq_saida_int, nr_seq_saida_spsadt, nr_seq_prestador_exec, ie_tipo_segurado, ie_origem_conta, ie_tipo_consulta, nr_seq_congenere, nr_seq_nota_cobranca, ie_recem_nascido, cd_senha_externa, dt_inicio_faturamento, cd_guia_ok, dt_fechamento_conta, dt_atendimento_referencia, cd_usuario_plano_imp, nr_seq_conta_rec, nr_seq_conta_princ, cd_guia_fat, cd_guia_pos_estab, ie_tipo_segurado_cta, nr_seq_cabecalho, ie_cobertura_especial, ie_regime_atendimento, ie_saude_ocupacional) AS select	a.nr_sequencia,
	a.dt_atualizacao,
	a.nm_usuario,
	a.dt_atualizacao_nrec,
	a.nm_usuario_nrec,
	a.dt_autorizacao,
	a.dt_validade_senha,
	a.dt_emissao,
	a.ie_tipo_doenca,
	a.cd_senha_imp,
	a.nr_seq_protocolo,
	a.ie_status,
	a.vl_procedimentos,
	a.vl_diarias,
	a.vl_taxas,
	a.vl_materiais,
	a.vl_medicamentos,
	a.vl_gases,
	a.vl_total,
	a.vl_cobrado,
	a.vl_opm,
	a.vl_saldo,
	a.vl_glosa,
	a.nr_seq_guia,
	a.vl_coparticipacao,
	a.ds_observacao,
	a.ie_aborto,
	a.ie_atend_rn_sala_parto,
	a.ie_baixo_peso,
	a.ie_complicacao_neonatal,
	a.ie_complicacao_puerperio,
	a.nr_seq_grau_partic,
	a.ie_gestacao,
	a.ie_obito,
	a.ie_parto_cesaria,
	a.ie_parto_normal,
	a.ie_transtorno,
	a.ie_tipo_faturamento,
	a.nr_seq_prot_conta,
	a.cd_estabelecimento,
	a.cd_conta_deb,
	a.nr_seq_regra_ctb_cred,
	a.nr_seq_regra_ctb_deb,
	a.cd_conta_cred,
	a.cd_historico,
	a.cd_conta_glosa_cred,
	a.cd_conta_glosa_deb,
	a.nr_seq_plano,
	a.ie_tipo_plano,
	a.ie_tipo_beneficiario,
	a.qt_diarias_sip,
	a.nr_seq_conta_referencia,
	a.vl_pacotes,
	a.vl_total_beneficiario,
	a.sg_conselho_exec,
	a.sg_conselho_solic,
	a.cd_ans,
	a.cd_cnes,
	a.ie_obito_mulher,
	a.qt_obito_precoce,
	a.qt_obito_tardio,
	a.qt_nasc_vivos,
	a.qt_nasc_vivos_termo,
	a.qt_nasc_mortos,
	a.qt_nasc_vivos_prematuros,
	a.nr_crm_exec,
	a.uf_crm_exec,
	a.nr_seq_cbo_saude,
	a.ie_tipo_documento,
	a.nr_documento,
	a.dt_documento,
	a.cd_pessoa_fisica,
	a.cd_cgc,
	a.nr_seq_lote_pgto,
	a.nr_seq_competencia,
	a.ie_cobranca_prevista,
	a.nr_seq_participante,
	a.nr_seq_serv_pre_pagto,
	a.ie_tipo_conta,
	a.ie_estagio_complemento,
	a.ds_indicacao_clinica,
	a.dt_entrada_uti,
	a.dt_saida_uti,
	a.dt_cirurgia,
	a.vl_pagamento_medico,
	a.nr_seq_honorario_crit,
	a.nr_seq_prest_pgto_medico,
	a.nr_seq_conselho_solic,
	a.nr_seq_conselho_exec,
	a.ie_glosa,
	a.vl_adic_procedimento,
	a.vl_adic_co,
	a.vl_adic_materiais,
	a.ie_exige_autorizacao,
	a.vl_liberado_ptu,
	a.nr_seq_analise,
	a.nm_recem_nascido,
	a.dt_nascimento,
	a.nr_seq_cbo_saude_solic,
	a.ie_tipo_partic_prof,
	a.dt_lib_complemento,
	a.dt_hora_emissao,
	a.nr_seq_atendimento,
	a.nr_seq_regra_compl,
	a.nr_seq_motivo_cancel,
	a.ie_cobranca_previa_servico,
	a.ie_tipo_gat,
	a.dt_fim_tratamento,
	a.ie_status_fat,
	a.dt_inicio_consistencia,
	a.dt_fim_consistencia,
	a.nr_seq_tipo_conta,
	a.ie_reabertura_compl,
	a.nr_seq_protocolo_origem,
	a.nr_seq_regra_conta_auto,
	a.dt_inicio_geracao_conta,
	a.dt_fim_geracao_conta,
	a.cd_guia_pesquisa,
	a.cd_guia_ref_pesquisa,
	a.cd_guia_prest_pesquisa,
	a.cd_doenca_dig,
	a.cd_sistema_ant,
	a.ie_tipo_acomodacao_ptu,
	pls_obter_se_internado(a.nr_sequencia,'X') ie_internado,
	e.nr_seq_discussao,
	e.cd_guia cd_guia,
	e.cd_senha cd_senha,
	e.ie_tipo_guia ie_tipo_guia,
	e.nr_seq_clinica nr_seq_clinica,
	e.dt_alta dt_alta,
	coalesce(e.dt_entrada, a.dt_entrada) dt_entrada,
	e.nr_seq_fatura nr_seq_fatura,
	e.cd_excecao cd_excecao,
	e.cd_cooperativa cd_cooperativa,
	e.dt_atendimento dt_atendimento,
	e.nr_seq_segurado,
	e.cd_medico_solicitante ,
	e.cd_medico_executor,
	e.ie_indicacao_acidente ,
	e.ie_carater_internacao ,
	e.nr_seq_tipo_acomodacao,
	e.ie_regime_internacao ,
	e.nr_seq_prestador ,
	e.cd_guia_prestador ,
	e.nr_seq_tipo_atendimento ,
	e.cd_guia_referencia ,
	e.nr_seq_saida_consulta ,
	e.nr_seq_saida_int ,
	e.nr_seq_saida_spsadt ,
	e.nr_seq_prestador_exec ,
	e.ie_tipo_segurado,
	e.ie_origem_conta ,
	e.ie_tipo_consulta,
	e.nr_seq_congenere ,
	e.nr_seq_nota_cobranca ,
	e.ie_recem_nascido ,
	e.cd_senha_externa ,
	a.dt_inicio_faturamento,
	a.cd_guia_ok,
	a.dt_fechamento_conta,
	a.dt_atendimento_referencia,
	e.cd_usuario_plano_imp,
	e.nr_seq_conta_rec,
	a.nr_seq_conta_princ,
	a.cd_guia_fat,
	a.cd_guia_pos_estab,
	coalesce(e.ie_tipo_segurado,a.ie_tipo_segurado) ie_tipo_segurado_cta,
	e.nr_sequencia nr_seq_cabecalho,
	a.ie_cobertura_especial,
	a.ie_regime_atendimento,
	a.ie_saude_ocupacional
FROM	pls_conta_pos_cabecalho e,
	pls_conta a
where	a.nr_sequencia		= e.nr_seq_conta;

