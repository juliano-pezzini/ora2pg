-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW scs_treinamento_ind_aval_2 (dt_avaliacao, ds_item, vl_med_result, nr_sequencia, nr_seq_item, ds_instrutor, ds_treinamento) AS select  	A.DT_AVALIACAO,
        	c.DS_ITEM,
          ((b.qt_resultado)/(  SELECT    Count(*)
                                      FROM      SAC_PESQUISA X
                                      WHERE     X.NR_SEQ_TIPO_AVALIACAO=1035
                                      AND X.dt_avaliacao = a.dt_avaliacao)) VL_MED_RESULT,
        	A.NR_SEQUENCIA,
          b.nr_seq_item,
        	OBTER_RESULT_SAC(b.nr_seq_pesquisa, 8629) ds_instrutor,
	        OBTER_RESULT_SAC(b.nr_seq_pesquisa, 8627) ds_treinamento
from    	SAC_PESQUISA A,
        	SAC_PESQUISA_RESULT B,
        	MED_ITEM_AVALIAR c
where   	B.NR_SEQ_PESQUISA =  A.NR_SEQUENCIA
AND     	B.NR_SEQ_ITEM = c.NR_SEQUENCIA
AND     	A.NR_SEQ_TIPO_AVALIACAO=1035
and	b.nr_seq_item in (8631,8632,8633,8634,8635,8636,8637,8638,8639);

