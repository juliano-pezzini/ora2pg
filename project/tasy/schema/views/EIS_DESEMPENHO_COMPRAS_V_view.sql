-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_desempenho_compras_v (nr_sequencia, dt_referencia, cd_estabelecimento, dt_atualizacao, nm_usuario, cd_comprador, ie_consignado, cd_local_estoque, qt_solicitacao, cd_centro_custo, qt_cotacao, qt_ordem, qt_hora_proc, vl_ordem, qt_solic_ordem, cd_grupo_material, qt_dia_aprov_proc, qt_dia_ordem_compra, qt_solic_item, qt_cot_item, qt_ordem_item, qt_solic_ordem_item, cd_pessoa_solicitante, nr_ordem_compra, qt_solic_count, ds_local_estoque, ds_centro_custo, ds_grupo_material, ds_consignado, nm_comprador, ds_pessoa_solicitante) AS select	a.nr_sequencia,
	a.dt_referencia,
	cd_estabelecimento,
	dt_atualizacao,
	nm_usuario,
	cd_comprador,
	ie_consignado,
	cd_local_estoque,
	qt_solicitacao,
	cd_centro_custo,
	qt_cotacao,
	qt_ordem,
	qt_hora_proc,
	vl_ordem,
	qt_solic_ordem,
	cd_grupo_material,
	qt_dia_aprov_proc,
	qt_dia_ordem_compra,
	qt_solic_item,
	qt_cot_item,
	qt_ordem_item,
	qt_solic_ordem_item,
	cd_pessoa_solicitante,
	nr_ordem_compra,
	qt_solic_count,
	coalesce(substr(obter_desc_local_estoque(a.cd_local_estoque),1,80), 'Sem local de estoque') ds_local_estoque,
	coalesce(substr(obter_desc_centro_custo(a.cd_centro_custo),1,80),'Sem centro de custo') ds_centro_custo,
	coalesce(substr(obter_desc_grupo_mat(a.cd_grupo_material),1,80),'Sem grupo material') ds_grupo_material,
	substr(obter_valor_dominio(91,a.ie_consignado),1,80) ds_consignado,
	substr(obter_nome_pessoa_fisica(a.cd_comprador, null),1,80) nm_comprador,
	substr(obter_nome_pessoa_fisica(a.cd_pessoa_solicitante, null),1,80) ds_pessoa_solicitante
FROM	eis_desempenho_compras a;

