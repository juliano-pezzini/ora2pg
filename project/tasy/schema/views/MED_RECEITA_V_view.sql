-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW med_receita_v (nr_sequencia, dt_atualizacao, nm_usuario, nr_atendimento, dt_receita, ds_receita, nr_atendimento_hosp, nr_seq_cliente, cd_pessoa_fisica, cd_medico_resp, dt_liberacao) AS SELECT
	A.NR_SEQUENCIA           	,
	A.DT_ATUALIZACAO         	,
	A.NM_USUARIO             	,
	A.NR_ATENDIMENTO         	,
	A.DT_RECEITA             	,
	A.DS_RECEITA             	,
	A.NR_ATENDIMENTO_HOSP	,
	A.NR_SEQ_CLIENTE      	,
	coalesce(A.CD_PESSOA_FISICA, C.CD_PESSOA_FISICA) cd_pessoa_fisica,
	C.CD_MEDICO CD_MEDICO_RESP,
	A.DT_LIBERACAO
FROM	MED_RECEITA A,
	MED_ATENDIMENTO B,
	MED_CLIENTE C
WHERE	A.NR_ATENDIMENTO	= B.NR_ATENDIMENTO
AND	B.NR_SEQ_CLIENTE     = C.NR_SEQUENCIA;

