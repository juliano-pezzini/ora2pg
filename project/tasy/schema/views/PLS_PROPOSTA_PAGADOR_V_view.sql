-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_proposta_pagador_v (nr_sequencia, nr_seq_proposta, dt_atualizacao, nm_usuario, dt_atualizacao_nrec, nm_usuario_nrec, cd_cgc_pagador, cd_pagador, cd_condicao_pagamento, ie_endereco_boleto, dt_dia_vencimento, nr_seq_forma_cobranca, cd_banco, cd_agencia_bancaria, ie_digito_agencia, cd_conta, ie_digito_conta, nr_seq_contrato_pagador, ie_envia_cobranca, nr_seq_pagador_ant, cd_tipo_portador, cd_portador, nr_seq_conta_banco, nr_seq_empresa, cd_profissao, nr_seq_vinculo_empresa, cd_matricula, dt_inicio_vigencia, dt_fim_vigencia, ie_mes_vencimento, nr_seq_compl_pf_tel_adic, nr_seq_dia_vencimento, cd_pessoa, nm_pessoa) AS select	a.NR_SEQUENCIA,a.NR_SEQ_PROPOSTA,a.DT_ATUALIZACAO,a.NM_USUARIO,a.DT_ATUALIZACAO_NREC,a.NM_USUARIO_NREC,a.CD_CGC_PAGADOR,a.CD_PAGADOR,a.CD_CONDICAO_PAGAMENTO,a.IE_ENDERECO_BOLETO,a.DT_DIA_VENCIMENTO,a.NR_SEQ_FORMA_COBRANCA,a.CD_BANCO,a.CD_AGENCIA_BANCARIA,a.IE_DIGITO_AGENCIA,a.CD_CONTA,a.IE_DIGITO_CONTA,a.NR_SEQ_CONTRATO_PAGADOR,a.IE_ENVIA_COBRANCA,a.NR_SEQ_PAGADOR_ANT,a.CD_TIPO_PORTADOR,a.CD_PORTADOR,a.NR_SEQ_CONTA_BANCO,a.NR_SEQ_EMPRESA,a.CD_PROFISSAO,a.NR_SEQ_VINCULO_EMPRESA,a.CD_MATRICULA,a.DT_INICIO_VIGENCIA,a.DT_FIM_VIGENCIA,a.IE_MES_VENCIMENTO,a.NR_SEQ_COMPL_PF_TEL_ADIC,a.NR_SEQ_DIA_VENCIMENTO,
	b.cd_pessoa_fisica cd_pessoa,
	b.nm_pessoa_fisica nm_pessoa
FROM	pessoa_fisica		b,
	pls_proposta_pagador	a
where	a.cd_pagador		= b.cd_pessoa_fisica
and	a.cd_cgc_pagador is null

union

select	a.NR_SEQUENCIA,a.NR_SEQ_PROPOSTA,a.DT_ATUALIZACAO,a.NM_USUARIO,a.DT_ATUALIZACAO_NREC,a.NM_USUARIO_NREC,a.CD_CGC_PAGADOR,a.CD_PAGADOR,a.CD_CONDICAO_PAGAMENTO,a.IE_ENDERECO_BOLETO,a.DT_DIA_VENCIMENTO,a.NR_SEQ_FORMA_COBRANCA,a.CD_BANCO,a.CD_AGENCIA_BANCARIA,a.IE_DIGITO_AGENCIA,a.CD_CONTA,a.IE_DIGITO_CONTA,a.NR_SEQ_CONTRATO_PAGADOR,a.IE_ENVIA_COBRANCA,a.NR_SEQ_PAGADOR_ANT,a.CD_TIPO_PORTADOR,a.CD_PORTADOR,a.NR_SEQ_CONTA_BANCO,a.NR_SEQ_EMPRESA,a.CD_PROFISSAO,a.NR_SEQ_VINCULO_EMPRESA,a.CD_MATRICULA,a.DT_INICIO_VIGENCIA,a.DT_FIM_VIGENCIA,a.IE_MES_VENCIMENTO,a.NR_SEQ_COMPL_PF_TEL_ADIC,a.NR_SEQ_DIA_VENCIMENTO,
	b.cd_cgc cd_pessoa,
	b.ds_razao_social nm_pessoa
from	pessoa_juridica		b,
	pls_proposta_pagador	a
where	a.cd_cgc_pagador	= b.cd_cgc
and	a.cd_cgc_pagador is null;

