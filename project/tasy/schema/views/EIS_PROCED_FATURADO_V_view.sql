-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_proced_faturado_v (dt_contabil, cd_estabelecimento, cd_setor_atendimento, ie_origem_proced, cd_procedimento, ie_periodo, nm_usuario, dt_atualizacao, cd_medico_executor, cd_equipamento, cd_convenio, ie_tipo_atendimento, qt_procedimento, vl_custo_operacional, vl_medico, vl_materiais, vl_anestesita, vl_custo, vl_tabela, vl_receita_vp, qt_dias_prazo, cd_conta_contabil, cd_medico_laudo, nr_seq_proc_interno, cd_medico_req, cd_medico_prescr, ie_complexidade_sus, nr_atendimento, cd_paciente, nm_paciente, cd_tipo_procedimento, ds_setor_atendimento, ds_procedimento, nm_medico_laudo, nm_medico_executor, nm_medico_req, nm_medico_prescr, ds_equipamento, ds_convenio, ds_tipo_atendimento, ds_tipo_procedimento, vl_total, ds_grupo_proc, ds_especialidade, ds_area_procedimento, cd_grupo_proc, cd_especialidade, cd_area_procedimento, ds_proc_interno, ds_procedimento_int, ds_tipo_convenio, cd_tipo_convenio, ds_estabelecimento, ds_complexidade_sus, ds_pac_atend) AS select	a.DT_CONTABIL,a.CD_ESTABELECIMENTO,a.CD_SETOR_ATENDIMENTO,a.IE_ORIGEM_PROCED,a.CD_PROCEDIMENTO,a.IE_PERIODO,a.NM_USUARIO,a.DT_ATUALIZACAO,a.CD_MEDICO_EXECUTOR,a.CD_EQUIPAMENTO,a.CD_CONVENIO,a.IE_TIPO_ATENDIMENTO,a.QT_PROCEDIMENTO,a.VL_CUSTO_OPERACIONAL,a.VL_MEDICO,a.VL_MATERIAIS,a.VL_ANESTESITA,a.VL_CUSTO,a.VL_TABELA,a.VL_RECEITA_VP,a.QT_DIAS_PRAZO,a.CD_CONTA_CONTABIL,a.CD_MEDICO_LAUDO,a.NR_SEQ_PROC_INTERNO,a.CD_MEDICO_REQ,a.CD_MEDICO_PRESCR,a.IE_COMPLEXIDADE_SUS,a.NR_ATENDIMENTO,a.CD_PACIENTE,a.NM_PACIENTE,
	b.cd_tipo_procedimento, 
	obter_nome_setor(a.cd_setor_atendimento) ds_setor_atendimento, 
	substr(b.ds_procedimento, 1, 75) ds_procedimento, 
	obter_nome_pessoa_fisica(a.cd_medico_laudo, null) nm_medico_laudo, 
	obter_nome_pessoa_fisica(a.cd_medico_executor, null) nm_medico_executor, 
	obter_nome_pessoa_fisica(a.cd_medico_req, null) nm_medico_req, 
	obter_nome_pessoa_fisica(a.cd_medico_prescr, null) nm_medico_prescr, 
	Obter_Desc_Equipamento(a.cd_equipamento) ds_equipamento, 
	obter_nome_convenio(a.cd_convenio) ds_convenio, 
	obter_valor_dominio(12, a.ie_tipo_atendimento) ds_tipo_atendimento, 
	obter_valor_dominio(95, b.cd_tipo_procedimento) ds_tipo_procedimento, 
	(a.vl_medico + a.vl_materiais + a.vl_custo_operacional) vl_total, 
	substr(c.ds_grupo_proc,1,75) ds_grupo_proc, 
	substr(c.ds_especialidade,1,75) ds_especialidade, 
	substr(c.ds_area_procedimento,1,75) ds_area_procedimento, 
	c.cd_grupo_proc, 
	c.cd_especialidade, 
	c.cd_area_procedimento, 
   	substr(obter_desc_proc_interno(nr_seq_proc_interno),1,250) ds_proc_interno, 
	substr(ds_proc_interno,1,250) ds_procedimento_int, 
	substr(obter_desc_tipo_convenio(a.cd_convenio),1,250) ds_tipo_convenio, 
	obter_Tipo_Convenio(a.cd_convenio) cd_tipo_convenio, 
	substr(obter_nome_estabelecimento(a.cd_estabelecimento),1,80) ds_estabelecimento, 
	substr(obter_valor_dominio(1763,a.ie_complexidade_sus),1,250) ds_complexidade_sus, 
	nm_paciente || ' - ' || a.nr_atendimento ds_pac_atend 
FROM	procedimento b, 
	eis_Proced_Faturado a, 
	estrutura_procedimento_v c 
where	a.cd_procedimento	= b.cd_procedimento 
and	a.ie_origem_proced	= b.ie_origem_proced 
and	c.cd_procedimento	= b.cd_procedimento 
and	c.ie_origem_proced	= b.ie_origem_proced;

