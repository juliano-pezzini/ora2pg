-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_rouparia_v2 (cd_estabelecimento, dt_referencia, ie_periodo, dt_liberacao, nr_seq_local, nr_seq_operacao, nr_seq_personalizacao, nr_seq_tipo, nr_seq_tamanho, qt_peca_destino, qt_peca_origem, qt_peso_destino, qt_peso_origem, cd_setor, qt_dias_sem_movto, ds_setor, ds_local, ds_personalizacao, ds_tipo, ds_tamanho, ds_operacao) AS select	cd_estabelecimento,
	dt_referencia,
	ie_periodo,
	dt_liberacao,
	nr_seq_local,
	nr_seq_operacao,
	nr_seq_personalizacao,
	nr_seq_tipo,
	nr_seq_tamanho,
	qt_peca_destino,
	qt_peca_origem,
	qt_peso_destino,
	qt_peso_origem,
	cd_setor,
	qt_dias_sem_movto,
	substr(coalesce(obter_nome_setor(cd_setor),'Não informado'),1,100) ds_setor,
	substr(coalesce(rop_obter_dados_local(nr_seq_local,'D'),'Não informado'),1,100) ds_local,
	substr(coalesce(rop_obter_dados_person(nr_seq_personalizacao,'D'),'Não informado'),1,100) ds_personalizacao,
	substr(coalesce(rop_obter_dados_tipo(nr_seq_tipo,'D'),'Não informado'),1,100) ds_tipo,
	substr(coalesce(rop_obter_dados_tamanho(nr_seq_tamanho,'D'),'Não informado'),1,100) ds_tamanho,
	substr(coalesce(rop_obter_dados_operacao(nr_seq_operacao,'D'),'Não informado'),1,100) ds_operacao
FROM	eis_rouparia;

