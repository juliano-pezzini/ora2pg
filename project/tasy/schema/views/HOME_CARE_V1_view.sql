-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW home_care_v1 (qt_reg, cd_estabelecimento, cd_medico_indicou, cd_medico_resp, cd_perfil_ativo, cd_pessoa_fisica, ds_observacao, dt_atualizacao, dt_atualizacao_nrec, dt_final, dt_referencia, ie_classificacao, ie_situacao, nm_usuario, nm_usuario_nrec, nr_atendimento_origem, nr_seq_classificacao, nr_seq_entidade, nr_seq_origem, nr_seq_status_pac, nr_sequencia, qt_km, qt_min_atend, ds_classif_serv, ds_classif_pac, ds_status_pac, ds_origem, ds_entidade, nm_medic_resp, nm_medic_assis, ds_motiv_alta, cd_motivo_alta) AS select	count(*) qt_reg,
		cd_estabelecimento, 
		cd_medico_indicou, 
		cd_medico_resp, 
		cd_perfil_ativo, 
		cd_pessoa_fisica, 
		ds_observacao, 
		dt_atualizacao, 
		dt_atualizacao_nrec, 
		dt_final, 
		dt_inicio dt_referencia, 
		ie_classificacao, 
		ie_situacao, 
		nm_usuario, 
		nm_usuario_nrec, 
		nr_atendimento_origem, 
		nr_seq_classificacao, 
		nr_seq_entidade, 
		nr_seq_origem, 
		nr_seq_status_pac, 
		nr_sequencia, 
		qt_km, 
		qt_min_atend, 
		substr(obter_desc_hc_classif_pac(NR_SEQ_CLASSIFICACAO),1,250) ds_classif_serv, 
	  	substr(obter_desc_hc_classif_serv(IE_CLASSIFICACAO),1,250) DS_CLASSIF_PAC, 
		substr(hc_obter_desc_status_pac(NR_SEQ_STATUS_PAC),1,90) DS_STATUS_PAC, 
		substr(obter_desc_hc_origem(NR_SEQ_ORIGEM),1,250) DS_ORIGEM, 
		substr(obter_desc_hc_entidade(NR_SEQ_ENTIDADE),1,250) DS_ENTIDADE, 
		substr(obter_nome_pf(CD_MEDICO_RESP),1,250) NM_MEDIC_RESP, 
		substr(obter_nome_pf(CD_MEDICO_INDICOU),1,250) nm_medic_assis, 
		substr(Obter_Motivo_Alta_Atend(NR_ATENDIMENTO_ORIGEM),1,80) ds_motiv_alta, 
		substr(Obter_cd_Motivo_Alta_Atend(NR_ATENDIMENTO_ORIGEM),1,80) CD_MOTIVO_ALTA 
FROM 	PACIENTE_HOME_CARE 
where	IE_SITUACAO = 'A' 
group by cd_estabelecimento, 
		cd_medico_indicou, 
		cd_medico_resp, 
		cd_perfil_ativo, 
		cd_pessoa_fisica, 
		ds_observacao, 
		dt_atualizacao, 
		dt_atualizacao_nrec, 
		dt_final, 
		dt_inicio, 
		ie_classificacao, 
		ie_situacao, 
		nm_usuario, 
		nm_usuario_nrec, 
		nr_atendimento_origem, 
		nr_seq_classificacao, 
		nr_seq_entidade, 
		nr_seq_origem, 
		nr_seq_status_pac, 
		nr_sequencia, 
		qt_km, 
		qt_min_atend, 
		NR_SEQ_CLASSIFICACAO, 
	  IE_CLASSIFICACAO, 
		nr_seq_status_pac, 
		NR_SEQ_ORIGEM, 
		NR_SEQ_ENTIDADE, 
		CD_MEDICO_RESP, 
		CD_MEDICO_INDICOU, 
		nr_atendimento_origem;

