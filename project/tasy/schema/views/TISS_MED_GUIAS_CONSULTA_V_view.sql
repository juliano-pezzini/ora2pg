-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW tiss_med_guias_consulta_v (ds_versao, cd_autorizacao, nr_seq_med_prot, nr_atendimento, nr_seq_med_guia, cd_medico_executor, cd_convenio, ie_tiss_tipo_guia, cd_cgc, nr_seq_item, cd_medico) AS select	'2.01.01' ds_versao,
	b.cd_guia cd_autorizacao,
	b.nr_seq_protocolo nr_seq_med_prot,
	b.nr_atendimento,
	b.nr_sequencia nr_seq_med_guia,
	CASE WHEN a.ie_beneficiario='C' THEN  null  ELSE a.cd_medico END  cd_medico_executor,
	a.cd_convenio,
	'3' ie_tiss_tipo_guia,
	CASE WHEN a.ie_beneficiario='C' THEN  a.cd_cgc  ELSE null END  cd_cgc,
	a.nr_seq_item,
	a.cd_medico
FROM 	med_faturamento b,
	med_prot_convenio a
where	a.nr_sequencia	= b.nr_seq_protocolo;

