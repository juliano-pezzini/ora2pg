-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW dpc_report4907_diagnosis_v (nr_sequencia, si_main_c, si_main_d, si_for_hosp_c, si_for_hosp_d, si_most_exp_c, si_most_exp_d, si_sec_most_exp_c, si_sec_most_exp_d, si_com_hosp1_c, si_com_hosp1_d, si_com_hosp2_c, si_com_hosp2_d, si_com_hosp3_c, si_com_hosp3_d, si_com_hosp4_c, si_com_hosp4_d, si_com_hosp5_c, si_com_hosp5_d, si_com_hosp6_c, si_com_hosp6_d, si_com_hosp7_c, si_com_hosp7_d, si_com_hosp8_c, si_com_hosp8_d, si_com_hosp9_c, si_com_hosp9_d, si_com_hosp10_c, si_com_hosp10_d, si_after_admi1_c, si_after_admi1_d, si_after_admi2_c, si_after_admi2_d, si_after_admi3_c, si_after_admi3_d, si_after_admi4_c, si_after_admi4_d, si_after_admi5_c, si_after_admi5_d, si_after_admi6_c, si_after_admi6_d, si_after_admi7_c, si_after_admi7_d, si_after_admi8_c, si_after_admi8_d, si_after_admi9_c, si_after_admi9_d, si_after_admi10_c, si_after_admi10_d) AS select	coalesce(a.nr_sequencia, 0) nr_sequencia,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_MAIN_DISEASE','N'), ' ') si_main_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_MAIN_DISEASE','N')), ' ') si_main_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_REASON_HOSP_DISEASE','N'), ' ') si_for_hosp_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_REASON_HOSP_DISEASE','N')), ' ') si_for_hosp_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_MOST_EXP_DISEASE','N'), ' ') si_most_exp_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_MOST_EXP_DISEASE','N')), ' ') si_most_exp_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_SEC_MOST_EXP_DISEASE','N'), ' ') si_sec_most_exp_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_SEC_MOST_EXP_DISEASE','N')), ' ') si_sec_most_exp_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_1','N'), ' ') si_com_hosp1_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_1','N')), ' ') si_com_hosp1_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_2','N'), ' ') si_com_hosp2_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_2','N')), ' ') si_com_hosp2_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_3','N'), ' ') si_com_hosp3_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_3','N')), ' ') si_com_hosp3_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_4','N'), ' ') si_com_hosp4_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_4','N')), ' ') si_com_hosp4_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_5','N'), ' ') si_com_hosp5_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_5','N')), ' ') si_com_hosp5_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_6','N'), ' ') si_com_hosp6_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_6','N')), ' ') si_com_hosp6_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_7','N'), ' ') si_com_hosp7_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_7','N')), ' ') si_com_hosp7_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_8','N'), ' ') si_com_hosp8_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_8','N')), ' ') si_com_hosp8_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_9','N'), ' ') si_com_hosp9_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_9','N')), ' ') si_com_hosp9_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_10','N'), ' ') si_com_hosp10_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_COMORB_DISEASE_10','N')), ' ') si_com_hosp10_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_1','N'), ' ') si_after_admi1_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_1','N')), ' ') si_after_admi1_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_2','N'), ' ') si_after_admi2_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_2','N')), ' ') si_after_admi2_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_3','N'), ' ') si_after_admi3_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_3','N')), ' ') si_after_admi3_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_4','N'), ' ') si_after_admi4_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_4','N')), ' ') si_after_admi4_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_5','N'), ' ') si_after_admi5_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_5','N')), ' ') si_after_admi5_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_6','N'), ' ') si_after_admi6_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_6','N')), ' ') si_after_admi6_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_7','N'), ' ') si_after_admi7_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_7','N')), ' ') si_after_admi7_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_8','N'), ' ') si_after_admi8_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_8','N')), ' ') si_after_admi8_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_9','N'), ' ') si_after_admi9_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_9','N')), ' ') si_after_admi9_d,
		coalesce(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_10','N'), ' ') si_after_admi10_c,
		coalesce(obter_desc_cid(dpc_pkg.get_value_report4907(a.nr_sequencia,'CD_AFT_ADM_DISEASE_10','N')), ' ') si_after_admi10_d
FROM	patient_dpc_questionnaire a;

