-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW nota_fiscal_prazo_medio_v (nr_sequencia, cd_estabelecimento, cd_cgc_emitente, cd_serie_nf, nr_nota_fiscal, nr_sequencia_nf, qt_dias_prazo) AS select 	b.nr_sequencia,
	b.cd_estabelecimento,
	b.cd_cgc_emitente,
	b.cd_serie_nf,
	b.nr_nota_fiscal,
	b.nr_sequencia_nf,
	dividir(sum(a.vl_vencimento * (a.dt_vencimento - b.dt_emissao )), sum(a.vl_vencimento)) qt_dias_prazo
FROM	nota_fiscal_venc  a,
	nota_fiscal  b
where	a.nr_sequencia	= b.nr_sequencia
group by	b.nr_sequencia,
	b.cd_estabelecimento,
	b.cd_cgc_emitente,
	b.cd_serie_nf,
	b.nr_nota_fiscal,
	b.nr_sequencia_nf;

