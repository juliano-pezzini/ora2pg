-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW rmv_procedimento (codtabelaorigem, codprocorigem, codcirurgia, descorigem) AS select 	substr(CASE WHEN OBTER_VALOR_DOMINIO(30,a.ie_origem_proced)='SUS_2008' THEN 'SUS_08'  ELSE OBTER_VALOR_DOMINIO(30,a.ie_origem_proced) END ,1,6) codtabelaorigem,
	to_char(a.cd_procedimento) codprocorigem,
	to_char(b.nr_cirurgia) codcirurgia,
	a.ds_procedimento descorigem
FROM	procedimento a,
	cirurgia b
where	a.cd_procedimento = b.cd_procedimento_princ;

