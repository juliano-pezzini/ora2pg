-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_plusoft_solic_alteracao_v (nr_seq_solicitacao, ds_status, cd_usuario, nr_seq_alt_campo, ds_atributo, ds_valor_anterior, ds_valor_solicitado, ds_status_campo, cd_pessoa_fisica) AS select 	sa.nr_sequencia	nr_seq_solicitacao,
		substr(obter_valor_dominio((4437), sa.ie_status), 1, 255)					ds_status,
		sa.nm_usuario_nrec										cd_usuario,
		sac.nr_sequencia                                                                             	nr_seq_alt_campo,
		substr(pls_obter_dados_solic_alt(sac.nm_atributo, null, 'S', sac.ds_chave_composta), 1, 255) 	ds_atributo,
		substr(pls_obter_dados_solic_alt(sac.nm_atributo, sac.ds_valor_old, null), 1, 255)           	ds_valor_anterior,
		substr(pls_obter_dados_solic_alt(sac.nm_atributo, sac.ds_valor_new, null), 1, 255)           	ds_valor_solicitado,
		CASE WHEN sac.ie_status='A' THEN  'Aprovado' WHEN sac.ie_status='R' THEN  'Reprovado'  ELSE 'Pendente' END                          	ds_status_campo,
		sa.cd_pessoa_fisica										cd_pessoa_fisica
	FROM 	tasy_solic_alt_campo sac,
		tasy_solic_alteracao sa
	where 	sac.nr_seq_solicitacao = sa.nr_sequencia
	order by
		sac.nr_sequencia;

