-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW contrato_v2 (nr_sequencia, cd_estabelecimento, nr_seq_tipo_contrato, ds_objeto_contrato, ie_renovacao, dt_atualizacao, nm_usuario, ie_situacao, dt_inicio, dt_fim, cd_cgc_contratado, cd_pessoa_contratada, qt_dias_rescisao, cd_contrato, ie_prazo_contrato, nm_contato, cd_pessoa_resp, vl_total_contrato, ds_atribuicao, ie_pagar_receber, cd_pessoa_negoc, dt_revisao, ie_avisa_vencimento, qt_dias_aviso_venc, cd_cargo, ds_motivo_rescisao, nr_seq_forma_rescisao, cd_setor, vl_multa_contratual, cd_condicao_pagamento, ie_avisa_venc_setor, pr_multa_contratual, nr_seq_subtipo_contrato, ie_classificacao, nr_seq_contrato_atual, dt_atualizacao_aditivo, nr_seq_aditivo, qt_dias_interv_aviso, nr_seq_indice_reajuste, nr_seq_area, dt_liberacao, nm_usuario_lib, ie_avisa_reajuste, dt_publicacao, dt_atualizacao_nrec, nm_usuario_nrec, nr_solic_compra, ie_email_origem, cd_operacao_nf, cd_natureza_operacao, dt_assinatura, nm_usuario_assinat, qt_dias_reajuste, telefone_contato, email_contato, cd_pessoa_contratante, cd_cnpj_contratante, vl_custas_contrato, pr_custas_contrato, ds_titulo_contrato, nr_documento_externo, ie_periodo_nf, qt_maximo_nf_periodo, qt_dias_revisao, vl_negociado, nr_seq_contrato_gestao, nr_cpf_contato, qt_dias_periodo, ie_estagio, dt_encerramento, nm_usuario_encer, ds_observacao, nr_seq_errata, nr_seq_pendencia, ie_finalizado, dt_finalizado, nm_usuario_finaliz, ie_sla, ie_enviar_email_oc, cd_medico_resp, vl_fatur_minimo, nr_seq_cliente, nm_medico_externo, ie_indice_reajuste, cd_paciente, cd_moeda_estrangeira, cd_comprador, dt_assinatura_orig, nm_usuario_assinat_orig, ie_somente_oc_pagto, ie_sistema_amort, vl_taxa_banco_contrat, ds_indexador, nr_ddi_telefone, ds_objeto, ds_contratado, nr_cnpj_cpf, ds_pessoa_fisica, ds_cpf) AS select	a.NR_SEQUENCIA,a.CD_ESTABELECIMENTO,a.NR_SEQ_TIPO_CONTRATO,a.DS_OBJETO_CONTRATO,a.IE_RENOVACAO,a.DT_ATUALIZACAO,a.NM_USUARIO,a.IE_SITUACAO,a.DT_INICIO,a.DT_FIM,a.CD_CGC_CONTRATADO,a.CD_PESSOA_CONTRATADA,a.QT_DIAS_RESCISAO,a.CD_CONTRATO,a.IE_PRAZO_CONTRATO,a.NM_CONTATO,a.CD_PESSOA_RESP,a.VL_TOTAL_CONTRATO,a.DS_ATRIBUICAO,a.IE_PAGAR_RECEBER,a.CD_PESSOA_NEGOC,a.DT_REVISAO,a.IE_AVISA_VENCIMENTO,a.QT_DIAS_AVISO_VENC,a.CD_CARGO,a.DS_MOTIVO_RESCISAO,a.NR_SEQ_FORMA_RESCISAO,a.CD_SETOR,a.VL_MULTA_CONTRATUAL,a.CD_CONDICAO_PAGAMENTO,a.IE_AVISA_VENC_SETOR,a.PR_MULTA_CONTRATUAL,a.NR_SEQ_SUBTIPO_CONTRATO,a.IE_CLASSIFICACAO,a.NR_SEQ_CONTRATO_ATUAL,a.DT_ATUALIZACAO_ADITIVO,a.NR_SEQ_ADITIVO,a.QT_DIAS_INTERV_AVISO,a.NR_SEQ_INDICE_REAJUSTE,a.NR_SEQ_AREA,a.DT_LIBERACAO,a.NM_USUARIO_LIB,a.IE_AVISA_REAJUSTE,a.DT_PUBLICACAO,a.DT_ATUALIZACAO_NREC,a.NM_USUARIO_NREC,a.NR_SOLIC_COMPRA,a.IE_EMAIL_ORIGEM,a.CD_OPERACAO_NF,a.CD_NATUREZA_OPERACAO,a.DT_ASSINATURA,a.NM_USUARIO_ASSINAT,a.QT_DIAS_REAJUSTE,a.TELEFONE_CONTATO,a.EMAIL_CONTATO,a.CD_PESSOA_CONTRATANTE,a.CD_CNPJ_CONTRATANTE,a.VL_CUSTAS_CONTRATO,a.PR_CUSTAS_CONTRATO,a.DS_TITULO_CONTRATO,a.NR_DOCUMENTO_EXTERNO,a.IE_PERIODO_NF,a.QT_MAXIMO_NF_PERIODO,a.QT_DIAS_REVISAO,a.VL_NEGOCIADO,a.NR_SEQ_CONTRATO_GESTAO,a.NR_CPF_CONTATO,a.QT_DIAS_PERIODO,a.IE_ESTAGIO,a.DT_ENCERRAMENTO,a.NM_USUARIO_ENCER,a.DS_OBSERVACAO,a.NR_SEQ_ERRATA,a.NR_SEQ_PENDENCIA,a.IE_FINALIZADO,a.DT_FINALIZADO,a.NM_USUARIO_FINALIZ,a.IE_SLA,a.IE_ENVIAR_EMAIL_OC,a.CD_MEDICO_RESP,a.VL_FATUR_MINIMO,a.NR_SEQ_CLIENTE,a.NM_MEDICO_EXTERNO,a.IE_INDICE_REAJUSTE,a.CD_PACIENTE,a.CD_MOEDA_ESTRANGEIRA,a.CD_COMPRADOR,a.DT_ASSINATURA_ORIG,a.NM_USUARIO_ASSINAT_ORIG,a.IE_SOMENTE_OC_PAGTO,a.IE_SISTEMA_AMORT,a.VL_TAXA_BANCO_CONTRAT,a.DS_INDEXADOR,a.NR_DDI_TELEFONE,
	substr(a.ds_objeto_contrato,1,255) ds_objeto,
	substr(obter_descricao_contrato(a.nr_sequencia),1,255) ds_contratado,
	substr(coalesce(a.cd_cgc_contratado, obter_cpf_pessoa_fisica(a.cd_pessoa_contratada)),1,20) nr_cnpj_cpf,
	substr(obter_dados_pf_pj(cd_pessoa_contratada, null, 'N'),1,255) ds_pessoa_fisica,
	substr(obter_dados_pf_pj(cd_pessoa_contratada, null, 'C'),1,100) ds_cpf
FROM	contrato a;

