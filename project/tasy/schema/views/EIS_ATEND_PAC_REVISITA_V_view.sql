-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_atend_pac_revisita_v (nr_atendimento, cd_pessoa_fisica, cd_medico_resp, nr_atend_original, dt_alta_interno, dt_alta, cd_estabelecimento, ie_origem, ie_com_alta, nm_paciente, nm_medico, nm_estabelecimento, dt_atend_original, dt_atualizacao, dt_inicio_atendimento, dt_atualizacao_nrec) AS SELECT A.NR_ATENDIMENTO,
	 A.CD_PESSOA_FISICA,
	 A.CD_MEDICO_RESP,
	 A.NR_ATEND_ORIGINAL,
	 A.DT_ALTA_INTERNO,
	 A.DT_ALTA,
	 A.CD_ESTABELECIMENTO,
	 CASE WHEN A.NR_ATEND_ORIGINAL IS NULL THEN obter_desc_expressao(928857)  ELSE obter_desc_expressao(928855) END  IE_ORIGEM,
	 CASE WHEN A.DT_ALTA IS NULL THEN 'N'  ELSE 'S' END  IE_COM_ALTA,
	 SUBSTR(OBTER_NOME_PF(A.CD_PESSOA_FISICA), 1, 255) NM_PACIENTE,
	 SUBSTR(OBTER_NOME_PF(A.CD_MEDICO_RESP),1,255) NM_MEDICO,
	 SUBSTR(OBTER_NOME_ESTABELECIMENTO(A.CD_ESTABELECIMENTO),1,255) NM_ESTABELECIMENTO,
	 A.DT_ATEND_ORIGINAL,
	 A.DT_ATUALIZACAO,
	 A.DT_INICIO_ATENDIMENTO,
	 A.DT_ATUALIZACAO_NREC
	FROM ATENDIMENTO_PACIENTE A;

