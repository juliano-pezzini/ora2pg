-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW homologacao_migracao_v (nr_seq_projeto, ds_projeto, nr_seq_os_projeto, nr_seq_os_homolog, dt_os, nm_usuario_homolog, dt_homolog, ie_tipo_homolog, cd_funcao, nr_seq_os) AS select	p.nr_sequencia nr_seq_projeto,
	p.ds_titulo ds_projeto,
	o.nr_seq_origem nr_seq_os_projeto,
	o.nr_sequencia nr_seq_os_homolog,
	o.dt_ordem_servico dt_os,
	t.nm_usuario_lib nm_usuario_homolog,
	t.dt_liberacao dt_homolog,
	CASE WHEN t.nr_seq_tipo=47 THEN 'T'  ELSE 'P' END  ie_tipo_homolog,
	o.cd_funcao,
	o.nr_sequencia nr_seq_os
FROM	man_ordem_serv_tecnico t,
	man_ordem_servico o,
	proj_ordem_servico r,
	proj_projeto p
where	t.nr_seq_ordem_serv = o.nr_sequencia
and	t.nr_seq_tipo in (47,70)
and	t.dt_liberacao is not null
and	o.nr_sequencia = r.nr_seq_ordem
and	r.nr_seq_proj = p.nr_sequencia
and	r.ie_tipo_ordem = 'T'
and	p.nr_seq_gerencia = 9
and	p.nr_seq_classif = 14;

