-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW contas_partic_sem_titulo_v (nr_atendimento, nm_pessoa_fisica, nr_interno_conta, dt_entrada, dt_alta, ds_status, ie_protocolo, ie_tipo_atendimento, ds_tipo_atendimento) AS select	c.nr_atendimento,
    	p.nm_pessoa_fisica, 
    c.nr_interno_conta, 
    a.dt_entrada, 
    a.dt_alta, 
    obter_valor_dominio(49,c.ie_status_acerto) ds_status, 
	obter_nivel_prot(c.nr_interno_conta) ie_protocolo, 
	a.ie_tipo_atendimento, 
	substr(obter_valor_dominio(12, a.ie_tipo_atendimento),1,200) ds_tipo_atendimento 
FROM 	pessoa_fisica p, 
    convenio o, 
    conta_paciente c, 
    atendimento_paciente a 
where 	o.ie_tipo_convenio = 1 
and 	c.ie_cancelamento is null 
and 	obter_titulo_conta_protocolo(0, c.nr_interno_conta) is null 
and 	a.nr_atendimento = c.nr_atendimento 
AND 	o.cd_convenio = c.cd_convenio_parametro 
and 	a.cd_pessoa_fisica = p.cd_pessoa_fisica;

