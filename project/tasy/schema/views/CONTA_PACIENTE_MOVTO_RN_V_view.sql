-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW conta_paciente_movto_rn_v (ie_emite_conta, nr_atendimento, nr_sequencia, cd_setor_atendimento, cd_unidade_basica, cd_unidade_compl, cd_unidade, dt_entrada_unidade, cd_tipo_acomodacao, dt_saida_unidade, nr_atend_dia, ds_observacao, nm_usuario_original, dt_saida_interno, ie_passagem_setor, nr_acompanhante, nr_seq_interno, ds_setor_atendimento, nm_unidade, cd_classif_setor, ds_classif_setor, ds_tipo_acomodacao, nr_interno_conta) AS select	'222' ie_emite_conta,
	a.nr_atendimento,
	a.nr_sequencia,
	a.cd_setor_atendimento,
	a.cd_unidade_basica,
	a.cd_unidade_compl,
	(a.cd_unidade_basica || '/' || a.cd_unidade_compl) cd_unidade,
	a.dt_entrada_unidade,
	a.cd_tipo_acomodacao,
	a.dt_saida_unidade,
	a.nr_atend_dia,
	a.ds_observacao,
	a.nm_usuario_original,
	a.dt_saida_interno,
	a.ie_passagem_setor,
	a.nr_acompanhante,
	a.nr_seq_interno,
	b.ds_setor_atendimento,
	(b.nm_unidade_basica || '/'||b.nm_unidade_compl)   nm_unidade,
	b.cd_classif_setor,
	obter_valor_dominio(1,b.cd_classif_setor) ds_classif_setor,
	c.ds_tipo_acomodacao,
	d.nr_interno_conta
FROM	tipo_acomodacao c,
	setor_atendimento b,
	atend_paciente_unidade a,
	atendimento_paciente e,
	conta_paciente d
where 	a.cd_setor_atendimento = b.cd_setor_atendimento
and 	a.cd_tipo_acomodacao   = c.cd_tipo_acomodacao
and 	e.nr_atendimento_mae = d.nr_atendimento
and 	a.nr_atendimento = e.nr_atendimento;

