-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW fis_tipo_correcao_rel_v (nr_seq_nota_fiscal, razao_social, endereco, municipio, estado, cnpj, insc_esta, natureza, cod_fiscal, transporte, emissao, data_saida, unidade, quantidade, desc_serv, preco_unitario, valor_prod, clas_fis, aliq_ipi, valor_ipi, base_ipi, vl_total_nota, valor_extenso, valor_icms, base_icms, nm_transp, end_transp, isen_ipi, isen_icms, peso, volume, rasura, vencimento, historico, periodo, base_iss, valor_iss, observacao, obsnota, frete) AS select	distinct
	a.nr_seq_nota_fiscal,
	substr(fis_obter_tipo_correcao(1,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)razao_social,
	substr(fis_obter_tipo_correcao(2,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)endereco,
	substr(fis_obter_tipo_correcao(3,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)municipio,
	substr(fis_obter_tipo_correcao(4,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)estado,
	substr(fis_obter_tipo_correcao(5,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)cnpj,
	substr(fis_obter_tipo_correcao(6,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)insc_esta,
	substr(fis_obter_tipo_correcao(7,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)natureza,
	substr(fis_obter_tipo_correcao(8,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)cod_fiscal,
	substr(fis_obter_tipo_correcao(9,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)transporte,
	substr(fis_obter_tipo_correcao(10,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)emissao,
	substr(fis_obter_tipo_correcao(11,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)data_saida,
	substr(fis_obter_tipo_correcao(12,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)unidade,
	substr(fis_obter_tipo_correcao(13,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)quantidade,
	substr(fis_obter_tipo_correcao(14,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)desc_serv,
	substr(fis_obter_tipo_correcao(15,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)preco_unitario,
	substr(fis_obter_tipo_correcao(16,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)valor_prod,
	substr(fis_obter_tipo_correcao(17,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)clas_fis,
	substr(fis_obter_tipo_correcao(18,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)aliq_ipi,
	substr(fis_obter_tipo_correcao(19,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)valor_ipi,
	substr(fis_obter_tipo_correcao(20,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)base_ipi,
	substr(fis_obter_tipo_correcao(21,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)vl_total_nota,
	substr(fis_obter_tipo_correcao(22,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)valor_extenso,
	substr(fis_obter_tipo_correcao(23,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)valor_icms,
	substr(fis_obter_tipo_correcao(24,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)base_icms,
	substr(fis_obter_tipo_correcao(25,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)nm_transp,
	substr(fis_obter_tipo_correcao(26,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)end_transp,
	substr(fis_obter_tipo_correcao(27,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)isen_ipi,
	substr(fis_obter_tipo_correcao(28,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)isen_icms,
	substr(fis_obter_tipo_correcao(29,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)peso,
	substr(fis_obter_tipo_correcao(30,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)volume,
	substr(fis_obter_tipo_correcao(31,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)rasura,
	substr(fis_obter_tipo_correcao(32,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)vencimento,
	substr(fis_obter_tipo_correcao(33,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)historico,
	substr(fis_obter_tipo_correcao(34,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)periodo,
	substr(fis_obter_tipo_correcao(35,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)base_iss,
	substr(fis_obter_tipo_correcao(36,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)valor_iss,
	substr(fis_obter_tipo_correcao(37,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)observacao,
	substr(fis_obter_tipo_correcao(40,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)obsnota,
	substr(fis_obter_tipo_correcao(44,a.nr_seq_nota_fiscal,to_char(dt_liberacao,'dd/mm/yyyy')),1,5)frete
FROM	fis_carta_correcao a
where	a.dt_liberacao = (select max(b.dt_liberacao) from fis_carta_correcao b where a.nr_seq_nota_fiscal = b.nr_seq_nota_fiscal);

