-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_servico_v (nr_seq_servico, tp_registro, nr_sequencia, nr_seq_geracao, id_benef, cd_tipo_registro, cd_unimed_destino, cd_unimed_origem, dt_geracao, dt_inicial_pagto, dt_final_pagto, nr_versao_transacao, nr_lote, nr_nota, reservado_1, cd_unimed, reservado_2, cd_usuario_plano, nm_benef, dt_atend, reservado_3, cd_excecao, tp_carater_atend, reservado_4, reservado_5, cd_cid, reservado_6, tp_paciente, tp_saida_cons_sadt, tp_atendimento, nr_guia_principal, nr_lote_703, nr_nota_703, cd_uni_hosp, cd_hosp, nm_hosp, tp_acomodacao, dt_internacao, dt_alta, ft_mult_amb, tp_ind_acidente, tp_saida, cgc_hospital, tp_internacao, qt_nasc_vivos, qt_nasc_mortos, qt_nasc_vivos_pre, qt_obito_precoce, qt_obito_tardio, id_int_obstetricia_1, id_int_obstetricia_2, id_int_obstetricia_3, id_int_obstetricia_4, id_int_obstetricia_5, id_int_obstetricia_6, id_int_obstetricia_7, id_int_obstetricia_8, id_int_obstetricia_9, tp_faturamento, cd_cid_obito, nr_declara_vivo_1, nr_declara_vivo_2, nr_declara_vivo_3, nr_declara_vivo_4, nr_declara_vivo_5, ie_obito_mulher, nr_declara_obito, cd_cid_obito_1, cd_cid_obito_2, cd_cid_obito_3, cd_cid_obito_4, cd_cid_obito_5, nr_declara_obito_1, nr_declara_obito_2, nr_declara_obito_3, nr_declara_obito_4, nr_declara_obito_5, nr_lote_704, nr_nota_704, id_copartic, cd_uni_pre, cd_prest, nm_prest, tp_particip, dt_servico, dt_pagamento, tp_tabela, cd_servico, qt_paga, vl_serv_pag, vl_co_pag, vl_filme_pag, cd_porte_ane, cd_unimed_autorizadora, reservado_7, reservado_8, cd_uni_pre_req, cd_pre_req, cd_via_acesso, reservado_9, reservado_10, reservado_11, vl_adic_procedimento, vl_adic_co, vl_adic_filme, cd_espec, tp_prest_exec, id_rec_proprio, tp_pessoa, nr_cnpj_cpf, id_pacote, cd_ato, fat_mult_serv, nr_seq_nota, hr_realiz, cd_cnes_prest, nm_prof_prest, sg_cons_prof_prest, nr_cons_prof_prest, sg_uf_cons_prest, reservado_12, nr_cnpj_cpf_req, nm_prest_req, sg_cons_prof_req, nr_cons_prof_req, sg_uf_cons_req, id_reembolso, nr_autorizacao, nr_lote_705, nr_nota_705, tp_reg_cpl, ie_tipo_complemento, nm_desc_cpl, nr_nota_fiscal, ds_link_nfe, qt_tot_r702, qt_tot_r703, qt_tot_r704, qt_tot_r705, qt_tot_serv, vl_tot_serv, reservado) AS select	/*+ USE_CONCAT*/	nr_sequencia		nr_seq_servico,
	1			tp_registro,
	1			nr_sequencia,
	nr_seq_geracao		nr_seq_geracao,
	null			id_benef,
	'701'			cd_tipo_registro,
	cd_unimed_destino	cd_unimed_destino,
	cd_unimed_origem	cd_unimed_origem,
	dt_geracao		dt_geracao,
	dt_inicio_pagto		dt_inicial_pagto,
	dt_fim_pagto		dt_final_pagto,
	nr_versao_transacao	nr_versao_transacao,
	0			nr_lote,
	'0'			nr_nota,
	' '			reservado_1,
	null			cd_unimed,
	' '			reservado_2,
	null			cd_usuario_plano,
	null			nm_benef,
	null			dt_atend,
	' '			reservado_3,
	null			cd_excecao,
	null			tp_carater_atend,
	' '			reservado_4,
	' '			reservado_5,
	null			cd_cid,
	' '			reservado_6,
	null			tp_paciente,
	null			tp_saida_cons_sadt,
	null			tp_atendimento,
	null			nr_guia_principal,
	null			nr_lote_703,
	null			nr_nota_703,
	null			cd_uni_hosp,
	null			cd_hosp,
	null			nm_hosp,
	null			tp_acomodacao,
	null			dt_internacao,
	null			dt_alta,
	null			ft_mult_amb,
	null			tp_ind_acidente,
	null			tp_saida,
	null			cgc_hospital,
	null			tp_internacao,
	null			qt_nasc_vivos,
	null			qt_nasc_mortos,
	null			qt_nasc_vivos_pre,
	null			qt_obito_precoce,
	null			qt_obito_tardio,
	null			id_int_obstetricia_1,
	null			id_int_obstetricia_2,
	null			id_int_obstetricia_3,
	null			id_int_obstetricia_4,
	null			id_int_obstetricia_5,
	null			id_int_obstetricia_6,
	null			id_int_obstetricia_7,
	null			id_int_obstetricia_8,
	null			id_int_obstetricia_9,
	null			tp_faturamento,
	null			cd_cid_obito,
	null			nr_declara_vivo_1,
	null			nr_declara_vivo_2,
	null			nr_declara_vivo_3,
	null			nr_declara_vivo_4,
	null			nr_declara_vivo_5,
	null			ie_obito_mulher,
	null			nr_declara_obito,
	null			cd_cid_obito_1,
	null			cd_cid_obito_2,
	null			cd_cid_obito_3,
	null			cd_cid_obito_4,
	null			cd_cid_obito_5,
	null			nr_declara_obito_1,
	null			nr_declara_obito_2,
	null			nr_declara_obito_3,
	null			nr_declara_obito_4,
	null			nr_declara_obito_5,
	null			nr_lote_704,
	null			nr_nota_704,
	null			id_copartic,
	null			cd_uni_pre,
	null			cd_prest,
	null			nm_prest,
	null			tp_particip,
	null			dt_servico,
	null			dt_pagamento,
	null			tp_tabela,
	null			cd_servico,
	null			qt_paga,
	0			vl_serv_pag,
	0			vl_co_pag,
	0			vl_filme_pag,
	null			cd_porte_ane,
	null			cd_unimed_autorizadora,
	' ' 			reservado_7,
	' '			reservado_8,
	null			cd_uni_pre_req,
	null			cd_pre_req,
	null			cd_via_acesso,
	' '			reservado_9,
	' '			reservado_10,
	' '			reservado_11,
	null			vl_adic_procedimento,
	null			vl_adic_co,
	null			vl_adic_filme,
	null			cd_espec,
	null			tp_prest_exec,
	null			id_rec_proprio,
	null			tp_pessoa,
	null			nr_cnpj_cpf,
	null			id_pacote,
	null			cd_ato,
	null			fat_mult_serv,
	null			nr_seq_nota,
	null			hr_realiz,
	null			cd_cnes_prest,
	null			nm_prof_prest,
	null			sg_cons_prof_prest,
	null			nr_cons_prof_prest,
	null			sg_uf_cons_prest,
	' '			reservado_12,
	null			nr_cnpj_cpf_req,
	null			nm_prest_req,
	null			sg_cons_prof_req,
	null			nr_cons_prof_req,
	null			sg_uf_cons_req,
	null			id_reembolso,
	null			nr_autorizacao,
	null			nr_lote_705,
	null			nr_nota_705,
	null			tp_reg_cpl,
	null			ie_tipo_complemento,
	null			nm_desc_cpl,
	null			nr_nota_fiscal,
	null			ds_link_nfe,
	null			qt_tot_r702,
	null			qt_tot_r703,
	null			qt_tot_r704,
	null			qt_tot_r705,
	null			qt_tot_serv,
	null			vl_tot_serv,
	null	reservado
FROM	ptu_servico_pre_pagto

union

select	nr_seq_serv_pre_pagto	nr_seq_servico,
	2			tp_registro,
	2			nr_sequencia,
	null			nr_seq_geracao,
	cd_usuario_plano	id_benef,
	'702'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			dt_inicial_pagto,
	null			dt_final_pagto,
	null			nr_versao_transacao,
	nr_lote			nr_lote,
	nr_nota			nr_nota,
	' '			reservado_1,
	cd_unimed		cd_unimed,
	' '			reservado_2,
	cd_usuario_plano	cd_usuario_plano,
	nm_beneficiario		nm_benef,
	dt_atendimento		dt_atend,
	' '			reservado_3,
	cd_excecao		cd_excecao,
	ie_carater_atendimento	tp_carater_atend,
	' '			reservado_4,
	' '			reservado_5,
	cd_cid			cd_cid,
	' '			reservado_6,
	ie_paciente		tp_paciente,
	ie_tipo_saida_spdat	tp_saida_cons_sadt,
	ie_tipo_atendimento	tp_atendimento,
	nr_guia_principal	nr_guia_principal,
	null			nr_lote_703,
	null			nr_nota_703,
	null			cd_uni_hosp,
	null			cd_hosp,
	null			nm_hosp,
	null			ie_tipo_acomodacao,
	null			dt_internacao,
	null			dt_alta,
	null			ft_mult_amb,
	null			tp_ind_acidente,
	null			tp_saida,
	null			cgc_hospital,
	null			tp_internacao,
	null			qt_nasc_vivos,
	null			qt_nasc_mortos,
	null			qt_nasc_vivos_pre,
	null			qt_obito_precoce,
	null			qt_obito_tardio,
	null			id_int_obstetricia_1,
	null			id_int_obstetricia_2,
	null			id_int_obstetricia_3,
	null			id_int_obstetricia_4,
	null			id_int_obstetricia_5,
	null			id_int_obstetricia_6,
	null			id_int_obstetricia_7,
	null			id_int_obstetricia_8,
	null			id_int_obstetricia_9,
	null			tp_faturamento,
	null			cd_cid_obito,
	null			nr_declara_vivo_1,
	null			nr_declara_vivo_2,
	null			nr_declara_vivo_3,
	null			nr_declara_vivo_4,
	null			nr_declara_vivo_5,
	null			ie_obito_mulher,
	null			nr_declara_obito,
	null			cd_cid_obito_1,
	null			cd_cid_obito_2,
	null			cd_cid_obito_3,
	null			cd_cid_obito_4,
	null			cd_cid_obito_5,
	null			nr_declara_obito_1,
	null			nr_declara_obito_2,
	null			nr_declara_obito_3,
	null			nr_declara_obito_4,
	null			nr_declara_obito_5,
	null			nr_lote_704,
	null			nr_nota_704,
	null			id_copartic,
	null			cd_uni_pre,
	null			cd_prest,
	null			nm_prest,
	null			tp_particip,
	null			dt_servico,
	null			dt_pagamento,
	null			tp_tabela,
	null			cd_servico,
	null			qt_paga,
	0			vl_serv_pag,
	0			vl_co_pag,
	0			vl_filme_pag,
	null			cd_porte_ane,
	null			cd_unimed_autorizadora,
	' ' 			reservado_7,
	' '			reservado_8,
	null			cd_uni_pre_req,
	null			cd_pre_req,
	null			cd_via_acesso,
	' '			reservado_9,
	' '			reservado_10,
	' '			reservado_11,
	null			vl_adic_procedimento,
	null			vl_adic_co,
	null			vl_adic_filme,
	null			cd_espec,
	null			tp_prest_exec,
	null			id_rec_proprio,
	null			tp_pessoa,
	null			nr_cnpj_cpf,
	null			id_pacote,
	null			cd_ato,
	null			fat_mult_serv,
	null			nr_seq_nota,
	null			hr_realiz,
	null			cd_cnes_prest,
	null			nm_prof_prest,
	null			sg_cons_prof_prest,
	null			nr_cons_prof_prest,
	null			sg_uf_cons_prest,
	' '			reservado_12,
	null			nr_cnpj_cpf_req,
	null			nm_prest_req,
	null			sg_cons_prof_req,
	null			nr_cons_prof_req,
	null			sg_uf_cons_req,
	null			id_reembolso,
	null			nr_autorizacao,
	null			nr_lote_705,
	null			nr_nota_705,
	null			tp_reg_cpl,
	null			ie_tipo_complemento,
	null			nm_desc_cpl,
	null			nr_nota_fiscal,
	null			ds_link_nfe,
	null			qt_tot_r702,
	null			qt_tot_r703,
	null			qt_tot_r704,
	null			qt_tot_r705,
	null			qt_tot_serv,
	null			vl_tot_serv,
	null	reservado
from	ptu_nota_cobranca

union

select distinct	c.nr_seq_serv_pre_pagto		nr_seq_servico,
	3			tp_registro,
	3			nr_sequencia,
	null			nr_seq_geracao,
	null			id_benef,
	'703'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			dt_inicial_pagto,
	null			dt_final_pagto,
	null			nr_versao_transacao,
	c.nr_lote		nr_lote,
	c.nr_nota		nr_nota,
	' '			reservado_1,
	null			cd_unimed,
	' '			reservado_2,
	null			cd_usuario_plano,
	null			nm_benef,
	null			dt_atend,
	' '			reservado_3,
	null			cd_excecao,
	null			tp_carater_atend,
	' '			reservado_4,
	' '			reservado_5,
	null			cd_cid,
	' '			reservado_6,
	null			tp_paciente,
	null			tp_saida_cons_sadt,
	null			tp_atendimento,
	null			nr_guia_principal,
	a.nr_lote			nr_lote_703,
	a.nr_nota			nr_nota_703,
	a.cd_unimed_hospital	cd_uni_hosp,
	a.cd_hospital		cd_hosp,
	a.nm_hospital		nm_hosp,
	a.ie_tipo_acomodacao	tp_acomodacao,
	a.dt_internacao		dt_internacao,
	a.dt_alta		dt_alta,
	a.tx_mult_amb		ft_mult_amb,
	a.ie_ind_acidente	ie_ind_acidente,
	a.cd_motivo_saida	tp_saida,
	a.cd_cgc_hospital	cgc_hospital,
	a.ie_tipo_internacao	tp_internacao,
	a.qt_nasc_vivos		qt_nasc_vivos,
	a.qt_nasc_mortos	qt_nasc_mortos,
	a.qt_nasc_vivos_pre	qt_nasc_vivos_pre,
	a.qt_obito_precoce	qt_obito_precoce,
	a.qt_obito_tardio	qt_obito_tardio,
	coalesce(a.ie_int_gestacao,'N')	id_int_obstetricia_1,
	coalesce(a.ie_int_aborto,'N')		id_int_obstetricia_2,
	coalesce(a.ie_int_transtorno,'N')	id_int_obstetricia_3,
	coalesce(a.ie_int_puerperio,'N')	id_int_obstetricia_4,
	coalesce(a.ie_int_recem_nascido,'N')	id_int_obstetricia_5,
	coalesce(a.ie_int_neonatal,'N')	id_int_obstetricia_6,
	coalesce(a.ie_int_baixo_peso,'N')	id_int_obstetricia_7,
	coalesce(a.ie_int_parto_cesarea,'N')	id_int_obstetricia_8,
	coalesce(a.ie_int_parto_normal,'N')	id_int_obstetricia_9,
	a.ie_faturamento	tp_faturamento,
	a.cd_cid_obito		cd_cid_obito,
	b.nr_declara_vivo	nr_declara_vivo_1,
	b.nr_declara_vivo	nr_declara_vivo_2,
	b.nr_declara_vivo	nr_declara_vivo_3,
	b.nr_declara_vivo	nr_declara_vivo_4,
	b.nr_declara_vivo	nr_declara_vivo_5,
	a.ie_obito_mulher	ie_obito_mulher,
	a.nr_declara_obito	nr_declara_obito,
	b.cd_cid_obito		cd_cid_obito_1,
	b.cd_cid_obito		cd_cid_obito_2,
	b.cd_cid_obito		cd_cid_obito_3,
	b.cd_cid_obito		cd_cid_obito_4,
	b.cd_cid_obito		cd_cid_obito_5,
	b.nr_declara_obito	nr_declara_obito_1,
	b.nr_declara_obito	nr_declara_obito_2,
	b.nr_declara_obito	nr_declara_obito_3,
	b.nr_declara_obito	nr_declara_obito_4,
	b.nr_declara_obito	nr_declara_obito_5,
	null			nr_lote_704,
	null			nr_nota_704,
	null			id_copartic,
	null			cd_uni_pre,
	null			cd_prest,
	null			nm_prest,
	null			tp_particip,
	null			dt_servico,
	null			dt_pagamento,
	null			tp_tabela,
	null			cd_servico,
	null			qt_paga,
	0			vl_serv_pag,
	0			vl_co_pag,
	0			vl_filme_pag,
	null			cd_porte_ane,
	null			cd_unimed_autorizadora,
	' ' 			reservado_7,
	' '			reservado_8,
	null			cd_uni_pre_req,
	null			cd_pre_req,
	null			cd_via_acesso,
	' '			reservado_9,
	' '			reservado_10,
	' '			reservado_11,
	null			vl_adic_procedimento,
	null			vl_adic_co,
	null			vl_adic_filme,
	null			cd_espec,
	null			tp_prest_exec,
	null			id_rec_proprio,
	null			tp_pessoa,
	null			nr_cnpj_cpf,
	null			id_pacote,
	null			cd_ato,
	null			fat_mult_serv,
	null			nr_seq_nota,
	null			hr_realiz,
	null			cd_cnes_prest,
	null			nm_prof_prest,
	null			sg_cons_prof_prest,
	null			nr_cons_prof_prest,
	null			sg_uf_cons_prest,
	' '			reservado_12,
	null			nr_cnpj_cpf_req,
	null			nm_prest_req,
	null			sg_cons_prof_req,
	null			nr_cons_prof_req,
	null			sg_uf_cons_req,
	null			id_reembolso,
	null			nr_autorizacao,
	null			nr_lote_705,
	null			nr_nota_705,
	null			tp_reg_cpl,
	null			ie_tipo_complemento,
	null			nm_desc_cpl,
	null			nr_nota_fiscal,
	null			ds_link_nfe,
	null			qt_tot_r702,
	null			qt_tot_r703,
	null			qt_tot_r704,
	null			qt_tot_r705,
	null			qt_tot_serv,
	null			vl_tot_serv,
	null	reservado
from	ptu_nota_hospitalar	a,
	ptu_nota_hosp_compl	b,
	ptu_nota_cobranca	c
where	a.nr_sequencia		= b.nr_seq_nota_hosp
and	a.nr_seq_nota_cobr	= c.nr_sequencia

union

select	b.nr_seq_serv_pre_pagto		nr_seq_servico,
	4			tp_registro,
	4			nr_sequencia,
	null			nr_seq_geracao,
	null			id_benef,
	'704'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			dt_inicial_pagto,
	null			dt_finial_pagto,
	null			nr_versao_transacao,
	b.nr_lote		nr_lote,
	b.nr_nota		nr_nota,
	' '			reservado_1,
	null			cd_unimed,
	' '			reservado_2,
	null			cd_usuario_plano,
	null			nm_benef,
	null			dt_atend,
	' '			reservado_3,
	null			cd_excecao,
	null			tp_carater_atend,
	' '			reservado_4,
	' '			reservado_5,
	null			cd_cid,
	' '			reservado_6,
	null			tp_paciente,
	null			tp_saida_cons_sadt,
	null			tp_atendimento,
	null			nr_guia_principal,
	null			nr_lote_703,
	null			nr_nota_703,
	null			cd_uni_hosp,
	null			cd_hosp,
	null			nm_hosp,
	null			tp_acomodacao,
	null			dt_internacao,
	null			dt_alta,
	null			ft_mult_amb,
	null			tp_ind_acidente,
	null			tp_saida,
	null			cgc_hospital,
	null			tp_internacao,
	null			qt_nasc_vivos,
	null			qt_nasc_mortos,
	null			qt_nasc_vivos_pre,
	null			qt_obito_precoce,
	null			qt_obito_tardio,
	null			id_int_obstetricia_1,
	null			id_int_obstetricia_2,
	null			id_int_obstetricia_3,
	null			id_int_obstetricia_4,
	null			id_int_obstetricia_5,
	null			id_int_obstetricia_6,
	null			id_int_obstetricia_7,
	null			id_int_obstetricia_8,
	null			id_int_obstetricia_9,
	null			tp_faturamento,
	null			cd_cid_obito,
	null			nr_declara_vivo_1,
	null			nr_declara_vivo_2,
	null			nr_declara_vivo_3,
	null			nr_declara_vivo_4,
	null			nr_declara_vivo_5,
	null			ie_obito_mulher,
	null			nr_declara_obito,
	null			cd_cid_obito_1,
	null			cd_cid_obito_2,
	null			cd_cid_obito_3,
	null			cd_cid_obito_4,
	null			cd_cid_obito_5,
	null			nr_declara_obito_1,
	null			nr_declara_obito_2,
	null			nr_declara_obito_3,
	null			nr_declara_obito_4,
	null			nr_declara_obito_5,
	a.nr_lote				nr_lote_704,
	a.nr_nota				nr_nota_704,
	'S'					id_copartic,
	a.cd_unimed_prestador			cd_uni_pre,
	a.cd_prestador				cd_prest,
	a.nm_prestador				nm_prest,
	a.ie_tipo_participacao			tp_participacao,
	a.dt_procedimento			dt_servico,
	a.dt_procedimento			dt_pagamento,
	a.ie_tipo_tabela			tp_tabela,
	substr(ptu_obter_proced_conversao_700(a.cd_procedimento,a.ie_origem_proced, a.cd_prestador, b.cd_unimed),1,15)	cd_servico,
	a.qt_procedimento			qt_paga,
	(a.vl_procedimento)	vl_serv_pag,
	(a.vl_custo_operacional)	vl_co_pag,
	(a.vl_filme)	vl_filme_pag,
	a.cd_porte_anestesico			cd_porte_ane,
	a.cd_unimed_autorizadora		cd_unimed_autorizadora,
	' ' 					reservado_7,
	' '					reservado_8,
	a.cd_unimed_pre_req			cd_uni_pre_req,
	a.cd_prestador_req			cd_pre_req,
	a.ie_via_acesso				cd_via_acesso,
	' '					reservado_9,
	' '					reservado_10,
	' '					reservado_11,
	a.vl_adic_procedimento			vl_adic_procedimento,
	a.vl_adic_co				vl_adic_co,
	a.vl_adic_filme				vl_adic_filme,
	a.cd_especialidade			cd_espec,
	a.ie_tipo_prestador			tp_prest_exec,
	a.ie_rede_propria			id_rec_proprio,
	a.ie_tipo_pessoa_prestador		tp_pessoa,
	a.nr_cgc_cpf				nr_cnpj_cpf,
	a.ie_pacote				id_pacote,
	a.cd_ato				cd_ato,
	a.tx_procedimento			fat_mult_serv,
	a.nr_seq_nota				nr_seq_nota,
	a.ds_hora_procedimento			hr_realiz,
	a.cd_cnes_prest				cd_cnes_prest,
	a.nm_profissional_prestador		nm_prof_prest,
	a.sg_cons_prof_prest			sg_cons_prof_prest,
	a.nr_cons_prof_prest			nr_cons_prof_prest,
	a.sg_uf_cons_prest			sg_uf_cons_prest,
	' '					reservado_12,
	a.nr_cgc_cpf_req			nr_cnpj_cpf_req,
	a.nm_prestador_requisitante		nm_prest_req,
	a.sg_cons_prof_req			sg_cons_prof_req,
	a.nr_cons_prof_req			nr_cons_prof_req,
	a.sg_uf_cons_req			sg_uf_cons_req,
	a.ie_reembolso				id_reembolso,
	a.nr_autorizacao			nr_autorizacao,
	null					nr_lote_705,
	null					nr_nota_705,
	null					tp_reg_cpl,
	null					ie_tipo_complemento,
	null					nm_desc_cpl,
	null					nr_nota_fiscal,
	null					ds_link_nfe,
	null					qt_tot_r702,
	null					qt_tot_r703,
	null					qt_tot_r704,
	null					qt_tot_r705,
	null					qt_tot_serv,
	null					vl_tot_serv,
	null	reservado
from	ptu_nota_servico	a,
	ptu_nota_cobranca	b
where	a.nr_seq_nota_cobr	= b.nr_Sequencia

union

select	b.nr_seq_serv_pre_pagto		nr_seq_servico,
	5			tp_registro,
	5			nr_sequencia,
	null			nr_seq_geracao,
	null			id_benef,
	'705'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			dt_inicial_pagto,
	null			dt_final_pagto,
	null			nr_versao_transacao,
	b.nr_lote		nr_lote,
	b.nr_nota		nr_nota,
	' '			reservado_1,
	null			cd_unimed,
	' '			reservado_2,
	null			cd_usuario_plano,
	null			nm_benef,
	null			dt_atend,
	' '			reservado_3,
	null			cd_excecao,
	null			tp_carater_atend,
	' '			reservado_4,
	' '			reservado_5,
	null			cd_cid,
	' '			reservado_6,
	null			tp_paciente,
	null			tp_saida_cons_sadt,
	null			tp_atendimento,
	null			nr_guia_principal,
	null			nr_lote_703,
	null			nr_nota_703,
	null			cd_uni_hosp,
	null			cd_hosp,
	null			nm_hosp,
	null			tp_acomodacao,
	null			dt_internacao,
	null			dt_alta,
	null			ft_mult_amb,
	null			tp_ind_acidente,
	null			tp_saida,
	null			cgc_hospital,
	null			tp_internacao,
	null			qt_nasc_vivos,
	null			qt_nasc_mortos,
	null			qt_nasc_vivos_pre,
	null			qt_obito_precoce,
	null			qt_obito_tardio,
	null			id_int_obstetricia_1,
	null			id_int_obstetricia_2,
	null			id_int_obstetricia_3,
	null			id_int_obstetricia_4,
	null			id_int_obstetricia_5,
	null			id_int_obstetricia_6,
	null			id_int_obstetricia_7,
	null			id_int_obstetricia_8,
	null			id_int_obstetricia_9,
	null			tp_faturamento,
	null			cd_cid_obito,
	null			nr_declara_vivo_1,
	null			nr_declara_vivo_2,
	null			nr_declara_vivo_3,
	null			nr_declara_vivo_4,
	null			nr_declara_vivo_5,
	null			ie_obito_mulher,
	null			nr_declara_obito,
	null			cd_cid_obito_1,
	null			cd_cid_obito_2,
	null			cd_cid_obito_3,
	null			cd_cid_obito_4,
	null			cd_cid_obito_5,
	null			nr_declara_obito_1,
	null			nr_declara_obito_2,
	null			nr_declara_obito_3,
	null			nr_declara_obito_4,
	null			nr_declara_obito_5,
	null			nr_lote_704,
	null			nr_nota_704,
	null			id_copartic,
	null			cd_uni_pre,
	null			cd_prest,
	null			nm_prest,
	null			tp_particip,
	null			dt_servico,
	null			dt_pagamento,
	null			tp_tabela,
	null			cd_servico,
	null			qt_paga,
	0			vl_serv_pag,
	0			vl_co_pag,
	0			vl_filme_pag,
	null			cd_porte_ane,
	null			cd_unimed_autorizadora,
	' ' 			reservado_7,
	' '			reservado_8,
	null			cd_uni_pre_req,
	null			cd_pre_req,
	null			cd_via_acesso,
	' '			reservado_9,
	' '			reservado_10,
	' '			reservado_11,
	null			vl_adic_procedimento,
	null			vl_adic_co,
	null			vl_adic_filme,
	null			cd_espec,
	null			tp_prest_exec,
	null			id_rec_proprio,
	null			tp_pessoa,
	null			nr_cnpj_cpf,
	null			id_pacote,
	null			cd_ato,
	null			fat_mult_serv,
	null			nr_seq_nota,
	null			hr_realiz,
	null			cd_cnes_prest,
	null			nm_prof_prest,
	null			sg_cons_prof_prest,
	null			nr_cons_prof_prest,
	null			sg_uf_cons_prest,
	' '			reservado_12,
	null			nr_cnpj_cpf_req,
	null			nm_prest_req,
	null			sg_cons_prof_req,
	null			nr_cons_prof_req,
	null			sg_uf_cons_req,
	null			id_reembolso,
	null			nr_autorizacao,
	a.nr_lote		nr_lote_705,
	a.nr_nota		nr_nota_705,
	a.ie_tipo_complemento	tp_reg_cpl,
	a.ie_tipo_complemento	ie_tipo_complemento,
	a.ds_complemento	nm_desc_cpl,
	null			nr_nota_fiscal,
	null			ds_link_nfe,
	null			qt_tot_r702,
	null			qt_tot_r703,
	null			qt_tot_r704,
	null			qt_tot_r705,
	null			qt_tot_serv,
	null			vl_tot_serv,
	null	reservado
from	ptu_nota_complemento	a,
	ptu_nota_cobranca	b
where	a.nr_seq_nota_cobr	= b.nr_sequencia

union

select	nr_sequencia		nr_seq_servico,
	7			tp_registro,
	7			nr_sequencia,
	null			nr_seq_geracao,
	null			id_benef,
	'709'			cd_tipo_registro,
	null			cd_unimed_destino,
	null			cd_unimed_origem,
	null			dt_geracao,
	null			dt_inicio_pagto,
	null			dt_fim_pagto,
	null			nr_versao_transacao,
	999991			nr_lote,
	'999991'		nr_nota,
	' '			reservado_1,
	null			cd_unimed,
	' '			reservado_2,
	null			cd_usuario_plano,
	null			nm_benef,
	null			dt_atend,
	' '			reservado_3,
	null			cd_excecao,
	null			tp_carater_atend,
	' '			reservado_4,
	' '			reservado_5,
	null			cd_cid,
	' '			reservado_6,
	null			tp_paciente,
	null			tp_saida_cons_sadt,
	null			tp_atendimento,
	null			nr_guia_principal,
	null			nr_lote_703,
	null			nr_nota_703,
	null			cd_uni_hosp,
	null			cd_hosp,
	null			nm_hosp,
	null			tp_acomodacao,
	null			dt_internacao,
	null			dt_alta,
	null			ft_mult_amb,
	null			tp_ind_acidente,
	null			tp_saida,
	null			cgc_hospital,
	null			tp_internacao,
	null			qt_nasc_vivos,
	null			qt_nasc_mortos,
	null			qt_nasc_vivos_pre,
	null			qt_obito_precoce,
	null			qt_obito_tardio,
	null			id_int_obstetricia_1,
	null			id_int_obstetricia_2,
	null			id_int_obstetricia_3,
	null			id_int_obstetricia_4,
	null			id_int_obstetricia_5,
	null			id_int_obstetricia_6,
	null			id_int_obstetricia_7,
	null			id_int_obstetricia_8,
	null			id_int_obstetricia_9,
	null			tp_faturamento,
	null			cd_cid_obito,
	null			nr_declara_vivo_1,
	null			nr_declara_vivo_2,
	null			nr_declara_vivo_3,
	null			nr_declara_vivo_4,
	null			nr_declara_vivo_5,
	null			ie_obito_mulher,
	null			nr_declara_obito,
	null			cd_cid_obito_1,
	null			cd_cid_obito_2,
	null			cd_cid_obito_3,
	null			cd_cid_obito_4,
	null			cd_cid_obito_5,
	null			nr_declara_obito_1,
	null			nr_declara_obito_2,
	null			nr_declara_obito_3,
	null			nr_declara_obito_4,
	null			nr_declara_obito_5,
	null			nr_lote_704,
	null			nr_nota_704,
	null			id_copartic,
	null			cd_uni_pre,
	null			cd_prest,
	null			nm_prest,
	null			tp_participacao,
	null			dt_servico,
	null			dt_pagamento,
	null			tp_tabela,
	null			cd_servico,
	null			qt_paga,
	0			vl_serv_pag,
	0			vl_co_serv_pag,
	0			vl_filme_pag,
	null			cd_porte_ane,
	null			cd_unimed_autorizadora,
	' ' 			reservado_7,
	' '			reservado_8,
	null			cd_uni_pre_req,
	null			cd_pre_req,
	null			cd_via_acesso,
	' '			reservado_9,
	' '			reservado_10,
	' '			reservado_11,
	null			vl_adic_procedimento,
	null			vl_adic_co,
	null			vl_adic_filme,
	null			cd_espec,
	null			tp_prest_exec,
	null			id_rec_proprio,
	null			tp_pessoa,
	null			nr_cnpj_cpf,
	null			id_pacote,
	null			cd_ato,
	null			tx_procedimento,
	null			nr_seq_nota,
	null			hr_realiz,
	null			cd_cnes_prest,
	null			nm_prof_prest,
	null			sg_cons_prof_prest,
	null			nr_cons_prof_prest,
	null			sg_uf_cons_prest,
	' '			reservado_12,
	null			nr_cnpj_cpf_req,
	null			nm_prest_req,
	null			sg_cons_prof_req,
	null			nr_cons_prof_req,
	null			sg_uf_cons_req,
	null			ie_reembolso,
	null			nr_autorizacao,
	null			nr_lote_705,
	null			nr_nota_705,
	null			tp_reg_cpl,
	null			ie_tipo_complemento,
	null			nm_desc_cpl,
	null			nr_nota_fiscal,
	null			ds_link_nfe,
	ptu_obter_qt_registro_serv(nr_sequencia, '702')		qt_tot_r702,
	ptu_obter_qt_registro_serv(nr_sequencia, '703')		qt_tot_r703,
	ptu_obter_qt_registro_serv(nr_sequencia, '704')		qt_tot_r704,
	ptu_obter_qt_registro_serv(nr_sequencia, '705')		qt_tot_r705,
	ptu_obter_qt_registro_serv(nr_sequencia, 'qt_serv')		qt_tot_serv,
	ptu_obter_qt_registro_serv(nr_sequencia, 'vl_serv')		vl_tot_serv,
	null	reservado
from	ptu_servico_pre_pagto;

