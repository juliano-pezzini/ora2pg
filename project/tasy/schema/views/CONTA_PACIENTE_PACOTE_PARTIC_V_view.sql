-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW conta_paciente_pacote_partic_v (nr_seq_partic, ie_funcao, cd_medico, cd_cgc, ie_valor_informado, vl_participante, vl_conta, nr_conta_medico, ie_tipo_servico_sus, ie_tipo_ato_sus, qt_ponto_sus, vl_ponto_sus, vl_original, ie_responsavel_credito, pr_procedimento, cd_especialidade, pr_faturar, cd_medico_convenio, nr_doc_honor_conv, nr_interno_conta, nr_crm, cd_procedimento, ds_procedimento, ds_funcao, vl_procedimento, nm_medico, ie_emite_conta) AS select	b.NR_SEQ_PARTIC,
	b.IE_FUNCAO, 
	b.CD_PESSOA_FISICA cd_medico, 
	b.CD_CGC, 
	b.IE_VALOR_INFORMADO, 
	b.VL_PARTICIPANTE, 
	b.VL_CONTA, 
	b.NR_CONTA_MEDICO, 
	b.IE_TIPO_SERVICO_SUS, 
	b.IE_TIPO_ATO_SUS, 
	b.QT_PONTO_SUS, 
	b.VL_PONTO_SUS, 
	b.VL_ORIGINAL, 
	b.IE_RESPONSAVEL_CREDITO, 
	b.PR_PROCEDIMENTO, 
	b.CD_ESPECIALIDADE, 
	b.PR_FATURAR, 
	b.CD_MEDICO_CONVENIO, 
	b.NR_DOC_HONOR_CONV, 
	a.nr_interno_conta, 
	c.nr_crm, 
	a.cd_procedimento, 
	d.ds_procedimento, 
	e.ds_funcao, 
	a.vl_procedimento, 
	substr(obter_nome_pessoa_fisica(c.cd_pessoa_fisica, null),1,254) nm_medico, 
	81 ie_emite_conta 
FROM funcao_medico e, procedimento d, procedimento_paciente a, procedimento_participante b
LEFT OUTER JOIN medico c ON (b.cd_pessoa_fisica = c.cd_pessoa_fisica)
WHERE a.nr_sequencia		= b.nr_sequencia and a.cd_motivo_exc_conta	is null and a.cd_procedimento	= d.cd_procedimento and a.ie_origem_proced	= d.ie_origem_proced  and b.ie_funcao		= e.cd_funcao and a.nr_seq_proc_pacote	is not null;

