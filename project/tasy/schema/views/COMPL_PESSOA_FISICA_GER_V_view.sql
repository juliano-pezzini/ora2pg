-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW compl_pessoa_fisica_ger_v (cd_pessoa_fisica, nr_sequencia, ie_tipo_complemento, dt_atualizacao, nm_usuario, nm_contato, ds_endereco, cd_cep, nr_endereco, ds_complemento, ds_bairro, ds_municipio, sg_estado, nr_telefone, nr_ramal, ds_observacao, ds_email, cd_empresa_refer, cd_profissao, nr_identidade, nr_cpf, cd_municipio_ibge, ds_setor_trabalho, ds_horario_trabalho, nr_matricula_trabalho, nr_seq_parentesco, ds_fone_adic, ds_fax, dt_atualizacao_nrec, nm_usuario_nrec, cd_pessoa_fisica_ref, nr_seq_pais, ds_fonetica, cd_tipo_logradouro, nr_ddd_telefone, nr_ddi_telefone, nr_ddi_fax, nr_ddd_fax, ds_website, nm_contato_pesquisa, qt_dependente, ie_nf_correio, cd_zona_procedencia, ie_obriga_email, nr_seq_ident_cnes, ie_mala_direta, ie_tipo_sangue, ie_fator_rh, nr_seq_local_atend_med, cd_pessoa_end_ref, nr_seq_end_ref, ie_empresa_pagadora, nr_seq_regiao, ie_correspondencia, nr_ddi_fone_adic, nr_ddd_fone_adic, nr_seq_tipo_compl_adic, nr_telefone_celular, nr_ddd_celular, nr_ddi_celular, ie_nao_possui_email, ie_regime_casamento, ie_resp_legal, nr_seq_assentamento_mx, nr_seq_localizacao_mx, ds_compl_end, nr_seq_tipo_custodia, ie_custodiante, ie_contato_principal, nr_seq_pessoa_endereco, ds_end, ds_cid_est, ds_pais) AS select
   a.CD_PESSOA_FISICA,a.NR_SEQUENCIA,a.IE_TIPO_COMPLEMENTO,a.DT_ATUALIZACAO,a.NM_USUARIO,a.NM_CONTATO,a.DS_ENDERECO,a.CD_CEP,a.NR_ENDERECO,a.DS_COMPLEMENTO,a.DS_BAIRRO,a.DS_MUNICIPIO,a.SG_ESTADO,a.NR_TELEFONE,a.NR_RAMAL,a.DS_OBSERVACAO,a.DS_EMAIL,a.CD_EMPRESA_REFER,a.CD_PROFISSAO,a.NR_IDENTIDADE,a.NR_CPF,a.CD_MUNICIPIO_IBGE,a.DS_SETOR_TRABALHO,a.DS_HORARIO_TRABALHO,a.NR_MATRICULA_TRABALHO,a.NR_SEQ_PARENTESCO,a.DS_FONE_ADIC,a.DS_FAX,a.DT_ATUALIZACAO_NREC,a.NM_USUARIO_NREC,a.CD_PESSOA_FISICA_REF,a.NR_SEQ_PAIS,a.DS_FONETICA,a.CD_TIPO_LOGRADOURO,a.NR_DDD_TELEFONE,a.NR_DDI_TELEFONE,a.NR_DDI_FAX,a.NR_DDD_FAX,a.DS_WEBSITE,a.NM_CONTATO_PESQUISA,a.QT_DEPENDENTE,a.IE_NF_CORREIO,a.CD_ZONA_PROCEDENCIA,a.IE_OBRIGA_EMAIL,a.NR_SEQ_IDENT_CNES,a.IE_MALA_DIRETA,a.IE_TIPO_SANGUE,a.IE_FATOR_RH,a.NR_SEQ_LOCAL_ATEND_MED,a.CD_PESSOA_END_REF,a.NR_SEQ_END_REF,a.IE_EMPRESA_PAGADORA,a.NR_SEQ_REGIAO,a.IE_CORRESPONDENCIA,a.NR_DDI_FONE_ADIC,a.NR_DDD_FONE_ADIC,a.NR_SEQ_TIPO_COMPL_ADIC,a.NR_TELEFONE_CELULAR,a.NR_DDD_CELULAR,a.NR_DDI_CELULAR,a.IE_NAO_POSSUI_EMAIL,a.IE_REGIME_CASAMENTO,a.IE_RESP_LEGAL,a.NR_SEQ_ASSENTAMENTO_MX,a.NR_SEQ_LOCALIZACAO_MX,a.DS_COMPL_END,a.NR_SEQ_TIPO_CUSTODIA,a.IE_CUSTODIANTE,a.IE_CONTATO_PRINCIPAL,a.NR_SEQ_PESSOA_ENDERECO,
   a.ds_endereco ||
   case when
         a.ds_compl_end is not null 
      then ', ' || a.ds_compl_end 
   end || 
   case when
         a.ds_bairro is not null 
      then ', ' || a.ds_bairro 
   end ||    
   case when
         a.ds_complemento is not null 
      then ' - ' || a.ds_complemento 
   end ds_end, 
   case when
         a.cd_cep is not null 
      then a.cd_cep
   end ||
   case when
         a.ds_municipio is not null 
      then ' '|| a.ds_municipio 
   end || 
   case when
         a.sg_estado is not null 
      then ' - ' || a.sg_estado 
   end ds_cid_est, 
   substr(obter_nome_pais(nr_seq_pais), 1, 200) ds_pais 
FROM
   compl_pessoa_fisica a;

