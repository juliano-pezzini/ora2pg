-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW solicitacao_compra_v (cd_estabelecimento, ds_local_estoque, ds_centro_custo, nr_solic_compra, ds_material, qt_material, cd_unidade_medida_compra, nr_cot_compra, nr_item_solic_compra, dt_entrega_solicitada, ds_conta_contabil, ds_observacao, dt_solicitacao_compra, dt_liberacao, nm_pessoa_fisica, nm_pessoa_autor, nr_seq_forma_compra, ds_justificativa) AS SELECT	D.CD_ESTABELECIMENTO,
	B.DS_LOCAL_ESTOQUE, 
	C.DS_CENTRO_CUSTO, 
	D.NR_SOLIC_COMPRA, 
	E.DS_MATERIAL, 
	F.QT_MATERIAL, 
	F.CD_UNIDADE_MEDIDA_COMPRA, 
	F.NR_COT_COMPRA, 
	F.NR_ITEM_SOLIC_COMPRA, 
	G.DT_ENTREGA_SOLICITADA, 
	H.DS_CONTA_CONTABIL, 
	D.DS_OBSERVACAO, 
	D.DT_SOLICITACAO_COMPRA, 
	D.DT_LIBERACAO, 
	SUBSTR(OBTER_NOME_PF(D.CD_PESSOA_SOLICITANTE),1,60) NM_PESSOA_FISICA, 
	SUBSTR(OBTER_NOME_PF(D.CD_PESSOA_AUTORIZA),1,60) NM_PESSOA_AUTOR, 
	D.NR_SEQ_FORMA_COMPRA, 
	D.DS_JUSTIFICATIVA 
FROM solic_compra_item_entrega g, solic_compra_item f, material e, solic_compra d
LEFT OUTER JOIN local_estoque b ON (D.CD_LOCAL_ESTOQUE = B.CD_LOCAL_ESTOQUE)
LEFT OUTER JOIN centro_custo c ON (D.CD_CENTRO_CUSTO = C.CD_CENTRO_CUSTO)
LEFT OUTER JOIN conta_contabil h ON (D.CD_CONTA_CONTABIL = H.CD_CONTA_CONTABIL)
WHERE D.NR_SOLIC_COMPRA 		= F.NR_SOLIC_COMPRA AND D.NR_SOLIC_COMPRA 		= G.NR_SOLIC_COMPRA AND F.NR_ITEM_SOLIC_COMPRA	= G.NR_ITEM_SOLIC_COMPRA AND F.CD_MATERIAL		= E.CD_MATERIAL;

