-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW compl_pessoa_fisica_jst_v (ie_evento_t, nr_sequencia_t, nr_sequencia_sup_t, dt_atualizacao_t, nm_usuario_t, cd_pessoa_fisica, nr_sequencia, ie_tipo_complemento, dt_atualizacao, nm_usuario, nm_contato, ds_endereco, cd_cep, nr_endereco, nr_seq_assentamento_mx, ds_complemento, ds_bairro, ds_municipio, sg_estado, nr_telefone, nr_ramal, ds_observacao, ds_email, cd_empresa_refer, cd_profissao, nr_identidade, ie_tipo_sangue, ie_fator_rh, nr_cpf, cd_municipio_ibge, ds_setor_trabalho, ds_horario_trabalho, nr_matricula_trabalho, ds_website, ds_fone_adic, ds_fax, nr_seq_parentesco, cd_pessoa_fisica_ref, nr_seq_pais, cd_tipo_logradouro, nr_ddd_telefone, nr_ddi_telefone, nr_ddi_fax, nr_ddd_fax, nr_seq_ident_cnes, nm_contato_pesquisa, qt_dependente, ie_empresa_pagadora, ie_correspondencia, dt_atualizacao_nrec, nm_usuario_nrec, ds_fonetica, ie_nf_correio, cd_zona_procedencia, nr_seq_local_atend_med, cd_pessoa_end_ref, nr_seq_end_ref, ie_obriga_email, ie_mala_direta, nr_seq_regiao, nr_ddi_fone_adic, nr_ddd_fone_adic, nr_seq_tipo_compl_adic, nr_telefone_celular, nr_ddd_celular, nr_ddi_celular, ie_nao_possui_email, ie_custodiante, nr_seq_tipo_custodia, ds_compl_end, ie_regime_casamento, ie_resp_legal, nr_seq_pessoa_endereco, ie_contato_principal, nr_seq_localizacao_mx) AS SELECT T.IE_EVENTO IE_EVENTO_T, T.NR_SEQUENCIA NR_SEQUENCIA_T, T.NR_SEQUENCIA_SUP NR_SEQUENCIA_SUP_T, T.DT_ATUALIZACAO DT_ATUALIZACAO_T, T.NM_USUARIO NM_USUARIO_T
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_PESSOA_FISICA' THEN T.VL_CAMPO END) CD_PESSOA_FISICA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQUENCIA' THEN T.VL_CAMPO END) NR_SEQUENCIA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_TIPO_COMPLEMENTO' THEN T.VL_CAMPO END) IE_TIPO_COMPLEMENTO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DT_ATUALIZACAO' THEN T.VL_CAMPO END) DT_ATUALIZACAO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NM_USUARIO' THEN T.VL_CAMPO END) NM_USUARIO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NM_CONTATO' THEN T.VL_CAMPO END) NM_CONTATO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_ENDERECO' THEN T.VL_CAMPO END) DS_ENDERECO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_CEP' THEN T.VL_CAMPO END) CD_CEP
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_ENDERECO' THEN T.VL_CAMPO END) NR_ENDERECO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQ_ASSENTAMENTO_MX' THEN T.VL_CAMPO END) NR_SEQ_ASSENTAMENTO_MX
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_COMPLEMENTO' THEN T.VL_CAMPO END) DS_COMPLEMENTO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_BAIRRO' THEN T.VL_CAMPO END) DS_BAIRRO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_MUNICIPIO' THEN T.VL_CAMPO END) DS_MUNICIPIO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'SG_ESTADO' THEN T.VL_CAMPO END) SG_ESTADO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_TELEFONE' THEN T.VL_CAMPO END) NR_TELEFONE
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_RAMAL' THEN T.VL_CAMPO END) NR_RAMAL
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_OBSERVACAO' THEN T.VL_CAMPO END) DS_OBSERVACAO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_EMAIL' THEN T.VL_CAMPO END) DS_EMAIL
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_EMPRESA_REFER' THEN T.VL_CAMPO END) CD_EMPRESA_REFER
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_PROFISSAO' THEN T.VL_CAMPO END) CD_PROFISSAO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_IDENTIDADE' THEN T.VL_CAMPO END) NR_IDENTIDADE
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_TIPO_SANGUE' THEN T.VL_CAMPO END) IE_TIPO_SANGUE
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_FATOR_RH' THEN T.VL_CAMPO END) IE_FATOR_RH
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_CPF' THEN T.VL_CAMPO END) NR_CPF
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_MUNICIPIO_IBGE' THEN T.VL_CAMPO END) CD_MUNICIPIO_IBGE
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_SETOR_TRABALHO' THEN T.VL_CAMPO END) DS_SETOR_TRABALHO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_HORARIO_TRABALHO' THEN T.VL_CAMPO END) DS_HORARIO_TRABALHO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_MATRICULA_TRABALHO' THEN T.VL_CAMPO END) NR_MATRICULA_TRABALHO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_WEBSITE' THEN T.VL_CAMPO END) DS_WEBSITE
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_FONE_ADIC' THEN T.VL_CAMPO END) DS_FONE_ADIC
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_FAX' THEN T.VL_CAMPO END) DS_FAX
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQ_PARENTESCO' THEN T.VL_CAMPO END) NR_SEQ_PARENTESCO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_PESSOA_FISICA_REF' THEN T.VL_CAMPO END) CD_PESSOA_FISICA_REF
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQ_PAIS' THEN T.VL_CAMPO END) NR_SEQ_PAIS
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_TIPO_LOGRADOURO' THEN T.VL_CAMPO END) CD_TIPO_LOGRADOURO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_DDD_TELEFONE' THEN T.VL_CAMPO END) NR_DDD_TELEFONE
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_DDI_TELEFONE' THEN T.VL_CAMPO END) NR_DDI_TELEFONE
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_DDI_FAX' THEN T.VL_CAMPO END) NR_DDI_FAX
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_DDD_FAX' THEN T.VL_CAMPO END) NR_DDD_FAX
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQ_IDENT_CNES' THEN T.VL_CAMPO END) NR_SEQ_IDENT_CNES
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NM_CONTATO_PESQUISA' THEN T.VL_CAMPO END) NM_CONTATO_PESQUISA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'QT_DEPENDENTE' THEN T.VL_CAMPO END) QT_DEPENDENTE
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_EMPRESA_PAGADORA' THEN T.VL_CAMPO END) IE_EMPRESA_PAGADORA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_CORRESPONDENCIA' THEN T.VL_CAMPO END) IE_CORRESPONDENCIA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DT_ATUALIZACAO_NREC' THEN T.VL_CAMPO END) DT_ATUALIZACAO_NREC
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NM_USUARIO_NREC' THEN T.VL_CAMPO END) NM_USUARIO_NREC
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_FONETICA' THEN T.VL_CAMPO END) DS_FONETICA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_NF_CORREIO' THEN T.VL_CAMPO END) IE_NF_CORREIO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_ZONA_PROCEDENCIA' THEN T.VL_CAMPO END) CD_ZONA_PROCEDENCIA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQ_LOCAL_ATEND_MED' THEN T.VL_CAMPO END) NR_SEQ_LOCAL_ATEND_MED
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'CD_PESSOA_END_REF' THEN T.VL_CAMPO END) CD_PESSOA_END_REF
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQ_END_REF' THEN T.VL_CAMPO END) NR_SEQ_END_REF
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_OBRIGA_EMAIL' THEN T.VL_CAMPO END) IE_OBRIGA_EMAIL
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_MALA_DIRETA' THEN T.VL_CAMPO END) IE_MALA_DIRETA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQ_REGIAO' THEN T.VL_CAMPO END) NR_SEQ_REGIAO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_DDI_FONE_ADIC' THEN T.VL_CAMPO END) NR_DDI_FONE_ADIC
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_DDD_FONE_ADIC' THEN T.VL_CAMPO END) NR_DDD_FONE_ADIC
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQ_TIPO_COMPL_ADIC' THEN T.VL_CAMPO END) NR_SEQ_TIPO_COMPL_ADIC
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_TELEFONE_CELULAR' THEN T.VL_CAMPO END) NR_TELEFONE_CELULAR
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_DDD_CELULAR' THEN T.VL_CAMPO END) NR_DDD_CELULAR
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_DDI_CELULAR' THEN T.VL_CAMPO END) NR_DDI_CELULAR
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_NAO_POSSUI_EMAIL' THEN T.VL_CAMPO END) IE_NAO_POSSUI_EMAIL
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_CUSTODIANTE' THEN T.VL_CAMPO END) IE_CUSTODIANTE
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQ_TIPO_CUSTODIA' THEN T.VL_CAMPO END) NR_SEQ_TIPO_CUSTODIA
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'DS_COMPL_END' THEN T.VL_CAMPO END) DS_COMPL_END
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_REGIME_CASAMENTO' THEN T.VL_CAMPO END) IE_REGIME_CASAMENTO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_RESP_LEGAL' THEN T.VL_CAMPO END) IE_RESP_LEGAL
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQ_PESSOA_ENDERECO' THEN T.VL_CAMPO END) NR_SEQ_PESSOA_ENDERECO
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'IE_CONTATO_PRINCIPAL' THEN T.VL_CAMPO END) IE_CONTATO_PRINCIPAL
     , MAX(CASE WHEN T.NM_ATRIBUTO = 'NR_SEQ_LOCALIZACAO_MX' THEN T.VL_CAMPO END) NR_SEQ_LOCALIZACAO_MX
  FROM JSON_SCHEMA_T T
 WHERE T.NM_TABELA = 'COMPL_PESSOA_FISICA'
 GROUP BY T.IE_EVENTO, T.NM_TABELA, T.NR_SEQUENCIA, T.NR_SEQUENCIA_SUP, T.DT_ATUALIZACAO, T.NM_USUARIO;

