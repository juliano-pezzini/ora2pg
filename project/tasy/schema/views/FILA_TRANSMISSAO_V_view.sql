-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW fila_transmissao_v (qt_registros, nr_sequencia, ds_evento, ie_evento, dt_atualizacao, dt_atualizacao_nrec, nm_usuario, nr_seq_documento, ds_status, ie_status, ds_sistema, nr_doc_externo, ds_envio_recebe, ds_log, ds_xml, ds_xml_retorno, ie_envio_recebe, ds_message, ie_status_http, ds_message_response, nr_seq_agrupador, nr_seq_dependencia, ds_classif_evento, ds_classif_erro, cd_estab_documento, cd_setor_usuario, ds_estab_documento, ds_setor_usuario, ds_perfil_usuario, cd_perfil, ie_tipo_erro, dt_processamento, nr_seq_classif, qt_seg_processamento, nr_seq_sistema) AS select	1 qt_registros,
	nr_sequencia,
	substr(obter_valor_dominio(8187,ie_evento),1,255) ds_evento,
	ie_evento,
	dt_atualizacao,
	dt_atualizacao_nrec,
	nm_usuario,
	nr_seq_documento,
	substr(obter_valor_dominio(8190,ie_status),1,255) ds_status,
	ie_status,
	substr(obter_nm_sistema_intpd(nr_seq_evento_sistema,0),1,255) ds_sistema,
	nr_doc_externo,
	substr(intpd_obter_se_env_rec(ie_envio_recebe),1,50) ds_envio_recebe,
	ds_log,
	substr(ds_xml,4000,1) ds_xml,
	substr(ds_xml_retorno,4000,1) ds_xml_retorno,
	ie_envio_recebe,
	CASE WHEN substr(DS_MESSAGE,4000,1)='0' THEN  ''  ELSE substr(DS_MESSAGE,4000,1) END  DS_MESSAGE,
	IE_STATUS_HTTP,
	CASE WHEN substr(DS_MESSAGE_RESPONSE,4000,1)='0' THEN  ''  ELSE substr(DS_MESSAGE_RESPONSE,4000,1) END  DS_MESSAGE_RESPONSE,
	nr_seq_agrupador,
	nr_seq_dependencia,
	intpd_obter_classif_evento(nr_seq_evento_sistema) ds_classif_evento,
	substr(obter_desc_expressao(670600),1,50) ds_classif_erro,
	CD_ESTAB_DOCUMENTO,
	cd_setor_usuario,
	substr(coalesce(OBTER_NOME_ESTABELECIMENTO(CD_ESTAB_DOCUMENTO),obter_desc_expressao(327119)),1,255) ds_estab_documento,
	coalesce(obter_nome_setor(CD_SETOR_USUARIO),obter_desc_expressao(327119)) ds_setor_usuario,
	coalesce(obter_nome_perfil(CD_PERFIL),obter_desc_expressao(327119)) ds_perfil_usuario,
	cd_perfil,
	ie_tipo_erro,
	dt_processamento,
	obter_classif_intpd(nr_seq_evento_sistema,'S') nr_seq_classif,
	obter_dif_data(dt_atualizacao_nrec,dt_processamento,'TS') qt_seg_processamento,
	(select x.nr_seq_sistema FROM intpd_eventos_sistema x where x.nr_sequencia = a.nr_seq_evento_sistema) nr_seq_sistema
from	intpd_fila_transmissao a;

