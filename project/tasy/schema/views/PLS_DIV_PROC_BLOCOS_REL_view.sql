-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_div_proc_blocos_rel (nr_seq_analise, nr_seq_maximo, cd_procedimento_1, cd_procedimento_2, cd_procedimento_3, cd_procedimento_4, cd_procedimento_5, cd_procedimento_6, dt_procedimento_1, dt_procedimento_2, dt_procedimento_3, dt_procedimento_4, dt_procedimento_5, dt_procedimento_6) AS select	a.nr_seq_analise,
	a.nr_seq_maximo,
	(	select	b.cd_procedimento
		FROM	W_PLS_ANALISE_REL_AUD_PROC b
		where	b.nr_seq_analise = a.nr_seq_analise
		and	b.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO  LIMIT 1) cd_procedimento_1,
	(	select	b.cd_procedimento
		from	W_PLS_ANALISE_REL_AUD_PROC b
		where	b.nr_seq_analise = a.nr_seq_analise
		and	b.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO
		and	b.nr_sequencia not in (	select	c.nr_sequencia
						from	W_PLS_ANALISE_REL_AUD_PROC c
						where	c.nr_seq_analise = a.nr_seq_analise
						and	c.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO  LIMIT 1)  LIMIT 1) cd_procedimento_2,
	(	select	b.cd_procedimento
		from	W_PLS_ANALISE_REL_AUD_PROC b
		where	b.nr_seq_analise = a.nr_seq_analise
		and	b.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO
		and	b.nr_sequencia not in (	select	c.nr_sequencia
						from	W_PLS_ANALISE_REL_AUD_PROC c
						where	c.nr_seq_analise = a.nr_seq_analise
						and	c.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO  LIMIT 2)  LIMIT 1) cd_procedimento_3,
	(	select	b.cd_procedimento
		from	W_PLS_ANALISE_REL_AUD_PROC b
		where	b.nr_seq_analise = a.nr_seq_analise
		and	b.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO
		and	b.nr_sequencia not in (	select	c.nr_sequencia
						from	W_PLS_ANALISE_REL_AUD_PROC c
						where	c.nr_seq_analise = a.nr_seq_analise
						and	c.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO  LIMIT 3)  LIMIT 1) cd_procedimento_4,
	(	select	b.cd_procedimento
		from	W_PLS_ANALISE_REL_AUD_PROC b
		where	b.nr_seq_analise = a.nr_seq_analise
		and	b.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO
		and	b.nr_sequencia not in (	select	c.nr_sequencia
						from	W_PLS_ANALISE_REL_AUD_PROC c
						where	c.nr_seq_analise = a.nr_seq_analise
						and	c.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO  LIMIT 4)  LIMIT 1) cd_procedimento_5,
	(	select	b.cd_procedimento
		from	W_PLS_ANALISE_REL_AUD_PROC b
		where	b.nr_seq_analise = a.nr_seq_analise
		and	b.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO
		and	b.nr_sequencia not in (	select	c.nr_sequencia
						from	W_PLS_ANALISE_REL_AUD_PROC c
						where	c.nr_seq_analise = a.nr_seq_analise
						and	c.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO  LIMIT 5)  LIMIT 1) cd_procedimento_6,
	(	select	to_char(b.dt_procedimento, 'dd/mm/yyyy')
		from	W_PLS_ANALISE_REL_AUD_PROC b
		where	b.nr_seq_analise = a.nr_seq_analise
		and	b.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO  LIMIT 1) dt_procedimento_1,
	(	select	to_char(b.dt_procedimento, 'dd/mm/yyyy')
		from	W_PLS_ANALISE_REL_AUD_PROC b
		where	b.nr_seq_analise = a.nr_seq_analise
		and	b.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO
		and	b.nr_sequencia not in (	select	c.nr_sequencia
						from	W_PLS_ANALISE_REL_AUD_PROC c
						where	c.nr_seq_analise = a.nr_seq_analise
						and	c.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO  LIMIT 1)  LIMIT 1) dt_procedimento_2,
	(	select	to_char(b.dt_procedimento, 'dd/mm/yyyy')
		from	W_PLS_ANALISE_REL_AUD_PROC b
		where	b.nr_seq_analise = a.nr_seq_analise
		and	b.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO
		and	b.nr_sequencia not in (	select	c.nr_sequencia
						from	W_PLS_ANALISE_REL_AUD_PROC c
						where	c.nr_seq_analise = a.nr_seq_analise
						and	c.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO  LIMIT 2)  LIMIT 1) dt_procedimento_3,
	(	select	to_char(b.dt_procedimento, 'dd/mm/yyyy')
		from	W_PLS_ANALISE_REL_AUD_PROC b
		where	b.nr_seq_analise = a.nr_seq_analise
		and	b.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO
		and	b.nr_sequencia not in (	select	c.nr_sequencia
						from	W_PLS_ANALISE_REL_AUD_PROC c
						where	c.nr_seq_analise = a.nr_seq_analise
						and	c.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO  LIMIT 3)  LIMIT 1) dt_procedimento_4,
	(	select	to_char(b.dt_procedimento, 'dd/mm/yyyy')
		from	W_PLS_ANALISE_REL_AUD_PROC b
		where	b.nr_seq_analise = a.nr_seq_analise
		and	b.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO
		and	b.nr_sequencia not in (	select	c.nr_sequencia
						from	W_PLS_ANALISE_REL_AUD_PROC c
						where	c.nr_seq_analise = a.nr_seq_analise
						and	c.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO  LIMIT 4)  LIMIT 1) dt_procedimento_5,
	(	select	to_char(b.dt_procedimento, 'dd/mm/yyyy')
		from	W_PLS_ANALISE_REL_AUD_PROC b
		where	b.nr_seq_analise = a.nr_seq_analise
		and	b.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO
		and	b.nr_sequencia not in (	select	c.nr_sequencia
						from	W_PLS_ANALISE_REL_AUD_PROC c
						where	c.nr_seq_analise = a.nr_seq_analise
						and	c.NR_SEQ_MAXIMO = a.NR_SEQ_MAXIMO  LIMIT 5)  LIMIT 1) dt_procedimento_6
from	W_PLS_ANALISE_REL_AUD_PROC a
group by a.nr_seq_analise, a.NR_SEQ_MAXIMO;

