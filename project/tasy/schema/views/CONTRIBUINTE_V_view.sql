-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW contribuinte_v (nr_seq_contribuinte, dt_adesao, dt_atualizacao, nm_usuario, cd_pessoa_fisica, cd_cgc, cd_cgc_arrecadador, cd_ident_arrecadador, vl_contribuicao, ie_periodicidade, dt_exclusao, ds_observacao, nm_pessoa_fisica, ds_cgc, ds_cgc_arrecadador, ds_periodicidade) AS SELECT A.NR_SEQ_CONTRIBUINTE,A.DT_ADESAO,A.DT_ATUALIZACAO,A.NM_USUARIO,A.CD_PESSOA_FISICA,A.CD_CGC,A.CD_CGC_ARRECADADOR,A.CD_IDENT_ARRECADADOR,A.VL_CONTRIBUICAO,A.IE_PERIODICIDADE,A.DT_EXCLUSAO,A.DS_OBSERVACAO,
     SUBSTR(OBTER_NOME_PF(B.CD_PESSOA_FISICA),1,255) NM_PESSOA_FISICA, 
     C.DS_RAZAO_SOCIAL DS_CGC, 
     D.DS_RAZAO_SOCIAL DS_CGC_ARRECADADOR, 
	  E.DS_VALOR_DOMINIO DS_PERIODICIDADE 
  FROM contribuinte a
LEFT OUTER JOIN pessoa_fisica b ON (A.CD_PESSOA_FISICA = B.CD_PESSOA_FISICA)
LEFT OUTER JOIN pessoa_juridica c ON (A.CD_CGC = C.CD_CGC)
LEFT OUTER JOIN pessoa_juridica d ON (A.CD_CGC_ARRECADADOR = D.CD_CGC)
LEFT OUTER JOIN valor_dominio e ON (A.IE_PERIODICIDADE = E.VL_DOMINIO)
WHERE E.CD_DOMINIO	    = 719;

