-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW cpoe_material_hemo_item_v (nr_sequencia, cd_interv_hem, cd_mat_hem, cd_unid_medida_dose_hem, ds_hor_hem, dt_inicio_hem, dt_prim_hor_hem, hr_prim_hor_hem, ie_adm_mat_hem, ie_urgencia_mat_hem, ie_via_mat_hem, qt_dose_hem) AS select NR_SEQUENCIA,CD_INTERV_HEM,CD_MAT_HEM,CD_UNID_MEDIDA_DOSE_HEM,DS_HOR_HEM,DT_INICIO_HEM,DT_PRIM_HOR_HEM,HR_PRIM_HOR_HEM,IE_ADM_MAT_HEM,IE_URGENCIA_MAT_HEM,IE_VIA_MAT_HEM,QT_DOSE_HEM
	FROM ( 
		select	 
			nr_sequencia nr_sequencia, 
			cd_interv_hem1 cd_interv_hem, 
			cd_mat_hem1 cd_mat_hem, 
			cd_unid_medida_dose_hem1 cd_unid_medida_dose_hem, 
			ds_hor_hem1 ds_hor_hem, 
			dt_inicio_hem1 dt_inicio_hem, 
			dt_prim_hor_hem1 dt_prim_hor_hem, 
			hr_prim_hor_hem1 hr_prim_hor_hem, 
			ie_adm_mat_hem1 ie_adm_mat_hem, 
			ie_urgencia_mat_hem1 ie_urgencia_mat_hem, 
			ie_via_mat_hem1 ie_via_mat_hem, 
			qt_dose_hem1 qt_dose_hem 
		from CPOE_hemoterapia 
		where	cd_interv_hem1 is not null 
		
union all
 
		select	 
			nr_sequencia nr_sequencia, 
			cd_interv_hem2 cd_interv_hem, 
			cd_mat_hem2 cd_mat_hem, 
			cd_unid_medida_dose_hem2 cd_unid_medida_dose_hem, 
			ds_hor_hem2 ds_hor_hem, 
			dt_inicio_hem2 dt_inicio_hem, 
			dt_prim_hor_hem2 dt_prim_hor_hem, 
			hr_prim_hor_hem2 hr_prim_hor_hem, 
			ie_adm_mat_hem2 ie_adm_mat_hem, 
			ie_urgencia_mat_hem2 ie_urgencia_mat_hem, 
			ie_via_mat_hem2 ie_via_mat_hem, 
			qt_dose_hem2 qt_dose_hem 
		from CPOE_hemoterapia		 
		where	cd_interv_hem2 is not null 
		
union all
 
		select	 
			nr_sequencia nr_sequencia,		 
			cd_interv_hem3 cd_interv_hem, 
			cd_mat_hem3 cd_mat_hem, 
			cd_unid_medida_dose_hem3 cd_unid_medida_dose_hem, 
			ds_hor_hem3 ds_hor_hem, 
			dt_inicio_hem3 dt_inicio_hem, 
			dt_prim_hor_hem3 dt_prim_hor_hem, 
			hr_prim_hor_hem3 hr_prim_hor_hem, 
			ie_adm_mat_hem3 ie_adm_mat_hem, 
			ie_urgencia_mat_hem3 ie_urgencia_mat_hem, 
			ie_via_mat_hem3 ie_via_mat_hem, 
			qt_dose_hem3 qt_dose_hem 
		from CPOE_hemoterapia 
		where	cd_interv_hem3 is not null 
		
union all
 
		select	 
			nr_sequencia nr_sequencia, 
			cd_interv_hem4 cd_interv_hem, 
			cd_mat_hem4 cd_mat_hem, 
			cd_unid_medida_dose_hem4 cd_unid_medida_dose_hem, 
			ds_hor_hem4 ds_hor_hem, 
			dt_inicio_hem4 dt_inicio_hem, 
			dt_prim_hor_hem4 dt_prim_hor_hem, 
			hr_prim_hor_hem4 hr_prim_hor_hem, 
			ie_adm_mat_hem4 ie_adm_mat_hem, 
			ie_urgencia_mat_hem4 ie_urgencia_mat_hem, 
			ie_via_mat_hem4 ie_via_mat_hem, 
			qt_dose_hem4 qt_dose_hem 
		from CPOE_hemoterapia 
		where	cd_interv_hem4 is not null 
		
union all
 
		select	 
			nr_sequencia nr_sequencia, 
			cd_interv_hem5 cd_interv_hem, 
			cd_mat_hem5 cd_mat_hem, 
			cd_unid_medida_dose_hem5 cd_unid_medida_dose_hem, 
			ds_hor_hem5 ds_hor_hem, 
			dt_inicio_hem5 dt_inicio_hem, 
			dt_prim_hor_hem5 dt_prim_hor_hem, 
			hr_prim_hor_hem5 hr_prim_hor_hem, 
			ie_adm_mat_hem5 ie_adm_mat_hem, 
			ie_urgencia_mat_hem5 ie_urgencia_mat_hem, 
			ie_via_mat_hem5 ie_via_mat_hem, 
			qt_dose_hem5 qt_dose_hem 
		from CPOE_hemoterapia 
		where	cd_interv_hem5 is not null 			 
	) alias0order by nr_sequencia;

