-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_conta_pos_proc_v (cd_item_convertido, ds_item_convertido, qt_item, qt_glosa, nr_sequencia, ie_status_faturamento, vl_liberado_material_fat, vl_liberado_co_fat, vl_liberado_hi_fat, vl_glosa_material_fat, vl_glosa_hi_fat, vl_glosa_co_fat, vl_glosa_taxa_co, vl_glosa_taxa_material, vl_glosa_taxa_servico, vl_lib_taxa_co, vl_lib_taxa_material, vl_lib_taxa_servico, vl_taxa_co, vl_taxa_material, vl_taxa_servico, nr_seq_lote_fat, nr_seq_evento_fat, nr_seq_disc_proc, tx_administracao, ds_item_ptu, nr_seq_conta_proc, cd_procedimento, ie_origem_proced, nr_seq_conta, nr_seq_analise, vl_custo_operacional_calc, vl_medico_calc, vl_materiais_calc, nr_seq_lote_disc, nr_seq_sca, dt_competencia_mens, qt_original, vl_calculado, vl_beneficiario, vl_administracao) AS select	cd_procedimento_conv cd_item_convertido,
	(	select 	a.ds_proc_envio
		FROM	pls_conversao_proc a
		where	a.nr_sequencia = nr_seq_regra_conv) ds_item_convertido,
	qt_item,
	qt_glosa,
	nr_sequencia,
	ie_status_faturamento,
	vl_liberado_material_fat,
	vl_liberado_co_fat,
	vl_liberado_hi_fat,
	vl_glosa_material_fat,
	vl_glosa_hi_fat,
	vl_glosa_co_fat,
	vl_glosa_taxa_co,
	vl_glosa_taxa_material,
	vl_glosa_taxa_servico,
	vl_lib_taxa_co,
	vl_lib_taxa_material,
	vl_lib_taxa_servico,
	vl_taxa_co,
	vl_taxa_material,
	vl_taxa_servico,
	nr_seq_lote_fat,
	nr_seq_evento_fat,
	nr_seq_disc_proc,
	tx_administracao,
	ds_item_ptu,
	nr_seq_conta_proc,
	cd_procedimento,
	ie_origem_proced,
	nr_seq_conta,
	nr_seq_analise,
	vl_custo_operacional_calc,
	vl_medico_calc,
	vl_materiais_calc,
	nr_seq_lote_disc,
	nr_seq_sca,
	dt_competencia_mens,
	coalesce(qt_item, 0) + coalesce(qt_glosa, 0) qt_original,
	coalesce(vl_medico_calc, 0) + coalesce(vl_materiais_calc, 0) + coalesce(vl_custo_operacional_calc, 0) +
		coalesce(vl_taxa_co, 0) + coalesce(vl_taxa_material, 0) + coalesce(vl_taxa_servico, 0) vl_calculado,
	coalesce(vl_medico, 0) + coalesce(vl_materiais, 0) + coalesce(vl_custo_operacional, 0) +
		coalesce(vl_lib_taxa_co, 0) + coalesce(vl_lib_taxa_material, 0) + coalesce(vl_lib_taxa_servico, 0) vl_beneficiario,
	coalesce(vl_lib_taxa_co, 0) + coalesce(vl_lib_taxa_material, 0) + coalesce(vl_lib_taxa_servico, 0) vl_administracao
from	pls_conta_pos_proc;

