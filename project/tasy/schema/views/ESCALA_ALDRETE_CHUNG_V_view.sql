-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW escala_aldrete_chung_v (nr_sequencia, nr_seq_apres, qt_pontos, dt_avaliacao, data_aval, ds_item, ds_avaliacao, nm_profissional, nr_seq_pepo, nr_cirurgia) AS SELECT   nr_sequencia,
		 0 nr_seq_apres,
		 qt_aldrete qt_pontos,
		 dt_avaliacao,
		 PKG_DATE_FORMATERS.to_varchar(dt_avaliacao,'short',wheb_usuario_pck.get_cd_estabelecimento,wheb_usuario_pck.get_nm_usuario) data_aval,
         OBTER_DESC_EXPRESSAO(670724) ds_item ,
		 qt_aldrete || ' - ' || SUBSTR(obter_desc_escala_chung(qt_aldrete),1,100) ds_avaliacao,
         SUBSTR(obter_nome_pf(cd_profissional),1,100) nm_profissional,
		 nr_seq_pepo,
		 nr_cirurgia
FROM     escala_aldrete
WHERE coalesce(ie_situacao,'A') = 'A'

union

select   nr_sequencia, 1, qt_aldrete, dt_avaliacao, '',
         obter_desc_expressao(283891) DS_ITEM,
         CASE WHEN ie_atividade=2 THEN  OBTER_DESC_EXPRESSAO(670733) WHEN ie_atividade=1 THEN  OBTER_DESC_EXPRESSAO(670737)  ELSE OBTER_DESC_EXPRESSAO(670744) END , '', nr_seq_pepo, nr_cirurgia
from     escala_aldrete
where	coalesce(ie_situacao,'A') = 'A'

union

select   nr_sequencia, 2, qt_aldrete, dt_avaliacao, '',
         OBTER_DESC_EXPRESSAO(297717) DS_ITEM,
         CASE WHEN ie_respiracao=2 THEN  OBTER_DESC_EXPRESSAO(670745) WHEN ie_respiracao=1 THEN  OBTER_DESC_EXPRESSAO(670749)  ELSE OBTER_DESC_EXPRESSAO(670751) END , '', nr_seq_pepo, nr_cirurgia
from     escala_aldrete
where	coalesce(ie_situacao,'A') = 'A'

union

SELECT   nr_sequencia, 3, qt_aldrete, dt_avaliacao,'',
         OBTER_DESC_EXPRESSAO(296235) DS_ITEM,
         CASE WHEN ie_pressao_arterial=2 THEN  obter_desc_expressao(670752) WHEN ie_pressao_arterial=1 THEN  obter_desc_expressao(670753)  ELSE obter_desc_expressao(670754) END , '', nr_seq_pepo, nr_cirurgia
FROM     escala_aldrete
WHERE	coalesce(ie_situacao,'A') = 'A'

union

SELECT  nr_sequencia, 4, qt_aldrete, dt_avaliacao,'',
        OBTER_DESC_EXPRESSAO(285710) DS_ITEM,
	    CASE WHEN ie_consciencia=2 THEN  OBTER_DESC_EXPRESSAO(670755) WHEN ie_consciencia=1 THEN  OBTER_DESC_EXPRESSAO(670757)  ELSE OBTER_DESC_EXPRESSAO(670758) END , '', nr_seq_pepo, nr_cirurgia
FROM	escala_aldrete
WHERE	coalesce(ie_situacao,'A') = 'A'

union

SELECT   nr_sequencia, 5, qt_aldrete, dt_avaliacao,'',
         OBTER_DESC_EXPRESSAO(285493) DS_ITEM,
         CASE WHEN ie_coloracao=2 THEN  OBTER_DESC_EXPRESSAO(670759) WHEN ie_coloracao=1 THEN  OBTER_DESC_EXPRESSAO(670760)  ELSE OBTER_DESC_EXPRESSAO(670761) END , '', nr_seq_pepo, nr_cirurgia
FROM     escala_aldrete
WHERE	coalesce(ie_situacao,'A') = 'A'

union

SELECT   nr_sequencia, 0, qt_chung, dt_avaliacao,PKG_DATE_FORMATERS.to_varchar(dt_avaliacao,'short',wheb_usuario_pck.get_cd_estabelecimento,wheb_usuario_pck.get_nm_usuario) dt_aval,
         OBTER_DESC_EXPRESSAO(670762) DS_ITEM,qt_chung || ' - ' || SUBSTR(obter_desc_escala_chung(qt_chung),1,100),
         SUBSTR(obter_nome_pf(cd_profissional),1,100) nm_profissional, nr_seq_pepo, nr_cirurgia
FROM     escala_chung
WHERE	coalesce(ie_situacao,'A') = 'A'

union

SELECT   nr_sequencia, 1 , qt_chung, dt_avaliacao, '',
         OBTER_DESC_EXPRESSAO(298520) ds_item,
         CASE WHEN ie_sinais_vitais=2 THEN  OBTER_DESC_EXPRESSAO(670763) WHEN ie_sinais_vitais=1 THEN  OBTER_DESC_EXPRESSAO(670764)  ELSE OBTER_DESC_EXPRESSAO(670765) END  ds_avaliacao, '', nr_seq_pepo, nr_cirurgia
FROM     escala_chung
WHERE	coalesce(ie_situacao,'A') = 'A'

union

SELECT   nr_sequencia, 2, qt_chung, dt_avaliacao, '',
         OBTER_DESC_EXPRESSAO(283891) DS_ITEM,
		   CASE WHEN ie_atividade=2 THEN  OBTER_DESC_EXPRESSAO(670766) WHEN ie_atividade=1 THEN    OBTER_DESC_EXPRESSAO(670767)  ELSE OBTER_DESC_EXPRESSAO(670768) END , '', nr_seq_pepo, nr_cirurgia
FROM     escala_chung
WHERE	coalesce(ie_situacao,'A') = 'A'

union

SELECT   nr_sequencia, 3, qt_chung, dt_avaliacao,'',
         OBTER_DESC_EXPRESSAO(294012) DS_ITEM,
         CASE WHEN ie_nauseas=2 THEN  OBTER_DESC_EXPRESSAO(670769) WHEN ie_nauseas=1 THEN  OBTER_DESC_EXPRESSAO(670770)  ELSE OBTER_DESC_EXPRESSAO(670772) END , '', nr_seq_pepo, nr_cirurgia
FROM     escala_chung
WHERE	coalesce(ie_situacao,'A') = 'A'

union

SELECT   nr_sequencia, 4, qt_chung, dt_avaliacao,'',
         OBTER_DESC_EXPRESSAO(288205) DS_ITEM,
		   CASE WHEN ie_dor=2 THEN  OBTER_DESC_EXPRESSAO(670773)  ELSE OBTER_DESC_EXPRESSAO(670774) END , '', nr_seq_pepo, nr_cirurgia
FROM	   escala_chung
WHERE	coalesce(ie_situacao,'A') = 'A'

union

SELECT   nr_sequencia, 5, qt_chung, dt_avaliacao,'',
         OBTER_DESC_EXPRESSAO(298035) DS_ITEM,
         CASE WHEN ie_sangramento=2 THEN  OBTER_DESC_EXPRESSAO(670776) WHEN ie_sangramento=1 THEN  OBTER_DESC_EXPRESSAO(670777)  ELSE OBTER_DESC_EXPRESSAO(670778) END , '', nr_seq_pepo, nr_cirurgia
FROM     escala_chung
WHERE	coalesce(ie_situacao,'A') = 'A'

UNION

SELECT 	nr_sequencia, 0, qt_pontuacao, dt_avaliacao,PKG_DATE_FORMATERS.to_varchar(dt_avaliacao,'short',wheb_usuario_pck.get_cd_estabelecimento,wheb_usuario_pck.get_nm_usuario) dt_aval,
		OBTER_DESC_EXPRESSAO(670779), qt_pontuacao || '',
		SUBSTR(obter_nome_pf(cd_profissional),1,100) nm_profissional, nr_seq_pepo, nr_cirurgia
FROM    escala_stewart
WHERE	coalesce(ie_situacao,'A') = 'A'

UNION

SELECT nr_sequencia, 2, qt_pontuacao, dt_avaliacao,'' dt_aval,
	   OBTER_DESC_EXPRESSAO(301669) ds_item,
       CASE WHEN IE_VIA_AEREA=2 THEN  OBTER_DESC_EXPRESSAO(670783) WHEN IE_VIA_AEREA=1 THEN  OBTER_DESC_EXPRESSAO(670784)  ELSE OBTER_DESC_EXPRESSAO(670785) END 	ds_avaliacao,'' nm_profissional, nr_seq_pepo, nr_cirurgia
FROM   escala_stewart
WHERE	coalesce(ie_situacao,'A') = 'A'

UNION

SELECT nr_sequencia, 2, qt_pontuacao, dt_avaliacao,'' dt_aval,
	   OBTER_DESC_EXPRESSAO(301669) ds_item,
       CASE WHEN IE_VIA_AEREA=2 THEN  OBTER_DESC_EXPRESSAO(670786) WHEN IE_VIA_AEREA=1 THEN  OBTER_DESC_EXPRESSAO(670787)  ELSE OBTER_DESC_EXPRESSAO(670788) END 	ds_avaliacao,'' nm_profissional, nr_seq_pepo, nr_cirurgia
FROM   escala_stewart
WHERE	coalesce(ie_situacao,'A') = 'A'

UNION

SELECT nr_sequencia, 3, qt_pontuacao, dt_avaliacao,'' dt_aval,
	   OBTER_DESC_EXPRESSAO(293628) ds_item,
       CASE WHEN IE_MOVIMENTO=2 THEN  OBTER_DESC_EXPRESSAO(670789) WHEN IE_MOVIMENTO=1 THEN  OBTER_DESC_EXPRESSAO(670790)  ELSE OBTER_DESC_EXPRESSAO(670791) END 	ds_avaliacao,'' nm_profissional, nr_seq_pepo, nr_cirurgia
FROM   escala_stewart
WHERE	coalesce(ie_situacao,'A') = 'A'

UNION

SELECT nr_sequencia, 4, qt_pontuacao, dt_avaliacao,'' dt_aval,
	   OBTER_DESC_EXPRESSAO(298044) ds_item,
       CASE WHEN IE_SAO2='S' THEN  OBTER_DESC_EXPRESSAO(327113)  ELSE OBTER_DESC_EXPRESSAO(327114) END 	ds_avaliacao,'' nm_profissional, nr_seq_pepo, nr_cirurgia
FROM   escala_stewart
WHERE	coalesce(ie_situacao,'A') = 'A'

UNION

SELECT nr_sequencia, 5, qt_pontuacao, dt_avaliacao,'' dt_aval,
	   OBTER_DESC_EXPRESSAO(294266) ds_item,
       CASE WHEN IE_NORMOTERMIA='S' THEN  OBTER_DESC_EXPRESSAO(327113)  ELSE OBTER_DESC_EXPRESSAO(327114) END 	ds_avaliacao,'' nm_profissional, nr_seq_pepo, nr_cirurgia
FROM   escala_stewart
WHERE	coalesce(ie_situacao,'A') = 'A'

UNION

SELECT nr_sequencia, 6, qt_pontuacao, dt_avaliacao,'' dt_aval,
	   OBTER_DESC_EXPRESSAO(288209) ds_item,
       CASE WHEN IE_DOR_CONTROLADA='S' THEN  OBTER_DESC_EXPRESSAO(327113)  ELSE OBTER_DESC_EXPRESSAO(327114) END 	ds_avaliacao,'' nm_profissional, nr_seq_pepo, nr_cirurgia
FROM   escala_stewart
WHERE	coalesce(ie_situacao,'A') = 'A'

UNION

SELECT nr_sequencia, 7, qt_pontuacao, dt_avaliacao,'' dt_aval,
	   OBTER_DESC_EXPRESSAO(284049) ds_item,
       CASE WHEN IE_AUSENCIA_VOMITO='S' THEN  OBTER_DESC_EXPRESSAO(327113)  ELSE OBTER_DESC_EXPRESSAO(327114) END 	ds_avaliacao,'' nm_profissional, nr_seq_pepo, nr_cirurgia
FROM   escala_stewart
WHERE	coalesce(ie_situacao,'A') = 'A'

UNION

SELECT nr_sequencia, 8, qt_pontuacao, dt_avaliacao,'' dt_aval,
	   OBTER_DESC_EXPRESSAO(284048) ds_item,
       CASE WHEN IE_AUSENCIA_SANGRAMENTO='S' THEN  OBTER_DESC_EXPRESSAO(327113)  ELSE OBTER_DESC_EXPRESSAO(327114) END 	ds_avaliacao,'' nm_profissional, nr_seq_pepo, nr_cirurgia
FROM   escala_stewart
WHERE	coalesce(ie_situacao,'A') = 'A'

UNION

SELECT nr_sequencia, 9, qt_pontuacao, dt_avaliacao,'' dt_aval,
	   OBTER_DESC_EXPRESSAO(298521) ds_item,
       CASE WHEN IE_SINAIS_ESTAVEIS='S' THEN  OBTER_DESC_EXPRESSAO(327113)  ELSE OBTER_DESC_EXPRESSAO(327114) END 	ds_avaliacao,'' nm_profissional, nr_seq_pepo, nr_cirurgia
FROM   escala_stewart
WHERE	coalesce(ie_situacao,'A') = 'A';

