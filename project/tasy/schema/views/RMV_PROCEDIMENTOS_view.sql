-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW rmv_procedimentos (codtabelaorigem, codprocorigem, descorigem, video, codcirurgia) AS select 	substr(CASE WHEN OBTER_VALOR_DOMINIO(30,a.ie_origem_proced)='SUS_2008' THEN 'SUS_08'  ELSE OBTER_VALOR_DOMINIO(30,a.ie_origem_proced) END ,1,6) codtabelaorigem,
	substr(to_char(a.cd_procedimento),1,10) codprocorigem,
	substr(a.ds_procedimento,1,100) descorigem,
	CASE WHEN c.ie_video='S' THEN 1  ELSE 0 END  video,
	substr(to_char(b.nr_cirurgia),1,50) codcirurgia
FROM procedimento a, cirurgia b
LEFT OUTER JOIN proc_interno c ON (b.nr_seq_proc_interno = c.nr_sequencia)
WHERE a.cd_procedimento 	= b.cd_procedimento_princ;

