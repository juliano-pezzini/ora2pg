-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pfcs_ed_dpts_v (ds_content, vl_pfcs, vl_ai, vl_target, cd_estabelecimento, nr_seq_indicator, nr_seq_coloring, qt_hour, ie_disabled) AS SELECT wheb_mensagem_pck.get_texto(1141669) DS_CONTENT, --> Capacity
    concat(pfcs_get_percentage_value(sum(vl_indicator_help), sum(vl_indicator)), '%') VL_PFCS,
    null VL_AI,
    (pfcs_get_percentage_value(sum(vl_indicator_help), sum(vl_indicator)))::numeric  VL_TARGET,
    nr_seq_operational_level CD_ESTABELECIMENTO,
    nr_seq_indicator NR_SEQ_INDICATOR,
    100 NR_SEQ_COLORING,
    null QT_HOUR,
    'S' IE_DISABLED
FROM pfcs_panel
WHERE nr_seq_indicator = 114
    AND ie_situation = 'A'
GROUP BY nr_seq_indicator, nr_seq_operational_level

UNION ALL

SELECT obter_desc_expressao(960928) DS_CONTENT, --> Census
    concat(concat(sum(p.vl_indicator_help), '/' ), sum(p.vl_indicator)) VL_PFCS,
    pfcs_get_simulation_data(p.nr_seq_operational_level, aux.qt_hora, 1, '1') VL_AI,
    (sum(p.vl_indicator_help))::numeric  VL_TARGET,
    p.nr_seq_operational_level CD_ESTABELECIMENTO,
    113 NR_SEQ_INDICATOR,
    113 NR_SEQ_COLORING,
    aux.qt_hora QT_HOUR,
    'N' IE_DISABLED
FROM pfcs_panel p join(WITH RECURSIVE cte AS (
select (rownum-1) qt_hora  level <= 48  UNION ALL
select (rownum-1) qt_hora  level <= 48 JOIN cte c ON ()

) SELECT * FROM cte;
) aux on aux.qt_hora <= 48
WHERE p.nr_seq_indicator = 114
    AND p.ie_situation = 'A'
GROUP BY p.nr_seq_operational_level, p.nr_seq_indicator, aux.qt_hora

UNION ALL

SELECT wheb_mensagem_pck.get_texto(1151722) DS_CONTENT, --> ED Available Beds
    to_char(sum(p.vl_indicator_aux)) VL_PFCS,
    to_char(sum(p.vl_indicator_assist) - (pfcs_get_simulation_data(p.nr_seq_operational_level, aux.qt_hora, 1, '1'))::numeric ) VL_AI,
    (sum(p.vl_indicator_aux))::numeric  VL_TARGET,
    p.nr_seq_operational_level CD_ESTABELECIMENTO,
    121 NR_SEQ_INDICATOR,
    121 NR_SEQ_COLORING,
    aux.qt_hora QT_HOUR,
    'N' IE_DISABLED
FROM pfcs_panel p join(WITH RECURSIVE cte AS (
select (rownum-1) qt_hora  level <= 48  UNION ALL
select (rownum-1) qt_hora  level <= 48 JOIN cte c ON ()

) SELECT * FROM cte;
) aux on aux.qt_hora <= 48
WHERE p.nr_seq_indicator = 114
    AND p.ie_situation = 'A'
GROUP BY p.nr_seq_indicator, p.nr_seq_operational_level, aux.qt_hora

UNION ALL

SELECT wheb_mensagem_pck.get_texto(1210531) DS_CONTENT, --> ED Unavailable Beds
    to_char(sum(p.vl_indicator_help) + sum(p.vl_indicator_collab)) VL_PFCS,
    null VL_AI,
    (sum(p.vl_indicator_help) + sum(p.vl_indicator_collab))::numeric  VL_TARGET,
    p.nr_seq_operational_level CD_ESTABELECIMENTO,
    416 NR_SEQ_INDICATOR,
    416 NR_SEQ_COLORING,
    aux.qt_hora QT_HOUR,
    'N' IE_DISABLED
FROM pfcs_panel p join(WITH RECURSIVE cte AS (
select (rownum-1) qt_hora  level <= 48  UNION ALL
select (rownum-1) qt_hora  level <= 48 JOIN cte c ON ()

) SELECT * FROM cte;
) aux on aux.qt_hora <= 48
WHERE p.nr_seq_indicator = 114
    AND p.ie_situation = 'A'
GROUP BY p.nr_seq_indicator, p.nr_seq_operational_level, aux.qt_hora

UNION ALL

SELECT obter_desc_expressao(1081127) DS_CONTENT, --> ED Admissions
    to_char(sum(p.vl_indicator)) VL_PFCS,
    pfcs_get_simulation_data(p.nr_seq_operational_level, aux.qt_hora, 2, '1') VL_AI,
    (sum(p.vl_indicator))::numeric  VL_TARGET,
    p.nr_seq_operational_level CD_ESTABELECIMENTO,
    p.nr_seq_indicator NR_SEQ_INDICATOR,
    p.nr_seq_indicator NR_SEQ_COLORING,
    aux.qt_hora QT_HOUR,
    'N' IE_DISABLED
FROM pfcs_panel p join(WITH RECURSIVE cte AS (
select (rownum-1) qt_hora  level <= 48  UNION ALL
select (rownum-1) qt_hora  level <= 48 JOIN cte c ON ()

) SELECT * FROM cte;
) aux on aux.qt_hora <= 48
WHERE p.nr_seq_indicator = 115
    AND p.ie_situation = 'A'
GROUP BY p.nr_seq_indicator, p.nr_seq_operational_level, aux.qt_hora

UNION ALL

SELECT wheb_mensagem_pck.get_texto(1151651) DS_CONTENT, --> Potential Admits
    to_char(sum(vl_indicator)) VL_PFCS,
    null VL_AI,
    (sum(vl_indicator))::numeric  VL_TARGET,
    nr_seq_operational_level CD_ESTABELECIMENTO,
    nr_seq_indicator NR_SEQ_INDICATOR,
    166 NR_SEQ_COLORING,
    null QT_HOUR,
    'N' IE_DISABLED
FROM pfcs_panel
WHERE nr_seq_indicator = 116
    AND ie_situation = 'A'
GROUP BY nr_seq_indicator, nr_seq_operational_level

UNION ALL

SELECT wheb_mensagem_pck.get_texto(1157506) DS_CONTENT, --> ED Boarders
    to_char(Sum(vl_indicator)) VL_PFCS,
    null VL_AI,
    (Sum(vl_indicator))::numeric  VL_TARGET,
    nr_seq_operational_level CD_ESTABELECIMENTO,
    nr_seq_indicator NR_SEQ_INDICATOR,
    167 NR_SEQ_COLORING,
    null QT_HOUR,
    'N' IE_DISABLED
FROM pfcs_panel
WHERE nr_seq_indicator = 117
    AND ie_situation ='A'
GROUP BY nr_seq_indicator, nr_seq_operational_level

UNION ALL

SELECT obter_desc_expressao(1039023) DS_CONTENT, --> Observation/Holding
    to_char(sum(vl_indicator)) VL_PFCS,
    null VL_AI,
    (sum(vl_indicator))::numeric  VL_TARGET,
    nr_seq_operational_level CD_ESTABELECIMENTO,
    nr_seq_indicator NR_SEQ_INDICATOR,
    168 NR_SEQ_COLORING,
    null QT_HOUR,
    'N' IE_DISABLED
FROM pfcs_panel
WHERE nr_seq_indicator = 118
    AND ie_situation ='A'
GROUP BY nr_seq_indicator, nr_seq_operational_level

UNION ALL

SELECT wheb_mensagem_pck.get_texto(1211837) DS_CONTENT, --> Direct Admit
    to_char(sum(vl_indicator)) VL_PFCS,
    null VL_AI,
    (sum(vl_indicator_aux))::numeric  VL_TARGET,
    nr_seq_operational_level CD_ESTABELECIMENTO,
    119 NR_SEQ_INDICATOR,
    119 NR_SEQ_COLORING,
    null QT_HOUR,
    'N' IE_DISABLED
FROM pfcs_panel
WHERE nr_seq_indicator = 119
    AND ie_situation = 'A'
GROUP BY nr_seq_indicator, nr_seq_operational_level

UNION ALL

SELECT wheb_mensagem_pck.get_texto(1146250) DS_CONTENT, --> Transfers
    to_char(sum(vl_indicator)) VL_PFCS,
    null VL_AI,
    (sum(vl_indicator_aux))::numeric  VL_TARGET,
    nr_seq_operational_level CD_ESTABELECIMENTO,
    120 NR_SEQ_INDICATOR,
    120 NR_SEQ_COLORING,
    null QT_HOUR,
    'N' IE_DISABLED
FROM pfcs_panel
WHERE nr_seq_indicator = 120
    AND ie_situation = 'A'
GROUP BY nr_seq_indicator, nr_seq_operational_level

UNION ALL

SELECT wheb_mensagem_pck.get_texto(1157590) DS_CONTENT, --> Inpatient Admits Delays
    to_char(sum(vl_indicator_aux)) VL_PFCS,
    null VL_AI,
    (sum(vl_indicator_aux))::numeric  VL_TARGET,
    nr_seq_operational_level CD_ESTABELECIMENTO,
    149 NR_SEQ_INDICATOR,
    149 NR_SEQ_COLORING,
    null QT_HOUR,
    'N' IE_DISABLED
FROM pfcs_panel
WHERE nr_seq_indicator = 115
GROUP BY nr_seq_indicator, nr_seq_operational_level

UNION ALL

SELECT wheb_mensagem_pck.get_texto(1157591) DS_CONTENT, --> Admits to OR
    to_char(sum(vl_indicator)) VL_PFCS,
    null VL_AI,
    (sum(vl_indicator))::numeric  VL_TARGET,
    nr_seq_operational_level CD_ESTABELECIMENTO,
    nr_seq_indicator NR_SEQ_INDICATOR,
    nr_seq_indicator NR_SEQ_COLORING,
    null QT_HOUR,
    'N' IE_DISABLED
FROM pfcs_panel
WHERE nr_seq_indicator = 150
GROUP BY nr_seq_indicator, nr_seq_operational_level

UNION ALL

SELECT wheb_mensagem_pck.get_texto(1157592) DS_CONTENT, --> ED Discharges
    to_char(sum(p.vl_indicator)) VL_PFCS,
    pfcs_get_simulation_data(p.nr_seq_operational_level, aux.qt_hora, 3, '1') VL_AI,
    (sum(p.vl_indicator))::numeric  VL_TARGET,
    p.nr_seq_operational_level CD_ESTABELECIMENTO,
    p.nr_seq_indicator NR_SEQ_INDICATOR,
    p.nr_seq_indicator NR_SEQ_COLORING,
    aux.qt_hora QT_HOUR,
    'N' IE_DISABLED
FROM pfcs_panel p join(WITH RECURSIVE cte AS (
select (rownum-1) qt_hora  level <= 48  UNION ALL
select (rownum-1) qt_hora  level <= 48 JOIN cte c ON ()

) SELECT * FROM cte;
) aux on aux.qt_hora <= 48
WHERE p.nr_seq_indicator = 139
    AND p.ie_situation = 'A'
GROUP BY p.nr_seq_indicator, p.nr_seq_operational_level, aux.qt_hora

UNION ALL

SELECT wheb_mensagem_pck.get_texto(1147479) DS_CONTENT, --> Discharge Delays
    to_char(sum(vl_indicator_aux)) VL_PFCS,
    null VL_AI,
    (sum(vl_indicator_aux))::numeric  VL_TARGET,
    nr_seq_operational_level CD_ESTABELECIMENTO,
    151 NR_SEQ_INDICATOR,
    151 NR_SEQ_COLORING,
    null QT_HOUR,
    'S' IE_DISABLED
FROM pfcs_panel
WHERE nr_seq_indicator = 139
    AND ie_situation = 'A'
GROUP BY nr_seq_indicator, nr_seq_operational_level

UNION ALL

SELECT wheb_mensagem_pck.get_texto(1157593) DS_CONTENT, --> Average disposition for admission time
    to_char(get_time_by_minutes(dividir(sum(vl_indicator), sum(vl_indicator_aux)))) VL_PFCS,
    null VL_AI,
    dividir(sum(vl_indicator), sum(vl_indicator_aux)) VL_TARGET,
    nr_seq_operational_level CD_ESTABELECIMENTO,
    nr_seq_indicator NR_SEQ_INDICATOR,
    nr_seq_indicator NR_SEQ_COLORING,
    null QT_HOUR,
    'S' IE_DISABLED
FROM pfcs_panel
WHERE nr_seq_indicator = 152
    AND ie_situation = 'A'
GROUP BY nr_seq_indicator, nr_seq_operational_level

UNION ALL

SELECT wheb_mensagem_pck.get_texto(1159612) DS_CONTENT, --> Average time to emergency OR
    get_time_by_minutes(PFCS_GET_AVG_REQUEST_TIME(nr_seq_indicator, nr_seq_operational_level, null)) VL_PFCS,
    null VL_AI,
    null VL_TARGET,
    nr_seq_operational_level CD_ESTABELECIMENTO,
    159 NR_SEQ_INDICATOR,
    159 NR_SEQ_COLORING,
    null QT_HOUR,
    'S' IE_DISABLED
FROM pfcs_panel
WHERE nr_seq_indicator = 150
    AND ie_situation = 'A'
GROUP BY nr_seq_indicator, nr_seq_operational_level

UNION ALL

SELECT wheb_mensagem_pck.get_texto(1157594) DS_CONTENT, --> Average LOS
    get_time_by_minutes(avg(vl_indicator)) VL_PFCS,
    null VL_AI,
    avg(vl_indicator) VL_TARGET,
    nr_seq_operational_level CD_ESTABELECIMENTO,
    nr_seq_indicator NR_SEQ_INDICATOR,
    nr_seq_indicator NR_SEQ_COLORING,
    null QT_HOUR,
    'S' IE_DISABLED
FROM pfcs_panel
WHERE nr_seq_indicator = 153
    AND ie_situation = 'A'
GROUP BY nr_seq_indicator, nr_seq_operational_level;

