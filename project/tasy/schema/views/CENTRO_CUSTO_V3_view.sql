-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW centro_custo_v3 (cd_centro_custo, ds_centro_custo, ie_situacao, dt_atualizacao, nm_usuario, nr_seq_terceiro, cd_grupo, cd_classificacao, ie_tipo, cd_estabelecimento, cd_centro_custo_consumo, cd_sistema_contabil, ie_tipo_custo, ie_periodo_proj_receita, dt_atualizacao_nrec, nm_usuario_nrec, dt_fim_contabil, ds_observacao, cd_centro_custo_ref, ie_motivo_desconto, ie_motivo_desc_titulo, ds_centro_custo_ref) AS select  a.CD_CENTRO_CUSTO,a.DS_CENTRO_CUSTO,a.IE_SITUACAO,a.DT_ATUALIZACAO,a.NM_USUARIO,a.NR_SEQ_TERCEIRO,a.CD_GRUPO,a.CD_CLASSIFICACAO,a.IE_TIPO,a.CD_ESTABELECIMENTO,a.CD_CENTRO_CUSTO_CONSUMO,a.CD_SISTEMA_CONTABIL,a.IE_TIPO_CUSTO,a.IE_PERIODO_PROJ_RECEITA,a.DT_ATUALIZACAO_NREC,a.NM_USUARIO_NREC,a.DT_FIM_CONTABIL,a.DS_OBSERVACAO,a.CD_CENTRO_CUSTO_REF,
    coalesce((select max('S')
    FROM    centro_motivo_desconto x
    where   x.cd_centro_custo   = a.cd_centro_custo),'N') ie_motivo_desconto,
    coalesce((select max('S')
    from    motivo_desconto_cc x
    where   x.cd_centro_custo   = a.cd_centro_custo),'N') ie_motivo_desc_titulo,
    substr(obter_desc_centro_custo(a.cd_centro_custo_ref),1,255) ds_centro_custo_ref
from    centro_custo a;

