-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_ordem_servico_v40_v (cd_transacao, ie_tipo_registro, nr_sequencia, nr_seq_requisicao, nr_seq_guia, ie_tipo_cliente, cd_unimed_executora, cd_unimed_beneficiario, cd_unimed, cd_usuario_plano, nr_via_cartao, nr_seq_origem, ie_urg_emerg, dt_validade, nm_benficiario, dt_prov_atendimento, cd_doenca_cid, cd_unimed_prestador_req, nr_seq_prestador_req, cd_unimed_prestador, nr_seq_prestador, cd_especialidade, cd_unimed_solicitante, nr_transacao_solicitante, nm_prestador, sg_conselho_profissional, nr_conselho_profissional, uf_conselho_profissional, ds_observacao, ds_ind_clinica, ie_tipo_tabela, cd_servico, qt_servico_aut, ds_opme, ds_fim) AS select	00606				cd_transacao,
	1				ie_tipo_registro,
	nr_sequencia			nr_sequencia,
	nr_seq_requisicao		nr_seq_requisicao,
	nr_seq_guia			nr_seq_guia,
	CASE WHEN ie_tipo_cliente='U' THEN 'UNIMED' WHEN ie_tipo_cliente='P' THEN 'PORTAL' WHEN ie_tipo_cliente='R' THEN 'PRESTADOR' END  ie_tipo_cliente,
	cd_unimed_executora		cd_unimed_executora,
	cd_unimed_beneficiario		cd_unimed_beneficiario,
	cd_unimed			cd_unimed,
	cd_usuario_plano		cd_usuario_plano,
	nr_via_cartao			nr_via_cartao,
	nr_seq_origem			nr_seq_origem,
	ie_urg_emerg			ie_urg_emerg,
	dt_validade			dt_validade,
	nm_benficiario			nm_benficiario,
	dt_prov_atendimento		dt_prov_atendimento,
	cd_doenca_cid			cd_doenca_cid,
	cd_unimed_prestador_req		cd_unimed_prestador_req,
	nr_seq_prestador_req		nr_seq_prestador_req,
	cd_unimed_prestador		cd_unimed_prestador,
	nr_seq_prestador		nr_seq_prestador,
	cd_especialidade		cd_especialidade,
	cd_unimed_solicitante		cd_unimed_solicitante,
	nr_transacao_solicitante	nr_transacao_solicitante,
	nm_prestador			nm_prestador,
	sg_conselho_profissional	sg_conselho_profissional,
	nr_conselho_profissional	nr_conselho_profissional,
	uf_conselho_profissional	uf_conselho_profissional,
	null				ds_observacao,
	null				ds_ind_clinica,
	null				ie_tipo_tabela,
	null				cd_servico,
	null				qt_servico_aut,
	null				ds_opme,
	null				ds_fim
FROM	ptu_requisicao_ordem_serv

union

select	null				cd_transacao,
	2				ie_tipo_registro,
	nr_sequencia			nr_sequencia,
	nr_seq_requisicao		nr_seq_requisicao,
	nr_seq_guia			nr_seq_guia,
	null				ie_tipo_cliente,
	null				cd_unimed_executora,
	null				cd_unimed_beneficiario,
	null				cd_unimed,
	null				cd_usuario_plano,
	null				nr_via_cartao,
	null				nr_seq_origem,
	null				ie_urg_emerg,
	null				dt_validade,
	null				nm_benficiario,
	null				dt_prov_atendimento,
	null				cd_doenca_cid,
	null				cd_unimed_prestador_req,
	null				nr_seq_prestador_req,
	null				cd_unimed_prestador,
	null				nr_seq_prestador,
	null				cd_especialidade,
	null				cd_unimed_solicitante,
	null				nr_transacao_solicitante,
	null				nm_prestador,
	null				sg_conselho_profissional,
	null				nr_conselho_profissional,
	null				uf_conselho_profissional,
	Elimina_Acentuacao(ds_observacao) ds_observacao,
	Elimina_Acentuacao(ds_ind_clinica) ds_ind_clinica,
	null				ie_tipo_tabela,
	null				cd_servico,
	null				qt_servico_aut,
	null				ds_opme,
	null				ds_fim
from	ptu_requisicao_ordem_serv

union

select	null				cd_transacao,
	4				ie_tipo_registro,
	nr_seq_req_ord			nr_sequencia,
	nr_seq_requisicao		nr_seq_requisicao,
	nr_seq_guia			nr_seq_guia,
	null				ie_tipo_cliente,
	null				cd_unimed_executora,
	null				cd_unimed_beneficiario,
	null				cd_unimed,
	null				cd_usuario_plano,
	null				nr_via_cartao,
	null				nr_seq_origem,
	null				ie_urg_emerg,
	null				dt_validade,
	null				nm_benficiario,
	null				dt_prov_atendimento,
	null				cd_doenca_cid,
	null				cd_unimed_prestador_req,
	null				nr_seq_prestador_req,
	null				cd_unimed_prestador,
	null				nr_seq_prestador,
	null				cd_especialidade,
	null				cd_unimed_solicitante,
	null				nr_transacao_solicitante,
	null				nm_prestador,
	null				sg_conselho_profissional,
	null				nr_conselho_profissional,
	null				uf_conselho_profissional,
	null				ds_observacao,
	null				ds_ind_clinica,
	ie_tipo_tabela			ie_tipo_tabela,
	cd_servico			cd_servico,
	qt_servico_aut			qt_servico_aut,
	Elimina_Acentuacao(ds_opme)	ds_opme,
	null				ds_fim
from	ptu_req_ord_serv_servico	b,
	ptu_requisicao_ordem_serv	a
where	b.nr_seq_req_ord	= a.nr_sequencia

union

select	null				cd_transacao,
	5				ie_tipo_registro,
	nr_sequencia			nr_sequencia,
	nr_seq_requisicao		nr_seq_requisicao,
	nr_seq_guia			nr_seq_guia,
	null				ie_tipo_cliente,
	null				cd_unimed_executora,
	null				cd_unimed_beneficiario,
	null				cd_unimed,
	null				cd_usuario_plano,
	null				nr_via_cartao,
	null				nr_seq_origem,
	null				ie_urg_emerg,
	null				dt_validade,
	null				nm_benficiario,
	null				dt_prov_atendimento,
	null				cd_doenca_cid,
	null				cd_unimed_prestador_req,
	null				nr_seq_prestador_req,
	null				cd_unimed_prestador,
	null				nr_seq_prestador,
	null				cd_especialidade,
	null				cd_unimed_solicitante,
	null				nr_transacao_solicitante,
	null				nm_prestador,
	null				sg_conselho_profissional,
	null				nr_conselho_profissional,
	null				uf_conselho_profissional,
	null				ds_observacao,
	null				ds_ind_clinica,
	null				ie_tipo_tabela,
	null				cd_servico,
	null				qt_servico_aut,
	null				ds_opme,
	'FIM$'				ds_fim
from	ptu_requisicao_ordem_serv;

