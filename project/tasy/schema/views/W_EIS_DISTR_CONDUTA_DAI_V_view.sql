-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW w_eis_distr_conduta_dai_v (cd_setor, ds_setor_atendimento, dt_avaliacao, ds_sexo, ie_faixa_etaria, ds_conduta, ds_protocolo, na, nr_sequencia) AS select	distinct
	Obter_Setor_Atendimento(b.nr_atendimento) cd_setor, 
	SUBSTR(obter_nome_setor(Obter_Setor_Atendimento(b.nr_atendimento)),1,255) ds_Setor_Atendimento,	 
	TRUNC(b.dt_atualizacao_nrec) dt_avaliacao, 
	SUBSTR(obter_sexo_pf(OBTER_PESSOA_ATENDIMENTO(b.nr_atendimento,'C'),'D'),1,20) ds_sexo, 
	SUBSTR(Obter_desc_ficha_DAI(null,'E',b.dt_atualizacao_nrec,obter_data_nascto_pf(OBTER_PESSOA_ATENDIMENTO(b.nr_atendimento,'C'))),1,80) ie_faixa_etaria, 
	d.ds_acao ds_conduta, 
	c.ds_regra ds_protocolo,	 
	b.nr_atendimento NA, 
	d.nr_sequencia 
FROM	pe_prescricao a, 
	gqa_pendencia_pac b,	 
	gqa_pendencia_regra c,	 
	gqa_pend_pac_acao f, 
	pe_prescr_proc g, 
	gqa_acao d, 
	eif_escala h 
where	a.nr_seq_pend_pac_acao = f.nr_sequencia 
and	f.nr_seq_pend_pac = b.nr_sequencia 
and	b.nr_seq_pend_regra = c.nr_sequencia 
and	g.nr_seq_prescr = a.nr_sequencia 
and	d.nr_Seq_proc = g.nr_seq_proc 
and	d.nr_seq_pend_regra = c.nr_Sequencia 
and	c.nr_seq_escala = 117 
and	c.nr_seq_score_flex = h.nr_sequencia 
and	upper(h.ds_escala) like upper('%dermatite%') 
and	c.nr_seq_result is not null;

