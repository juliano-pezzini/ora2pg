-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW adiantamento_v (nr_adiantamento, cd_estabelecimento, dt_atualizacao, nm_usuario, dt_adiantamento, vl_adiantamento, vl_especie, vl_saldo, cd_moeda, cd_tipo_recebimento, cd_pessoa_fisica, cd_cgc, nr_atendimento, cd_banco, cd_agencia_bancaria, cd_cgc_emp_cred, nr_cartao_cred, nr_documento_cred, nr_lote_contabil, ds_observacao, dt_baixa, nr_seq_trans_fin, dt_contabil, ie_situacao, nr_recibo, nr_seq_trans_caixa, nr_seq_caixa_rec, ie_lib_caixa, dt_autenticacao, nr_seq_conta_banco, nr_documento, nr_seq_proposta_pagador, ie_franquia, nr_seq_contrato, nr_seq_tit_rec_cobr, nr_seq_tipo, nr_seq_viagem, nr_titulo_duplicidade, nr_seq_grupo_prod, cd_pessoa_adiant, ds_razao_social, ds_moeda, ds_tipo_recebimento, nm_pessoa_juridica, nm_pessoa_fisica, ds_banco, nm_pessoa_adiant, ie_status, nm_usuario_nrec, dt_atualizacao_nrec, nr_nota_fiscal) AS Select 	a.NR_ADIANTAMENTO,
	a.CD_ESTABELECIMENTO,
	a.DT_ATUALIZACAO,
	a.NM_USUARIO,
	a.DT_ADIANTAMENTO,
	a.VL_ADIANTAMENTO,
	a.VL_ESPECIE,
	a.VL_SALDO,
	a.CD_MOEDA,
	a.CD_TIPO_RECEBIMENTO,
	a.CD_PESSOA_FISICA,
	a.CD_CGC,
	a.NR_ATENDIMENTO,
	a.CD_BANCO,
	a.CD_AGENCIA_BANCARIA,
	a.CD_CGC_EMP_CRED,
	a.NR_CARTAO_CRED,
	a.NR_DOCUMENTO_CRED,
	a.NR_LOTE_CONTABIL,
	a.DS_OBSERVACAO,
	a.DT_BAIXA,
	a.NR_SEQ_TRANS_FIN,
	a.DT_CONTABIL,
	a.IE_SITUACAO,
	a.NR_RECIBO,
	a.NR_SEQ_TRANS_CAIXA,
	a.NR_SEQ_CAIXA_REC,
	a.IE_LIB_CAIXA,
	a.DT_AUTENTICACAO,
	a.NR_SEQ_CONTA_BANCO,
	a.NR_DOCUMENTO,
	a.NR_SEQ_PROPOSTA_PAGADOR,
	a.IE_FRANQUIA,
	a.NR_SEQ_CONTRATO,
	a.NR_SEQ_TIT_REC_COBR,
	a.NR_SEQ_TIPO,
	a.NR_SEQ_VIAGEM,
	a.NR_TITULO_DUPLICIDADE,
	a.NR_SEQ_GRUPO_PROD,
	a.CD_PESSOA_ADIANT,
          	c.ds_razao_social,
          	d.ds_moeda,
          	e.ds_tipo_recebimento,
          	f.ds_razao_social nm_pessoa_juridica,
			substr(obter_nome_pf(g.cd_pessoa_fisica),1,255) nm_pessoa_fisica,
          	h.ds_banco,
	substr(obter_nome_pf_pj(a.cd_pessoa_fisica, a.cd_cgc),1,100) nm_pessoa_adiant,
	a.IE_STATUS,
	a.nm_usuario_nrec,
	a.dt_atualizacao_nrec,
    obter_nr_nota_fiscal_adiant(a.nr_adiantamento) nr_nota_fiscal
FROM tipo_recebimento e, moeda d, pessoa_juridica c, estabelecimento b, adiantamento a
LEFT OUTER JOIN pessoa_juridica f ON (a.cd_cgc = f.cd_cgc)
LEFT OUTER JOIN pessoa_fisica g ON (a.cd_pessoa_fisica = g.cd_pessoa_fisica)
LEFT OUTER JOIN banco h ON (a.cd_banco = h.cd_banco)
WHERE a.cd_estabelecimento = b.cd_estabelecimento and b.cd_cgc = c.cd_cgc and a.cd_moeda = d.cd_moeda and a.cd_tipo_recebimento = e.cd_tipo_recebimento;

