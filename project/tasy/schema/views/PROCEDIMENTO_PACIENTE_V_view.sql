-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW procedimento_paciente_v (nr_sequencia, nr_atendimento, dt_entrada_unidade, cd_procedimento, dt_procedimento, qt_procedimento, dt_atualizacao, nm_usuario, cd_medico, cd_convenio, cd_categoria, cd_pessoa_fisica, dt_prescricao, ds_observacao, vl_procedimento, vl_medico, vl_anestesista, vl_materiais, cd_edicao_amb, cd_tabela_servico, dt_vigencia_preco, cd_procedimento_princ, dt_procedimento_princ, dt_acerto_conta, dt_acerto_convenio, dt_acerto_medico, vl_auxiliares, vl_custo_operacional, tx_medico, tx_anestesia, nr_prescricao, nr_sequencia_prescricao, cd_motivo_exc_conta, ds_compl_motivo_excon, cd_acao, qt_devolvida, cd_motivo_devolucao, nr_cirurgia, nr_doc_convenio, cd_medico_executor, ie_cobra_pf_pj, nr_laudo, dt_conta, cd_setor_atendimento, cd_conta_contabil, cd_procedimento_aih, ie_origem_proced, nr_aih, ie_responsavel_credito, tx_procedimento, cd_equipamento, ie_valor_informado, cd_estabelecimento_custo, cd_tabela_custo, cd_situacao_glosa, nr_lote_contabil, cd_procedimento_convenio, nr_seq_autorizacao, ie_tipo_servico_sus, ie_tipo_ato_sus, cd_cgc_prestador, nr_nf_prestador, cd_atividade_prof_bpa, nr_interno_conta, nr_seq_proc_princ, ie_guia_informada, dt_inicio_procedimento, ie_emite_conta, ie_funcao_medico, ie_classif_sus, cd_especialidade, nm_usuario_original, nr_seq_proc_pacote, ie_tipo_proc_sus, cd_setor_receita, vl_adic_plant, qt_porte_anestesico, tx_hora_extra, ie_emite_conta_honor, nr_seq_atepacu, ie_proc_princ_atend, cd_medico_req, ie_tipo_guia, ie_video, nr_doc_interno, ie_auditoria, nr_seq_grupo_rec, cd_medico_convenio, cd_motivo_ajuste, ie_via_acesso, nr_seq_cor_exec, nr_seq_exame, ie_intercorrencia, nr_seq_origem, ie_dispersao, cd_setor_paciente, nr_seq_conta_origem, nr_seq_parcial, nr_seq_proc_interno, cd_senha, nr_seq_aih, nr_doc_honor_conv, dt_conferencia, ie_tipo_atend_bpa, ie_grupo_atend_bpa, cd_cgc_prestador_conta, cd_medico_exec_conta, nr_seq_pq_proc, qt_filme, nr_seq_proc_crit_repasse, cd_autor_convenio, cd_senha_autor, nr_seq_regra_lanc, ie_tiss_tipo_guia, nr_seq_tiss_tabela, nr_minuto_duracao, ie_tiss_tipo_guia_honor, nr_seq_regra_preco, ie_tiss_tipo_guia_desp, ie_tecnica_utilizada, ie_tiss_tipo_despesa, cd_cgc_prestador_tiss, cd_cgc_honorario_tiss, ie_integracao, nr_seq_proc_acerto, vl_original_tabela, cd_doenca_cid, nr_seq_apac, nr_seq_ajuste_proc, cd_tab_custo_preco, nr_seq_proc_autor, ie_doc_executor, nr_seq_regra_doc, cd_cbo, cd_prestador_tiss, cd_cgc_prest_solic_tiss, cd_setor_resp, dt_final_procedimento, ie_tiss_desp_honor, cd_prest_resp, nr_seq_proc_est, cd_medico_exec_tiss, ds_proc_tiss, nr_seq_tamanho_filme, ds_prestador_tiss, nr_seq_proc_crit_hor, nr_seq_reg_template, cd_procedimento_tuss, ie_ratear_item, ie_complexidade, ie_tipo_financiamento, cd_funcao, cd_perfil, nr_seq_regra_qtde_exec, cd_centro_custo_receita, nr_seq_regra_guia_tiss, nr_seq_regra_honor_tiss, ie_tipo_atend_tiss, vl_desp_tiss, ie_resp_cred_manual, nr_seq_just_valor_inf, cd_medico_solic_tiss, cd_medico_prof_solic_tiss, vl_repasse_calc, tx_custo_oper_qt, ie_spect, nr_seq_agenda_rxt, cd_prestador_solic_tiss, ds_prestador_solic_tiss, vl_tx_desconto, vl_tx_adm, cd_medico_honor_tiss, nr_controle, nr_seq_regra_taxa_cir, nr_seq_proc_orig, nr_sequencia_gas, nr_seq_etapa_checkup, nr_seq_checkup_etapa, ie_via_hemodinamica, cd_regra_repasse, ie_trat_conta_rn, nr_seq_reg_proced, nr_seq_pepo, nr_seq_motivo_incl, dt_conversao_manual, cd_cgc_prest_honor_tiss, nr_seq_transfusao, nr_seq_reserva, ie_lado, nr_seq_hc_equipamento, dt_vinc_proced_adic, ds_indicacao, cd_tipo_anestesia, nr_seq_material, ie_carater_cirurgia, cd_medico_prev_laudo, ds_just_valor_inf, nr_fone_integracao, dt_ligacao_integracao, nr_seq_lanc_acao, ds_just_alter_data, nr_seq_proc_ditado, nr_seq_orig_audit, nr_seq_servico, nr_seq_servico_classif, nr_seq_sus_equipe, nr_seq_crit_honorario, ie_tx_cir_tempo, nr_seq_pe_prescr, nr_seq_prescr_mat, nr_seq_solucao, cd_medico_autenticacao, dt_autenticacao, ds_biometria, nr_seq_proc_desdob, cd_medico_residente, ie_retorno, nr_ato_ipasgo, nr_seq_conta_reversao, nr_seq_regra_pepo, ds_proc_tuss, nr_seq_tuss_item, ds_procedimento, cd_laudo_padrao, cd_kit_material, ie_classificacao, ds_proc_convenio, cd_proc_convenio, cd_funcao_medico, nm_medico_executor, ds_proc_interno_conv) AS select		/* +index(b procedi_pk) */
		a.NR_SEQUENCIA,a.NR_ATENDIMENTO,a.DT_ENTRADA_UNIDADE,a.CD_PROCEDIMENTO,a.DT_PROCEDIMENTO,a.QT_PROCEDIMENTO,a.DT_ATUALIZACAO,a.NM_USUARIO,a.CD_MEDICO,a.CD_CONVENIO,a.CD_CATEGORIA,a.CD_PESSOA_FISICA,a.DT_PRESCRICAO,a.DS_OBSERVACAO,a.VL_PROCEDIMENTO,a.VL_MEDICO,a.VL_ANESTESISTA,a.VL_MATERIAIS,a.CD_EDICAO_AMB,a.CD_TABELA_SERVICO,a.DT_VIGENCIA_PRECO,a.CD_PROCEDIMENTO_PRINC,a.DT_PROCEDIMENTO_PRINC,a.DT_ACERTO_CONTA,a.DT_ACERTO_CONVENIO,a.DT_ACERTO_MEDICO,a.VL_AUXILIARES,a.VL_CUSTO_OPERACIONAL,a.TX_MEDICO,a.TX_ANESTESIA,a.NR_PRESCRICAO,a.NR_SEQUENCIA_PRESCRICAO,a.CD_MOTIVO_EXC_CONTA,a.DS_COMPL_MOTIVO_EXCON,a.CD_ACAO,a.QT_DEVOLVIDA,a.CD_MOTIVO_DEVOLUCAO,a.NR_CIRURGIA,a.NR_DOC_CONVENIO,a.CD_MEDICO_EXECUTOR,a.IE_COBRA_PF_PJ,a.NR_LAUDO,a.DT_CONTA,a.CD_SETOR_ATENDIMENTO,a.CD_CONTA_CONTABIL,a.CD_PROCEDIMENTO_AIH,a.IE_ORIGEM_PROCED,a.NR_AIH,a.IE_RESPONSAVEL_CREDITO,a.TX_PROCEDIMENTO,a.CD_EQUIPAMENTO,a.IE_VALOR_INFORMADO,a.CD_ESTABELECIMENTO_CUSTO,a.CD_TABELA_CUSTO,a.CD_SITUACAO_GLOSA,a.NR_LOTE_CONTABIL,a.CD_PROCEDIMENTO_CONVENIO,a.NR_SEQ_AUTORIZACAO,a.IE_TIPO_SERVICO_SUS,a.IE_TIPO_ATO_SUS,a.CD_CGC_PRESTADOR,a.NR_NF_PRESTADOR,a.CD_ATIVIDADE_PROF_BPA,a.NR_INTERNO_CONTA,a.NR_SEQ_PROC_PRINC,a.IE_GUIA_INFORMADA,a.DT_INICIO_PROCEDIMENTO,a.IE_EMITE_CONTA,a.IE_FUNCAO_MEDICO,a.IE_CLASSIF_SUS,a.CD_ESPECIALIDADE,a.NM_USUARIO_ORIGINAL,a.NR_SEQ_PROC_PACOTE,a.IE_TIPO_PROC_SUS,a.CD_SETOR_RECEITA,a.VL_ADIC_PLANT,a.QT_PORTE_ANESTESICO,a.TX_HORA_EXTRA,a.IE_EMITE_CONTA_HONOR,a.NR_SEQ_ATEPACU,a.IE_PROC_PRINC_ATEND,a.CD_MEDICO_REQ,a.IE_TIPO_GUIA,a.IE_VIDEO,a.NR_DOC_INTERNO,a.IE_AUDITORIA,a.NR_SEQ_GRUPO_REC,a.CD_MEDICO_CONVENIO,a.CD_MOTIVO_AJUSTE,a.IE_VIA_ACESSO,a.NR_SEQ_COR_EXEC,a.NR_SEQ_EXAME,a.IE_INTERCORRENCIA,a.NR_SEQ_ORIGEM,a.IE_DISPERSAO,a.CD_SETOR_PACIENTE,a.NR_SEQ_CONTA_ORIGEM,a.NR_SEQ_PARCIAL,a.NR_SEQ_PROC_INTERNO,a.CD_SENHA,a.NR_SEQ_AIH,a.NR_DOC_HONOR_CONV,a.DT_CONFERENCIA,a.IE_TIPO_ATEND_BPA,a.IE_GRUPO_ATEND_BPA,a.CD_CGC_PRESTADOR_CONTA,a.CD_MEDICO_EXEC_CONTA,a.NR_SEQ_PQ_PROC,a.QT_FILME,a.NR_SEQ_PROC_CRIT_REPASSE,a.CD_AUTOR_CONVENIO,a.CD_SENHA_AUTOR,a.NR_SEQ_REGRA_LANC,a.IE_TISS_TIPO_GUIA,a.NR_SEQ_TISS_TABELA,a.NR_MINUTO_DURACAO,a.IE_TISS_TIPO_GUIA_HONOR,a.NR_SEQ_REGRA_PRECO,a.IE_TISS_TIPO_GUIA_DESP,a.IE_TECNICA_UTILIZADA,a.IE_TISS_TIPO_DESPESA,a.CD_CGC_PRESTADOR_TISS,a.CD_CGC_HONORARIO_TISS,a.IE_INTEGRACAO,a.NR_SEQ_PROC_ACERTO,a.VL_ORIGINAL_TABELA,a.CD_DOENCA_CID,a.NR_SEQ_APAC,a.NR_SEQ_AJUSTE_PROC,a.CD_TAB_CUSTO_PRECO,a.NR_SEQ_PROC_AUTOR,a.IE_DOC_EXECUTOR,a.NR_SEQ_REGRA_DOC,a.CD_CBO,a.CD_PRESTADOR_TISS,a.CD_CGC_PREST_SOLIC_TISS,a.CD_SETOR_RESP,a.DT_FINAL_PROCEDIMENTO,a.IE_TISS_DESP_HONOR,a.CD_PREST_RESP,a.NR_SEQ_PROC_EST,a.CD_MEDICO_EXEC_TISS,a.DS_PROC_TISS,a.NR_SEQ_TAMANHO_FILME,a.DS_PRESTADOR_TISS,a.NR_SEQ_PROC_CRIT_HOR,a.NR_SEQ_REG_TEMPLATE,a.CD_PROCEDIMENTO_TUSS,a.IE_RATEAR_ITEM,a.IE_COMPLEXIDADE,a.IE_TIPO_FINANCIAMENTO,a.CD_FUNCAO,a.CD_PERFIL,a.NR_SEQ_REGRA_QTDE_EXEC,a.CD_CENTRO_CUSTO_RECEITA,a.NR_SEQ_REGRA_GUIA_TISS,a.NR_SEQ_REGRA_HONOR_TISS,a.IE_TIPO_ATEND_TISS,a.VL_DESP_TISS,a.IE_RESP_CRED_MANUAL,a.NR_SEQ_JUST_VALOR_INF,a.CD_MEDICO_SOLIC_TISS,a.CD_MEDICO_PROF_SOLIC_TISS,a.VL_REPASSE_CALC,a.TX_CUSTO_OPER_QT,a.IE_SPECT,a.NR_SEQ_AGENDA_RXT,a.CD_PRESTADOR_SOLIC_TISS,a.DS_PRESTADOR_SOLIC_TISS,a.VL_TX_DESCONTO,a.VL_TX_ADM,a.CD_MEDICO_HONOR_TISS,a.NR_CONTROLE,a.NR_SEQ_REGRA_TAXA_CIR,a.NR_SEQ_PROC_ORIG,a.NR_SEQUENCIA_GAS,a.NR_SEQ_ETAPA_CHECKUP,a.NR_SEQ_CHECKUP_ETAPA,a.IE_VIA_HEMODINAMICA,a.CD_REGRA_REPASSE,a.IE_TRAT_CONTA_RN,a.NR_SEQ_REG_PROCED,a.NR_SEQ_PEPO,a.NR_SEQ_MOTIVO_INCL,a.DT_CONVERSAO_MANUAL,a.CD_CGC_PREST_HONOR_TISS,a.NR_SEQ_TRANSFUSAO,a.NR_SEQ_RESERVA,a.IE_LADO,a.NR_SEQ_HC_EQUIPAMENTO,a.DT_VINC_PROCED_ADIC,a.DS_INDICACAO,a.CD_TIPO_ANESTESIA,a.NR_SEQ_MATERIAL,a.IE_CARATER_CIRURGIA,a.CD_MEDICO_PREV_LAUDO,a.DS_JUST_VALOR_INF,a.NR_FONE_INTEGRACAO,a.DT_LIGACAO_INTEGRACAO,a.NR_SEQ_LANC_ACAO,a.DS_JUST_ALTER_DATA,a.NR_SEQ_PROC_DITADO,a.NR_SEQ_ORIG_AUDIT,a.NR_SEQ_SERVICO,a.NR_SEQ_SERVICO_CLASSIF,a.NR_SEQ_SUS_EQUIPE,a.NR_SEQ_CRIT_HONORARIO,a.IE_TX_CIR_TEMPO,a.NR_SEQ_PE_PRESCR,a.NR_SEQ_PRESCR_MAT,a.NR_SEQ_SOLUCAO,a.CD_MEDICO_AUTENTICACAO,a.DT_AUTENTICACAO,a.DS_BIOMETRIA,a.NR_SEQ_PROC_DESDOB,a.CD_MEDICO_RESIDENTE,a.IE_RETORNO,a.NR_ATO_IPASGO,a.NR_SEQ_CONTA_REVERSAO,a.NR_SEQ_REGRA_PEPO,a.DS_PROC_TUSS,a.NR_SEQ_TUSS_ITEM, 
		b.ds_procedimento, 
		b.cd_laudo_padrao, 
		b.cd_kit_material, 
		b.ie_classificacao, 
		substr(CASE WHEN a.nr_seq_proc_interno IS NULL THEN  			Obter_Nome_Item_Convenio(a.cd_convenio, 1, 			a.cd_procedimento, a.ie_origem_proced,'N', a.cd_especialidade, null, Obter_Tipo_Atendimento(a.nr_atendimento), null)  ELSE Obter_Desc_Prescr_Proc(a.cd_procedimento, a.ie_origem_proced, a.nr_seq_proc_interno) END ,1,80) ds_proc_convenio, 
		substr(Obter_Codigo_Item_Convenio(a.cd_convenio, 1, 
			a.cd_procedimento, a.ie_origem_proced,'N', a.cd_especialidade, null, Obter_Tipo_Atendimento(a.nr_atendimento)),1,20) cd_proc_convenio, 
		a.ie_funcao_medico cd_funcao_medico, 
		substr(obter_nome_pessoa_fisica(a.cd_medico_executor, null),1, 100) nm_medico_executor, 
		substr(Obter_Nome_Interno_Conv2(a.cd_convenio,1,a.cd_procedimento,a.ie_origem_proced,'N',a.cd_especialidade,a.cd_medico_executor, 
			a.nr_seq_proc_interno,a.nr_atendimento,a.dt_procedimento,a.cd_setor_atendimento,a.nr_seq_atepacu,a.nr_seq_exame),1,80) ds_proc_interno_conv		 
FROM		Procedimento b, 
		Procedimento_Paciente a 
where 	a.cd_procedimento		= b.cd_procedimento 
and 	a.ie_origem_proced		= b.ie_origem_proced;

