-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW registro_cobranca_desempenho_v (qt_cobranca, nm_evento, ds_observacao, nr_seq_cobrador, nr_seq_pagador, cd_estabelecimento) AS select	/*+USE_CONCAT*/	count(*) qt_cobranca,
	d.nm_evento,
	substr(c.ds_observacao,1,255) ds_observacao,
	e.nr_seq_cobrador,
	g.nr_sequencia nr_seq_pagador,
	e.cd_estabelecimento
FROM cobranca e, pls_evento_ocorrencia d, pls_atendimento_evento c, pessoa_fisica b, pls_atendimento a, titulo_receber f
LEFT OUTER JOIN pls_contrato_pagador g ON (f.cd_pessoa_fisica = g.cd_pessoa_fisica)
WHERE a.cd_pessoa_fisica	= b.cd_pessoa_fisica and a.nr_sequencia		= c.nr_seq_atendimento and c.nr_seq_evento		= d.nr_sequencia and a.cd_pessoa_fisica	= f.cd_pessoa_fisica and f.nr_titulo		= e.nr_titulo  and d.ie_acao_evento = 11 group by d.nm_evento, c.ds_observacao, e.nr_seq_cobrador, g.nr_sequencia, e.cd_estabelecimento

union all

select	count(*) qt_cobranca,
	d.nm_evento,
	substr(c.ds_observacao,1,255) ds_observacao,
	e.nr_seq_cobrador,
	g.nr_sequencia nr_seq_pagador,
	e.cd_estabelecimento
FROM titulo_receber f, cobranca e, pls_evento_ocorrencia d, pls_atendimento_evento c, pls_atendimento a, pessoa_juridica b
LEFT OUTER JOIN pls_contrato_pagador g ON (b.cd_cgc = g.cd_cgc)
WHERE a.cd_cgc	= b.cd_cgc and a.nr_sequencia	= c.nr_seq_atendimento and c.nr_seq_evento	= d.nr_sequencia and a.cd_cgc	= f.cd_cgc and f.nr_titulo	= e.nr_titulo  and d.ie_acao_evento = 11 group by d.nm_evento, c.ds_observacao, e.nr_seq_cobrador, g.nr_sequencia, e.cd_estabelecimento

union all

select	count(*) qt_cobranca,
	obter_descricao_padrao_pk('TIPO_HIST_COB','DS_HISTORICO','NR_SEQUENCIA',a.nr_seq_historico) nm_evento,
	substr(a.ds_historico,1,255) ds_observacao,
	c.nr_seq_cobrador,
	e.nr_sequencia nr_seq_pagador,
	c.cd_estabelecimento
FROM titulo_receber d, cobranca c, registro_cobranca a, pessoa_juridica b
LEFT OUTER JOIN pls_contrato_pagador e ON (b.cd_cgc = e.cd_cgc)
WHERE a.cd_cgc	= b.cd_cgc and b.cd_cgc	= d.cd_cgc and d.nr_titulo	= c.nr_titulo  group by a.nr_seq_historico, a.ds_historico, c.nr_seq_cobrador, e.nr_sequencia, c.cd_estabelecimento

union all

select	count(*) qt_cobranca,
	obter_descricao_padrao_pk('TIPO_HIST_COB','DS_HISTORICO','NR_SEQUENCIA',a.nr_seq_historico) nm_evento,
	substr(a.ds_historico,1,255) ds_observacao,
	c.nr_seq_cobrador,
	e.nr_sequencia nr_seq_pagador,
	c.cd_estabelecimento
FROM titulo_receber d, cobranca c, registro_cobranca a, pessoa_fisica b
LEFT OUTER JOIN pls_contrato_pagador e ON (b.cd_pessoa_fisica = e.cd_pessoa_fisica)
WHERE a.cd_pessoa_fisica	= b.cd_pessoa_fisica and b.cd_pessoa_fisica	= d.cd_pessoa_fisica and d.nr_titulo		= c.nr_titulo  group by a.nr_seq_historico, a.ds_historico, c.nr_seq_cobrador, e.nr_sequencia, c.cd_estabelecimento;

