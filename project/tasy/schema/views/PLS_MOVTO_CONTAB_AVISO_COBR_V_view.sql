-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_movto_contab_aviso_cobr_v (ie_status, nr_seq_conta_proc, nr_seq_conta_mat, cd_conta_cred, cd_conta_deb, cd_classif_cred, cd_classif_deb, nr_seq_esquema, nr_sequencia, nr_seq_grupo_ans, ie_ato_cooperado, nr_seq_atualizacao, nr_seq_aviso_proc, nr_seq_aviso_mat, nr_seq_aviso_proc_item, nr_seq_aviso_mat_item) AS select	a.ie_status,
	a.nr_seq_conta_proc,
	null nr_seq_conta_mat,
	b.cd_conta_credito cd_conta_cred,
	b.cd_conta_debito cd_conta_deb,
	b.cd_classif_credito cd_classif_cred,
	b.cd_classif_debito cd_classif_deb,
	b.nr_seq_esquema,
	a.nr_sequencia,
	(select	max(cp.nr_seq_grupo_ans)
	FROM	pls_conta_proc	cp
	where	cp.nr_sequencia  = b.nr_seq_conta_proc) nr_seq_grupo_ans,
	(select	max(cp.ie_ato_cooperado)
	from	pls_conta_proc	cp
	where	cp.nr_sequencia	= b.nr_seq_conta_proc) ie_ato_cooperado,
	a.nr_seq_atualizacao,
	b.nr_sequencia nr_seq_aviso_proc,
	null nr_seq_aviso_mat,
	null nr_seq_aviso_proc_item,
	null nr_seq_aviso_mat_item
from	pls_movimento_contabil	a,
	ptu_aviso_procedimento	b
where	b.nr_sequencia		= a.nr_seq_aviso_proc
and	a.nr_seq_aviso_proc_item is null

union all

select	a.ie_status,
	null nr_seq_conta_proc,
	a.nr_seq_conta_mat,
	b.cd_conta_credito cd_conta_cred,
	b.cd_conta_debito cd_conta_deb,
	b.cd_classif_credito cd_classif_cred,
	b.cd_classif_debito cd_classif_deb,
	b.nr_seq_esquema,
	a.nr_sequencia,
	(select	max(cm.nr_seq_grupo_ans)
	from	pls_conta_mat	cm
	where	cm.nr_sequencia	= b.nr_seq_conta_mat) nr_seq_grupo_ans,
	(select	max(cm.ie_ato_cooperado)
	from	pls_conta_proc	cm
	where	cm.nr_sequencia	= b.nr_seq_conta_mat) ie_ato_cooperado,
	a.nr_seq_atualizacao,
	null nr_seq_aviso_proc,
	b.nr_sequencia nr_seq_aviso_mat,
	null nr_seq_aviso_proc_item,
	null nr_seq_aviso_mat_item
from	pls_movimento_contabil	a,
	ptu_aviso_material	b
where	b.nr_sequencia		= a.nr_seq_aviso_mat
and	a.nr_seq_aviso_mat_item is null

union all

select	a.ie_status,
	a.nr_seq_conta_proc,
	null nr_seq_conta_mat,
	b.cd_conta_credito cd_conta_cred,
	b.cd_conta_debito cd_conta_deb,
	b.cd_classif_credito cd_classif_cred,
	b.cd_classif_debito cd_classif_deb,
	b.nr_seq_esquema,
	a.nr_sequencia,
	(select	max(cp.nr_seq_grupo_ans)
	from	pls_conta_proc	cp
	where	cp.nr_sequencia  = b.nr_seq_conta_proc) nr_seq_grupo_ans,
	(select	max(cp.ie_ato_cooperado)
	from	pls_conta_proc	cp
	where	cp.nr_sequencia	= b.nr_seq_conta_proc) ie_ato_cooperado,
	a.nr_seq_atualizacao,
	null nr_seq_aviso_proc,
	null nr_seq_aviso_mat,
	b.nr_sequencia nr_seq_aviso_proc_item,
	null nr_seq_aviso_mat_item
from	pls_movimento_contabil	a,
	ptu_aviso_proc_item	b
where	b.nr_sequencia		= a.nr_seq_aviso_proc_item

union all

select	a.ie_status,
	null nr_seq_conta_proc,
	a.nr_seq_conta_mat,
	b.cd_conta_credito cd_conta_cred,
	b.cd_conta_debito cd_conta_deb,
	b.cd_classif_credito cd_classif_cred,
	b.cd_classif_debito cd_classif_deb,
	b.nr_seq_esquema,
	a.nr_sequencia,
	(select	max(cm.nr_seq_grupo_ans)
	from	pls_conta_mat	cm
	where	cm.nr_sequencia	= b.nr_seq_conta_mat) nr_seq_grupo_ans,
	(select	max(cm.ie_ato_cooperado)
	from	pls_conta_proc	cm
	where	cm.nr_sequencia	= b.nr_seq_conta_mat) ie_ato_cooperado,
	a.nr_seq_atualizacao,
	null nr_seq_aviso_proc,
	null nr_seq_aviso_mat,
	null nr_seq_aviso_proc_item,
	b.nr_sequencia nr_seq_aviso_mat_item
from	pls_movimento_contabil	a,
	ptu_aviso_mat_item	b
where	b.nr_sequencia		= a.nr_seq_aviso_mat_item;

