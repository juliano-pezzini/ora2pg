-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ptu_sos_unimed_litoral_v (nr_seq_benef, nr_seq_lote, cd_carteirinha_unimed, nm_benef, dt_nascimento, ie_sexo, ie_estado_civil, dt_inclusao_sos, dt_exclusao_sos, ie_tipo_cliente, ds_endereco, ds_complemento, ds_bairro, ds_cidade, sg_uf, cd_cep, nr_ddd, nr_telefone, nm_pessoa_contato, cd_unimed_origem, nr_digito_verificador) AS select	d.nr_sequencia				nr_seq_benef,
	a.nr_sequencia				nr_seq_lote,
	'0'||d.cd_unimed||d.cd_usuario_plano	cd_carteirinha_unimed,
	d.nm_beneficiario 			nm_benef,
	d.dt_nascimento				dt_nascimento,
	d.ie_sexo				ie_sexo,
	d.ie_estado_civil			ie_estado_civil,
	d.dt_inclusao 				dt_inclusao_sos,
	d.dt_exclusao 				dt_exclusao_sos,
	1					ie_tipo_cliente,
	e.ds_endereco				ds_endereco,
	e.ds_complemento			ds_complemento,
	e.ds_bairro				ds_bairro,
	e.nm_municipio				ds_cidade,
	e.sg_uf					sg_uf,
	e.cd_cep				cd_cep,
	e.nr_ddd				nr_ddd,
	e.nr_fone				nr_telefone,
	' '					nm_pessoa_contato,
	b.cd_unimed_origem			cd_unimed_origem,
	substr(d.cd_usuario_plano,13,1) 	nr_digito_verificador
FROM ptu_mov_produto_empresa c, ptu_movimentacao_produto b, ptu_mov_produto_lote a, ptu_mov_produto_benef d
LEFT OUTER JOIN ptu_movimento_benef_compl e ON (d.nr_sequencia = e.nr_seq_beneficiario)
WHERE d.nr_seq_empresa		= c.nr_sequencia and c.nr_seq_mov_produto		= b.nr_sequencia and b.nr_seq_lote			= a.nr_sequencia;

