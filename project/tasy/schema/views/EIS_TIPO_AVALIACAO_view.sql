-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eis_tipo_avaliacao (nr_seq_aval_compl, nr_seq_checkup, dt_liberacao, ie_situacao, dt_inativacao, nm_usuario_inativacao, ds_justificativa, nr_seq_com_cliente, ie_apresentar_web, nr_seq_lote, nr_seq_agenda_pac, nr_seq_contato, cd_perfil_ativo, nr_seq_ageint, nr_seq_agenda_cons, ie_restricao_visualizacao, nr_seq_aval_pre, nr_seq_material, nr_seq_chamado, nr_cirurgia, nr_seq_pepo, dt_atualizacao_nrec, nm_usuario_nrec, ie_avaliador_aux, dt_liberacao_aux, nr_seq_tipo_avaliacao, nr_seq_assinatura, nr_seq_assinat_inativacao, nr_seq_atepacu, cd_estabelecimento, nr_seq_consulta, nr_seq_regulacao, nr_seq_prescr, nr_seq_atend_checklist, nr_seq_checklist_item, nr_seq_atendimento, nm_usuario_lib, cd_unidade, ie_atualiza_macro, nr_seq_pac_hfp, nr_seq_planejamento, nr_seq_hem_etapa, nr_seq_aferese_terap, nr_sequencia, dt_atualizacao, nm_usuario, cd_pessoa_fisica, dt_avaliacao, ds_observacao, nr_atendimento, cd_medico, ie_avaliacao_parcial, nr_prescricao, desc_aval, nm_profissional, cd_convenio, ds_convenio, nm_pessoa_fisica, cd_setor_atendimento, ds_setor_atendimento) AS select a.nr_seq_aval_compl,
	a.nr_seq_checkup, 
	a.dt_liberacao, 
	a.ie_situacao, 
	a.dt_inativacao, 
	a.nm_usuario_inativacao, 
	a.ds_justificativa, 
	a.nr_seq_com_cliente, 
	a.ie_apresentar_web, 
	a.nr_seq_lote, 
	a.nr_seq_agenda_pac, 
	a.nr_seq_contato, 
	a.cd_perfil_ativo, 
	a.nr_seq_ageint, 
	a.nr_seq_agenda_cons, 
	a.ie_restricao_visualizacao, 
	a.nr_seq_aval_pre, 
	a.nr_seq_material, 
	a.nr_seq_chamado, 
	a.nr_cirurgia, 
	a.nr_seq_pepo, 
	a.dt_atualizacao_nrec, 
	a.nm_usuario_nrec, 
	a.ie_avaliador_aux, 
	a.dt_liberacao_aux, 
	a.nr_seq_tipo_avaliacao, 
	a.nr_seq_assinatura, 
	a.nr_seq_assinat_inativacao, 
	a.nr_seq_atepacu, 
	a.cd_estabelecimento, 
	a.nr_seq_consulta, 
	a.nr_seq_regulacao, 
	a.nr_seq_prescr, 
	a.nr_seq_atend_checklist, 
	a.nr_seq_checklist_item, 
	a.nr_seq_atendimento, 
	a.nm_usuario_lib, 
	a.cd_unidade, 
	a.ie_atualiza_macro, 
	a.nr_seq_pac_hfp, 
	a.nr_seq_planejamento, 
	a.nr_seq_hem_etapa, 
	a.nr_seq_aferese_terap, 
	a.nr_sequencia, 
	a.dt_atualizacao, 
	a.nm_usuario, 
	a.cd_pessoa_fisica, 
	a.dt_avaliacao, 
	a.ds_observacao, 
	a.nr_atendimento, 
	a.cd_medico, 
	a.ie_avaliacao_parcial, 
	a.nr_prescricao, 
	coalesce(substr(obter_descricao_padrao('MED_TIPO_AVALIACAO','DS_TIPO', nr_seq_tipo_avaliacao),1,100),'Não Informado')desc_aval, 
        substr(obter_nome_usuario(a.NM_USUARIO),1,255) nm_profissional, 
        obter_convenio_atendimento(a.nr_atendimento) cd_convenio, 
        coalesce(obter_desc_convenio(obter_convenio_atendimento(a.nr_atendimento)),'Não Informado') ds_convenio, 
        substr(obter_nome_pf(a.cd_pessoa_fisica),1,80) nm_pessoa_fisica, 
        substr(obter_Setor_Atendimento(nr_Atendimento),1,50)cd_setor_Atendimento, 
        substr(obter_nome_setor(obter_Setor_Atendimento(nr_Atendimento)),1,250)ds_setor_Atendimento 
    FROM  med_avaliacao_paciente a 
    where  ie_situacao = 'A' 
    and   dt_liberacao is not null 
    and   dt_inativacao is null 
    and   nr_Seq_tipo_avaliacao is not null 
    order  by desc_aval;

