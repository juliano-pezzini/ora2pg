-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW pls_itens_atendimento_v (ie_pendencia, ds_pendencia, nr_sequencia, dt_solicitacao, ds_ocorrencia, nr_seq_atend) AS select	1 ie_pendencia,
	'Autorização' ds_pendencia,
	a.nr_sequencia,
	a.dt_solicitacao,
	a.ds_ocorrencia,
	a.nr_seq_atend
FROM (select	a.nr_sequencia,
		a.dt_solicitacao,
		substr(obter_valor_dominio(1746, a.ie_tipo_guia),1,255) ds_ocorrencia,
		a.nr_seq_atend_pls nr_seq_atend
	from 	pls_guia_plano	a
	order by a.cd_guia) a

union

select	2 ie_pendencia,
	'Boletim de ocorrência' ds_pendencia,
	a.nr_sequencia,
	a.dt_solicitacao,
	a.ds_ocorrencia,
	a.nr_seq_atend
from (select	a.nr_sequencia,
		a.dt_ocorrencia dt_solicitacao,
		substr(a.ds_ocorrencia,1,255) ds_ocorrencia,
		a.nr_atend_pls nr_seq_atend
	from	sac_resp_bol_ocor	b,
		sac_boletim_ocorrencia	a,
		sac_responsavel		c
	where	a.nr_sequencia 		= b.nr_seq_bo
	and	b.nr_seq_responsavel	= c.nr_sequencia) a

union

select	3 ie_pendencia,
	'Ordem de serviço' ds_pendencia,
	a.nr_sequencia,
	a.dt_solicitacao,
	substr(a.ds_ocorrencia,1,255),
	a.nr_seq_atend
from (select	nr_sequencia,
		dt_ordem_Servico dt_solicitacao,
		ds_dano_breve ds_ocorrencia,
		nr_seq_atend_pls nr_seq_atend
	from 	man_ordem_servico) a

union

select	4 ie_pendencia,
	'Requisição' ds_pendencia,
	a.nr_sequencia,
	a.dt_solicitacao,
	a.ds_ocorrencia,
	a.nr_seq_atend
from (select	a.nr_sequencia,
		a.dt_requisicao dt_solicitacao,
		substr(obter_valor_dominio(1746, a.ie_tipo_guia),1,255) ds_ocorrencia,
		a.nr_seq_atend_pls nr_seq_atend
	from 	pls_requisicao	a) a

union

select	5 ie_pendencia,
	'Solicitação de LEAD' ds_pendencia,
	a.nr_sequencia,
	a.dt_solicitacao,
	a.ds_ocorrencia,
	a.nr_seq_atend
from (select	a.nr_sequencia,
		a.dt_solicitacao,
		substr(obter_valor_dominio(2461, a.ie_status),1,255) ds_ocorrencia,
		a.nr_atend_pls nr_seq_atend
	from 	pls_solicitacao_comercial	a) a

union

select	6 ie_pendencia,
	'Agenda de consulta' ds_pendencia,
	a.nr_sequencia,
	a.dt_solicitacao,
	a.ds_ocorrencia,
	a.nr_seq_atend
from (select	a.nr_sequencia,
		a.dt_agendamento dt_solicitacao,
		substr(obter_valor_dominio(83, a.ie_status_agenda),1,255) ds_ocorrencia,
		a.nr_atend_pls nr_seq_atend
	from 	agenda_consulta	a) a

union

select	7 ie_pendencia,
	'Agenda Integrada' ds_pendencia,
	a.nr_sequencia,
	a.dt_solicitacao,
	a.ds_ocorrencia,
	a.nr_seq_atend
from (select	a.nr_sequencia,
		a.dt_inicio_agendamento dt_solicitacao,
		'' ds_ocorrencia,
		a.nr_seq_atend_pls nr_seq_atend
	from 	agenda_integrada a) a

union

select	8 ie_pendencia,
	'EUP' ds_pendencia,
	a.nr_sequencia,
	a.dt_solicitacao,
	a.ds_ocorrencia,
	a.nr_seq_atend
from (select	a.nr_atendimento nr_sequencia,
		a.dt_entrada dt_solicitacao,
		'' ds_ocorrencia,
		a.nr_seq_atend_pls nr_seq_atend
	from 	atendimento_paciente a) a

union

select	9 ie_pendencia,
	'Agenda de exame' ds_pendencia,
	a.nr_sequencia,
	a.dt_solicitacao,
	a.ds_ocorrencia,
	a.nr_seq_atend
from (select	a.nr_sequencia,
		a.dt_agendamento dt_solicitacao,
		'' ds_ocorrencia,
		a.nr_atend_pls nr_seq_atend
	from 	agenda_paciente	a) a

union

select	10 ie_pendencia,
	'Pendencia de resposta' ds_pendencia,
	a.nr_sequencia,
	a.dt_solicitacao,
	a.ds_ocorrencia,
	a.nr_seq_atend
from (select	c.nr_sequencia,
		c.dt_atualizacao dt_solicitacao,
		substr(c.ds_motivo_pendencia, 1, 255) ds_ocorrencia,
		a.nr_sequencia nr_seq_atend
	from	pls_atendimento a,
		pls_atendimento_evento b,
		pls_atend_evt_pend_resp c
	where	a.nr_sequencia = b.nr_seq_atendimento
	and	b.nr_sequencia = c.nr_seq_atend_evento) a

union

select	11 ie_pendencia,
	'Agendamento externo' ds_pendencia,
	a.nr_sequencia,
	a.dt_solicitacao,
	a.ds_ocorrencia,
	a.nr_seq_atend
from (select	b.nr_sequencia,
		b.dt_atualizacao dt_solicitacao,
		substr(b.ds_observacao, 1, 255) ds_ocorrencia,
		a.nr_sequencia nr_seq_atend
	from	pls_atendimento a,
		pls_atendimento_evento b,
		pls_atend_evt_agenda_ext c
	where	a.nr_sequencia = b.nr_seq_atendimento
	and	b.nr_sequencia = c.nr_seq_atend_evento) a

union

select	12 ie_pendencia,
	'Reembolso' ds_pendencia,
	a.nr_sequencia,
	a.dt_solicitacao,
	a.ds_ocorrencia,
	a.nr_seq_atend
from (select	b.nr_sequencia,
		b.dt_protocolo dt_solicitacao,
		substr(obter_valor_dominio(1869, b.ie_status),1,255) ds_ocorrencia,
		b.nr_seq_atend_call nr_seq_atend
	from	pls_protocolo_conta b) a

union

select  13 ie_pendencia,
	'Solicitação de rescisão' ds_pendencia,
	a.nr_sequencia,
	a.dt_solicitacao,
	a.ds_ocorrencia,
	a.nr_seq_atend
from (select	a.nr_sequencia,
                a.dt_solicitacao,
                substr(obter_valor_dominio(8259, a.ie_status),1,255) ds_ocorrencia,
                a.nr_seq_atendimento nr_seq_atend
	from   	pls_solicitacao_rescisao a) a
order by 1;

