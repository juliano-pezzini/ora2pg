-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW eme_contrato_v (nr_sequencia, cd_estabelecimento, cd_contrato, nr_seq_cobertura, dt_atualizacao, nm_usuario, dt_contrato, cd_cgc, cd_pessoa_fisica, nr_seq_regra_preco, qt_dia_vencimento, ie_reajuste, dt_cancelamento, ds_motivo_cancelamento, cd_procedimento, ie_origem_proced, cd_operacao_nf, cd_serie_nf, cd_convenio, cd_categoria, cd_usuario_convenio, ds_evento, nm_contrato, dt_ultimo_reajuste, ds_observacao, nr_seq_contrato, dt_validade, nr_seq_motivo_cancel, nm_usuario_cancel, ie_origem, dt_envio, nm_usuario_envio, cd_tipo_acomodacao, ie_tipo_acom_integ, cd_tipo_recebimento, ds_cobertura, nm_contratado, ds_cgc_cpf) AS select	a.NR_SEQUENCIA,a.CD_ESTABELECIMENTO,a.CD_CONTRATO,a.NR_SEQ_COBERTURA,a.DT_ATUALIZACAO,a.NM_USUARIO,a.DT_CONTRATO,a.CD_CGC,a.CD_PESSOA_FISICA,a.NR_SEQ_REGRA_PRECO,a.QT_DIA_VENCIMENTO,a.IE_REAJUSTE,a.DT_CANCELAMENTO,a.DS_MOTIVO_CANCELAMENTO,a.CD_PROCEDIMENTO,a.IE_ORIGEM_PROCED,a.CD_OPERACAO_NF,a.CD_SERIE_NF,a.CD_CONVENIO,a.CD_CATEGORIA,a.CD_USUARIO_CONVENIO,a.DS_EVENTO,a.NM_CONTRATO,a.DT_ULTIMO_REAJUSTE,a.DS_OBSERVACAO,a.NR_SEQ_CONTRATO,a.DT_VALIDADE,a.NR_SEQ_MOTIVO_CANCEL,a.NM_USUARIO_CANCEL,a.IE_ORIGEM,a.DT_ENVIO,a.NM_USUARIO_ENVIO,a.CD_TIPO_ACOMODACAO,a.IE_TIPO_ACOM_INTEG,a.CD_TIPO_RECEBIMENTO,
	substr(obter_tipo_cobertura(a.nr_sequencia),1,80) ds_cobertura, 
	substr(obter_nome_pf_pj(a.cd_pessoa_fisica,a.cd_cgc),1,100) nm_contratado, 
	coalesce(a.cd_cgc,substr(obter_cpf_pessoa_fisica(a.cd_pessoa_fisica),1,80)) ds_cgc_cpf 
FROM	eme_contrato a;

