-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW wkp_card_erros_warnings_v (nr_sequencia, nr_case, nr_record_id, ie_record_type, dt_admission, cd_error_warning, error_warning_reason, ds_error_warning, ds_justificativa) AS SELECT
    DISTINCT
	A.NR_SEQUENCIA,
	A.NR_CASE,
	A.NR_RECORD_ID,
	A.IE_RECORD_TYPE,
	A.DT_ADMISSION,
	A.CD_ERROR_WARNING,
	'unclear if it''s part of the Online Scoring response' as ERROR_WARNING_REASON,
	A.DS_ERROR_WARNING,
   (SELECT ds_justificativa
      FROM SCORING_ERROR_WARNING_JUST  WHERE NR_SEQUENCIA = (SELECT MAX(X.NR_SEQUENCIA)
                                                                 FROM  SCORING_ERROR_WARNING_JUST X
                                                                WHERE X.nr_seq_scoring_error_warning = a.nr_sequencia)) DS_JUSTIFICATIVA
FROM
	SCORING_ERROR_WARNING A,
	W_XDOK_EW B 
WHERE A.cd_error_warning = B.code 
  AND B.akzeptierbar = 'X';

