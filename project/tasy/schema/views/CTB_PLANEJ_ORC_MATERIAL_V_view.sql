-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

CREATE OR REPLACE VIEW ctb_planej_orc_material_v (vl_planej, qt_planej, nr_sequencia, nr_seq_planej, dt_referencia, cd_estab_exclusivo, cd_empresa, cd_material, cd_conta_contabil, cd_centro_custo, cd_conta_financ, nr_seq_contrato, cd_cnpj, nr_seq_proj_gpi, cd_estabelecimento) AS select a.vl_planej_01 vl_planej,
       a.qt_planej_01 qt_planej,
       a.nr_sequencia,
       a.nr_seq_planej,
       ctb_obter_mes_ref(b.nr_seq_mes_inicio) dt_referencia,
       b.cd_estab_exclusivo,
       b.cd_empresa,
       a.cd_material,
       a.cd_conta_contabil,
       a.cd_centro_custo,
       a.cd_conta_financ,
       a.nr_seq_contrato,
       a.cd_cnpj,
       a.nr_seq_proj_gpi,
       a.cd_estabelecimento
FROM   ctb_planej_orc_material a,
       ctb_orc_cenario b
where  a.nr_seq_planej = b.nr_sequencia

union all

select a.vl_planej_02,
       a.qt_planej_02,
       a.nr_sequencia,
       a.nr_seq_planej,
       add_months(ctb_obter_mes_ref(b.nr_seq_mes_inicio),1),
       b.cd_estab_exclusivo,
       b.cd_empresa,
       a.cd_material,
       a.cd_conta_contabil,
       a.cd_centro_custo,
       a.cd_conta_financ,
       a.nr_seq_contrato,
       a.cd_cnpj,
       a.nr_seq_proj_gpi,
       a.cd_estabelecimento
from   ctb_planej_orc_material a,
       ctb_orc_cenario b
where  a.nr_seq_planej = b.nr_sequencia

union all

select a.vl_planej_03,
       a.qt_planej_03,
       a.nr_sequencia,
       a.nr_seq_planej,
       add_months(ctb_obter_mes_ref(b.nr_seq_mes_inicio),2),
       b.cd_estab_exclusivo,
       b.cd_empresa,
       a.cd_material,
       a.cd_conta_contabil,
       a.cd_centro_custo,
       a.cd_conta_financ,
       a.nr_seq_contrato,
       a.cd_cnpj,
       a.nr_seq_proj_gpi,
       a.cd_estabelecimento
from   ctb_planej_orc_material a,
       ctb_orc_cenario b
where  a.nr_seq_planej = b.nr_sequencia

union all

select a.vl_planej_04,
       a.qt_planej_04,
       a.nr_sequencia,
       a.nr_seq_planej,
       add_months(ctb_obter_mes_ref(b.nr_seq_mes_inicio),3),
       b.cd_estab_exclusivo,
       b.cd_empresa,
       a.cd_material,
       a.cd_conta_contabil,
       a.cd_centro_custo,
       a.cd_conta_financ,
       a.nr_seq_contrato,
       a.cd_cnpj,
       a.nr_seq_proj_gpi,
       a.cd_estabelecimento
from   ctb_planej_orc_material a,
       ctb_orc_cenario b
where  a.nr_seq_planej = b.nr_sequencia

union all

select a.vl_planej_05,
       a.qt_planej_05,
       a.nr_sequencia,
       a.nr_seq_planej,
       add_months(ctb_obter_mes_ref(b.nr_seq_mes_inicio),4),
       b.cd_estab_exclusivo,
       b.cd_empresa,
       a.cd_material,
       a.cd_conta_contabil,
       a.cd_centro_custo,
       a.cd_conta_financ,
       a.nr_seq_contrato,
       a.cd_cnpj,
       a.nr_seq_proj_gpi,
       a.cd_estabelecimento
from   ctb_planej_orc_material a,
       ctb_orc_cenario b
where  a.nr_seq_planej = b.nr_sequencia

union all

select a.vl_planej_06,
       a.qt_planej_06,
       a.nr_sequencia,
       a.nr_seq_planej,
       add_months(ctb_obter_mes_ref(b.nr_seq_mes_inicio),5),
       b.cd_estab_exclusivo,
       b.cd_empresa,
       a.cd_material,
       a.cd_conta_contabil,
       a.cd_centro_custo,
       a.cd_conta_financ,
       a.nr_seq_contrato,
       a.cd_cnpj,
       a.nr_seq_proj_gpi,
       a.cd_estabelecimento
from   ctb_planej_orc_material a,
       ctb_orc_cenario b
where  a.nr_seq_planej = b.nr_sequencia

union all

select a.vl_planej_07,
       a.qt_planej_07,
       a.nr_sequencia,
       a.nr_seq_planej,
       add_months(ctb_obter_mes_ref(b.nr_seq_mes_inicio),6),
       b.cd_estab_exclusivo,
       b.cd_empresa,
       a.cd_material,
       a.cd_conta_contabil,
       a.cd_centro_custo,
       a.cd_conta_financ,
       a.nr_seq_contrato,
       a.cd_cnpj,
       a.nr_seq_proj_gpi,
       a.cd_estabelecimento
from   ctb_planej_orc_material a,
       ctb_orc_cenario b
where  a.nr_seq_planej = b.nr_sequencia

union all

select a.vl_planej_08,
       a.qt_planej_08,
       a.nr_sequencia,
       a.nr_seq_planej,
       add_months(ctb_obter_mes_ref(b.nr_seq_mes_inicio),7),
       b.cd_estab_exclusivo,
       b.cd_empresa,
       a.cd_material,
       a.cd_conta_contabil,
       a.cd_centro_custo,
       a.cd_conta_financ,
       a.nr_seq_contrato,
       a.cd_cnpj,
       a.nr_seq_proj_gpi,
       a.cd_estabelecimento
from   ctb_planej_orc_material a,
       ctb_orc_cenario b
where  a.nr_seq_planej = b.nr_sequencia

union all

select a.vl_planej_09,
       a.qt_planej_09,
       a.nr_sequencia,
       a.nr_seq_planej,
       add_months(ctb_obter_mes_ref(b.nr_seq_mes_inicio),8),
       b.cd_estab_exclusivo,
       b.cd_empresa,
       a.cd_material,
       a.cd_conta_contabil,
       a.cd_centro_custo,
       a.cd_conta_financ,
       a.nr_seq_contrato,
       a.cd_cnpj,
       a.nr_seq_proj_gpi,
       a.cd_estabelecimento
from   ctb_planej_orc_material a,
       ctb_orc_cenario b
where  a.nr_seq_planej = b.nr_sequencia

union all

select a.vl_planej_10,
       a.qt_planej_10,
       a.nr_sequencia,
       a.nr_seq_planej,
       add_months(ctb_obter_mes_ref(b.nr_seq_mes_inicio),9),
       b.cd_estab_exclusivo,
       b.cd_empresa,
       a.cd_material,
       a.cd_conta_contabil,
       a.cd_centro_custo,
       a.cd_conta_financ,
       a.nr_seq_contrato,
       a.cd_cnpj,
       a.nr_seq_proj_gpi,
       a.cd_estabelecimento
from   ctb_planej_orc_material a,
       ctb_orc_cenario b
where  a.nr_seq_planej = b.nr_sequencia

union all

select a.vl_planej_11,
       a.qt_planej_11,
       a.nr_sequencia,
       a.nr_seq_planej,
       add_months(ctb_obter_mes_ref(b.nr_seq_mes_inicio),10),
       b.cd_estab_exclusivo,
       b.cd_empresa,
       a.cd_material,
       a.cd_conta_contabil,
       a.cd_centro_custo,
       a.cd_conta_financ,
       a.nr_seq_contrato,
       a.cd_cnpj,
       a.nr_seq_proj_gpi,
       a.cd_estabelecimento
from   ctb_planej_orc_material a,
       ctb_orc_cenario b
where  a.nr_seq_planej = b.nr_sequencia

union all

select a.vl_planej_12,
       a.qt_planej_12,
       a.nr_sequencia,
       a.nr_seq_planej,
       add_months(ctb_obter_mes_ref(b.nr_seq_mes_inicio),11),
       b.cd_estab_exclusivo,
       b.cd_empresa,
       a.cd_material,
       a.cd_conta_contabil,
       a.cd_centro_custo,
       a.cd_conta_financ,
       a.nr_seq_contrato,
       a.cd_cnpj,
       a.nr_seq_proj_gpi,
       a.cd_estabelecimento
from   ctb_planej_orc_material a,
       ctb_orc_cenario b
where  a.nr_seq_planej = b.nr_sequencia;

