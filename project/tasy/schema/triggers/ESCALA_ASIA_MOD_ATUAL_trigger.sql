-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

DROP TRIGGER IF EXISTS escala_asia_mod_atual ON escala_asia_mod CASCADE;
CREATE OR REPLACE FUNCTION trigger_fct_escala_asia_mod_atual() RETURNS trigger AS $BODY$
declare

BEGIN

if (wheb_usuario_pck.get_ie_executar_trigger = 'S') then

if (NEW.ie_motor_c5_r = '6') then
NEW.ie_motor_c5_r := '5';
end if;
if (NEW.ie_motor_c6_r = '6') then
NEW.ie_motor_c6_r := '5';
end if;
if (NEW.ie_motor_c7_r = '6') then
NEW.ie_motor_c7_r := '5';
end if;
if (NEW.ie_motor_c8_r = '6') then
NEW.ie_motor_c8_r := '5';
end if;
if (NEW.ie_motor_t1_r = '6') then
NEW.ie_motor_t1_r := '5';
end if;
if (NEW.ie_motor_l2_r = '6') then
NEW.ie_motor_l2_r := '5';
end if;
if (NEW.ie_motor_l3_r = '6') then
NEW.ie_motor_l3_r := '5';
end if;
if (NEW.ie_motor_l4_r = '6') then
NEW.ie_motor_l4_r := '5';
end if;
if (NEW.ie_motor_l5_r = '6') then
NEW.ie_motor_l5_r := '5';
end if;
if (NEW.ie_motor_s1_r = '6') then
NEW.ie_motor_s1_r := '5';
end if;

if (NEW.ie_motor_c5_l = '6') then
NEW.ie_motor_c5_l := '5';
end if;
if (NEW.ie_motor_c6_l = '6') then
NEW.ie_motor_c6_l := '5';
end if;
if (NEW.ie_motor_c7_l = '6') then
NEW.ie_motor_c7_l := '5';
end if;
if (NEW.ie_motor_c8_l = '6') then
NEW.ie_motor_c8_l := '5';
end if;
if (NEW.ie_motor_t1_l = '6') then
NEW.ie_motor_t1_l := '5';
end if;
if (NEW.ie_motor_l2_l = '6') then
NEW.ie_motor_l2_l := '5';
end if;
if (NEW.ie_motor_l3_l = '6') then
NEW.ie_motor_l3_l := '5';
end if;
if (NEW.ie_motor_l4_l = '6') then
NEW.ie_motor_l4_l := '5';
end if;
if (NEW.ie_motor_l5_l = '6') then
NEW.ie_motor_l5_l := '5';
end if;
if (NEW.ie_motor_s1_l = '6') then
NEW.ie_motor_s1_l := '5';
end if;

NEW.QT_PONT_MOTOR_R	:=	somente_numero(NEW.ie_motor_c5_r) +
          somente_numero(NEW.ie_motor_c6_r) +
					somente_numero(NEW.ie_motor_c7_r) +
					somente_numero(NEW.ie_motor_c8_r) +
					somente_numero(NEW.ie_motor_t1_r) +
          somente_numero(NEW.ie_motor_l2_r) +
					somente_numero(NEW.ie_motor_l3_r) +
					somente_numero(NEW.ie_motor_l4_r) +
					somente_numero(NEW.ie_motor_l5_r) +
					somente_numero(NEW.ie_motor_s1_r);

NEW.QT_UER :=  somente_numero(NEW.ie_motor_c5_r ) +
					somente_numero(NEW.ie_motor_c6_r ) +
					somente_numero(NEW.ie_motor_c7_r ) +
					somente_numero(NEW.ie_motor_c8_r ) +
					somente_numero(NEW.ie_motor_t1_r );

NEW.QT_UEL :=  somente_numero(NEW.ie_motor_c5_l ) +
					somente_numero(NEW.ie_motor_c6_l ) +
					somente_numero(NEW.ie_motor_c7_l ) +
					somente_numero(NEW.ie_motor_c8_l ) +
					somente_numero(NEW.ie_motor_t1_l );

NEW.QT_UEMS := NEW.QT_UER +NEW.QT_UEL;

NEW.QT_LER := somente_numero(NEW.ie_motor_l2_r ) +
					somente_numero(NEW.ie_motor_l3_r ) +
					somente_numero(NEW.ie_motor_l4_r ) +
					somente_numero(NEW.ie_motor_l5_r ) +
					somente_numero(NEW.ie_motor_s1_r );

NEW.QT_LEL :=  somente_numero(NEW.ie_motor_l2_l ) +
					somente_numero(NEW.ie_motor_l3_l ) +
					somente_numero(NEW.ie_motor_l4_l ) +
					somente_numero(NEW.ie_motor_l5_l ) +
					somente_numero(NEW.ie_motor_s1_l );

NEW.QT_LEMS :=  NEW.QT_LER +   NEW.QT_LEL;

NEW.QT_PONT_MOTOR_L	:=	somente_numero(NEW.ie_motor_c5_l ) +
					somente_numero(NEW.ie_motor_c6_l ) +
					somente_numero(NEW.ie_motor_c7_l ) +
					somente_numero(NEW.ie_motor_c8_l ) +
					somente_numero(NEW.ie_motor_t1_l ) +
          somente_numero(NEW.ie_motor_l2_l ) +
					somente_numero(NEW.ie_motor_l3_l ) +
					somente_numero(NEW.ie_motor_l4_l ) +
					somente_numero(NEW.ie_motor_l5_l ) +
					somente_numero(NEW.ie_motor_s1_l );

NEW.QT_PONT_PRICK_R	:=	somente_numero(NEW.IE_SENS_PRICK_C2_R) +
					somente_numero(NEW.IE_SENS_PRICK_C3_R) +
					somente_numero(NEW.IE_SENS_PRICK_C4_R) +
					somente_numero(NEW.IE_SENS_PRICK_C5_R) +
					somente_numero(NEW.IE_SENS_PRICK_C6_R) +
					somente_numero(NEW.IE_SENS_PRICK_C7_R) +
					somente_numero(NEW.IE_SENS_PRICK_C8_R) +
					somente_numero(NEW.IE_SENS_PRICK_T1_R) +
					somente_numero(NEW.IE_SENS_PRICK_T2_R) +
					somente_numero(NEW.IE_SENS_PRICK_T3_R) +
					somente_numero(NEW.IE_SENS_PRICK_T4_R) +
					somente_numero(NEW.IE_SENS_PRICK_T5_R) +
					somente_numero(NEW.IE_SENS_PRICK_T6_R) +
					somente_numero(NEW.IE_SENS_PRICK_T7_R) +
					somente_numero(NEW.IE_SENS_PRICK_T8_R) +
					somente_numero(NEW.IE_SENS_PRICK_T9_R) +
					somente_numero(NEW.IE_SENS_PRICK_T10_R) +
					somente_numero(NEW.IE_SENS_PRICK_T11_R) +
					somente_numero(NEW.IE_SENS_PRICK_T12_R) +
					somente_numero(NEW.IE_SENS_PRICK_L1_R) +
					somente_numero(NEW.IE_SENS_PRICK_L2_R) +
					somente_numero(NEW.IE_SENS_PRICK_L3_R) +
					somente_numero(NEW.IE_SENS_PRICK_L4_R) +
					somente_numero(NEW.IE_SENS_PRICK_L5_R) +
					somente_numero(NEW.IE_SENS_PRICK_S1_R) +
					somente_numero(NEW.IE_SENS_PRICK_S2_R) +
					somente_numero(NEW.IE_SENS_PRICK_S3_R) +
					somente_numero(NEW.IE_SENS_PRICK_S4_5_R);
NEW.QT_PONT_PRICK_L	:=	somente_numero(NEW.IE_SENS_PRICK_C2_L) +
					somente_numero(NEW.IE_SENS_PRICK_C3_L) +
					somente_numero(NEW.IE_SENS_PRICK_C4_L) +
					somente_numero(NEW.IE_SENS_PRICK_C5_L) +
					somente_numero(NEW.IE_SENS_PRICK_C6_L) +
					somente_numero(NEW.IE_SENS_PRICK_C7_L) +
					somente_numero(NEW.IE_SENS_PRICK_C8_L) +
					somente_numero(NEW.IE_SENS_PRICK_T1_L) +
					somente_numero(NEW.IE_SENS_PRICK_T2_L) +
					somente_numero(NEW.IE_SENS_PRICK_T3_L) +
					somente_numero(NEW.IE_SENS_PRICK_T4_L) +
					somente_numero(NEW.IE_SENS_PRICK_T5_L) +
					somente_numero(NEW.IE_SENS_PRICK_T6_L) +
					somente_numero(NEW.IE_SENS_PRICK_T7_L) +
					somente_numero(NEW.IE_SENS_PRICK_T8_L) +
					somente_numero(NEW.IE_SENS_PRICK_T9_L) +
					somente_numero(NEW.IE_SENS_PRICK_T10_L) +
					somente_numero(NEW.IE_SENS_PRICK_T11_L) +
					somente_numero(NEW.IE_SENS_PRICK_T12_L) +
					somente_numero(NEW.IE_SENS_PRICK_L1_L) +
					somente_numero(NEW.IE_SENS_PRICK_L2_L) +
					somente_numero(NEW.IE_SENS_PRICK_L3_L) +
					somente_numero(NEW.IE_SENS_PRICK_L4_L) +
					somente_numero(NEW.IE_SENS_PRICK_L5_L) +
					somente_numero(NEW.IE_SENS_PRICK_S1_L) +
					somente_numero(NEW.IE_SENS_PRICK_S2_L) +
					somente_numero(NEW.IE_SENS_PRICK_S3_L) +
					somente_numero(NEW.IE_SENS_PRICK_S4_5_L);


NEW.QT_PONT_TOUCH_R	:=	somente_numero(NEW.IE_SENS_TOUCH_C2_R) +
					somente_numero(NEW.IE_SENS_TOUCH_C3_R) +
					somente_numero(NEW.IE_SENS_TOUCH_C4_R) +
					somente_numero(NEW.IE_SENS_TOUCH_C5_R) +
					somente_numero(NEW.IE_SENS_TOUCH_C6_R) +
					somente_numero(NEW.IE_SENS_TOUCH_C7_R) +
					somente_numero(NEW.IE_SENS_TOUCH_C8_R) +
					somente_numero(NEW.IE_SENS_TOUCH_T1_R) +
					somente_numero(NEW.IE_SENS_TOUCH_T2_R) +
					somente_numero(NEW.IE_SENS_TOUCH_T3_R) +
					somente_numero(NEW.IE_SENS_TOUCH_T4_R) +
					somente_numero(NEW.IE_SENS_TOUCH_T5_R) +
					somente_numero(NEW.IE_SENS_TOUCH_T6_R) +
					somente_numero(NEW.IE_SENS_TOUCH_T7_R) +
					somente_numero(NEW.IE_SENS_TOUCH_T8_R) +
					somente_numero(NEW.IE_SENS_TOUCH_T9_R) +
					somente_numero(NEW.IE_SENS_TOUCH_T10_R) +
					somente_numero(NEW.IE_SENS_TOUCH_T11_R) +
					somente_numero(NEW.IE_SENS_TOUCH_T12_R) +
					somente_numero(NEW.IE_SENS_TOUCH_L1_R) +
					somente_numero(NEW.IE_SENS_TOUCH_L2_R) +
					somente_numero(NEW.IE_SENS_TOUCH_L3_R) +
					somente_numero(NEW.IE_SENS_TOUCH_L4_R) +
					somente_numero(NEW.IE_SENS_TOUCH_L5_R) +
					somente_numero(NEW.IE_SENS_TOUCH_S1_R) +
					somente_numero(NEW.IE_SENS_TOUCH_S2_R) +
					somente_numero(NEW.IE_SENS_TOUCH_S3_R) +
					somente_numero(NEW.IE_SENS_TOUCH_S4_5_R);
NEW.QT_PONT_TOUCH_L	:=	somente_numero(NEW.IE_SENS_TOUCH_C2_L) +
					somente_numero(NEW.IE_SENS_TOUCH_C3_L) +
					somente_numero(NEW.IE_SENS_TOUCH_C4_L) +
					somente_numero(NEW.IE_SENS_TOUCH_C5_L) +
					somente_numero(NEW.IE_SENS_TOUCH_C6_L) +
					somente_numero(NEW.IE_SENS_TOUCH_C7_L) +
					somente_numero(NEW.IE_SENS_TOUCH_C8_L) +
					somente_numero(NEW.IE_SENS_TOUCH_T1_L) +
					somente_numero(NEW.IE_SENS_TOUCH_T2_L) +
					somente_numero(NEW.IE_SENS_TOUCH_T3_L) +
					somente_numero(NEW.IE_SENS_TOUCH_T4_L) +
					somente_numero(NEW.IE_SENS_TOUCH_T5_L) +
					somente_numero(NEW.IE_SENS_TOUCH_T6_L) +
					somente_numero(NEW.IE_SENS_TOUCH_T7_L) +
					somente_numero(NEW.IE_SENS_TOUCH_T8_L) +
					somente_numero(NEW.IE_SENS_TOUCH_T9_L) +
					somente_numero(NEW.IE_SENS_TOUCH_T10_L) +
					somente_numero(NEW.IE_SENS_TOUCH_T11_L) +
					somente_numero(NEW.IE_SENS_TOUCH_T12_L) +
					somente_numero(NEW.IE_SENS_TOUCH_L1_L) +
					somente_numero(NEW.IE_SENS_TOUCH_L2_L) +
					somente_numero(NEW.IE_SENS_TOUCH_L3_L) +
					somente_numero(NEW.IE_SENS_TOUCH_L4_L) +
					somente_numero(NEW.IE_SENS_TOUCH_L5_L) +
					somente_numero(NEW.IE_SENS_TOUCH_S1_L) +
					somente_numero(NEW.IE_SENS_TOUCH_S2_L) +
					somente_numero(NEW.IE_SENS_TOUCH_S3_L) +
					somente_numero(NEW.IE_SENS_TOUCH_S4_5_L);

NEW.QT_LTR		:=	NEW.QT_PONT_TOUCH_R;
NEW.QT_LTL		:=	NEW.QT_PONT_TOUCH_L;
NEW.QT_LTT		:=	NEW.QT_LTR + NEW.QT_LTL;
NEW.QT_PPL		:=	NEW.QT_PONT_PRICK_L;
NEW.QT_PPR		:=	NEW.QT_PONT_PRICK_R;
NEW.QT_PPT		:=	NEW.QT_PPL + NEW.QT_PPR;

end if;

RETURN NEW;
end
$BODY$
 LANGUAGE 'plpgsql' SECURITY DEFINER;
-- REVOKE ALL ON FUNCTION trigger_fct_escala_asia_mod_atual() FROM PUBLIC;

CREATE TRIGGER escala_asia_mod_atual
	BEFORE INSERT OR UPDATE ON escala_asia_mod FOR EACH ROW
	EXECUTE PROCEDURE trigger_fct_escala_asia_mod_atual();

