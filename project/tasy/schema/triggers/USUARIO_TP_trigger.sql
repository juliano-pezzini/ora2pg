-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

DROP TRIGGER IF EXISTS usuario_tp ON usuario CASCADE;
CREATE OR REPLACE FUNCTION trigger_fct_usuario_tp() RETURNS trigger AS $BODY$
DECLARE nr_seq_w bigint;ds_s_w   varchar(1);ds_c_w   varchar(1);ds_w	   varchar(1);ie_log_w varchar(1);BEGIN BEGIN ds_s_w := to_char(OLD.NM_USUARIO);  ds_c_w:=null;SELECT * FROM gravar_log_alteracao(substr(OLD.NR_SEQ_PERFIL,1,4000), substr(NEW.NR_SEQ_PERFIL,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'NR_SEQ_PERFIL', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_ORDEM_SERV,1,4000), substr(NEW.IE_EVENTO_ORDEM_SERV,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_ORDEM_SERV', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_ATUALIZAR_DIC,1,4000), substr(NEW.IE_ATUALIZAR_DIC,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_ATUALIZAR_DIC', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_RECOLETA,1,4000), substr(NEW.IE_EVENTO_RECOLETA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_RECOLETA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.NR_SEQ_IMPRESSORA,1,4000), substr(NEW.NR_SEQ_IMPRESSORA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'NR_SEQ_IMPRESSORA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_OBJ_INV,1,4000), substr(NEW.IE_EVENTO_OBJ_INV,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_OBJ_INV', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_MOSTRAR_ANEXO_COMUNIC,1,4000), substr(NEW.IE_MOSTRAR_ANEXO_COMUNIC,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_MOSTRAR_ANEXO_COMUNIC', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_COMUNIC_PADRAO,1,4000), substr(NEW.DS_COMUNIC_PADRAO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'DS_COMUNIC_PADRAO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_EMAIL,1,4000), substr(NEW.DS_EMAIL,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'DS_EMAIL', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_ESTABELECIMENTO,1,4000), substr(NEW.CD_ESTABELECIMENTO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'CD_ESTABELECIMENTO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_CLASSIF_LOCALIZADOR,1,4000), substr(NEW.CD_CLASSIF_LOCALIZADOR,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'CD_CLASSIF_LOCALIZADOR', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.NR_RAMAL,1,4000), substr(NEW.NR_RAMAL,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'NR_RAMAL', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(to_char(OLD.DT_ATUALIZACAO,'dd/mm/yyyy hh24:mi:ss'), to_char(NEW.DT_ATUALIZACAO,'dd/mm/yyyy hh24:mi:ss'), NEW.nm_usuario_atual, nr_seq_w, 'DT_ATUALIZACAO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_PESSOA_FISICA,1,4000), substr(NEW.CD_PESSOA_FISICA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'CD_PESSOA_FISICA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_MENSAGEM_ENVIO,1,4000), substr(NEW.IE_MENSAGEM_ENVIO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_MENSAGEM_ENVIO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_MENSAGEM_REC,1,4000), substr(NEW.IE_MENSAGEM_REC,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_MENSAGEM_REC', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_ANEXAR_ARQUIVO,1,4000), substr(NEW.IE_ANEXAR_ARQUIVO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_ANEXAR_ARQUIVO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_SITUACAO,1,4000), substr(NEW.IE_SITUACAO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_SITUACAO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_CHAMAR_TASYMON,1,4000), substr(NEW.IE_CHAMAR_TASYMON,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_CHAMAR_TASYMON', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(to_char(OLD.DT_ALTERACAO_SENHA,'dd/mm/yyyy hh24:mi:ss'), to_char(NEW.DT_ALTERACAO_SENHA,'dd/mm/yyyy hh24:mi:ss'), NEW.nm_usuario_atual, nr_seq_w, 'DT_ALTERACAO_SENHA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_SENHA,1,4000), substr(NEW.DS_SENHA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'DS_SENHA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.NM_USUARIO_ATUAL,1,4000), substr(NEW.NM_USUARIO_ATUAL,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'NM_USUARIO_ATUAL', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_APROV_DOC,1,4000), substr(NEW.IE_EVENTO_APROV_DOC,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_APROV_DOC', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_CONTA_EMAIL,1,4000), substr(NEW.DS_CONTA_EMAIL,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'DS_CONTA_EMAIL', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_SETOR_ATENDIMENTO,1,4000), substr(NEW.CD_SETOR_ATENDIMENTO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'CD_SETOR_ATENDIMENTO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_USUARIO,1,4000), substr(NEW.DS_USUARIO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'DS_USUARIO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.NM_USUARIO,1,4000), substr(NEW.NM_USUARIO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'NM_USUARIO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_COMUNIC_INTERNA,1,4000), substr(NEW.IE_COMUNIC_INTERNA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_COMUNIC_INTERNA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_LOCALIZAR_MEDICO,1,4000), substr(NEW.IE_LOCALIZAR_MEDICO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_LOCALIZAR_MEDICO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_BARRAS,1,4000), substr(NEW.CD_BARRAS,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'CD_BARRAS', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_TIPO_EVOLUCAO,1,4000), substr(NEW.IE_TIPO_EVOLUCAO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_TIPO_EVOLUCAO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.QT_DIA_SENHA,1,4000), substr(NEW.QT_DIA_SENHA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'QT_DIA_SENHA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_SENHA_LAUDO,1,4000), substr(NEW.DS_SENHA_LAUDO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'DS_SENHA_LAUDO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_COMUNIC,1,4000), substr(NEW.IE_EVENTO_COMUNIC,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_COMUNIC', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_ALERTA,1,4000), substr(NEW.IE_EVENTO_ALERTA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_ALERTA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_APROV_COMPRA,1,4000), substr(NEW.IE_EVENTO_APROV_COMPRA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_APROV_COMPRA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_FUNCAO,1,4000), substr(NEW.CD_FUNCAO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'CD_FUNCAO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_EXAME_URG,1,4000), substr(NEW.IE_EVENTO_EXAME_URG,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_EXAME_URG', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_PRESCR,1,4000), substr(NEW.IE_EVENTO_PRESCR,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_PRESCR', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_PROC_AGENDA,1,4000), substr(NEW.IE_EVENTO_PROC_AGENDA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_PROC_AGENDA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_SAC,1,4000), substr(NEW.IE_EVENTO_SAC,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_SAC', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_PROCESSO,1,4000), substr(NEW.IE_EVENTO_PROCESSO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_PROCESSO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_FECHAR_TASYMON,1,4000), substr(NEW.IE_FECHAR_TASYMON,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_FECHAR_TASYMON', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.NR_SEQ_CLASSIF,1,4000), substr(NEW.NR_SEQ_CLASSIF,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'NR_SEQ_CLASSIF', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_LIB_TELEFONE,1,4000), substr(NEW.IE_EVENTO_LIB_TELEFONE,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_LIB_TELEFONE', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_PERFIL_INICIAL,1,4000), substr(NEW.CD_PERFIL_INICIAL,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'CD_PERFIL_INICIAL', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_AGENDA,1,4000), substr(NEW.IE_EVENTO_AGENDA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_AGENDA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.NM_USUARIO_ORIG,1,4000), substr(NEW.NM_USUARIO_ORIG,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'NM_USUARIO_ORIG', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_VERSAO_ANTERIOR,1,4000), substr(NEW.IE_VERSAO_ANTERIOR,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_VERSAO_ANTERIOR', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_PROFISSIONAL,1,4000), substr(NEW.IE_PROFISSIONAL,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_PROFISSIONAL', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(to_char(OLD.DT_VALIDADE_USUARIO,'dd/mm/yyyy hh24:mi:ss'), to_char(NEW.DT_VALIDADE_USUARIO,'dd/mm/yyyy hh24:mi:ss'), NEW.nm_usuario_atual, nr_seq_w, 'DT_VALIDADE_USUARIO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_SENHA_EMAIL,1,4000), substr(NEW.DS_SENHA_EMAIL,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'DS_SENHA_EMAIL', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_SUSP_EXAME,1,4000), substr(NEW.IE_EVENTO_SUSP_EXAME,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_SUSP_EXAME', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_OS_PE_BSC,1,4000), substr(NEW.IE_OS_PE_BSC,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_OS_PE_BSC', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_LOGIN,1,4000), substr(NEW.DS_LOGIN,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'DS_LOGIN', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_MED_CIH,1,4000), substr(NEW.IE_EVENTO_MED_CIH,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_MED_CIH', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_SOLIC_PRONT,1,4000), substr(NEW.IE_EVENTO_SOLIC_PRONT,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_SOLIC_PRONT', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_HIST_PADRAO,1,4000), substr(NEW.DS_HIST_PADRAO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'DS_HIST_PADRAO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_CANC_CIR_SAN,1,4000), substr(NEW.IE_EVENTO_CANC_CIR_SAN,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_CANC_CIR_SAN', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_CANC_AGENDA_SAN,1,4000), substr(NEW.IE_EVENTO_CANC_AGENDA_SAN,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_CANC_AGENDA_SAN', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_ENC_AGENDA_SAN,1,4000), substr(NEW.IE_EVENTO_ENC_AGENDA_SAN,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_ENC_AGENDA_SAN', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_TRANSF_AGENDA_SAN,1,4000), substr(NEW.IE_EVENTO_TRANSF_AGENDA_SAN,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_TRANSF_AGENDA_SAN', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_CERTIFICADO,1,4000), substr(NEW.CD_CERTIFICADO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'CD_CERTIFICADO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_ALTERACAO_PARAM,1,4000), substr(NEW.IE_EVENTO_ALTERACAO_PARAM,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_ALTERACAO_PARAM', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_INT_AGENDA_SAN,1,4000), substr(NEW.IE_EVENTO_INT_AGENDA_SAN,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_INT_AGENDA_SAN', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_VINC_AGENDA_SAN,1,4000), substr(NEW.IE_EVENTO_VINC_AGENDA_SAN,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_VINC_AGENDA_SAN', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.NR_SEQ_JUSTIFIC_ACESSO,1,4000), substr(NEW.NR_SEQ_JUSTIFIC_ACESSO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'NR_SEQ_JUSTIFIC_ACESSO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_PACIENTE,1,4000), substr(NEW.IE_EVENTO_PACIENTE,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_PACIENTE', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_ESTRANGEIRO,1,4000), substr(NEW.IE_EVENTO_ESTRANGEIRO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_ESTRANGEIRO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_TEXTO_EMAIL,1,4000), substr(NEW.DS_TEXTO_EMAIL,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'DS_TEXTO_EMAIL', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(to_char(OLD.DT_ATUALIZACAO_NREC,'dd/mm/yyyy hh24:mi:ss'), to_char(NEW.DT_ATUALIZACAO_NREC,'dd/mm/yyyy hh24:mi:ss'), NEW.nm_usuario_atual, nr_seq_w, 'DT_ATUALIZACAO_NREC', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_ALTA_PARTIC,1,4000), substr(NEW.IE_EVENTO_ALTA_PARTIC,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_ALTA_PARTIC', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_PREV_ALTA,1,4000), substr(NEW.IE_EVENTO_PREV_ALTA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_PREV_ALTA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_ALTA_REGRA,1,4000), substr(NEW.IE_EVENTO_ALTA_REGRA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_ALTA_REGRA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.NR_SEQ_IDIOMA,1,4000), substr(NEW.NR_SEQ_IDIOMA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'NR_SEQ_IDIOMA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_ALTA_PARTIC_EXT,1,4000), substr(NEW.IE_EVENTO_ALTA_PARTIC_EXT,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_ALTA_PARTIC_EXT', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_ALERTA_MEDICO,1,4000), substr(NEW.IE_EVENTO_ALERTA_MEDICO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_ALERTA_MEDICO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_RECEBER_COPIA_EMAIL,1,4000), substr(NEW.IE_RECEBER_COPIA_EMAIL,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_RECEBER_COPIA_EMAIL', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.NM_USUARIO_PESQUISA,1,4000), substr(NEW.NM_USUARIO_PESQUISA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'NM_USUARIO_PESQUISA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_SOLIC_COMPRA,1,4000), substr(NEW.IE_EVENTO_SOLIC_COMPRA,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_SOLIC_COMPRA', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_EVENTO_SC_URGENTE,1,4000), substr(NEW.IE_EVENTO_SC_URGENTE,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_EVENTO_SC_URGENTE', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_CAN_DELETE_PATIENT,1,4000), substr(NEW.IE_CAN_DELETE_PATIENT,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_CAN_DELETE_PATIENT', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_CAN_AUTH_PATIENT_DELETION,1,4000), substr(NEW.IE_CAN_AUTH_PATIENT_DELETION,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_CAN_AUTH_PATIENT_DELETION', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_CAN_VIEW_SENSITIVE_INFO,1,4000), substr(NEW.IE_CAN_VIEW_SENSITIVE_INFO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_CAN_VIEW_SENSITIVE_INFO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_CAN_VIEW_PATIENT_INFO,1,4000), substr(NEW.IE_CAN_VIEW_PATIENT_INFO,1,4000), NEW.nm_usuario_atual, nr_seq_w, 'IE_CAN_VIEW_PATIENT_INFO', ie_log_w, ds_w, 'USUARIO', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;   exception when others then ds_w:= '1'; end;   END;
RETURN NEW;
end
$BODY$
 LANGUAGE 'plpgsql' SECURITY DEFINER;
-- REVOKE ALL ON FUNCTION trigger_fct_usuario_tp() FROM PUBLIC;

CREATE TRIGGER usuario_tp
	AFTER UPDATE ON usuario FOR EACH ROW
	EXECUTE PROCEDURE trigger_fct_usuario_tp();

