-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

DROP TRIGGER IF EXISTS evolucao_paciente_befinsert ON evolucao_paciente CASCADE;
CREATE OR REPLACE FUNCTION trigger_fct_evolucao_paciente_befinsert() RETURNS trigger AS $BODY$
DECLARE

dt_entrada_w		timestamp;
ie_medico_w		varchar(1);
cd_estabelecimento_w	smallint;
qt_hora_w		double precision;
qt_hora_med_w		double precision;
qt_hora_retroativa_w	double precision;
BEGIN
  BEGIN

	IF ( wheb_usuario_pck.get_ie_executar_trigger = 'S' ) THEN
		NEW.CD_UNIDADE	:= Obter_Ult_Unid_Atendimento(NEW.nr_atendimento);
	END IF;

exception
	when others then
	null;

  END;
RETURN NEW;
END;
$BODY$
 LANGUAGE 'plpgsql' SECURITY DEFINER;
-- REVOKE ALL ON FUNCTION trigger_fct_evolucao_paciente_befinsert() FROM PUBLIC;

CREATE TRIGGER evolucao_paciente_befinsert
	BEFORE INSERT ON evolucao_paciente FOR EACH ROW
	EXECUTE PROCEDURE trigger_fct_evolucao_paciente_befinsert();

