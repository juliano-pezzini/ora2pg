-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

DROP TRIGGER IF EXISTS pls_parametros_ar_afterupdate ON pls_parametros_ar CASCADE;
CREATE OR REPLACE FUNCTION trigger_fct_pls_parametros_ar_afterupdate() RETURNS trigger AS $BODY$
declare

BEGIN

if (NEW.ie_novo_resultado <> OLD.ie_novo_resultado) then
	CALL pls_gerar_log_alt_parametros(	'PLS_PARAMETROS_AR', 'IE_NOVO_RESULTADO', OLD.ie_novo_resultado,
					NEW.ie_novo_resultado, NEW.nm_usuario, NEW.cd_estabelecimento);
end if;

if (NEW.ie_data_conta_medica <> OLD.ie_data_conta_medica) then
	CALL pls_gerar_log_alt_parametros(	'PLS_PARAMETROS_AR', 'IE_DATA_CONTA_MEDICA', OLD.ie_data_conta_medica,
					NEW.ie_data_conta_medica, NEW.nm_usuario, NEW.cd_estabelecimento);
end if;

if (NEW.ie_pro_rata <> OLD.ie_pro_rata) then
	CALL pls_gerar_log_alt_parametros(	'PLS_PARAMETROS_AR', 'IE_PRO_RATA', OLD.ie_pro_rata,
					NEW.ie_pro_rata, NEW.nm_usuario, NEW.cd_estabelecimento);
end if;

if (NEW.ie_data_coparticipacao <> OLD.ie_data_coparticipacao) then
	CALL pls_gerar_log_alt_parametros(	'PLS_PARAMETROS_AR', 'IE_DATA_COPARTICIPACAO', OLD.ie_data_coparticipacao,
					NEW.ie_data_coparticipacao, NEW.nm_usuario, NEW.cd_estabelecimento);
end if;

RETURN NEW;
end
$BODY$
 LANGUAGE 'plpgsql' SECURITY DEFINER;
-- REVOKE ALL ON FUNCTION trigger_fct_pls_parametros_ar_afterupdate() FROM PUBLIC;

CREATE TRIGGER pls_parametros_ar_afterupdate
	AFTER UPDATE ON pls_parametros_ar FOR EACH ROW
	EXECUTE PROCEDURE trigger_fct_pls_parametros_ar_afterupdate();

