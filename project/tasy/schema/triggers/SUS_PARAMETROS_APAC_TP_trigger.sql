-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

DROP TRIGGER IF EXISTS sus_parametros_apac_tp ON sus_parametros_apac CASCADE;
CREATE OR REPLACE FUNCTION trigger_fct_sus_parametros_apac_tp() RETURNS trigger AS $BODY$
declare

nr_seq_w 	bigint;
ds_s_w   		varchar(50);
ds_c_w   		varchar(500);
ds_w     		varchar(500);
ie_log_w 		varchar(1);
BEGIN
  BEGIN

BEGIN
ds_s_w	:= to_char(OLD.cd_estabelecimento);
ds_c_w	:= null;

SELECT * FROM gravar_log_alteracao(substr(OLD.cd_orgao_emissor_apac,1,2000), substr(NEW.cd_orgao_emissor_apac,1,2000), NEW.nm_usuario, nr_seq_w, 'CD_ORGAO_EMISSOR_APAC', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.cd_estabelecimento,1,2000), substr(NEW.cd_estabelecimento,1,2000), NEW.nm_usuario, nr_seq_w, 'CD_ESTABELECIMENTO', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.cd_cnes_hospital,1,2000), substr(NEW.cd_cnes_hospital,1,2000), NEW.nm_usuario, nr_seq_w, 'CD_CNES_HOSPITAL', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.cd_medico_responsavel,1,2000), substr(NEW.cd_medico_responsavel,1,2000), NEW.nm_usuario, nr_seq_w, 'CD_MEDICO_RESPONSAVEL', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.cd_medico_autorizador,1,2000), substr(NEW.cd_medico_autorizador,1,2000), NEW.nm_usuario, nr_seq_w, 'CD_MEDICO_AUTORIZADOR', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.dt_competencia_apac,1,2000), substr(NEW.dt_competencia_apac,1,2000), NEW.nm_usuario, nr_seq_w, 'DT_COMPETENCIA_APAC', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.cd_municipio_ibge,1,2000), substr(NEW.cd_municipio_ibge,1,2000), NEW.nm_usuario, nr_seq_w, 'CD_MUNICIPIO_IBGE', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.cd_interface_envio,1,2000), substr(NEW.cd_interface_envio,1,2000), NEW.nm_usuario, nr_seq_w, 'CD_INTERFACE_ENVIO', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.nm_orgao_destino,1,2000), substr(NEW.nm_orgao_destino,1,2000), NEW.nm_usuario, nr_seq_w, 'NM_ORGAO_DESTINO', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.ie_orgao_destino,1,2000), substr(NEW.ie_orgao_destino,1,2000), NEW.nm_usuario, nr_seq_w, 'IE_ORGAO_DESTINO', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.cd_diretor_clinico,1,2000), substr(NEW.cd_diretor_clinico,1,2000), NEW.nm_usuario, nr_seq_w, 'CD_DIRETOR_CLINICO', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.ie_sigla_apac,1,2000), substr(NEW.ie_sigla_apac,1,2000), NEW.nm_usuario, nr_seq_w, 'IE_SIGLA_APAC', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.cd_unidade_apac,1,2000), substr(NEW.cd_unidade_apac,1,2000), NEW.nm_usuario, nr_seq_w, 'CD_UNIDADE_APAC', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.ie_exporta_resp,1,2000), substr(NEW.ie_exporta_resp,1,2000), NEW.nm_usuario, nr_seq_w, 'IE_EXPORTA_RESP', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.ie_inc_proc_conta_data,1,2000), substr(NEW.ie_inc_proc_conta_data,1,2000), NEW.nm_usuario, nr_seq_w, 'IE_INC_PROC_CONTA_DATA', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
SELECT * FROM gravar_log_alteracao(substr(OLD.ie_exp_cnes_prest_apac,1,2000), substr(NEW.ie_exp_cnes_prest_apac,1,2000), NEW.nm_usuario, nr_seq_w, 'IE_EXP_CNES_PREST_APAC', ie_log_w, ds_w, 'SUS_PARAMETROS_APAC', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;
exception
	when others then
	ds_w	:= '1';
	end;

  END;
RETURN NEW;
end
$BODY$
 LANGUAGE 'plpgsql' SECURITY DEFINER;
-- REVOKE ALL ON FUNCTION trigger_fct_sus_parametros_apac_tp() FROM PUBLIC;

CREATE TRIGGER sus_parametros_apac_tp
	AFTER UPDATE ON sus_parametros_apac FOR EACH ROW
	EXECUTE PROCEDURE trigger_fct_sus_parametros_apac_tp();

