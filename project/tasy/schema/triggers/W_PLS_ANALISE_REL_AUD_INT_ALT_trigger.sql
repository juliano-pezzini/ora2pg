-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

DROP TRIGGER IF EXISTS w_pls_analise_rel_aud_int_alt ON w_pls_analise_rel_aud_int CASCADE;
CREATE OR REPLACE FUNCTION trigger_fct_w_pls_analise_rel_aud_int_alt() RETURNS trigger AS $BODY$
declare
	ds_observacao_w	varchar(4000);
BEGIN 
if (coalesce(wheb_usuario_pck.get_ie_executar_trigger,'S') = 'S') then 
		 
		if (coalesce(OLD.cd_procedimento,'x') <> coalesce(NEW.cd_procedimento,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'código procedimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.cd_procedimento||' - modificada: '||NEW.cd_procedimento;
		end if;	
		 
		if (coalesce(OLD.ds_acao_auditoria,'x') <> coalesce(NEW.ds_acao_auditoria,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição ação auditoria: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_acao_auditoria||' - modificada: '||NEW.ds_acao_auditoria;
		end if;
 
		if (coalesce(OLD.ds_alt_cirurgico_adic_opme,'x') <> coalesce(NEW.ds_alt_cirurgico_adic_opme,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição alteração cirurgico adicionar OPME: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_alt_cirurgico_adic_opme||' - modificada: '||NEW.ds_alt_cirurgico_adic_opme;
		end if;	
 
		if (coalesce(OLD.ds_alt_cirurgico_adic_proc,'x') <> coalesce(NEW.ds_alt_cirurgico_adic_proc,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição alteração cirurgico adicionar procedimentos:'||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_alt_cirurgico_adic_proc||' - modificada: '||NEW.ds_alt_cirurgico_adic_proc;
		end if;	
 
		if (coalesce(OLD.ds_alt_cirurgico_exc_opme,'x') <> coalesce(NEW.ds_alt_cirurgico_exc_opme,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição alteração cirurgico executar OPME: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_alt_cirurgico_exc_opme||' - modificada: '||NEW.ds_alt_cirurgico_exc_opme;
		end if;
 
		if (coalesce(OLD.ds_alt_cirurgico_exc_proc,'x') <> coalesce(NEW.ds_alt_cirurgico_exc_proc,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição alteração cirurgico executar procedimentos: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_alt_cirurgico_exc_proc||' - modificada: '||NEW.ds_alt_cirurgico_exc_proc;
		end if;	
 
		if (coalesce(OLD.ds_alt_cirurgico_mod_tec,'x') <> coalesce(NEW.ds_alt_cirurgico_mod_tec,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição alteração cirurgico modificar tec: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_alt_cirurgico_mod_tec||' - modificada: '||NEW.ds_alt_cirurgico_mod_tec;
		end if;	
 
		if (coalesce(OLD.ds_alt_proced_atend,'x') <> coalesce(NEW.ds_alt_proced_atend,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição alteração procedimento atendimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_alt_proced_atend||' - modificada: '||NEW.ds_alt_proced_atend;
		end if;		
 
		if (coalesce(OLD.ds_anatomopatologico,'x') <> coalesce(NEW.ds_anatomopatologico,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição anatomopatologico: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_anatomopatologico||' - modificada: '||NEW.ds_anatomopatologico;
		end if;	
 
		if (coalesce(OLD.ds_antibiotico,'x') <> coalesce(NEW.ds_antibiotico,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição antibiotico: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_antibiotico||' - modificada: '||NEW.ds_antibiotico;
		end if;	
		 
		if (coalesce(OLD.ds_antibiotico_posologia,'x') <> coalesce(NEW.ds_antibiotico_posologia,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição antibiotico posologia: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_antibiotico_posologia||' - modificada: '||NEW.ds_antibiotico_posologia;
		end if;	
 
		if (coalesce(OLD.ds_anatomop_posologia,'x') <> coalesce(NEW.ds_anatomop_posologia,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição anatomopatologico posologia: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_anatomop_posologia||' - modificada: '||NEW.ds_anatomop_posologia;
		end if;	
 
		if (coalesce(OLD.ds_antifungico,'x') <> coalesce(NEW.ds_antifungico,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição antifúngico: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_antifungico||' - modificada: '||NEW.ds_antifungico;
		end if;	
 
		if (coalesce(OLD.ds_antifungico_posologia,'x') <> coalesce(NEW.ds_antifungico_posologia,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição antifúngico posologia: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_antifungico_posologia||' - modificada: '||NEW.ds_antifungico_posologia;
		end if;	
 
		if (coalesce(OLD.ds_curativo_espec,'x') <> coalesce(NEW.ds_curativo_espec,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição curativo espec: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_curativo_espec||' - modificada: '||NEW.ds_curativo_espec;
		end if;	
 
		if (coalesce(OLD.ds_curativo_espec_posologia,'x') <> coalesce(NEW.ds_curativo_espec_posologia,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição curativo espec posologia: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_curativo_espec_posologia||' - modificada: '||NEW.ds_curativo_espec_posologia;
		end if;		
 
		if (coalesce(OLD.ds_evolucao_clinica,'x') <> coalesce(NEW.ds_evolucao_clinica,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição escrição evolução clínica: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_evolucao_clinica||' - modificada: '||NEW.ds_evolucao_clinica;
		end if;		
 
		if (coalesce(OLD.ds_gasoterapia,'x') <> coalesce(NEW.ds_gasoterapia,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição gasoterapia: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_gasoterapia||' - modificada: '||NEW.ds_gasoterapia;
		end if;	
 
		if (coalesce(OLD.ds_gasoterapia_posologia,'x') <> coalesce(NEW.ds_gasoterapia_posologia,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição gasoterapia posologia: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_gasoterapia_posologia||' - modificada: '||NEW.ds_gasoterapia_posologia;
		end if;		
		 
		if (coalesce(OLD.ds_imunobiologico,'x') <> coalesce(NEW.ds_imunobiologico,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição imunobiológico: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_imunobiologico||' - modificada: '||NEW.ds_imunobiologico;
		end if;
		 
		if (coalesce(OLD.ds_imunobio_posologia,'x') <> coalesce(NEW.ds_imunobio_posologia,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição imunobiológico posologia: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_imunobio_posologia||' - modificada: '||NEW.ds_imunobio_posologia;
		end if;
		 
		if (coalesce(OLD.ds_indicacao_clinica ,'x') <> coalesce(NEW.ds_indicacao_clinica ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição indicação clínica: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_indicacao_clinica ||' - modificada: '||NEW.ds_indicacao_clinica;
		end if;
		 
		if (coalesce(OLD.ds_justificativa ,'x') <> coalesce(NEW.ds_justificativa ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição justificativa: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_justificativa ||' - modificada: '||NEW.ds_justificativa;
		end if;
		 
		if (coalesce(OLD.ds_nutricao_proc ,'x') <> coalesce(NEW.ds_nutricao_proc ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição nutrição procedimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_nutricao_proc ||' - modificada: '||NEW.ds_nutricao_proc;
		end if;
		 
		if (coalesce(OLD.ds_nutricao_proc_posologia ,'x') <> coalesce(NEW.ds_nutricao_proc_posologia ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição nutrição procedimento posologia: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_nutricao_proc_posologia ||' - modificada: '||NEW.ds_nutricao_proc_posologia;
		end if;
		 
		if (coalesce(OLD.ds_opme_proc  ,'x') <> coalesce(NEW.ds_opme_proc  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição OPME procedimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_opme_proc  ||' - modificada: '||NEW.ds_opme_proc;
		end if;	
		 
		if (coalesce(OLD.ds_opme_proc_posologia  ,'x') <> coalesce(NEW.ds_opme_proc_posologia  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição OPME procedimento posologia: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_opme_proc_posologia  ||' - modificada: '||NEW.ds_opme_proc_posologia;
		end if;		
 
		if (coalesce(OLD.ds_oxigenio_hiper  ,'x') <> coalesce(NEW.ds_oxigenio_hiper  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição oxigenio hiper: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_oxigenio_hiper  ||' - modificada: '||NEW.ds_oxigenio_hiper;
		end if;	
		 
		if (coalesce(OLD.ds_oxigenio_hiper_posologia  ,'x') <> coalesce(NEW.ds_oxigenio_hiper_posologia  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição oxigenio hiper posologia: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_oxigenio_hiper_posologia  ||' - modificada: '||NEW.ds_oxigenio_hiper_posologia;
		end if;
		 
		if (coalesce(OLD.ds_proced_princ_aut  ,'x') <> coalesce(NEW.ds_proced_princ_aut  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição procedimento principal aut: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_proced_princ_aut  ||' - modificada: '||NEW.ds_proced_princ_aut;
		end if;	
 
		if (coalesce(OLD.ds_quimio_diferente_util  ,'x') <> coalesce(NEW.ds_quimio_diferente_util  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição quimio diferente util: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_quimio_diferente_util  ||' - modificada: '||NEW.ds_quimio_diferente_util;
		end if;
 
		if (coalesce(OLD.ds_sangue  ,'x') <> coalesce(NEW.ds_sangue  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição sangue: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_sangue  ||' - modificada: '||NEW.ds_sangue;
		end if;	
 
		if (coalesce(OLD.ds_sangue_posologia  ,'x') <> coalesce(NEW.ds_sangue_posologia  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição sangue posologia: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_sangue_posologia  ||' - modificada: '||NEW.ds_sangue_posologia;
		end if;	
 
		if (coalesce(OLD.ds_terapia_renal  ,'x') <> coalesce(NEW.ds_terapia_renal  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição terapia renal: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_terapia_renal  ||' - modificada: '||NEW.ds_terapia_renal;
		end if;		
 
		if (coalesce(OLD.ds_terapia_renal_posologia  ,'x') <> coalesce(NEW.ds_terapia_renal_posologia  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Descrição terapia renal posologia: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ds_terapia_renal_posologia  ||' - modificada: '||NEW.ds_terapia_renal_posologia;
		end if;	
	 
		if (coalesce(to_char(OLD.dt_atualizacao_nrec, 'dd/mm/yyyy hh24:mi:ss'),'x') <> coalesce(to_char(NEW.dt_atualizacao_nrec, 'dd/mm/yyyy hh24:mi:ss'),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Data de atualização: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '||to_char(OLD.dt_atualizacao_nrec, 'dd/mm/yyyy hh24:mi:ss')||' - modificado: '||to_char(NEW.dt_atualizacao_nrec, 'dd/mm/yyyy hh24:mi:ss')||chr(13)||chr(10);
		end if;
		 
				if (coalesce(to_char(OLD.dt_atualizacao, 'dd/mm/yyyy hh24:mi:ss'),'x') <> coalesce(to_char(NEW.dt_atualizacao, 'dd/mm/yyyy hh24:mi:ss'),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Data de atualização: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '||to_char(OLD.dt_atualizacao, 'dd/mm/yyyy hh24:mi:ss')||' - modificado: '||to_char(NEW.dt_atualizacao, 'dd/mm/yyyy hh24:mi:ss')||chr(13)||chr(10);
		end if;
 
		if (coalesce(to_char(OLD.dt_alt_cirurgico_adic_opme, 'dd/mm/yyyy hh24:mi:ss'),'x') <> coalesce(to_char(NEW.dt_alt_cirurgico_adic_opme, 'dd/mm/yyyy hh24:mi:ss'),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Data de alteração cirúrgico adicionar OPME: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '||to_char(OLD.dt_alt_cirurgico_adic_opme, 'dd/mm/yyyy hh24:mi:ss')||' - modificado: '||to_char(NEW.dt_alt_cirurgico_adic_opme, 'dd/mm/yyyy hh24:mi:ss')||chr(13)||chr(10);
		end if;
 
		if (coalesce(to_char(OLD.dt_alt_cirurgico_adic_proc, 'dd/mm/yyyy hh24:mi:ss'),'x') <> coalesce(to_char(NEW.dt_alt_cirurgico_adic_proc, 'dd/mm/yyyy hh24:mi:ss'),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Data de alteração cirúrgico adicionar procedimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '||to_char(OLD.dt_alt_cirurgico_adic_proc, 'dd/mm/yyyy hh24:mi:ss')||' - modificado: '||to_char(NEW.dt_alt_cirurgico_adic_proc, 'dd/mm/yyyy hh24:mi:ss')||chr(13)||chr(10);
		end if;	
 
		if (coalesce(to_char(OLD.dt_alt_cirurgico_exc_opme, 'dd/mm/yyyy hh24:mi:ss'),'x') <> coalesce(to_char(NEW.dt_alt_cirurgico_exc_opme, 'dd/mm/yyyy hh24:mi:ss'),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Data de alteração cirúrgico executar OPME: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '||to_char(OLD.dt_alt_cirurgico_exc_opme, 'dd/mm/yyyy hh24:mi:ss')||' - modificado: '||to_char(NEW.dt_alt_cirurgico_exc_opme, 'dd/mm/yyyy hh24:mi:ss')||chr(13)||chr(10);
		end if;
 
		if (coalesce(to_char(OLD.dt_alt_cirurgico_exc_proc, 'dd/mm/yyyy hh24:mi:ss'),'x') <> coalesce(to_char(NEW.dt_alt_cirurgico_exc_proc, 'dd/mm/yyyy hh24:mi:ss'),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Data de alteração cirúrgico executar procedimento-: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '||to_char(OLD.dt_alt_cirurgico_exc_proc, 'dd/mm/yyyy hh24:mi:ss')||' - modificado: '||to_char(NEW.dt_alt_cirurgico_exc_proc, 'dd/mm/yyyy hh24:mi:ss')||chr(13)||chr(10);
		end if;
 
		if (coalesce(to_char(OLD.dt_alt_cirurgico_mod_tec, 'dd/mm/yyyy hh24:mi:ss'),'x') <> coalesce(to_char(NEW.dt_alt_cirurgico_mod_tec, 'dd/mm/yyyy hh24:mi:ss'),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Data de alteração cirúrgico modificar tec: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '||to_char(OLD.dt_alt_cirurgico_mod_tec, 'dd/mm/yyyy hh24:mi:ss')||' - modificado: '||to_char(NEW.dt_alt_cirurgico_mod_tec, 'dd/mm/yyyy hh24:mi:ss')||chr(13)||chr(10);
		end if;
 
		if (coalesce(to_char(OLD.dt_alt_proced_atend, 'dd/mm/yyyy hh24:mi:ss'),'x') <> coalesce(to_char(NEW.dt_alt_proced_atend, 'dd/mm/yyyy hh24:mi:ss'),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Data de alteração procedimento atendimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '||to_char(OLD.dt_alt_proced_atend, 'dd/mm/yyyy hh24:mi:ss')||' - modificado: '||to_char(NEW.dt_alt_proced_atend, 'dd/mm/yyyy hh24:mi:ss')||chr(13)||chr(10);
		end if;	
		 
		if (coalesce(to_char(OLD.dt_procedimento, 'dd/mm/yyyy hh24:mi:ss'),'x') <> coalesce(to_char(NEW.dt_procedimento, 'dd/mm/yyyy hh24:mi:ss'),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Data procedimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '||to_char(OLD.dt_procedimento, 'dd/mm/yyyy hh24:mi:ss')||' - modificado: '||to_char(NEW.dt_procedimento, 'dd/mm/yyyy hh24:mi:ss')||chr(13)||chr(10);
		end if;
		 
		if (coalesce(to_char(OLD.dt_proced_princ_aut , 'dd/mm/yyyy hh24:mi:ss'),'x') <> coalesce(to_char(NEW.dt_proced_princ_aut , 'dd/mm/yyyy hh24:mi:ss'),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Data procedimento principal aut: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '||to_char(OLD.dt_proced_princ_aut , 'dd/mm/yyyy hh24:mi:ss')||' - modificado: '||to_char(NEW.dt_proced_princ_aut , 'dd/mm/yyyy hh24:mi:ss')||chr(13)||chr(10);
		end if;
		 
		if (coalesce(OLD.hr_alt_cirurgico_adic_opme  ,'x') <> coalesce(NEW.hr_alt_cirurgico_adic_opme  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Hora alteração cirurgico adicionar OPME: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.hr_alt_cirurgico_adic_opme  ||' - modificada: '||NEW.hr_alt_cirurgico_adic_opme;
		end if;	
		 
		if (coalesce(OLD.hr_alt_cirurgico_adic_proc  ,'x') <> coalesce(NEW.hr_alt_cirurgico_adic_proc  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Hora alteração cirurgico adicionar procedimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.hr_alt_cirurgico_adic_proc  ||' - modificada: '||NEW.hr_alt_cirurgico_adic_proc;
		end if;	
		 
		if (coalesce(OLD.hr_alt_cirurgico_exc_opme  ,'x') <> coalesce(NEW.hr_alt_cirurgico_exc_opme  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Hora alteração cirurgico executar OPME: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.hr_alt_cirurgico_exc_opme  ||' - modificada: '||NEW.hr_alt_cirurgico_exc_opme;
		end if;	
		 
		if (coalesce(OLD.hr_alt_cirurgico_exc_proc  ,'x') <> coalesce(NEW.hr_alt_cirurgico_exc_proc  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Hora alteração cirurgico executar procedimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.hr_alt_cirurgico_exc_proc  ||' - modificada: '||NEW.hr_alt_cirurgico_exc_proc;
		end if;	
		 
		if (coalesce(OLD.hr_alt_cirurgico_mod_tec  ,'x') <> coalesce(NEW.hr_alt_cirurgico_mod_tec  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Hora alteração cirurgico modificar tec: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.hr_alt_cirurgico_mod_tec  ||' - modificada: '||NEW.hr_alt_cirurgico_mod_tec;
		end if;	
		 
		if (coalesce(OLD.hr_alt_proced_atend  ,'x') <> coalesce(NEW.hr_alt_proced_atend  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Hora alteração procedimento atendimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.hr_alt_proced_atend  ||' - modificada: '||NEW.hr_alt_proced_atend;
		end if;	
		 
		if (coalesce(OLD.hr_proced_princ_aut  ,'x') <> coalesce(NEW.hr_proced_princ_aut  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Hora procedimento principal aut: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.hr_proced_princ_aut  ||' - modificada: '||NEW.hr_proced_princ_aut;
		end if;	
		 
		if (coalesce(OLD.hr_quimio_diferente_util  ,'x') <> coalesce(NEW.hr_quimio_diferente_util  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Hora quimio diferente util: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.hr_quimio_diferente_util  ||' - modificada: '||NEW.hr_quimio_diferente_util;
		end if;	
		 
		if (coalesce(to_char(OLD.dt_quimio_diferente_util , 'dd/mm/yyyy hh24:mi:ss'),'x') <> coalesce(to_char(NEW.dt_quimio_diferente_util , 'dd/mm/yyyy hh24:mi:ss'),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Data quimio diferente util: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '||to_char(OLD.dt_quimio_diferente_util , 'dd/mm/yyyy hh24:mi:ss')||' - modificado: '||to_char(NEW.dt_quimio_diferente_util , 'dd/mm/yyyy hh24:mi:ss')||chr(13)||chr(10);
		end if;
		 
		if (coalesce(OLD.ie_alt_cirurgico_adic_opme  ,'x') <> coalesce(NEW.ie_alt_cirurgico_adic_opme  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Alteração cirurgico adicionar OPME: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_alt_cirurgico_adic_opme  ||' - modificada: '||NEW.ie_alt_cirurgico_adic_opme;
		end if;	
		 
		if (coalesce(OLD.ie_alt_cirurgico_adic_proc  ,'x') <> coalesce(NEW.ie_alt_cirurgico_adic_proc  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Alteração cirurgico adicionar procedimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_alt_cirurgico_adic_proc  ||' - modificada: '||NEW.ie_alt_cirurgico_adic_proc;
		end if;	
		 
		if (coalesce(OLD.ie_alt_cirurgico_exc_opme  ,'x') <> coalesce(NEW.ie_alt_cirurgico_exc_opme  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Alteração cirurgico executar OPME: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_alt_cirurgico_exc_opme  ||' - modificada: '||NEW.ie_alt_cirurgico_exc_opme;
		end if;	
		 
		if (coalesce(OLD.ie_alt_cirurgico_exc_proc  ,'x') <> coalesce(NEW.ie_alt_cirurgico_exc_proc  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Alteração cirurgico executar procedimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_alt_cirurgico_exc_proc  ||' - modificada: '||NEW.ie_alt_cirurgico_exc_proc;
		end if;	
		 
		if (coalesce(OLD.ie_alt_cirurgico_mod_tec  ,'x') <> coalesce(NEW.ie_alt_cirurgico_mod_tec  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Alteração cirurgico modificar tec: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_alt_cirurgico_mod_tec  ||' - modificada: '||NEW.ie_alt_cirurgico_mod_tec;
		end if;	
		 
		if (coalesce(OLD.ie_alt_proced_atend  ,'x') <> coalesce(NEW.ie_alt_proced_atend  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Alteração procedimento atendimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_alt_proced_atend  ||' - modificada: '||NEW.ie_alt_proced_atend;
		end if;
		 
		if (coalesce(OLD.ie_anatomopatologico  ,'x') <> coalesce(NEW.ie_anatomopatologico  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Anatomopatologico: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_anatomopatologico  ||' - modificada: '||NEW.ie_anatomopatologico;
		end if;
		 
		if (coalesce(OLD.ie_antibiotico  ,'x') <> coalesce(NEW.ie_antibiotico  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Antibiótico: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_antibiotico  ||' - modificada: '||NEW.ie_antibiotico;
		end if;
		 
		if (coalesce(OLD.ie_antifungico  ,'x') <> coalesce(NEW.ie_antifungico  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Antifúngico: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_antifungico  ||' - modificada: '||NEW.ie_antifungico;
		end if;
		 
		if (coalesce(OLD.ie_curativo_espec  ,'x') <> coalesce(NEW.ie_curativo_espec  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Curativo espec: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_curativo_espec  ||' - modificada: '||NEW.ie_curativo_espec;
		end if;
		 
		if (coalesce(OLD.ie_gasoterapia  ,'x') <> coalesce(NEW.ie_gasoterapia  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Gasoterapia: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_gasoterapia  ||' - modificada: '||NEW.ie_gasoterapia;
		end if;
		 
		if (coalesce(OLD.ie_imunobiologico  ,'x') <> coalesce(NEW.ie_imunobiologico  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Imunobiológico: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_imunobiologico  ||' - modificada: '||NEW.ie_imunobiologico;
		end if;
		 
		if (coalesce(OLD.ie_nutricao_proc  ,'x') <> coalesce(NEW.ie_nutricao_proc  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Nutrição procedimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_nutricao_proc  ||' - modificada: '||NEW.ie_nutricao_proc;
		end if;
		 
		if (coalesce(OLD.ie_opme_proc  ,'x') <> coalesce(NEW.ie_opme_proc  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Opme procedimento: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_opme_proc  ||' - modificada: '||NEW.ie_opme_proc;
		end if;
		 
		if (coalesce(OLD.ie_oxigenio_hiper  ,'x') <> coalesce(NEW.ie_oxigenio_hiper  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Oxigênio hiper: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_oxigenio_hiper  ||' - modificada: '||NEW.ie_oxigenio_hiper;
		end if;
		 
		if (coalesce(OLD.ie_proced_princ_aut  ,'x') <> coalesce(NEW.ie_proced_princ_aut  ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Procedimento principal aut: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_proced_princ_aut  ||' - modificada: '||NEW.ie_proced_princ_aut;
		end if;
		 
		if (coalesce(OLD.ie_quimio_diferente_util   ,'x') <> coalesce(NEW.ie_quimio_diferente_util   ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Quimio diferente util: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_quimio_diferente_util   ||' - modificada: '||NEW.ie_quimio_diferente_util;
		end if;
		 
		if (coalesce(OLD.ie_sangue   ,'x') <> coalesce(NEW.ie_sangue   ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Sangue: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_sangue   ||' - modificada: '||NEW.ie_sangue;
		end if;
		 
		if (coalesce(OLD.ie_terapia_renal   ,'x') <> coalesce(NEW.ie_terapia_renal   ,'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Terapia renal: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| OLD.ie_terapia_renal   ||' - modificada: '||NEW.ie_terapia_renal;
		end if;
		 
		 
		if (coalesce(to_char(OLD.nr_seq_analise),'x') <> coalesce(to_char(NEW.nr_seq_analise),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Número seq análise '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| to_char(OLD.nr_seq_analise)   ||' - modificada: '||to_char(NEW.nr_seq_analise);
		end if;
		 
		if (coalesce(to_char(OLD.nr_seq_grupo_membro_enf),'x') <> coalesce(to_char(NEW.nr_seq_grupo_membro_enf),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Número seq grupo membro enf: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| to_char(OLD.nr_seq_grupo_membro_enf)   ||' - modificada: '||to_char(NEW.nr_seq_grupo_membro_enf);
		end if;
		 
		if (coalesce(to_char(OLD.nr_seq_grupo_membro_med),'x') <> coalesce(to_char(NEW.nr_seq_grupo_membro_med),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Número seq grupo membro med: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| to_char(OLD.nr_seq_grupo_membro_med)   ||' - modificada: '||to_char(NEW.nr_seq_grupo_membro_med);
		end if;
		 
		if (coalesce(to_char(OLD.nr_sequencia),'x') <> coalesce(to_char(NEW.nr_sequencia),'x')) then 
			ds_observacao_w :=	ds_observacao_w||chr(13)||chr(10)|| 
						'Número seq grupo membro med: '||chr(13)||chr(10)|| 
						chr(9)||'anterior: '|| to_char(OLD.nr_sequencia)   ||' - modificada: '||to_char(NEW.nr_sequencia);
		end if;
		 
				 
		insert into pls_log_relat_audit( 	nr_sequencia, dt_atualizacao, nm_usuario, 
							dt_atualizacao_nrec, nm_usuario_nrec, 
							ds_log, nr_seq_relatorio) 
				values ( 	nextval('pls_log_relat_audit_seq'), LOCALTIMESTAMP, substr(coalesce(wheb_usuario_pck.get_nm_usuario,'Usuário não identificado '),1,14), 
							LOCALTIMESTAMP, substr(coalesce(wheb_usuario_pck.get_nm_usuario,'Usuário não identificado '),1,14),  
							ds_observacao_w, NEW.nr_sequencia);
		--end if; 
	 
end if;
 
RETURN NEW;
end
$BODY$
 LANGUAGE 'plpgsql' SECURITY DEFINER;
-- REVOKE ALL ON FUNCTION trigger_fct_w_pls_analise_rel_aud_int_alt() FROM PUBLIC;

CREATE TRIGGER w_pls_analise_rel_aud_int_alt
	BEFORE UPDATE ON w_pls_analise_rel_aud_int FOR EACH ROW
	EXECUTE PROCEDURE trigger_fct_w_pls_analise_rel_aud_int_alt();

