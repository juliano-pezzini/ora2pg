-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

DROP TRIGGER IF EXISTS nicu_clinical_rule_tp ON nicu_clinical_rule CASCADE;
CREATE OR REPLACE FUNCTION trigger_fct_nicu_clinical_rule_tp() RETURNS trigger AS $BODY$
DECLARE nr_seq_w bigint;ds_s_w   varchar(1);ds_c_w   varchar(1);ds_w	   varchar(1);ie_log_w varchar(1);BEGIN BEGIN ds_s_w := to_char(OLD.NR_SEQUENCIA);  ds_c_w:=null;SELECT * FROM gravar_log_alteracao(substr(OLD.QT_DATA_LOAD,1,4000), substr(NEW.QT_DATA_LOAD,1,4000), NEW.nm_usuario, nr_seq_w, 'QT_DATA_LOAD', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.ID_DECIMATION_TYPE,1,4000), substr(NEW.ID_DECIMATION_TYPE,1,4000), NEW.nm_usuario, nr_seq_w, 'ID_DECIMATION_TYPE', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_UOFM_LABEL,1,4000), substr(NEW.DS_UOFM_LABEL,1,4000), NEW.nm_usuario, nr_seq_w, 'DS_UOFM_LABEL', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_LOOK_BACK_CRITERIA,1,4000), substr(NEW.IE_LOOK_BACK_CRITERIA,1,4000), NEW.nm_usuario, nr_seq_w, 'IE_LOOK_BACK_CRITERIA', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_OUTBOUND_DATA_VALUE,1,4000), substr(NEW.DS_OUTBOUND_DATA_VALUE,1,4000), NEW.nm_usuario, nr_seq_w, 'DS_OUTBOUND_DATA_VALUE', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_BODY_SYSTEM,1,4000), substr(NEW.IE_BODY_SYSTEM,1,4000), NEW.nm_usuario, nr_seq_w, 'IE_BODY_SYSTEM', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_CARD_COLUMN,1,4000), substr(NEW.IE_CARD_COLUMN,1,4000), NEW.nm_usuario, nr_seq_w, 'IE_CARD_COLUMN', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.NR_SEQ_ORDEM,1,4000), substr(NEW.NR_SEQ_ORDEM,1,4000), NEW.nm_usuario, nr_seq_w, 'NR_SEQ_ORDEM', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_PANEL_LABEL,1,4000), substr(NEW.DS_PANEL_LABEL,1,4000), NEW.nm_usuario, nr_seq_w, 'DS_PANEL_LABEL', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_SITUACAO,1,4000), substr(NEW.IE_SITUACAO,1,4000), NEW.nm_usuario, nr_seq_w, 'IE_SITUACAO', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_SOURCE,1,4000), substr(NEW.IE_SOURCE,1,4000), NEW.nm_usuario, nr_seq_w, 'IE_SOURCE', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.ID_AGING_TYPE,1,4000), substr(NEW.ID_AGING_TYPE,1,4000), NEW.nm_usuario, nr_seq_w, 'ID_AGING_TYPE', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_UOFM_SNM,1,4000), substr(NEW.CD_UOFM_SNM,1,4000), NEW.nm_usuario, nr_seq_w, 'CD_UOFM_SNM', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_BODY_SYSTEM_SNM,1,4000), substr(NEW.CD_BODY_SYSTEM_SNM,1,4000), NEW.nm_usuario, nr_seq_w, 'CD_BODY_SYSTEM_SNM', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_CARD_COLUMN_SNM,1,4000), substr(NEW.CD_CARD_COLUMN_SNM,1,4000), NEW.nm_usuario, nr_seq_w, 'CD_CARD_COLUMN_SNM', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_BODY_SUB_SNM,1,4000), substr(NEW.CD_BODY_SUB_SNM,1,4000), NEW.nm_usuario, nr_seq_w, 'CD_BODY_SUB_SNM', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_BODY_SUB,1,4000), substr(NEW.DS_BODY_SUB,1,4000), NEW.nm_usuario, nr_seq_w, 'DS_BODY_SUB', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_PANEL_SNM,1,4000), substr(NEW.CD_PANEL_SNM,1,4000), NEW.nm_usuario, nr_seq_w, 'CD_PANEL_SNM', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_TOOLTIP_SNM,1,4000), substr(NEW.CD_TOOLTIP_SNM,1,4000), NEW.nm_usuario, nr_seq_w, 'CD_TOOLTIP_SNM', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_TOOLTIP,1,4000), substr(NEW.DS_TOOLTIP,1,4000), NEW.nm_usuario, nr_seq_w, 'DS_TOOLTIP', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_OBX_SNM_MAP,1,4000), substr(NEW.DS_OBX_SNM_MAP,1,4000), NEW.nm_usuario, nr_seq_w, 'DS_OBX_SNM_MAP', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_LABEL_IN,1,4000), substr(NEW.DS_LABEL_IN,1,4000), NEW.nm_usuario, nr_seq_w, 'DS_LABEL_IN', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_SNOMED_IN,1,4000), substr(NEW.CD_SNOMED_IN,1,4000), NEW.nm_usuario, nr_seq_w, 'CD_SNOMED_IN', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_TRIGGER_LABEL,1,4000), substr(NEW.DS_TRIGGER_LABEL,1,4000), NEW.nm_usuario, nr_seq_w, 'DS_TRIGGER_LABEL', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_CATEGORY,1,4000), substr(NEW.IE_CATEGORY,1,4000), NEW.nm_usuario, nr_seq_w, 'IE_CATEGORY', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_APP,1,4000), substr(NEW.IE_APP,1,4000), NEW.nm_usuario, nr_seq_w, 'IE_APP', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.ID_RULE,1,4000), substr(NEW.ID_RULE,1,4000), NEW.nm_usuario, nr_seq_w, 'ID_RULE', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_RULE_TYPE,1,4000), substr(NEW.IE_RULE_TYPE,1,4000), NEW.nm_usuario, nr_seq_w, 'IE_RULE_TYPE', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_SHOW_NA,1,4000), substr(NEW.IE_SHOW_NA,1,4000), NEW.nm_usuario, nr_seq_w, 'IE_SHOW_NA', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_SNOMED_OUT,1,4000), substr(NEW.CD_SNOMED_OUT,1,4000), NEW.nm_usuario, nr_seq_w, 'CD_SNOMED_OUT', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_LABEL,1,4000), substr(NEW.DS_LABEL,1,4000), NEW.nm_usuario, nr_seq_w, 'DS_LABEL', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.CD_SNOMED_UOFM_IN,1,4000), substr(NEW.CD_SNOMED_UOFM_IN,1,4000), NEW.nm_usuario, nr_seq_w, 'CD_SNOMED_UOFM_IN', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.DS_UOFM_IN,1,4000), substr(NEW.DS_UOFM_IN,1,4000), NEW.nm_usuario, nr_seq_w, 'DS_UOFM_IN', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w; SELECT * FROM gravar_log_alteracao(substr(OLD.IE_DATA_LOAD_TYPE,1,4000), substr(NEW.IE_DATA_LOAD_TYPE,1,4000), NEW.nm_usuario, nr_seq_w, 'IE_DATA_LOAD_TYPE', ie_log_w, ds_w, 'NICU_CLINICAL_RULE', ds_s_w, ds_c_w) INTO STRICT nr_seq_w, ie_log_w;   exception when others then ds_w:= '1'; end;   END;
RETURN NEW;
end
$BODY$
 LANGUAGE 'plpgsql' SECURITY DEFINER;
-- REVOKE ALL ON FUNCTION trigger_fct_nicu_clinical_rule_tp() FROM PUBLIC;

CREATE TRIGGER nicu_clinical_rule_tp
	AFTER UPDATE ON nicu_clinical_rule FOR EACH ROW
	EXECUTE PROCEDURE trigger_fct_nicu_clinical_rule_tp();

