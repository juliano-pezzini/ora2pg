-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

DROP TRIGGER IF EXISTS nicu_patient_allergy_befinsert ON nicu_patient_allergy CASCADE;
CREATE OR REPLACE FUNCTION trigger_fct_nicu_patient_allergy_befinsert() RETURNS trigger AS $BODY$
DECLARE
BEGIN

if (wheb_usuario_pck.get_ie_executar_trigger = 'S') then
	BEGIN
	if (NEW.ID_TYPE is not null) and (NEW.DS_TYPE is null) then
		BEGIN
    if (NEW.ID_TYPE = 'DA') then
		  NEW.DS_TYPE := expressao_pck.obter_dic_expressao_loc(1006220,'US');
    elsif (NEW.ID_TYPE = 'FA') then
      NEW.DS_TYPE := expressao_pck.obter_dic_expressao_loc(1007929,'US');
    elsif (NEW.ID_TYPE = 'MA') then
      NEW.DS_TYPE := expressao_pck.obter_dic_expressao_loc(1012173,'US');
    elsif (NEW.ID_TYPE = 'MC') then
      NEW.DS_TYPE := expressao_pck.obter_dic_expressao_loc(1012174,'US');
    end if;
		end;
	end if;

  if (NEW.ID_SEVERITY is not null) and (NEW.DS_SEVERITY is null) then
		BEGIN
    if (NEW.ID_SEVERITY = 'MI') then
      NEW.DS_SEVERITY := expressao_pck.obter_dic_expressao_loc(798762,'US');
    elsif (NEW.ID_SEVERITY = 'MO') then
      NEW.DS_SEVERITY := expressao_pck.obter_dic_expressao_loc(293044,'US');
    elsif (NEW.ID_SEVERITY = 'SV') then
      NEW.DS_SEVERITY := expressao_pck.obter_dic_expressao_loc(724031,'US');
    end if;
    end;
  end if;

	end;
end if;
        
RETURN NEW;
end
$BODY$
 LANGUAGE 'plpgsql' SECURITY DEFINER;
-- REVOKE ALL ON FUNCTION trigger_fct_nicu_patient_allergy_befinsert() FROM PUBLIC;

CREATE TRIGGER nicu_patient_allergy_befinsert
	BEFORE INSERT OR UPDATE ON nicu_patient_allergy FOR EACH ROW
	EXECUTE PROCEDURE trigger_fct_nicu_patient_allergy_befinsert();

