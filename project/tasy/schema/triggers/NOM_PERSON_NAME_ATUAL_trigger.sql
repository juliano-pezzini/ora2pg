-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

DROP TRIGGER IF EXISTS nom_person_name_atual ON person_name CASCADE;
CREATE OR REPLACE FUNCTION trigger_fct_nom_person_name_atual() RETURNS trigger AS $BODY$
declare

qt_minima_w	smallint := 2;
qt_maxima_w	smallint := 25;
BEGIN

if (obter_utiliza_nom(wheb_usuario_pck.get_cd_estabelecimento) = 'S') then
	if (LENGTH(NEW.DS_GIVEN_NAME) < qt_minima_w or LENGTH(NEW.DS_GIVEN_NAME) > qt_maxima_w ) then
		CALL wheb_mensagem_pck.exibir_mensagem_abort(1073379,'DS_TIPO=' || obter_texto_dic_objeto(926380,wheb_usuario_pck.get_nr_seq_idioma,null) || ';' || 'QT_MINIMA=' || qt_minima_w || ';' || 'QT_MAXIMA=' || qt_maxima_w );
	end if;
	if (LENGTH(NEW.DS_FAMILY_NAME) < qt_minima_w or LENGTH(NEW.DS_FAMILY_NAME) > qt_maxima_w) then
		CALL wheb_mensagem_pck.exibir_mensagem_abort(1073379,'DS_TIPO=' || obter_texto_dic_objeto(1025612,wheb_usuario_pck.get_nr_seq_idioma,null) || ';' || 'QT_MINIMA=' || qt_minima_w || ';' || 'QT_MAXIMA=' || qt_maxima_w );
	end if;
	if (LENGTH(NEW.DS_COMPONENT_NAME_1) < qt_minima_w or LENGTH(NEW.DS_COMPONENT_NAME_1) > qt_maxima_w ) then
		CALL wheb_mensagem_pck.exibir_mensagem_abort(1073379,'DS_TIPO=' || obter_texto_dic_objeto(1025613,wheb_usuario_pck.get_nr_seq_idioma,null) || ';' || 'QT_MINIMA=' || qt_minima_w || ';' || 'QT_MAXIMA=' || qt_maxima_w );
	end if;

end if;

RETURN NEW;
end;
$BODY$
 LANGUAGE 'plpgsql' SECURITY DEFINER;
-- REVOKE ALL ON FUNCTION trigger_fct_nom_person_name_atual() FROM PUBLIC;

CREATE TRIGGER nom_person_name_atual
	BEFORE INSERT OR UPDATE ON person_name FOR EACH ROW
	EXECUTE PROCEDURE trigger_fct_nom_person_name_atual();

