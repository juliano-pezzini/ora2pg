-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

DROP TRIGGER IF EXISTS ageint_quest_perguntas_atual ON ageint_quest_perguntas CASCADE;
CREATE OR REPLACE FUNCTION trigger_fct_ageint_quest_perguntas_atual() RETURNS trigger AS $BODY$
DECLARE

qt_reg_w	bigint;


BEGIN

	if NEW.ie_situacao <> 'A' then
	
		select	count(1)
		into STRICT 		qt_reg_w
		from		ageint_quest_estrutura
		where 	nr_seq_pergunta = NEW.nr_sequencia
		and 		ie_situacao = 'A';
		
		if qt_reg_w > 0 then
		
			CALL wheb_mensagem_pck.Exibir_Mensagem_Abort(1085539);
		
		end if;
	
	end if;

RETURN NEW;
END;
$BODY$
 LANGUAGE 'plpgsql' SECURITY DEFINER;
-- REVOKE ALL ON FUNCTION trigger_fct_ageint_quest_perguntas_atual() FROM PUBLIC;

CREATE TRIGGER ageint_quest_perguntas_atual
	BEFORE UPDATE ON ageint_quest_perguntas FOR EACH ROW
	EXECUTE PROCEDURE trigger_fct_ageint_quest_perguntas_atual();

