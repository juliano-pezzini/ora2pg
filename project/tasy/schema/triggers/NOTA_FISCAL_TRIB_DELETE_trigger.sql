-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

DROP TRIGGER IF EXISTS nota_fiscal_trib_delete ON nota_fiscal_trib CASCADE;
CREATE OR REPLACE FUNCTION trigger_fct_nota_fiscal_trib_delete() RETURNS trigger AS $BODY$
declare
/*
PRAGMA AUTONOMOUS_TRANSACTION;
ds_benefic_w	varchar2(80);
dt_emissao_w	date;
vl_total_nota_w	number(15,2);
ds_tributo_w	varchar2(40);
*/
BEGIN


null;
/*
select	substr(obter_nome_pf_pj(cd_pessoa_fisica,cd_cgc),1,80),
	dt_emissao,
	vl_total_nota
into	ds_benefic_w,
	dt_emissao_w,
	vl_total_nota_w
from	nota_fiscal
where	nr_sequencia	= :old.nr_sequencia;

select	ds_tributo
into	ds_tributo_w
from	tributo
where	cd_tributo = :old.cd_tributo;
*/
/*insert	into log__tasy
	(dt_atualizacao,
	nm_usuario,
	cd_log,
	ds_log)
values	(sysdate,
	'Tasy',
	5650,
	'Pessoa nota: ' || ds_benefic_w || chr(13) ||
	'Emissão: ' || dt_emissao_w || chr(13) ||
	'Dt criação tributo: ' || to_char(:old.dt_atualizacao_nrec,'dd/mm/yyyy hh24:mi:ss') || chr(13) ||
	'Valor total nota: ' || vl_total_nota_w || chr(13) ||
	'Tributo: ' || ds_tributo_w || chr(13) ||
	'Valor tributo ' || :old.vl_tributo);
*/
-- commit;
RETURN OLD;
END
$BODY$
 LANGUAGE 'plpgsql' SECURITY DEFINER;
-- REVOKE ALL ON FUNCTION trigger_fct_nota_fiscal_trib_delete() FROM PUBLIC;

CREATE TRIGGER nota_fiscal_trib_delete
	BEFORE DELETE ON nota_fiscal_trib FOR EACH ROW
	EXECUTE PROCEDURE trigger_fct_nota_fiscal_trib_delete();

