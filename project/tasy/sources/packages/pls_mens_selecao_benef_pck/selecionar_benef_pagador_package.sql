-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_mens_selecao_benef_pck.selecionar_benef_pagador ( nr_seq_lote_p pls_lote_mensalidade.nr_sequencia%type, nr_seq_pagador_p pls_contrato_pagador.nr_sequencia%type, cd_estabelecimento_p estabelecimento.cd_estabelecimento%type, nm_usuario_p usuario.nm_usuario%type) AS $body$
DECLARE


ds_select_w		varchar(32000);


BEGIN

CALL exec_sql_dinamico(nm_usuario_p, 'truncate table pls_mens_benef_pag_tmp');

PERFORM set_config('pls_mens_selecao_benef_pck.cd_estabelecimento_w', cd_estabelecimento_p, false);

CALL CALL CALL pls_mens_selecao_benef_pck.carregar_filtros_lote(nr_seq_lote_p, cd_estabelecimento_p, nm_usuario_p);
CALL pls_mens_selecao_benef_pck.carregar_beneficiarios_pag(nr_seq_pagador_p);

CALL pls_mens_selecao_benef_pck.excluir_benef_excecao();

end;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_mens_selecao_benef_pck.selecionar_benef_pagador ( nr_seq_lote_p pls_lote_mensalidade.nr_sequencia%type, nr_seq_pagador_p pls_contrato_pagador.nr_sequencia%type, cd_estabelecimento_p estabelecimento.cd_estabelecimento%type, nm_usuario_p usuario.nm_usuario%type) FROM PUBLIC;
