-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION fis_transf_entre_estab.fis_carga_nf_trans_item ( nr_seq_nf_transf_p bigint) RETURNS varchar AS $body$
DECLARE


ds_retorno_w	varchar(1):= 'S';
idx_array_w	bigint:= 0;

C01 CURSOR FOR
	SELECT	cd_procedimento,
		cd_material,
		ie_origem_proced,
		nm_usuario,
		pr_desconto,
		vl_desconto,
		qt_item_trans,
		vl_liquido,
		vl_total_item_nf,
		vl_unitario_item_nf,
		cd_centro_custo_s,
		cd_conta_contabil_s,
		cd_local_estoque_s,
		cd_natureza_operacao_s,
		ds_nota_fiscal_item_s,
		cd_centro_custo_e,
		cd_conta_contabil_e,
		cd_local_estoque_e,
		cd_natureza_operacao_e,
		ds_nota_fiscal_item_e
	from	nota_fiscal_transf_item
	where	nr_seq_nota_fiscal_trans 	= nr_seq_nf_transf_p  LIMIT 1;

c01_w	c01%rowtype;


BEGIN

begin



open C01;
loop
fetch C01 into
	c01_w;
EXIT WHEN NOT FOUND; /* apply on C01 */
	begin
	
	idx_array_w:= current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item.count + 1;
	
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].cd_procedimento		:= c01_w.cd_procedimento;
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].cd_material			:= c01_w.cd_material;
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].ie_origem_proced		:= c01_w.ie_origem_proced;
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].nm_usuario			:= c01_w.nm_usuario;
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].pr_desconto			:= c01_w.pr_desconto;
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].vl_desconto			:= c01_w.vl_desconto;
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].qt_item_trans		:= c01_w.qt_item_trans;
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].vl_liquido			:= c01_w.vl_liquido;
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].vl_total_item_nf		:= c01_w.vl_total_item_nf;
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].vl_unitario_item_nf		:= c01_w.vl_unitario_item_nf;
	
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].cd_centro_custo_s		:= c01_w.cd_centro_custo_s;
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].cd_conta_contabil_s		:= c01_w.cd_conta_contabil_s;
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].cd_local_estoque_s		:= c01_w.cd_local_estoque_s;
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].cd_natureza_operacao_s	:= c01_w.cd_natureza_operacao_s;
	current_setting('fis_transf_entre_estab.nf_transf_item_saida_w')::registro_nf_transf_item[idx_array_w].ds_nota_fiscal_item_s	:= c01_w.ds_nota_fiscal_item_s;
	
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].cd_procedimento		:= c01_w.cd_procedimento;
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].cd_material		:= c01_w.cd_material;
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].ie_origem_proced		:= c01_w.ie_origem_proced;
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].nm_usuario		:= c01_w.nm_usuario;
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].pr_desconto		:= c01_w.pr_desconto;
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].vl_desconto		:= c01_w.vl_desconto;
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].qt_item_trans		:= c01_w.qt_item_trans;
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].vl_liquido		:= c01_w.vl_liquido;
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].vl_total_item_nf		:= c01_w.vl_total_item_nf;
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].vl_unitario_item_nf	:= c01_w.vl_unitario_item_nf;
	
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].cd_centro_custo_e		:= c01_w.cd_centro_custo_e;
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].cd_conta_contabil_e	:= c01_w.cd_conta_contabil_e;
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].cd_local_estoque_e	:= c01_w.cd_local_estoque_e;
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].cd_natureza_operacao_e	:= c01_w.cd_natureza_operacao_e;
	current_setting('fis_transf_entre_estab.nf_transf_item_entrada_w')::registro_nf_transf_item[idx_array_w].ds_nota_fiscal_item_e	:= c01_w.ds_nota_fiscal_item_e;
	

	end;
end loop;
close C01;

exception
when others then
	ds_retorno_w:=	'N';
end;

return	ds_retorno_w;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION fis_transf_entre_estab.fis_carga_nf_trans_item ( nr_seq_nf_transf_p bigint) FROM PUBLIC;
