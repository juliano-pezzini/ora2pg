-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE ctb_contab_onl_lote_fin_pck.get_estab_centro () AS $body$
BEGIN
if (coalesce(cd_centro_custo_w,0) <> 0) then
    begin
        cd_estab_movto_w := obter_estab_centro_custo(cd_centro_custo_w);

        /*
        5  - Contas a Receber
        6  - Receitas
        14  - Repasse a terceiros
        */

        if (doc_p.doc.cd_tipo_lote_contabil in (14,6,5)) and (ie_regra_centro_estab_w = 'S') and (cd_estab_movto_w <> doc_p.doc.cd_estabelecimento) then
            begin
            cd_centro_custo_w := coalesce(ctb_obter_centro_contab(cd_estab_movto_w,
                                                             cd_centro_custo_w,
                                                             doc_p.doc.cd_estabelecimento),
                                                             cd_centro_custo_w);
            cd_estab_movto_w  := obter_estab_centro_custo(cd_centro_custo_w);
            end;
        end if;
    exception
        when others then
            cd_estab_movto_w := doc_p.cd_estab_movto;
    end;
end if;
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ctb_contab_onl_lote_fin_pck.get_estab_centro () FROM PUBLIC;
