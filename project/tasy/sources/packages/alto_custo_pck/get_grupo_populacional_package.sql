-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION alto_custo_pck.get_grupo_populacional (cd_pessoa_fisica_p text) RETURNS varchar AS $body$
DECLARE

    ds_retorno_w      varchar(255);

BEGIN
    select  CASE WHEN               max(ie_grupo_populacional)=6 THEN   1 WHEN               max(ie_grupo_populacional)=7 THEN   2 WHEN               max(ie_grupo_populacional)=8 THEN   3 WHEN               max(ie_grupo_populacional)=13 THEN  4 WHEN               max(ie_grupo_populacional)=12 THEN  5 WHEN               max(ie_grupo_populacional)=14 THEN  6 WHEN               max(ie_grupo_populacional)=1 THEN   7 WHEN               max(ie_grupo_populacional)=9 THEN   8 WHEN               max(ie_grupo_populacional)=2 THEN   9 WHEN               max(ie_grupo_populacional)=17 THEN  10 WHEN               max(ie_grupo_populacional)=18 THEN  11 WHEN               max(ie_grupo_populacional)=10 THEN  12 WHEN               max(ie_grupo_populacional)=3 THEN   13 WHEN               max(ie_grupo_populacional)=4 THEN   14 WHEN               max(ie_grupo_populacional)=5 THEN   33 WHEN               max(ie_grupo_populacional)=11 THEN  37  ELSE 61 END 
    into STRICT    ds_retorno_w
    from    pessoa_fisica_aux
    where   cd_pessoa_fisica = cd_pessoa_fisica_p;

    return ds_retorno_w;
  END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION alto_custo_pck.get_grupo_populacional (cd_pessoa_fisica_p text) FROM PUBLIC;
