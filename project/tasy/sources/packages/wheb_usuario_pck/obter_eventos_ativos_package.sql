-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE wheb_usuario_pck.obter_eventos_ativos () AS $body$
DECLARE

	evento_w bigint;
	C01		integer;
	ds_comando_w	varchar(2000);
	retorno_w	integer;

	
BEGIN

		ds_comando_w := ' select distinct i.nr_seq_evento '||
				' from  cliente_integracao c, '||
				'    	informacao_integracao i '||
				' where c.nr_seq_inf_integracao = i.nr_sequencia '||
				' and  c.ie_situacao  in (:IE_SITUACAO_A,:IE_SITUACAO_P)';

		PERFORM set_config('wheb_usuario_pck.eventos_ativos_w', numset_t2(), false);

		C01 := DBMS_SQL.OPEN_CURSOR;
		DBMS_SQL.PARSE(C01, ds_comando_w, dbms_sql.Native);
		DBMS_SQL.DEFINE_COLUMN(c01,1,evento_w);		
		DBMS_SQL.BIND_VARIABLE(c01,'IE_SITUACAO_A', 'A',1);
		DBMS_SQL.BIND_VARIABLE(c01,'IE_SITUACAO_P', 'P',1);
		retorno_w := DBMS_SQL.execute(c01);

		while( DBMS_SQL.FETCH_ROWS(C01) > 0 ) loop
			DBMS_SQL.COLUMN_VALUE(C01, 1, evento_w);
			current_setting('wheb_usuario_pck.eventos_ativos_w')::numset_t2.extend;
			current_setting('wheb_usuario_pck.eventos_ativos_w')::numset_t2(current_setting('wheb_usuario_pck.eventos_ativos_w')::numset_t2.count) := evento_w;
		END LOOP;
		DBMS_SQL.CLOSE_CURSOR(C01);
	end;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE wheb_usuario_pck.obter_eventos_ativos () FROM PUBLIC;
