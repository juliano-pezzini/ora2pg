-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pfcs_pck_db_utils.remove_module_settings (nm_module_p text) AS $body$
DECLARE

        nr_register_count_w pfcs_general_rule.nr_sequencia%type := 0;

BEGIN
        select coalesce(count(nr_sequencia),0)
        into STRICT nr_register_count_w
        from pfcs_general_rule;

        if (nr_register_count_w > 0) then
            if (nm_module_p = current_setting('pfcs_pck_db_utils.nm_module_enterprise_demand_w')::FUNCAO.DS_FUNCAO%TYPE) then
                update pfcs_general_rule set
                    qt_time_transfer  = NULL,
                    qt_time_discharge  = NULL,
                    qt_time_admission  = NULL;
            elsif (nm_module_p = current_setting('pfcs_pck_db_utils.nm_module_discharge_manager_w')::FUNCAO.DS_FUNCAO%TYPE) then
                update pfcs_general_rule set
                    hr_start_noon  = NULL,
                    hr_end_noon  = NULL;
            elsif (nm_module_p = current_setting('pfcs_pck_db_utils.nm_module_operating_rooms_w')::FUNCAO.DS_FUNCAO%TYPE) then
                update pfcs_general_rule set
                    qt_time_avail_slot  = NULL,
                    qt_time_pending_surgeries  = NULL,
                    ie_pacu_mean_type  = NULL;
            end if;
        end if;
    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pfcs_pck_db_utils.remove_module_settings (nm_module_p text) FROM PUBLIC;
