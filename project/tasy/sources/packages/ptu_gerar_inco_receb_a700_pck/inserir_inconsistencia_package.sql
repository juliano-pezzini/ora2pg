-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE ptu_gerar_inco_receb_a700_pck.inserir_inconsistencia ( nr_seq_nota_cobr_p ptu_nota_cobranca.nr_sequencia%type, nr_seq_nota_servico_p ptu_nota_servico.nr_sequencia%type, cd_inconsistencia_p ptu_inconsistencia_a700.cd_inconsistencia%type) AS $body$
BEGIN
	
	insert into ptu_serv_pre_pagto_incons(	nr_sequencia,dt_atualizacao,nm_usuario,dt_atualizacao_nrec,nm_usuario_nrec,
			CD_INCONSISTENCIA,NR_SEQ_NOTA_COBR,NR_SEQ_NOTA_SERVICO)
	values (	nextval('ptu_serv_pre_pagto_incons_seq'),clock_timestamp(),get_nm_usuario,clock_timestamp(),get_nm_usuario,
			cd_inconsistencia_p,nr_seq_nota_cobr_p,nr_seq_nota_servico_p);
			
	if (nr_seq_nota_cobr_p IS NOT NULL AND nr_seq_nota_cobr_p::text <> '') and (coalesce(nr_seq_nota_servico_p::text, '') = '') and (current_setting('ptu_gerar_inco_receb_a700_pck.ie_consiste_nota_cobr_w')::varchar(10) <> 'IN') then
		PERFORM set_config('ptu_gerar_inco_receb_a700_pck.ie_consiste_nota_cobr_w', current_setting('ptu_gerar_inco_receb_a700_pck.ptu_inconsist_a700_rec_vetor_w')::ptu_inconsist_a700_rec_v[cd_inconsistencia_p].ie_impede_geracao_conta, false);
	end if;
	
	if (nr_seq_nota_servico_p IS NOT NULL AND nr_seq_nota_servico_p::text <> '') and (current_setting('ptu_gerar_inco_receb_a700_pck.ie_consiste_servico_w')::varchar(10) <> 'IN') then
		PERFORM set_config('ptu_gerar_inco_receb_a700_pck.ie_consiste_servico_w', current_setting('ptu_gerar_inco_receb_a700_pck.ptu_inconsist_a700_rec_vetor_w')::ptu_inconsist_a700_rec_v[cd_inconsistencia_p].ie_impede_geracao_conta, false);
	end if;
		
	
	end;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ptu_gerar_inco_receb_a700_pck.inserir_inconsistencia ( nr_seq_nota_cobr_p ptu_nota_cobranca.nr_sequencia%type, nr_seq_nota_servico_p ptu_nota_servico.nr_sequencia%type, cd_inconsistencia_p ptu_inconsistencia_a700.cd_inconsistencia%type) FROM PUBLIC;
