-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pls_monitor_qualidade_pck.converte_data ( dt_referencia_p text, ds_mascara_p text) RETURNS timestamp AS $body$
DECLARE

 
dt_referencia_w		varchar(20);	
dt_ref_final_w		timestamp;
			

BEGIN 
 
if (dt_referencia_p IS NOT NULL AND dt_referencia_p::text <> '') then 
 
	if (ds_mascara_p = 'AAAAMM') then 
	 
		dt_referencia_w := '01' || substr(dt_referencia_p, 5, 2) || substr(dt_referencia_p, 1, 4);
		 
		dt_ref_final_w := to_date(dt_referencia_w);
	 
	elsif (ds_mascara_p = 'AAAA-MM-DD') then 
		 
		dt_referencia_w := replace(dt_referencia_p, '-', '');
		 
		dt_referencia_w := substr(dt_referencia_w, 7, 2) || substr(dt_referencia_w, 5, 2) || substr(dt_referencia_w, 1, 4);
		 
		dt_ref_final_w := to_date(dt_referencia_w);
		 
	elsif (ds_mascara_p = 'HHMISS') then 
	 
		dt_referencia_w := replace(dt_referencia_p, ':', '');
		 
		dt_referencia_w := to_char(clock_timestamp(), 'ddmmyyyy') || substr(dt_referencia_w, 1, 2) || substr(dt_referencia_w, 3, 2) || substr(dt_referencia_w, 5, 2);
		 
		dt_ref_final_w := to_date(dt_referencia_w, 'ddmmyyyyhh24miss');
	end if;
end if;
 
return dt_ref_final_w;
 
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pls_monitor_qualidade_pck.converte_data ( dt_referencia_p text, ds_mascara_p text) FROM PUBLIC;
