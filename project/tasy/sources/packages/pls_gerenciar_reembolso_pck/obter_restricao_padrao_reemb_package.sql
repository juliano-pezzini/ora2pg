-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';


-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------




CREATE OR REPLACE FUNCTION pls_gerenciar_reembolso_pck.obter_restricao_padrao_reemb ( dados_consistencia_p pls_gerenciar_reembolso_pck.dados_consistencia, nr_id_transacao_p pls_def_reemb_selecao.nr_id_transacao%type, dados_filtro_p pls_gerenciar_reembolso_pck.dados_filtro, valor_bind_p INOUT sql_pck.t_dado_bind) AS $body$
DECLARE


dados_restricao_w	pls_gerenciar_reembolso_pck.dados_restricao_select;
ds_qt_filtro_proc_w	varchar(1000);
ds_qt_filtro_mat_w	varchar(1000);
ds_alias_w		varchar(10);


BEGIN

-- Inicializar o retorno

dados_restricao_w.ds_restricao_proc		:= null;
dados_restricao_w.ds_restricao_mat		:= null;

if (nr_id_transacao_p IS NOT NULL AND nr_id_transacao_p::text <> '') then
	
	ds_alias_w := 'a';
	
	valor_bind_p := pls_gerenciar_reembolso_pck.obter_restricao_fil_item(nr_id_transacao_p, dados_filtro_p, 'P', valor_bind_p);
	
	if (ds_qt_filtro_proc_w IS NOT NULL AND ds_qt_filtro_proc_w::text <> '') then		
		dados_restricao_w.ds_restricao_proc := dados_restricao_w.ds_restricao_proc ||pls_util_pck.enter_w ||ds_qt_filtro_proc_w;
	end if;
	
	valor_bind_p := pls_gerenciar_reembolso_pck.obter_restricao_fil_item(nr_id_transacao_p, dados_filtro_p, 'M', valor_bind_p);
	
	if (ds_qt_filtro_mat_w IS NOT NULL AND ds_qt_filtro_mat_w::text <> '') then		
		dados_restricao_w.ds_restricao_mat := dados_restricao_w.ds_restricao_mat ||pls_util_pck.enter_w ||ds_qt_filtro_mat_w;		
	end if;
		
	dados_restricao_w.ds_restricao_proc := dados_restricao_w.ds_restricao_proc || pls_util_pck.enter_w ||
							'and ' || ds_alias_w || '.nr_seq_conta = :nr_seq_conta';							
							
	dados_restricao_w.ds_restricao_mat := dados_restricao_w.ds_restricao_mat || pls_util_pck.enter_w ||
							'and ' || ds_alias_w || '.nr_seq_conta = :nr_seq_conta';
		
	valor_bind_p := sql_pck.bind_variable(':nr_seq_conta', dados_consistencia_p.nr_seq_conta, valor_bind_p);	

end if;

return;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pls_gerenciar_reembolso_pck.obter_restricao_padrao_reemb ( dados_consistencia_p pls_gerenciar_reembolso_pck.dados_consistencia, nr_id_transacao_p pls_def_reemb_selecao.nr_id_transacao%type, dados_filtro_p pls_gerenciar_reembolso_pck.dados_filtro, valor_bind_p INOUT sql_pck.t_dado_bind) FROM PUBLIC;
