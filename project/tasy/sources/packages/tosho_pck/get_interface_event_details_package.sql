-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

   
    /** 
	+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
	Get the interface event and company name
	+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   **/
 


CREATE OR REPLACE PROCEDURE tosho_pck.get_interface_event_details (nr_seq_event_p bigint, nm_integration_p INOUT text, nm_interface_p INOUT text) AS $body$
BEGIN
   select substr(obter_descricao_padrao('EVENTO_INTEGRACAO', 'DS_EVENTO', i.nr_seq_evento), 1, 80) ,
              (select b.nm_empresa || ' - ' || a.ds_sistema ds
                from  sistema_integracao   a,
                      empresa_integracao   b
                where b.nr_sequencia = a.nr_seq_empresa
                and   a.nr_sequencia = i.nr_seq_sistema_destino
               )
        into STRICT   nm_integration_p,
               nm_interface_p
        from   cliente_integracao      c,
               informacao_integracao   i
        where  c.nr_seq_inf_integracao = i.nr_sequencia
        and    c.ie_situacao = 'A'
        and    i.nr_seq_evento = nr_seq_event_p 
        order by i.nr_sequencia desc LIMIT 1;
    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE tosho_pck.get_interface_event_details (nr_seq_event_p bigint, nm_integration_p INOUT text, nm_interface_p INOUT text) FROM PUBLIC;
