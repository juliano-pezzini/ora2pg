-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_reajuste_pck.inserir_seg_preco_origem () AS $body$
BEGIN

if (tb_nr_seq_tabela_w.count > 0) then
	forall i in tb_nr_seq_tabela_w.first..tb_nr_seq_tabela_w.last
		insert into pls_segurado_preco_origem(nr_sequencia, cd_estabelecimento, dt_atualizacao,
				nm_usuario, nr_seq_segurado, nr_seq_plano,
				dt_atualizacao_nrec, nm_usuario_nrec, vl_preco_atual,
				nr_seq_tabela, ie_origem_preco, nr_seq_reajuste,
				cd_motivo_reajuste, dt_reajuste, nr_seq_preco,
				qt_idade, vl_preco_ant, nr_seq_reajuste_preco,
				nr_seq_vinculo_sca, dt_liberacao, nm_usuario_liberacao)
			values (nextval('pls_segurado_preco_origem_seq'), cd_estabelecimento_p, clock_timestamp(),
				nm_usuario_p, tb_nr_seq_segurado_w(i), tb_nr_seq_plano_w(i),
				clock_timestamp(), nm_usuario_p, tb_vl_preco_sca_w(i),
				tb_nr_seq_tabela_w(i), 'SB', nr_seq_reajuste_p,
				'I', dt_reajuste_p, tb_nr_seq_plano_preco_w(i),
				tb_qt_idade_w(i), tb_vl_preco_ant_sca_w(i), tb_nr_seq_reajuste_sca_w(i),
				tb_nr_seq_vinculo_sca_w(i), clock_timestamp(), nm_usuario_p);
	commit;
end if;

CALL pls_reajuste_pck.limpar_vetor_seg_preco_origem();

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_reajuste_pck.inserir_seg_preco_origem () FROM PUBLIC;
