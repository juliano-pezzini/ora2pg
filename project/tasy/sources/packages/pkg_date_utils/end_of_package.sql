-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pkg_date_utils.end_of ( SOURCE timestamp, Date_FIELD text, CALENDAR CALENDAR DEFAULT ESTABLISHMENT) RETURNS timestamp AS $body$
BEGIN
    CASE Date_FIELD
    WHEN 'YEAR' THEN
      RETURN ADD_MONTHS(TRUNC(SOURCE, 'YEAR'),12) - 1/(24*60*60);
    WHEN 'MONTH' THEN
      RETURN ADD_MONTHS(TRUNC(SOURCE, 'MONTH'),1) - 1/(24*60*60);
    WHEN 'DAY' THEN
      BEGIN
        RETURN TRUNC(SOURCE, 'DD') + 1 - 1/(24*60*60);
      EXCEPTION WHEN OTHERS THEN
        RETURN TRUNC(SOURCE, 'DD') - 1/(24*60*60) + 1;
      END;
    ELSE
      RETURN NULL;
    END CASE;
    RETURN SOURCE;
  END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pkg_date_utils.end_of ( SOURCE timestamp, Date_FIELD text, CALENDAR CALENDAR DEFAULT ESTABLISHMENT) FROM PUBLIC;
