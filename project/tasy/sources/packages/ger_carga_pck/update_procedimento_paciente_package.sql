-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';


	--##################################################################################
CREATE OR REPLACE PROCEDURE ger_carga_pck.update_procedimento_paciente ( procedimento_paciente_p procedimento_paciente ) AS $body$
DECLARE

        procedimento_paciente_w     procedimento_paciente%rowtype;
        procedimento_pac_medico_w   procedimento_pac_medico%rowtype;

BEGIN
        procedimento_paciente_w := procedimento_paciente_p;
        IF (procedimento_paciente_w.nr_sequencia IS NOT NULL AND procedimento_paciente_w.nr_sequencia::text <> '') THEN
            UPDATE procedimento_paciente
            SET
                row = procedimento_paciente_w
            WHERE
                nr_sequencia = procedimento_paciente_w.nr_sequencia;

            SELECT
                *
            INTO STRICT procedimento_pac_medico_w
            FROM
                procedimento_pac_medico
            WHERE
                nr_atendimento = procedimento_paciente_w.nr_atendimento
                AND nr_seq_propaci = procedimento_paciente_w.nr_sequencia  LIMIT 1;

            procedimento_pac_medico_w.dt_atualizacao := procedimento_paciente_w.dt_atualizacao;
            procedimento_pac_medico_w.nm_usuario := procedimento_paciente_w.nm_usuario;
            procedimento_pac_medico_w.cd_procedimento := procedimento_paciente_w.cd_procedimento;
            procedimento_pac_medico_w.ie_origem_proced := procedimento_paciente_w.ie_origem_proced;
            procedimento_pac_medico_w.qt_procedimento := procedimento_paciente_w.qt_procedimento;
            procedimento_pac_medico_w.ie_lado := procedimento_paciente_w.ie_lado;
            procedimento_pac_medico_w.nr_seq_proc_interno := procedimento_paciente_w.nr_seq_proc_interno;
            procedimento_pac_medico_w.dt_procedimento := procedimento_paciente_w.dt_procedimento;
            UPDATE procedimento_pac_medico
            SET
                row = procedimento_pac_medico_w
            WHERE
                nr_sequencia = procedimento_pac_medico_w.nr_sequencia;

        END IF;

    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ger_carga_pck.update_procedimento_paciente ( procedimento_paciente_p procedimento_paciente ) FROM PUBLIC;
