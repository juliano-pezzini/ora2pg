-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE localizador_subsecao_pck.atualizar_row_families ( nr_seq_documento_secao_p bigint, nr_sequencia_p bigint, ie_acao_p text) AS $body$
DECLARE

	
nr_seq_superior_w	documento_subsecao.nr_seq_superior%type;	

BEGIN

if (ie_acao_p = 'I') then
	select	nextval('documento_subsecao_seq')
	into STRICT	nr_seq_superior_w
	;
	
	insert   into  documento_subsecao( nr_sequencia,
										nr_seq_documento_secao,
										dt_atualizacao,
										nm_usuario,
										dt_atualizacao_nrec,
										nm_usuario_nrec,
										nr_seq_apresentacao,
										ie_modo,
										nm_atributo,
										nr_seq_grupo_pg,
										nr_seq_tipo_pg,
										nr_seq_score_flex,
										nr_ficha_tecnica,
										ie_tipo_dosagem,
										ie_controla_adep,
										nr_seq_gas,
										cd_material,
										cd_grupo_material,
										cd_subgrupo_material,
										cd_classe_material,
										ie_evolucao_clinica,
										nr_seq_inf_adic,
										ie_membro,
										ie_aparelho_pa,
										nr_seq_exame,
										nr_seq_origem,
										nr_seq_linked_data,
										ie_evento_tipo,
										ie_tipo_elemento,
										nr_seq_tipo_registro,
										nr_seq_diagnostico,
										nr_seq_temp_conteudo)
	SELECT                              nr_seq_superior_w,
										nr_seq_documento_secao_p,
										clock_timestamp(),
										wheb_usuario_pck.get_nm_usuario,
										clock_timestamp(),
										wheb_usuario_pck.get_nm_usuario,
										nr_seq_apresentacao,
										'A',
										nm_atributo,
										nr_seq_grupo_pg,
										nr_seq_tipo_pg,
										nr_seq_score_flex,
										nr_ficha_tecnica,
										ie_tipo_dosagem,
										ie_controla_adep,
										nr_seq_gas,
										cd_material,
										cd_grupo_material,
										cd_subgrupo_material,
										cd_classe_material,
										ie_evolucao_clinica,
										nr_seq_inf_adic,
										ie_membro,
										ie_aparelho_pa,
										nr_seq_exame,
										nr_sequencia_p,
										nr_seq_linked_data,
										ie_evento_tipo,
										ie_tipo_elemento,
										nr_seq_tipo_registro,
										nr_seq_diagnostico,
										nr_seq_temp_conteudo
	from                                documento_subsecao
	where                               nr_sequencia = nr_sequencia_p;
	
	insert   into  documento_subsecao( nr_sequencia,
										nr_seq_documento_secao,
										dt_atualizacao,
										nm_usuario,
										dt_atualizacao_nrec,
										nm_usuario_nrec,
										nr_seq_apresentacao,
										ie_modo,
										nm_atributo,
										nr_seq_grupo_pg,
										nr_seq_tipo_pg,
										nr_seq_score_flex,
										nr_ficha_tecnica,
										ie_tipo_dosagem,
										ie_controla_adep,
										nr_seq_gas,
										cd_material,
										cd_grupo_material,
										cd_subgrupo_material,
										cd_classe_material,
										ie_evolucao_clinica,
										nr_seq_inf_adic,
										ie_membro,
										ie_aparelho_pa,
										nr_seq_exame,
										nr_seq_origem,
										nr_seq_linked_data,
										ie_evento_tipo,
										ie_tipo_elemento,
										nr_seq_tipo_registro,
										nr_seq_diagnostico,
										nr_seq_superior,
										nr_seq_temp_conteudo,
										nr_ordem_composto,
										ie_mostrar_linha_sup,
										ds_texto_antes,
										ds_texto_depois)
	SELECT                              nextval('documento_subsecao_seq'),
										nr_seq_documento_secao_p,
										clock_timestamp(),
										wheb_usuario_pck.get_nm_usuario,
										clock_timestamp(),
										wheb_usuario_pck.get_nm_usuario,
										nr_seq_apresentacao,
										'A',
										nm_atributo,
										nr_seq_grupo_pg,
										nr_seq_tipo_pg,
										nr_seq_score_flex,
										nr_ficha_tecnica,
										ie_tipo_dosagem,
										ie_controla_adep,
										nr_seq_gas,
										cd_material,
										cd_grupo_material,
										cd_subgrupo_material,
										cd_classe_material,
										ie_evolucao_clinica,
										nr_seq_inf_adic,
										ie_membro,
										ie_aparelho_pa,
										nr_seq_exame,
										nr_sequencia_p,
										nr_seq_linked_data,
										ie_evento_tipo,
										ie_tipo_elemento,
										nr_seq_tipo_registro,
										nr_seq_diagnostico,
										nr_seq_superior_w,
										nr_seq_temp_conteudo,
										nr_ordem_composto,
										ie_mostrar_linha_sup,
										ds_texto_antes,
										ds_texto_depois
	from                                documento_subsecao
	where                               nr_seq_superior = nr_sequencia_p;
	
elsif (ie_acao_p = 'D') then
	delete	from	documento_subsecao
	where	((nr_sequencia = nr_sequencia_p) or (nr_seq_superior = nr_sequencia_p));
end if;	

commit;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE localizador_subsecao_pck.atualizar_row_families ( nr_seq_documento_secao_p bigint, nr_sequencia_p bigint, ie_acao_p text) FROM PUBLIC;
