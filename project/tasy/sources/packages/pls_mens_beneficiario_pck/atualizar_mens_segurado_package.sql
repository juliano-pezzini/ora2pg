-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_mens_beneficiario_pck.atualizar_mens_segurado ( tb_nr_seq_segurado_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_pagador_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_mensalidade_p INOUT pls_util_cta_pck.t_number_table, tb_dt_mesano_referencia_p INOUT pls_util_cta_pck.t_date_table, tb_nr_parcela_p INOUT pls_util_cta_pck.t_number_table, tb_qt_idade_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_plano_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_contrato_p INOUT pls_util_cta_pck.t_number_table, tb_nr_parcela_contrato_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_intercambio_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_titular_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_parentesco_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_subestipulante_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_localizacao_benef_p INOUT pls_util_cta_pck.t_number_table, tb_dt_rescisao_benef_p INOUT pls_util_cta_pck.t_date_table, tb_dt_inicio_cobertura_p INOUT pls_util_cta_pck.t_date_table, tb_dt_fim_cobertura_p INOUT pls_util_cta_pck.t_date_table, tb_ie_tipo_estipulante_p INOUT pls_util_cta_pck.t_varchar2_table_2, tb_ie_rescisao_proporcional_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_ie_pce_proporcional_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_ie_reativacao_proporc_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_nr_seq_segurado_preco_p INOUT pls_util_cta_pck.t_number_table, tb_tb_nr_seq_reajuste_p INOUT pls_util_cta_pck.t_number_table, nr_seq_lote_p bigint, tb_ie_remido_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_nr_seq_regra_susp_reaj_p INOUT pls_util_cta_pck.t_number_table, nm_usuario_p text) AS $body$
BEGIN

if (tb_nr_seq_segurado_p.count > 0) then
	forall i in tb_nr_seq_segurado_p.first..tb_nr_seq_segurado_p.last
		insert	into	pls_mensalidade_segurado(	nr_sequencia, nr_seq_mensalidade, nr_seq_lote, nr_seq_segurado,
				nm_usuario, nm_usuario_nrec, dt_atualizacao, dt_atualizacao_nrec,
				dt_mesano_referencia, nr_parcela, qt_idade,
				nr_seq_plano, nr_seq_contrato, nr_parcela_contrato,
				nr_seq_intercambio, nr_seq_titular, nr_seq_parentesco,
				nr_seq_subestipulante, nr_seq_localizacao_benef, dt_rescisao_benef,
				dt_inicio_cobertura, dt_fim_cobertura, ie_tipo_estipulante,
				ie_rescisao_proporcional, ie_pce_proporcional, ie_reativacao_proporcional,ie_remido,
				nr_seq_segurado_preco, nr_seq_reajuste, nr_seq_regra_susp_reaj_fx)
			values (	nextval('pls_mensalidade_segurado_seq'), tb_nr_seq_mensalidade_p(i), nr_seq_lote_p, tb_nr_seq_segurado_p(i),
				nm_usuario_p, nm_usuario_p, clock_timestamp(), clock_timestamp(),
				tb_dt_mesano_referencia_p(i), tb_nr_parcela_p(i), tb_qt_idade_p(i),
				tb_nr_seq_plano_p(i), tb_nr_seq_contrato_p(i), tb_nr_parcela_contrato_p(i),
				tb_nr_seq_intercambio_p(i), tb_nr_seq_titular_p(i), tb_nr_seq_parentesco_p(i),
				tb_nr_seq_subestipulante_p(i), tb_nr_seq_localizacao_benef_p(i), tb_dt_rescisao_benef_p(i),
				tb_dt_inicio_cobertura_p(i), tb_dt_fim_cobertura_p(i), tb_ie_tipo_estipulante_p(i),
				tb_ie_rescisao_proporcional_p(i), tb_ie_pce_proporcional_p(i), tb_ie_reativacao_proporc_p(i),tb_ie_remido_p(i),
				tb_nr_seq_segurado_preco_p(i), tb_tb_nr_seq_reajuste_p(i), tb_nr_seq_regra_susp_reaj_p(i));
	commit;
end if;

--Limpar as variaveis

tb_nr_seq_segurado_p.delete;
tb_nr_seq_pagador_p.delete;
tb_nr_seq_mensalidade_p.delete;
tb_dt_mesano_referencia_p.delete;
tb_nr_parcela_p.delete;
tb_qt_idade_p.delete;
tb_nr_seq_plano_p.delete;
tb_nr_seq_contrato_p.delete;
tb_nr_parcela_contrato_p.delete;
tb_nr_seq_intercambio_p.delete;
tb_nr_seq_titular_p.delete;
tb_nr_seq_parentesco_p.delete;
tb_nr_seq_subestipulante_p.delete;
tb_nr_seq_localizacao_benef_p.delete;
tb_dt_rescisao_benef_p.delete;
tb_dt_inicio_cobertura_p.delete;
tb_dt_fim_cobertura_p.delete;
tb_ie_tipo_estipulante_p.delete;
tb_ie_rescisao_proporcional_p.delete;
tb_ie_pce_proporcional_p.delete;
tb_ie_reativacao_proporc_p.delete;
tb_ie_remido_p.delete;
tb_nr_seq_regra_susp_reaj_p.delete;
tb_nr_seq_segurado_preco_p.delete;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_mens_beneficiario_pck.atualizar_mens_segurado ( tb_nr_seq_segurado_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_pagador_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_mensalidade_p INOUT pls_util_cta_pck.t_number_table, tb_dt_mesano_referencia_p INOUT pls_util_cta_pck.t_date_table, tb_nr_parcela_p INOUT pls_util_cta_pck.t_number_table, tb_qt_idade_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_plano_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_contrato_p INOUT pls_util_cta_pck.t_number_table, tb_nr_parcela_contrato_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_intercambio_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_titular_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_parentesco_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_subestipulante_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_localizacao_benef_p INOUT pls_util_cta_pck.t_number_table, tb_dt_rescisao_benef_p INOUT pls_util_cta_pck.t_date_table, tb_dt_inicio_cobertura_p INOUT pls_util_cta_pck.t_date_table, tb_dt_fim_cobertura_p INOUT pls_util_cta_pck.t_date_table, tb_ie_tipo_estipulante_p INOUT pls_util_cta_pck.t_varchar2_table_2, tb_ie_rescisao_proporcional_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_ie_pce_proporcional_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_ie_reativacao_proporc_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_nr_seq_segurado_preco_p INOUT pls_util_cta_pck.t_number_table, tb_tb_nr_seq_reajuste_p INOUT pls_util_cta_pck.t_number_table, nr_seq_lote_p bigint, tb_ie_remido_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_nr_seq_regra_susp_reaj_p INOUT pls_util_cta_pck.t_number_table, nm_usuario_p text) FROM PUBLIC;
