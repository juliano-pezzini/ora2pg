-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_tipos_ocor_pck.atualizar_lista_conta ( nr_seq_selecao_p dbms_sql.number_table, ds_observacao_p dbms_sql.varchar2_table, ie_valido_p dbms_sql.varchar2_table, nm_usuario_p usuario.nm_usuario%type, nr_id_transacao_p pls_selecao_ocor_cta.nr_id_transacao%type default null, qt_excedido_p dbms_sql.number_table default num_table_vazia) AS $body$
BEGIN

if (qt_excedido_p.count > 0) then
	forall i in nr_seq_selecao_p.first..nr_seq_selecao_p.last
		update	pls_selecao_ocor_cta
		set	ie_valido_temp = ie_valido_p(i),
			ds_observacao = substr(CASE WHEN ds_observacao = NULL THEN  ds_observacao_p(i)  ELSE pls_util_pck.limita_string(ds_observacao, ds_observacao_p(i)) END , 0, 4000),
			qt_excedido	= qt_excedido_p(i)
		where	nr_id_transacao = nr_id_transacao_p
		and	nr_seq_conta = nr_seq_selecao_p(i);
	
else
	forall i in nr_seq_selecao_p.first..nr_seq_selecao_p.last
		update	pls_selecao_ocor_cta
		set	ie_valido_temp = ie_valido_p(i),
			ds_observacao = substr(CASE WHEN ds_observacao = NULL THEN  ds_observacao_p(i)  ELSE pls_util_pck.limita_string(ds_observacao, ds_observacao_p(i)) END , 0, 4000)
		where	nr_id_transacao = nr_id_transacao_p
		and	nr_seq_conta = nr_seq_selecao_p(i);
	
end if;
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_tipos_ocor_pck.atualizar_lista_conta ( nr_seq_selecao_p dbms_sql.number_table, ds_observacao_p dbms_sql.varchar2_table, ie_valido_p dbms_sql.varchar2_table, nm_usuario_p usuario.nm_usuario%type, nr_id_transacao_p pls_selecao_ocor_cta.nr_id_transacao%type default null, qt_excedido_p dbms_sql.number_table default num_table_vazia) FROM PUBLIC;
