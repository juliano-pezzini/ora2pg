-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE configure_psa_tws_pack.configure_psa_tws_customer () AS $body$
DECLARE


id_application      	application.id%type;
id_datasource       datasource.id%type;

/*++++++++++++CUSTOMER PORTAL ADM++++++++*/

ds_role_customeradm		role.ds_role%TYPE := 'CustomerPortalADM';
nm_role_customeradm	role.nm_role%TYPE := 'customerportaladm';
ds_role_cli_auth_customeradm 	role.ds_role%TYPE := 'CliAuthCustomerPortalADM';
nm_role_cli_auth_customeradm	role.nm_role%TYPE := 'cliAuthCustomerPortalADM';


/*++++++++++++CUSTOMER PORTAL++++++++*/

ds_role_customer		role.ds_role%TYPE := 'CustomerPortal';
nm_role_customer	role.nm_role%TYPE := 'customerportal';
ds_role_cli_auth_customer 	role.ds_role%TYPE := 'CliAuthCustomerPortal';
nm_role_cli_auth_customer	role.nm_role%TYPE := 'cliAuthCustomerPortal';



BEGIN

/*++++++++++++++++++++++++++++++++++++++++++++++ Create application and datasouce to CUSTOMERPORTALADM  +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/

id_application  := configure_psa_tws_pack.create_application_client( 5, 'CUSTOMERPORTALADM', 'customerportaladm', 'WEBSUITE', 'websuite', id_application );
CALL configure_psa_tws_pack.create_role( ds_role_customeradm,  nm_role_customeradm, id_application, 'N');

--Create CUSTOMERPORTALADM

CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_email_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_email_tag')::permission.ds_tag%TYPE, ds_role_customeradm, nm_role_customeradm,  id_application, 'N');
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_location_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_location_tag')::permission.ds_tag%TYPE, ds_role_customeradm, nm_role_customeradm,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_reports_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_reports_tag')::permission.ds_tag%TYPE, ds_role_customeradm, nm_role_customeradm,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_notification_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_notification_tag')::permission.ds_tag%TYPE, ds_role_customeradm, nm_role_customeradm,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_utils_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_utils_tag')::permission.ds_tag%TYPE, ds_role_customeradm,  nm_role_customeradm, id_application, 'N');
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_person_adm_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_person_adm_tag')::permission.ds_tag%TYPE, ds_role_customeradm,  nm_role_customeradm, id_application, 'N');

--Permission Auth

CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_create_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_create_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_customeradm, nm_role_cli_auth_customeradm,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_retrie_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_retrie_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_customeradm, nm_role_cli_auth_customeradm,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_cons_give_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_cons_give_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_customeradm, nm_role_cli_auth_customeradm,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_acti_stat_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_acti_stat_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_customeradm, nm_role_cli_auth_customeradm,  id_application, 'N' );
CALL configure_psa_tws_pack.create_client_role('CUSTOMERPORTALADM', ds_role_cli_auth_customeradm);


/*++++++++++++++++++++++++++++++++++++++++++++++ Create application and datasouce to CUSTOMERPORTAL +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/

id_application  := configure_psa_tws_pack.create_application_client( 5, 'CUSTOMERPORTAL', 'customerportal', 'WEBSUITE', 'websuite', id_application );
CALL configure_psa_tws_pack.create_role( ds_role_customer,  nm_role_customer, id_application, 'N');

--Create CUSTOMERPORTAL

CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_email_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_email_tag')::permission.ds_tag%TYPE, ds_role_customer, nm_role_customer,  id_application, 'N');
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_location_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_location_tag')::permission.ds_tag%TYPE, ds_role_customer, nm_role_customer,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_reports_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_reports_tag')::permission.ds_tag%TYPE, ds_role_customer, nm_role_customer,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_notification_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_notification_tag')::permission.ds_tag%TYPE, ds_role_customer, nm_role_customer,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_utils_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_utils_tag')::permission.ds_tag%TYPE, ds_role_customer,  nm_role_customer, id_application, 'N');
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_person_adm_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_person_adm_tag')::permission.ds_tag%TYPE, ds_role_customer,  nm_role_customer, id_application, 'N');

--Permission Auth

CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_create_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_create_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_customer, nm_role_cli_auth_customer,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_retrie_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_retrie_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_customer, nm_role_cli_auth_customer,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_cons_give_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_cons_give_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_customer, nm_role_cli_auth_customer,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_acti_stat_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_acti_stat_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_customer, nm_role_cli_auth_customer,  id_application, 'N' );

CALL configure_psa_tws_pack.create_client_role('CUSTOMERPORTAL', ds_role_cli_auth_customer);

commit;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE configure_psa_tws_pack.configure_psa_tws_customer () FROM PUBLIC;
