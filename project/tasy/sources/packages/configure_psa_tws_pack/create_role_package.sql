-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

--Declaring Desc permissions





--Declaring TAG permissions




CREATE OR REPLACE PROCEDURE configure_psa_tws_pack.create_role ( ds_role_p role.ds_role%type, nm_role_p role.nm_role%type, id_application_p application.id%type, ie_default_p role.ie_default%type) AS $body$
DECLARE


id_role_w   		role.id%type;


BEGIN

select	max(id)
into STRICT	id_role_w
from	role
where	id_application 	= id_application_p
and	nm_role 	= nm_role_p;


if ( coalesce(id_role_w::text, '') = '' ) then

	id_role_w := psa_uuid_generator;

	-- insert unlinked profile role to websuite application

	insert into role(id, dt_creation, dt_modification, ds_role, nm_role, id_application, ie_default)
	values ( id_role_w, clock_timestamp(), clock_timestamp(), ds_role_p, nm_role_p, id_application_p, ie_default_p );

end if;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE configure_psa_tws_pack.create_role ( ds_role_p role.ds_role%type, nm_role_p role.nm_role%type, id_application_p application.id%type, ie_default_p role.ie_default%type) FROM PUBLIC;
