-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE configure_psa_tws_pack.configure_psa_tws_beneficiary ( nm_attempts client.vl_allowed_login_attempts%type ) AS $body$
DECLARE


id_application      	application.id%type;
id_datasource       	datasource.id%type;

ds_role_proposalHpms	role.ds_role%TYPE := 'ProposalHpms';
nm_role_proposalHpms	role.nm_role%TYPE := 'proposalHpms';

ds_role_beneficiary	role.ds_role%TYPE := 'Beneficiary';
nm_role_beneficiary	role.nm_role%TYPE := 'beneficiary';

ds_role_cli_auth_beneficiary role.ds_role%TYPE := 'CliAuthBeneficiary';
nm_role_cli_auth_beneficiary role.nm_role%TYPE := 'cliAuthBeneficiary';

ds_role_cli_auth_proposal role.ds_role%TYPE := 'CliAuthProposal';
nm_role_cli_auth_proposal role.nm_role%TYPE := 'cliAuthProposal';


BEGIN

/*++++++++++++++++++++++++++++++++++++++++++++++ create application and datasouce to PROPORSALHPMS +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/

id_application := configure_psa_tws_pack.create_application_client( nm_attempts, 'PROPOSALHPMS', 'proposal_hpms', 'HPMS', 'hpms', id_application);

--Utilizado para deletar as permissoes nao sera mais utilizadas

CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_person_adm_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_location_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmsproduct_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmsauthoriz_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmspreventmed_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmscont_retr_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmsmonthlyfee_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_person_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmsbenef_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmscontract_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmsfinancial_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmsfinan_retr_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmsaut_retr_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmsbenef_retr_tag')::permission.ds_tag%TYPE,  id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmsmedbills_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmsaudc_tag')::permission.ds_tag%TYPE, id_application);
CALL configure_psa_tws_pack.delete_permission_role( current_setting('configure_psa_tws_pack.permission_hpmsaudc_retr_tag')::permission.ds_tag%TYPE, id_application);


--Create USERPROPOSALHPMS

CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_email_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_email_tag')::permission.ds_tag%TYPE, ds_role_proposalHpms, nm_role_proposalHpms,  id_application, 'N');
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_location_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_location_tag')::permission.ds_tag%TYPE, ds_role_proposalHpms, nm_role_proposalHpms,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_hpmsproduct_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_hpmsproduct_tag')::permission.ds_tag%TYPE, ds_role_proposalHpms, nm_role_proposalHpms,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_hpmspricesimul_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_hpmspricesimul_tag')::permission.ds_tag%TYPE, ds_role_proposalHpms, nm_role_proposalHpms,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_hpmsproppur_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_hpmsproppur_tag')::permission.ds_tag%TYPE, ds_role_proposalHpms, nm_role_proposalHpms,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role(current_setting('configure_psa_tws_pack.permission_utils_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_utils_tag')::permission.ds_tag%TYPE, ds_role_proposalHpms,  nm_role_proposalHpms,  id_application, 'N');

--Insert Client Proposal Role profile permissions to application

CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_create_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_create_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_beneficiary, nm_role_cli_auth_beneficiary,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_retrie_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_retrie_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_beneficiary, nm_role_cli_auth_beneficiary,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_cons_give_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_cons_give_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_beneficiary, nm_role_cli_auth_beneficiary,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_acti_stat_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_acti_stat_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_beneficiary, nm_role_cli_auth_beneficiary,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_full_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_full_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_beneficiary, nm_role_cli_auth_beneficiary,  id_application, 'N' );

--Insert Client Proposal Role profile permissions to application

CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_create_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_create_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_proposal, nm_role_cli_auth_proposal,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_retrie_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_retrie_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_proposal, nm_role_cli_auth_proposal,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_cons_give_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_cons_give_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_proposal, nm_role_cli_auth_proposal,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_subj_acti_stat_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_subj_acti_stat_tag')::permission.ds_tag%TYPE, ds_role_cli_auth_proposal, nm_role_cli_auth_proposal,  id_application, 'N' );

CALL configure_psa_tws_pack.create_client_role( 'PROPOSALHPMS', ds_role_cli_auth_proposal);

/*++++++++++++++++++++++++++++++++++++++++++++++ Create application and datasouce to BENEFICIARY +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++*/

id_application  := configure_psa_tws_pack.create_application_client( nm_attempts, 'BENEFICIARY', 'beneficiary', 'HPMS', 'hpms', id_application );
CALL configure_psa_tws_pack.create_role( ds_role_beneficiary,  nm_role_beneficiary, id_application, 'N');

--Create BENEFICIARY

CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_email_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_email_tag')::permission.ds_tag%TYPE, ds_role_beneficiary, nm_role_beneficiary,  id_application, 'N');
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_reports_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_reports_tag')::permission.ds_tag%TYPE, ds_role_beneficiary, nm_role_beneficiary,  id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_utils_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_utils_tag')::permission.ds_tag%TYPE, ds_role_beneficiary,  nm_role_beneficiary, id_application, 'N');
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_exams_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_exams_tag')::permission.ds_tag%TYPE, ds_role_beneficiary, nm_role_beneficiary, id_application, 'N' );
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_schedule_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_schedule_tag')::permission.ds_tag%TYPE, ds_role_beneficiary, nm_role_beneficiary, id_application, 'N');
CALL CALL configure_psa_tws_pack.create_permission_role( current_setting('configure_psa_tws_pack.permission_notification_desc')::permission.ds_tag%TYPE, current_setting('configure_psa_tws_pack.permission_notification_tag')::permission.ds_tag%TYPE, ds_role_beneficiary, nm_role_beneficiary,  id_application, 'N' );

CALL configure_psa_tws_pack.create_client_role('BENEFICIARY', ds_role_cli_auth_beneficiary );
commit;
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE configure_psa_tws_pack.configure_psa_tws_beneficiary ( nm_attempts client.vl_allowed_login_attempts%type ) FROM PUBLIC;
