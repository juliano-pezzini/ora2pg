-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION adds_pck.obter_item_adds ( nr_seq_adds_p bigint) RETURNS SETOF T_ITEM_ROW_DATA AS $body$
DECLARE


c01 CURSOR FOR
	SELECT	a.nr_sequencia,
		obter_desc_expressao(coalesce(b.cd_exp_inf_suep,b.cd_exp_informacao)) ds_name,
		obter_desc_expressao(b.CD_EXP_UNIDADE_SUEP,b.ds_unid_med) ds_unid_med,
		b.nr_sequencia  nr_seq_sinal_vital
	from	adds_sv a,
		pep_informacao b
	where	a.nr_seq_modelo	= nr_seq_adds_p
	and	a.nr_seq_sinal_vital = b.nr_sequencia
	and	a.ie_situacao = 'A'
	order by nr_seq_apres;

t_item_row_w	t_item_row;
BEGIN

for r_c01 in c01 loop
	begin

	t_item_row_w.code_chart			:= r_c01.nr_seq_sinal_vital;
	t_item_row_w.nr_seq_sinal_vital		:= r_c01.nr_seq_sinal_vital;
	t_item_row_w.name			:= r_c01.ds_name;
	t_item_row_w.description		:= r_c01.ds_unid_med;
	if ((trim(both t_item_row_w.description) IS NOT NULL AND (trim(both t_item_row_w.description))::text <> '')) then
		t_item_row_w.description	:= '('||t_item_row_w.description||')'; --A camila pediu :)
	end if;
	t_item_row_w.nr_seq_adds_sv		:= r_c01.nr_sequencia;
	t_item_row_w.style			:= 'lines';
	t_item_row_w.qt_size			:= 2;
	t_item_row_w.fixed_scale		:= 0;
	--t_item_row_w.shaded			:= 'true';

	t_item_row_w.color			:= '#000';
	t_item_row_w.fill_color			:= 'transparent';
	if (r_c01.nr_seq_sinal_vital in (363,14,23,60,395,396)) then
		t_item_row_w.style	:= 'candlestickes';
	end if;

	RETURN NEXT t_item_row_w;
	end;
end loop;


return;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION adds_pck.obter_item_adds ( nr_seq_adds_p bigint) FROM PUBLIC;
