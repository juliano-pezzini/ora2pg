-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION atualiza_versao_pck.exp_tables_rule_003 (p_table_name text) RETURNS varchar AS $body$
DECLARE

    v_ret    varchar(1);
    v_qt_ops bigint;

BEGIN
    v_ret := 'S';
    if p_table_name in ('PLS_WEB_PARAM_OUTORGANTE', 'PLS_INCONSISTENCIA', 'PLS_MACRO_PLANO',
        'PLS_PORTAB_INCONSISTENCIA', 'DIOPS_INCONSISTENCIA',
        'SIB_INCONSISTENCIA', 'PTU_INCONSISTENCIA',
        'PLS_CAD_INCONSIST_PESSOA', 'PTU_INCONSISTENCIA_PREST',
        'PTU_INCONSISTENCIA_A700', 'PTU_INCONSISTENCIA_MAT',
        'PLS_MACRO_MENSALIDADE', 'SIB_CONFERENCIA_DIVERG',
        'PLS_MACRO_CARTEIRA', 'PLS_MACRO_ANALISE_AUT', 'PLS_GRUPO_RELATORIO',
        'PLS_MACRO_ALERTAS_EVENTOS', 'PLS_INCONSISTENCIA_INC_SEG',
        'PLS_ATRIBUTOS_WEB', 'PLS_INCONSISTENCIA_INT',
        'PLS_INCONSIST_PROCESSO', 'PLS_INCONSISTENCIA_CONTAB',
        'PLS_INCONSIST_CONTAB_LOTE', 'PLS_INCONSIST_CANCEL_REC',
        'PLS_ITENS_RELAC_CLIENTE', 'SIP_INCONSISTENCIA_SISTEMA',
        'SIP_INCONSISTENCIA', 'PLS_ITENS_SOLICITACAO_LEAD',
        'PLS_ITENS_PROSPECCAO', 'PLS_ITENS_PROPOSTA',
        'PLS_ITENS_ANALISE_ADESAO', 'PLS_OC_CTA_TIPO_VALIDACAO',
        'PLS_OC_CTA_TIPO_VAL_GLOSA', 'PLS_ACAO_ANALISE',
        'PLS_MACRO_MENSAGEM_GUIA', 'PLS_MACRO_ANALISE_ADESAO',
        'PLS_RP_CTA_TIPO_VALIDACAO', 'PLS_CTA_TIPO_PROCESSO',
        'PLS_TIPO_INFORMACAO_BOLETO', 'PLS_CRITICA_MENSALIDADE',
        'PLS_CRITICA_COPARTICIPACAO', 'PLS_OCOR_AUT_TIPO_VALID',
        'PLS_INCONS_LANC_PROG_IMP', 'PLS_TISS_ORIGEM_EVENTO',
        'PLS_CTA_PROCESSO', 'PLS_INCONSISTENCIA_LIB_FAT',
        'PLS_MONITOR_TISS_GPO_PROC', 'PLS_MONITOR_TISS_INC',
        'PLS_ARQUIVOS_BI_TIPOS', 'PLS_ARQUIVOS_BI_LIBERACAO',
        'PLS_FAT_CAMPO', 'PLS_PROCESSO_ADIC_VERSAO',
        'PTU_INCONSISTENCIA_A300', 'PLS_TISS_TERMO_CRED_DEB',
        'PLS_CAD_DUPLICIDADE_LEAD', 'PLS_ATRIB_QUALIF_PREST',
        'PLS_CG_TAB_TASY') then
      begin
        EXECUTE 'select count(*) from pls_outorgante'
          into STRICT v_qt_ops;
      exception
        when others then
          v_qt_ops := 0;
      end;
      if v_qt_ops = 0 then
        v_ret := 'N';
      end if;
    end if;
    return v_ret;
  end;

  --------------------------------------------------------------------------------------
  --                                                                                 
  -- Cria backup das tabelas exportas. Campos LONG e LONG RAW não tem backup.
  --                                                                                 
  -- Tabelas criadas:
  -- B_<BACKUP_PREFIX>_<SHORTNAME>
  --
  -- <BACKUP_PREFIX> é definida no inicio da procedure prepare_update_database,
  -- e é armazenada na variável global G_BACKUP_PREFIX
  --
  -- <SHORTNAME> é o nome abreviado da tabela, definido no cadastro do dicionário.
  -- 
  --------------------------------------------------------------------------------------
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION atualiza_versao_pck.exp_tables_rule_003 (p_table_name text) FROM PUBLIC;
