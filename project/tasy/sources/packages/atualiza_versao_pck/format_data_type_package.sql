-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION atualiza_versao_pck.format_data_type (p_ie_tipo_atributo text, p_qt_tamanho bigint, p_qt_decimais bigint) RETURNS varchar AS $body$
DECLARE

    v_datatype        varchar(128);
    v_length_semantic varchar(128);

BEGIN
    v_datatype := p_ie_tipo_atributo;

    if p_ie_tipo_atributo in ('DATE', 'FLOAT') then
      v_datatype := p_ie_tipo_atributo;
    end if;

    /*    if p_ie_tipo_atributo in ('TIMESTAMP') then
          v_datatype := 'DATE';
        end if;
    */
    if p_ie_tipo_atributo = 'VARCHAR2' then
    
      select CASE WHEN value='AL32UTF8' THEN  'CHAR'  ELSE 'BYTE' END 
        into STRICT v_length_semantic
        from nls_database_parameters
       where parameter = 'NLS_CHARACTERSET';

      v_datatype := 'VARCHAR2(' || p_qt_tamanho || ' ' || v_length_semantic || ')';
    end if;

    if p_ie_tipo_atributo = 'NUMBER' then
      if p_qt_decimais = 0 then
        v_datatype := 'NUMBER(' || p_qt_tamanho || ')';
      else
        v_datatype := 'NUMBER(' || p_qt_tamanho || ',' || p_qt_decimais || ')';
      end if;
    end if;

    return v_datatype;
  end;

  --------------------------------------------------------------------------------------
  --                                                                                 
  -- Ativa o uso de paralelismo na sess√£o de banco de dados. Para este recurso
  -- funcionar, o banco de dados deve ter o recurso configurado.
  --                                                                                 
  --------------------------------------------------------------------------------------
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION atualiza_versao_pck.format_data_type (p_ie_tipo_atributo text, p_qt_tamanho bigint, p_qt_decimais bigint) FROM PUBLIC;
