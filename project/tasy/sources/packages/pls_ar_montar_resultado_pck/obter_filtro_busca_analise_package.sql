-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

-- OBTER_FILTRO_BUSCA_ANALISE



CREATE OR REPLACE FUNCTION pls_ar_montar_resultado_pck.obter_filtro_busca_analise ( ds_param_filtro_p text) RETURNS TB_FILTROS_ANALISE_RESULTADO AS $body$
DECLARE


dados_filtro_w	tb_filtros_analise_resultado;
ds_param_w	varchar(255);
ds_valor_w	varchar(255);

-- retona chave=valor

c_param_valor CURSOR(	ds_param_filtro_pc	text) FOR
	SELECT	ds_valor_vchr2, nr_valor_number, dt_valor_date
	from	table(pls_util_pck.converter_lista_valores(ds_param_filtro_pc, ';'));

-- retorna a chave em um registro e o valor em outro

c_valor CURSOR(	ds_chave_valor_pc	text) FOR
	SELECT	ds_valor_vchr2, nr_valor_number, dt_valor_date
	from	table(pls_util_pck.converter_lista_valores(ds_chave_valor_pc, '='));

BEGIN

for r_c_param_valor_w in c_param_valor(ds_param_filtro_p) loop
	ds_param_w := null;
	
	for r_c_valor_w in c_valor(r_c_param_valor_w.ds_valor_vchr2) loop
		case(ds_param_w)
			when 'nr_seq_grupo_contrato' then
				dados_filtro_w.nr_seq_grupo_contrato := r_c_valor_w.nr_valor_number;
			when 'nr_seq_contrato' then
				dados_filtro_w.nr_seq_contrato := r_c_valor_w.nr_valor_number;
			when 'nr_seq_intercambio' then
				dados_filtro_w.nr_seq_intercambio := r_c_valor_w.nr_valor_number;
			when 'nr_seq_grupo_intercambio' then
				dados_filtro_w.nr_seq_grupo_intercambio := r_c_valor_w.nr_valor_number;
			when 'nr_seq_pagador' then
				dados_filtro_w.nr_seq_pagador := r_c_valor_w.nr_valor_number;
			when 'nr_seq_segurado' then
				dados_filtro_w.nr_seq_segurado := r_c_valor_w.nr_valor_number;
			when 'ie_considerar_dependentes' then
				dados_filtro_w.ie_considerar_dependentes := r_c_valor_w.ds_valor_vchr2;
			when 'cd_estabelecimento' then
				dados_filtro_w.cd_estabelecimento := r_c_valor_w.ds_valor_vchr2;
			when 'ie_tipo_vinculo_operadora' then
				dados_filtro_w.ie_tipo_vinculo_operadora := r_c_valor_w.ds_valor_vchr2;
			when 'nr_seq_faixa_etaria' then
				dados_filtro_w.nr_seq_faixa_etaria := r_c_valor_w.nr_valor_number;
			when 'ie_regulamentacao' then
				dados_filtro_w.ie_regulamentacao := r_c_valor_w.ds_valor_vchr2;
			when 'ie_preco' then
				dados_filtro_w.ie_preco := r_c_valor_w.ds_valor_vchr2;
			when 'ie_tipo_contratacao' then
				dados_filtro_w.ie_tipo_contratacao := r_c_valor_w.ds_valor_vchr2;
			when 'ie_tipo_segurado' then
				dados_filtro_w.ie_tipo_segurado := r_c_valor_w.ds_valor_vchr2;
			when 'ie_situacao_trabalhista' then
				dados_filtro_w.ie_situacao_trabalhista := r_c_valor_w.ds_valor_vchr2;
			when 'ie_tipo_contrato' then
				dados_filtro_w.ie_tipo_contrato := r_c_valor_w.ds_valor_vchr2;
			when 'ie_benef_remido' then
				dados_filtro_w.ie_benef_remido := r_c_valor_w.ds_valor_vchr2;
			when 'nr_seq_congenere' then
				dados_filtro_w.nr_seq_congenere := r_c_valor_w.nr_valor_number;
			when 'dt_inicial' then
				dados_filtro_w.dt_inicial := r_c_valor_w.dt_valor_date;
			when 'dt_final' then
				dados_filtro_w.dt_final := r_c_valor_w.dt_valor_date;
			when 'pr_resultado_inicial' then
				dados_filtro_w.pr_resultado_inicial := r_c_valor_w.nr_valor_number;
			when 'pr_resultado_final' then
				dados_filtro_w.pr_resultado_final := r_c_valor_w.nr_valor_number;
			when 'pr_sinistralidade_inicial' then
				dados_filtro_w.pr_sinistralidade_inicial := r_c_valor_w.nr_valor_number;
			when 'pr_sinistralidade_final' then
				dados_filtro_w.pr_sinistralidade_final := r_c_valor_w.nr_valor_number;
			when 'ds_dimensao_um' then
				dados_filtro_w.ds_dimensao_um := r_c_valor_w.ds_valor_vchr2;
			when 'ds_dimensao_dois' then
				dados_filtro_w.ds_dimensao_dois := r_c_valor_w.ds_valor_vchr2;
			else
				null;
		end case;
		
		ds_param_w := r_c_valor_w.ds_valor_vchr2;
	end loop;
end loop;

return dados_filtro_w;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pls_ar_montar_resultado_pck.obter_filtro_busca_analise ( ds_param_filtro_p text) FROM PUBLIC;
