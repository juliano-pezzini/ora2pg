-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION clinical_notes_pck.get_soap_content_emar ( nr_atendimento_p bigint, nr_sequencia_p bigint, ie_record_type_p text, ie_record_sub_type_p text, ie_soap_type_p text, ie_stage_p bigint, ie_option_p text) RETURNS varchar AS $body$
DECLARE

    ds_content_w varchar(32000);
    ie_alteracao_sol_w varchar(3);
	ds_blood_mgmt varchar(200);
	ds_procedures varchar(200);
	ds_execution_label_w varchar(200);
	ie_drip_shot_w varchar(3);
    cl_notes CURSOR FOR
      SELECT *
      from table(clinical_notes_pck.get_clinical_note_rule(nr_atendimento_p,ie_record_type_p,ie_record_sub_type_p,ie_soap_type_p,ie_stage_p));
	/*Nutrition - Oral Diet*/

	c00 CURSOR FOR
	SELECT distinct SUBSTR(obter_desc_dieta(d.cd_dieta),1,255) item,
		e.dt_alteracao evtDate,
		obter_valor_dominio(1620, e.ie_alteracao) action,
		e.nr_seq_qualidade amt,
		e.qt_dose_adm vol,
		e.nr_seq_satisfacao satis,
		e.ds_justificativa justif
	from prescr_dieta_hor p,
		prescr_mat_alteracao e,
		prescr_medica a,
		prescr_dieta d
	where p.nr_prescricao = e.nr_prescricao
		and d.nr_prescricao		= p.nr_prescricao
		and e.nr_sequencia = nr_sequencia_p
		and p.nr_prescricao = a.nr_prescricao;
	/*Nutrition - Oral supplements*/

	c001 CURSOR FOR
	SELECT distinct SUBSTR(obter_desc_dieta(d.cd_dieta),1,255) item,
		e.dt_alteracao evtDate,
		obter_valor_dominio(1620, e.ie_alteracao) action,
		e.nr_seq_qualidade amt,
		e.qt_dose_adm vol,
		e.nr_seq_satisfacao satis,
		e.ds_justificativa justif
	from prescr_mat_hor p,
		prescr_mat_alteracao e,
		prescr_medica a,
		prescr_dieta d
	where p.nr_prescricao = e.nr_prescricao
		and d.nr_prescricao		= p.nr_prescricao
		and e.nr_sequencia = nr_sequencia_p
		and p.nr_prescricao = a.nr_prescricao;
	/*Nutrition - Adult TPN*/

	c002 CURSOR FOR
	SELECT CASE WHEN x.ie_forma='P' THEN  wheb_mensagem_pck.get_texto(1109952) || ' ' || y.ds_npt  ELSE obter_valor_dominio(1988,x.ie_forma) END  item,
		p.dt_alteracao evtDate,
		obter_valor_dominio(1662, p.ie_alteracao) action,
		obter_valor_dominio(1883, p.ie_forma_infusao) infmethod,
		p.qt_volume_fase || ' ' || obter_desc_expressao(703346) bagVol,
		p.qt_dosagem || ' ' || p.ie_tipo_dosagem infRate,
		p.qt_vol_infundido infvol,
		p.qt_vol_desprezado disvol,
		substr(p.ds_observacao,1,2000) instructions
	FROM prescr_solucao_evento p, nut_pac x
LEFT OUTER JOIN protocolo_npt y ON (x.nr_seq_protocolo = y.nr_sequencia)
WHERE p.nr_sequencia = nr_sequencia_p  and x.nr_prescricao = p.nr_prescricao;
	/*Medicines*/

	c01 CURSOR FOR
	SELECT distinct obter_desc_material(p.cd_item) medicine,
		to_char(p.dt_horario, 'dd/mm/yyyy hh24:mi') schDate,
		cpoe_get_order_unit_data(ah.nr_seq_cpoe,ah.ie_tipo_item,'NR_ORDER_UNIT') nr_order_unit,
		coalesce((SELECT distinct e.NR_SEQUENCIA_RP from cpoe_material  c
		left outer join cpoe_rp e on c.nr_seq_cpoe_rp = e.nr_sequencia where     x.NR_SEQ_MAT_CPOE=c.nr_sequencia ),0) nr_sequencia_rp,
		to_char(p.dt_alteracao, 'dd/mm/yyyy hh24:mi') evtDate,
		coalesce(OBTER_DESC_CAMPO_GRID(336306,CASE WHEN p.ie_alteracao=3 THEN 'A' WHEN p.ie_alteracao=38 THEN 'J' WHEN p.ie_alteracao=5 THEN 'S'  ELSE null END ),
		obter_valor_dominio(1620, p.ie_alteracao)) action,
		nvl2(p.qt_dose_adm,p.qt_dose_adm || ' ' || (SELECT max(z.DS_UNIDADE_MEDIDA)  FROM UNIDADE_MEDIDA_DOSE_V z where z.CD_UNIDADE_MEDIDA = p.cd_um_dose_adm),null) doseAdm,
		ap.ds_via_aplicacao route,
		substr(p.DS_JUSTIFICATIVA,1,2000) justification,
		substr(p.ds_observacao,1,2000) instructions
	from prescr_mat_alteracao p,
		prescr_material x,
		via_aplicacao ap,
		ADEP_HORARIOS_WEB ah
	where p.nr_sequencia = nr_sequencia_p
		and x.nr_prescricao = p.nr_prescricao
		and ap.ie_via_aplicacao = x.ie_via_aplicacao
		and x.cd_material = p.cd_item
		and p.cd_item = ah.cd_item
		and x.nr_sequencia = p.nr_seq_prescricao;
	/*Infusions - Start and restart soln*/

	c011 CURSOR FOR
		SELECT distinct(SELECT CPOE_Obter_desc_info_material(cm.cd_material,cm.cd_mat_comp1,cm.qt_dose_comp1,cm.cd_unid_med_dose_comp1,cm.cd_mat_comp2,cm.qt_dose_comp2,cm.cd_unid_med_dose_comp2,cm.cd_mat_comp3,cm.qt_dose_comp3,cm.cd_unid_med_dose_comp3,cm.cd_mat_dil,cm.qt_dose_dil,cm.cd_unid_med_dose_dil,cm.cd_mat_red,cm.qt_dose_red,cm.cd_unid_med_dose_red,cm.dt_liberacao,null,null,cm.ie_via_aplicacao,null,cm.dt_lib_suspensao,cm.dt_suspensao,cm.ie_administracao,cm.nr_seq_ataque,
cm.nr_seq_procedimento,cm.nr_seq_adicional,cm.nr_seq_hemoterapia,cm.ds_dose_diferenciada,cm.ds_dose_diferenciada_dil,cm.ds_dose_diferenciada_red,cm.ds_dose_diferenciada_comp1,cm.ds_dose_diferenciada_comp2,cm.ds_dose_diferenciada_comp3,cm.cd_mat_comp4,cm.qt_dose_comp4,cm.cd_unid_med_dose_comp4,cm.ds_dose_diferenciada_comp4,cm.cd_mat_comp5,cm.qt_dose_comp5,cm.cd_unid_med_dose_comp5,cm.ds_dose_diferenciada_comp5,cm.cd_mat_comp6,cm.qt_dose_comp6,cm.cd_unid_med_dose_comp6,cm.ds_dose_diferenciada_comp6,
cm.dt_inicio,cm.dt_fim, cm.dt_fim_cih,cm.nr_dia_util,cm.ie_antibiotico,cm.ie_tipo_solucao,cm.cd_mat_comp7,cm.qt_dose_comp7,cm.cd_unid_med_dose_comp7,cm.ds_dose_diferenciada_comp7,null,cm.cd_mat_recons,cm.qt_dose_recons,cm.cd_unid_med_dose_recons,cm.ds_dose_diferenciada_rec,cm.ds_solucao,cm.ie_duracao,cm.ie_ref_calculo,cm.nr_etapas,cm.ie_controle_tempo,cm.qt_dias_solicitado,cm.qt_dias_liberado,cm.nr_atendimento,cm.ie_baixado_por_alta,cm.dt_alta_medico,substr(cpoe_if_item_allowed(wheb_usuario_pck.get_cd_perfil,'DR'),1,80),
'N',cm.nr_sequencia,obter_horarios_regra(cm.ds_horarios),null,cm.ie_reset_atb,cm.nr_seq_cpoe_anterior,cm.ds_calc_therap_dose,null,cm.qt_final_concentration,cm.ie_um_final_conc_pca,cm.qt_dose_range_min,cm.qt_dose_range_max,cm.ie_dose_range,cm.ds_medic_nao_padrao,cm.ie_medicacao_paciente,'S',cm.qt_dose_dia)
from cpoe_material cm where     p.NR_SEQ_CPOE=cm.nr_sequencia)soln,
            PKG_DATE_FORMATERS.to_varchar(p.dt_alteracao,'timestamp',wheb_usuario_pck.get_cd_estabelecimento,wheb_usuario_pck.get_nm_usuario) evtDate,
            obter_valor_dominio(1662, p.ie_alteracao) action,
            obter_valor_dominio(1883, p.ie_forma_infusao) infmethod,
            ap.ds_via_aplicacao route,
            (CASE WHEN (p.qt_volume_fase IS NOT NULL AND p.qt_volume_fase::text <> '') THEN p.qt_volume_fase || ' ' || obter_desc_expressao(703346) ELSE null END) bagVol,
           (CASE WHEN (p.qt_dosagem IS NOT NULL AND p.qt_dosagem::text <> '') THEN p.qt_dosagem||' '||obter_valor_dominio(93,p.ie_tipo_dosagem) ELSE null END) infRate,
(select coalesce(substr(ad.ds_motivo,1,2000),null) from adep_motivo_admnistracao ad where (coalesce(p.nr_seq_motivo_adm::text, '') = ''
or p.nr_seq_motivo_adm = ad.nr_sequencia)) rsn,
            substr(p.ds_observacao,1,2000) instructions,
             PKG_DATE_FORMATERS.to_varchar(p.DT_HORARIO,'timestamp',wheb_usuario_pck.get_cd_estabelecimento,wheb_usuario_pck.get_nm_usuario) sched_time,
             (CASE WHEN (ps.qt_dose_nais IS NOT NULL AND ps.qt_dose_nais::text <> '') THEN ps.qt_dose_nais||' '|| ps.qt_unid_medida_nais ELSE null END) nais_p,
             obter_valor_dominio(1537,ps.ie_bomba_infusao) devic_p,
             (CASE WHEN (ps.qt_dosagem IS NOT NULL AND ps.qt_dosagem::text <> '') THEN ps.qt_dosagem||' '||obter_valor_dominio(93,ps.ie_tipo_dosagem) ELSE null END) qt_original,
             obter_valor_dominio(10330, p.IE_STERILE_PREPARATION) ie_sterile_prep_p,
              (CASE WHEN (p.qt_dose_terapeutica IS NOT NULL AND p.qt_dose_terapeutica::text <> '') THEN p.qt_dose_terapeutica||' '||p.ie_tipo_dosagem ELSE null END) qt_dose_terap_p,
              obter_pf_usuario(coalesce(ps.nm_usuario, a.nm_usuario),'N') ds_orderer_p,
			(select max(cpoe_get_order_unit_data(ah.nr_seq_cpoe,ah.ie_tipo_item,'NR_ORDER_UNIT')) from adep_horarios_web ah
			where  x.nr_prescricao = ah.nr_prescricao and  p.nr_seq_solucao = ah.nr_seq_item )nr_order_unit,
			coalesce((select distinct e.NR_SEQUENCIA_RP from cpoe_material  c left outer join cpoe_rp e on c.nr_seq_cpoe_rp = e.nr_sequencia where     x.NR_SEQ_MAT_CPOE=c.nr_sequencia ),0)  nr_sequencia_rp
			from prescr_solucao_evento p
			join prescr_material x on x.nr_sequencia = p.nr_seq_solucao and x.nr_prescricao = p.nr_prescricao
			join prescr_solucao ps on  ps.nr_prescricao = p.nr_prescricao  and ps.NR_SEQ_SOLUCAO = p.NR_SEQ_SOLUCAO
			join prescr_medica a on x.nr_prescricao = a.nr_prescricao
			left outer join via_aplicacao ap on ap.ie_via_aplicacao = x.ie_via_aplicacao
			where p.nr_sequencia = nr_sequencia_p;
	/*Infusions - Stop*/

	c012 CURSOR FOR
		SELECT distinct(SELECT CPOE_Obter_desc_info_material(cm.cd_material,cm.cd_mat_comp1,cm.qt_dose_comp1,cm.cd_unid_med_dose_comp1,cm.cd_mat_comp2,cm.qt_dose_comp2,cm.cd_unid_med_dose_comp2,cm.cd_mat_comp3,cm.qt_dose_comp3,cm.cd_unid_med_dose_comp3,cm.cd_mat_dil,cm.qt_dose_dil,cm.cd_unid_med_dose_dil,cm.cd_mat_red,cm.qt_dose_red,cm.cd_unid_med_dose_red,cm.dt_liberacao,null,null,cm.ie_via_aplicacao,null,cm.dt_lib_suspensao,cm.dt_suspensao,cm.ie_administracao,cm.nr_seq_ataque,
cm.nr_seq_procedimento,cm.nr_seq_adicional,cm.nr_seq_hemoterapia,cm.ds_dose_diferenciada,cm.ds_dose_diferenciada_dil,cm.ds_dose_diferenciada_red,cm.ds_dose_diferenciada_comp1,cm.ds_dose_diferenciada_comp2,cm.ds_dose_diferenciada_comp3,cm.cd_mat_comp4,cm.qt_dose_comp4,cm.cd_unid_med_dose_comp4,cm.ds_dose_diferenciada_comp4,cm.cd_mat_comp5,cm.qt_dose_comp5,cm.cd_unid_med_dose_comp5,cm.ds_dose_diferenciada_comp5,cm.cd_mat_comp6,cm.qt_dose_comp6,cm.cd_unid_med_dose_comp6,cm.ds_dose_diferenciada_comp6,
cm.dt_inicio,cm.dt_fim, cm.dt_fim_cih,cm.nr_dia_util,cm.ie_antibiotico,cm.ie_tipo_solucao,cm.cd_mat_comp7,cm.qt_dose_comp7,cm.cd_unid_med_dose_comp7,cm.ds_dose_diferenciada_comp7,null,cm.cd_mat_recons,cm.qt_dose_recons,cm.cd_unid_med_dose_recons,cm.ds_dose_diferenciada_rec,cm.ds_solucao,cm.ie_duracao,cm.ie_ref_calculo,cm.nr_etapas,cm.ie_controle_tempo,cm.qt_dias_solicitado,cm.qt_dias_liberado,cm.nr_atendimento,cm.ie_baixado_por_alta,cm.dt_alta_medico,substr(cpoe_if_item_allowed(wheb_usuario_pck.get_cd_perfil,'DR'),1,80),
'N',cm.nr_sequencia,obter_horarios_regra(cm.ds_horarios),null,cm.ie_reset_atb,cm.nr_seq_cpoe_anterior,cm.ds_calc_therap_dose,null,cm.qt_final_concentration,cm.ie_um_final_conc_pca,cm.qt_dose_range_min,cm.qt_dose_range_max,cm.ie_dose_range,cm.ds_medic_nao_padrao,cm.ie_medicacao_paciente,'S',cm.qt_dose_dia)
from cpoe_material cm where     p.NR_SEQ_CPOE=cm.nr_sequencia) soln,
             PKG_DATE_FORMATERS.to_varchar(p.dt_alteracao,'timestamp',wheb_usuario_pck.get_cd_estabelecimento,wheb_usuario_pck.get_nm_usuario) evtDate,
             obter_valor_dominio(1662, p.ie_alteracao) action,
             ap.ds_via_aplicacao route,
(select coalesce(substr(max(ad.ds_motivo),1,2000),null) from adep_motivo_admnistracao ad where (coalesce(p.nr_seq_motivo_adm::text, '') = ''
or p.nr_seq_motivo_adm = ad.nr_sequencia)) rsn,
             (CASE WHEN (p.qt_volume_fase IS NOT NULL AND p.qt_volume_fase::text <> '') THEN p.qt_volume_fase || ' ' || obter_desc_expressao(703346) ELSE null END) bagVol,
             (CASE WHEN (p.qt_vol_infundido IS NOT NULL AND p.qt_vol_infundido::text <> '') THEN p.qt_vol_infundido||' '|| obter_desc_expressao(703346) ELSE null END) infvol,
             (CASE WHEN (p.qt_vol_desprezado IS NOT NULL AND p.qt_vol_desprezado::text <> '') THEN p.qt_vol_desprezado||' '|| obter_desc_expressao(703346) ELSE null END) disvol,
              (CASE WHEN (p.qt_volume_parcial IS NOT NULL AND p.qt_volume_parcial::text <> '') THEN p.qt_volume_parcial||' '|| obter_desc_expressao(703346) ELSE null END) part_volume_p,
             substr(p.ds_observacao,1,2000) instructions,
              (select max(cpoe_get_order_unit_data(ah.nr_seq_cpoe,ah.ie_tipo_item,'NR_ORDER_UNIT')) from adep_horarios_web ah
			where  x.nr_prescricao = ah.nr_prescricao
			and  p.nr_seq_solucao = ah.nr_seq_item )nr_order_unit,
               PKG_DATE_FORMATERS.to_varchar(p.DT_HORARIO,'timestamp',wheb_usuario_pck.get_cd_estabelecimento,wheb_usuario_pck.get_nm_usuario) sched_time,
              (CASE WHEN (p.qt_min_pausa IS NOT NULL AND p.qt_min_pausa::text <> '') THEN p.qt_min_pausa ||' ' ||obter_valor_dominio(1889,'MI') ELSE null END) pause_time_p,
			coalesce((select distinct e.NR_SEQUENCIA_RP from cpoe_material  c
		left outer join cpoe_rp e on c.nr_seq_cpoe_rp = e.nr_sequencia where     x.NR_SEQ_MAT_CPOE=c.nr_sequencia ),0)  nr_sequencia_rp
		from prescr_solucao_evento p
        join prescr_material x on x.nr_sequencia = p.nr_seq_solucao and x.nr_prescricao = p.nr_prescricao
        join prescr_solucao ps on  ps.nr_prescricao = p.nr_prescricao  and ps.NR_SEQ_SOLUCAO = p.NR_SEQ_SOLUCAO
        join prescr_medica a on x.nr_prescricao = a.nr_prescricao
        left outer join via_aplicacao ap on ap.ie_via_aplicacao = x.ie_via_aplicacao
        where p.nr_sequencia = nr_sequencia_p;
	/*Infusions - Finish*/

	c013 CURSOR FOR
SELECT distinct(Select CPOE_Obter_desc_info_material(cm.cd_material,cm.cd_mat_comp1,cm.qt_dose_comp1,cm.cd_unid_med_dose_comp1,cm.cd_mat_comp2,cm.qt_dose_comp2,cm.cd_unid_med_dose_comp2,cm.cd_mat_comp3,cm.qt_dose_comp3,cm.cd_unid_med_dose_comp3,cm.cd_mat_dil,cm.qt_dose_dil,cm.cd_unid_med_dose_dil,cm.cd_mat_red,cm.qt_dose_red,cm.cd_unid_med_dose_red,cm.dt_liberacao,null,null,cm.ie_via_aplicacao,null,cm.dt_lib_suspensao,cm.dt_suspensao,cm.ie_administracao,cm.nr_seq_ataque,
cm.nr_seq_procedimento,cm.nr_seq_adicional,cm.nr_seq_hemoterapia,cm.ds_dose_diferenciada,cm.ds_dose_diferenciada_dil,cm.ds_dose_diferenciada_red,cm.ds_dose_diferenciada_comp1,cm.ds_dose_diferenciada_comp2,cm.ds_dose_diferenciada_comp3,cm.cd_mat_comp4,cm.qt_dose_comp4,cm.cd_unid_med_dose_comp4,cm.ds_dose_diferenciada_comp4,cm.cd_mat_comp5,cm.qt_dose_comp5,cm.cd_unid_med_dose_comp5,cm.ds_dose_diferenciada_comp5,cm.cd_mat_comp6,cm.qt_dose_comp6,cm.cd_unid_med_dose_comp6,cm.ds_dose_diferenciada_comp6,
cm.dt_inicio,cm.dt_fim, cm.dt_fim_cih,cm.nr_dia_util,cm.ie_antibiotico,cm.ie_tipo_solucao,cm.cd_mat_comp7,cm.qt_dose_comp7,cm.cd_unid_med_dose_comp7,cm.ds_dose_diferenciada_comp7,null,cm.cd_mat_recons,cm.qt_dose_recons,cm.cd_unid_med_dose_recons,cm.ds_dose_diferenciada_rec,cm.ds_solucao,cm.ie_duracao,cm.ie_ref_calculo,cm.nr_etapas,cm.ie_controle_tempo,cm.qt_dias_solicitado,cm.qt_dias_liberado,cm.nr_atendimento,cm.ie_baixado_por_alta,cm.dt_alta_medico,substr(cpoe_if_item_allowed(wheb_usuario_pck.get_cd_perfil,'DR'),1,80),
'N',cm.nr_sequencia,obter_horarios_regra(cm.ds_horarios),null,cm.ie_reset_atb,cm.nr_seq_cpoe_anterior,cm.ds_calc_therap_dose,null,cm.qt_final_concentration,cm.ie_um_final_conc_pca,cm.qt_dose_range_min,cm.qt_dose_range_max,cm.ie_dose_range,cm.ds_medic_nao_padrao,cm.ie_medicacao_paciente,'S',cm.qt_dose_dia)
from cpoe_material cm where     p.NR_SEQ_CPOE=cm.nr_sequencia) soln,
             PKG_DATE_FORMATERS.to_varchar(p.dt_alteracao,'timestamp',wheb_usuario_pck.get_cd_estabelecimento,wheb_usuario_pck.get_nm_usuario) evtDate,
             obter_valor_dominio(1662, p.ie_alteracao) action,
             ap.ds_via_aplicacao route,
             p.qt_volume_fase || ' '|| obter_desc_expressao(703346) bagVol,
              (CASE WHEN (p.qt_vol_infundido IS NOT NULL AND p.qt_vol_infundido::text <> '') THEN p.qt_vol_infundido||' '||obter_desc_expressao(703346) ELSE null END) infvol,
             (CASE WHEN (p.qt_vol_desprezado IS NOT NULL AND p.qt_vol_desprezado::text <> '') THEN p.qt_vol_desprezado||' '||obter_desc_expressao(703346) ELSE null END) disvol,
              (CASE WHEN (p.qt_volume_parcial IS NOT NULL AND p.qt_volume_parcial::text <> '') THEN p.qt_volume_parcial||' '||obter_desc_expressao(703346) ELSE null END) part_volume_p,
             substr(p.ds_observacao,1,2000) instructions,
              PKG_DATE_FORMATERS.to_varchar(p.DT_HORARIO,'timestamp',wheb_usuario_pck.get_cd_estabelecimento,wheb_usuario_pck.get_nm_usuario) sched_time,
              (select max(cpoe_get_order_unit_data(ah.nr_seq_cpoe,ah.ie_tipo_item,'NR_ORDER_UNIT')) from adep_horarios_web ah
                where  x.nr_prescricao = ah.nr_prescricao and  p.nr_seq_solucao = ah.nr_seq_item )nr_order_unit,
			coalesce((select distinct e.NR_SEQUENCIA_RP from cpoe_material  c
		left outer join cpoe_rp e on c.nr_seq_cpoe_rp = e.nr_sequencia where     x.NR_SEQ_MAT_CPOE=c.nr_sequencia ),0)  nr_sequencia_rp
        from prescr_solucao_evento p
        join prescr_material x on x.nr_sequencia = p.nr_seq_solucao and x.nr_prescricao = p.nr_prescricao
        join prescr_solucao ps on  ps.nr_prescricao = p.nr_prescricao  and ps.NR_SEQ_SOLUCAO = p.NR_SEQ_SOLUCAO
        join prescr_medica a on x.nr_prescricao = a.nr_prescricao
        left outer join via_aplicacao ap on ap.ie_via_aplicacao = x.ie_via_aplicacao
        where p.nr_sequencia = nr_sequencia_p;
	/*Exams and Procedures*/

	c02 CURSOR FOR
		SELECT distinct SUBSTR(Obter_Desc_Prescr_Proc(b.CD_PROCEDIMENTO,b.IE_ORIGEM_PROCED,b.nr_seq_proc_interno),1,255) item,
             p.dt_alteracao evtDate,
             obter_valor_dominio(1620, p.ie_alteracao) action,
             substr(p.DS_JUSTIFICATIVA,1,2000) justification,
             substr(p.ds_observacao,1,2000) instructions
		from prescr_mat_alteracao p,
			prescr_proc_hor c,
			prescr_medica a,
      prescr_procedimento b
		where p.nr_sequencia = nr_sequencia_p
			and	c.nr_prescricao = b.nr_prescricao
			and	c.nr_seq_procedimento = b.nr_sequencia
			and	b.nr_prescricao = a.nr_prescricao
			and	c.nr_prescricao = a.nr_prescricao
			and c.nr_prescricao = p.nr_prescricao
      and p.nr_seq_horario_proc = c.nr_sequencia;
	c03 CURSOR FOR
	/*Gas therapy*/

	SELECT distinct y.ds_gas item,
		e.dt_evento evtDate,
		obter_valor_dominio(2702, e.ie_evento) action,
		e.qt_gasoterapia qty,
		e.ie_unidade_medida uom,
		obter_valor_dominio(1612, e.ie_disp_resp_esp) device,
		e.ds_justificativa justif
	from prescr_gasoterapia_hor h, prescr_gasoterapia_evento e,
		gas y,
		prescr_gasoterapia x
	where h.nr_seq_gasoterapia = e.nr_seq_gasoterapia
		and e.nr_sequencia = nr_sequencia_p
		and x.nr_seq_gas = y.nr_sequencia
		and h.nr_prescricao = x.nr_prescricao;
	/*Recommendations*/

	c04 CURSOR FOR
		SELECT distinct SUBSTR(obter_desc_recomendacao(p.cd_item),1,250) item,
             p.dt_alteracao evtDate,
             obter_valor_dominio(1620, p.ie_alteracao) action,
             substr(p.DS_JUSTIFICATIVA,1,2000) justification,
             substr(p.ds_observacao,1,2000) instructions
		from prescr_mat_alteracao p
		where p.nr_sequencia = nr_sequencia_p;
	/*Interventions*/

	c004 CURSOR FOR
	SELECT distinct substr(obter_desc_intervencoes(c.nr_seq_proc),1,250) item,
		p.dt_alteracao evtDate,
		obter_valor_dominio(1620, p.ie_alteracao) action,
		substr(p.DS_JUSTIFICATIVA,1,2000) justification,
		substr(p.ds_observacao,1,2000) instructions
	from prescr_mat_alteracao p,
		pe_prescr_proc_hor c
	where p.nr_sequencia = nr_sequencia_p
		and p.nr_prescricao = c.nr_seq_pe_prescr;
	/*Blood management - Start and restart*/

	c051 CURSOR FOR
	SELECT distinct CASE WHEN coalesce(b.nr_seq_exame_sangue::text, '') = '' THEN z.ds_derivado  ELSE substr(Obter_desc_san_exame(b.nr_seq_exame_sangue),1,80) END  || ' ' || substr(obter_interv_cuidados_hm(b.nr_prescricao, b.nr_sequencia, 'S'),1,100) item,
        p.dt_alteracao evtDate,
        (SELECT max(x.NR_ORDER_UNIT) from cpoe_order_unit x where x.nr_sequencia = (select max(l.nr_seq_cpoe_order_unit) from cpoe_hemoterapia l, prescr_solic_bco_sangue p where l.nr_sequencia = p.nr_seq_hemo_cpoe and p.nr_prescricao = a.nr_prescricao)) nr_order_unit,
        obter_valor_dominio(1662, p.ie_alteracao) action,
        obter_valor_dominio(1883, p.ie_forma_infusao) infmethod,
        p.qt_volume_fase|| ' ' || obter_desc_expressao(703346) bagvol,
		(CASE WHEN (p.qt_dosagem IS NOT NULL AND p.qt_dosagem::text <> '') THEN p.qt_dosagem||' '||obter_valor_dominio(93,p.ie_tipo_dosagem) ELSE null END) infRate,
        substr(p.ds_observacao,1,2000) instructions,
        (select max(nr_sangue) from san_producao x where x.nr_sequencia = (select y.nr_seq_producao from san_reserva_prod y where y.nr_sequencia = p.nr_seq_prod_reserva))prod_id_num
	FROM prescr_solucao_evento p, prescr_proc_hor c, prescr_medica a, prescr_procedimento b
LEFT OUTER JOIN san_derivado z ON (b.nr_seq_derivado = z.nr_sequencia)
WHERE p.nr_sequencia = nr_sequencia_p and c.nr_prescricao = b.nr_prescricao and c.nr_seq_procedimento = b.nr_sequencia and b.nr_prescricao = a.nr_prescricao and c.nr_prescricao = a.nr_prescricao and c.nr_prescricao = p.nr_prescricao and b.nr_sequencia = c.nr_seq_procedimento and c.nr_seq_procedimento = p.nr_seq_procedimento;
	/*Blood management - Stop*/

	c052 CURSOR FOR
	SELECT distinct CASE WHEN coalesce(b.nr_seq_exame_sangue::text, '') = '' THEN z.ds_derivado  ELSE substr(Obter_desc_san_exame(b.nr_seq_exame_sangue),1,80) END  || ' ' || substr(obter_interv_cuidados_hm(b.nr_prescricao, b.nr_sequencia, 'S'),1,100) item,
        p.dt_alteracao evtDate,
        (SELECT max(x.NR_ORDER_UNIT) from cpoe_order_unit x where x.nr_sequencia = (select max(l.nr_seq_cpoe_order_unit) from cpoe_hemoterapia l, prescr_solic_bco_sangue p where l.nr_sequencia = p.nr_seq_hemo_cpoe and p.nr_prescricao = a.nr_prescricao)) nr_order_unit,
        obter_valor_dominio(1662, p.ie_alteracao) action,
        substr(ad.ds_motivo,1,2000) rsn,
        p.qt_volume_fase|| ' ' || obter_desc_expressao(703346) bagvol,
        p.qt_vol_infundido infvol,
        p.qt_vol_desprezado disvol,
        substr(p.ds_observacao,1,2000) instructions,
        (select max(nr_sangue) from san_producao x where x.nr_sequencia = (select y.nr_seq_producao from san_reserva_prod y where y.nr_sequencia = p.nr_seq_prod_reserva))prod_id_num
	FROM prescr_solucao_evento p, prescr_proc_hor c, adep_motivo_interrupcao ad, prescr_medica a, prescr_procedimento b
LEFT OUTER JOIN san_derivado z ON (b.nr_seq_derivado = z.nr_sequencia)
WHERE p.nr_sequencia = nr_sequencia_p and c.nr_prescricao = b.nr_prescricao and c.nr_seq_procedimento = b.nr_sequencia and b.nr_prescricao = a.nr_prescricao and c.nr_prescricao = a.nr_prescricao and c.nr_prescricao = p.nr_prescricao and b.nr_sequencia = c.nr_seq_procedimento and c.nr_seq_procedimento = p.nr_seq_procedimento and (coalesce(p.nr_seq_motivo::text, '') = '' or p.nr_seq_motivo = ad.nr_sequencia);
	/*Blood management - Finish*/

	c053 CURSOR FOR
	SELECT distinct CASE WHEN coalesce(b.nr_seq_exame_sangue::text, '') = '' THEN z.ds_derivado  ELSE substr(Obter_desc_san_exame(b.nr_seq_exame_sangue),1,80) END  || ' ' || substr(obter_interv_cuidados_hm(b.nr_prescricao, b.nr_sequencia, 'S'),1,100) item,
        p.dt_alteracao evtDate,
        (SELECT max(m.NR_ORDER_UNIT) from cpoe_order_unit m where m.nr_sequencia =(select max(l.nr_seq_cpoe_order_unit) from cpoe_hemoterapia l, prescr_solic_bco_sangue p where l.nr_sequencia = p.nr_seq_hemo_cpoe and p.nr_prescricao = a.nr_prescricao)) nr_order_unit,
        obter_valor_dominio(1662, p.ie_alteracao) action,
        p.qt_volume_fase|| ' ' || obter_desc_expressao(703346) bagvol,
        p.qt_vol_infundido infvol,
        p.qt_vol_desprezado disvol,
        substr(p.ds_observacao,1,2000) instructions,
        (select max(nr_sangue) from san_producao x where x.nr_sequencia = (select y.nr_seq_producao from san_reserva_prod y where y.nr_sequencia = p.nr_seq_prod_reserva))prod_id_num
	FROM prescr_solucao_evento p, prescr_proc_hor c, prescr_medica a, prescr_procedimento b
LEFT OUTER JOIN san_derivado z ON (b.nr_seq_derivado = z.nr_sequencia)
WHERE p.nr_sequencia = nr_sequencia_p and c.nr_prescricao = b.nr_prescricao and c.nr_seq_procedimento = b.nr_sequencia and b.nr_prescricao = a.nr_prescricao and c.nr_prescricao = a.nr_prescricao and c.nr_prescricao = p.nr_prescricao and b.nr_sequencia = c.nr_seq_procedimento and c.nr_seq_procedimento = p.nr_seq_procedimento;
	/*Blood management tab - Start/Resume infusion*/

	c0511 CURSOR FOR
	SELECT distinct (SELECT ds_derivado from san_producao_v a where a.nr_sequencia = (select b.nr_seq_producao
		from san_reserva_prod b where b.nr_sequencia = p.nr_seq_prod_reserva)) item,
        p.dt_alteracao evtDate,
        obter_valor_dominio(1662, p.ie_alteracao) action,
        obter_valor_dominio(1883, p.ie_forma_infusao) infmethod,
        p.qt_volume_fase|| ' ' || obter_desc_expressao(703346) bagvol,
        p.qt_dosagem|| ' ' || p.ie_tipo_dosagem infRate,
        substr(p.ds_observacao,1,2000) instructions,
        (select max(nr_sangue) from san_producao x where x.nr_sequencia = (select y.nr_seq_producao from san_reserva_prod y where y.nr_sequencia = p.nr_seq_prod_reserva)) prod_id_num,
		(select max(m.NR_ORDER_UNIT) from cpoe_order_unit m where m.nr_sequencia = (select max(l.nr_seq_cpoe_order_unit) from cpoe_hemoterapia l, prescr_solic_bco_sangue z where l.nr_sequencia = z.nr_seq_hemo_cpoe and z.nr_prescricao = p.nr_prescricao)) nr_order_unit
	from prescr_solucao_evento p
	where p.nr_sequencia = nr_sequencia_p;
	/*Blood management tab - Stop infusion*/

	c0512 CURSOR FOR
	SELECT distinct (SELECT ds_derivado from san_producao_v a where a.nr_sequencia = (select b.nr_seq_producao
		from san_reserva_prod b where b.nr_sequencia = p.nr_seq_prod_reserva)) item,
        p.dt_alteracao evtDate,
        obter_valor_dominio(1662, p.ie_alteracao) action,
        substr(ad.ds_motivo,1,2000) rsn,
        p.qt_volume_fase|| ' ' || obter_desc_expressao(703346) bagvol,
        p.qt_vol_infundido infvol,
        p.qt_vol_desprezado disvol,
        substr(p.ds_observacao,1,2000) instructions,
        (select max(nr_sangue) from san_producao x where x.nr_sequencia = (select y.nr_seq_producao from san_reserva_prod y where y.nr_sequencia = p.nr_seq_prod_reserva)) prod_id_num,
		(select max(m.NR_ORDER_UNIT) from cpoe_order_unit m where m.nr_sequencia = (select max(l.nr_seq_cpoe_order_unit) from cpoe_hemoterapia l, prescr_solic_bco_sangue z where l.nr_sequencia = z.nr_seq_hemo_cpoe and z.nr_prescricao = p.nr_prescricao)) nr_order_unit
	from prescr_solucao_evento p, adep_motivo_interrupcao ad
	where p.nr_sequencia = nr_sequencia_p
	and (coalesce(p.nr_seq_motivo::text, '') = '' or p.nr_seq_motivo = ad.nr_sequencia);
    /*Blood Management -> transfusion-> Reaction tab - on submit*/

     c05111 CURSOR FOR
     SELECT
        *
        FROM
            (
                SELECT (
                        SELECT
                            MAX(c.nr_order_unit)
                        FROM
                            prescr_solic_bco_sangue   aa,
                            cpoe_hemoterapia          b,
                            cpoe_order_unit           c,
                            san_transfusao            d
                        WHERE
                            aa.nr_seq_hemo_cpoe = b.nr_sequencia
                            AND b.nr_seq_cpoe_order_unit = c.nr_sequencia
                            AND aa.nr_prescricao = d.nr_prescricao
                            AND d.nr_sequencia = nr_sequencia_p
                    ) ORDER_UNIT,
                    a.ds_derivado   ITEM,
                    a.nr_sangue     SERIAL,
                    (
                        SELECT
                            MAX(ds_grupo_reacao)
                        FROM
                            san_grupo_reacao
                        WHERE
                            nr_sequencia = nr_seq_grupo_reacao
                    ) REACTION_GROUP,
                    substr(obter_descricao_padrao('SAN_TIPO_REACAO', 'DS_TIPO_REACAO', nr_seq_reacao), 1, 255) REACTION,
                    dt_reacao       DT_REACTION,
                    ds_sintoma      SYMPTOMS,
                    ds_conduta      ACTION_TAKEN,
                    obter_nome_pessoa_fisica(str.cd_pf_realizou, NULL) PERFORMED_BY
                FROM
                    san_producao_v     a, san_transfusao     tr, san_trans_reacao   str
                WHERE
                    tr.nr_sequencia = a.nr_seq_transfusao
                    AND a.nr_sequencia = str.nr_seq_producao
                    AND (str.dt_lib_medico IS NOT NULL AND str.dt_lib_medico::text <> '')
                    AND tr.nr_sequencia = nr_sequencia_p
                ORDER BY
                    str.dt_lib_medico DESC
            ) alias8 LIMIT 1;
	/*Blood management tab - Finish*/

	c0513 CURSOR FOR
	SELECT distinct (SELECT ds_derivado from san_producao_v a where a.nr_sequencia = (select b.nr_seq_producao
		from san_reserva_prod b where b.nr_sequencia = p.nr_seq_prod_reserva)) item,
        p.dt_alteracao evtDate,
        obter_valor_dominio(1662, p.ie_alteracao) action,
        p.qt_volume_fase|| ' ' || obter_desc_expressao(703346) bagvol,
        p.qt_vol_infundido infvol,
        p.qt_vol_desprezado disvol,
        substr(p.ds_observacao,1,2000) instructions,
        (select max(nr_sangue) from san_producao x where x.nr_sequencia = (select y.nr_seq_producao from san_reserva_prod y where y.nr_sequencia = p.nr_seq_prod_reserva)) prod_id_num,
		(select l.nr_seq_cpoe_order_unit from cpoe_hemoterapia l, prescr_solic_bco_sangue z where l.nr_sequencia = z.nr_seq_hemo_cpoe and z.nr_prescricao = p.nr_prescricao) nr_order_unit
	from prescr_solucao_evento p
	where p.nr_sequencia = nr_sequencia_p;
	/*Dialysis*/

	c06 CURSOR FOR
	SELECT distinct substr(coalesce(obter_desc_prot_npt(x.nr_seq_protocolo),obter_prim_comp_sol(a.nr_prescricao,x.nr_seq_solucao)),1,240) item,
		e.dt_evento evtDate,
		obter_valor_dominio(2184, e.ie_evento) action
	from hd_prescricao_evento e,
		prescr_solucao x,
		prescr_medica a
	where e.nr_sequencia = nr_sequencia_p
		and x.nr_prescricao = a.nr_prescricao
		and  e.nr_prescricao = a.nr_prescricao;
	/*Materials*/

	c08 CURSOR FOR
		SELECT distinct substr(VIPE_obter_se_medic_composto(a.nr_prescricao, x.nr_sequencia, x.nr_agrupamento, 'D')
             || CASE WHEN coalesce(x.ie_lado, '')='N' THEN  '' WHEN coalesce(x.ie_lado, '')='' THEN  ''  ELSE ' (' || obter_desc_expressao(292416) || ': ' || obter_valor_dominio(1372,x.ie_lado) || ')' END ,1,240) item,
             p.dt_alteracao evtDate,
             obter_valor_dominio(1620, p.ie_alteracao) action,
             substr(p.DS_JUSTIFICATIVA,1,2000) justification,
             substr(p.ds_observacao,1,2000) instructions
		from prescr_mat_alteracao p,
			prescr_material x,
			prescr_mat_hor c,
			prescr_medica a
		where p.nr_Sequencia = nr_sequencia_p
			and	x.nr_prescricao = c.nr_prescricao
			and	x.nr_sequencia = c.nr_seq_material
			and	x.nr_prescricao = a.nr_prescricao
			and	c.nr_prescricao = a.nr_prescricao
			and c.nr_prescricao = p.nr_prescricao
			and p.nr_seq_horario = c.nr_sequencia;


BEGIN
    ds_content_w := '';
    ie_alteracao_sol_w := '';
	ds_blood_mgmt := '';
	ds_procedures := '';
	ds_execution_label_w := '(' || obter_desc_expressao(928121) ||')';
  if ( ie_record_type_p ='CPOE_ITEMS' and ((ie_record_sub_type_p = 1 and ie_option_p = 'SOL') or ie_record_sub_type_p = 5)) then
	ds_blood_mgmt := obter_desc_expressao(291262) || ds_execution_label_w;
    select max(ie_alteracao)
    into STRICT ie_alteracao_sol_w
    from prescr_solucao_evento
    where nr_sequencia = nr_sequencia_p;

	if (ie_record_sub_type_p = 1 and ie_option_p = 'SOL')then
	select distinct coalesce(max(ie_drip_shot),'D')
    into STRICT ie_drip_shot_w
    from cpoe_material c,prescr_solucao_evento p
    where p.nr_sequencia =nr_sequencia_p
    and p.nr_seq_cpoe=c.nr_sequencia;
    end if;
  end if;
	if ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 0 and ie_option_p = 'D') then
		for r_c00 in c00
		loop
			for r_clinical_note_fields in cl_notes
			loop
			begin
				if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c00.item IS NOT NULL AND r_c00.item::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(287913) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.item;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.item;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c00.evtDate IS NOT NULL AND r_c00.evtDate::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(287913) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.evtDate;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.evtDate;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c00.action IS NOT NULL AND r_c00.action::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(287913) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.action;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.action;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'AMT' and (r_c00.amt IS NOT NULL AND r_c00.amt::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(287913) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.amt;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.amt;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'VOL' and (r_c00.vol IS NOT NULL AND r_c00.vol::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(287913) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.vol;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.vol;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'SATIS' and (r_c00.satis IS NOT NULL AND r_c00.satis::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(287913) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.satis;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.satis;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'JUSTIF' and (r_c00.justif IS NOT NULL AND r_c00.justif::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(287913) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.justif;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c00.justif;
					end if;
				end;
				end if;
			end;
	end loop;
	end loop;
	elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 0 and ie_option_p = 'S') then
		for r_c001 in c001
		loop
			for r_clinical_note_fields in cl_notes
			loop
			begin
				if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c001.item IS NOT NULL AND r_c001.item::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(298960) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.item;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.item;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c001.evtDate IS NOT NULL AND r_c001.evtDate::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(298960) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.evtDate;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.evtDate;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c001.action IS NOT NULL AND r_c001.action::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(298960) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.action;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.action;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'AMT' and (r_c001.amt IS NOT NULL AND r_c001.amt::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(298960) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.amt;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.amt;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'VOL' and (r_c001.vol IS NOT NULL AND r_c001.vol::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(298960) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.vol;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.vol;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'SATIS' and (r_c001.satis IS NOT NULL AND r_c001.satis::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(298960) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.satis;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.satis;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'JUSTIF' and (r_c001.justif IS NOT NULL AND r_c001.justif::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(298960) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.justif;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c001.justif;
					end if;
				end;
				end if;
			end;
	end loop;
	end loop;
	elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 0 and ie_option_p in ('NPA-AN')) then
		for r_c002 in c002
			loop
				for r_clinical_note_fields in cl_notes
				loop
				begin
					if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c002.item IS NOT NULL AND r_c002.item::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(305331) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.item;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.item;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c002.evtDate IS NOT NULL AND r_c002.evtDate::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(305331) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.evtDate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.evtDate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c002.action IS NOT NULL AND r_c002.action::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(305331) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.action;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.action;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF_METHOD' and (r_c002.infmethod IS NOT NULL AND r_c002.infmethod::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(305331) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.infmethod;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.infmethod;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'BAG_VOL' and (r_c002.bagVol IS NOT NULL AND r_c002.bagVol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(305331) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.bagVol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.bagVol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF_RATE' and (r_c002.infRate IS NOT NULL AND r_c002.infRate::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(305331) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.infRate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.infRate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF_VOL' and (r_c002.infvol IS NOT NULL AND r_c002.infvol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(305331) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.infvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.infvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'DIS_VOL' and (r_c002.disvol IS NOT NULL AND r_c002.disvol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(305331) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.disvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.disvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c002.instructions IS NOT NULL AND r_c002.instructions::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(305331) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.instructions;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c002.instructions;
						end if;
					end;
					end if;
				end;
		end loop;
	  end loop;
	elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 1 and ie_option_p = 'M') then
		for r_c01 in c01
		loop
			for r_clinical_note_fields in cl_notes
			loop
			begin
				if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c01.medicine IS NOT NULL AND r_c01.medicine::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(293070) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.medicine;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.medicine;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c01.evtDate IS NOT NULL AND r_c01.evtDate::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(293070) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.evtDate;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.evtDate;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c01.action IS NOT NULL AND r_c01.action::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(293070) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.action;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.action;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'ROUTE' and (r_c01.route IS NOT NULL AND r_c01.route::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(292952) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.route;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.route;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'JUSTIF' and (r_c01.justification IS NOT NULL AND r_c01.justification::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(293070) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.justification;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.justification;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c01.instructions IS NOT NULL AND r_c01.instructions::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(293070) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.instructions;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.instructions;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'SCHEDULE_DT' and (r_c01.schDate IS NOT NULL AND r_c01.schDate::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(293070) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.schDate;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.schDate;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'ORDER_UNIT' and (r_c01.nr_order_unit IS NOT NULL AND r_c01.nr_order_unit::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(293070) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.nr_order_unit;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.nr_order_unit;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'RP' and (r_c01.nr_sequencia_rp IS NOT NULL AND r_c01.nr_sequencia_rp::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(293070) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.nr_sequencia_rp;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.nr_sequencia_rp;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'DOSE' and (r_c01.doseAdm IS NOT NULL AND r_c01.doseAdm::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(293070) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.doseAdm;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c01.doseAdm;
					end if;
				end;
				end if;
			end;
	end loop;
  end loop;
  elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 1 and ie_option_p = 'SOL' and ie_alteracao_sol_w in (1, 3)) then
		for r_c011 in c011
			loop
				for r_clinical_note_fields in cl_notes
				loop
				begin
					if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c011.soln IS NOT NULL AND r_c011.soln::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.soln;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.soln;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c011.evtDate IS NOT NULL AND r_c011.evtDate::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.evtDate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.evtDate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c011.action IS NOT NULL AND r_c011.action::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.action;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.action;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF_METHOD' and ie_alteracao_sol_w <> 3 and (r_c011.infmethod IS NOT NULL AND r_c011.infmethod::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.infmethod;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.infmethod;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ROUTE' and (r_c011.route IS NOT NULL AND r_c011.route::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.route;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.route;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'BAG_VOL' and (r_c011.bagVol IS NOT NULL AND r_c011.bagVol::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.bagVol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.bagVol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF' and (r_c011.infRate IS NOT NULL AND r_c011.infRate::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.infRate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.infRate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ROUTE_ADM' and (r_c011.rsn IS NOT NULL AND r_c011.rsn::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.rsn;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.rsn;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'ORDER_UNIT' and (r_c011.nr_order_unit IS NOT NULL AND r_c011.nr_order_unit::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.nr_order_unit;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.nr_order_unit;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'RP' and (r_c011.nr_sequencia_rp IS NOT NULL AND r_c011.nr_sequencia_rp::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.nr_sequencia_rp;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.nr_sequencia_rp;
						end if;
					end;
					end if;
                     if (r_clinical_note_fields.ie_field = 'SCHEDULE_DT' and (r_c011.sched_time IS NOT NULL AND r_c011.sched_time::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.sched_time;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.sched_time;
						end if;
					end;
					end if;
                     if (r_clinical_note_fields.ie_field = 'CD_UNID_M_NAIS' and (r_c011.nais_p IS NOT NULL AND r_c011.nais_p::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.nais_p;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.nais_p;
						end if;
					end;
					end if;
                     if (r_clinical_note_fields.ie_field = 'CD_DISPOSITIVO' and (r_c011.devic_p IS NOT NULL AND r_c011.devic_p::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.devic_p;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.devic_p;
						end if;
					end;
					end if;
                     if (r_clinical_note_fields.ie_field = 'IE_STERILE_PREP' and (r_c011.ie_sterile_prep_p IS NOT NULL AND r_c011.ie_sterile_prep_p::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.ie_sterile_prep_p;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.ie_sterile_prep_p;
						end if;
					end;
					end if;
                     if (r_clinical_note_fields.ie_field = 'QT_DOSE_ORIG' and (r_c011.qt_original IS NOT NULL AND r_c011.qt_original::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.qt_original;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.qt_original;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'QT_DOSE_TERAP' and (r_c011.qt_dose_terap_p IS NOT NULL AND r_c011.qt_dose_terap_p::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.qt_dose_terap_p;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.qt_dose_terap_p;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'DS_ORDERER_P' and (r_c011.ds_orderer_p IS NOT NULL AND r_c011.ds_orderer_p::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.ds_orderer_p;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.ds_orderer_p;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c011.instructions IS NOT NULL AND r_c011.instructions::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.instructions;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c011.instructions;
						end if;
					end;
					end if;
				end;
		end loop;
	  end loop;
	elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 1 and ie_option_p = 'SOL' and ie_alteracao_sol_w = 2) then
		for r_c012 in c012
			loop
				for r_clinical_note_fields in cl_notes
				loop
				begin
					if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c012.soln IS NOT NULL AND r_c012.soln::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.soln;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.soln;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c012.evtDate IS NOT NULL AND r_c012.evtDate::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.evtDate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.evtDate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c012.action IS NOT NULL AND r_c012.action::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.action;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.action;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ROUTE' and (r_c012.route IS NOT NULL AND r_c012.route::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.route;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.route;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'BAG_VOL' and (r_c012.bagVol IS NOT NULL AND r_c012.bagVol::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.bagVol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.bagVol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF_VOL' and (r_c012.infvol IS NOT NULL AND r_c012.infvol::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.infvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.infvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'DIS_VOL' and (r_c012.disvol IS NOT NULL AND r_c012.disvol::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.disvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.disvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ORDER_UNIT' and (r_c012.nr_order_unit IS NOT NULL AND r_c012.nr_order_unit::text <> '') ) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.nr_order_unit;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.nr_order_unit;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'RP' and (r_c012.nr_sequencia_rp IS NOT NULL AND r_c012.nr_sequencia_rp::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.nr_sequencia_rp;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.nr_sequencia_rp;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ROUTE_ADM' and (r_c012.rsn IS NOT NULL AND r_c012.rsn::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.rsn;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.rsn;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'SCHEDULE_DT' and (r_c012.sched_time IS NOT NULL AND r_c012.sched_time::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.sched_time;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.sched_time;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'PART_VOL_P' and (r_c012.part_volume_p IS NOT NULL AND r_c012.part_volume_p::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.part_volume_p;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.part_volume_p;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'PAUSE_TIME_P' and (r_c012.pause_time_p IS NOT NULL AND r_c012.pause_time_p::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.pause_time_p;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.pause_time_p;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c012.instructions IS NOT NULL AND r_c012.instructions::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.instructions;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c012.instructions;
						end if;
					end;
					end if;
				end;
		end loop;
	  end loop;
	elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 1 and ie_option_p = 'SOL' and ie_alteracao_sol_w = 4) then
		for r_c013 in c013
			loop
				for r_clinical_note_fields in cl_notes
				loop
				begin
					if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c013.soln IS NOT NULL AND r_c013.soln::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.soln;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.soln;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c013.evtDate IS NOT NULL AND r_c013.evtDate::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.evtDate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.evtDate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c013.action IS NOT NULL AND r_c013.action::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.action;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.action;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ROUTE' and (r_c013.route IS NOT NULL AND r_c013.route::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.route;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.route;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'BAG_VOL' and (r_c013.bagVol IS NOT NULL AND r_c013.bagVol::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.bagVol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.bagVol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF_VOL' and (r_c013.infvol IS NOT NULL AND r_c013.infvol::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.infvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.infvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'DIS_VOL' and (r_c013.disvol IS NOT NULL AND r_c013.disvol::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.disvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.disvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ORDER_UNIT' and (r_c013.nr_order_unit IS NOT NULL AND r_c013.nr_order_unit::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.nr_order_unit;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.nr_order_unit;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'RP' and (r_c013.nr_sequencia_rp IS NOT NULL AND r_c013.nr_sequencia_rp::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.nr_sequencia_rp;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.nr_sequencia_rp;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'PART_VOL_P' and (r_c013.part_volume_p IS NOT NULL AND r_c013.part_volume_p::text <> '') and ie_drip_shot_w='D') then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.part_volume_p;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.part_volume_p;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'SCHEDULE_DT' and (r_c013.sched_time IS NOT NULL AND r_c013.sched_time::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.sched_time;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.sched_time;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c013.instructions IS NOT NULL AND r_c013.instructions::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || obter_desc_expressao(304733) || ds_execution_label_w || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.instructions;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c013.instructions;
						end if;
					end;
					end if;
				end;
		end loop;
	  end loop;
  elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p in (2, 9)) then
	if (ie_record_sub_type_p = 2) then
		ds_procedures := obter_desc_expressao(614206);
	else
		ds_procedures := obter_desc_expressao(314898);
	end if;
	for r_c02 in c02
		loop
			for r_clinical_note_fields in cl_notes
			loop
			begin
				if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c02.item IS NOT NULL AND r_c02.item::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || ds_procedures || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c02.item;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c02.item;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c02.evtDate IS NOT NULL AND r_c02.evtDate::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || ds_procedures || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c02.evtDate;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c02.evtDate;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c02.action IS NOT NULL AND r_c02.action::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || ds_procedures || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c02.action;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c02.action;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'JUSTIF' and (r_c02.justification IS NOT NULL AND r_c02.justification::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || ds_procedures || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c02.justification;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c02.justification;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c02.instructions IS NOT NULL AND r_c02.instructions::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || ds_procedures || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c02.instructions;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c02.instructions;
					end if;
				end;
				end if;
			end;
	end loop;
  end loop;
  elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 3) then
	for r_c03 in c03
		loop
			for r_clinical_note_fields in cl_notes
			loop
			begin
				if (r_clinical_note_fields.ie_field = 'DS_ITEM' and (r_c03.item IS NOT NULL AND r_c03.item::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(290567) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.item;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.item;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'DT_EVENT' and (r_c03.evtDate IS NOT NULL AND r_c03.evtDate::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(290567) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.evtDate;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.evtDate;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'IE_STATUS' and (r_c03.action IS NOT NULL AND r_c03.action::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(290567) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.action;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.action;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'QT_AMOUNT' and (r_c03.qty IS NOT NULL AND r_c03.qty::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(290567) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.qty;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.qty;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'CD_UOM' and (r_c03.uom IS NOT NULL AND r_c03.uom::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(290567) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.uom;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.uom;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'CD_DEVICE' and (r_c03.device IS NOT NULL AND r_c03.device::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(290567) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.device;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.device;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'DS_JUSTIF' and (r_c03.justif IS NOT NULL AND r_c03.justif::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(290567) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.justif;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c03.justif;
					end if;
				end;
				end if;
			end;
	end loop;
  end loop;
  elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 4 and ie_option_p = 'R') then
	for r_c04 in c04
		loop
			for r_clinical_note_fields in cl_notes
			loop
			begin
				if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c04.item IS NOT NULL AND r_c04.item::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(297348) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c04.item;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c04.item;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c04.evtDate IS NOT NULL AND r_c04.evtDate::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(297348) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c04.evtDate;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c04.evtDate;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c04.action IS NOT NULL AND r_c04.action::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(297348) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c04.action;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c04.action;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'JUSTIF' and (r_c04.justification IS NOT NULL AND r_c04.justification::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(297348) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c04.justification;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c04.justification;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c04.instructions IS NOT NULL AND r_c04.instructions::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(297348) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c04.instructions;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c04.instructions;
					end if;
				end;
				end if;
			end;
	end loop;
  end loop;
  elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 4 and ie_option_p = 'E') then
	for r_c004 in c004
		loop
			for r_clinical_note_fields in cl_notes
			loop
			begin
				if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c004.item IS NOT NULL AND r_c004.item::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(292225) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c004.item;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c004.item;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c004.evtDate IS NOT NULL AND r_c004.evtDate::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(292225) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c004.evtDate;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c004.evtDate;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c004.action IS NOT NULL AND r_c004.action::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(292225) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c004.action;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c004.action;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'JUSTIF' and (r_c004.justification IS NOT NULL AND r_c004.justification::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(292225) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c004.justification;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c004.justification;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c004.instructions IS NOT NULL AND r_c004.instructions::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(292225) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c004.instructions;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c004.instructions;
					end if;
				end;
				end if;
			end;
	end loop;
  end loop;
    elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 5 and ie_alteracao_sol_w in (1, 3) and ie_option_p = 'BM') then
		for r_c0511 in c0511
			loop
				for r_clinical_note_fields in cl_notes
				loop
				begin
					if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c0511.item IS NOT NULL AND r_c0511.item::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.item;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.item;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c0511.evtDate IS NOT NULL AND r_c0511.evtDate::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.evtDate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.evtDate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c0511.action IS NOT NULL AND r_c0511.action::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.action;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.action;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF_METHOD' and ie_alteracao_sol_w <> 3 and (r_c0511.infmethod IS NOT NULL AND r_c0511.infmethod::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.infmethod;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.infmethod;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'BAG_VOL' and (r_c0511.bagVol IS NOT NULL AND r_c0511.bagVol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.bagVol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.bagVol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF' and (r_c0511.infRate IS NOT NULL AND r_c0511.infRate::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.infRate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.infRate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c0511.instructions IS NOT NULL AND r_c0511.instructions::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.instructions;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.instructions;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'BLOOD_ID_NUM' and (r_c0511.prod_id_num IS NOT NULL AND r_c0511.prod_id_num::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.prod_id_num;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.prod_id_num;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'ORDER_UNIT' and (r_c0511.nr_order_unit IS NOT NULL AND r_c0511.nr_order_unit::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.nr_order_unit;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0511.nr_order_unit;
						end if;
					end;
					end if;
				end;
		end loop;
	  end loop;
    elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 5 and ie_option_p = 're') then
        ds_blood_mgmt :=  obter_desc_expressao(1073347);
        for r_c05111 in c05111
			loop
            CALL grava_log_tasy(7689,ds_blood_mgmt||'--','test');
				for r_clinical_note_fields in cl_notes
				loop
				begin
                if (r_clinical_note_fields.ie_field = 'ORDER_UNIT' and (r_c05111.ORDER_UNIT IS NOT NULL AND r_c05111.ORDER_UNIT::text <> '')) then
                    begin
                        if ( coalesce(ds_content_w::text, '') = '' ) then
                          ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
                          ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.ORDER_UNIT;
                        else
                          ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.ORDER_UNIT;
                        end if;
                    end;
                end if;
                if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c05111.ITEM IS NOT NULL AND r_c05111.ITEM::text <> '')) then
                    begin
                        if ( coalesce(ds_content_w::text, '') = '' ) then
                          ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
                          ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.ITEM;
                        else
                          ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.ITEM;
                        end if;
                    end;
                end if;
                if (r_clinical_note_fields.ie_field = 'SERIAL' and (r_c05111.SERIAL IS NOT NULL AND r_c05111.SERIAL::text <> '')) then
                    begin
                        if ( coalesce(ds_content_w::text, '') = '' ) then
                          ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
                          ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.SERIAL;
                        else
                          ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.SERIAL;
                        end if;
                    end;
                end if;
                if (r_clinical_note_fields.ie_field = 'REACTION_GROUP' and (r_c05111.REACTION_GROUP IS NOT NULL AND r_c05111.REACTION_GROUP::text <> '')) then
                    begin
                        if ( coalesce(ds_content_w::text, '') = '' ) then
                          ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
                          ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.REACTION_GROUP;
                        else
                          ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.REACTION_GROUP;
                        end if;
                    end;
                end if;
                if (r_clinical_note_fields.ie_field = 'REACTION' and (r_c05111.REACTION IS NOT NULL AND r_c05111.REACTION::text <> '')) then
                    begin
                        if ( coalesce(ds_content_w::text, '') = '' ) then
                          ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
                          ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.REACTION;
                        else
                          ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.REACTION;
                        end if;
                    end;
                end if;
                if (r_clinical_note_fields.ie_field = 'DT_REACTION' and (r_c05111.DT_REACTION IS NOT NULL AND r_c05111.DT_REACTION::text <> '')) then
                    begin
                        if ( coalesce(ds_content_w::text, '') = '' ) then
                          ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
                          ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.DT_REACTION;
                        else
                          ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.DT_REACTION;
                        end if;
                    end;
                end if;
                if (r_clinical_note_fields.ie_field = 'SYMPTOMS' and (r_c05111.SYMPTOMS IS NOT NULL AND r_c05111.SYMPTOMS::text <> '')) then
                    begin
                        if ( coalesce(ds_content_w::text, '') = '' ) then
                          ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
                          ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.SYMPTOMS;
                        else
                          ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.SYMPTOMS;
                        end if;
                    end;
                end if;
                if (r_clinical_note_fields.ie_field = 'ACTION_TAKEN' and (r_c05111.ACTION_TAKEN IS NOT NULL AND r_c05111.ACTION_TAKEN::text <> '')) then
                    begin
                        if ( coalesce(ds_content_w::text, '') = '' ) then
                          ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
                          ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.ACTION_TAKEN;
                        else
                          ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.ACTION_TAKEN;
                        end if;
                    end;
                end if;
                if (r_clinical_note_fields.ie_field = 'PERFORMED_BY' and (r_c05111.PERFORMED_BY IS NOT NULL AND r_c05111.PERFORMED_BY::text <> '')) then
                    begin
                        if ( coalesce(ds_content_w::text, '') = '' ) then
                          ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
                          ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.PERFORMED_BY;
                        else
                          ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c05111.PERFORMED_BY;
                        end if;
                    end;
                end if;
                end;

  end loop;
END LOOP;
	elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 5 and ie_alteracao_sol_w = 2 and ie_option_p = 'BM') then
		for r_c0512 in c0512
			loop
				for r_clinical_note_fields in cl_notes
				loop
				begin
					if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c0512.item IS NOT NULL AND r_c0512.item::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.item;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.item;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c0512.evtDate IS NOT NULL AND r_c0512.evtDate::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.evtDate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.evtDate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c0512.action IS NOT NULL AND r_c0512.action::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.action;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.action;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'BAG_VOL' and (r_c0512.bagVol IS NOT NULL AND r_c0512.bagVol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.bagVol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.bagVol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF_VOL' and (r_c0512.infvol IS NOT NULL AND r_c0512.infvol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.infvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.infvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'DIS_VOL' and (r_c0512.disvol IS NOT NULL AND r_c0512.disvol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.disvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.disvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ROUTE_ADM' and (r_c0512.rsn IS NOT NULL AND r_c0512.rsn::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.rsn;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.rsn;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c0512.instructions IS NOT NULL AND r_c0512.instructions::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.instructions;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.instructions;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'BLOOD_ID_NUM' and (r_c0512.prod_id_num IS NOT NULL AND r_c0512.prod_id_num::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.prod_id_num;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.prod_id_num;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'ORDER_UNIT' and (r_c0512.nr_order_unit IS NOT NULL AND r_c0512.nr_order_unit::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.nr_order_unit;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0512.nr_order_unit;
						end if;
					end;
					end if;
				end;
		end loop;
	  end loop;
	elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 5 and ie_alteracao_sol_w = 4 and ie_option_p = 'BM') then
		for r_c0513 in c0513
			loop
				for r_clinical_note_fields in cl_notes
				loop
				begin
					if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c0513.item IS NOT NULL AND r_c0513.item::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.item;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.item;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c0513.evtDate IS NOT NULL AND r_c0513.evtDate::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.evtDate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.evtDate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c0513.action IS NOT NULL AND r_c0513.action::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.action;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.action;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'BAG_VOL' and (r_c0513.bagVol IS NOT NULL AND r_c0513.bagVol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.bagVol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.bagVol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF_VOL' and (r_c0513.infvol IS NOT NULL AND r_c0513.infvol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.infvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.infvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'DIS_VOL' and (r_c0513.disvol IS NOT NULL AND r_c0513.disvol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.disvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.disvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c0513.instructions IS NOT NULL AND r_c0513.instructions::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt|| '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.instructions;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.instructions;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'BLOOD_ID_NUM' and (r_c0513.prod_id_num IS NOT NULL AND r_c0513.prod_id_num::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.prod_id_num;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.prod_id_num;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'ORDER_UNIT' and (r_c0513.nr_order_unit IS NOT NULL AND r_c0513.nr_order_unit::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.nr_order_unit;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c0513.nr_order_unit;
						end if;
					end;
					end if;
				end;
		end loop;
	  end loop;
  elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 5 and ie_alteracao_sol_w in (1, 3)) then
		for r_c051 in c051
			loop
				for r_clinical_note_fields in cl_notes
				loop
				begin
					if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c051.item IS NOT NULL AND r_c051.item::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.item;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.item;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c051.evtDate IS NOT NULL AND r_c051.evtDate::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.evtDate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.evtDate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c051.action IS NOT NULL AND r_c051.action::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.action;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.action;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF_METHOD' and ie_alteracao_sol_w <> 3 and (r_c051.infmethod IS NOT NULL AND r_c051.infmethod::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.infmethod;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.infmethod;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'BAG_VOL' and (r_c051.bagVol IS NOT NULL AND r_c051.bagVol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.bagVol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.bagVol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF' and (r_c051.infRate IS NOT NULL AND r_c051.infRate::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.infRate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.infRate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c051.instructions IS NOT NULL AND r_c051.instructions::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.instructions;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.instructions;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'BLOOD_ID_NUM' and (r_c051.prod_id_num IS NOT NULL AND r_c051.prod_id_num::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.prod_id_num;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.prod_id_num;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'ORDER_UNIT' and (r_c051.nr_order_unit IS NOT NULL AND r_c051.nr_order_unit::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.nr_order_unit;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c051.nr_order_unit;
						end if;
					end;
					end if;
				end;
		end loop;
	  end loop;
	elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 5 and ie_alteracao_sol_w = 2) then
		for r_c052 in c052
			loop
				for r_clinical_note_fields in cl_notes
				loop
				begin
					if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c052.item IS NOT NULL AND r_c052.item::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.item;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.item;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c052.evtDate IS NOT NULL AND r_c052.evtDate::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.evtDate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.evtDate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c052.action IS NOT NULL AND r_c052.action::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.action;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.action;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'BAG_VOL' and (r_c052.bagVol IS NOT NULL AND r_c052.bagVol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.bagVol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.bagVol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF_VOL' and (r_c052.infvol IS NOT NULL AND r_c052.infvol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.infvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.infvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'DIS_VOL' and (r_c052.disvol IS NOT NULL AND r_c052.disvol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.disvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.disvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ROUTE_ADM' and (r_c052.rsn IS NOT NULL AND r_c052.rsn::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.rsn;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.rsn;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c052.instructions IS NOT NULL AND r_c052.instructions::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.instructions;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.instructions;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'BLOOD_ID_NUM' and (r_c052.prod_id_num IS NOT NULL AND r_c052.prod_id_num::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.prod_id_num;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.prod_id_num;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'ORDER_UNIT' and (r_c052.nr_order_unit IS NOT NULL AND r_c052.nr_order_unit::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.nr_order_unit;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c052.nr_order_unit;
						end if;
					end;
					end if;
				end;
		end loop;
	  end loop;
	elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 5 and ie_alteracao_sol_w = 4) then
		for r_c053 in c053
			loop
				for r_clinical_note_fields in cl_notes
				loop
				begin
					if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c053.item IS NOT NULL AND r_c053.item::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.item;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.item;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c053.evtDate IS NOT NULL AND r_c053.evtDate::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.evtDate;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.evtDate;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c053.action IS NOT NULL AND r_c053.action::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.action;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.action;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'BAG_VOL' and (r_c053.bagVol IS NOT NULL AND r_c053.bagVol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.bagVol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.bagVol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'INF_VOL' and (r_c053.infvol IS NOT NULL AND r_c053.infvol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.infvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.infvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'DIS_VOL' and (r_c053.disvol IS NOT NULL AND r_c053.disvol::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.disvol;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.disvol;
						end if;
					end;
					end if;
					if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c053.instructions IS NOT NULL AND r_c053.instructions::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt|| '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.instructions;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.instructions;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'BLOOD_ID_NUM' and (r_c053.prod_id_num IS NOT NULL AND r_c053.prod_id_num::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.prod_id_num;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.prod_id_num;
						end if;
					end;
					end if;
                    if (r_clinical_note_fields.ie_field = 'ORDER_UNIT' and (r_c053.nr_order_unit IS NOT NULL AND r_c053.nr_order_unit::text <> '')) then
					begin
						if ( coalesce(ds_content_w::text, '') = '' ) then
						  ds_content_w    := '<b>' || ds_blood_mgmt || '</b>';
						  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.nr_order_unit;
						else
						  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c053.nr_order_unit;
						end if;
					end;
					end if;
				end;
		end loop;
	  end loop;
  elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 6) then
	for r_c06 in c06
		loop
			for r_clinical_note_fields in cl_notes
			loop
			begin
				if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c06.item IS NOT NULL AND r_c06.item::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(287725) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c06.item;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c06.item;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c06.evtDate IS NOT NULL AND r_c06.evtDate::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(287725) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c06.evtDate;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c06.evtDate;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c06.action IS NOT NULL AND r_c06.action::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(287725) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c06.action;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c06.action;
					end if;
				end;
				end if;
			end;
	end loop;
  end loop;
  elsif ( ie_record_type_p ='CPOE_ITEMS' and ie_record_sub_type_p = 8) then
	for r_c08 in c08
		loop
			for r_clinical_note_fields in cl_notes
			loop
			begin
				if (r_clinical_note_fields.ie_field = 'ITEM' and (r_c08.item IS NOT NULL AND r_c08.item::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(292952) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c08.item;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c08.item;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'EVT_DATE' and (r_c08.evtDate IS NOT NULL AND r_c08.evtDate::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(292952) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c08.evtDate;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c08.evtDate;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'ACTION' and (r_c08.action IS NOT NULL AND r_c08.action::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(292952) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c08.action;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c08.action;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'JUSTIF' and (r_c08.justification IS NOT NULL AND r_c08.justification::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(292952) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c08.justification;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c08.justification;
					end if;
				end;
				end if;
				if (r_clinical_note_fields.ie_field = 'COMMENT' and (r_c08.instructions IS NOT NULL AND r_c08.instructions::text <> '')) then
				begin
					if ( coalesce(ds_content_w::text, '') = '' ) then
					  ds_content_w    := '<b>' || obter_desc_expressao(292952) || ds_execution_label_w || '</b>';
					  ds_content_w    := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c08.instructions;
					else
					  ds_content_w := ds_content_w|| '</br>' || coalesce(r_clinical_note_fields.nm_field,r_clinical_note_fields.ds_expressao) || ' - '|| r_c08.instructions;
					end if;
				end;
				end if;
			end;
	end loop;
  end loop;
  end if;
    return ds_content_w;
  END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION clinical_notes_pck.get_soap_content_emar ( nr_atendimento_p bigint, nr_sequencia_p bigint, ie_record_type_p text, ie_record_sub_type_p text, ie_soap_type_p text, ie_stage_p bigint, ie_option_p text) FROM PUBLIC;
