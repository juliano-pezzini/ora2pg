-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION clinical_notes_pck.get_soap_inpat_tp (nr_atendimento_p bigint, nr_sequencia_p bigint, ie_record_type_p text, ie_soap_type_p text, ie_stage_p bigint) RETURNS varchar AS $body$
DECLARE

    ds_content_w varchar(32000);
    ds_department_w varchar(255);
    ds_ward_w       varchar(255);
    ds_room_w       varchar(255);
    ds_hosp_date_w       varchar(255);
    ds_est_admn_prd_w varchar(255);
    ds_indication_w  varchar(4000);
    ds_purps_adm_w varchar(4000);
    ds_inf_test_sch_w  varchar(4000);
    ds_inf_surg_sch_w  varchar(4000);
    ds_inf_nurse_w     varchar(4000);
    ds_inf_paramed_w      varchar(4000);
    ds_notes_w      varchar(4000);
    ds_phy_inchg_w varchar(255);
    ds_phy_asstnt_w  varchar(4000);
    ds_nurse_prim_w varchar(255);
    ds_nurse_asstnt_w varchar(4000);
    ds_other_staff_w varchar(4000);
    ds_inf_home_rec_w varchar(4000);
    ds_diagnosis_w varchar(4000);
    ds_spe_nutr_cont_w varchar(255);
    ds_add_char_menu_w varchar(255);
    ds_lifestyle_coun_w varchar(255);
    ds_hosp_med_pro_w varchar(4000);
    ds_home_recover_crg_w varchar(255);
    cd_exp_header_w dic_expressao.cd_expressao%type;
	ds_actions_discharge_w varchar(255);
    c01 CURSOR FOR
    SELECT *
    from table(clinical_notes_pck.get_clinical_note_rule(nr_atendimento_p,ie_record_type_p,null,ie_soap_type_p,ie_stage_p));

BEGIN
    select CASE WHEN a.si_type_form=1 THEN 1031672 WHEN a.si_type_form=2 THEN 1031693 WHEN a.si_type_form=3 THEN 1031695 WHEN a.si_type_form=4 THEN 1031697  ELSE 1031672 END 
	into STRICT cd_exp_header_w
	from med_treatment_plan a
	where nr_sequencia=nr_sequencia_p;
    select  substr(obter_nome_departamento_medico(a.cd_department, 'N'), 1, 255),
	substr(obter_nome_setor(a.cd_ward), 1, 255),
    (select max(cd_unidade_basica)from   unidade_atendimento c,setor_atendimento d where  c.cd_setor_atendimento = d.cd_setor_atendimento and c.cd_setor_atendimento = a.cd_ward and cd_unidade_basica = a.cd_room),
	 pkg_date_formaters.to_varchar(a.dt_hospitalization, 'short', wheb_usuario_pck.get_cd_estabelecimento, wheb_usuario_pck.get_nm_usuario),
     a.ds_estimated_adm_period,
	 a.ds_indication,
	 a.ds_purpose_admission,
	 a.ds_inf_test_schedule,
	 a.ds_inf_surgical_schedule,
	 a.ds_inf_nurse,
     a.ds_inf_paramedical,
     a.ds_notes,
	 (select obter_nome_medico(b.cd_physician, 'N') from med_treatment_plan_team b where nr_seq_med_treat_plan = a.nr_sequencia  and si_person_type = 1),
	 (obter_select_concatenado_bv('select obter_nome_medico(c.cd_physician, ' || '''N''' || ') from MED_TREATMENT_PLAN_TEAM c where c.NR_SEQ_MED_TREAT_PLAN = :NR_SEQ_MED_TREAT_PLAN_P  and c.SI_PERSON_TYPE = 2','NR_SEQ_MED_TREAT_PLAN_P=' || a.nr_sequencia || ';' , ',')),
	 (select obter_nome_pf(d.cd_person) from med_treatment_plan_team d where nr_seq_med_treat_plan = a.nr_sequencia  and si_person_type = 3),
	 (obter_select_concatenado_bv('select substr(obter_nome_pf(d.cd_person),1,255) from MED_TREATMENT_PLAN_TEAM d where d.NR_SEQ_MED_TREAT_PLAN = :NR_SEQ_MED_TREAT_PLAN_P  and d.SI_PERSON_TYPE = 4','NR_SEQ_MED_TREAT_PLAN_P=' || a.nr_sequencia || ';' , ',')),
	 (obter_select_concatenado_bv('select substr(obter_nome_pf(e.cd_person),1,255) from MED_TREATMENT_PLAN_TEAM e where e.NR_SEQ_MED_TREAT_PLAN = :NR_SEQ_MED_TREAT_PLAN_P  and e.SI_PERSON_TYPE = 5','NR_SEQ_MED_TREAT_PLAN_P=' || a.nr_sequencia || ';' , ',')),
	 a.ds_inf_home_recovery_sup,
     (obter_select_concatenado_bv('select obter_desc_cid(e.cd_doenca) from MED_TREATMENT_PLAN_DISEASE e where e.NR_SEQ_MED_TREAT_PLAN = :NR_SEQ_MED_TREAT_PLAN_P ','NR_SEQ_MED_TREAT_PLAN_P=' || a.nr_sequencia || ';' , ',')),
     substr(OBTER_DESC_CAMPO_GRID(336169,CASE WHEN a.SI_SPECIAL_NUTRITION_CONTROL=0 THEN 0  ELSE 1 END ),1,255) ,
     substr(OBTER_DESC_CAMPO_GRID(1032442,CASE WHEN a.SI_ADDITIONAL_CHARGES_MENU=0 THEN 0  ELSE 1 END ),1,255) ,
     (obter_select_concatenado_bv('select substr(obter_nome_pf(d.cd_person),1,255) from MED_TREATMENT_PLAN_TEAM d where d.NR_SEQ_MED_TREAT_PLAN = :NR_SEQ_MED_TREAT_PLAN_P  and d.SI_PERSON_TYPE = 6','NR_SEQ_MED_TREAT_PLAN_P=' || a.nr_sequencia || ';' , ',')),
     (obter_select_concatenado_bv('select substr(obter_nome_pf(d.cd_person),1,255) from MED_TREATMENT_PLAN_TEAM d where d.NR_SEQ_MED_TREAT_PLAN = :NR_SEQ_MED_TREAT_PLAN_P  and d.SI_PERSON_TYPE = 7','NR_SEQ_MED_TREAT_PLAN_P=' || a.nr_sequencia || ';' , ',')),
     a.ds_hosp_medical_protect,
	 a.ds_actions_discharge
     into STRICT
	 ds_department_w,
	 ds_ward_w,
	 ds_room_w,
	 ds_hosp_date_w ,
     ds_est_admn_prd_w,
     ds_indication_w,
     ds_purps_adm_w,
	 ds_inf_test_sch_w,
	 ds_inf_surg_sch_w,
	 ds_inf_nurse_w,
	 ds_inf_paramed_w,
	 ds_notes_w,
	 ds_phy_inchg_w,
	 ds_phy_asstnt_w,
	 ds_nurse_prim_w,
	 ds_nurse_asstnt_w,
	 ds_other_staff_w,
     ds_inf_home_rec_w,
     ds_diagnosis_w,
     ds_spe_nutr_cont_w,
     ds_add_char_menu_w,
     ds_lifestyle_coun_w,
     ds_home_recover_crg_w,
	 ds_hosp_med_pro_w,
     ds_actions_discharge_w
	 from    med_treatment_plan a
	 where     nr_atendimento = nr_atendimento_p   and nr_sequencia=nr_sequencia_p;

     for r_c01 in c01 loop
     if (ie_record_type_p = 'IP_MED_TP') then
        if (r_c01.ie_field    = 'MED_DEPT' and (ds_department_w IS NOT NULL AND ds_department_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w    := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_department_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_department_w;
          end if;
        end if;
        if (r_c01.ie_field    = 'CD_WARD' and (ds_ward_w IS NOT NULL AND ds_ward_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w    := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_ward_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_ward_w;
          end if;
        end if;
        if (r_c01.ie_field    = 'CD_ROOM' and (ds_room_w IS NOT NULL AND ds_room_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w    := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_room_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_room_w;
          end if;
        end if;
        if (r_c01.ie_field    = 'DT_HOSP' and (ds_hosp_date_w IS NOT NULL AND ds_hosp_date_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w    := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_hosp_date_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_hosp_date_w;
          end if;
        end if;
        if (r_c01.ie_field    = 'DS_EST_ADMN_PRD' and (ds_est_admn_prd_w IS NOT NULL AND ds_est_admn_prd_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w    := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_est_admn_prd_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_est_admn_prd_w;
          end if;
        end if;
        if (r_c01.ie_field   = 'DS_INDICATION' and (ds_indication_w IS NOT NULL AND ds_indication_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_indication_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_indication_w;
          end if;
        end if;
        if (r_c01.ie_field   = 'DS_PURPS_ADM' and (ds_purps_adm_w IS NOT NULL AND ds_purps_adm_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_purps_adm_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_purps_adm_w;
          end if;
        end if;
		if (r_c01.ie_field   = 'DS_INF_TEST_SCH' and (ds_inf_test_sch_w IS NOT NULL AND ds_inf_test_sch_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_inf_test_sch_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_inf_test_sch_w;
          end if;
        end if;
		if (r_c01.ie_field   = 'DS_INF_SURG_SCH' and (ds_inf_surg_sch_w IS NOT NULL AND ds_inf_surg_sch_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_inf_surg_sch_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_inf_surg_sch_w;
          end if;
        end if;
		if (r_c01.ie_field   = 'DS_INF_NURSE' and (ds_inf_nurse_w IS NOT NULL AND ds_inf_nurse_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_inf_nurse_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_inf_nurse_w;
          end if;
        end if;
		if (r_c01.ie_field   = 'DS_INF_PARAMED' and (ds_inf_paramed_w IS NOT NULL AND ds_inf_paramed_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_inf_paramed_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_inf_paramed_w;
          end if;
        end if;
        if (r_c01.ie_field   = 'DS_NOTES' and (ds_notes_w IS NOT NULL AND ds_notes_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_notes_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_notes_w;
          end if;
        end if;
        if (r_c01.ie_field   = 'DS_SPE_NUTR_CON' and (ds_spe_nutr_cont_w IS NOT NULL AND ds_spe_nutr_cont_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_spe_nutr_cont_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_spe_nutr_cont_w;
          end if;
        end if;
        if (r_c01.ie_field   = 'DS_ADD_CHR_MENU' and (ds_add_char_menu_w IS NOT NULL AND ds_add_char_menu_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_add_char_menu_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_add_char_menu_w;
          end if;
        end if;
        if (r_c01.ie_field   = 'PHYSICIAN_INCHG' and (ds_phy_inchg_w IS NOT NULL AND ds_phy_inchg_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_phy_inchg_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_phy_inchg_w;
          end if;
          end if;
        if (r_c01.ie_field   = 'PHYSICIAN_ASSTN' and (ds_phy_asstnt_w IS NOT NULL AND ds_phy_asstnt_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_phy_asstnt_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_phy_asstnt_w;
          end if;
          end if;
        if (r_c01.ie_field   = 'PRIM_NURSE' and (ds_nurse_prim_w IS NOT NULL AND ds_nurse_prim_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_nurse_prim_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_nurse_prim_w;
          end if;
          end if;
        if (r_c01.ie_field   = 'NURSE_ASSISTNT' and (ds_nurse_asstnt_w IS NOT NULL AND ds_nurse_asstnt_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_nurse_asstnt_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_nurse_asstnt_w;
          end if;
          end if;
        if (r_c01.ie_field   = 'OTH_STAFF' and (ds_other_staff_w IS NOT NULL AND ds_other_staff_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_other_staff_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_other_staff_w;
          end if;
        end if;
        if (r_c01.ie_field   = 'DS_INF_HOME_REC' and (ds_inf_home_rec_w IS NOT NULL AND ds_inf_home_rec_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_inf_home_rec_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_inf_home_rec_w;
          end if;
        end if;
        if (r_c01.ie_field   = 'DS_DIAGNOSIS' and (ds_diagnosis_w IS NOT NULL AND ds_diagnosis_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_diagnosis_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_diagnosis_w;
          end if;
        end if;
        if (r_c01.ie_field   = 'DS_HOSP_MED_PRO' and (ds_hosp_med_pro_w IS NOT NULL AND ds_hosp_med_pro_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_hosp_med_pro_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_hosp_med_pro_w;
          end if;
        end if;
        if (r_c01.ie_field   = 'DS_LIFE_COUN' and (ds_lifestyle_coun_w IS NOT NULL AND ds_lifestyle_coun_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_lifestyle_coun_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_lifestyle_coun_w;
          end if;
        end if;
        if (r_c01.ie_field   = 'DS_HM_REC_CHA' and (ds_home_recover_crg_w IS NOT NULL AND ds_home_recover_crg_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_home_recover_crg_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_home_recover_crg_w;
          end if;
        end if;
		if (r_c01.ie_field   = 'DS_DSCHG_ACTION' and (ds_actions_discharge_w IS NOT NULL AND ds_actions_discharge_w::text <> ''))then
          if (coalesce(ds_content_w::text, '') = '' ) then
            ds_content_w   := '<b>' || obter_desc_expressao(cd_exp_header_w) || '</b>';
            ds_content_w   := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_actions_discharge_w;
          else
            ds_content_w := ds_content_w|| '</br>' || coalesce(r_c01.nm_field,r_c01.ds_expressao) || ' - '|| ds_actions_discharge_w;
          end if;
        end if;
      end if;
    end loop;
    return ds_content_w;
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION clinical_notes_pck.get_soap_inpat_tp (nr_atendimento_p bigint, nr_sequencia_p bigint, ie_record_type_p text, ie_soap_type_p text, ie_stage_p bigint) FROM PUBLIC;
