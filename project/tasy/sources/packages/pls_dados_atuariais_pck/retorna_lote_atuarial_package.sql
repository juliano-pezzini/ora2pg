-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pls_dados_atuariais_pck.retorna_lote_atuarial (nr_seq_lote_p pls_atuarial_lote.nr_sequencia%type) RETURNS LOTE_ATUARIAL AS $body$
DECLARE

/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Finalidade:	Carrega os dados do lote atuarial, e retorna as informacoes em um type proprio

-------------------------------------------------------------------------------------------------------------------

Locais de chamada direta: 
[X]  Objetos do dicionario [ ] Tasy (Delphi/Java) [  ] Portal [  ]  Relatorios [ ] Outros:
-------------------------------------------------------------------------------------------------------------------

Pontos de atencao:

	
Alteracoes:
-------------------------------------------------------------------------------------------------------------------

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */


ds_retorno_w	lote_atuarial;

BEGIN

select	max(pls_obter_dados_outorgante(a.cd_estabelecimento, 'ANS')),
	max(a.cd_estabelecimento),
	max(a.ds_log),
	max(a.dt_fim_arquivo),
	max(fim_dia(coalesce(a.dt_fim_comp, clock_timestamp()))),
	max(a.dt_fim_geracao),
	max(a.dt_inicio_arquivo),
	max(trunc(a.dt_inicio_comp,'dd')),
	max(a.dt_inicio_geracao),
	max(a.ie_status),
	max(a.ie_tipo_arquivo),
	max(a.nr_seq_benef_regra),
	max(a.nr_seq_conta_regra),
	max(a.nr_seq_estip_regra),
	max(a.nr_seq_mens_regra),
	max(a.nr_seq_plano_regra),
	max(a.nr_seq_prest_regra),
	max(a.nr_seq_proced_regra),
	max(a.nr_sequencia)
into STRICT	ds_retorno_w.cd_ans,
	ds_retorno_w.cd_estabelecimento,
	ds_retorno_w.ds_log,
	ds_retorno_w.dt_fim_arquivo,
	ds_retorno_w.dt_fim_comp,
	ds_retorno_w.dt_fim_geracao,
	ds_retorno_w.dt_inicio_arquivo,
	ds_retorno_w.dt_inicio_comp,
	ds_retorno_w.dt_inicio_geracao,
	ds_retorno_w.ie_status,
	ds_retorno_w.ie_tipo_arquivo,
	ds_retorno_w.nr_seq_benef_regra,
	ds_retorno_w.nr_seq_conta_regra,
	ds_retorno_w.nr_seq_estip_regra,
	ds_retorno_w.nr_seq_mens_regra,
	ds_retorno_w.nr_seq_plano_regra,
	ds_retorno_w.nr_seq_prest_regra,
	ds_retorno_w.nr_seq_proced_regra,
	ds_retorno_w.nr_sequencia
from	pls_atuarial_lote	a
where	a.nr_sequencia	= nr_seq_lote_p;

return ds_retorno_w;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pls_dados_atuariais_pck.retorna_lote_atuarial (nr_seq_lote_p pls_atuarial_lote.nr_sequencia%type) FROM PUBLIC;
