-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pls_dados_atuariais_pck.retorna_tipo_col_regra ( ie_campo_p pls_atuarial_arq_campo.ie_campo%type, ie_tipo_arquivo_p pls_atuarial_arq_regra.ie_tipo_arquivo%type) RETURNS varchar AS $body$
DECLARE

/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Finalidade:	Retorna o tipo da coluna no metadata. conforme a tabela.

	Se for uma function, entao sera considerado automaticamente como VARCHAR2
		
-------------------------------------------------------------------------------------------------------------------

Locais de chamada direta: 
[X]  Objetos do dicionario [ ] Tasy (Delphi/Java) [  ] Portal [  ]  Relatorios [ ] Outros:
-------------------------------------------------------------------------------------------------------------------

Pontos de atencao:

	
	
Alteracoes:
-------------------------------------------------------------------------------------------------------------------

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */


ds_retorno_w	varchar(100) := '';
ds_tabela_w	varchar(100) := '';

BEGIN

if (ie_campo_p IS NOT NULL AND ie_campo_p::text <> '') then

	-- Levanta a tabela

	ds_tabela_w := 	case 	ie_tipo_arquivo_p
				when 1 then 'PLS_ATU_BENEF_ITEM' -- Beneficiario

				when 2 then 'PLS_ATU_CONTA_ITEM' -- Conta medica

				when 3 then 'PLS_ATU_ESTIP_ITEM' -- Estipulante

				when 4 then 'PLS_ATU_MENS_ITEM' -- Mensalidade

				when 5 then 'PLS_ATU_PREST_ITEM' -- Prestador

				when 6 then 'PLS_ATU_PLANO_ITEM' -- Produto

				when 7 then 'PLS_ATU_PROCED_ITEM' -- Procedimento

			end;
			
	select	max(a.data_type)
	into STRICT	ds_retorno_w
	from	user_tab_cols		a
	where	a.table_name		= ds_tabela_w
	and	a.column_name		= ie_campo_p;
	
else
	
	ds_retorno_w := 'VARCHAR2';
end if;


return ds_retorno_w;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pls_dados_atuariais_pck.retorna_tipo_col_regra ( ie_campo_p pls_atuarial_arq_campo.ie_campo%type, ie_tipo_arquivo_p pls_atuarial_arq_regra.ie_tipo_arquivo%type) FROM PUBLIC;
