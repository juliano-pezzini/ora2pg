-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_dados_atuariais_pck.criar_job_gerar_lote ( nr_seq_lote_p pls_atuarial_lote.nr_sequencia%type, nm_usuario_p usuario.nm_usuario%type) AS $body$
DECLARE

/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Finalidade:	Rotina que vai criar a JOB para gerar os dados do lote

	Essa rotina so deve gerar a JOB, nenhuma outra regra de negocio
	deve ser incluida aqui

-------------------------------------------------------------------------------------------------------------------

Locais de chamada direta: 
[X]  Objetos do dicionario [ ] Tasy (Delphi/Java) [  ] Portal [  ]  Relatorios [ ] Outros:
-------------------------------------------------------------------------------------------------------------------

Pontos de atencao:

	
Alteracoes:
-------------------------------------------------------------------------------------------------------------------

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */


jobno			bigint;
ds_comando_job_w	varchar(2000);


BEGIN

ds_comando_job_w	:= 'pls_dados_atuariais_pck.gerar_dados_atuariais_lote(' ||	nr_seq_lote_p || ',' || -- nr_seq_lote_p
											pls_util_pck.aspas_w || nm_usuario_p || pls_util_pck.aspas_w || ');';

-- Vai iniciar a procedure em 2.5 segundos apos a conclusao desta e sempre joga a proxima execucao para daqui a 10000 dias

dbms_job.submit(jobno, ds_comando_job_w, clock_timestamp() + interval '216000 seconds' * (1/24/60/60));


END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_dados_atuariais_pck.criar_job_gerar_lote ( nr_seq_lote_p pls_atuarial_lote.nr_sequencia%type, nm_usuario_p usuario.nm_usuario%type) FROM PUBLIC;
