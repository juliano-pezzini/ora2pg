-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION dpc_pkg.get_condition_field_enabled (nr_seq_mdc_p bigint, nr_seq_classification_p bigint, nm_field_p text default null, cd_condition_p text default null, nr_seq_severity_p bigint default null) RETURNS varchar AS $body$
DECLARE




	nr_return_w         varchar(255);
	cd_mdc_w            varchar(255);
	cd_classification_w varchar(255);
	qt_w                bigint;
	
	
BEGIN
    nr_return_w := '999';

    select max(cd_mdc)
    into STRICT   cd_mdc_w
    from   dpc_mdc
    where  nr_sequencia = nr_seq_mdc_p;

    select max(cd_classification)
    into STRICT   cd_classification_w
    from   dpc_classification
    where  nr_sequencia = nr_seq_classification_p;

    if (cd_condition_p IS NOT NULL AND cd_condition_p::text <> '') then
	if (cd_mdc_w in ('01') and cd_classification_w in ('0010', '0020', '0030', '0040', '0050', '0061',
                                    '0069', '0070', '0083', '0086', '0089', '0090', '0100', '0110', '0111',
                                    '0120', '0130', '0140', '0155', '0160', '0170', '0180', '0190', '0200',
                                    '021x', '0220', '0230', '0240', '0260', '0270', '0280', '0290', '0300', '0310')) then
	    	nr_return_w := '8';
	else
		nr_return_w  := '999';
	end if;
		
    elsif (cd_mdc_w = '04' and cd_classification_w = '0080') then
	    nr_return_w := '1';

    elsif (cd_mdc_w in ('10','01') and cd_classification_w in ('0020','0040','0050','0061','0069',
                                       '0070','0080','0090','0100','0160','0260','0270')) then
        nr_return_w := '2';
		
	elsif (cd_mdc_w = '06' and cd_classification_w = '0350') then
	    nr_return_w := '3';
		
    elsif (cd_mdc_w = '16' and cd_classification_w = '1000') then
	    nr_return_w := '4';
	
    elsif (cd_mdc_w = '17' and cd_classification_w in ('0020','0030','0040','0050','0060')) then
	    nr_return_w := '5';

    elsif (cd_mdc_w = '14' and (cd_classification_w = '0010' or SUBSTR(cd_classification_w, 1,3) = '029')) then
	    nr_return_w := '6';
		
    elsif (cd_mdc_w = '01' and cd_classification_w = '0060') then
	    nr_return_w := '7';
	else
	    nr_return_w  := '999';
    end if;

return nr_return_w;
end;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION dpc_pkg.get_condition_field_enabled (nr_seq_mdc_p bigint, nr_seq_classification_p bigint, nm_field_p text default null, cd_condition_p text default null, nr_seq_severity_p bigint default null) FROM PUBLIC;
