-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION dpc_pkg.get_value_report4907 (nr_seq_dpc_quest_p bigint, ds_column_p text, is_date text) RETURNS varchar AS $body$
DECLARE


ds_return_w  varchar(255);

BEGIN

if (is_date = 'Y') then
    select  coalesce(max(to_char(a.dt_value, 'dd/mm/yyyy')), ' ')
        into STRICT    ds_return_w
        from    pat_dpc_quest_item a,
                pat_dpc_quest_form b
        where   b.nr_seq_dpc_quest = nr_seq_dpc_quest_p
        and     a.nr_seq_quest_form = b.nr_sequencia
        and     a.ds_column = ds_column_p;
elsif (is_date = 'N') then
  select  coalesce(max(a.ds_value), ' ')
        into STRICT    ds_return_w
        from    pat_dpc_quest_item a,
                pat_dpc_quest_form b
        where   b.nr_seq_dpc_quest = nr_seq_dpc_quest_p
        and     a.nr_seq_quest_form = b.nr_sequencia
        and     a.ds_column = ds_column_p;
end if;

return  ds_return_w;
end;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION dpc_pkg.get_value_report4907 (nr_seq_dpc_quest_p bigint, ds_column_p text, is_date text) FROM PUBLIC;
