-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE dpc_pkg.get_mandatory_fields (DS_FIELD_P text, DS_VALUE_P text,DS_MANDATORY_FIELDS_P INOUT text, SI_MANDATORY_P INOUT text, nr_seq_patient_dpc_p bigint) AS $body$
DECLARE


	CD_HUGH_CNT                bigint;
	CD_NYHA_CNT				   bigint;
	CD_NYHA_IS_HEART_CNT	   bigint;	
	CD_NYHA_CLASSIF_CNT        bigint;
	CD_CHILD_BIRTH_INFO_CNT    bigint;
	CD_STROKE_BEFORE_HOSP_CNT  bigint;
	CD_STROKE_DISCHARGE_CNT    bigint;
	CD_BRAIN_TEMOZ_CNT         bigint;
	VL_GAF_ADM_CNT             bigint;
	CD_PNEUMONIA_SEVERITY_CNT  bigint;
	CD_PANCREATITIS_SEVERITY_CNT bigint;
	VL_BURN_INDEX_CNT          bigint;
	QT_AGE                     smallint;
	DISCHARGE_DATE_W           timestamp;
	SI_MAIN_W varchar(1) := 'Y';
	SI_SECOND_MOST_EXPENSIVE_W varchar(1) := 'Y';
	CD_MDC_W patient_dpc_general_cond.nr_seq_mdc%type;
	CD_CLASSIFICATION_W patient_dpc_general_cond.nr_seq_classification%type;
	CD_DOENCA_SI_MAIN_W diagnostico_doenca.cd_doenca%type;
	CD_DOE_SI_SEC_MOST_EXP_W diagnostico_doenca.cd_doenca%type;
	CD_DOE_NR_SEQ_MOST_EXP_DIAG_W diagnostico_doenca.cd_doenca%type;
	type t_cid is table of varchar(10);
    t_cids t_cid := t_cid('I110', 'I130', 'I132', 'I270', 'I272', 'I279');

BEGIN

select a.dt_alta into STRICT DISCHARGE_DATE_W
from   atendimento_paciente a,
patient_dpc b
where  a.nr_atendimento = b.nr_atendimento
and    b.nr_sequencia = nr_seq_patient_dpc_p;
IF (DS_FIELD_P = 'SI_PREGNANT') THEN
       DS_MANDATORY_FIELDS_P := 'VL_PREGNANCY_WEEK';

    IF (DS_VALUE_P = '1') THEN  
        SI_MANDATORY_P := 'S';
    ELSE   
        SI_MANDATORY_P := 'N';
    END IF;

END IF;

IF (DS_FIELD_P = 'CD_HOSPITALIZATION_ROUTE') THEN
       DS_MANDATORY_FIELDS_P := 'SI_REFERAL;CD_SCHEDULE_EMERG;CD_MED_CARE_BEFORE;SI_AMBULANCE_TRANSP;CD_OTHER_CLINIC;CD_SELF_HARM';

    IF (DS_VALUE_P = '1' or DS_VALUE_P = '4' or DS_VALUE_P = '5') THEN
        SI_MANDATORY_P := 'S';
    ELSE
        SI_MANDATORY_P := 'N';
    END IF;

END IF;

IF (DS_FIELD_P = 'CD_HOSPITALIZATION_ROUTE' and DS_VALUE_P='0') THEN
       DS_MANDATORY_FIELDS_P := 'CD_SELF_HARM';

    IF (DS_VALUE_P = '0') THEN
        SI_MANDATORY_P := 'S';
    ELSE
        DS_MANDATORY_FIELDS_P := 'SI_REFERAL;CD_SCHEDULE_EMERG;CD_MED_CARE_BEFORE;SI_AMBULANCE_TRANSP;CD_OTHER_CLINIC;CD_SELF_HARM';
        SI_MANDATORY_P := 'N';
    END IF;

END IF;


IF (DS_FIELD_P = 'SI_MENTAL_WARD') THEN
       DS_MANDATORY_FIELDS_P := 'CD_SELF_HARM';

    IF (DS_VALUE_P ='1_0') THEN
        SI_MANDATORY_P := 'S';
    ELSIF (DS_VALUE_P ='1_1') THEN
        SI_MANDATORY_P := 'S';
    ELSIF (DS_VALUE_P ='1_4') THEN
        SI_MANDATORY_P := 'S';
    ELSIF (DS_VALUE_P ='1_5') THEN
        SI_MANDATORY_P := 'S';
    ELSE
        SI_MANDATORY_P := 'N';
    END IF;

END IF;

IF (DS_FIELD_P = 'CD_DISCHARGE_TYPE') THEN
       DS_MANDATORY_FIELDS_P := 'CD_MED_CARE_AFTER';

    IF (DS_VALUE_P ='1') THEN  
        SI_MANDATORY_P := 'S';
    ELSE   
        SI_MANDATORY_P := 'N';
    END IF;

END IF;

IF (DS_FIELD_P = 'CD_REHOSP_REASON_PLAN') THEN
       DS_MANDATORY_FIELDS_P := 'DS_TEXT_REHOSP_REASON';

    IF (DS_VALUE_P ='7') THEN  
        SI_MANDATORY_P := 'S';
    ELSE   
        SI_MANDATORY_P := 'N';
    END IF;

END IF;

IF (DS_FIELD_P = 'CD_REALOC_REASON_PLAN') THEN
       DS_MANDATORY_FIELDS_P := 'DS_TEXT_REALOC_REASON';

    IF (DS_VALUE_P ='7') THEN  
        SI_MANDATORY_P := 'S';
    ELSE   
        SI_MANDATORY_P := 'N';
    END IF;

END IF;

IF (DS_FIELD_P = 'CD_MOST_EXP_DISEASE') THEN
       DS_MANDATORY_FIELDS_P := 'CD_INJURY_MOST_CODE';

    IF (DS_VALUE_P in ('C340', 'C341', 'C342','C343' ,'C348', 'C349', 'C445', 'C493', 'C73', 'C783', 'C788', 'C792', 'C795','C798','C859','D139',
      'D180','D181','D213', 'D360', 'D361','D367', 'D376','D377', 'D481', 'D485', 'G618','J841') 
       or DS_VALUE_P LIKE 'I50%' or DS_VALUE_P LIKE 'S364%'
       or DS_VALUE_P LIKE 'S368%' or DS_VALUE_P LIKE 'S378%') THEN
        SI_MANDATORY_P := 'S';
    ELSE   
        SI_MANDATORY_P := 'N';
    END IF;

END IF;

IF (DS_FIELD_P = 'CD_INTRACTABLE_DISEASE_1') THEN
       DS_MANDATORY_FIELDS_P := 'SI_WITH_MED_EXP_SUB_2';

    IF (DS_VALUE_P IS NOT NULL AND DS_VALUE_P::text <> '') THEN  
        SI_MANDATORY_P := 'S';
    ELSE   
        SI_MANDATORY_P := 'N';
    END IF;

END IF;

IF (DISCHARGE_DATE_W IS NOT NULL AND DISCHARGE_DATE_W::text <> '') THEN
  IF (DS_FIELD_P = 'DT_DISCHARGE_FIM') THEN
        DS_MANDATORY_FIELDS_P := 'SI_FIM_CLEANING_EXIT;SI_FIM_CHANGING_LOW_EXIT;SI_FIM_SELF_TOILET_EXIT;SI_FIM_URINATION_EXIT;SI_FIM_DEFECATION_EXIT;' ||
        'SI_BED_WHEEL_EXIT;SI_FIM_TOILET_MOV_EXIT;SI_FIM_BATH_SHOWER_EXIT;SI_FIM_WALK_WHEEL_EXIT;SI_FIM_STAIRS_EXIT;SI_FIM_UNDERSTANDING_EXIT;' ||
        'SI_FIM_EXPRESSION_EXIT;SI_FIM_SOCIAL_EXIT;SI_FIM_PROBLEM_EXIT;SI_FIM_MEMORY_EXIT;SI_FIM_MEAL_EXIT;SI_FIM_GROOMING_EXIT;SI_CHANGING_UP_EXIT';
      IF (DS_VALUE_P IS NOT NULL AND DS_VALUE_P::text <> '') THEN
          SI_MANDATORY_P := 'S';
      ELSE   
          SI_MANDATORY_P := 'N';
      END IF;

  END IF;
END IF;

IF (DS_FIELD_P = 'DT_ADMISSION_FIM') THEN
  DS_MANDATORY_FIELDS_P := 'SI_FIM_MEAL;SI_FIM_GROOMING;SI_FIM_CLEANING;SI_FIM_CHANGING_UP;SI_FIM_CHANGING_LOW;SI_FIM_SELF_TOILET;SI_FIM_URINATION;' ||
  'SI_FIM_DEFECATION;SI_FIM_BED_WHEELCHAIR;SI_FIM_TOILET_MOV;SI_FIM_BATH_SHOWER;SI_FIM_WALK_WHEELCHAIR;SI_FIM_STAIRS;SI_FIM_UNDERSTANDING;' ||
  'SI_FIM_EXPRESSION;SI_FIM_SOCIAL;SI_FIM_PROBLEM_SOLVING;SI_FIM_MEMORY;SI_TIMES_FIM';

  IF (DS_VALUE_P IS NOT NULL AND DS_VALUE_P::text <> '') THEN
        SI_MANDATORY_P := 'S';
  ELSE   
        SI_MANDATORY_P := 'N';
  END IF;
END IF;
		
IF (DS_FIELD_P = 'CD_CHILD_BIRTH_INFO') THEN
       DS_MANDATORY_FIELDS_P := 'VL_BLEEDING_CHILDBIRTH';

    IF (DS_VALUE_P = '1' or DS_VALUE_P= '2') THEN  
        SI_MANDATORY_P := 'S';
    ELSE   
        SI_MANDATORY_P := 'N';
    END IF;

END IF;
IF (DS_FIELD_P = 'DT_SOFA_AFTER_ENTRY') THEN
       DS_MANDATORY_FIELDS_P := 'VL_SOFA_AFTER_ENTRY';

    IF (DS_VALUE_P <> '99999999') THEN  
        SI_MANDATORY_P := 'S';
    ELSE   
        SI_MANDATORY_P := 'N';
    END IF;

END IF;

IF (DS_FIELD_P = 'DT_SOFA_AFTER_ENTRY') THEN
       DS_MANDATORY_FIELDS_P := 'VL_SOFA_AFTER_ENTRY';

    IF (DS_VALUE_P <> '99999999') THEN  
        SI_MANDATORY_P := 'S';
    ELSE   
        SI_MANDATORY_P := 'N';
    END IF;

END IF;	

IF (DS_FIELD_P = 'DT_SOFA_TREAT_AFTER_MES') THEN
       DS_MANDATORY_FIELDS_P := 'VL_SOFA_TREAT_AFTER_MES';

    IF (DS_VALUE_P <> '99999999') THEN  
        SI_MANDATORY_P := 'S';
    ELSE   
        SI_MANDATORY_P := 'N';
    END IF;

END IF;		
IF (DS_FIELD_P = 'DT_SOFA2_AFTER_ENTRY') THEN
       DS_MANDATORY_FIELDS_P := 'VL_SOFA2_AFTER_ENTRY';

    IF (DS_VALUE_P <> '99999999') THEN  
        SI_MANDATORY_P := 'S';
    ELSE   
        SI_MANDATORY_P := 'N';
    END IF;

END IF;	

IF (DS_FIELD_P = 'DT_SOFA2_TREAT_AFTER_MES') THEN
       DS_MANDATORY_FIELDS_P := 'VL_SOFA2_TREAT_AFTER_MES';
    IF (DS_VALUE_P <> '99999999') THEN
        SI_MANDATORY_P := 'S';
    ELSE   
        SI_MANDATORY_P := 'N';
    END IF;

END IF;	

IF (DS_FIELD_P = 'SI_CANCER_RECURR') THEN
       DS_MANDATORY_FIELDS_P := 'CD_UICC_PRIMARY_TUMOR;CD_UICC_REGIONAL_NODE;CD_UICC_DISTANT_METASTASIS';
    IF (DS_VALUE_P= '0') THEN
        SI_MANDATORY_P := 'S';
    ELSE   
        SI_MANDATORY_P := 'N';
    END IF;

END IF;

IF (DS_FIELD_P = 'CD_MOST_EXP_DISEASE_Q') THEN
		Select   count(1) into STRICT CD_HUGH_CNT
		from    dpc_icd c
		where  c.cd_icd = DS_VALUE_P 
		and      c.cd_mdc = '04' 
		and      c.cd_classification <> '026x';
		
		Select   count(1) into STRICT CD_NYHA_CNT
		from     dpc_icd c
		where    c.cd_icd = DS_VALUE_P
		and      c.cd_mdc = '05' 
		and      c.cd_classification = '0030';
		
		Select   count(1) INTO STRICT CD_NYHA_IS_HEART_CNT
		from    dpc_icd c 
		where ( DS_VALUE_P LIKE 'I20%' or DS_VALUE_P LIKE 'I25%' )
		and      c.cd_mdc = '05' 
		and      c.cd_classification = '0050';

		Select   count(1) INTO STRICT CD_NYHA_CLASSIF_CNT
		from    dpc_icd c 
		where (DS_VALUE_P LIKE 'I11%' or  DS_VALUE_P LIKE 'I13%' or  DS_VALUE_P LIKE 'I270%' or  DS_VALUE_P LIKE 'I272%' or DS_VALUE_P LIKE 'I279%');
	
		Select   count(1) INTO STRICT CD_CHILD_BIRTH_INFO_CNT
		from    dpc_icd c
		where  ((trim(both trailing '$' from trim(both c.cd_icd)) = SUBSTR(DS_VALUE_P,1,3)) or (trim(both c.cd_icd) = DS_VALUE_P))
		and      c.cd_mdc = '12' 
		and      c.cd_classification in ('0130','0140','0160','0170','0180','0200','0210','0260','0270');
	   
		Select   count(1) INTO STRICT CD_STROKE_BEFORE_HOSP_CNT
		from     dpc_icd c 
		where (c.cd_icd = DS_VALUE_P or DS_VALUE_P LIKE 'I60%')
		and      c.cd_mdc = '01' 
		and      c.cd_classification in ('0020','0040','0070');
		
		Select   count(1) INTO STRICT CD_STROKE_DISCHARGE_CNT
		from     dpc_icd c
		where (c.cd_icd = DS_VALUE_P or DS_VALUE_P LIKE 'I60%')
		and      c.cd_mdc = '01' 
		and      c.cd_classification in ('0020','0040','0070');

		Select   count(1) INTO STRICT CD_BRAIN_TEMOZ_CNT
		from    dpc_icd c
		where  c.cd_icd = DS_VALUE_P 
		and      c.cd_mdc = '01' 
		and      c.cd_classification = '0010'; 	
		
		Select   count(1) INTO STRICT VL_GAF_ADM_CNT
		from    dpc_icd c
		where  c.cd_icd = DS_VALUE_P 
		and      ((c.cd_mdc = '01'  and      c.cd_classification = '021x') or (c.cd_mdc = '17')); 	

		Select   count(1) INTO STRICT CD_PNEUMONIA_SEVERITY_CNT
		from    dpc_icd c
		where  c.cd_icd = DS_VALUE_P
		and      c.cd_mdc = '04' 
		and      c.cd_classification in ('0040','0080');

		Select   count(1) INTO STRICT CD_PANCREATITIS_SEVERITY_CNT
		from    dpc_icd c
		where  c.cd_icd = DS_VALUE_P 
		and      c.cd_mdc = '06' 
		and      c.cd_classification in ('0350');
	    
		Select   count(1) INTO STRICT VL_BURN_INDEX_CNT
		from    dpc_icd c 
		where  c.cd_icd = DS_VALUE_P 
		and      c.cd_mdc = '16' 
		and      c.cd_classification in ('1000');
  
    SI_MANDATORY_P := 'N';
	
	IF (CD_HUGH_CNT>0) THEN  
		DS_MANDATORY_FIELDS_P := DS_MANDATORY_FIELDS_P || ';' || 'CD_HUGH_JONES_CLASSIF';
		SI_MANDATORY_P := 'S';
	END IF;
	
	IF (CD_NYHA_CNT>0) THEN
		DS_MANDATORY_FIELDS_P := DS_MANDATORY_FIELDS_P || ';' || 'CD_NYHA_MYOCARDIAL_INFARCATION';
		SI_MANDATORY_P := 'S';
	END IF;
	
	IF (CD_NYHA_IS_HEART_CNT>0) THEN
		DS_MANDATORY_FIELDS_P := DS_MANDATORY_FIELDS_P || ';' || 'CD_NYHA_IS_HEART_SEVERITY';
		SI_MANDATORY_P := 'S';
	END IF;
	
	IF (CD_NYHA_CLASSIF_CNT>0) THEN
	  DS_MANDATORY_FIELDS_P := DS_MANDATORY_FIELDS_P || ';' || 'CD_NYHA_CLASSIF';
 	  SI_MANDATORY_P := 'S';
	END IF;

	IF (CD_CHILD_BIRTH_INFO_CNT>0) THEN  
		DS_MANDATORY_FIELDS_P := DS_MANDATORY_FIELDS_P || ';' || 'CD_CHILD_BIRTH_INFO';
		SI_MANDATORY_P := 'S';
	END IF;
	
	IF (CD_STROKE_BEFORE_HOSP_CNT>0) THEN
		DS_MANDATORY_FIELDS_P := DS_MANDATORY_FIELDS_P || ';' || 'CD_STROKE_BEFORE_HOSP';
		SI_MANDATORY_P := 'S';
	END IF;
	
	IF (CD_STROKE_DISCHARGE_CNT>0) THEN
		DS_MANDATORY_FIELDS_P := DS_MANDATORY_FIELDS_P || ';' || 'CD_STROKE_DISCHARGE';
		SI_MANDATORY_P := 'S';
	END IF;

	IF (CD_BRAIN_TEMOZ_CNT>0) THEN  
		DS_MANDATORY_FIELDS_P := DS_MANDATORY_FIELDS_P || ';' || 'CD_BRAIN_TEMOZ';
		SI_MANDATORY_P := 'S';
	END IF;

	IF (VL_GAF_ADM_CNT>0) THEN
		DS_MANDATORY_FIELDS_P := DS_MANDATORY_FIELDS_P || ';' || 'VL_GAF_ADM;SI_HOSPITALIZATION_LAW';
		SI_MANDATORY_P := 'S';
	END IF;

   IF (CD_PNEUMONIA_SEVERITY_CNT>0) THEN  
	    DS_MANDATORY_FIELDS_P := DS_MANDATORY_FIELDS_P || ';' || 'CD_PNEUMONIA_SEVERITY';
  		SI_MANDATORY_P := 'S';
	END IF;

   IF (CD_PANCREATITIS_SEVERITY_CNT>0) THEN  
	    DS_MANDATORY_FIELDS_P := DS_MANDATORY_FIELDS_P || ';' || 'CD_PANCREATITIS_SEVERITY';
		SI_MANDATORY_P := 'S';
   END IF;

   IF (VL_BURN_INDEX_CNT>0) THEN  
    DS_MANDATORY_FIELDS_P := DS_MANDATORY_FIELDS_P || ';' || 'VL_BURN_INDEX';
	SI_MANDATORY_P := 'S';
   END IF;	

   IF (DS_VALUE_P in ('C340', 'C341', 'C342','C343' ,'C348', 'C349', 'C445', 'C493', 'C73', 'C783', 'C788', 'C792', 'C795','C798','C859','D139',
       'D180','D181','D213', 'D360', 'D361','D367', 'D376','D377', 'D481', 'D485', 'G618','J841') 
       or DS_VALUE_P LIKE 'I50%' or DS_VALUE_P LIKE 'S364%'
       or DS_VALUE_P LIKE 'S368%' or DS_VALUE_P LIKE 'S378%') THEN
     
     DS_MANDATORY_FIELDS_P := DS_MANDATORY_FIELDS_P || ';' || 'CD_INJURY_MOST_CODE';
     SI_MANDATORY_P := 'S';

   END IF;

END IF;	

	IF (DS_FIELD_P in ('NR_SEQ_MDC','NR_SEQ_CLASSIFICATION')) THEN
      select max(c.cd_mdc) CD_MDC, max(c.cd_classification) CD_CLASSIFICATION
      into STRICT CD_MDC_W, CD_CLASSIFICATION_W
      from patient_dpc_general_cond a,
        dpc_classification c
      where a.nr_seq_patient_dpc = nr_seq_patient_dpc_p
      and c.nr_sequencia = a.nr_seq_classification;

      DS_MANDATORY_FIELDS_P := 'CD_NYHA_CLASSIF';

    IF (CD_MDC_W = '05' AND CD_CLASSIFICATION_W = '0050') THEN
        SI_MANDATORY_P := 'S';
    ELSE
        SI_MANDATORY_P := 'N';
      END IF;
    END IF;

	IF (DS_FIELD_P in ('SI_MAIN','SI_SECOND_MOST_EXPENSIVE','NR_SEQ_MOST_EXP_DIAGNOSIS')) THEN
      select  max(b.cd_doenca) cd_doenca
      into STRICT CD_DOENCA_SI_MAIN_W
      from  patient_dpc_diagnosis a,
        diagnostico_doenca b
      where nr_seq_patient_dpc = nr_seq_patient_dpc_p
      and si_main = si_main_w
      and a.nr_seq_diagnosis = b.nr_seq_interno;

      select  max(b.cd_doenca) cd_doenca
      into STRICT CD_DOE_SI_SEC_MOST_EXP_W
      from  patient_dpc a,
        diagnostico_doenca b
      where a.nr_sequencia = nr_seq_patient_dpc_p
      and a.nr_seq_most_exp_diagnosis = b.nr_seq_interno;

      select  max(b.cd_doenca) cd_doenca
      into STRICT CD_DOE_NR_SEQ_MOST_EXP_DIAG_W
      from  patient_dpc_diagnosis a,
        diagnostico_doenca b
      where a.nr_seq_patient_dpc = nr_seq_patient_dpc_p
      and a.si_second_most_expensive = si_second_most_expensive_w
      and a.nr_seq_diagnosis = b.nr_seq_interno;

      DS_MANDATORY_FIELDS_P := 'CD_NYHA_IS_HEART_SEVERITY';

      IF (CD_DOENCA_SI_MAIN_W member of t_cids
      AND CD_DOE_SI_SEC_MOST_EXP_W member of t_cids
      AND CD_DOE_NR_SEQ_MOST_EXP_DIAG_W member of t_cids) THEN
          SI_MANDATORY_P := 'S';
      ELSE
          SI_MANDATORY_P := 'N';
      END IF;
    END IF;

      IF (DS_FIELD_P = 'SI_OBSTETRIC_DEPARTMENT') THEN
        select  coalesce(max(obter_idade_pf(b.cd_pessoa_fisica, clock_timestamp(), 'A')), 0) idade
        into STRICT    QT_AGE
        from    patient_dpc a,
                atendimento_paciente b,
                atend_paciente_unidade c,
                departamento_medico d
        where   b.nr_atendimento = a.nr_atendimento
        and     c.nr_atendimento = b.nr_atendimento
        and     d.cd_departamento = c.cd_departamento
        and     a.nr_sequencia = nr_seq_patient_dpc_p
        and     ((d.si_obstetric_department = 'N') or (coalesce(d.si_obstetric_department::text, '') = ''));

        DS_MANDATORY_FIELDS_P := 'SI_DEFECATION_EXIT;SI_URINATION_EXIT;SI_CLOTHES_EXIT;SI_STAIRS_EXIT;SI_WALKING_EXIT;' ||
        'SI_BATHING_EXIT;SI_TOILET_EXIT;SI_GROOMING_EXIT;SI_MEAL_EXIT;SI_MOVEMENT_EXIT;' ||
        'CD_PURPOSE_HOSP;SI_DEFECATION_EXIT;SI_URINATION_EXIT;SI_CLOTHES_EXIT;SI_STAIRS_EXIT;SI_WALKING_EXIT;' ||
        'SI_BATHING_EXIT;SI_TOILET_EXIT;SI_GROOMING_EXIT;SI_MEAL_EXIT;SI_MOVEMENT_EXIT;' ||
        'CD_DISCHARGE_DESTINATION;CD_HOSPITALIZATION_ROUTE;SI_MENTAL_WARD;' ||
        'SI_REALOCATION;CD_CHILD_BIRTH_INFO;DT_SOFA_AFTER_ENTRY;DT_SOFA_TREAT_AFTER_MES;DT_SOFA2_AFTER_ENTRY;'||
        'DT_SOFA2_TREAT_AFTER_MES;SI_CANCER_RECURR;SI_CAN_GEN_RULES;SI_CAN_PART;SI_CAN_STAGE;SI_PREGNANT;' ||
        'CD_MOST_EXP_DISEASE;SI_TIMES_BEDSORES;SI_TIMES_FIM;SI_TIMES_ROOM;SI_TIMES_ROOM_AFTER;SI_OBSTETRIC_DEPARTMENT';

        IF (QT_AGE > 0) THEN
            SI_MANDATORY_P := 'S';
        ELSE
            SI_MANDATORY_P := 'N';
        END IF;
    END IF;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE dpc_pkg.get_mandatory_fields (DS_FIELD_P text, DS_VALUE_P text,DS_MANDATORY_FIELDS_P INOUT text, SI_MANDATORY_P INOUT text, nr_seq_patient_dpc_p bigint) FROM PUBLIC;
