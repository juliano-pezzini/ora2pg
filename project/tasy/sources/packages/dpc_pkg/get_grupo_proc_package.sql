-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION dpc_pkg.get_grupo_proc ( cd_classification_p text, ie_origem_proced_p bigint) RETURNS bigint AS $body$
DECLARE


        cd_grupo_proc_actual_w  grupo_proc.cd_grupo_proc%type;

BEGIN
        select  max(cd_grupo_proc)
        into STRICT    cd_grupo_proc_actual_w
        from    grupo_proc a
        where   a.ie_origem_proced = ie_origem_proced_p
        and     cd_classification_p = ( SELECT  max(cd_classification)
                                        from    dpc_classification x
                                        where   x.nr_sequencia = a.cd_original);

        return cd_grupo_proc_actual_w;
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION dpc_pkg.get_grupo_proc ( cd_classification_p text, ie_origem_proced_p bigint) FROM PUBLIC;
