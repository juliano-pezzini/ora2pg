-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION param_pck.obter_valor_parametro_usuario ( cd_funcao_p bigint, nr_sequencia_p bigint, cd_perfil_p bigint, nm_usuario_p text, cd_estabelecimento_p bigint) RETURNS varchar AS $body$
DECLARE



	chave_w	varchar(100);
	vl_parametro_w	varchar(255);
	cd_estabelecimento_w	bigint;
	
BEGIN

	chave_w	:= cd_funcao_p||'_'||nr_sequencia_p||'_'||coalesce(cd_perfil_p,0)||'_'||coalesce(nm_usuario_p,'XPTO')||'_'||coalesce(cd_estabelecimento_p,0);

	chave_w	:= upper(chave_w);


	if (current_setting('param_pck.vetor_w')::vetorFuncao.EXISTS(chave_w)) then
		return current_setting('param_pck.vetor_w')::vetorFuncao[chave_w].vl_parametro;
	else
		current_setting('param_pck.vetor_w')::vetorFuncao[chave_w].cd_funcao		:= cd_funcao_p;
		current_setting('param_pck.vetor_w')::vetorFuncao[chave_w].nr_sequencia		:= nr_sequencia_p;
		current_setting('param_pck.vetor_w')::vetorFuncao[chave_w].cd_perfil		:= cd_perfil_p;
		current_setting('param_pck.vetor_w')::vetorFuncao[chave_w].nm_usuario		:= nm_usuario_p;
		current_setting('param_pck.vetor_w')::vetorFuncao[chave_w].cd_estabelecimento	:= cd_estabelecimento_p;

		current_setting('param_pck.vetor_w')::vetorFuncao[chave_w].vl_parametro := param_pck.load_param_usuario(	cd_funcao_p, nr_sequencia_p, cd_perfil_p, nm_usuario_p, cd_estabelecimento_p, current_setting('param_pck.vetor_w')::vetorFuncao[chave_w].vl_parametro);
		return current_setting('param_pck.vetor_w')::vetorFuncao[chave_w].vl_parametro;
	end if;

	return	null;

	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION param_pck.obter_valor_parametro_usuario ( cd_funcao_p bigint, nr_sequencia_p bigint, cd_perfil_p bigint, nm_usuario_p text, cd_estabelecimento_p bigint) FROM PUBLIC;
