-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';


CREATE TYPE r_regcol AS ( name_col       varchar(100),
							value_col      varchar(100),
							id_pk_col      bigint,
							id_dt          bigint);


CREATE OR REPLACE PROCEDURE apap_dinamico_pck.executa_consultas () AS $body$
DECLARE


  type v_regcol is table of r_regcol index by integer;
  v_regcol_w			v_regcol;
  sql_w               text := null;
  indice_w            bigint  := 0;
  nr_indice_w			bigint  := 0;
  id_pk_01_w          bigint  := 0;
  id_pk_02_w          bigint  := 0;
  id_pk_03_w          bigint  := 0;
  id_dt_registro_w    bigint  := 0;
  id_dt_apap_w        bigint  := 0;
  id_dt_inicio_w      bigint  := 0;
  id_dt_fim_w         bigint  := 0;
  id_vl_pad_w         bigint  := 0;
  id_vl_pas_w         bigint  := 0;
  id_vl_pam_w         bigint  := 0;
  id_vl_papd_w        bigint  := 0;
  id_vl_paps_w        bigint  := 0;
  id_vl_papm_w        bigint  := 0;
  id_ds_prof_w        bigint  := 0;
  id_ie_alerta_w      bigint  := 0;
  id_ds_cor_alerta_w  bigint  := 0;	
  id_ds_tooltip_w     bigint  := 0;
  id_vl_grafico_w     bigint  := 0;
  id_ie_status_w      bigint  := 0;
  id_qt_dose_w        bigint  := 0;
  id_ie_situacao_w	  bigint  := 0;	
  id_dt_inativacao_w  bigint  := 0;	
  id_dt_liberacao_w	  bigint  := 0;		
  id_ie_integracao_w  bigint  := 0;	
  id_nr_seq_icone_w	  bigint  := 0;	
  possui_alteracao_w  bigint  := 0;		
  v_cursor				integer;
  v_col_cnt           	integer;
  v_ind               	bigint;
  rec_tab             	dbms_sql.desc_tab;
  v_line              	varchar(250);
  vl_conteudo_w       	double precision;
  vl_pad_w            	double precision;
  vl_pas_w            	double precision;
  vl_pam_w            	double precision;
  vl_papd_w           	double precision;
  vl_paps_w           	double precision;
  vl_papm_w           	double precision;
  ds_profissional_w   	w_apap_pac_registro.ds_profissional%type;
  ie_alerta_w         	w_apap_pac_registro.ie_alerta%type;
  ds_cor_alerta_w		w_apap_pac_registro.ds_cor%type;
  ds_tooltip_w			w_apap_pac_registro.ds_tooltip%type;
  ie_status_w				w_apap_pac_registro.ie_status%type;
  vl_grafico_w			w_apap_pac_registro.vl_grafico%type;
  ie_situacao_w			w_apap_pac_registro.ie_situacao%type;
  nr_seq_icone_w		w_apap_pac_registro.nr_seq_icone%type;
  dt_inativacao_w		timestamp;
  dt_liberacao_w		timestamp;
  ie_integracao_w		w_apap_pac_registro.ie_integracao%type;
  dt_conteudo_w        	timestamp;
  ds_conteudo_w        	w_apap_pac_registro.ds_resultado%type;
  dt_registro_w        	timestamp  := null;
  dt_apap_w            	timestamp  := null;
  dt_inicio_continuo_w	timestamp  := null;
  dt_fim_continuo_w    	timestamp  := null;
  nr_sequencia_w       	bigint  := null;
  col_type_w           	bigint;
  ie_tipo_informacao_w w_apap_pac_informacao.ie_tipo_informacao%type;
  qt_dose_w w_apap_pac_registro.qt_dose%type;
  ds_lookup_w			linked_data_atributo.ds_lookup%type := null;
  ds_result_desc_w		varchar(2000);
  ie_param_1494_w		varchar(15);
BEGIN
	obter_param_usuario(281, 1494, wheb_usuario_pck.get_cd_perfil, wheb_usuario_pck.get_nm_usuario, wheb_usuario_pck.get_cd_estabelecimento, ie_param_1494_w);
	
  begin
	for	i in 1..query_v_w.count
	loop
	  sql_w   := UPPER('select '||current_setting('apap_dinamico_pck.query_v_w')::query_t[i].ds_select||' from '||current_setting('apap_dinamico_pck.query_v_w')::query_t[i].nm_tabela||' a where a.'||current_setting('apap_dinamico_pck.query_v_w')::query_t[i].ds_where);
	  indice_w          := 0;
	  id_pk_01_w        := 0;
	  id_pk_02_w        := 0;
	  id_pk_03_w        := 0;
	  id_dt_registro_w  := 0;
	  id_dt_apap_w      := 0;
	  id_dt_inicio_w    := 0;
	  id_dt_fim_w       := 0;
	  id_vl_pad_w       := 0;
	  id_vl_pas_w       := 0;
	  id_vl_pam_w       := 0;
	  id_vl_papd_w      := 0;
	  id_vl_paps_w      := 0;
	  id_vl_papm_w      := 0;
	  id_ds_prof_w      := 0;
	  id_ie_alerta_w    := 0;
	  id_ds_cor_alerta_w:= 0;
	  id_ds_tooltip_w	:= 0;
	  id_vl_grafico_w	:= 0;
	  id_ie_status_w	:= 0;
	  id_ie_situacao_w	:= 0;
	  id_ie_integracao_w:= 0;
	  id_dt_inativacao_w:= 0;
	  id_dt_liberacao_w	:= 0;
	  id_nr_seq_icone_w	:= 0;
	  id_qt_dose_w 		:= null;
	  ie_situacao_w		:= 'A';
	  ie_integracao_w	:= 'N';
	  dt_inativacao_w	:= null;
	  nr_seq_icone_w	:= null;
	  dt_liberacao_w	:= null;	
	  ie_status_w		:= null;

	  v_cursor := dbms_sql.open_cursor;
	  dbms_sql.parse(v_cursor, sql_w, dbms_sql.native);

	  if (position(':NR_ATENDIMENTO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_ATENDIMENTO_P', current_setting('apap_dinamico_pck.nr_atendimento_w')::atendimento_paciente.nr_atendimento%type);
	  end if;
	  if (position(':NM_USUARIO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NM_USUARIO_P', current_setting('apap_dinamico_pck.nm_usuario_w')::usuario.nm_usuario%type);
	  end if;
	  if (position(':CD_PESSOA_FISICA_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':CD_PESSOA_FISICA_P', current_setting('apap_dinamico_pck.cd_pessoa_fisica_w')::pessoa_fisica.cd_pessoa_fisica%type);
	  end if;
	  if (position(':CD_SETOR_ATENDIMENTO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':CD_SETOR_ATENDIMENTO_P', current_setting('apap_dinamico_pck.cd_setor_atendimento_w')::setor_atendimento.cd_setor_atendimento%type);
	  end if;
	  if (position(':DT_INICIO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':DT_INICIO_P', current_setting('apap_dinamico_pck.dt_inicial_w')::timestamp);
	  end if;
	  if (position(':DT_FIM_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':DT_FIM_P', current_setting('apap_dinamico_pck.dt_final_w')::timestamp);
	  end if;
	  if (position(':NR_SEQ_GRUPO_PG_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_GRUPO_PG_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_grupo_pg);
	  end if;
	  if (position(':IE_INTEGRACAO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_INTEGRACAO_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_ie_integracao);
	  end if;
	  if (position(':IE_PARAM_1494_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_PARAM_1494_P', ie_param_1494_w);
	  end if;
	  if (position(':IE_APARELHO_PA_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_APARELHO_PA_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_ie_aparelho_pa);
	  end if;
	  if (position(':IE_MEDIANA_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_MEDIANA_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_ie_mediana);
	  end if;
	  if (position(':IE_MEDIANA_1_MIN_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_MEDIANA_1_MIN_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_ie_mediana_1_min);
	  end if;
	  if (position(':IE_MEDIANA_5_MIN_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_MEDIANA_5_MIN_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_ie_mediana_5_min);
	  end if;
	  if (position(':IE_MEDIANA_10_MIN_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_MEDIANA_10_MIN_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_ie_mediana_10_min);
	  end if;
	  if (position(':IE_MEDIANA_15_MIN_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_MEDIANA_15_MIN_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_ie_mediana_15_min);
	  end if;
	  if (position(':NR_SEQ_SCORE_FLEX_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_SCORE_FLEX_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_score_flex);
	  end if;
	  if (position(':NR_SEQ_TOPOGRAFIA_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_TOPOGRAFIA_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_topografia);
	  end if;
	  if (position(':IE_LADO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_LADO_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_ie_lado);
	  end if;
	  if (position(':NR_SEQ_TIPO_PG_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_TIPO_PG_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_tipo_pg);
	  end if;
	  if (position(':NR_SEQ_DISPOSITIVO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_DISPOSITIVO_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_dispositivo);
	  end if;
	  if (position(':NR_SEQ_ATEND_DISP_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_ATEND_DISP_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_atend_disp);
	  end if;
	  if (position(':NR_FICHA_TECNICA_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_FICHA_TECNICA_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_ficha_tecnica);
	  end if;
	  if (position(':IE_CONTROLA_ADEP_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_CONTROLA_ADEP_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_ie_controla_adep);
	  end if;
	  if (position(':IE_TIPO_DOSAGEM_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_TIPO_DOSAGEM_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_ie_tipo_dosagem);
	  end if;
	  if (position(':NR_SEQ_GAS_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_GAS_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_gas);
	  end if;
	  if (position(':CD_MATERIAL_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':CD_MATERIAL_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_cd_material);
	  end if;
	  if (position(':IE_EVOLUCAO_CLINICA_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_EVOLUCAO_CLINICA_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_ie_evolucao_clinica);
	  end if;
	  if (position(':NR_SEQ_TIPO_REGISTRO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_TIPO_REGISTRO_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_tipo_registro);
	  end if;
	  if (position(':NR_SEQ_TIPO_AVALIACAO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_TIPO_AVALIACAO_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_tipo_avaliacao);
	  end if;
	  if (position(':NR_PRESCRICAO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_PRESCRICAO_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_prescricao);
	  end if;
	  if (position(':NR_SEQ_SOLUCAO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_SOLUCAO_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_solucao);
	  end if;
	  if (position(':NR_SEQ_EXAME_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_EXAME_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_exame);
	  end if;
	  if (position(':NR_SEQ_CPOE_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_CPOE_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_cpoe);
	  end if;
	  if (position(':IE_GLICEMIA_CONFIRMADA_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_GLICEMIA_CONFIRMADA_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_glicemia_confirmada);
	  end if;
	  if (position(':IE_EVENTO_TIPO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_EVENTO_TIPO_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_ie_evento_tipo);
	  end if;
	  if (position(':IE_TIPO_ELEMENTO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':IE_TIPO_ELEMENTO_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_ie_tipo_elemento);
	  end if;
	  if (position(':NR_SEQ_GQA_PROT_ETA_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_GQA_PROT_ETA_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_gqa_prot_eta);
	  end if;
	  if (position(':NR_SEQ_DISP_PAC_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_DISP_PAC_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_disp_pac);
	  end if;
	  if (position(':NR_SEQ_DIAGNOSTICO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_DIAGNOSTICO_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_diagnostico);
	  end if;
	  if (position(':NR_SEQ_INTERVENTION_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':nr_seq_intervention_p', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_intervention);
	  end if;
	  if (position(':NR_SEQ_CP_INDICATOR_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':nr_seq_cp_indicator_p', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_cp_indicator);
	  end if;
	  if (position(':NR_SEQ_ATRIB_CLIENTE_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_ATRIB_CLIENTE_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_atrib_cliente);
	  end if;
	  if (position(':NR_SEQ_TEMP_CONTEUDO_P' in sql_w) > 0) then
		dbms_sql.bind_variable(v_cursor, ':NR_SEQ_TEMP_CONTEUDO_P', current_setting('apap_dinamico_pck.query_v_w')::query_t[i].bind_nr_seq_temp_conteudo);
	  end if;

	  dbms_sql.describe_columns(v_cursor, v_col_cnt, rec_tab);
	  for v_pos in 1 .. rec_tab.last
	  loop
		v_line      := rec_tab[v_pos].col_name;
		col_type_w  := rec_tab[v_pos].col_type;
		case col_type_w
		  when 2 then
			DBMS_SQL.DEFINE_COLUMN(v_cursor, v_pos, vl_conteudo_w);
		  when 12 then
			DBMS_SQL.DEFINE_COLUMN(v_cursor, v_pos, dt_conteudo_w);
		  else
			DBMS_SQL.DEFINE_COLUMN(v_cursor, v_pos, ds_conteudo_w, 255);
		end case;

		indice_w := indice_w + 1;
		v_regcol_w[indice_w].name_col   := v_line;
		v_regcol_w[indice_w].value_col  := null;

		if (v_line = 'PK_1') then
		  id_pk_01_w := v_pos;
		elsif (v_line = 'PK_2') then
		  id_pk_02_w := v_pos;
		elsif (v_line = 'PK_3') then
		  id_pk_03_w := v_pos;
		elsif (v_line = 'DT_REGISTRO') then
		  id_dt_registro_w     := v_pos;
		elsif (v_line = 'DT_APAP') then
		  id_dt_apap_w   := v_pos;
		elsif (v_line = 'DT_INICIO') then
		  id_dt_inicio_w := v_pos;
		elsif (v_line = 'DT_FIM') then
		  id_dt_fim_w    := v_pos;
		elsif (v_line = 'VL_PAD') then
		  id_vl_pad_w    := v_pos;
		elsif (v_line = 'VL_PAS') then
		  id_vl_pas_w    := v_pos;
		elsif (v_line = 'VL_PAM') then
		  id_vl_pam_w    := v_pos;
		elsif (v_line = 'VL_PAPD') then
		  id_vl_papd_w   := v_pos;
		elsif (v_line = 'VL_PAPS') then
		  id_vl_paps_w    := v_pos;
		elsif (v_line = 'VL_PAPM') then
		  id_vl_papm_w    := v_pos;
		elsif (v_line = 'DS_PROFISSIONAL') then
		  id_ds_prof_w    := v_pos;
		elsif (v_line = 'IE_ALERTA') then
		  id_ie_alerta_w    := v_pos;
		elsif (v_line = 'DS_COR_ALERTA') then
		  id_ds_cor_alerta_w:= v_pos;
		elsif (v_line = 'DS_TOOLTIP') then
		  id_ds_tooltip_w   := v_pos;
		elsif (v_line = 'VL_GRAFICO') then
		  id_vl_grafico_w   := v_pos;
		elsif (v_line = 'IE_STATUS') then
		  id_ie_status_w	  := v_pos;
		elsif (v_line = 'IE_SITUACAO') then
		  id_ie_situacao_w	  := v_pos;
		elsif (v_line = 'DT_INATIVACAO') then
		  id_dt_inativacao_w  := v_pos;
		elsif (v_line = 'NR_SEQ_ICONE') then
		  id_nr_seq_icone_w   := v_pos;
		elsif (v_line = 'DT_LIBERACAO') then
		  id_dt_liberacao_w  := v_pos;
		elsif (v_line = 'IE_INTEGRACAO') then
		  id_ie_integracao_w  := v_pos;
		elsif (v_line = 'QT_DOSE') then
		  id_qt_dose_w := v_pos;
		end if;
	  end loop;

	  dt_registro_w        := null;
	  dt_apap_w            := null;
	  nr_sequencia_w       := null;
	  dt_inicio_continuo_w := null;
	  dt_fim_continuo_w    := null;
	  v_ind := dbms_sql.EXECUTE(v_cursor);

	  loop v_ind := dbms_sql.fetch_rows(v_cursor);
		exit when v_ind = 0;
		for v_col_seq in 1 .. rec_tab.count
		loop
		  ds_conteudo_w  := null;
		  vl_conteudo_w  := null;
		  dt_conteudo_w  := null;
		  ds_cor_alerta_w:= null;
		  dt_liberacao_w := clock_timestamp(); 	
		  nr_seq_icone_w := null;	
		  if (id_dt_registro_w > 0) then
			dbms_sql.column_value(v_cursor, id_dt_registro_w, dt_registro_w);
		  end if;
		  if (id_dt_apap_w > 0) then
			dbms_sql.column_value(v_cursor, id_dt_apap_w, dt_apap_w);
		  end if;
		  if (id_dt_inicio_w > 0) then
			dbms_sql.column_value(v_cursor, id_dt_inicio_w, dt_inicio_continuo_w);
		  end if;
		  if (id_dt_fim_w > 0) then
			dbms_sql.column_value(v_cursor, id_dt_fim_w, dt_fim_continuo_w);
		  end if;
		  if (id_pk_01_w > 0) then
			dbms_sql.column_value(v_cursor, id_pk_01_w, nr_sequencia_w);
		  end if;
		  if (id_vl_pad_w > 0) then
			dbms_sql.column_value(v_cursor, id_vl_pad_w, vl_pad_w);
		  end if;
		  if (id_vl_pas_w > 0) then
			dbms_sql.column_value(v_cursor, id_vl_pas_w, vl_pas_w);
		  end if;
		  if (id_vl_pam_w > 0) then
			dbms_sql.column_value(v_cursor, id_vl_pam_w, vl_pam_w);
		  end if;
		  if (id_vl_papd_w > 0) then
			dbms_sql.column_value(v_cursor, id_vl_papd_w, vl_papd_w);
		  end if;
		  if (id_vl_paps_w > 0) then
			dbms_sql.column_value(v_cursor, id_vl_paps_w, vl_paps_w);
		  end if;
		  if (id_vl_papm_w > 0) then
			dbms_sql.column_value(v_cursor, id_vl_papm_w, vl_papm_w);
		  end if;
		  if (id_ds_prof_w > 0) then
			dbms_sql.column_value(v_cursor, id_ds_prof_w, ds_profissional_w);
		  end if;
		  if (id_ie_alerta_w > 0) then
			dbms_sql.column_value(v_cursor, id_ie_alerta_w, ie_alerta_w);
		  end if;
		  if (id_ds_cor_alerta_w > 0) then
			dbms_sql.column_value(v_cursor, id_ds_cor_alerta_w, ds_cor_alerta_w);
		  end if;
		  if (id_ds_tooltip_w > 0) then
			dbms_sql.column_value(v_cursor, id_ds_tooltip_w, ds_tooltip_w);
		  end if;
		  if (id_ie_status_w > 0) then
			dbms_sql.column_value(v_cursor, id_ie_status_w, ie_status_w);
		  end if;
		  if (id_vl_grafico_w > 0) then
			dbms_sql.column_value(v_cursor, id_vl_grafico_w, vl_grafico_w);
		  end if;
		  if (id_qt_dose_w > 0) then
			dbms_sql.column_value(v_cursor, id_qt_dose_w, qt_dose_w);
		  end if;
		  if (id_ie_situacao_w > 0) then
			dbms_sql.column_value(v_cursor, id_ie_situacao_w, ie_situacao_w);
		  end if;
		  if (id_dt_inativacao_w > 0) then
			dbms_sql.column_value(v_cursor, id_dt_inativacao_w, dt_inativacao_w);
		  end if;
		  if (id_dt_liberacao_w > 0) then
			dbms_sql.column_value(v_cursor, id_dt_liberacao_w, dt_liberacao_w);
		  end if;
		  if (id_ie_integracao_w > 0) then
			dbms_sql.column_value(v_cursor, id_ie_integracao_w, ie_integracao_w);
		  end if;
		  if (id_nr_seq_icone_w > 0) then
			dbms_sql.column_value(v_cursor, id_nr_seq_icone_w, nr_seq_icone_w);
		  end if;
		
		  
		  
		  if (rec_tab[v_col_seq].col_type = 1) then
			dbms_sql.column_value(v_cursor, v_col_seq, ds_conteudo_w);
		  elsif (rec_tab[v_col_seq].col_type = 2) then
			dbms_sql.column_value(v_cursor, round((v_col_seq)::numeric,3), vl_conteudo_w);
		  elsif (rec_tab[v_col_seq].col_type = 12) then
			dbms_sql.column_value(v_cursor, v_col_seq, dt_conteudo_w);
		  end if;
		  ds_lookup_w 		:= null;
		  ds_result_desc_w	:= null;
		  if ((dt_conteudo_w IS NOT NULL AND dt_conteudo_w::text <> '') or (vl_conteudo_w IS NOT NULL AND vl_conteudo_w::text <> '') or (ds_conteudo_w IS NOT NULL AND ds_conteudo_w::text <> '')) then
			
			select      count(1)
			into STRICT        possui_alteracao_w
			from        w_apap_pac_informacao a
			inner join  w_apap_pac_registro b ON (b.nr_seq_apap_inf = a.nr_sequencia)
			where       a.nm_tabela = current_setting('apap_dinamico_pck.query_v_w')::query_t[i].nm_tabela
			and         a.nm_usuario = current_setting('apap_dinamico_pck.nm_usuario_w')::usuario.nm_usuario%type
			and         b.nr_seq_origem = nr_sequencia_w
			and         b.ie_status_houdini = 'L';
	

			if (possui_alteracao_w = 0) then
			  select  max(c.ie_tipo_informacao),
					  max(c.ds_lookup)	
			  into STRICT    ie_tipo_informacao_w,
					  ds_lookup_w
			  from    w_apap_pac_informacao c,
					  w_apap_pac_grupo b,
					  w_apap_pac a
			  where   a.nr_sequencia = b.nr_seq_mod_apap
			  and     b.nr_sequencia = c.nr_seq_apap_grupo
			  and     c.nm_atributo = v_regcol_w[v_col_seq].name_col
			  and     a.nr_atendimento = current_setting('apap_dinamico_pck.nr_atendimento_w')::atendimento_paciente.nr_atendimento%type
			  and     a.nm_usuario = current_setting('apap_dinamico_pck.nm_usuario_w')::usuario.nm_usuario%type
			  and     a.nr_seq_documento = current_setting('apap_dinamico_pck.nr_seq_documento_w')::documento.nr_sequencia%type;
			
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t.extend(1);
			  nr_indice_w                                  := current_setting('apap_dinamico_pck.valores_v_w')::valores_t.count;
			
			  if (current_setting('apap_dinamico_pck.query_v_w')::query_t[i].nm_tabela = 'EHR_REG_ELEMENTO') and (nr_sequencia_w IS NOT NULL AND nr_sequencia_w::text <> '') then
				select  max(c.nr_sequencia),
						max(c.dt_inativacao),
						max(c.ie_situacao)
				into STRICT	nr_sequencia_w,
						dt_inativacao_w,
						ie_situacao_w
				from    ehr_reg_elemento a,
						ehr_reg_template b,
						ehr_registro c
				where   a.nr_seq_reg_template 	= b.nr_sequencia
				and		b.nr_seq_reg			= c.nr_sequencia
				and     a.nr_sequencia        	= nr_sequencia_w;
			  end if;	
				
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].nr_sequencia        := nr_sequencia_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].dt_conteudo         := dt_conteudo_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].vl_conteudo         := vl_conteudo_w;

			  if (coalesce(ie_tipo_informacao_w::text, '') = '' or ie_tipo_informacao_w <> 'D') then
				current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ds_conteudo := substr(ds_conteudo_w,1,255);
			  else
				current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ds_conteudo 	:= 'assets\no-icon.svg';
				current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].nr_seq_icone 	:= -1;
			  end if;
			
			  begin
			  if (ds_lookup_w IS NOT NULL AND ds_lookup_w::text <> '') and ((vl_conteudo_w IS NOT NULL AND vl_conteudo_w::text <> '') or (ds_conteudo_w IS NOT NULL AND ds_conteudo_w::text <> '')) then
				Obter_valor_Dinamico_char_bv(ds_lookup_w,'vl_resultado='||coalesce(to_char(vl_conteudo_w),ds_conteudo_w)||';',ds_result_desc_w);
			  end if;
			  if (coalesce(ds_result_desc_w::text, '') = '') then
				ds_result_desc_w := current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].vl_conteudo;
				if (coalesce(ds_result_desc_w::text, '') = '') then
					ds_result_desc_w := current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ds_conteudo;
					if (coalesce(ds_result_desc_w::text, '') = '') then
						ds_result_desc_w := pkg_date_formaters_tz.to_varchar(current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].dt_conteudo,'shortDate',establishment_timezone_utils.gettimezone);
					end if;
				end if;
			  end if;		
			  exception
				when others then
					ds_result_desc_w := null;
			  end;
			
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].dt_medicao          := coalesce(dt_apap_w,dt_registro_w);
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].dt_registro         := dt_registro_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].dt_inicio_continuo  := dt_inicio_continuo_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].dt_fim_continuo     := dt_fim_continuo_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].vl_pad              := vl_pad_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].vl_pas              := vl_pas_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].vl_pam              := vl_pam_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].vl_papd             := vl_papd_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].vl_paps             := vl_paps_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].vl_papm             := vl_papm_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ds_profissional     := ds_profissional_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ie_alerta           := ie_alerta_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ds_cor_alerta       := ds_cor_alerta_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ds_tooltip          := ds_tooltip_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].vl_grafico          := vl_grafico_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ie_status           := ie_status_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].nm_tabela           := current_setting('apap_dinamico_pck.query_v_w')::query_t[i].nm_tabela;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].nm_atributo         := v_regcol_w[v_col_seq].name_col;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].qt_dose             := qt_dose_w;
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ds_result_desc	   := substr(ds_result_desc_w,1,255);
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].dt_liberacao	   	   := dt_liberacao_w;
			  if (position('/assets/' in ds_conteudo_w) > 0) then
				current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].nr_seq_icone	   	   := nr_seq_icone_w;
			  else	
				current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].nr_seq_icone	   	   := null;
			  end if;	
			  if (dt_inativacao_w IS NOT NULL AND dt_inativacao_w::text <> '') then
				current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ie_situacao	   := 'I';
			  else
				current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ie_situacao	   := coalesce(ie_situacao_w,'A');
			  end if;	
			  current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ie_integracao	   := coalesce(ie_integracao_w,'N');
			
			  if (current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w](.nr_sequencia IS NOT NULL AND .nr_sequencia::text <> '')) and (current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ie_integracao = 'S') then
					if (current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w]coalesce(.dt_liberacao::text, '') = '') then
						current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ie_status_registro := 'P';
					elsif (current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ie_situacao = 'I') then
						current_setting('apap_dinamico_pck.valores_v_w')::valores_t[nr_indice_w].ie_status_registro := 'R';
					end if;	
			  end if;	

			end if;
		  end if;
		end loop;
	  end loop;
	  dbms_sql.close_cursor(v_cursor);
	end loop;
  exception
	when others then
	  PERFORM set_config('apap_dinamico_pck.sql_errm_w', sqlerrm, false);
	  CALL apap_dinamico_pck.gera_log_apap('executa_consultas: '||current_setting('apap_dinamico_pck.sql_errm_w')::varchar(4000)||' * '||sql_w);
  end;
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE apap_dinamico_pck.executa_consultas () FROM PUBLIC;
