-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE escala_mods_befins_md_pck.obter_score_cardiovascular_md (qt_pa_diastolica_p bigint, qt_pa_sistolica_p bigint, qt_freq_cardiaca_p bigint, qt_pvc_p bigint, qt_pam_p INOUT bigint, qt_pa_ajustada_p INOUT bigint, qt_pto_cardio_p INOUT bigint) AS $body$
BEGIN
    qt_pam_p := coalesce(dividir((qt_pa_sistolica_p + (qt_pa_diastolica_p * 2)), 3), 0);

    if (qt_freq_cardiaca_p IS NOT NULL AND qt_freq_cardiaca_p::text <> '') and (qt_pvc_p IS NOT NULL AND qt_pvc_p::text <> '') and (qt_pam_p IS NOT NULL AND qt_pam_p::text <> '') then
	  qt_pa_ajustada_p := coalesce(dividir((qt_freq_cardiaca_p * qt_pvc_p), qt_pam_p), 0);
    end if;

    if (coalesce(qt_pa_ajustada_p::text, '') = '') then
	  qt_pto_cardio_p := 0;
    elsif (qt_pa_ajustada_p > 30) then
	  qt_pto_cardio_p := 4;
    elsif (qt_pa_ajustada_p > 20) and (qt_pa_ajustada_p <= 30) then
	  qt_pto_cardio_p := 3;
    elsif (qt_pa_ajustada_p > 15) and (qt_pa_ajustada_p <= 20) then
	qt_pto_cardio_p := 2;
    elsif (qt_pa_ajustada_p > 10) and (qt_pa_ajustada_p <= 15) then
	  qt_pto_cardio_p := 1;
    elsif (qt_pa_ajustada_p <= 10) then
	  qt_pto_cardio_p := 0;
    end if;

  end;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE escala_mods_befins_md_pck.obter_score_cardiovascular_md (qt_pa_diastolica_p bigint, qt_pa_sistolica_p bigint, qt_freq_cardiaca_p bigint, qt_pvc_p bigint, qt_pam_p INOUT bigint, qt_pa_ajustada_p INOUT bigint, qt_pto_cardio_p INOUT bigint) FROM PUBLIC;
