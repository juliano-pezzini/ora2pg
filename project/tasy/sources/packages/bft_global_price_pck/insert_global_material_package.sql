-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE bft_global_price_pck.insert_global_material ( cd_unidade_p text, cd_principio_p text, cd_concentracao_p text, cd_acao_p text, cd_forma_apresentacao_p text, cd_laboratorio_p text, cd_tamanho_p text, cd_tipo_controle_p text, cd_tipo_venda_p text, cd_via_adm_p text, cd_apresentacao_p text, ds_apresentacao_p text, ie_importado_p text, ie_refrigerado_p text, ie_iva_p text, qt_unidade_p bigint, cd_material_glo_p text, ds_material_glo_p text, nm_usuario_p text, cd_estabelecimento_p bigint, ie_situacao_p text default null) AS $body$
DECLARE

				
	ora2pg_rowcount int;
material_global_w	material_global%rowtype;
	
	
BEGIN
	update	material_global
	set	cd_material_glo	= cd_material_glo_p,
		ds_material_glo		=	ds_material_glo_p,
		dt_atualizacao		=	clock_timestamp(),
		ie_situacao			=	'A',
		cd_estabelecimento	=	cd_estabelecimento_p,
		nm_usuario		=	nm_usuario_p,	
		cd_apresentacao		=	cd_apresentacao_p,
		ds_apresentacao		=	ds_apresentacao_p,
		ie_importado		=	ie_importado_p,
		ie_refrigerado		=	ie_refrigerado_p,
		ie_iva			=	ie_iva_p,
		qt_unidade		=	qt_unidade_p,
		cd_laboratorio		=	cd_laboratorio_p,
		cd_tipo_venda		=	cd_tipo_venda_p,
		cd_tipo_controle	=	cd_tipo_controle_p,
		cd_tamanho		=	cd_tamanho_p,
		cd_forma_apresentacao	=	cd_forma_apresentacao_p,
		cd_via_adm		=	cd_via_adm_p,
		cd_principio		=	cd_principio_p,
		cd_acao			=	cd_acao_p,
		cd_concentracao		=	cd_concentracao_p,
		cd_unidade		=	cd_unidade_p
	where	cd_material_glo	= cd_material_glo_p;
	
	GET DIAGNOSTICS ora2pg_rowcount = ROW_COUNT;

	
	if ( ora2pg_rowcount = 0) then
		material_global_w.cd_material_glo	:=	cd_material_glo_p;
		material_global_w.ds_material_glo	:=	ds_material_glo_p;
		material_global_w.ie_situacao		:=	'A';
		material_global_w.cd_estabelecimento	:=	cd_estabelecimento_p;
		material_global_w.dt_atualizacao	:=	clock_timestamp();
		material_global_w.nm_usuario		:=	nm_usuario_p;
		material_global_w.dt_atualizacao_nrec	:=	clock_timestamp();
		material_global_w.nm_usuario_nrec	:=	nm_usuario_p;
		material_global_w.cd_apresentacao	:=	cd_apresentacao_p;
		material_global_w.ds_apresentacao	:=	ds_apresentacao_p;
		material_global_w.ie_importado		:=	ie_importado_p;
		material_global_w.ie_refrigerado	:=	ie_refrigerado_p;
		material_global_w.ie_iva		:=	ie_iva_p;
		material_global_w.qt_unidade		:=	qt_unidade_p;
		material_global_w.cd_laboratorio	:=	cd_laboratorio_p;
		material_global_w.cd_tipo_venda		:=	cd_tipo_venda_P;
		material_global_w.cd_tipo_controle	:=	cd_tipo_controle_p;
		material_global_w.cd_tamanho		:=	cd_tamanho_p;
		material_global_w.cd_forma_apresentacao	:=	cd_forma_apresentacao_p;
		material_global_w.cd_via_adm		:=	cd_via_adm_p;
		material_global_w.cd_principio		:=	cd_principio_P;
		material_global_w.cd_acao		:=	cd_acao_p;
		material_global_w.cd_concentracao	:=	cd_concentracao_p;
		material_global_w.cd_unidade		:=	cd_unidade_p;
		
		insert into material_global values (material_global_w.*);
	end if;
		
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE bft_global_price_pck.insert_global_material ( cd_unidade_p text, cd_principio_p text, cd_concentracao_p text, cd_acao_p text, cd_forma_apresentacao_p text, cd_laboratorio_p text, cd_tamanho_p text, cd_tipo_controle_p text, cd_tipo_venda_p text, cd_via_adm_p text, cd_apresentacao_p text, ds_apresentacao_p text, ie_importado_p text, ie_refrigerado_p text, ie_iva_p text, qt_unidade_p bigint, cd_material_glo_p text, ds_material_glo_p text, nm_usuario_p text, cd_estabelecimento_p bigint, ie_situacao_p text default null) FROM PUBLIC;
