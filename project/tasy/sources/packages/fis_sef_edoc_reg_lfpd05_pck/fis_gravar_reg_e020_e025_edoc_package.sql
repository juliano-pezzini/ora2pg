-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';


/*Gravação dos registro e020 e e025*/

CREATE OR REPLACE PROCEDURE fis_sef_edoc_reg_lfpd05_pck.fis_gravar_reg_e020_e025_edoc () AS $body$
BEGIN
/*Grava o registro e020 para depois o e025, pois precisa do nr_sequencia gravado para poder inserir o nr_Seq_superior do e025*/

forall i in current_setting('fis_sef_edoc_reg_lfpd05_pck.fis_registros_e020_w')::registro_e020.first .. current_setting('fis_sef_edoc_reg_lfpd05_pck.fis_registros_e020_w')::registro_e020.last
	insert into fis_sef_edoc_e020 values current_setting('fis_sef_edoc_reg_lfpd05_pck.fis_registros_e020_w')::registro_e020(i);

/*Limpa o array*/

current_setting('fis_sef_edoc_reg_lfpd05_pck.fis_registros_e020_w')::registro_e020.delete;

/*Grava o e025*/

forall i in current_setting('fis_sef_edoc_reg_lfpd05_pck.fis_registros_e025_w')::registro_e025.first .. current_setting('fis_sef_edoc_reg_lfpd05_pck.fis_registros_e025_w')::registro_e025.last
	insert into fis_sef_edoc_e025 values current_setting('fis_sef_edoc_reg_lfpd05_pck.fis_registros_e025_w')::registro_e025(i);

/*Limpa o array*/

current_setting('fis_sef_edoc_reg_lfpd05_pck.fis_registros_e025_w')::registro_e025.delete;

commit;

PERFORM set_config('fis_sef_edoc_reg_lfpd05_pck.qt_cursor_e020_w', 0, false);
PERFORM set_config('fis_sef_edoc_reg_lfpd05_pck.qt_cursor_e025_w', 0, false);

/*Libera memoria*/

dbms_session.free_unused_user_memory;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE fis_sef_edoc_reg_lfpd05_pck.fis_gravar_reg_e020_e025_edoc () FROM PUBLIC;
