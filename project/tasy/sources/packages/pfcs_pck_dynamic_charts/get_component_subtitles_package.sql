-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pfcs_pck_dynamic_charts.get_component_subtitles (nr_seq_card_p bigint) RETURNS varchar AS $body$
DECLARE

        ds_component_subtitles_w    PFCS_PCK_SUBTYPES.VARCHAR_255_T;
        ds_column_1_w               dic_objeto.nm_campo_base%type;
        ds_column_2_w               dic_objeto.nm_campo_base%type;
        ds_column_3_w               dic_objeto.nm_campo_base%type;
        ds_column_4_w               dic_objeto.nm_campo_base%type;

BEGIN
        select  max(pfcs_pck_dynamic_charts.get_ds_column_color(pci.nm_first_column, i.nr_seq_object)),
                max(pfcs_pck_dynamic_charts.get_ds_column_color(pci.nm_second_column, i.nr_seq_object)),
                max(pfcs_pck_dynamic_charts.get_ds_column_color(pci.nm_third_column, i.nr_seq_object)),
                max(pfcs_pck_dynamic_charts.get_ds_column_color(pci.nm_fourth_column, i.nr_seq_object))
        into STRICT    ds_column_1_w,
                ds_column_2_w,
                ds_column_3_w,
                ds_column_4_w
        from    pfcs_indicator i,
                pfcs_card c,
                pfcs_card_indicator pci
        where   c.nr_sequencia = nr_seq_card_p
        and     c.nr_seq_indicator = i.nr_sequencia
        and     pci.nr_seq_card = c.nr_sequencia;

        if (ds_column_1_w IS NOT NULL AND ds_column_1_w::text <> '') then
            ds_component_subtitles_w :=
                ds_component_subtitles_w || 'PFCS_PCK_DYNAMIC_CHARTS.CHECK_NULL_COMPONENT_SUBTITLES('
                    || chr(39) || 'firstCell:' || chr(39) || '||' || ds_column_1_w || '||' || chr(39) || ';' || chr(39)
                || ') ||';
        end if;
        if (ds_column_2_w IS NOT NULL AND ds_column_2_w::text <> '') then
            ds_component_subtitles_w :=
                ds_component_subtitles_w || 'PFCS_PCK_DYNAMIC_CHARTS.CHECK_NULL_COMPONENT_SUBTITLES('
                    || chr(39) || 'secondCell:' || chr(39) || '||' || ds_column_2_w || '||' || chr(39) || ';' || chr(39)
                || ') ||';
        end if;
        if (ds_column_3_w IS NOT NULL AND ds_column_3_w::text <> '') then
            ds_component_subtitles_w :=
                ds_component_subtitles_w || 'PFCS_PCK_DYNAMIC_CHARTS.CHECK_NULL_COMPONENT_SUBTITLES('
                    || chr(39) || 'thirdCell:' || chr(39) || '||' || ds_column_3_w || '||' || chr(39) || ';' || chr(39)
                || ') ||';
        end if;
        if (ds_column_4_w IS NOT NULL AND ds_column_4_w::text <> '') then
            ds_component_subtitles_w :=
                ds_component_subtitles_w || 'PFCS_PCK_DYNAMIC_CHARTS.CHECK_NULL_COMPONENT_SUBTITLES('
                    || chr(39) || 'fourthCell:' || chr(39) || '||' || ds_column_4_w || '||' || chr(39) || ';' || chr(39)
                || ') ||';
        end if;

        if (length(ds_component_subtitles_w) > 1) then
            ds_component_subtitles_w := substr(ds_component_subtitles_w, 1, length(ds_component_subtitles_w)-2);
        end if;

        return coalesce(ds_component_subtitles_w, 'null');
    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pfcs_pck_dynamic_charts.get_component_subtitles (nr_seq_card_p bigint) FROM PUBLIC;
