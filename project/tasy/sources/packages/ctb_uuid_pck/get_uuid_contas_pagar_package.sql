-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION ctb_uuid_pck.get_uuid_contas_pagar (nr_documento_p movimento_contabil_doc.nr_documento%type, nr_seq_doc_compl_p movimento_contabil_doc.nr_seq_doc_compl%type ) RETURNS NOTA_FISCAL.NR_NFE_IMP%TYPE AS $body$
DECLARE


nr_nfe_imp_w    nota_fiscal.nr_nfe_imp%type;
/* 7 - Contas a Pagar
movimento_contabil_doc.nr_seq_doc_compl =   titulo_pagar_baixa.nr_sequencia
movimento_contabil_doc.nr_documento =   titulo_pagar_baixa.nr_titulo
*/
BEGIN
    begin
    select  max(nf.nr_nfe_imp)
    into STRICT    nr_nfe_imp_w
    from    titulo_pagar_baixa nf,
            titulo_pagar t
    where   nf.nr_titulo = t.nr_titulo
    and     (nf.nr_nfe_imp IS NOT NULL AND nf.nr_nfe_imp::text <> '')
    and     nf.nr_sequencia = nr_seq_doc_compl_p
    and     nf.nr_titulo =  nr_documento_p;
    exception
    when others then
        nr_nfe_imp_w:= null;
    end;
return  nr_nfe_imp_w;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION ctb_uuid_pck.get_uuid_contas_pagar (nr_documento_p movimento_contabil_doc.nr_documento%type, nr_seq_doc_compl_p movimento_contabil_doc.nr_seq_doc_compl%type ) FROM PUBLIC;
