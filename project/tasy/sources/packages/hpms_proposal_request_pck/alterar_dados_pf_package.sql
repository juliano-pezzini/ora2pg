-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE hpms_proposal_request_pck.alterar_dados_pf ( cd_pessoa_fisica_p pessoa_fisica.cd_pessoa_fisica%type, nm_usuario_p usuario.nm_usuario%type) AS $body$
DECLARE


ie_gerar_solic_alt_pf_w		varchar(1);
pls_proposta_benef_online_w	pls_proposta_benef_online%rowtype;
pessoa_fisica_w			pessoa_fisica%rowtype;
compl_pessoa_fisica_w		compl_pessoa_fisica%rowtype;
cd_estabelecimento_w		estabelecimento.cd_estabelecimento%type;
nm_mae_w			compl_pessoa_fisica.nm_contato%type;
nm_pai_w			compl_pessoa_fisica.nm_contato%type;
qt_compl_residencial_w		bigint;
qt_compl_mae_w			bigint;
qt_compl_pai_w			bigint;
nr_sequencia_compl_w		compl_pessoa_fisica.nr_sequencia%type;


BEGIN

cd_estabelecimento_w	:= obter_estabelecimento_ativo;

ie_gerar_solic_alt_pf_w	:= coalesce(obter_valor_param_usuario(1395, 3, Obter_Perfil_Ativo, nm_usuario_p, cd_estabelecimento_w),'N');

if (ie_gerar_solic_alt_pf_w in ('A','S')) then
	select	*
	into STRICT	pls_proposta_benef_online_w
	from	pls_proposta_benef_online
	where	nr_sequencia = nr_seq_prop_benef_p;

	if (ie_gerar_solic_alt_pf_w = 'A') then
		update	pessoa_fisica
		set	nm_pessoa_fisica	= coalesce(pls_proposta_benef_online_w.nm_pessoa_fisica, nm_pessoa_fisica),
			dt_nascimento		= coalesce(pls_proposta_benef_online_w.dt_nascimento, dt_nascimento),
			nr_cpf			= coalesce(pls_proposta_benef_online_w.nr_cpf, nr_cpf),
			ie_estado_civil		= coalesce(pls_proposta_benef_online_w.ie_estado_civil, ie_estado_civil),
			ie_sexo			= coalesce(pls_proposta_benef_online_w.ie_sexo, ie_sexo),
			nr_identidade		= coalesce(pls_proposta_benef_online_w.nr_identidade, nr_identidade),
			dt_emissao_ci		= coalesce(pls_proposta_benef_online_w.dt_emissao_ci, dt_emissao_ci),
			sg_emissora_ci		= coalesce(pls_proposta_benef_online_w.sg_emissora_ci, sg_emissora_ci),
			ds_orgao_emissor_ci	= coalesce(pls_proposta_benef_online_w.ds_orgao_emissor_ci, ds_orgao_emissor_ci),
			nr_telefone_celular	= coalesce(pls_proposta_benef_online_w.nr_telefone_celular, nr_telefone_celular),
			nr_cartao_nac_sus	= coalesce(pls_proposta_benef_online_w.nr_cartao_nac_sus, nr_cartao_nac_sus),
			nr_ddd_celular		= coalesce(pls_proposta_benef_online_w.nr_ddd_celular, nr_ddd_celular),
			cd_municipio_ibge	= coalesce(pls_proposta_benef_online_w.cd_municipio_ibge, cd_municipio_ibge),
			dt_atualizacao		= clock_timestamp(),
			nm_usuario		= nm_usuario_p
		where	cd_pessoa_fisica	= cd_pessoa_fisica_p;
		
		select	count(1)
		into STRICT	qt_compl_residencial_w
		from	compl_pessoa_fisica
		where	cd_pessoa_fisica	= cd_pessoa_fisica_p
		and	ie_tipo_complemento	= 1;
		
		if (qt_compl_residencial_w > 0) then
			update	compl_pessoa_fisica
			set	nr_ddd_telefone		= coalesce(pls_proposta_benef_online_w.nr_ddd_telefone, nr_ddd_telefone),
				nr_ddi_telefone		= coalesce(pls_proposta_benef_online_w.nr_ddi_telefone, nr_ddi_telefone),
				nr_telefone		= coalesce(pls_proposta_benef_online_w.nr_telefone, nr_telefone),
				ds_bairro		= coalesce(pls_proposta_benef_online_w.ds_bairro, ds_bairro),
				cd_municipio_ibge	= coalesce(pls_proposta_benef_online_w.cd_municipio_ibge, cd_municipio_ibge),
				sg_estado		= coalesce(pls_proposta_benef_online_w.sg_estado, sg_estado),
				cd_cep			= coalesce(pls_proposta_benef_online_w.cd_cep, cd_cep),
				ds_endereco		= coalesce(pls_proposta_benef_online_w.ds_endereco, ds_endereco),
				nr_endereco		= coalesce(pls_proposta_benef_online_w.nr_endereco, nr_endereco),
				ds_complemento		= coalesce(pls_proposta_benef_online_w.ds_complemento, ds_complemento),
				ds_email		= coalesce(pls_proposta_benef_online_w.ds_email, ds_email),
				nr_seq_pais		= coalesce(pls_proposta_benef_online_w.nr_seq_pais, nr_seq_pais),
				cd_profissao		= coalesce(pls_proposta_benef_online_w.cd_profissao, cd_profissao),
				dt_atualizacao		= clock_timestamp(),
				nm_usuario		= nm_usuario_p
			where	cd_pessoa_fisica	= cd_pessoa_fisica_p
			and	ie_tipo_complemento	= 1;
		else
			select (coalesce(max(nr_sequencia),0)+1)
			into STRICT	nr_sequencia_compl_w
			from	compl_pessoa_fisica
			where	cd_pessoa_fisica = cd_pessoa_fisica_p;
		
			insert into compl_pessoa_fisica(nr_sequencia, dt_atualizacao, nm_usuario,
				cd_pessoa_fisica, ie_tipo_complemento, nr_ddd_telefone,
				nr_ddi_telefone, nr_telefone, ds_bairro,
				cd_municipio_ibge, sg_estado, cd_cep,
				ds_endereco, nr_endereco, ds_complemento,
				ds_email, dt_atualizacao_nrec, nm_usuario_nrec)
			values (nr_sequencia_compl_w, clock_timestamp(), nm_usuario_p,
				cd_pessoa_fisica_p, 1, pls_proposta_benef_online_w.nr_ddd_telefone,
				pls_proposta_benef_online_w.nr_ddi_telefone, pls_proposta_benef_online_w.nr_telefone, pls_proposta_benef_online_w.ds_bairro,
				pls_proposta_benef_online_w.cd_municipio_ibge, pls_proposta_benef_online_w.sg_estado, pls_proposta_benef_online_w.cd_cep,
				pls_proposta_benef_online_w.ds_endereco, pls_proposta_benef_online_w.nr_endereco, pls_proposta_benef_online_w.ds_complemento,
				pls_proposta_benef_online_w.ds_email, clock_timestamp(), nm_usuario_p);
		end if;
		
		select	count(1)
		into STRICT	qt_compl_mae_w
		from	compl_pessoa_fisica
		where	cd_pessoa_fisica	= cd_pessoa_fisica_p
		and	ie_tipo_complemento	= 5;
		
		if (qt_compl_mae_w > 0) then
			update	compl_pessoa_fisica
			set	nm_contato		= coalesce(pls_proposta_benef_online_w.nm_mae, nm_contato),
				dt_atualizacao		= clock_timestamp(),
				nm_usuario		= nm_usuario_p
			where	cd_pessoa_fisica	= cd_pessoa_fisica_p
			and	ie_tipo_complemento	= 5;
		else
			select (coalesce(max(nr_sequencia),0)+1)
			into STRICT	nr_sequencia_compl_w
			from	compl_pessoa_fisica
			where	cd_pessoa_fisica = cd_pessoa_fisica_p;
		
			insert into compl_pessoa_fisica(nr_sequencia, dt_atualizacao, nm_usuario,
				cd_pessoa_fisica, ie_tipo_complemento, nm_contato,
				dt_atualizacao_nrec, nm_usuario_nrec)
			values (nr_sequencia_compl_w, clock_timestamp(), nm_usuario_p,
				cd_pessoa_fisica_p, 5, pls_proposta_benef_online_w.nm_mae,
				clock_timestamp(), nm_usuario_p);
		end if;
		
		select	count(1)
		into STRICT	qt_compl_pai_w
		from	compl_pessoa_fisica
		where	cd_pessoa_fisica	= cd_pessoa_fisica_p
		and	ie_tipo_complemento	= 4;
		
		if (qt_compl_pai_w > 0) then
			update	compl_pessoa_fisica
			set	nm_contato		= coalesce(pls_proposta_benef_online_w.nm_pai, nm_contato),
				dt_atualizacao		= clock_timestamp(),
				nm_usuario		= nm_usuario_p
			where	cd_pessoa_fisica	= cd_pessoa_fisica_p
			and	ie_tipo_complemento	= 4;
		else
			select (coalesce(max(nr_sequencia),0)+1)
			into STRICT	nr_sequencia_compl_w
			from	compl_pessoa_fisica
			where	cd_pessoa_fisica = cd_pessoa_fisica_p;
		
			insert into compl_pessoa_fisica(nr_sequencia, dt_atualizacao, nm_usuario,
				cd_pessoa_fisica, ie_tipo_complemento, nm_contato,
				dt_atualizacao_nrec, nm_usuario_nrec)
			values (nr_sequencia_compl_w, clock_timestamp(), nm_usuario_p,
				cd_pessoa_fisica_p, 4, pls_proposta_benef_online_w.nm_pai,
				clock_timestamp(), nm_usuario_p);
		end if;
	elsif (ie_gerar_solic_alt_pf_w = 'S') then
		select	*
		into STRICT	pessoa_fisica_w
		from	pessoa_fisica
		where	cd_pessoa_fisica = cd_pessoa_fisica_p;
		
		--PESSOA FISICA

		if	((pls_proposta_benef_online_w.nm_pessoa_fisica IS NOT NULL AND pls_proposta_benef_online_w.nm_pessoa_fisica::text <> '') and
			((upper(pls_proposta_benef_online_w.nm_pessoa_fisica) <> upper(pessoa_fisica_w.nm_pessoa_fisica)) or (coalesce(pessoa_fisica_w.nm_pessoa_fisica::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(pessoa_fisica_w.nm_pessoa_fisica, pls_proposta_benef_online_w.nm_pessoa_fisica, 'NM_PESSOA_FISICA', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.dt_nascimento IS NOT NULL AND pls_proposta_benef_online_w.dt_nascimento::text <> '') and
			((pls_proposta_benef_online_w.dt_nascimento <> pessoa_fisica_w.dt_nascimento) or (coalesce(pessoa_fisica_w.dt_nascimento::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(pessoa_fisica_w.dt_nascimento, pls_proposta_benef_online_w.dt_nascimento, 'DT_NASCIMENTO', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.nr_cpf IS NOT NULL AND pls_proposta_benef_online_w.nr_cpf::text <> '') and
			((pls_proposta_benef_online_w.nr_cpf <> pessoa_fisica_w.nr_cpf) or (coalesce(pessoa_fisica_w.nr_cpf::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(pessoa_fisica_w.nr_cpf, pls_proposta_benef_online_w.nr_cpf, 'NR_CPF', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.ie_estado_civil IS NOT NULL AND pls_proposta_benef_online_w.ie_estado_civil::text <> '') and
			((pls_proposta_benef_online_w.ie_estado_civil <> pessoa_fisica_w.ie_estado_civil) or (coalesce(pessoa_fisica_w.ie_estado_civil::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(pessoa_fisica_w.ie_estado_civil, pls_proposta_benef_online_w.ie_estado_civil, 'IE_ESTADO_CIVIL', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.ie_sexo IS NOT NULL AND pls_proposta_benef_online_w.ie_sexo::text <> '') and
			((pls_proposta_benef_online_w.ie_sexo <> pessoa_fisica_w.ie_sexo) or (coalesce(pessoa_fisica_w.ie_sexo::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(pessoa_fisica_w.ie_sexo, pls_proposta_benef_online_w.ie_sexo, 'IE_SEXO', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.nr_identidade IS NOT NULL AND pls_proposta_benef_online_w.nr_identidade::text <> '') and
			((pls_proposta_benef_online_w.nr_identidade <> pessoa_fisica_w.nr_identidade) or (coalesce(pessoa_fisica_w.nr_identidade::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(pessoa_fisica_w.nr_identidade, pls_proposta_benef_online_w.nr_identidade, 'NR_IDENTIDADE', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.dt_emissao_ci IS NOT NULL AND pls_proposta_benef_online_w.dt_emissao_ci::text <> '') and
			((pls_proposta_benef_online_w.dt_emissao_ci <> pessoa_fisica_w.dt_emissao_ci) or (coalesce(pessoa_fisica_w.dt_emissao_ci::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(pessoa_fisica_w.dt_emissao_ci, pls_proposta_benef_online_w.dt_emissao_ci, 'DT_EMISSAO_CI', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.sg_emissora_ci IS NOT NULL AND pls_proposta_benef_online_w.sg_emissora_ci::text <> '') and
			((pls_proposta_benef_online_w.sg_emissora_ci <> pessoa_fisica_w.sg_emissora_ci) or (coalesce(pessoa_fisica_w.sg_emissora_ci::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(pessoa_fisica_w.sg_emissora_ci, pls_proposta_benef_online_w.sg_emissora_ci, 'SG_EMISSORA_CI', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.ds_orgao_emissor_ci IS NOT NULL AND pls_proposta_benef_online_w.ds_orgao_emissor_ci::text <> '') and
			((upper(pls_proposta_benef_online_w.ds_orgao_emissor_ci) <> upper(pessoa_fisica_w.ds_orgao_emissor_ci)) or (coalesce(pessoa_fisica_w.ds_orgao_emissor_ci::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(pessoa_fisica_w.ds_orgao_emissor_ci, pls_proposta_benef_online_w.ds_orgao_emissor_ci, 'DS_ORGAO_EMISSOR_CI', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.nr_telefone_celular IS NOT NULL AND pls_proposta_benef_online_w.nr_telefone_celular::text <> '') and
			((pls_proposta_benef_online_w.nr_telefone_celular <> pessoa_fisica_w.nr_telefone_celular) or (coalesce(pessoa_fisica_w.nr_telefone_celular::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(pessoa_fisica_w.nr_telefone_celular, pls_proposta_benef_online_w.nr_telefone_celular, 'NR_TELEFONE_CELULAR', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.nr_cartao_nac_sus IS NOT NULL AND pls_proposta_benef_online_w.nr_cartao_nac_sus::text <> '') and
			((pls_proposta_benef_online_w.nr_cartao_nac_sus <> pessoa_fisica_w.nr_cartao_nac_sus) or (coalesce(pessoa_fisica_w.nr_cartao_nac_sus::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(pessoa_fisica_w.nr_cartao_nac_sus, pls_proposta_benef_online_w.nr_cartao_nac_sus, 'NR_CARTAO_NAC_SUS', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.nr_ddd_celular IS NOT NULL AND pls_proposta_benef_online_w.nr_ddd_celular::text <> '') and
			((pls_proposta_benef_online_w.nr_ddd_celular <> pessoa_fisica_w.nr_ddd_celular) or (coalesce(pessoa_fisica_w.nr_ddd_celular::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(pessoa_fisica_w.nr_ddd_celular, pls_proposta_benef_online_w.nr_ddd_celular, 'NR_DDD_CELULAR', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.cd_municipio_ibge IS NOT NULL AND pls_proposta_benef_online_w.cd_municipio_ibge::text <> '') and
			((pls_proposta_benef_online_w.cd_municipio_ibge <> pessoa_fisica_w.cd_municipio_ibge) or (coalesce(pessoa_fisica_w.cd_municipio_ibge::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(pessoa_fisica_w.cd_municipio_ibge, pls_proposta_benef_online_w.cd_municipio_ibge, 'CD_MUNICIPIO_IBGE', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		CALL pls_tasy_gerar_solicitacao(cd_pessoa_fisica_p,'W');
		
		select	*
		into STRICT	compl_pessoa_fisica_w
		from	compl_pessoa_fisica
		where	ie_tipo_complemento = 1
		and	cd_pessoa_fisica = cd_pessoa_fisica_p;
		
		--COMPLEMENTO

		if	((pls_proposta_benef_online_w.nr_ddd_telefone IS NOT NULL AND pls_proposta_benef_online_w.nr_ddd_telefone::text <> '') and
			((pls_proposta_benef_online_w.nr_ddd_telefone <> compl_pessoa_fisica_w.nr_ddd_telefone) or (coalesce(compl_pessoa_fisica_w.nr_ddd_telefone::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(compl_pessoa_fisica_w.nr_ddd_telefone, pls_proposta_benef_online_w.nr_ddd_telefone, 'NR_DDD_TELEFONE', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.nr_ddi_telefone IS NOT NULL AND pls_proposta_benef_online_w.nr_ddi_telefone::text <> '') and
			((pls_proposta_benef_online_w.nr_ddi_telefone <> compl_pessoa_fisica_w.nr_ddi_telefone) or (coalesce(compl_pessoa_fisica_w.nr_ddi_telefone::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(compl_pessoa_fisica_w.nr_ddi_telefone, pls_proposta_benef_online_w.nr_ddi_telefone, 'NR_DDI_TELEFONE', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.nr_telefone IS NOT NULL AND pls_proposta_benef_online_w.nr_telefone::text <> '') and
			((pls_proposta_benef_online_w.nr_telefone <> compl_pessoa_fisica_w.nr_telefone) or (coalesce(compl_pessoa_fisica_w.nr_telefone::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(compl_pessoa_fisica_w.nr_telefone, pls_proposta_benef_online_w.nr_telefone, 'NR_TELEFONE', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.ds_bairro IS NOT NULL AND pls_proposta_benef_online_w.ds_bairro::text <> '') and
			((upper(pls_proposta_benef_online_w.ds_bairro) <> upper(compl_pessoa_fisica_w.ds_bairro)) or (coalesce(compl_pessoa_fisica_w.ds_bairro::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(compl_pessoa_fisica_w.ds_bairro, pls_proposta_benef_online_w.ds_bairro, 'DS_BAIRRO', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.cd_municipio_ibge IS NOT NULL AND pls_proposta_benef_online_w.cd_municipio_ibge::text <> '') and
			((pls_proposta_benef_online_w.cd_municipio_ibge <> compl_pessoa_fisica_w.cd_municipio_ibge) or (coalesce(compl_pessoa_fisica_w.cd_municipio_ibge::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(compl_pessoa_fisica_w.cd_municipio_ibge, pls_proposta_benef_online_w.cd_municipio_ibge, 'CD_MUNICIPIO_IBGE', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.sg_estado IS NOT NULL AND pls_proposta_benef_online_w.sg_estado::text <> '') and
			((pls_proposta_benef_online_w.sg_estado <> compl_pessoa_fisica_w.sg_estado) or (coalesce(compl_pessoa_fisica_w.sg_estado::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(compl_pessoa_fisica_w.sg_estado, pls_proposta_benef_online_w.sg_estado, 'SG_ESTADO', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.cd_cep IS NOT NULL AND pls_proposta_benef_online_w.cd_cep::text <> '') and
			((pls_proposta_benef_online_w.cd_cep <> compl_pessoa_fisica_w.cd_cep) or (coalesce(compl_pessoa_fisica_w.cd_cep::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(compl_pessoa_fisica_w.cd_cep, pls_proposta_benef_online_w.cd_cep, 'CD_CEP', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.ds_endereco IS NOT NULL AND pls_proposta_benef_online_w.ds_endereco::text <> '') and
			((upper(pls_proposta_benef_online_w.ds_endereco) <> upper(compl_pessoa_fisica_w.ds_endereco)) or (coalesce(compl_pessoa_fisica_w.ds_endereco::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(compl_pessoa_fisica_w.ds_endereco, pls_proposta_benef_online_w.ds_endereco, 'DS_ENDERECO', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.nr_endereco IS NOT NULL AND pls_proposta_benef_online_w.nr_endereco::text <> '') and
			((pls_proposta_benef_online_w.nr_endereco <> compl_pessoa_fisica_w.nr_endereco) or (coalesce(compl_pessoa_fisica_w.nr_endereco::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(compl_pessoa_fisica_w.nr_endereco, pls_proposta_benef_online_w.nr_endereco, 'NR_ENDERECO', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.ds_complemento IS NOT NULL AND pls_proposta_benef_online_w.ds_complemento::text <> '') and
			((upper(pls_proposta_benef_online_w.ds_complemento) <> upper(compl_pessoa_fisica_w.ds_complemento)) or (coalesce(compl_pessoa_fisica_w.ds_complemento::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(compl_pessoa_fisica_w.ds_complemento, pls_proposta_benef_online_w.ds_complemento, 'DS_COMPLEMENTO', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.ds_email IS NOT NULL AND pls_proposta_benef_online_w.ds_email::text <> '') and
			((upper(pls_proposta_benef_online_w.ds_email) <> upper(compl_pessoa_fisica_w.ds_email)) or (coalesce(compl_pessoa_fisica_w.ds_email::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(compl_pessoa_fisica_w.ds_email, pls_proposta_benef_online_w.ds_email, 'DS_EMAIL', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.nr_seq_pais IS NOT NULL AND pls_proposta_benef_online_w.nr_seq_pais::text <> '') and
			((pls_proposta_benef_online_w.nr_seq_pais <> compl_pessoa_fisica_w.nr_seq_pais) or (coalesce(compl_pessoa_fisica_w.nr_seq_pais::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(compl_pessoa_fisica_w.nr_seq_pais, pls_proposta_benef_online_w.nr_seq_pais, 'NR_SEQ_PAIS', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		if	((pls_proposta_benef_online_w.cd_profissao IS NOT NULL AND pls_proposta_benef_online_w.cd_profissao::text <> '') and
			((pls_proposta_benef_online_w.cd_profissao <> compl_pessoa_fisica_w.cd_profissao) or (coalesce(compl_pessoa_fisica_w.cd_profissao::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(compl_pessoa_fisica_w.cd_profissao, pls_proposta_benef_online_w.cd_profissao, 'CD_PROFISSAO', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		CALL pls_tasy_gerar_solic_compl(cd_pessoa_fisica_p,1,'W','HPMS_PROPOSAL_REQUEST_PCK.WSUITE_UPDATE_HOMONYM_BENEF');
		
		select	max(nm_contato)
		into STRICT	nm_mae_w
		from	compl_pessoa_fisica
		where	cd_pessoa_fisica	= cd_pessoa_fisica_p
		and	ie_tipo_complemento	= 5;
		
		--ENDERECO DA MAE

		if	((pls_proposta_benef_online_w.nm_mae IS NOT NULL AND pls_proposta_benef_online_w.nm_mae::text <> '') and
			((upper(pls_proposta_benef_online_w.nm_mae) <> upper(nm_mae_w)) or (coalesce(nm_mae_w::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(nm_mae_w, pls_proposta_benef_online_w.nm_mae, 'NM_CONTATO', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		CALL pls_tasy_gerar_solic_compl(cd_pessoa_fisica_p,5,'W','HPMS_PROPOSAL_REQUEST_PCK.WSUITE_UPDATE_HOMONYM_BENEF');
		
		select	max(nm_contato)
		into STRICT	nm_pai_w
		from	compl_pessoa_fisica
		where	cd_pessoa_fisica	= cd_pessoa_fisica_p
		and	ie_tipo_complemento	= 4;
		
		--ENDERECO DO PAI

		if	((pls_proposta_benef_online_w.nm_pai IS NOT NULL AND pls_proposta_benef_online_w.nm_pai::text <> '') and
			((upper(pls_proposta_benef_online_w.nm_pai) <> upper(nm_pai_w)) or (coalesce(nm_pai_w::text, '') = ''))) then
			CALL pls_gerar_solicitacao_alt(nm_pai_w, pls_proposta_benef_online_w.nm_pai, 'NM_CONTATO', cd_pessoa_fisica_p, cd_estabelecimento_w, nm_usuario_p);
		end if;
		
		CALL pls_tasy_gerar_solic_compl(cd_pessoa_fisica_p,4,'W','HPMS_PROPOSAL_REQUEST_PCK.WSUITE_UPDATE_HOMONYM_BENEF');
	end if;
end if;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE hpms_proposal_request_pck.alterar_dados_pf ( cd_pessoa_fisica_p pessoa_fisica.cd_pessoa_fisica%type, nm_usuario_p usuario.nm_usuario%type) FROM PUBLIC;
