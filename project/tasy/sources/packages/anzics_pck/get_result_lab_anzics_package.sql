-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION anzics_pck.get_result_lab_anzics ( nr_atendimento_p bigint, nr_seq_atepacu_p bigint, ie_opcao_p text, ie_tipo_exame_p text) RETURNS bigint AS $body$
DECLARE

    qt_exam_result_w          double precision;
    nr_seq_sodium_w           bigint;
    nr_seq_urea_w             bigint;
    nr_seq_bicabonate_w       bigint;
    nr_seq_albumin_w          bigint;
    nr_seq_lactate_w          bigint;
    nr_seq_hematocrit_w       bigint;
    nr_seq_white_blood_cell_w bigint;
    nr_seq_potassium_w        bigint;
    nr_seq_creatinine_w       bigint;
    nr_seq_glucose_w          bigint;
    nr_seq_billirubin_w       bigint;
    nr_seq_hemoglobin_w       bigint;
    nr_seq_platlet_w          bigint;
    nr_seq_urine_output_w     bigint;
    nr_seq_exam_w             bigint;

BEGIN
    BEGIN
      SELECT nr_seq_sodium ,
        nr_seq_urea,
        nr_seq_bicabonate,
        nr_seq_albumin,
        nr_seq_lactate,
        nr_seq_hematocrit,
        nr_seq_white_blood_cell,
        nr_seq_potassium,
        nr_seq_creatinine,
        nr_seq_glucose,
        nr_seq_billirubin,
        nr_seq_hemoglobin,
        nr_seq_platlet,
        nr_seq_urine_output
      INTO STRICT nr_seq_sodium_w ,
        nr_seq_urea_w ,
        nr_seq_bicabonate_w,
        nr_seq_albumin_w,
        nr_seq_lactate_w ,
        nr_seq_hematocrit_w ,
        nr_seq_white_blood_cell_w ,
        nr_seq_potassium_w ,
        nr_seq_creatinine_w,
        nr_seq_glucose_w ,
        nr_seq_billirubin_w ,
        nr_seq_hemoglobin_w,
        nr_seq_platlet_w ,
        nr_seq_urine_output_w
      FROM anzics_parameter
      WHERE cd_estabelecimento = wheb_usuario_pck.get_cd_estabelecimento;
    EXCEPTION
    WHEN OTHERS THEN
      NULL;
    END;
    IF (ie_tipo_exame_p    = 'NA') THEN
      nr_seq_exam_w       := nr_seq_sodium_w;
    elsif (ie_tipo_exame_p = 'K') THEN
      nr_seq_exam_w       := nr_seq_potassium_w;
    elsif (ie_tipo_exame_p = 'HCO3') THEN
      nr_seq_exam_w       := nr_seq_bicabonate_w;
    elsif (ie_tipo_exame_p = 'CREAT') THEN
      nr_seq_exam_w       := nr_seq_creatinine_w;
    elsif (ie_tipo_exame_p = 'UREA') THEN
      nr_seq_exam_w       := nr_seq_urea_w;
    elsif (ie_tipo_exame_p = 'ALBUM') THEN
      nr_seq_exam_w       := nr_seq_albumin_w;
    elsif (ie_tipo_exame_p = 'BILI') THEN
      nr_seq_exam_w       := nr_seq_billirubin_w;
    elsif (ie_tipo_exame_p = 'GLUC') THEN
      nr_seq_exam_w       := nr_seq_glucose_w;
    elsif (ie_tipo_exame_p = 'HCT') THEN
      nr_seq_exam_w       := nr_seq_hematocrit_w;
    elsif (ie_tipo_exame_p = 'WCC') THEN
      nr_seq_exam_w       := nr_seq_white_blood_cell_w;
    elsif (ie_tipo_exame_p = 'HMGN') THEN
      nr_seq_exam_w       := nr_seq_hemoglobin_w;
    elsif (ie_tipo_exame_p = 'PLAT') THEN
      nr_seq_exam_w       := nr_seq_platlet_w;
    elsif (ie_tipo_exame_p = 'LACTATE') THEN
      nr_seq_exam_w       := nr_seq_lactate_w;
    END IF;
    IF (ie_tipo_exame_p   = 'URINE') THEN
      qt_exam_result_w   := anzics_pck.get_urine24h(nr_atendimento_p,nr_seq_atepacu_p,nr_seq_urine_output_w);
    elsif (nr_seq_exam_w IS NOT NULL AND nr_seq_exam_w::text <> '') THEN
      qt_exam_result_w   := anzics_pck.get_result_lab(nr_atendimento_p,nr_seq_atepacu_p,nr_seq_exam_w,ie_opcao_p);
    END IF;
    RETURN qt_exam_result_w;
  END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION anzics_pck.get_result_lab_anzics ( nr_atendimento_p bigint, nr_seq_atepacu_p bigint, ie_opcao_p text, ie_tipo_exame_p text) FROM PUBLIC;
