-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION anzics_pck.obter_apache_score_anzics_ph ( qt_ph_p bigint, qt_paco2 bigint DEFAULT NULL, ie_apache_type text DEFAULT 'II') RETURNS bigint AS $body$
DECLARE

    nr_apache_score_w smallint := NULL;

BEGIN
    IF (ie_apache_type = 'II') THEN
      BEGIN
        IF (qt_ph_p IS NOT NULL AND qt_ph_p::text <> '') THEN
          IF (qt_ph_p          < 7.15) THEN
            nr_apache_score_w := 4;
          elsif (qt_ph_p      >= 7.15 AND qt_ph_p <= 7.24) THEN
            nr_apache_score_w := 3;
          elsif (qt_ph_p      >= 7.25 AND qt_ph_p <= 7.32) THEN
            nr_apache_score_w := 2;
          elsif (qt_ph_p      >= 7.33 AND qt_ph_p <= 7.49) THEN
            nr_apache_score_w := 0;
          elsif (qt_ph_p      >= 7.50 AND qt_ph_p <= 7.59) THEN
            nr_apache_score_w := 1;
          elsif (qt_ph_p      >= 7.60 AND qt_ph_p <= 7.69) THEN
            nr_apache_score_w := 3;
          elsif (qt_ph_p      >= 7.70) THEN
            nr_apache_score_w := 4;
          ELSE
            nr_apache_score_w := NULL;
          END IF;
        END IF;
      END;
    ELSE
      BEGIN
        IF((qt_ph_p         >= 7.30 AND qt_ph_p < 7.45 AND qt_paco2 >= 30 AND qt_paco2 <45) OR (qt_ph_p >= 7.45 AND qt_ph_p < 7.50 AND qt_paco2 >= 30 AND qt_paco2 <35) OR (qt_ph_p >= 7.60 AND qt_paco2 <=25)) THEN
          nr_apache_score_w := 0;
        elsif (qt_ph_p      >= 7.30 AND qt_ph_p < 7.45 AND qt_paco2 >= 30 AND qt_paco2 <45) THEN
          nr_apache_score_w := 1;
        elsif((qt_ph_p      >= 7.45 AND qt_ph_p < 7.50 AND qt_paco2 >= 35 AND qt_paco2 <45) OR (qt_ph_p >= 7.20 AND qt_ph_p < 7.30 AND qt_paco2 >= 50)) THEN
          nr_apache_score_w := 2;
        elsif((qt_ph_p      >= 7.20 AND qt_ph_p < 7.30 AND qt_paco2 >= 40 AND qt_paco2 <50) OR (qt_ph_p >= 7.50 AND qt_ph_p < 7.60 AND qt_paco2 <40) OR (qt_ph_p >= 7.60 AND qt_paco2 > 25 AND qt_paco2 < 40)) THEN
          nr_apache_score_w := 3;
        elsif (qt_ph_p        < 7.20 AND qt_paco2 >= 50) THEN
          nr_apache_score_w := 4;
        elsif (qt_ph_p        < 7.35 AND qt_ph_p < 7.50 AND qt_paco2 <= 30) THEN
          nr_apache_score_w := 5;
        elsif (qt_ph_p       >= 7.20 AND qt_ph_p < 7.30 AND qt_paco2 >= 30 AND qt_paco2 <40) THEN
          nr_apache_score_w := 6;
        elsif (qt_ph_p       >= 7.20 AND qt_ph_p < 7.35 AND qt_paco2 < 30 ) THEN
          nr_apache_score_w := 9;
        elsif((qt_ph_p       < 7.20 AND qt_paco2 <50) OR (qt_ph_p >= 7.50 AND qt_paco2 >= 40) OR (qt_ph_p >= 7.45 AND qt_ph_p < 7.50 AND qt_paco2 > 45)) THEN
          nr_apache_score_w := 12;
        ELSE
          nr_apache_score_w := NULL;
        END IF;
      END;
    END IF;
    RETURN nr_apache_score_w;
  END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION anzics_pck.obter_apache_score_anzics_ph ( qt_ph_p bigint, qt_paco2 bigint DEFAULT NULL, ie_apache_type text DEFAULT 'II') FROM PUBLIC;
