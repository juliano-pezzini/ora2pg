-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

 
-- Obtem o Ãºltimo valor vigente do material 
CREATE OR REPLACE FUNCTION ptu_gerar_tabela_a1200_pck.obter_preco_material ( nr_seq_preco_item_p pls_material_preco_item.nr_sequencia%type) RETURNS PLS_MATERIAL_VALOR_ITEM.VL_MATERIAL%TYPE AS $body$
DECLARE

			 
vl_material_w	pls_material_valor_item.vl_material%type;


BEGIN 
 
select	max(vl_material) 
into STRICT	vl_material_w 
from	pls_material_valor_item 
where	nr_seq_preco_item = nr_seq_preco_item_p 
and	dt_inicio_vigencia = (	SELECT	max(dt_inicio_vigencia) 
				from	pls_material_valor_item 
				where	nr_seq_preco_item = nr_seq_preco_item_p 
				and	dt_inicio_vigencia < clock_timestamp());
 
return	vl_material_w;
 
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION ptu_gerar_tabela_a1200_pck.obter_preco_material ( nr_seq_preco_item_p pls_material_preco_item.nr_sequencia%type) FROM PUBLIC;
