-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION alto_custo_hiv_pck.get_situacao_clinica ( cd_pessoa_fisica_p text) RETURNS varchar AS $body$
DECLARE

    ds_retorno_w varchar(1) := '9';

BEGIN
    select coalesce(max(a.ie_sintomatico), 9)
    into STRICT ds_retorno_w
    from diagnostico_doenca a,
      cid_doenca b,
      atendimento_paciente c
    where b.cd_doenca_cid      = a.cd_doenca
    and c.nr_atendimento       = a.nr_atendimento
    and c.cd_pessoa_fisica     = cd_pessoa_fisica_p
    and b.ie_doenca_cronica_mx = 'HIV'
    and (a.dt_liberacao IS NOT NULL AND a.dt_liberacao::text <> '')
    and coalesce(a.dt_inativacao::text, '') = ''
    and (a.dt_inicio IS NOT NULL AND a.dt_inicio::text <> '')
    and coalesce(a.dt_fim::text, '') = '';
    return ds_retorno_w;
  END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION alto_custo_hiv_pck.get_situacao_clinica ( cd_pessoa_fisica_p text) FROM PUBLIC;
