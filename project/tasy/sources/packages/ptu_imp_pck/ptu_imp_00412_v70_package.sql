-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';


--------------------------------------------------------------------------------00412 Consulta de Dados do Beneficiario-------------------------------------------------------------------------------------------------------------------------------------------------------------



CREATE OR REPLACE PROCEDURE ptu_imp_pck.ptu_imp_00412_v70 ( cd_transacao_p ptu_consulta_beneficiario.cd_transacao%type, ie_tipo_cliente_p ptu_consulta_beneficiario.ie_tipo_cliente%type, cd_unimed_exec_p ptu_consulta_beneficiario.cd_unimed_executora%type, cd_unimed_benef_p ptu_consulta_beneficiario.cd_unimed_beneficiario%type, nr_transacao_prest_p ptu_consulta_beneficiario.nr_seq_execucao%type, cd_unimed_p ptu_consulta_beneficiario.cd_unimed%type, cd_usuario_plano_p ptu_consulta_beneficiario.cd_usuario_plano%type, dt_nascimento_p text, nm_beneficiario_p ptu_consulta_beneficiario.nm_beneficiario%type, nr_cpf_p ptu_consulta_beneficiario.nr_cpf%type, nr_cns_p ptu_consulta_beneficiario.nr_cns%type, nm_usuario_p ptu_consulta_beneficiario.nm_usuario%type, sobrenome_beneficiario_p ptu_consulta_beneficiario.sobrenome_beneficiario%type, nr_versao_p ptu_consulta_beneficiario.nr_versao%type, nr_seq_cons_dados_benef_p INOUT ptu_consulta_beneficiario.nr_sequencia%type) AS $body$
DECLARE


/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Finalidade: Realizar a importacao do arquivo 00413 - Consulta de Dados do Beneficiario do PTU
-------------------------------------------------------------------------------------------------------------------

Locais de chamada direta:
[  ]  Objetos do dicionario [ x] Tasy (Delphi/Java) [  x] Portal [  ]  Relatorios [ x] Outros:
 ------------------------------------------------------------------------------------------------------------------

Pontos de atencao:
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */


ie_tipo_cliente_w	ptu_pedido_insistencia.ie_tipo_cliente%type;
dt_nascimento_w		ptu_consulta_beneficiario.dt_nascimento%type;


BEGIN

if (coalesce(dt_nascimento_p,'X')	<> 'X') then
	dt_nascimento_w	:= to_date(dt_nascimento_p, 'dd/mm/rrrr');
end if;

ie_tipo_cliente_w := ptu_converter_tipo_cliente(ie_tipo_cliente_p);

insert into ptu_consulta_beneficiario(nr_sequencia, cd_transacao, cd_unimed_beneficiario,
	cd_unimed_executora, dt_atualizacao, dt_atualizacao_nrec,
	nm_usuario, nm_usuario_nrec, cd_usuario_plano,
	dt_nascimento, ie_tipo_cliente, nm_beneficiario,
	nr_seq_execucao, nr_versao, sobrenome_beneficiario,
	cd_unimed, nr_cpf, nr_cns)
values (	nextval('ptu_consulta_beneficiario_seq'), cd_transacao_p, cd_unimed_benef_p,
	cd_unimed_exec_p, clock_timestamp(), clock_timestamp(),
	nm_usuario_p, nm_usuario_p, lpad(cd_usuario_plano_p,13,'0'),
	dt_nascimento_w, ie_tipo_cliente_w, nm_beneficiario_p,
	nr_transacao_prest_p, nr_versao_p, sobrenome_beneficiario_p,
	cd_unimed_p, nr_cpf_p, nr_cns_p) returning nr_sequencia into nr_seq_cons_dados_benef_p;

commit;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ptu_imp_pck.ptu_imp_00412_v70 ( cd_transacao_p ptu_consulta_beneficiario.cd_transacao%type, ie_tipo_cliente_p ptu_consulta_beneficiario.ie_tipo_cliente%type, cd_unimed_exec_p ptu_consulta_beneficiario.cd_unimed_executora%type, cd_unimed_benef_p ptu_consulta_beneficiario.cd_unimed_beneficiario%type, nr_transacao_prest_p ptu_consulta_beneficiario.nr_seq_execucao%type, cd_unimed_p ptu_consulta_beneficiario.cd_unimed%type, cd_usuario_plano_p ptu_consulta_beneficiario.cd_usuario_plano%type, dt_nascimento_p text, nm_beneficiario_p ptu_consulta_beneficiario.nm_beneficiario%type, nr_cpf_p ptu_consulta_beneficiario.nr_cpf%type, nr_cns_p ptu_consulta_beneficiario.nr_cns%type, nm_usuario_p ptu_consulta_beneficiario.nm_usuario%type, sobrenome_beneficiario_p ptu_consulta_beneficiario.sobrenome_beneficiario%type, nr_versao_p ptu_consulta_beneficiario.nr_versao%type, nr_seq_cons_dados_benef_p INOUT ptu_consulta_beneficiario.nr_sequencia%type) FROM PUBLIC;
