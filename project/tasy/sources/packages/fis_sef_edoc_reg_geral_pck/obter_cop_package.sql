-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

/*FUNCTION*/

CREATE OR REPLACE FUNCTION fis_sef_edoc_reg_geral_pck.obter_cop ( cd_cfop_p text, ie_entrada_saida_p text) RETURNS varchar AS $body$
DECLARE


ds_retorno_w			varchar(255);


BEGIN

if (cd_cfop_p = 0000) then
	ds_retorno_w:= 'OP00';
end if;

if	((ie_entrada_saida_p = 'E') and (coalesce(ds_retorno_w::text, '') = '')) then
	begin

	if (cd_cfop_p in (	'1101', '1102', '1111', '1113', '1116', '1117', '1118', '1120', '1121', '1122',
				'1126', '1128', '1251', '1252', '1253', '1254', '1255', '1256', '1257', '1401',
				'1403', '1406', '1407', '1551', '1556', '1651', '1652', '1653', '1933', '2101',
				'2102', '2111', '2113', '2116', '2117', '2118', '2120', '2121', '2122', '2126',
				'2128', '2251', '2252', '2253', '2254', '2255', '2256', '2257', '2401', '2403',
				'2406', '2407', '2551', '2556', '2651', '2652', '2653', '2933', '3101', '3102',
				'3126', '3127', '3128', '3251', '3551', '3556', '3651', '3652', '3653')) then
		ds_retorno_w:= 'EA10';
	end if;

	if (cd_cfop_p in (	'1201', '1202', '1203', '1204', '1410', '1411', '1553', '1660', '1661', '1662',
				'2201', '2202', '2203', '2204', '2410', '2411', '2553', '2660', '2661', '2662',
				'3201', '3202', '3211', '3553') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'EA20';
	end if;

	if (cd_cfop_p in (	'1124', '1125', '1414', '1415', '1451', '1452', '1554', '1664', '1902', '1903',
				'1904', '1906', '1907', '1909', '1913', '1914', '1916', '1918', '1919', '1921',
				'1925', '2124', '2125', '2414', '2415', '2554', '2664', '2902', '2903', '2904',
				'2906', '2907', '2909', '2913', '2914', '2916', '2919', '2921', '2925') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'EA30';
	end if;

	if (cd_cfop_p in (	'1503', '1504', '1505', '1506', '2503', '2504', '2505', '2506', '2918', '3503') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'EA40';
	end if;

	if (cd_cfop_p in (	'1501', '1555', '1663', '1901', '1905', '1908', '1910', '1911', '1912', '1915',
				'1917', '1920', '1923', '1924', '1934', '2501', '2555', '2663', '2901', '2905',
				'2908', '2910', '2911', '2912', '2915', '2917', '2920', '2923', '2924', '2934',
				'3930') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'EA50';
	end if;

	if (cd_cfop_p in (	'1151', '1152', '1153', '1154', '1208', '1209', '1408', '1409', '1552', '1557',
				'1658', '1659', '2151', '2152', '2153', '2154', '2208', '2209', '2408', '2409',
				'2552', '2557', '2658', '2659') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'EA60';
	end if;

	if (cd_cfop_p in (	'1926') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'EA65';
	end if;

	if (cd_cfop_p in (	'1301', '1302', '1303', '1304', '1305', '1306', '1351', '1352', '1353', '1354',
				'1355', '1356', '1360', '1932', '2301', '2302', '2303', '2304', '2305', '2306',
				'2351', '2352', '2353', '2354', '2355', '2356', '2932', '3301', '3351', '3352',
				'3353', '3354', '3355', '3356') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'EA70';
	end if;

	if (cd_cfop_p in (	'1205', '1206', '1207', '2205', '2206', '2207', '3205', '3206', '3207') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'EA80';
	end if;

	if (cd_cfop_p in (	'1601', '1602', '1604', '1605', '1922', '1931', '2922', '2931') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'EA90';
	end if;

	if (cd_cfop_p in (	'1603', '2603') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'EA91';
	end if;

	if (cd_cfop_p in (	'1949', '2949', '3949') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'EA99';
	end if;

	end;
elsif (ie_entrada_saida_p = 'S') then
	begin

	if (cd_cfop_p in (	'5101', '5102', '5103', '5104', '5105', '5106', '5109', '5110', '5111', '5112',
				'5113', '5114', '5115', '5116', '5117', '5118', '5119', '5120', '5122', '5123',
				'5251', '5252', '5253', '5254', '5255', '5256', '5257', '5258', '5401', '5402',
				'5403', '5405', '5551', '5651', '5652', '5653', '5654', '5655', '5656', '5667',
				'5933', '6101', '6102', '6103', '6104', '6105', '6106', '6107', '6108', '6109',
				'6110', '6111', '6112', '6113', '6114', '6115', '6116', '6117', '6118', '6119',
				'6120', '6122', '6123', '6251', '6252', '6253', '6254', '6255', '6256', '6257',
				'6258', '6401', '6402', '6403', '6404', '6551', '6651', '6652', '6653', '6654',
				'6655', '6656', '6667', '6933', '7101', '7102', '7105', '7106', '7127', '7251',
				'7501', '7551', '7651', '7654', '7667') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'SP10';
	end if;

	if (cd_cfop_p in (	'5201', '5202', '5210', '5410', '5411', '5412', '5413', '5553', '5556', '5660',
				'5661', '5662', '6201', '6202', '6210', '6410', '6411', '6412', '6413', '6553',
				'6556', '6660', '6661', '6662', '7201', '7202', '7210', '7211', '7553', '7556',
				'7930') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'SP20';
	end if;

	if (cd_cfop_p in (	'5414', '5415', '5451', '5501', '5502', '5504', '5505', '5554', '5657', '5663',
				'5666', '5901', '5904', '5905', '5908', '5910', '5911', '5912', '5914', '5915',
				'5917', '5920', '5923', '5924', '5934', '6414', '6415', '6501', '6502', '6504',
				'6505', '6554', '6657', '6663', '6666', '6901', '6904', '6905', '6908', '6910',
				'6911', '6912', '6914', '6915', '6917', '6920', '6923', '6924', '6934') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'SP30';
	end if;

	if (cd_cfop_p in (	'5124', '5125', '5503', '5555', '5664', '5665', '5902', '5903', '5906', '5907',
				'5909', '5913', '5916', '5918', '5919', '5921', '5925', '6124', '6125', '6208',
				'6209', '6503', '6555', '6664', '6665', '6902', '6903', '6906', '6907', '6909',
				'6913', '6916', '6918', '6919', '6921', '6925') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'SP50';
	end if;

	if (cd_cfop_p in (	'5151', '5152', '5153', '5155', '5156', '5208', '5209', '5408', '5409', '5552',
				'5557', '5658', '5659', '6151', '6152', '6153', '6155', '6156', '6408', '6409',
				'6552', '6557', '6658', '6659') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'SP60';
	end if;

	if (cd_cfop_p in (	'5926', '5927', '5928') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'SP65';
	end if;

	if (cd_cfop_p in (	'5301', '5302', '5303', '5304', '5305', '5306', '5307', '5351', '5352', '5353',
				'5354', '5355', '5356', '5357', '5359', '5360', '5932', '6301', '6302', '6303',
				'6304', '6305', '6306', '6307', '6351', '6352', '6353', '6354', '6355', '6356',
				'6357', '6359', '6360', '6932', '7301', '7358') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'SP70';
	end if;

	if (cd_cfop_p in (	'5205', '5206', '5207', '6205', '6206', '6207', '7205', '7206', '7207') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'SP80';
	end if;

	if (cd_cfop_p in (	'1301', '1302', '1303', '1304', '1305', '1306', '1351', '1352', '1353', '1354',
				'1355', '1356', '1360', '1932', '2301', '2302', '2303', '2304', '2305', '2306',
				'2351', '2352', '2353', '2354', '2355', '2356', '2932', '3301', '3351', '3352',
				'3353', '3354', '3355', '3356') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'EA70';
	end if;

	if (cd_cfop_p in (	'5601', '5602', '5605', '5606', '5922', '5929', '5931', '6922', '6929', '6931') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'SP90';
	end if;

	if (cd_cfop_p in (	'5603', '6603') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'SP91';
	end if;

	if (cd_cfop_p in (	'5949', '6949', '7949') and coalesce(ds_retorno_w::text, '') = '') then
		ds_retorno_w:= 'SP99';
	end if;

	end;
end if;


return	ds_retorno_w;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION fis_sef_edoc_reg_geral_pck.obter_cop ( cd_cfop_p text, ie_entrada_saida_p text) FROM PUBLIC;
