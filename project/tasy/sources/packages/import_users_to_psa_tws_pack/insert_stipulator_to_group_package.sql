-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE import_users_to_psa_tws_pack.insert_stipulator_to_group ( pls_estipulante_web_p pls_estipulante_web_row) AS $body$
DECLARE


nr_seq_grupo_contrato_web_w	pls_grupo_contrato_web.nr_sequencia%type;
	

BEGIN

insert into pls_grupo_contrato_web(	nr_sequencia, nm_usuario_web, ds_senha,
					ie_situacao, dt_atualizacao, nm_usuario,                     
					dt_atualizacao_nrec, nm_usuario_nrec, nr_seq_grupo_contrato,          
					cd_estabelecimento, cd_pessoa_fisica, ie_origem_grupo_web,              
					nr_seq_perfil_web, ds_email, ds_tec)  

			values (	nextval('pls_grupo_contrato_web_seq'), pls_estipulante_web_p.nm_usuario_web, pls_estipulante_web_p.ds_senha,
					pls_estipulante_web_p.ie_situacao, clock_timestamp(), 'stipulator',
					clock_timestamp(), 'stipulator', null,
					pls_estipulante_web_p.cd_estabelecimento, pls_estipulante_web_p.cd_pessoa_fisica, CASE WHEN coalesce(pls_estipulante_web_p.nr_seq_contrato_int::text, '') = '' THEN 1  ELSE 2 END ,																
					pls_estipulante_web_p.nr_seq_perfil_web, pls_estipulante_web_p.ds_email, pls_estipulante_web_p.ds_tec) returning nr_sequencia INTO nr_seq_grupo_contrato_web_w;
					
insert into pls_contrato_web(	nr_sequencia, ie_situacao, nr_seq_usuario_grupo,
					dt_atualizacao, nm_usuario, dt_atualizacao_nrec,    
					nm_usuario_nrec, nr_seq_contrato, nr_seq_intercambio,     
					nr_seq_subestipulante)
			values (	nextval('pls_contrato_web_seq'), pls_estipulante_web_p.ie_situacao, nr_seq_grupo_contrato_web_w,	
					clock_timestamp(), 'stipulator', clock_timestamp(),
					'stipulator', pls_estipulante_web_p.nr_seq_contrato, pls_estipulante_web_p.nr_seq_contrato_int,
					pls_estipulante_web_p.nr_seq_subestipulante);

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE import_users_to_psa_tws_pack.insert_stipulator_to_group ( pls_estipulante_web_p pls_estipulante_web_row) FROM PUBLIC;
