-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE ptu_aviso_imp_pck.inserir_a520_guias ( nr_sequencia_p INOUT ptu_aviso_conta.nr_sequencia%type, nm_usuario_p ptu_aviso_conta.nm_usuario%type, nr_seq_aviso_protocolo_p ptu_aviso_conta.nr_seq_aviso_protocolo%type, nr_seq_conta_p ptu_aviso_conta.nr_seq_conta%type, nr_seq_segurado_p ptu_aviso_conta.nr_seq_segurado%type, nr_guia_principal_p ptu_aviso_conta.nr_guia_principal%type, nr_guia_operadora_p ptu_aviso_conta.nr_guia_operadora%type, nr_guia_prestador_p ptu_aviso_conta.nr_guia_prestador%type, cd_registro_ans_p ptu_aviso_conta.cd_registro_ans%type, dt_autorizacao_p text, cd_senha_p ptu_aviso_conta.cd_senha%type, dt_validade_senha_p text, nr_carteira_benef_p ptu_aviso_conta.nr_carteira_benef%type, ie_atendimento_rn_p ptu_aviso_conta.ie_atendimento_rn%type, nm_beneficiario_p ptu_aviso_conta.nm_beneficiario%type, nr_cns_benef_p ptu_aviso_conta.nr_cns_benef%type, ie_ident_beneficiario_p ptu_aviso_conta.ie_ident_beneficiario%type, cd_prestador_solicitante_p ptu_aviso_conta.cd_prestador_solicitante%type, cd_cpf_solicitante_p ptu_aviso_conta.cd_cpf_solicitante%type, cd_cnpj_solicitante_p ptu_aviso_conta.cd_cnpj_solicitante%type, nm_profissional_solicitante_p ptu_aviso_conta.nm_profissional_solicitante%type, sg_conselho_solicitante_p ptu_aviso_conta.sg_conselho_solicitante%type, nr_conselho_solicitante_p ptu_aviso_conta.nr_conselho_solicitante%type, sg_uf_solicitante_p ptu_aviso_conta.sg_uf_solicitante%type, nr_cbo_solicitante_p ptu_aviso_conta.nr_cbo_solicitante%type, nm_solicitante_p ptu_aviso_conta.nm_solicitante%type, cd_cnes_solicitante_p ptu_aviso_conta.cd_cnes_solicitante%type, dt_solicitacao_p text, ie_carater_atendimento_p ptu_aviso_conta.ie_carater_atendimento%type, ds_indicacao_clinica_p ptu_aviso_conta.ds_indicacao_clinica%type, cd_prestador_executante_p ptu_aviso_conta.cd_prestador_executante%type, cd_cpf_executante_p ptu_aviso_conta.cd_cpf_executante%type, cd_cnpj_executante_p ptu_aviso_conta.cd_cnpj_executante%type, nm_profissional_executante_p ptu_aviso_conta.nm_profissional_executante%type, sg_conselho_executante_p ptu_aviso_conta.sg_conselho_executante%type, nr_conselho_executante_p ptu_aviso_conta.nr_conselho_executante%type, sg_uf_executante_p ptu_aviso_conta.sg_uf_executante%type, nr_cbo_executante_p ptu_aviso_conta.nr_cbo_executante%type, nm_executante_p ptu_aviso_conta.nm_executante%type, cd_cnes_executante_p ptu_aviso_conta.cd_cnes_executante%type, ie_tipo_atendimento_p ptu_aviso_conta.ie_tipo_atendimento%type, ie_indicacao_acidente_p ptu_aviso_conta.ie_indicacao_acidente%type, ie_tipo_consulta_p ptu_aviso_conta.ie_tipo_consulta%type, ie_motivo_encerramento_p ptu_aviso_conta.ie_motivo_encerramento%type, ds_observacao_p ptu_aviso_conta.ds_observacao%type, vl_procedimento_p ptu_aviso_conta.vl_procedimento%type, vl_diaria_p ptu_aviso_conta.vl_diaria%type, vl_taxa_p ptu_aviso_conta.vl_taxa%type, vl_material_p ptu_aviso_conta.vl_material%type, vl_medicamento_p ptu_aviso_conta.vl_medicamento%type, vl_opme_p ptu_aviso_conta.vl_opme%type, vl_gases_p ptu_aviso_conta.vl_gases%type, vl_total_geral_p ptu_aviso_conta.vl_total_geral%type, ie_tipo_faturamento_p ptu_aviso_conta.ie_tipo_faturamento%type, dt_inicio_faturamento_p text, dt_fim_faturamento_p text, hr_inicio_faturamento_p ptu_aviso_conta.hr_inicio_faturamento%type, hr_fim_faturamento_p ptu_aviso_conta.hr_fim_faturamento%type, ie_tipo_internacao_p ptu_aviso_conta.ie_tipo_internacao%type, ie_regime_internacao_p ptu_aviso_conta.ie_regime_internacao%type, ds_diagnostico_p ptu_aviso_conta.ds_diagnostico%type, dt_atendimento_ref_p text) AS $body$
DECLARE

/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Finalidade:	Insere os dados do A520 e devolve a chave primaria gerada
-------------------------------------------------------------------------------------------------------------------
Locais de chamada direta: 
[ ]  Objetos do dicionario [X] Tasy (Delphi/Java) [ X] Portal [ X]  Relatorios [ ] Outros:
-------------------------------------------------------------------------------------------------------------------
Pontos de atencao:

Alteracoes:
-------------------------------------------------------------------------------------------------------------------
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
dt_inicio_faturamento_w	ptu_aviso_conta.dt_inicio_faturamento%type;
dt_fim_faturamento_w	ptu_aviso_conta.dt_fim_faturamento%type;
hr_inicio_faturamento_w	ptu_aviso_conta.hr_inicio_faturamento%type;
hr_fim_faturamento_w	ptu_aviso_conta.hr_fim_faturamento%type;
dt_atendimento_ref_w	ptu_aviso_conta.dt_atendimento_ref%type;
dt_autorizacao_w	ptu_aviso_conta.dt_autorizacao%type;
dt_validade_senha_w	ptu_aviso_conta.dt_validade_senha%type;
dt_solicitacao_w	ptu_aviso_conta.dt_solicitacao%type;
nr_carteira_benef_w	ptu_aviso_conta.nr_carteira_benef%type := nr_carteira_benef_p;
qt_registro_w		integer;


BEGIN
-- tratativa das datas
dt_inicio_faturamento_w	:= ptu_aviso_imp_pck.converte_data(dt_inicio_faturamento_p);
dt_fim_faturamento_w	:= ptu_aviso_imp_pck.converte_data(dt_fim_faturamento_p);
hr_inicio_faturamento_w	:= ptu_aviso_imp_pck.concatena_data_hora(dt_inicio_faturamento_p, hr_inicio_faturamento_p);
hr_fim_faturamento_w	:= ptu_aviso_imp_pck.concatena_data_hora(dt_fim_faturamento_p, hr_fim_faturamento_p);
dt_autorizacao_w	:= ptu_aviso_imp_pck.converte_data(dt_autorizacao_p);
dt_validade_senha_w	:= ptu_aviso_imp_pck.converte_data(dt_validade_senha_p);
dt_solicitacao_w	:= ptu_aviso_imp_pck.converte_data(dt_solicitacao_p);
dt_atendimento_ref_w	:= ptu_aviso_imp_pck.converte_data(dt_atendimento_ref_p);

-- A quantidade de numeros da carteira Unimed e sempre 17
if (length(nr_carteira_benef_w) < 17) then
	nr_carteira_benef_w := lpad(nr_carteira_benef_w,17,'0');
end if;

insert into ptu_aviso_conta(	nr_sequencia,
				dt_atualizacao,
				nm_usuario,
				dt_atualizacao_nrec,
				nm_usuario_nrec,
				nr_seq_aviso_protocolo,
				nr_seq_conta,
				nr_seq_segurado,
				nr_guia_principal,
				nr_guia_operadora,
				nr_guia_prestador,
				cd_registro_ans,
				dt_autorizacao,
				cd_senha,
				dt_validade_senha,
				nr_carteira_benef,
				ie_atendimento_rn,
				nm_beneficiario,
				nr_cns_benef,
				ie_ident_beneficiario,
				cd_prestador_solicitante,
				cd_cpf_solicitante,
				cd_cnpj_solicitante,
				nm_profissional_solicitante,
				sg_conselho_solicitante,
				nr_conselho_solicitante,
				sg_uf_solicitante,
				nr_cbo_solicitante,
				nm_solicitante,
				cd_cnes_solicitante,
				dt_solicitacao,
				ie_carater_atendimento,
				ds_indicacao_clinica,
				cd_prestador_executante,
				cd_cpf_executante,
				cd_cnpj_executante,
				nm_profissional_executante,
				sg_conselho_executante,
				nr_conselho_executante,
				sg_uf_executante,
				nr_cbo_executante,
				nm_executante,
				cd_cnes_executante,
				ie_tipo_atendimento,
				ie_indicacao_acidente,
				ie_tipo_consulta,
				ie_motivo_encerramento,
				ds_observacao,
				vl_procedimento,
				vl_diaria,
				vl_taxa,
				vl_material,
				vl_medicamento,
				vl_opme,
				vl_gases,
				vl_total_geral,
				ie_tipo_faturamento,
				dt_inicio_faturamento,
				dt_fim_faturamento,
				hr_inicio_faturamento,
				hr_fim_faturamento,
				ie_tipo_internacao,
				ie_regime_internacao,
				ds_diagnostico,
				dt_atendimento_ref)
values (nextval('ptu_aviso_conta_seq'),
	clock_timestamp(),
	nm_usuario_p,
	clock_timestamp(),
	nm_usuario_p,
	nr_seq_aviso_protocolo_p,
	nr_seq_conta_p,
	nr_seq_segurado_p,
	nr_guia_principal_p,
	nr_guia_operadora_p,
	nr_guia_prestador_p,
	cd_registro_ans_p,
	dt_autorizacao_w,
	cd_senha_p,
	dt_validade_senha_w,
	nr_carteira_benef_w,
	ie_atendimento_rn_p,
	nm_beneficiario_p,
	nr_cns_benef_p,
	ie_ident_beneficiario_p,
	cd_prestador_solicitante_p,
	cd_cpf_solicitante_p,
	cd_cnpj_solicitante_p,
	nm_profissional_solicitante_p,
	sg_conselho_solicitante_p,
	nr_conselho_solicitante_p,
	sg_uf_solicitante_p,
	nr_cbo_solicitante_p,
	nm_solicitante_p,
	cd_cnes_solicitante_p,
	dt_solicitacao_w,
	ie_carater_atendimento_p,
	ds_indicacao_clinica_p,
	cd_prestador_executante_p,
	cd_cpf_executante_p,
	cd_cnpj_executante_p,
	nm_profissional_executante_p,
	sg_conselho_executante_p,
	nr_conselho_executante_p,
	sg_uf_executante_p,
	nr_cbo_executante_p,
	nm_executante_p,
	cd_cnes_executante_p,
	ie_tipo_atendimento_p,
	ie_indicacao_acidente_p,
	ie_tipo_consulta_p,
	ie_motivo_encerramento_p,
	ds_observacao_p,
	vl_procedimento_p,
	vl_diaria_p,
	vl_taxa_p,
	vl_material_p,
	vl_medicamento_p,
	vl_opme_p,
	vl_gases_p,
	vl_total_geral_p,
	ie_tipo_faturamento_p,
	dt_inicio_faturamento_w,
	dt_fim_faturamento_w,
	hr_inicio_faturamento_w,
	hr_fim_faturamento_w,
	ie_tipo_internacao_p,
	ie_regime_internacao_p,
	ds_diagnostico_p,
	dt_atendimento_ref_w) returning nr_sequencia into nr_sequencia_p;

commit;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ptu_aviso_imp_pck.inserir_a520_guias ( nr_sequencia_p INOUT ptu_aviso_conta.nr_sequencia%type, nm_usuario_p ptu_aviso_conta.nm_usuario%type, nr_seq_aviso_protocolo_p ptu_aviso_conta.nr_seq_aviso_protocolo%type, nr_seq_conta_p ptu_aviso_conta.nr_seq_conta%type, nr_seq_segurado_p ptu_aviso_conta.nr_seq_segurado%type, nr_guia_principal_p ptu_aviso_conta.nr_guia_principal%type, nr_guia_operadora_p ptu_aviso_conta.nr_guia_operadora%type, nr_guia_prestador_p ptu_aviso_conta.nr_guia_prestador%type, cd_registro_ans_p ptu_aviso_conta.cd_registro_ans%type, dt_autorizacao_p text, cd_senha_p ptu_aviso_conta.cd_senha%type, dt_validade_senha_p text, nr_carteira_benef_p ptu_aviso_conta.nr_carteira_benef%type, ie_atendimento_rn_p ptu_aviso_conta.ie_atendimento_rn%type, nm_beneficiario_p ptu_aviso_conta.nm_beneficiario%type, nr_cns_benef_p ptu_aviso_conta.nr_cns_benef%type, ie_ident_beneficiario_p ptu_aviso_conta.ie_ident_beneficiario%type, cd_prestador_solicitante_p ptu_aviso_conta.cd_prestador_solicitante%type, cd_cpf_solicitante_p ptu_aviso_conta.cd_cpf_solicitante%type, cd_cnpj_solicitante_p ptu_aviso_conta.cd_cnpj_solicitante%type, nm_profissional_solicitante_p ptu_aviso_conta.nm_profissional_solicitante%type, sg_conselho_solicitante_p ptu_aviso_conta.sg_conselho_solicitante%type, nr_conselho_solicitante_p ptu_aviso_conta.nr_conselho_solicitante%type, sg_uf_solicitante_p ptu_aviso_conta.sg_uf_solicitante%type, nr_cbo_solicitante_p ptu_aviso_conta.nr_cbo_solicitante%type, nm_solicitante_p ptu_aviso_conta.nm_solicitante%type, cd_cnes_solicitante_p ptu_aviso_conta.cd_cnes_solicitante%type, dt_solicitacao_p text, ie_carater_atendimento_p ptu_aviso_conta.ie_carater_atendimento%type, ds_indicacao_clinica_p ptu_aviso_conta.ds_indicacao_clinica%type, cd_prestador_executante_p ptu_aviso_conta.cd_prestador_executante%type, cd_cpf_executante_p ptu_aviso_conta.cd_cpf_executante%type, cd_cnpj_executante_p ptu_aviso_conta.cd_cnpj_executante%type, nm_profissional_executante_p ptu_aviso_conta.nm_profissional_executante%type, sg_conselho_executante_p ptu_aviso_conta.sg_conselho_executante%type, nr_conselho_executante_p ptu_aviso_conta.nr_conselho_executante%type, sg_uf_executante_p ptu_aviso_conta.sg_uf_executante%type, nr_cbo_executante_p ptu_aviso_conta.nr_cbo_executante%type, nm_executante_p ptu_aviso_conta.nm_executante%type, cd_cnes_executante_p ptu_aviso_conta.cd_cnes_executante%type, ie_tipo_atendimento_p ptu_aviso_conta.ie_tipo_atendimento%type, ie_indicacao_acidente_p ptu_aviso_conta.ie_indicacao_acidente%type, ie_tipo_consulta_p ptu_aviso_conta.ie_tipo_consulta%type, ie_motivo_encerramento_p ptu_aviso_conta.ie_motivo_encerramento%type, ds_observacao_p ptu_aviso_conta.ds_observacao%type, vl_procedimento_p ptu_aviso_conta.vl_procedimento%type, vl_diaria_p ptu_aviso_conta.vl_diaria%type, vl_taxa_p ptu_aviso_conta.vl_taxa%type, vl_material_p ptu_aviso_conta.vl_material%type, vl_medicamento_p ptu_aviso_conta.vl_medicamento%type, vl_opme_p ptu_aviso_conta.vl_opme%type, vl_gases_p ptu_aviso_conta.vl_gases%type, vl_total_geral_p ptu_aviso_conta.vl_total_geral%type, ie_tipo_faturamento_p ptu_aviso_conta.ie_tipo_faturamento%type, dt_inicio_faturamento_p text, dt_fim_faturamento_p text, hr_inicio_faturamento_p ptu_aviso_conta.hr_inicio_faturamento%type, hr_fim_faturamento_p ptu_aviso_conta.hr_fim_faturamento%type, ie_tipo_internacao_p ptu_aviso_conta.ie_tipo_internacao%type, ie_regime_internacao_p ptu_aviso_conta.ie_regime_internacao%type, ds_diagnostico_p ptu_aviso_conta.ds_diagnostico%type, dt_atendimento_ref_p text) FROM PUBLIC;
