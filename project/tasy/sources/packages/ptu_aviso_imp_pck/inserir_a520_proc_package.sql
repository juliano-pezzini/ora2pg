-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE ptu_aviso_imp_pck.inserir_a520_proc ( nr_sequencia_p INOUT ptu_aviso_procedimento.nr_sequencia%type, nm_usuario_p ptu_aviso_procedimento.nm_usuario%type, nr_seq_aviso_conta_p ptu_aviso_procedimento.nr_seq_aviso_conta%type, nr_seq_conta_proc_p ptu_aviso_procedimento.nr_seq_conta_proc%type, ie_origem_proced_p ptu_aviso_procedimento.ie_origem_proced%type, cd_procedimento_p ptu_aviso_procedimento.cd_procedimento%type, cd_despesa_p ptu_aviso_procedimento.cd_despesa%type, dt_execucao_p text, hr_inicial_p ptu_aviso_procedimento.hr_inicial%type, hr_final_p ptu_aviso_procedimento.hr_final%type, cd_tabela_p ptu_aviso_procedimento.cd_tabela%type, cd_proc_envio_p ptu_aviso_procedimento.cd_proc_envio%type, ds_procedimento_p ptu_aviso_procedimento.ds_procedimento%type, qt_executada_p ptu_aviso_procedimento.qt_executada%type, ie_via_acesso_p ptu_aviso_procedimento.ie_via_acesso%type, ie_tecnica_utilizada_p ptu_aviso_procedimento.ie_tecnica_utilizada%type, tx_reducao_acrescimo_p ptu_aviso_procedimento.tx_reducao_acrescimo%type, vl_unitario_p ptu_aviso_procedimento.vl_unitario%type, vl_total_p ptu_aviso_procedimento.vl_total%type, nr_seq_item_tiss_p ptu_aviso_procedimento.nr_seq_item_tiss%type) AS $body$
DECLARE

				
/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Finalidade:	Insere os dados do A520 e devolve a chave primaria gerada
-------------------------------------------------------------------------------------------------------------------
Locais de chamada direta: 
[ ]  Objetos do dicionario [X] Tasy (Delphi/Java) [ X] Portal [ X]  Relatorios [ ] Outros:
-------------------------------------------------------------------------------------------------------------------
Pontos de atencao:

Alteracoes:
-------------------------------------------------------------------------------------------------------------------
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
dt_execucao_w		ptu_aviso_procedimento.dt_execucao%type;
nr_seq_regra_w		varchar(255);
ie_ato_cooperado_w	varchar(255);
nr_seq_grupo_ans_w	bigint	:= null;


BEGIN

dt_execucao_w	:= ptu_aviso_imp_pck.converte_data(dt_execucao_p);

pls_obter_tipo_ato_coop_a520(nr_seq_aviso_conta_p, 'P', cd_proc_envio_p, null, cd_tabela_p, nr_seq_regra_w, ie_ato_cooperado_w);

nr_seq_grupo_ans_w	:= pls_obter_grupo_ans_a520(nr_seq_aviso_conta_p, 'P', cd_proc_envio_p, null, cd_tabela_p);

insert into ptu_aviso_procedimento(	nr_sequencia,				dt_atualizacao,			nm_usuario,
					dt_atualizacao_nrec,			nm_usuario_nrec,		nr_seq_aviso_conta,
					nr_seq_conta_proc,			ie_origem_proced,		cd_procedimento,
					cd_despesa,				dt_execucao,			hr_inicial,
					hr_final,				cd_tabela,			cd_proc_envio,
					ds_procedimento,			qt_executada,			ie_via_acesso,
					ie_tecnica_utilizada,			tx_reducao_acrescimo,		vl_unitario,
					vl_total,				nr_seq_item_tiss,		ie_ato_cooperado,
					nr_seq_grupo_ans)
				values (nextval('ptu_aviso_procedimento_seq'),	clock_timestamp(),			nm_usuario_p,
					clock_timestamp(),				nm_usuario_p,			nr_seq_aviso_conta_p,
					nr_seq_conta_proc_p,			ie_origem_proced_p,		cd_procedimento_p,
					cd_despesa_p,				dt_execucao_w,			hr_inicial_p,
					hr_final_p,				cd_tabela_p,			cd_proc_envio_p,
					ds_procedimento_p,			qt_executada_p,			ie_via_acesso_p,
					ie_tecnica_utilizada_p,			tx_reducao_acrescimo_p,		vl_unitario_p,
					vl_total_p,				nr_seq_item_tiss_p,		ie_ato_cooperado_w,
					nr_seq_grupo_ans_w) returning nr_sequencia into nr_sequencia_p;
					
commit;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ptu_aviso_imp_pck.inserir_a520_proc ( nr_sequencia_p INOUT ptu_aviso_procedimento.nr_sequencia%type, nm_usuario_p ptu_aviso_procedimento.nm_usuario%type, nr_seq_aviso_conta_p ptu_aviso_procedimento.nr_seq_aviso_conta%type, nr_seq_conta_proc_p ptu_aviso_procedimento.nr_seq_conta_proc%type, ie_origem_proced_p ptu_aviso_procedimento.ie_origem_proced%type, cd_procedimento_p ptu_aviso_procedimento.cd_procedimento%type, cd_despesa_p ptu_aviso_procedimento.cd_despesa%type, dt_execucao_p text, hr_inicial_p ptu_aviso_procedimento.hr_inicial%type, hr_final_p ptu_aviso_procedimento.hr_final%type, cd_tabela_p ptu_aviso_procedimento.cd_tabela%type, cd_proc_envio_p ptu_aviso_procedimento.cd_proc_envio%type, ds_procedimento_p ptu_aviso_procedimento.ds_procedimento%type, qt_executada_p ptu_aviso_procedimento.qt_executada%type, ie_via_acesso_p ptu_aviso_procedimento.ie_via_acesso%type, ie_tecnica_utilizada_p ptu_aviso_procedimento.ie_tecnica_utilizada%type, tx_reducao_acrescimo_p ptu_aviso_procedimento.tx_reducao_acrescimo%type, vl_unitario_p ptu_aviso_procedimento.vl_unitario%type, vl_total_p ptu_aviso_procedimento.vl_total%type, nr_seq_item_tiss_p ptu_aviso_procedimento.nr_seq_item_tiss%type) FROM PUBLIC;
