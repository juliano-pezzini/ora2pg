-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';


/*-----------------------------------------------------------------------------------------------------------------------------------------------------------------
'CCtx'
*/
CREATE OR REPLACE FUNCTION kodip_pck.get_cctx ( nr_seq_documento_p text, nr_atendimento_p bigint, ds_mode_p text) RETURNS SETOF T_CCTX AS $body$
DECLARE

		
_ora2pg_r RECORD;
nr_seq_episodio_w		episodio_paciente.nr_sequencia%type;
nr_atendimento_w		atendimento_paciente.nr_atendimento%type;
reg_integracao_w		gerar_int_padrao.reg_integracao_conv;
		
r_cctx_w			r_cctx;


BEGIN
nr_seq_episodio_w	:=	somente_numero(nr_seq_documento_p);
nr_atendimento_w	:=	nr_atendimento_p;
SELECT * FROM kodip_pck.inicializacao(nr_seq_episodio_w, nr_atendimento_w, reg_integracao_w) INTO STRICT _ora2pg_r;
 nr_seq_episodio_w := _ora2pg_r.nr_seq_episodio_p; nr_atendimento_w := _ora2pg_r.nr_atendimento_p; reg_integracao_w := _ora2pg_r.reg_integracao_p;

r_cctx_w.codingcatver	:= to_char(obter_data_referencia_proc(nr_atendimento_w),'yyyy');
r_cctx_w.modetype		:= ds_mode_p;
r_cctx_w.codingcanceled := 'false';

RETURN NEXT r_cctx_w;

reg_integracao_w := kodip_pck.record_log(nr_seq_episodio_w, reg_integracao_w);
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION kodip_pck.get_cctx ( nr_seq_documento_p text, nr_atendimento_p bigint, ds_mode_p text) FROM PUBLIC;
