-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pls_cta_regra_taxa_adm_pck.obter_ordem_sugerida_regra ( nr_seq_prestador_taxa_adm_p pls_prestador_taxa_adm.nr_sequencia%type) RETURNS bigint AS $body$
DECLARE


nr_valor_total_w	pls_prestador_taxa_adm.nr_ordem_execucao%type;

C01 CURSOR(	nr_seq_prestador_taxa_adm_pc 	pls_prestador_taxa_adm.nr_sequencia%type) FOR
	SELECT	dt_inicio_vigencia,
		dt_fim_vigencia,
		nr_seq_prestador,
		ie_tipo_item,
		cd_area_procedimento,
		cd_especialidade,
		cd_grupo_proc,
		cd_procedimento,
		ie_tipo_desp_proc,
		nr_seq_estrut_mat,
		nr_seq_material,
		ie_tipo_desp_mat
	from	pls_prestador_taxa_adm
	where	nr_sequencia = nr_seq_prestador_taxa_adm_pc;

BEGIN
-- iniciliza a vari√°vel
nr_valor_total_w := 0;

-- verifica a regra e adiciona 500 pontos para cada campo preenchido
for r_C01_w in C01( nr_seq_prestador_taxa_adm_p ) loop
	-- campo dt_inicio_vigencia
	if (r_C01_w.dt_inicio_vigencia IS NOT NULL AND r_C01_w.dt_inicio_vigencia::text <> '') then
		nr_valor_total_w := nr_valor_total_w + 500;
	end if;

	-- campo dt_fim_vigencia
	if (r_C01_w.dt_fim_vigencia IS NOT NULL AND r_C01_w.dt_fim_vigencia::text <> '') then
		nr_valor_total_w := nr_valor_total_w + 500;
	end if;

	-- campo nr_seq_prestador
	if (r_C01_w.nr_seq_prestador IS NOT NULL AND r_C01_w.nr_seq_prestador::text <> '') then
		nr_valor_total_w := nr_valor_total_w + 500;
	end if;

	-- campo ie_tipo_item
	if (r_C01_w.ie_tipo_item IS NOT NULL AND r_C01_w.ie_tipo_item::text <> '') then
		nr_valor_total_w := nr_valor_total_w + 500;
	end if;

	-- campo cd_area_procedimento
	if (r_C01_w.cd_area_procedimento IS NOT NULL AND r_C01_w.cd_area_procedimento::text <> '') then
		nr_valor_total_w := nr_valor_total_w + 500;
	end if;

	-- campo cd_especialidade
	if (r_C01_w.cd_especialidade IS NOT NULL AND r_C01_w.cd_especialidade::text <> '') then
		nr_valor_total_w := nr_valor_total_w + 500;
	end if;

	-- campo cd_procedimento
	if (r_C01_w.cd_procedimento IS NOT NULL AND r_C01_w.cd_procedimento::text <> '') then
		nr_valor_total_w := nr_valor_total_w + 500;
	end if;

	-- campo ie_tipo_desp_proc
	if (r_C01_w.ie_tipo_desp_proc IS NOT NULL AND r_C01_w.ie_tipo_desp_proc::text <> '') then
		nr_valor_total_w := nr_valor_total_w + 500;
	end if;

	-- campo nr_seq_estrut_mat
	if (r_C01_w.nr_seq_estrut_mat IS NOT NULL AND r_C01_w.nr_seq_estrut_mat::text <> '') then
		nr_valor_total_w := nr_valor_total_w + 500;
	end if;

	-- campo nr_seq_material
	if (r_C01_w.nr_seq_material IS NOT NULL AND r_C01_w.nr_seq_material::text <> '') then
		nr_valor_total_w := nr_valor_total_w + 500;
	end if;

	-- campo ie_tipo_desp_mat
	if (r_C01_w.ie_tipo_desp_mat IS NOT NULL AND r_C01_w.ie_tipo_desp_mat::text <> '') then
		nr_valor_total_w := nr_valor_total_w + 500;
	end if;
end loop;

return nr_valor_total_w;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pls_cta_regra_taxa_adm_pck.obter_ordem_sugerida_regra ( nr_seq_prestador_taxa_adm_p pls_prestador_taxa_adm.nr_sequencia%type) FROM PUBLIC;
