-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION alto_custo_erc_pck.get_altura () RETURNS varchar AS $body$
DECLARE

        ds_retorno_w varchar(255);


BEGIN
        begin
            select  max(a.qt_altura_cm)
            into STRICT    ds_retorno_w
            from    atendimento_sinal_vital a
            where   a.nr_sequencia =    (
                                        SELECT  max(b.nr_sequencia)
                                        from    table(alto_custo_pck.get_atendimentos_paciente(current_setting('alto_custo_erc_pck.option_last_w')::varchar(1))) t,
                                                atendimento_sinal_vital b
                                        where   b.nr_atendimento = t.nr_atendimento
                                        )
            and     (a.dt_liberacao IS NOT NULL AND a.dt_liberacao::text <> '');

            exception
                when no_data_found then
                    ds_retorno_w := null;
        end;

      return ds_retorno_w;
    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION alto_custo_erc_pck.get_altura () FROM PUBLIC;
