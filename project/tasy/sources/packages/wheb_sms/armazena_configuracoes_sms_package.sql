-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE wheb_sms.armazena_configuracoes_sms (NM_USUARIO_P text) AS $body$
DECLARE


		ds_parametro_w			varchar(255);
		cd_estabelecimento_w	smallint;
	
BEGIN

		cd_estabelecimento_w := coalesce(wheb_usuario_pck.get_cd_estabelecimento,1);

		PERFORM set_config('wheb_sms.nm_usuario_sms_w', OBTER_VALOR_PARAM_USUARIO(0,54,coalesce(wheb_usuario_pck.get_cd_perfil,0),nm_usuario_p,cd_estabelecimento_w), false);
		if (current_setting('wheb_sms.nm_usuario_sms_w')::coalesce(varchar(255)::text, '') = '') then
			select	ds_parametro
			into STRICT	ds_parametro_w
			from	funcao_parametro
			where	cd_funcao	= 0
			and		nr_sequencia	= 54;
			CALL Wheb_mensagem_pck.exibir_mensagem_abort(213820,'DS_PARAMETRO_W=' || ds_parametro_w);
		end if;

		PERFORM set_config('wheb_sms.ds_senha_usuario_sms_w', OBTER_VALOR_PARAM_USUARIO(0,55,coalesce(wheb_usuario_pck.get_cd_perfil,0),nm_usuario_p,cd_estabelecimento_w), false);
		if (current_setting('wheb_sms.ds_senha_usuario_sms_w')::coalesce(varchar(255)::text, '') = '') then
			select	ds_parametro
			into STRICT	ds_parametro_w
			from	funcao_parametro
			where	cd_funcao		= 0
			and		nr_sequencia	= 55;
			CALL Wheb_mensagem_pck.exibir_mensagem_abort(213820,'DS_PARAMETRO_W=' || ds_parametro_w);
		end if;

		PERFORM set_config('wheb_sms.ds_url_sms_w', OBTER_VALOR_PARAM_USUARIO(0,68,0,nm_usuario_p,1), false);
		PERFORM set_config('wheb_sms.cd_empresa_w', OBTER_VALOR_PARAM_USUARIO(0,89,0,nm_usuario_p,1), false);
		PERFORM set_config('wheb_sms.ip_servidor_proxy_w', OBTER_VALOR_PARAM_USUARIO(0,80,0,nm_usuario_p,1), false);
		PERFORM set_config('wheb_sms.nm_usuario_proxy_w', OBTER_VALOR_PARAM_USUARIO(0,81,0,nm_usuario_p,1), false);
		PERFORM set_config('wheb_sms.ds_senha_proxy_w', OBTER_VALOR_PARAM_USUARIO(0,82,0,nm_usuario_p,1), false);
		PERFORM set_config('wheb_sms.ip_whebservidorsms_w', OBTER_VALOR_PARAM_USUARIO(0,236,0,nm_usuario_p,1), false);

	end;


$body$
LANGUAGE PLPGSQL
;
-- REVOKE ALL ON PROCEDURE wheb_sms.armazena_configuracoes_sms (NM_USUARIO_P text) FROM PUBLIC;
