-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE nais_mla_internalpro.get_action_code_med_detail ( messagetype_p text, record_p medtreatmentinforedtyp, message_data INOUT text ) AS $body$
DECLARE

        record_w     medtreatmentinforedtyp;
        actioncode   varchar(10);
        medical_affair_code nais_conversion_master%rowtype;

BEGIN
        PERFORM set_config('nais_mla_internalpro.ds_line_w', null, false);
        record_w := record_p;
        record_w.nr_data_class := '01';
        case
            when( messagetype_p = 'P0' ) then
                medical_affair_code := get_medicalaffair_code('PC','CPOE_PROCEDIMENTO','NR_SEQ_PROC_INTERNO',record_w.internal_code_medical, null, null);
                if (medical_affair_code.cd_medical_action IS NOT NULL AND medical_affair_code.cd_medical_action::text <> '') then
                    record_w.internal_code := rpad(medical_affair_code.cd_medical_action, 6, ' ');
                else
                    record_w.internal_code := rpad('.4000', 6, ' ');
                end if;
        end case;

        record_w.dosage := '         ';
        record_w.unit := ' ';
        record_w.free_comments := ' ';
        CALL CALL CALL CALL nais_mla_internalpro.common_med_treatment_info(record_w);
        message_data := current_setting('nais_mla_internalpro.ds_line_w')::varchar(32767);
    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE nais_mla_internalpro.get_action_code_med_detail ( messagetype_p text, record_p medtreatmentinforedtyp, message_data INOUT text ) FROM PUBLIC;
