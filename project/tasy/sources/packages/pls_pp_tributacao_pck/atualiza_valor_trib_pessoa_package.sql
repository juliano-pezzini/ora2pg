-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_pp_tributacao_pck.atualiza_valor_trib_pessoa ( tb_nr_seq_trib_pes_p INOUT pls_util_cta_pck.t_number_table, tb_pr_aliquota_p INOUT pls_util_cta_pck.t_number_table, tb_vl_desc_depen_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_tit_pag_p INOUT pls_util_cta_pck.t_number_table, tb_vl_base_calc_p INOUT pls_util_cta_pck.t_number_table, tb_vl_tributo_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_irpf_p INOUT pls_util_cta_pck.t_number_table, tb_vl_reducao_p INOUT pls_util_cta_pck.t_number_table, tb_qt_dependente_p INOUT pls_util_cta_pck.t_number_table, tb_vl_trib_nao_retido_p INOUT pls_util_cta_pck.t_number_table, tb_vl_trib_adic_p INOUT pls_util_cta_pck.t_number_table, tb_vl_base_nao_retido_p INOUT pls_util_cta_pck.t_number_table, tb_vl_base_adic_p INOUT pls_util_cta_pck.t_number_table, tb_vl_base_acum_trib_p INOUT pls_util_cta_pck.t_number_table, tb_vl_base_total_p INOUT pls_util_cta_pck.t_number_table, tb_dt_pgto_trib_p INOUT pls_util_cta_pck.t_date_table, tb_nr_seq_trans_reg_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_trans_baixa_p INOUT pls_util_cta_pck.t_number_table, tb_cd_beneficiario_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_ie_periodicidade_p INOUT pls_util_cta_pck.t_varchar2_table_5, tb_cd_variacao_p INOUT pls_util_cta_pck.t_number_table, tb_cd_cond_pgto_p INOUT pls_util_cta_pck.t_number_table, tb_cd_darf_p INOUT pls_util_cta_pck.t_varchar2_table_10, tb_nr_seq_classe_p INOUT pls_util_cta_pck.t_number_table, tb_cd_tipo_baixa_neg_p INOUT pls_util_cta_pck.t_number_table, tb_ie_vencimento_p INOUT pls_util_cta_pck.t_varchar2_table_5, tb_ie_ger_tit_pagar_p INOUT pls_util_cta_pck.t_varchar2_table_5, tb_cd_conta_financ_p INOUT pls_util_cta_pck.t_number_table, nr_cont_p INOUT integer) AS $body$
BEGIN

-- se tem algo manda pro banco

if (tb_nr_seq_trib_pes_p.count > 0) then

	forall i in tb_nr_seq_trib_pes_p.first..tb_nr_seq_trib_pes_p.last
		update	pls_pp_valor_trib_pessoa
		set	pr_aliquota = coalesce(tb_pr_aliquota_p(i), 0),
			vl_desc_dependente = coalesce(tb_vl_desc_depen_p(i), 0),
			vl_base_calculo = coalesce(tb_vl_base_calc_p(i), 0),
			vl_tributo = coalesce(tb_vl_tributo_p(i), 0),
			vl_reducao = coalesce(tb_vl_reducao_p(i), 0),
			qt_dependente =  coalesce(tb_qt_dependente_p(i), 0),
			vl_nao_retido =  coalesce(tb_vl_trib_nao_retido_p(i), 0),
			vl_trib_adic =  coalesce(tb_vl_trib_adic_p(i), 0),
			vl_base_nao_retido =  coalesce(tb_vl_base_nao_retido_p(i), 0),
			vl_base_adic =  coalesce(tb_vl_base_adic_p(i), 0),
			nr_seq_regra_irpf = tb_nr_seq_irpf_p(i),
			nr_seq_trib_conta_pagar = tb_nr_seq_tit_pag_p(i),
			vl_base_acumulada = coalesce(tb_vl_base_acum_trib_p(i), 0),
			vl_base_total = coalesce(tb_vl_base_total_p(i), 0),
			dt_pgto_tributo = tb_dt_pgto_trib_p(i),
			nr_seq_trans_reg = tb_nr_seq_trans_reg_p(i),
			nr_seq_trans_baixa = tb_nr_seq_trans_baixa_p(i),
			cd_beneficiario = tb_cd_beneficiario_p(i),
			ie_periodicidade = tb_ie_periodicidade_p(i),
			cd_variacao = tb_cd_variacao_p(i),
			cd_cond_pagto = tb_cd_cond_pgto_p(i),
			cd_darf = tb_cd_darf_p(i),
			nr_seq_classe = tb_nr_seq_classe_p(i),
			cd_tipo_baixa_neg = tb_cd_tipo_baixa_neg_p(i),
			ie_vencimento = tb_ie_vencimento_p(i),
			ie_gerar_titulo_pagar = tb_ie_ger_tit_pagar_p(i),
			cd_conta_financ = tb_cd_conta_financ_p(i)
		where	nr_sequencia = tb_nr_seq_trib_pes_p(i);
	commit;
end if;

-- limpa os parametros

tb_nr_seq_trib_pes_p.delete;
tb_pr_aliquota_p.delete;
tb_vl_desc_depen_p.delete;
tb_nr_seq_tit_pag_p.delete;
tb_vl_base_calc_p.delete;
tb_vl_tributo_p.delete;
tb_nr_seq_irpf_p.delete;
tb_vl_reducao_p.delete;
tb_qt_dependente_p.delete;
tb_vl_trib_nao_retido_p.delete;
tb_vl_trib_adic_p.delete;
tb_vl_base_nao_retido_p.delete;
tb_vl_base_adic_p.delete;
tb_vl_base_acum_trib_p.delete;
tb_dt_pgto_trib_p.delete;
tb_nr_seq_trans_reg_p.delete;
tb_nr_seq_trans_baixa_p.delete;
tb_cd_beneficiario_p.delete;
tb_ie_periodicidade_p.delete;
tb_cd_variacao_p.delete;
tb_cd_cond_pgto_p.delete;
tb_cd_darf_p.delete;
tb_nr_seq_classe_p.delete;
tb_cd_tipo_baixa_neg_p.delete;
tb_ie_vencimento_p.delete;
tb_ie_ger_tit_pagar_p.delete;
tb_cd_conta_financ_p.delete;
nr_cont_p := 0;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_pp_tributacao_pck.atualiza_valor_trib_pessoa ( tb_nr_seq_trib_pes_p INOUT pls_util_cta_pck.t_number_table, tb_pr_aliquota_p INOUT pls_util_cta_pck.t_number_table, tb_vl_desc_depen_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_tit_pag_p INOUT pls_util_cta_pck.t_number_table, tb_vl_base_calc_p INOUT pls_util_cta_pck.t_number_table, tb_vl_tributo_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_irpf_p INOUT pls_util_cta_pck.t_number_table, tb_vl_reducao_p INOUT pls_util_cta_pck.t_number_table, tb_qt_dependente_p INOUT pls_util_cta_pck.t_number_table, tb_vl_trib_nao_retido_p INOUT pls_util_cta_pck.t_number_table, tb_vl_trib_adic_p INOUT pls_util_cta_pck.t_number_table, tb_vl_base_nao_retido_p INOUT pls_util_cta_pck.t_number_table, tb_vl_base_adic_p INOUT pls_util_cta_pck.t_number_table, tb_vl_base_acum_trib_p INOUT pls_util_cta_pck.t_number_table, tb_vl_base_total_p INOUT pls_util_cta_pck.t_number_table, tb_dt_pgto_trib_p INOUT pls_util_cta_pck.t_date_table, tb_nr_seq_trans_reg_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_trans_baixa_p INOUT pls_util_cta_pck.t_number_table, tb_cd_beneficiario_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_ie_periodicidade_p INOUT pls_util_cta_pck.t_varchar2_table_5, tb_cd_variacao_p INOUT pls_util_cta_pck.t_number_table, tb_cd_cond_pgto_p INOUT pls_util_cta_pck.t_number_table, tb_cd_darf_p INOUT pls_util_cta_pck.t_varchar2_table_10, tb_nr_seq_classe_p INOUT pls_util_cta_pck.t_number_table, tb_cd_tipo_baixa_neg_p INOUT pls_util_cta_pck.t_number_table, tb_ie_vencimento_p INOUT pls_util_cta_pck.t_varchar2_table_5, tb_ie_ger_tit_pagar_p INOUT pls_util_cta_pck.t_varchar2_table_5, tb_cd_conta_financ_p INOUT pls_util_cta_pck.t_number_table, nr_cont_p INOUT integer) FROM PUBLIC;
