-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION ctb_regras_contabil.replace_first ( str_p text, str_replace_p text, str_index_p bigint default NULL, str_index_end_p bigint default NULL, str_target_p text default NULL) RETURNS varchar AS $body$
DECLARE


    str_index_w     bigint;
    str_index_end_w bigint;
    ds_resultado_w  varchar(4000);


BEGIN

        BEGIN
            IF (str_target_p IS NOT NULL AND str_target_p::text <> '') THEN
                str_index_w     := position(str_target_p in str_p);
                str_index_end_w := LENGTH(str_target_p);
            ELSE
                str_index_w := str_index_p;

                IF (str_index_end_p IS NOT NULL AND str_index_end_p::text <> '') THEN
                    str_index_end_w := str_index_end_p;
                ELSE
                    str_index_end_w := 1;
                END IF;
            END IF;

            ds_resultado_w := SUBSTR(str_p, 1, str_index_w - 1) || str_replace_p || SUBSTR(str_p, str_index_w + str_index_end_w, LENGTH(str_p));
        EXCEPTION WHEN OTHERS THEN
            ds_resultado_w := str_p;
        END;

        RETURN ds_resultado_w;

    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION ctb_regras_contabil.replace_first ( str_p text, str_replace_p text, str_index_p bigint default NULL, str_index_end_p bigint default NULL, str_target_p text default NULL) FROM PUBLIC;
