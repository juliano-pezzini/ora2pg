-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION ctb_regras_contabil.index_of ( ds_str_p text, ds_stop_p text, ds_target_p text, nr_start_p bigint ) RETURNS varchar AS $body$
DECLARE


    nr_start_w      bigint;
    qt_tamanho_w    bigint := 1;
    ds_match_w      bigint := -1;


BEGIN

        nr_start_w := nr_start_p;
        qt_tamanho_w := position(ds_stop_p in SUBSTR(ds_str_p, nr_start_p, LENGTH(ds_str_p)));

        WHILE(ds_match_w < 0 AND position(ds_target_p in ds_str_p) > 0 AND nr_start_w <= LENGTH(ds_str_p)) LOOP

            IF SUBSTR(ds_str_p, nr_start_w, qt_tamanho_w - 1) = ds_target_p THEN
                ds_match_w := 1;
                EXIT;
            END IF;

            nr_start_w := nr_start_w + 1;
            qt_tamanho_w := position(ds_stop_p in SUBSTR(ds_str_p || ds_stop_p, nr_start_w, LENGTH(ds_str_p)));

        END LOOP;

        IF ds_match_w = 1 THEN
            RETURN nr_start_w || ',' || (qt_tamanho_w - 1);
        END IF;

        RETURN NULL;

    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION ctb_regras_contabil.index_of ( ds_str_p text, ds_stop_p text, ds_target_p text, nr_start_p bigint ) FROM PUBLIC;
