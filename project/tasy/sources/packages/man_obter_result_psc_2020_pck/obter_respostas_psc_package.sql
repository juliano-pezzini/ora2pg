-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION man_obter_result_psc_2020_pck.obter_respostas_psc ( nm_usuario text, dt_inicio timestamp, dt_fim timestamp, ie_produto_p text, ie_migracao_p text, cd_gerente_p bigint, sg_estado_p text, nr_seq_canal_p bigint) RETURNS SETOF T_PERGUNTAS_RESPOSTAS_ROW AS $body$
DECLARE

t_avaliacao_row_w	t_avaliacao_row;

  client RECORD;
  req RECORD;

BEGIN

	t_avaliacao_row_w.ds_cliente	:= 'Cliente';

	/* Dados Gerais */

	
	t_avaliacao_row_w.questao_1	    := man_obter_result_psc_2020_pck.man_obter_questao_psc(21026);
	t_avaliacao_row_w.questao_2	    := man_obter_result_psc_2020_pck.man_obter_questao_psc(21027);
	t_avaliacao_row_w.questao_3	    := man_obter_result_psc_2020_pck.man_obter_questao_psc(21028);
	
	/* Perguntas estrategicas aplicadas com a administracao */

	
	t_avaliacao_row_w.questao_4	    := man_obter_result_psc_2020_pck.man_obter_questao_psc(21029);	-- Perguntas Estrategicas Aplicadas com a Administracao (S, N)
	t_avaliacao_row_w.questao_5	    := man_obter_result_psc_2020_pck.man_obter_questao_psc(21031);	-- Nome do Respondente
	t_avaliacao_row_w.questao_6	    := man_obter_result_psc_2020_pck.man_obter_questao_psc(21032);	-- Cargo
	t_avaliacao_row_w.questao_7	    := man_obter_result_psc_2020_pck.man_obter_questao_psc(21033);	-- E-mail
	t_avaliacao_row_w.questao_8	    := man_obter_result_psc_2020_pck.man_obter_questao_psc(21034);	-- 1) Em uma escala de 1 a 10, o quanto voce indicaria a Philips para um novo negocio?
	t_avaliacao_row_w.questao_9	    := man_obter_result_psc_2020_pck.man_obter_questao_psc(21035);	-- 1.1)  Em poucas palavras descreva o que motivou sua opiniao (NPS):
	t_avaliacao_row_w.questao_10	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21037);	-- 2) Como voce avalia a senioridade, presenca e resolutividade dos profissionais responsaveis pelo relacionamento da Philips/Canais de Distribuicao com a sua instituicao?
	t_avaliacao_row_w.questao_11	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21038);	-- Justifique:
	t_avaliacao_row_w.questao_12	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21013);	-- 3) Como voce percebe o engajamento e pro-atividade para resolver um problema ou criar uma oportunidade para sua Instituicao?
	t_avaliacao_row_w.questao_13	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21014);	-- Justifique
	t_avaliacao_row_w.questao_14	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21039);	-- 4) Em que nivel o Tasy contribui para a Gestao e Tomada de Decisao da sua Instituicao?
	t_avaliacao_row_w.questao_15	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21040);	-- Justifique
	t_avaliacao_row_w.questao_16	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21041);	-- 5) Como voce entende a participacao do TASY nos seus planos estrategicos de longo prazoa
	t_avaliacao_row_w.questao_17	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21042);	-- Justifique
	t_avaliacao_row_w.questao_18	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21015);	-- 6) Como voce avalia o retorno sob o investimento obtido com o TASY?
	t_avaliacao_row_w.questao_19	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21016);	-- Justifique
	t_avaliacao_row_w.questao_20	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21043);	-- 7) Voce compraria novamente a solucao?
	t_avaliacao_row_w.questao_21	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21044);	-- Justifique
	t_avaliacao_row_w.questao_22	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21045);	-- 8) O quanto a sua Instituicao e suportada pela Philips quanto as suas necessidades?
	t_avaliacao_row_w.questao_23	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21046);	-- Justifique
	t_avaliacao_row_w.questao_24	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21047);	-- 9) Qual a sua avaliacao quanto as inovacoes e novas tecnologias da Philips?
	t_avaliacao_row_w.questao_25	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21010);	-- Justifique
	
	/* Perguntas Operacionais Aplicadas com a TI */

	
	t_avaliacao_row_w.questao_26	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21048);	-- Perguntas Operacionais Aplicadas com a TI (S, N)
	t_avaliacao_row_w.questao_27	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21050);	-- Nome do Respondente
	t_avaliacao_row_w.questao_28	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21051);	-- Cargo
	t_avaliacao_row_w.questao_29	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21052);	-- E-mail
	t_avaliacao_row_w.questao_30	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21053);	-- 1) Em uma escala de 1 a 10, o quanto voce indicaria a Philips para um novo negocio?
	t_avaliacao_row_w.questao_31	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21054);	-- 1.1)  Em poucas palavras descreva o que motivou sua opiniao:
	t_avaliacao_row_w.questao_32	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21056);	-- 2) Como percebe enganjamento e pro-atividade para resolver um problema ou criar uma oportunidade?
	t_avaliacao_row_w.questao_33	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21057);	-- Justifique
	t_avaliacao_row_w.questao_34	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21011);	-- 3) Satisfacao quanto ao atendimento do Suporte nas OSs de Duvidas e Defeitos
	t_avaliacao_row_w.questao_35	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21012);	-- Justifique
	t_avaliacao_row_w.questao_36	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21058);	-- 4) Como voce avalia o atendimento da OS de Solicitacao?
	t_avaliacao_row_w.questao_37	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21059);	-- Justifique
	t_avaliacao_row_w.questao_38	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21017);	-- 5) Na sua opiniao, o produto funciona conforme prometido?
	t_avaliacao_row_w.questao_39	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21018);	-- Justifique
	t_avaliacao_row_w.questao_40	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21060);	-- 6) Como voce avalia a estabilidade do sistema?
	t_avaliacao_row_w.questao_41	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21061);	-- Justifique
	t_avaliacao_row_w.questao_42	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21062);	-- 7) Satisfacao quanto a agilidade/assertividade do atendimento com as situacoes apos atualizacao?
	t_avaliacao_row_w.questao_43	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21063);	-- Justifique
	t_avaliacao_row_w.questao_44	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21019);	-- 8) Como voce avalia a facilidade de uso do TASY?
	t_avaliacao_row_w.questao_45	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21020);	-- Justifique
	t_avaliacao_row_w.questao_46	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21064);	-- 9) Qual a sua avaliacao quanto as inovacoes e novas tecnologias da Philips?
	t_avaliacao_row_w.questao_47	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21065);	-- Justifique
	t_avaliacao_row_w.questao_48	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21066);	-- 10) Qual a sua avaliacao quanto aos eventos e materiais Philips com foco educacional e em relacionamento?
	t_avaliacao_row_w.questao_49	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21067);	-- Justifique
	t_avaliacao_row_w.questao_50	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21021);	-- 11) Como voce avalia a integracao do TASY com demais ferramentas e solucoes do mercado?
	t_avaliacao_row_w.questao_51	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21022);	-- Justifique
	t_avaliacao_row_w.questao_52	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21068);	-- 12) Teve projetos (consultoria) nos ultimos 12 meses? Qual a satisfacao com a(s) entrega(s) do(s) projeto(s) no que diz respeito ao conhecimento e responsabilidade dos Consultores/Gerentes de Projeto?
	t_avaliacao_row_w.questao_53	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21069);	-- Justifique
	t_avaliacao_row_w.questao_54	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21023);	-- 12.1)  Qual a sua avaliacao quanto ao impacto desta consultoria na operacao da Instituicao?
	t_avaliacao_row_w.questao_55	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21024);	-- Justifique
	t_avaliacao_row_w.questao_56	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21070);	-- 13) Faz uso do Philips Learning Center, com Gestor e usuarios cadastrados? Qual e sua avaliacao?
	t_avaliacao_row_w.questao_57	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21071);	-- Justifique
	t_avaliacao_row_w.questao_58	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21072);	-- Consideracoes finais
	t_avaliacao_row_w.questao_59	:= man_obter_result_psc_2020_pck.man_obter_questao_psc(21074);	-- Analise do Gestor / Plano de Acao
	RETURN NEXT t_avaliacao_row_w;

	for client in (
			SELECT	distinct obter_desc_cliente(mep.nr_seq_com_cliente, 'N') ds_cliente,
				mep.nr_sequencia nr_seq_registro,
				mep.dt_avaliacao
			from	med_avaliacao_paciente mep,
				com_cliente,
				com_canal,
				com_canal_cliente,
				pessoa_juridica pj,
				com_cliente_conta
			where	com_cliente.nr_sequencia = mep.nr_seq_com_cliente
			and	coalesce(mep.ie_situacao,'A') = 'A'
			and	com_cliente.nr_sequencia = com_canal_cliente.nr_seq_cliente
			and	com_canal.nr_sequencia = com_canal_cliente.nr_seq_canal
			and	pj.cd_cgc = com_cliente.cd_cnpj
			and	com_cliente.nr_sequencia = com_cliente_conta.nr_seq_cliente
			and (coalesce(nr_seq_canal_p, 0) = 0	or nr_seq_canal_p = com_canal.nr_sequencia)
			and (coalesce(cd_gerente_p, 0) = 0	or (cd_gerente_p = com_cliente_conta.cd_pessoa_fisica and coalesce(com_cliente_conta.dt_final::text, '') = ''))
			and (coalesce(ie_produto_p, '0') = '0'	or ie_produto_p = com_cliente.ie_produto)
			and (coalesce(sg_estado_p, '0') = '0'	or sg_estado_p = pj.sg_estado)
			and (coalesce(ie_migracao_p, '0') = '0'	or ie_migracao_p = com_cliente.ie_migracao)
			and	mep.nr_seq_tipo_avaliacao = 1736
			and	trunc(mep.dt_avaliacao) between dt_inicio and dt_fim
		) loop
			begin
				for req in (

					SELECT	coalesce(q_1.ds_resultado, 'N/A') q1,
						coalesce(q_2.ds_resultado, 'N/A') q2,
						coalesce(q_3.ds_resultado, 'N/A') q3,
						coalesce(q_4.ds_resultado, 'N/A') q4,
						coalesce(q_5.ds_resultado, 'N/A') q5,
						coalesce(q_6.ds_resultado, 'N/A') q6,
						coalesce(q_7.ds_resultado, 'N/A') q7,
						coalesce(q_8.ds_resultado, 'N/A') q8,
						coalesce(q_9.ds_resultado, 'N/A') q9,
						coalesce(q_10.ds_resultado, 'N/A') q10,
						coalesce(q_11.ds_resultado, 'N/A') q11,
						coalesce(q_12.ds_resultado, 'N/A') q12,
						coalesce(q_13.ds_resultado, 'N/A') q13,
						coalesce(q_14.ds_resultado, 'N/A') q14,
						coalesce(q_15.ds_resultado, 'N/A') q15,
						coalesce(q_16.ds_resultado, 'N/A') q16,
						coalesce(q_17.ds_resultado, 'N/A') q17,
						coalesce(q_18.ds_resultado, 'N/A') q18,
						coalesce(q_19.ds_resultado, 'N/A') q19,
						coalesce(q_20.ds_resultado, 'N/A') q20,
						coalesce(q_21.ds_resultado, 'N/A') q21,
						coalesce(q_22.ds_resultado, 'N/A') q22,
						coalesce(q_23.ds_resultado, 'N/A') q23,
						coalesce(q_24.ds_resultado, 'N/A') q24,
						coalesce(q_25.ds_resultado, 'N/A') q25,
						coalesce(q_26.ds_resultado, 'N/A') q26,
						coalesce(q_27.ds_resultado, 'N/A') q27,
						coalesce(q_28.ds_resultado, 'N/A') q28,
						coalesce(q_29.ds_resultado, 'N/A') q29,
						coalesce(q_30.ds_resultado, 'N/A') q30,
						coalesce(q_31.ds_resultado, 'N/A') q31,
						coalesce(q_32.ds_resultado, 'N/A') q32,
						coalesce(q_33.ds_resultado, 'N/A') q33,
						coalesce(q_34.ds_resultado, 'N/A') q34,
						coalesce(q_35.ds_resultado, 'N/A') q35,
						coalesce(q_36.ds_resultado, 'N/A') q36,
						coalesce(q_37.ds_resultado, 'N/A') q37,
						coalesce(q_38.ds_resultado, 'N/A') q38,
						coalesce(q_39.ds_resultado, 'N/A') q39,
						coalesce(q_40.ds_resultado, 'N/A') q40,
						coalesce(q_41.ds_resultado, 'N/A') q41,
						coalesce(q_42.ds_resultado, 'N/A') q42,
						coalesce(q_43.ds_resultado, 'N/A') q43,
						coalesce(q_44.ds_resultado, 'N/A') q44,
						coalesce(q_45.ds_resultado, 'N/A') q45,
						coalesce(q_46.ds_resultado, 'N/A') q46,
						coalesce(q_47.ds_resultado, 'N/A') q47,
						coalesce(q_48.ds_resultado, 'N/A') q48,
						coalesce(q_49.ds_resultado, 'N/A') q49,
						coalesce(q_50.ds_resultado, 'N/A') q50,
						coalesce(q_51.ds_resultado, 'N/A') q51,
						coalesce(q_52.ds_resultado, 'N/A') q52,
						coalesce(q_53.ds_resultado, 'N/A') q53,
						coalesce(q_54.ds_resultado, 'N/A') q54,
						coalesce(q_55.ds_resultado, 'N/A') q55,
						coalesce(q_56.ds_resultado, 'N/A') q56,
						coalesce(q_57.ds_resultado, 'N/A') q57,
						coalesce(q_58.ds_resultado, 'N/A') q58,
						coalesce(q_59.ds_resultado, 'N/A') q59
					from (
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21026
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_1,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21027
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_2,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21028
							and	psc.nm_usuario = nm_usuario
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_3,
						(
							select	CASE WHEN max(psc.qt_resultado)=1 THEN  'N'  ELSE 'S' END  ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21030
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_4,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21031
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_5,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21032
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_6,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21033
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_7,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21034
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_8,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21036
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_9,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21037
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_10,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21038
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_11,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21013
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_12,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21014
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_13,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21039
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_14,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21040
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_15,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21041
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_16,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21042
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_17,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21015
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_18,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21016
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_19,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21043
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_20,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21044
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_21,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21045
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_22,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21046
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_23,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21047
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_24,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21010
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_25,
						
						/* continuar daqui (perguntas operacionais) */

						
						(
							select	CASE WHEN max(psc.qt_resultado)=1 THEN  'N'  ELSE 'S' END  ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21049
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_26,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21050
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_27,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21051
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_28,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21052
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_29,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21053
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_30,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21055
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_31,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21056
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_32,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21057
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_33,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21011
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_34,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21012
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_35,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21058
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_36,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21059
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_37,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21017
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_38,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21018
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_39,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21060
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_40,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21061
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_41,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21062
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_42,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21063
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_43,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21019
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_44,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21020
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_45,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21064
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_46,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21065
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_47,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21066
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_48,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21067
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_49,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21021
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_50,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21022
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_51,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21068
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_52,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21069
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_53,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21023
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_54,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21024
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_55,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21070
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_56,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21071
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_57,
						(
							select	max(substr(to_char(psc.ds_resultado_long), 1, 4000)) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21073
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_58,
						(
							select	max(psc.ds_resultado) ds_resultado
							from	com_psc_respostas psc
							where	psc.nr_seq_item = 21075
							and	psc.nr_seq_avaliacao = client.nr_seq_registro
							and	psc.nm_usuario = nm_usuario
							and	psc.dt_avaliacao between dt_inicio and dt_fim
						) q_59
				) loop
					begin
						t_avaliacao_row_w.ds_cliente	:= client.ds_cliente;
						t_avaliacao_row_w.dt_avaliacao	:= client.dt_avaliacao;
						t_avaliacao_row_w.questao_1	    := req.q1;
						t_avaliacao_row_w.questao_2	    := req.q2;
						t_avaliacao_row_w.questao_3	    := req.q3;
						t_avaliacao_row_w.questao_4	    := req.q4;
						t_avaliacao_row_w.questao_5	    := req.q5;
						t_avaliacao_row_w.questao_6	    := req.q6;
						t_avaliacao_row_w.questao_7	    := req.q7;
						t_avaliacao_row_w.questao_8	    := req.q8;
						t_avaliacao_row_w.questao_9	    := req.q9;
						t_avaliacao_row_w.questao_10	:= req.q10;
						t_avaliacao_row_w.questao_11	:= req.q11;
						t_avaliacao_row_w.questao_12	:= req.q12;
						t_avaliacao_row_w.questao_13	:= req.q13;
						t_avaliacao_row_w.questao_14	:= req.q14;
						t_avaliacao_row_w.questao_15	:= req.q15;
						t_avaliacao_row_w.questao_16	:= req.q16;
						t_avaliacao_row_w.questao_17	:= req.q17;
						t_avaliacao_row_w.questao_18	:= req.q18;
						t_avaliacao_row_w.questao_19	:= req.q19;
						t_avaliacao_row_w.questao_20	:= req.q20;
						t_avaliacao_row_w.questao_21	:= req.q21;
						t_avaliacao_row_w.questao_22	:= req.q22;
						t_avaliacao_row_w.questao_23	:= req.q23;
						t_avaliacao_row_w.questao_24	:= req.q24;
						t_avaliacao_row_w.questao_25	:= req.q25;
						t_avaliacao_row_w.questao_26	:= req.q26;
						t_avaliacao_row_w.questao_27	:= req.q27;
						t_avaliacao_row_w.questao_28	:= req.q28;
						t_avaliacao_row_w.questao_29	:= req.q29;
						t_avaliacao_row_w.questao_30	:= req.q30;
						t_avaliacao_row_w.questao_31	:= req.q31;
						t_avaliacao_row_w.questao_32	:= req.q32;
						t_avaliacao_row_w.questao_33	:= req.q33;
						t_avaliacao_row_w.questao_34	:= req.q34;
						t_avaliacao_row_w.questao_35	:= req.q35;
						t_avaliacao_row_w.questao_36	:= req.q36;
						t_avaliacao_row_w.questao_37	:= req.q37;
						t_avaliacao_row_w.questao_38	:= req.q38;
						t_avaliacao_row_w.questao_39	:= req.q39;
						t_avaliacao_row_w.questao_40	:= req.q40;
						t_avaliacao_row_w.questao_41	:= req.q41;
						t_avaliacao_row_w.questao_42	:= req.q42;
						t_avaliacao_row_w.questao_43	:= req.q43;
						t_avaliacao_row_w.questao_44	:= req.q44;
						t_avaliacao_row_w.questao_45	:= req.q45;
						t_avaliacao_row_w.questao_46	:= req.q46;
						t_avaliacao_row_w.questao_47	:= req.q47;
						t_avaliacao_row_w.questao_48	:= req.q48;
						t_avaliacao_row_w.questao_49	:= req.q49;
						t_avaliacao_row_w.questao_50	:= req.q50;
						t_avaliacao_row_w.questao_51	:= req.q51;
						t_avaliacao_row_w.questao_52	:= req.q52;
						t_avaliacao_row_w.questao_53	:= req.q53;
						t_avaliacao_row_w.questao_54	:= req.q54;
						t_avaliacao_row_w.questao_55	:= req.q55;
						t_avaliacao_row_w.questao_56	:= req.q56;
						t_avaliacao_row_w.questao_57	:= req.q57;
						t_avaliacao_row_w.questao_58	:= req.q58;
						t_avaliacao_row_w.questao_59	:= req.q59;
						RETURN NEXT t_avaliacao_row_w;
					end;
				end loop;
			end;
		end loop;
return;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION man_obter_result_psc_2020_pck.obter_respostas_psc ( nm_usuario text, dt_inicio timestamp, dt_fim timestamp, ie_produto_p text, ie_migracao_p text, cd_gerente_p bigint, sg_estado_p text, nr_seq_canal_p bigint) FROM PUBLIC;
