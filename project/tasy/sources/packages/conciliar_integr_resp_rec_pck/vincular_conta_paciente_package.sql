-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE conciliar_integr_resp_rec_pck.vincular_conta_paciente () AS $body$
DECLARE

current_setting('conciliar_integr_resp_rec_pck.i')::integer integer := 0;
j integer := 0;

BEGIN

if (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v.count > 1) then
	FOR current_setting('conciliar_integr_resp_rec_pck.i')::integer IN current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v.first .. current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v.last loop

		if (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_interno_conta = 0) then
			
			if ( current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v.count > 0) then

				for j in current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v.first .. current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v.last loop

					if (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_seq_protocolo = current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].nr_seq_protocolo) then

						if (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_seq_conta_guia = current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].nr_sequencia) then

							current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_interno_conta := current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].nr_interno_conta;

						elsif (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_guia_prestador = current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].nr_guia_prestador) and (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_guia_operadora = current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].cd_autorizacao) and (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).cd_senha = current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].cd_senha) and (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).vl_informado = current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].vl_total) then

							current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_interno_conta := current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].nr_interno_conta;

						elsif (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_guia_prestador = current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].nr_guia_prestador) and (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_guia_operadora = current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].cd_autorizacao) and (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).cd_senha = current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].cd_senha) then

							current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_interno_conta := current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].nr_interno_conta;

						elsif (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_guia_prestador = current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].nr_guia_prestador) and (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_guia_operadora = current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].cd_autorizacao) then

							current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_interno_conta := current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].nr_interno_conta;

						elsif (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_guia_prestador = current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].nr_guia_prestador) then
							current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_interno_conta := current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].nr_interno_conta;

						elsif (current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_guia_prestador = current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].cd_autorizacao) then
							current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).nr_interno_conta := current_setting('conciliar_integr_resp_rec_pck.tiss_conta_guia_w')::tiss_conta_guia_v[j].nr_interno_conta;
						else	
							current_setting('conciliar_integr_resp_rec_pck.campos_guia_w')::campos_guia_v(current_setting('conciliar_integr_resp_rec_pck.i')::integer).ie_status := 'CN';--'Conta Paciente nao encontrada!';
						end if;

					end if;

				end loop;
				
			end if;

		end if;

	end loop;

end if;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE conciliar_integr_resp_rec_pck.vincular_conta_paciente () FROM PUBLIC;
