-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION itech_pck.get_patient_name ( cd_pessoa_fisica_p pessoa_fisica.cd_pessoa_fisica%type, ds_type_p person_name.ds_type%type ) RETURNS varchar AS $body$
DECLARE


    ds_patient_name_w varchar(255);
    ds_given_name_w person_name.ds_given_name%type;
    ds_family_name_w person_name.ds_family_name%type;
	jpn_space_w varchar(255) := chr(14909568);

    
BEGIN
    
    select  coalesce(max(b.ds_given_name), ' '),
            coalesce(max(b.ds_family_name), ' ')
    into STRICT    ds_given_name_w,    
            ds_family_name_w
    from    pessoa_fisica a,
            person_name b
    where   b.nr_sequencia = a.nr_seq_person_name
    and     a.cd_pessoa_fisica = cd_pessoa_fisica_p
    and     b.ds_type = ds_type_p;

    ds_patient_name_w := ds_family_name_w||jpn_space_w||ds_given_name_w;

    return ds_patient_name_w;
  END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION itech_pck.get_patient_name ( cd_pessoa_fisica_p pessoa_fisica.cd_pessoa_fisica%type, ds_type_p person_name.ds_type%type ) FROM PUBLIC;
