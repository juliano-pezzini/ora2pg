-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE itech_pck.delete_error_file ( ds_file_p text, cd_event_data_error bigint, cd_event_index_error bigint, cd_event_log bigint) AS $body$
BEGIN
        CALL pls_utl_file_pck.excluir_arquivo(cd_event_index_error, ds_file_p); -- delete the file from index_error_folder
        CALL pls_utl_file_pck.excluir_arquivo(cd_event_data_error, ds_file_p); -- delete the file from data_error_folder
        PERFORM set_config('itech_pck.ds_log_message_w', 'Successfully created and moved the file from error 
        folder: '||ds_file_p||', '||'Time of Transmission = '||to_char(clock_timestamp(),'hh24:mi:ss'), false);
        CALL CALL itech_pck.save_log(cd_event_log, current_setting('itech_pck.log_file_name_w')::varchar(255), current_setting('itech_pck.ds_log_message_w')::varchar(32767)); -- updating log file
    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE itech_pck.delete_error_file ( ds_file_p text, cd_event_data_error bigint, cd_event_index_error bigint, cd_event_log bigint) FROM PUBLIC;
