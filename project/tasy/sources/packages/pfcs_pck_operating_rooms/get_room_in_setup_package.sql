-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

--  ========================================== Cursors ===========================================
    

--  ========================================== Functions ===========================================
CREATE OR REPLACE FUNCTION pfcs_pck_operating_rooms.get_room_in_setup (nr_seq_location_p bigint) RETURNS varchar AS $body$
DECLARE

        ie_in_setup_w PFCS_PCK_SUBTYPES.VARCHAR_1_T := PFCS_PCK_CONSTANTS.IE_NO;

BEGIN
        select  coalesce(max(PFCS_PCK_CONSTANTS.IE_YES), PFCS_PCK_CONSTANTS.IE_NO)
        into STRICT    ie_in_setup_w
        from    pfcs_task tsk
        where   tsk.si_status in (PFCS_PCK_CONSTANTS.SI_STATUS_ACCEPTED, PFCS_PCK_CONSTANTS.SI_STATUS_IN_PROGRESS)
        and     tsk.si_intent = PFCS_PCK_CONSTANTS.SI_INTENT_ORDER
        and     clock_timestamp() between tsk.period_start and coalesce(tsk.period_end, clock_timestamp())
        and     tsk.cd_task_code = PFCS_PCK_CONSTANTS.CD_TASK_OR_SETUP
        and     tsk.nr_seq_location = nr_seq_location_p;

        return ie_in_setup_w;
    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pfcs_pck_operating_rooms.get_room_in_setup (nr_seq_location_p bigint) FROM PUBLIC;
