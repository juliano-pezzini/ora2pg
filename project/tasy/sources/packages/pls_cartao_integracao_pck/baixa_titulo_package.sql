-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_cartao_integracao_pck.baixa_titulo (nr_seq_solic_pagto_p pls_solic_pagto_cartao_cr.nr_sequencia%type, nm_usuario_p usuario.nm_usuario%type) AS $body$
BEGIN

        if (not pls_cartao_integracao_pck.atualiza_situacao(nr_seq_solic_pagto_p, '0', '1', nm_usuario_p)) then
            CALL wheb_mensagem_pck.exibir_mensagem_abort(1030340); -- 'Situacao da solicitacao foi modificado antes do recebimento to retorno.'
        end if;

    end;

    /*
    Funcao para truncar nuemro de cartao de credito,
    A intencao do truncamento e que somente uma parte (sem exceder os primeiro
    seis e os ultimos quatro digitos) do PAN seja armazenado. Isso e diferente do
    mascaramento, no qual o PAN inteiro e armazenado, mas isso ocorre quando ele
    e exibido (ou seja, somente parte do PAN e exibido em telas, relatorios, recibos, etc.).
    Este requisito esta relacionado a protecao do PAN quando armazenado em
    arquivos, bancos de dados, etc, e nao devera ser confundido com o Requisito 3.3
    para protecao do PAN exibido em telas, recibos, etc.
    
    %param nr_cartao_credito_p Numero de Cartao de Credito
    %see https://pt.pcisecuritystandards.org/minisite/env2/
    %return Retorna numero de cartao de credito truncada
    */


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_cartao_integracao_pck.baixa_titulo (nr_seq_solic_pagto_p pls_solic_pagto_cartao_cr.nr_sequencia%type, nm_usuario_p usuario.nm_usuario%type) FROM PUBLIC;
