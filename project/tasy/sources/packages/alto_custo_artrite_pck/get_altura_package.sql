-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION alto_custo_artrite_pck.get_altura (nr_atendimento_p bigint) RETURNS varchar AS $body$
DECLARE


	ds_retorno_w    varchar(255);

	
BEGIN
  
		select max(qt_altura)
		into STRICT   ds_retorno_w
		from (
			SELECT  asv.qt_altura_cm qt_altura
			from    atendimento_sinal_vital asv
			where   asv.nr_atendimento = nr_atendimento_p
			and     (asv.dt_liberacao IS NOT NULL AND asv.dt_liberacao::text <> '')
			and     coalesce(asv.dt_inativacao::text, '') = ''
			and     asv.qt_altura_cm between 100 and 210
			order by asv.dt_sinal_vital desc) alias3 LIMIT 1;

		return ds_retorno_w;

	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION alto_custo_artrite_pck.get_altura (nr_atendimento_p bigint) FROM PUBLIC;
