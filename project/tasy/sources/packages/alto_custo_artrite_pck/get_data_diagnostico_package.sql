-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION alto_custo_artrite_pck.get_data_diagnostico (cd_pessoa_fisica_p text) RETURNS timestamp AS $body$
DECLARE


	ds_retorno_w timestamp;

	
BEGIN
  
		select  min(dd.dt_cid)
		into STRICT    ds_retorno_w
		from    diagnostico_doenca dd
		where   (dd.dt_cid IS NOT NULL AND dd.dt_cid::text <> '')
		and     (dd.dt_liberacao IS NOT NULL AND dd.dt_liberacao::text <> '')
		and     coalesce(dd.dt_inativacao::text, '') = ''
		and     alto_custo_pck.obter_se_tipo_doenca(dd.cd_doenca, 'A') = 'S'
		and     dd.nr_atendimento = alto_custo_pck.get_first_or_last_atendimento(cd_pessoa_fisica_p, 'A', 'F');

		return ds_retorno_w;

	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION alto_custo_artrite_pck.get_data_diagnostico (cd_pessoa_fisica_p text) FROM PUBLIC;
