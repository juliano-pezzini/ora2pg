-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_mens_itens_pck.add_item ( nr_seq_mensalidade_p pls_mensalidade.nr_sequencia%type, nr_seq_mensalidade_seg_p pls_mensalidade_segurado.nr_sequencia%type, ie_tipo_item_p pls_mensalidade_seg_item.ie_tipo_item%type, nr_seq_tipo_lanc_p pls_tipo_lanc_adic.nr_sequencia%type, vl_item_p pls_mensalidade_seg_item.vl_item%type, nr_seq_plano_p pls_mensalidade_seg_item.nr_seq_plano%type, ie_tipo_mensalidade_p pls_mensalidade_seg_item.ie_tipo_mensalidade%type, nr_seq_conta_p pls_conta.nr_sequencia%type, nr_seq_protocolo_p pls_protocolo_conta.nr_sequencia%type, vl_ato_cooperado_p pls_mensalidade_seg_item.vl_ato_cooperado%type, vl_ato_auxiliar_p pls_mensalidade_seg_item.vl_ato_auxiliar%type, vl_ato_nao_cooperado_p pls_mensalidade_seg_item.vl_ato_nao_cooperado%type, nr_seq_carteira_seg_p pls_segurado_carteira.nr_sequencia%type, nr_seq_agravo_parc_p pls_segurado_agravo_parc.nr_sequencia%type, nr_seq_regra_acrescimo_p pls_regra_acrescimo.nr_sequencia%type, nr_seq_tipo_acrescimo_p pls_tipo_acrescimo.nr_sequencia%type, nr_seq_lanc_mens_p pls_lancamento_mensalidade.nr_sequencia%type, nr_seq_lanc_aut_mens_p pls_segurado_mensalidade.nr_sequencia%type, cd_centro_custo_p pls_mensalidade_seg_item.cd_centro_custo%type, nr_seq_vinculo_sca_p pls_sca_vinculo.nr_sequencia%type, nr_parcela_sca_p pls_mensalidade_seg_item.nr_parcela_sca%type, dt_inicio_cobertura_p pls_mensalidade_seg_item.dt_inicio_cobertura%type, dt_fim_cobertura_p pls_mensalidade_seg_item.dt_fim_cobertura%type, nr_seq_segurado_p pls_segurado.nr_sequencia%type, nr_seq_titular_p pls_segurado.nr_seq_titular%type, nr_seq_seg_preco_origem_p pls_segurado_preco_origem.nr_sequencia%type, ds_mensagem_reajuste_p pls_mensalidade_seg_item.ds_mensagem_reajuste%type, ds_observacao_p pls_mensalidade_seg_item.ds_observacao%type, dt_retroativa_p pls_mensalidade_seg_item.dt_retroativa%type, nr_seq_reajuste_preco_p pls_mensalidade_seg_item.nr_seq_reajuste%type, ie_mat_proc_conta_pos_p text, nr_seq_seg_cart_ant_p pls_segurado_cart_ant.nr_sequencia%type, nr_seq_regra_susp_reaj_fx_p pls_susp_reaj_fx_etaria.nr_sequencia%type, ie_recomposicao_p pls_segurado_mensalidade.ie_recomposicao%type, tb_apropriacao_item_p tb_apropriacao_item, ie_inseriu_item_p INOUT text) AS $body$
DECLARE


ie_gerar_item_w		varchar(1);
vl_item_w		double precision;


BEGIN
ie_gerar_item_w	:= pls_mens_itens_pck.obter_se_gera_item_suspensao(ie_tipo_item_p, current_setting('pls_mens_itens_pck.nr_seq_motivo_susp_w')::pls_motivo_susp_cobr_mens.nr_sequencia%type);

if (ie_gerar_item_w = 'S') then
	current_setting('pls_mens_itens_pck.tb_nr_seq_mensalidade_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_seq_mensalidade_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_mensalidade_seg_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)	:= nr_seq_mensalidade_seg_p;
	current_setting('pls_mens_itens_pck.tb_ie_tipo_item_w')::pls_util_cta_pck.t_varchar2_table_5(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)			:= ie_tipo_item_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_tipo_lanc_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_seq_tipo_lanc_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_plano_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)			:= nr_seq_plano_p;
	current_setting('pls_mens_itens_pck.tb_ie_tipo_mensalidade_w')::pls_util_cta_pck.t_varchar2_table_1(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= ie_tipo_mensalidade_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_conta_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)			:= nr_seq_conta_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_protocolo_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_seq_protocolo_p;
	current_setting('pls_mens_itens_pck.tb_vl_ato_cooperado_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= vl_ato_cooperado_p;
	current_setting('pls_mens_itens_pck.tb_vl_ato_auxiliar_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= vl_ato_auxiliar_p;
	current_setting('pls_mens_itens_pck.tb_vl_ato_nao_cooperado_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= vl_ato_nao_cooperado_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_carteira_seg_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_seq_carteira_seg_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_agravo_parc_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_seq_agravo_parc_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_regra_acrescimo_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)	:= nr_seq_regra_acrescimo_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_tipo_acrescimo_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_seq_tipo_acrescimo_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_lanc_mens_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_seq_lanc_mens_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_lanc_aut_mens_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_seq_lanc_aut_mens_p;
	current_setting('pls_mens_itens_pck.tb_cd_centro_custo_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= cd_centro_custo_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_vinculo_sca_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_seq_vinculo_sca_p;
	current_setting('pls_mens_itens_pck.tb_nr_parcela_sca_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_parcela_sca_p;
	current_setting('pls_mens_itens_pck.tb_dt_inicio_cobertura_w')::pls_util_cta_pck.t_date_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= dt_inicio_cobertura_p;
	current_setting('pls_mens_itens_pck.tb_dt_fim_cobertura_w')::pls_util_cta_pck.t_date_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= dt_fim_cobertura_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_segurado_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_seq_segurado_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_titular_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_seq_titular_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_seg_preco_origem_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)	:= nr_seq_seg_preco_origem_p;
	current_setting('pls_mens_itens_pck.tb_ds_mensagem_reajuste_w')::pls_util_cta_pck.t_varchar2_table_4000(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= ds_mensagem_reajuste_p;
	current_setting('pls_mens_itens_pck.tb_ds_observacao_w')::pls_util_cta_pck.t_varchar2_table_4000(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)			:= ds_observacao_p;
	current_setting('pls_mens_itens_pck.tb_dt_retroativa_w')::pls_util_cta_pck.t_date_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)			:= dt_retroativa_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_reajuste_preco_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_seq_reajuste_preco_p;
	current_setting('pls_mens_itens_pck.tb_nr_seq_seg_cart_ant_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= nr_seq_seg_cart_ant_p;
	current_setting('pls_mens_itens_pck.tb_apropriacao_item_w')::tb_apropriacao_item_t(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= tb_apropriacao_item_p;
	current_setting('pls_mens_itens_pck.tb_vl_item_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)			:= vl_item_p;
	current_setting('pls_mens_itens_pck.tb_dt_mesano_referencia_w')::pls_util_cta_pck.t_date_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= current_setting('pls_mens_itens_pck.dt_mesano_referencia_w')::pls_mensalidade_segurado.dt_mesano_referencia%type;
	current_setting('pls_mens_itens_pck.tb_dt_referencia_w')::pls_util_cta_pck.t_date_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)			:= current_setting('pls_mens_itens_pck.dt_referencia_w')::pls_mensalidade.dt_referencia%type;
	current_setting('pls_mens_itens_pck.tb_nr_seq_regra_susp_reaj_fx_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)	:= nr_seq_regra_susp_reaj_fx_p;
	current_setting('pls_mens_itens_pck.tb_vl_sca_embutido_w')::pls_util_cta_pck.t_number_table(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= 0;
	current_setting('pls_mens_itens_pck.tb_ie_valor_apropriado_w')::pls_util_cta_pck.t_varchar2_table_1(current_setting('pls_mens_itens_pck.nr_indice_w')::integer)		:= 'N';
	current_setting('pls_mens_itens_pck.tb_ie_recomposicao_w')::pls_util_cta_pck.t_varchar2_table_1(current_setting('pls_mens_itens_pck.nr_indice_w')::integer) 		:= ie_recomposicao_p;
	PERFORM set_config('pls_mens_itens_pck.nr_indice_w', current_setting('pls_mens_itens_pck.nr_indice_w')::integer + 1, false);
	
	PERFORM set_config('pls_mens_itens_pck.ie_gerou_item_benef_w', 'S', false);
end if;

ie_inseriu_item_p	:= ie_gerar_item_w;
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_mens_itens_pck.add_item ( nr_seq_mensalidade_p pls_mensalidade.nr_sequencia%type, nr_seq_mensalidade_seg_p pls_mensalidade_segurado.nr_sequencia%type, ie_tipo_item_p pls_mensalidade_seg_item.ie_tipo_item%type, nr_seq_tipo_lanc_p pls_tipo_lanc_adic.nr_sequencia%type, vl_item_p pls_mensalidade_seg_item.vl_item%type, nr_seq_plano_p pls_mensalidade_seg_item.nr_seq_plano%type, ie_tipo_mensalidade_p pls_mensalidade_seg_item.ie_tipo_mensalidade%type, nr_seq_conta_p pls_conta.nr_sequencia%type, nr_seq_protocolo_p pls_protocolo_conta.nr_sequencia%type, vl_ato_cooperado_p pls_mensalidade_seg_item.vl_ato_cooperado%type, vl_ato_auxiliar_p pls_mensalidade_seg_item.vl_ato_auxiliar%type, vl_ato_nao_cooperado_p pls_mensalidade_seg_item.vl_ato_nao_cooperado%type, nr_seq_carteira_seg_p pls_segurado_carteira.nr_sequencia%type, nr_seq_agravo_parc_p pls_segurado_agravo_parc.nr_sequencia%type, nr_seq_regra_acrescimo_p pls_regra_acrescimo.nr_sequencia%type, nr_seq_tipo_acrescimo_p pls_tipo_acrescimo.nr_sequencia%type, nr_seq_lanc_mens_p pls_lancamento_mensalidade.nr_sequencia%type, nr_seq_lanc_aut_mens_p pls_segurado_mensalidade.nr_sequencia%type, cd_centro_custo_p pls_mensalidade_seg_item.cd_centro_custo%type, nr_seq_vinculo_sca_p pls_sca_vinculo.nr_sequencia%type, nr_parcela_sca_p pls_mensalidade_seg_item.nr_parcela_sca%type, dt_inicio_cobertura_p pls_mensalidade_seg_item.dt_inicio_cobertura%type, dt_fim_cobertura_p pls_mensalidade_seg_item.dt_fim_cobertura%type, nr_seq_segurado_p pls_segurado.nr_sequencia%type, nr_seq_titular_p pls_segurado.nr_seq_titular%type, nr_seq_seg_preco_origem_p pls_segurado_preco_origem.nr_sequencia%type, ds_mensagem_reajuste_p pls_mensalidade_seg_item.ds_mensagem_reajuste%type, ds_observacao_p pls_mensalidade_seg_item.ds_observacao%type, dt_retroativa_p pls_mensalidade_seg_item.dt_retroativa%type, nr_seq_reajuste_preco_p pls_mensalidade_seg_item.nr_seq_reajuste%type, ie_mat_proc_conta_pos_p text, nr_seq_seg_cart_ant_p pls_segurado_cart_ant.nr_sequencia%type, nr_seq_regra_susp_reaj_fx_p pls_susp_reaj_fx_etaria.nr_sequencia%type, ie_recomposicao_p pls_segurado_mensalidade.ie_recomposicao%type, tb_apropriacao_item_p tb_apropriacao_item, ie_inseriu_item_p INOUT text) FROM PUBLIC;
