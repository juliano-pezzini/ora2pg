-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_mens_itens_pck.inserir_mensalidade_sca ( cd_estabelecimento_p estabelecimento.cd_estabelecimento%type, nm_usuario_p usuario.nm_usuario%type) AS $body$
BEGIN
if (current_setting('pls_mens_itens_pck.tb_sca_nr_seq_item_w')::pls_util_cta_pck.t_number_table.count > 0) then
	forall i in current_setting('pls_mens_itens_pck.tb_sca_nr_seq_item_w')::pls_util_cta_pck.t_number_table.first..tb_sca_nr_seq_item_w.last
		insert	into	pls_mensalidade_sca(	nr_sequencia, nr_seq_item_mens, cd_estabelecimento,
				nr_seq_vinculo_sca, nr_parcela, vl_parcela,
				dt_atualizacao, nm_usuario, dt_atualizacao_nrec,
				nm_usuario_nrec, nr_seq_segurado, nr_seq_segurado_preco,
				nr_seq_mensalidade, dt_inicio_cobertura, dt_fim_cobertura)
			values (	nextval('pls_mensalidade_sca_seq'), current_setting('pls_mens_itens_pck.tb_sca_nr_seq_item_w')::pls_util_cta_pck.t_number_table(i), cd_estabelecimento_p,
				current_setting('pls_mens_itens_pck.tb_sca_nr_seq_vinculo_w')::pls_util_cta_pck.t_number_table(i), current_setting('pls_mens_itens_pck.tb_sca_nr_parcela_w')::pls_util_cta_pck.t_number_table(i), current_setting('pls_mens_itens_pck.tb_sca_vl_parcela_w')::pls_util_cta_pck.t_number_table(i),
				clock_timestamp(), nm_usuario_p, clock_timestamp(),
				nm_usuario_p, current_setting('pls_mens_itens_pck.tb_sca_nr_seq_segurado_w')::pls_util_cta_pck.t_number_table(i), current_setting('pls_mens_itens_pck.tb_sca_nr_seq_preco_w')::pls_util_cta_pck.t_number_table(i),
				current_setting('pls_mens_itens_pck.tb_sca_nr_seq_mensalidade_w')::pls_util_cta_pck.t_number_table(i), current_setting('pls_mens_itens_pck.tb_sca_dt_inicio_cobertura_w')::pls_util_cta_pck.t_date_table(i), current_setting('pls_mens_itens_pck.tb_sca_dt_fim_cobertura_w')::pls_util_cta_pck.t_date_table(i));
	commit;
end if;

current_setting('pls_mens_itens_pck.tb_sca_nr_seq_item_w')::pls_util_cta_pck.t_number_table.delete;
current_setting('pls_mens_itens_pck.tb_sca_nr_seq_mensalidade_w')::pls_util_cta_pck.t_number_table.delete;
current_setting('pls_mens_itens_pck.tb_sca_nr_seq_vinculo_w')::pls_util_cta_pck.t_number_table.delete;
current_setting('pls_mens_itens_pck.tb_sca_nr_parcela_w')::pls_util_cta_pck.t_number_table.delete;
current_setting('pls_mens_itens_pck.tb_sca_vl_parcela_w')::pls_util_cta_pck.t_number_table.delete;
current_setting('pls_mens_itens_pck.tb_sca_nr_seq_segurado_w')::pls_util_cta_pck.t_number_table.delete;
current_setting('pls_mens_itens_pck.tb_sca_nr_seq_preco_w')::pls_util_cta_pck.t_number_table.delete;
current_setting('pls_mens_itens_pck.tb_sca_dt_inicio_cobertura_w')::pls_util_cta_pck.t_date_table.delete;
current_setting('pls_mens_itens_pck.tb_sca_dt_fim_cobertura_w')::pls_util_cta_pck.t_date_table.delete;
PERFORM set_config('pls_mens_itens_pck.nr_indice_sca_w', 0, false);
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_mens_itens_pck.inserir_mensalidade_sca ( cd_estabelecimento_p estabelecimento.cd_estabelecimento%type, nm_usuario_p usuario.nm_usuario%type) FROM PUBLIC;
