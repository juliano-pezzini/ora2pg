-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pls_mens_itens_pck.obter_se_sca_gerado ( nr_seq_vinculo_sca_p pls_sca_vinculo.nr_sequencia%type, nr_parcela_sca_p pls_mensalidade_seg_item.nr_parcela_sca%type, ie_lancamento_mensalidade_p pls_sca_vinculo.ie_lancamento_mensalidade%type, dt_inicio_cobertura_p pls_mensalidade_sca.dt_inicio_cobertura%type, dt_fim_cobertura_p pls_mensalidade_sca.dt_fim_cobertura%type) RETURNS bigint AS $body$
BEGIN
if (ie_lancamento_mensalidade_p = 'D') then
	if (current_setting('pls_mens_itens_pck.tb_nr_seq_mensalidade_seg_w')::pls_util_cta_pck.t_number_table.count > 0) then
		for i in current_setting('pls_mens_itens_pck.tb_nr_seq_mensalidade_seg_w')::pls_util_cta_pck.t_number_table.first..tb_nr_seq_mensalidade_seg_w.last loop
			begin
			if (nr_seq_vinculo_sca_p = current_setting('pls_mens_itens_pck.tb_nr_seq_vinculo_sca_w')::pls_util_cta_pck.t_number_table(i)) and (nr_parcela_sca_p = current_setting('pls_mens_itens_pck.tb_nr_parcela_sca_w')::pls_util_cta_pck.t_number_table(i)) and (current_setting('pls_mens_itens_pck.tb_dt_fim_cobertura_w')::pls_util_cta_pck.t_date_table(i) >= dt_inicio_cobertura_p and current_setting('pls_mens_itens_pck.tb_dt_inicio_cobertura_w')::pls_util_cta_pck.t_date_table(i) <= dt_fim_cobertura_p) then
				return 1;
			end if;
			end;
		end loop;
	end if;
else
	if (current_setting('pls_mens_itens_pck.tb_sca_seq_mensalidade_w')::pls_util_cta_pck.t_number_table.count > 0) then
		for i in current_setting('pls_mens_itens_pck.tb_sca_seq_mensalidade_w')::pls_util_cta_pck.t_number_table.first..tb_sca_seq_mensalidade_w.last loop
			begin
			if (nr_seq_vinculo_sca_p = current_setting('pls_mens_itens_pck.tb_sca_nr_seq_vinculo_sca_w')::pls_util_cta_pck.t_number_table(i)) and (nr_parcela_sca_p = current_setting('pls_mens_itens_pck.tb_sca_parcela_w')::pls_util_cta_pck.t_number_table(i)) and (current_setting('pls_mens_itens_pck.tb_sca_fim_cobertura_w')::pls_util_cta_pck.t_date_table(i) >= dt_inicio_cobertura_p and current_setting('pls_mens_itens_pck.tb_sca_inicio_cobertura_w')::pls_util_cta_pck.t_date_table(i) <= dt_fim_cobertura_p) then
				return 1;
			end if;
			end;
		end loop;
	end if;
end if;

if (current_setting('pls_mens_itens_pck.tb_sca_nr_seq_mensalidade_w')::pls_util_cta_pck.t_number_table.count > 0) then
	for i in current_setting('pls_mens_itens_pck.tb_sca_nr_seq_mensalidade_w')::pls_util_cta_pck.t_number_table.first..tb_sca_nr_seq_mensalidade_w.last loop
		begin
		if (nr_seq_vinculo_sca_p = current_setting('pls_mens_itens_pck.tb_sca_nr_seq_vinculo_w')::pls_util_cta_pck.t_number_table(i)) and (nr_parcela_sca_p = current_setting('pls_mens_itens_pck.tb_sca_nr_parcela_w')::pls_util_cta_pck.t_number_table(i)) and (current_setting('pls_mens_itens_pck.tb_sca_dt_fim_cobertura_w')::pls_util_cta_pck.t_date_table(i) >= dt_inicio_cobertura_p and current_setting('pls_mens_itens_pck.tb_sca_dt_inicio_cobertura_w')::pls_util_cta_pck.t_date_table(i) <= dt_fim_cobertura_p) then
			return 1;
		end if;
		end;
	end loop;
end if;

return 0;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pls_mens_itens_pck.obter_se_sca_gerado ( nr_seq_vinculo_sca_p pls_sca_vinculo.nr_sequencia%type, nr_parcela_sca_p pls_mensalidade_seg_item.nr_parcela_sca%type, ie_lancamento_mensalidade_p pls_sca_vinculo.ie_lancamento_mensalidade%type, dt_inicio_cobertura_p pls_mensalidade_sca.dt_inicio_cobertura%type, dt_fim_cobertura_p pls_mensalidade_sca.dt_fim_cobertura%type) FROM PUBLIC;
