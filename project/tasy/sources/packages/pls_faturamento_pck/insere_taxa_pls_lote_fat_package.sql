-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_faturamento_pck.insere_taxa_pls_lote_fat ( nr_seq_lote_p pls_lote_faturamento.nr_sequencia%type, cd_estabelecimento_p estabelecimento.cd_estabelecimento%type, nm_usuario_p usuario.nm_usuario%type, ie_processo_p text ) AS $body$
DECLARE

					
-- Gera as taxas conforme os itens ja existentes na w_pls_lote_fat_proc e w_pls_lote_fat_mat
-- As taxas serao inseridas na propria w_pls_lote_fat_proc e w_pls_lote_fat_mat, para que sejam processados.
-- tabelas virtuais
tb_cd_guia_ok_w			dbms_sql.varchar2_table;
tb_dt_atendimento_ref_w		dbms_sql.date_table;
tb_dt_emissao_conta_w		dbms_sql.date_table;
tb_dt_inicio_faturamento_w	dbms_sql.date_table;
tb_ie_prestador_a400_w		dbms_sql.varchar2_table;
tb_ie_tipo_guia_w		dbms_sql.varchar2_table;
tb_nr_seq_congenere_w		dbms_sql.number_table;
tb_nr_seq_conta_w		dbms_sql.number_table;
tb_nr_seq_conta_proc_w		dbms_sql.number_table;
tb_nr_seq_conta_mat_w		dbms_sql.number_table;
tb_nr_seq_evento_fat_w		dbms_sql.number_table;
tb_nr_seq_lote_fat_w		dbms_sql.number_table;
tb_nr_seq_pos_proc_w		dbms_sql.number_table;
tb_nr_seq_pos_proc_fat_w	dbms_sql.number_table;
tb_nr_seq_pos_mat_w		dbms_sql.number_table;
tb_nr_seq_pos_mat_fat_w		dbms_sql.number_table;
tb_nr_seq_segurado_w		dbms_sql.number_table;
tb_ie_tipo_guia_princ_w		dbms_sql.varchar2_table;
tb_nr_seq_tipo_atend_w		dbms_sql.number_table;
tb_nr_seq_tipo_conta_w		dbms_sql.number_table;
tb_ie_origem_conta_w		dbms_sql.varchar2_table;
tb_ie_tipo_segurado_w		dbms_sql.varchar2_table;
tb_ie_internado_w		dbms_sql.varchar2_table;
tb_ie_tipo_intercambio_w	dbms_sql.varchar2_table;
tb_ie_tipo_conta_w		dbms_sql.varchar2_table;
tb_ie_pcmso_w			dbms_sql.varchar2_table;
tb_nr_seq_plano_w		dbms_sql.number_table;
tb_nr_seq_class_sca_w		dbms_sql.number_table;
tb_ie_tipo_despesa_proc_w	dbms_sql.varchar2_table;
tb_ie_tipo_despesa_w		dbms_sql.varchar2_table;
tb_cd_procedimento_w		dbms_sql.number_table;
tb_cd_area_procedimento_w	dbms_sql.number_table;
tb_cd_especialidade_w		dbms_sql.number_table;
tb_cd_grupo_proc_w		dbms_sql.number_table;
tb_ie_preco_w			dbms_sql.varchar2_table;
tb_nr_seq_grupo_rec_w		dbms_sql.number_table;
tb_dt_procedimento_ref_w	dbms_sql.date_table;
tb_dt_material_ref_w		dbms_sql.date_table;
tb_cd_prestador_w		dbms_sql.varchar2_table;
tb_nr_seq_tipo_prestador_w	dbms_sql.number_table;
tb_ie_tipo_pessoa_prest_w	dbms_sql.varchar2_table;
tb_ie_tipo_relacao_w		dbms_sql.varchar2_table;
tb_nr_seq_classif_prest_w	dbms_sql.number_table;
tb_ie_ato_cooperado_w		dbms_sql.varchar2_table;
tb_ie_ato_cooperado_pag_w	dbms_sql.varchar2_table;
tb_nr_seq_prestador_exec_w	dbms_sql.number_table;
tb_nr_seq_prestador_pgto_w	dbms_sql.number_table;
tb_ie_apresentacao_prot_w	dbms_sql.varchar2_table;
tb_ie_tipo_pess_prest_atend_w	dbms_sql.varchar2_table;
tb_ie_tipo_pess_prest_ptu_w	dbms_sql.varchar2_table;
tb_ie_tipo_pess_prest_solic_w	dbms_sql.varchar2_table;
tb_ie_origem_analise_pos_w	dbms_sql.varchar2_table;
tb_ie_tipo_cobranca_w		dbms_sql.varchar2_table;
tb_vl_item_w			dbms_sql.number_table;
tb_vl_item_ndc_w		dbms_sql.number_table;
tb_nr_seq_regra_inter_w		dbms_sql.number_table;
tb_dt_alta_w			dbms_sql.date_table;
tb_nr_seq_pos_proc_tx_w		dbms_sql.number_table;
tb_nr_seq_pos_mat_tx_w		dbms_sql.number_table;
tb_ie_tipo_protocolo_w		dbms_sql.varchar2_table;
tb_ie_origem_protocolo_w	dbms_sql.varchar2_table;
tb_ie_tipo_pessoa_prest_pag_w	dbms_sql.varchar2_table;
tb_cd_usuario_plano_w		dbms_sql.varchar2_table;
tb_nr_seq_pagador_w		dbms_sql.number_table;
tb_nr_seq_contrato_w		dbms_sql.number_table;
tb_nr_seq_intercambio_w		dbms_sql.number_table;
tb_nr_seq_ops_congenere_w	dbms_sql.number_table;
tb_ie_fat_data_alt_pre_w	dbms_sql.varchar2_table;
tb_nr_seq_protocolo_w		dbms_sql.number_table;
tb_nr_seq_congenere_prot_w	dbms_sql.number_table;
tb_nr_seq_conta_princ_w		dbms_sql.number_table;
tb_nr_seq_pos_proc_tx_fat_w	dbms_sql.number_table;
tb_nr_seq_pos_mat_tx_fat_w	dbms_sql.number_table;
tb_nr_agrupamento_w		dbms_sql.number_table;
tb_nr_seq_regra_fat_w		dbms_sql.number_table;
tb_cd_guia_referencia_w		dbms_sql.varchar2_table;
tb_ie_origem_proced_w		dbms_sql.number_table;
current_setting('pls_faturamento_pck.qt_registro_w')::integer			integer;

c00 CURSOR(	nr_seq_lote_pc	pls_lote_faturamento.nr_sequencia%type) FOR
	SELECT	nr_seq_conta
	from (SELECT	w.nr_seq_conta
		from	w_pls_lote_fat_proc w
		where	nr_seq_lote_fat = nr_seq_lote_pc
		and	not exists (select 1 from pls_conta_pos_proc_tx t where t.nr_seq_conta_pos_proc = w.nr_seq_pos_proc)
		
union

		select	w.nr_seq_conta
		from	w_pls_lote_fat_mat w
		where	w.nr_seq_lote_fat = nr_seq_lote_pc
		and	not exists (select 1 from pls_conta_pos_mat_tx t where t.nr_seq_conta_mat_pos = w.nr_seq_pos_mat)) alias3
	group by nr_seq_conta;

-- carrega as taxas existentes no pos - Proc
c01 CURSOR(	nr_seq_lote_pc	pls_lote_faturamento.nr_sequencia%type,
		ie_processo_pc	text ) FOR
	-- Tem pagamento medico e com divisao de pagamento
	SELECT	w.cd_guia_ok,				w.dt_atendimento_ref,			w.dt_emissao_conta,
		w.dt_inicio_faturamento,		w.ie_prestador_a400,			w.ie_tipo_guia,
		w.nr_seq_congenere,			w.nr_seq_conta,				w.nr_seq_conta_proc,
		w.nr_seq_evento_fat,			w.nr_seq_lote_fat,			w.nr_seq_pos_proc,
		w.nr_seq_pos_proc_fat,			w.nr_seq_segurado,			w.ie_tipo_guia_princ,
		w.nr_seq_tipo_atendimento,		w.nr_seq_tipo_conta,			w.ie_origem_conta,
		w.ie_tipo_segurado,			w.ie_internado,				w.ie_tipo_intercambio,
		w.ie_tipo_conta,			w.ie_pcmso,				w.nr_seq_plano,
		w.nr_seq_classificacao_sca,		w.ie_tipo_despesa_proc,			w.cd_procedimento,
		w.cd_area_procedimento,			w.cd_especialidade,			w.cd_grupo_proc,
		w.ie_preco,				w.nr_seq_grupo_rec,			w.dt_procedimento_ref,
		w.cd_prestador,				w.nr_seq_tipo_prestador,		w.ie_tipo_pessoa_prest,
		w.ie_tipo_relacao,			w.nr_seq_classif_prest,			w.ie_ato_cooperado,
		w.nr_seq_prestador_exec,		w.nr_seq_prestador_pgto,		w.ie_apresentacao_prot,
		w.ie_tipo_pessoa_prest_atend,		w.ie_tipo_pessoa_prest_ptu,		w.ie_tipo_pessoa_prest_solic,
		w.ie_origem_analise_pos,		CASE WHEN c.ie_tipo_taxa='1' THEN  '4' WHEN c.ie_tipo_taxa='2' THEN  '3' END  ie_tipo_cobranca,
		0 vl_item,				d.vl_taxa vl_item_ndc,			w.nr_seq_regra_inter,
		w.dt_alta,				c.nr_sequencia nr_seq_pos_proc_tx,	w.ie_tipo_protocolo,
		w.ie_origem_protocolo,			w.ie_ato_cooperado_pag,			w.ie_tipo_pessoa_prest_pag,
		w.cd_usuario_plano,			w.nr_seq_pagador,			w.nr_seq_contrato,
		w.nr_seq_intercambio,			w.nr_seq_ops_congenere,			w.ie_fat_data_alt_pre,
		w.nr_seq_protocolo,			w.nr_seq_congenere_prot,		w.nr_seq_conta_princ,
		d.nr_sequencia nr_seq_pos_proc_tx_fat,	w.nr_agrupamento,			w.nr_seq_regra_fat,
		w.cd_guia_referencia,			w.ie_origem_proced
	FROM w_pls_lote_fat_proc w, pls_conta_pos_proc_tx c, pls_conta_pos_proc a, pls_conta_pos_proc_tx_fat d
LEFT OUTER JOIN pls_conta_pos_proc_fat b ON (d.nr_seq_conta_resumo = b.nr_seq_conta_resumo)
WHERE a.nr_sequencia			= b.nr_seq_conta_pos_proc and a.nr_sequencia			= c.nr_seq_conta_pos_proc and c.nr_sequencia			= d.nr_seq_proc_pos_tx --and	b.nr_seq_conta(+)		= d.nr_seq_conta
  and a.nr_sequencia			= w.nr_seq_pos_proc and b.nr_sequencia			= w.nr_seq_pos_proc_fat and w.nr_seq_lote_fat		= nr_seq_lote_pc and a.ie_status_faturamento		= 'L' and d.vl_taxa			> 0 and coalesce(w.nr_seq_pos_proc_tx::text, '') = '' and ie_processo_pc			!= 'CF';
	
-- carrega as taxas existentes no pos - Proc
current_setting('pls_faturamento_pck.c03')::CURSOR( CURSOR(	nr_seq_lote_pc	pls_lote_faturamento.nr_sequencia%type,
		ie_processo_pc	text) FOR
	-- Nao teve pagamento medico e nao tem divisao de pagamento
	SELECT	w.cd_guia_ok,				w.dt_atendimento_ref,			w.dt_emissao_conta,
		w.dt_inicio_faturamento,		w.ie_prestador_a400,			w.ie_tipo_guia,
		w.nr_seq_congenere,			w.nr_seq_conta,				w.nr_seq_conta_proc,
		w.nr_seq_evento_fat,			w.nr_seq_lote_fat,			w.nr_seq_pos_proc,
		w.nr_seq_pos_proc_fat,			w.nr_seq_segurado,			w.ie_tipo_guia_princ,
		w.nr_seq_tipo_atendimento,		w.nr_seq_tipo_conta,			w.ie_origem_conta,
		w.ie_tipo_segurado,			w.ie_internado,				w.ie_tipo_intercambio,
		w.ie_tipo_conta,			w.ie_pcmso,				w.nr_seq_plano,
		w.nr_seq_classificacao_sca,		w.ie_tipo_despesa_proc,			w.cd_procedimento,
		w.cd_area_procedimento,			w.cd_especialidade,			w.cd_grupo_proc,
		w.ie_preco,				w.nr_seq_grupo_rec,			w.dt_procedimento_ref,
		w.cd_prestador,				w.nr_seq_tipo_prestador,		w.ie_tipo_pessoa_prest,
		w.ie_tipo_relacao,			w.nr_seq_classif_prest,			w.ie_ato_cooperado,
		w.nr_seq_prestador_exec,		w.nr_seq_prestador_pgto,		w.ie_apresentacao_prot,
		w.ie_tipo_pessoa_prest_atend,		w.ie_tipo_pessoa_prest_ptu,		w.ie_tipo_pessoa_prest_solic,
		w.ie_origem_analise_pos,		CASE WHEN c.ie_tipo_taxa='1' THEN  '4' WHEN c.ie_tipo_taxa='2' THEN  '3' END  ie_tipo_cobranca,
		0 vl_item,				d.vl_taxa vl_item_ndc,			w.nr_seq_regra_inter,
		w.dt_alta,				c.nr_sequencia nr_seq_pos_proc_tx,	w.ie_tipo_protocolo,
		w.ie_origem_protocolo,			w.ie_ato_cooperado_pag,			w.ie_tipo_pessoa_prest_pag,
		w.cd_usuario_plano,			w.nr_seq_pagador,			w.nr_seq_contrato,
		w.nr_seq_intercambio,			w.nr_seq_ops_congenere,			w.ie_fat_data_alt_pre,
		w.nr_seq_protocolo,			w.nr_seq_congenere_prot,		w.nr_seq_conta_princ,
		d.nr_sequencia nr_seq_pos_proc_tx_fat,	w.nr_agrupamento,			w.nr_seq_regra_fat,
		w.cd_guia_referencia,			w.ie_origem_proced
	from	pls_conta_pos_proc_tx_fat	d,
		pls_conta_pos_proc_tx		c,
		pls_conta_pos_proc_fat		b,
		pls_conta_pos_proc		a,
		w_pls_lote_fat_proc		w
	where	a.nr_sequencia			= b.nr_seq_conta_pos_proc
	and	a.nr_sequencia			= c.nr_seq_conta_pos_proc
	and	c.nr_sequencia			= d.nr_seq_proc_pos_tx
	and	a.nr_sequencia			= w.nr_seq_pos_proc
	and	b.nr_sequencia			= w.nr_seq_pos_proc_fat
	and	w.nr_seq_lote_fat		= nr_seq_lote_pc
	and	a.ie_status_faturamento		= 'L'
	and	d.vl_taxa			> 0
	and	coalesce(w.nr_seq_pos_proc_tx::text, '') = ''
	and	not exists (SELECT	1
				from	w_pls_lote_fat_proc x
				where	x.nr_seq_pos_proc_tx_fat	= d.nr_sequencia);

-- carrega as taxas existentes no pos - Mat
c02 CURSOR(	nr_seq_lote_pc	pls_lote_faturamento.nr_sequencia%type,
		ie_processo_pc	text) FOR
	-- Tem pagamento medico e com divisao de pagamento
	SELECT	w.cd_guia_ok,				w.dt_atendimento_ref,			w.dt_emissao_conta,
		w.dt_inicio_faturamento,		w.ie_prestador_a400,			w.ie_tipo_guia,
		w.nr_seq_congenere,			w.nr_seq_conta,				w.nr_seq_conta_mat,
		w.nr_seq_evento_fat,			w.nr_seq_lote_fat,			w.nr_seq_pos_mat,
		w.nr_seq_pos_mat_fat,			w.nr_seq_segurado,			w.ie_tipo_guia_princ,
		w.nr_seq_tipo_atendimento,		w.nr_seq_tipo_conta,			w.ie_origem_conta,
		w.ie_tipo_segurado,			w.ie_internado,				w.ie_tipo_intercambio,
		w.ie_tipo_conta,			w.ie_pcmso,				w.nr_seq_plano,
		w.nr_seq_classificacao_sca,		w.ie_tipo_despesa,			w.ie_preco,
		w.nr_seq_grupo_rec,			w.dt_material_ref,			w.cd_prestador,
		w.nr_seq_tipo_prestador,		w.ie_tipo_pessoa_prest,			w.ie_tipo_relacao,
		w.nr_seq_classif_prest,			w.ie_ato_cooperado,			w.nr_seq_prestador_pgto,
		w.ie_apresentacao_prot,			w.ie_tipo_pessoa_prest_atend,		w.ie_tipo_pessoa_prest_ptu,
		w.ie_tipo_pessoa_prest_solic,		w.ie_origem_analise_pos,		CASE WHEN c.ie_tipo_taxa='1' THEN  '4' WHEN c.ie_tipo_taxa='2' THEN  '3' END  ie_tipo_cobranca,
		0 vl_item,				d.vl_taxa vl_item_ndc,			w.nr_seq_regra_inter,
		w.dt_alta,				c.nr_sequencia nr_seq_pos_mat_tx,	w.ie_tipo_protocolo,
		w.ie_origem_protocolo,			w.ie_ato_cooperado_pag,			w.ie_tipo_pessoa_prest_pag,
		w.cd_usuario_plano,			w.nr_seq_pagador,			w.nr_seq_contrato,
		w.nr_seq_intercambio,			w.nr_seq_ops_congenere,			w.ie_fat_data_alt_pre,
		w.nr_seq_protocolo,			w.nr_seq_congenere_prot,		w.nr_seq_conta_princ,
		d.nr_sequencia nr_seq_pos_mat_tx_fat,	w.nr_agrupamento,			w.nr_seq_regra_fat,
		w.cd_guia_referencia
	FROM w_pls_lote_fat_mat w, pls_conta_pos_mat_tx c, pls_conta_pos_mat a, pls_conta_pos_mat_tx_fat d
LEFT OUTER JOIN pls_conta_pos_mat_fat b ON (d.nr_seq_conta_resumo = b.nr_seq_conta_resumo)
WHERE a.nr_sequencia			= b.nr_seq_conta_mat_pos and a.nr_sequencia			= c.nr_seq_conta_mat_pos and c.nr_sequencia			= d.nr_seq_pos_mat_tx --and	b.nr_seq_conta(+)		= d.nr_seq_conta
  and a.nr_sequencia			= w.nr_seq_pos_mat and b.nr_sequencia			= w.nr_seq_pos_mat_fat and w.nr_seq_lote_fat		= nr_seq_lote_pc and a.ie_status_faturamento		= 'L' and d.vl_taxa			> 0 and coalesce(w.nr_seq_pos_mat_tx::text, '') = '' and ie_processo_pc			!= 'CF';

-- carrega as taxas existentes no pos - Mat
current_setting('pls_faturamento_pck.c04')::CURSOR( CURSOR(	nr_seq_lote_pc	pls_lote_faturamento.nr_sequencia%type,
		ie_processo_pc	text ) FOR
	-- Nao teve pagamento medico e nao tem divisao de pagamento
	SELECT	w.cd_guia_ok,				w.dt_atendimento_ref,			w.dt_emissao_conta,
		w.dt_inicio_faturamento,		w.ie_prestador_a400,			w.ie_tipo_guia,
		w.nr_seq_congenere,			w.nr_seq_conta,				w.nr_seq_conta_mat,
		w.nr_seq_evento_fat,			w.nr_seq_lote_fat,			w.nr_seq_pos_mat,
		w.nr_seq_pos_mat_fat,			w.nr_seq_segurado,			w.ie_tipo_guia_princ,
		w.nr_seq_tipo_atendimento,		w.nr_seq_tipo_conta,			w.ie_origem_conta,
		w.ie_tipo_segurado,			w.ie_internado,				w.ie_tipo_intercambio,
		w.ie_tipo_conta,			w.ie_pcmso,				w.nr_seq_plano,
		w.nr_seq_classificacao_sca,		w.ie_tipo_despesa,			w.ie_preco,
		w.nr_seq_grupo_rec,			w.dt_material_ref,			w.cd_prestador,
		w.nr_seq_tipo_prestador,		w.ie_tipo_pessoa_prest,			w.ie_tipo_relacao,
		w.nr_seq_classif_prest,			w.ie_ato_cooperado,			w.nr_seq_prestador_pgto,
		w.ie_apresentacao_prot,			w.ie_tipo_pessoa_prest_atend,		w.ie_tipo_pessoa_prest_ptu,
		w.ie_tipo_pessoa_prest_solic,		w.ie_origem_analise_pos,		CASE WHEN c.ie_tipo_taxa='1' THEN  '4' WHEN c.ie_tipo_taxa='2' THEN  '3' END  ie_tipo_cobranca,
		0 vl_item,				d.vl_taxa vl_item_ndc,			w.nr_seq_regra_inter,
		w.dt_alta,				c.nr_sequencia nr_seq_pos_mat_tx,	w.ie_tipo_protocolo,
		w.ie_origem_protocolo,			w.ie_ato_cooperado_pag,			w.ie_tipo_pessoa_prest_pag,
		w.cd_usuario_plano,			w.nr_seq_pagador,			w.nr_seq_contrato,
		w.nr_seq_intercambio,			w.nr_seq_ops_congenere,			w.ie_fat_data_alt_pre,
		w.nr_seq_protocolo,			w.nr_seq_congenere_prot,		w.nr_seq_conta_princ,
		d.nr_sequencia nr_seq_pos_mat_tx_fat,	w.nr_agrupamento,			w.nr_seq_regra_fat,
		w.cd_guia_referencia
	from	pls_conta_pos_mat_tx_fat	d,
		pls_conta_pos_mat_tx		c,
		pls_conta_pos_mat_fat		b,
		pls_conta_pos_mat		a,
		w_pls_lote_fat_mat		w
	where	a.nr_sequencia			= b.nr_seq_conta_mat_pos
	and	a.nr_sequencia			= c.nr_seq_conta_mat_pos
	and	c.nr_sequencia			= d.nr_seq_pos_mat_tx
	and	a.nr_sequencia			= w.nr_seq_pos_mat
	and	b.nr_sequencia			= w.nr_seq_pos_mat_fat
	and	w.nr_seq_lote_fat		= nr_seq_lote_pc
	and	a.ie_status_faturamento		= 'L'
	and	d.vl_taxa			> 0
	and	coalesce(w.nr_seq_pos_mat_tx::text, '') = ''
	and	not exists (SELECT	1
				from	w_pls_lote_fat_mat x
				where	x.nr_seq_pos_mat_tx_fat	= d.nr_sequencia);
	
BEGIN
select	count(1)
into STRICT	current_setting('pls_faturamento_pck.qt_registro_w')::integer
from	pls_fatura_log
where	nr_seq_lote	= nr_seq_lote_p
and	ie_opcao	= 'GL';

if (current_setting('pls_faturamento_pck.qt_registro_w')::integer < 2) and (ie_processo_p != 'CF') then -- So deve processar as contas na primeira geracao do lote de faturamento e nao e uma conta fechada
	-- limpa as taxas ja gerada, caso existam
	delete	FROM w_pls_lote_fat_proc
	where	(nr_seq_pos_proc_tx IS NOT NULL AND nr_seq_pos_proc_tx::text <> '')
	and	nr_seq_lote_fat		= nr_seq_lote_p;

	-- limpa as taxas ja gerada, caso existam
	delete	FROM w_pls_lote_fat_mat
	where	(nr_seq_pos_mat_tx IS NOT NULL AND nr_seq_pos_mat_tx::text <> '')
	and	nr_seq_lote_fat		= nr_seq_lote_p;


	for r_c00_w in c00( nr_seq_lote_p ) loop
		-- Gerar taxa para conta que nao possui
		CALL pls_pos_estabelecido_pck.processa_taxa_adm_pos( r_c00_w.nr_seq_conta, nm_usuario_p, cd_estabelecimento_p);
	end loop;
end if;

-- Carrega as taxas originarias de procedimentos
open c01(nr_seq_lote_p,ie_processo_p);
loop
fetch c01 bulk collect into	tb_cd_guia_ok_w,			tb_dt_atendimento_ref_w,		tb_dt_emissao_conta_w,
				tb_dt_inicio_faturamento_w,		tb_ie_prestador_a400_w,			tb_ie_tipo_guia_w,
				tb_nr_seq_congenere_w,			tb_nr_seq_conta_w,			tb_nr_seq_conta_proc_w,
				tb_nr_seq_evento_fat_w,			tb_nr_seq_lote_fat_w,			tb_nr_seq_pos_proc_w,
				tb_nr_seq_pos_proc_fat_w,		tb_nr_seq_segurado_w,			tb_ie_tipo_guia_princ_w,
				tb_nr_seq_tipo_atend_w,			tb_nr_seq_tipo_conta_w,			tb_ie_origem_conta_w,
				tb_ie_tipo_segurado_w,			tb_ie_internado_w,			tb_ie_tipo_intercambio_w,
				tb_ie_tipo_conta_w,			tb_ie_pcmso_w,				tb_nr_seq_plano_w,
				tb_nr_seq_class_sca_w,			tb_ie_tipo_despesa_proc_w,		tb_cd_procedimento_w,
				tb_cd_area_procedimento_w,		tb_cd_especialidade_w,			tb_cd_grupo_proc_w,
				tb_ie_preco_w,				tb_nr_seq_grupo_rec_w,			tb_dt_procedimento_ref_w,
				tb_cd_prestador_w,			tb_nr_seq_tipo_prestador_w,		tb_ie_tipo_pessoa_prest_w,
				tb_ie_tipo_relacao_w,			tb_nr_seq_classif_prest_w,		tb_ie_ato_cooperado_w,
				tb_nr_seq_prestador_exec_w,		tb_nr_seq_prestador_pgto_w,		tb_ie_apresentacao_prot_w,
				tb_ie_tipo_pess_prest_atend_w,		tb_ie_tipo_pess_prest_ptu_w,		tb_ie_tipo_pess_prest_solic_w,
				tb_ie_origem_analise_pos_w,		tb_ie_tipo_cobranca_w,			tb_vl_item_w,
				tb_vl_item_ndc_w,			tb_nr_seq_regra_inter_w,		tb_dt_alta_w,
				tb_nr_seq_pos_proc_tx_w,		tb_ie_tipo_protocolo_w,			tb_ie_origem_protocolo_w,
				tb_ie_ato_cooperado_pag_w,		tb_ie_tipo_pessoa_prest_pag_w,		tb_cd_usuario_plano_w,
				tb_nr_seq_pagador_w,			tb_nr_seq_contrato_w,			tb_nr_seq_intercambio_w,
				tb_nr_seq_ops_congenere_w,		tb_ie_fat_data_alt_pre_w,		tb_nr_seq_protocolo_w,
				tb_nr_seq_congenere_prot_w,		tb_nr_seq_conta_princ_w,		tb_nr_seq_pos_proc_tx_fat_w,
				tb_nr_agrupamento_w,			tb_nr_seq_regra_fat_w,			tb_cd_guia_referencia_w,
				tb_ie_origem_proced_w
limit pls_util_pck.qt_registro_transacao_w;
exit when tb_cd_guia_ok_w.count = 0;

	forall i in tb_cd_guia_ok_w.first..tb_cd_guia_ok_w.last
		insert into w_pls_lote_fat_proc(	nr_sequencia,				cd_guia_ok,				dt_atendimento_ref,		dt_emissao_conta,
							dt_inicio_faturamento,			ie_prestador_a400,			ie_tipo_guia,			nr_seq_congenere,
							nr_seq_conta,				nr_seq_conta_proc,			nr_seq_evento_fat,		nr_seq_lote_fat,
							nr_seq_pos_proc,			nr_seq_pos_proc_fat,			nr_seq_segurado,		ie_tipo_guia_princ,
							nr_seq_tipo_atendimento,		nr_seq_tipo_conta,			ie_origem_conta,		ie_tipo_segurado,
							ie_internado,				ie_tipo_intercambio,			ie_tipo_conta,			ie_pcmso,
							nr_seq_plano,				nr_seq_classificacao_sca,		ie_tipo_despesa_proc,		cd_procedimento,
							cd_area_procedimento,			cd_especialidade,			cd_grupo_proc,			ie_preco,
							nr_seq_grupo_rec,			dt_procedimento_ref,			cd_prestador,			nr_seq_tipo_prestador,
							ie_tipo_pessoa_prest,			ie_tipo_relacao,			nr_seq_classif_prest,		ie_ato_cooperado,
							nr_seq_prestador_exec,			nr_seq_prestador_pgto,			ie_apresentacao_prot,		ie_tipo_pessoa_prest_atend,
							ie_tipo_pessoa_prest_ptu,		ie_tipo_pessoa_prest_solic,		ie_origem_analise_pos,		ie_tipo_cobranca,
							vl_item,				vl_item_ndc,				nr_seq_regra_inter,		dt_alta,
							nr_seq_pos_proc_tx,			nm_usuario,				nm_usuario_nrec,		dt_atualizacao,
							dt_atualizacao_nrec,			ie_tipo_protocolo,			ie_origem_protocolo,		ie_ato_cooperado_pag,
							ie_tipo_pessoa_prest_pag,		cd_usuario_plano,			nr_seq_pagador,			nr_seq_contrato,
							nr_seq_intercambio,			nr_seq_ops_congenere,			ie_fat_data_alt_pre,		nr_seq_protocolo,
							nr_seq_congenere_prot,			nr_seq_conta_princ,			nr_seq_pos_proc_tx_fat,		nr_agrupamento,
							nr_seq_regra_fat,			cd_guia_referencia,			ie_origem_proced)
		values (				nextval('w_pls_lote_fat_proc_seq'),	tb_cd_guia_ok_w(i),			tb_dt_atendimento_ref_w(i),	tb_dt_emissao_conta_w(i),
							tb_dt_inicio_faturamento_w(i),		tb_ie_prestador_a400_w(i),		tb_ie_tipo_guia_w(i),		tb_nr_seq_congenere_w(i),
							tb_nr_seq_conta_w(i),			tb_nr_seq_conta_proc_w(i),		tb_nr_seq_evento_fat_w(i),	tb_nr_seq_lote_fat_w(i),
							tb_nr_seq_pos_proc_w(i),		tb_nr_seq_pos_proc_fat_w(i),		tb_nr_seq_segurado_w(i),	tb_ie_tipo_guia_princ_w(i),
							tb_nr_seq_tipo_atend_w(i),		tb_nr_seq_tipo_conta_w(i),		tb_ie_origem_conta_w(i),	tb_ie_tipo_segurado_w(i),
							tb_ie_internado_w(i),			tb_ie_tipo_intercambio_w(i),		tb_ie_tipo_conta_w(i),		tb_ie_pcmso_w(i),
							tb_nr_seq_plano_w(i),			tb_nr_seq_class_sca_w(i),		tb_ie_tipo_despesa_proc_w(i),	tb_cd_procedimento_w(i),
							tb_cd_area_procedimento_w(i),		tb_cd_especialidade_w(i),		tb_cd_grupo_proc_w(i),		tb_ie_preco_w(i),
							tb_nr_seq_grupo_rec_w(i),		tb_dt_procedimento_ref_w(i),		tb_cd_prestador_w(i),		tb_nr_seq_tipo_prestador_w(i),
							tb_ie_tipo_pessoa_prest_w(i),		tb_ie_tipo_relacao_w(i),		tb_nr_seq_classif_prest_w(i),	tb_ie_ato_cooperado_w(i),
							tb_nr_seq_prestador_exec_w(i),		tb_nr_seq_prestador_pgto_w(i),		tb_ie_apresentacao_prot_w(i),	tb_ie_tipo_pess_prest_atend_w(i),
							tb_ie_tipo_pess_prest_ptu_w(i),		tb_ie_tipo_pess_prest_solic_w(i),	tb_ie_origem_analise_pos_w(i),	tb_ie_tipo_cobranca_w(i),
							tb_vl_item_w(i),			tb_vl_item_ndc_w(i),			tb_nr_seq_regra_inter_w(i),	tb_dt_alta_w(i),
							tb_nr_seq_pos_proc_tx_w(i),		nm_usuario_p,				nm_usuario_p,			clock_timestamp(),
							clock_timestamp(),				tb_ie_tipo_protocolo_w(i),		tb_ie_origem_protocolo_w(i),	tb_ie_ato_cooperado_pag_w(i),
							tb_ie_tipo_pessoa_prest_pag_w(i),	tb_cd_usuario_plano_w(i),		tb_nr_seq_pagador_w(i),		tb_nr_seq_contrato_w(i),
							tb_nr_seq_intercambio_w(i),		tb_nr_seq_ops_congenere_w(i),		tb_ie_fat_data_alt_pre_w(i),	tb_nr_seq_protocolo_w(i),
							tb_nr_seq_congenere_prot_w(i),		tb_nr_seq_conta_princ_w(i),		tb_nr_seq_pos_proc_tx_fat_w(i),	tb_nr_agrupamento_w(i),
							tb_nr_seq_regra_fat_w(i),		tb_cd_guia_referencia_w(i),		tb_ie_origem_proced_w(i));
	
	tb_cd_guia_ok_w.delete;			tb_dt_atendimento_ref_w.delete;		tb_dt_emissao_conta_w.delete;		tb_dt_inicio_faturamento_w.delete;
	tb_ie_prestador_a400_w.delete;		tb_ie_tipo_guia_w.delete;		tb_nr_seq_congenere_w.delete;		tb_nr_seq_conta_w.delete;
	tb_nr_seq_conta_proc_w.delete;		tb_nr_seq_evento_fat_w.delete;		tb_nr_seq_lote_fat_w.delete;		tb_nr_seq_pos_proc_w.delete;
	tb_nr_seq_pos_proc_fat_w.delete;	tb_nr_seq_segurado_w.delete;		tb_ie_tipo_guia_princ_w.delete;		tb_nr_seq_tipo_atend_w.delete;
	tb_nr_seq_tipo_conta_w.delete;		tb_ie_origem_conta_w.delete;		tb_ie_tipo_segurado_w.delete;		tb_ie_internado_w.delete;
	tb_ie_tipo_intercambio_w.delete;	tb_ie_tipo_conta_w.delete;		tb_ie_pcmso_w.delete;			tb_nr_seq_plano_w.delete;
	tb_nr_seq_class_sca_w.delete;		tb_ie_tipo_despesa_proc_w.delete;	tb_cd_procedimento_w.delete;		tb_cd_area_procedimento_w.delete;
	tb_cd_especialidade_w.delete;		tb_cd_grupo_proc_w.delete;		tb_ie_preco_w.delete;			tb_nr_seq_grupo_rec_w.delete;
	tb_dt_procedimento_ref_w.delete;	tb_cd_prestador_w.delete;		tb_nr_seq_tipo_prestador_w.delete;	tb_ie_tipo_pessoa_prest_w.delete;
	tb_ie_tipo_relacao_w.delete;		tb_nr_seq_classif_prest_w.delete;	tb_ie_ato_cooperado_w.delete;		tb_nr_seq_prestador_exec_w.delete;
	tb_nr_seq_prestador_pgto_w.delete;	tb_ie_apresentacao_prot_w.delete;	tb_ie_tipo_pess_prest_atend_w.delete;	tb_ie_tipo_pess_prest_ptu_w.delete;
	tb_ie_tipo_pess_prest_solic_w.delete;	tb_ie_origem_analise_pos_w.delete;	tb_ie_tipo_cobranca_w.delete;		tb_vl_item_w.delete;
	tb_vl_item_ndc_w.delete;		tb_nr_seq_regra_inter_w.delete;		tb_dt_alta_w.delete;			tb_nr_seq_pos_proc_tx_w.delete;
	tb_ie_tipo_protocolo_w.delete;		tb_ie_origem_protocolo_w.delete;	tb_ie_ato_cooperado_pag_w.delete;	tb_ie_tipo_pessoa_prest_pag_w.delete;
	tb_cd_usuario_plano_w.delete;		tb_nr_seq_pagador_w.delete;		tb_nr_seq_contrato_w.delete;		tb_nr_seq_intercambio_w.delete;
	tb_nr_seq_ops_congenere_w.delete;	tb_ie_fat_data_alt_pre_w.delete;	tb_nr_seq_protocolo_w.delete;		tb_nr_seq_congenere_prot_w.delete;
	tb_nr_seq_conta_princ_w.delete;		tb_nr_seq_pos_proc_tx_fat_w.delete;	tb_nr_agrupamento_w.delete;		tb_nr_seq_regra_fat_w.delete;
	tb_cd_guia_referencia_w.delete;		tb_ie_origem_proced_w.delete;

end loop; -- fim laco procedimentos
if (c01%isopen) then
	close c01;
end if;

-- Carrega as taxas originarias de procedimentos / Nao teve pagamento medico e nao tem divisao de pagamento
open current_setting('pls_faturamento_pck.c03')::CURSOR((nr_seq_lote_p,ie_processo_p);
loop
fetch current_setting('pls_faturamento_pck.c03')::CURSOR( bulk collect into	tb_cd_guia_ok_w,			tb_dt_atendimento_ref_w,		tb_dt_emissao_conta_w,
				tb_dt_inicio_faturamento_w,		tb_ie_prestador_a400_w,			tb_ie_tipo_guia_w,
				tb_nr_seq_congenere_w,			tb_nr_seq_conta_w,			tb_nr_seq_conta_proc_w,
				tb_nr_seq_evento_fat_w,			tb_nr_seq_lote_fat_w,			tb_nr_seq_pos_proc_w,
				tb_nr_seq_pos_proc_fat_w,		tb_nr_seq_segurado_w,			tb_ie_tipo_guia_princ_w,
				tb_nr_seq_tipo_atend_w,			tb_nr_seq_tipo_conta_w,			tb_ie_origem_conta_w,
				tb_ie_tipo_segurado_w,			tb_ie_internado_w,			tb_ie_tipo_intercambio_w,
				tb_ie_tipo_conta_w,			tb_ie_pcmso_w,				tb_nr_seq_plano_w,
				tb_nr_seq_class_sca_w,			tb_ie_tipo_despesa_proc_w,		tb_cd_procedimento_w,
				tb_cd_area_procedimento_w,		tb_cd_especialidade_w,			tb_cd_grupo_proc_w,
				tb_ie_preco_w,				tb_nr_seq_grupo_rec_w,			tb_dt_procedimento_ref_w,
				tb_cd_prestador_w,			tb_nr_seq_tipo_prestador_w,		tb_ie_tipo_pessoa_prest_w,
				tb_ie_tipo_relacao_w,			tb_nr_seq_classif_prest_w,		tb_ie_ato_cooperado_w,
				tb_nr_seq_prestador_exec_w,		tb_nr_seq_prestador_pgto_w,		tb_ie_apresentacao_prot_w,
				tb_ie_tipo_pess_prest_atend_w,		tb_ie_tipo_pess_prest_ptu_w,		tb_ie_tipo_pess_prest_solic_w,
				tb_ie_origem_analise_pos_w,		tb_ie_tipo_cobranca_w,			tb_vl_item_w,
				tb_vl_item_ndc_w,			tb_nr_seq_regra_inter_w,		tb_dt_alta_w,
				tb_nr_seq_pos_proc_tx_w,		tb_ie_tipo_protocolo_w,			tb_ie_origem_protocolo_w,
				tb_ie_ato_cooperado_pag_w,		tb_ie_tipo_pessoa_prest_pag_w,		tb_cd_usuario_plano_w,
				tb_nr_seq_pagador_w,			tb_nr_seq_contrato_w,			tb_nr_seq_intercambio_w,
				tb_nr_seq_ops_congenere_w,		tb_ie_fat_data_alt_pre_w,		tb_nr_seq_protocolo_w,
				tb_nr_seq_congenere_prot_w,		tb_nr_seq_conta_princ_w,		tb_nr_seq_pos_proc_tx_fat_w,
				tb_nr_agrupamento_w,			tb_nr_seq_regra_fat_w,			tb_cd_guia_referencia_w,
				tb_ie_origem_proced_w
limit pls_util_pck.qt_registro_transacao_w;
exit when tb_cd_guia_ok_w.count = 0;

	forall i in tb_cd_guia_ok_w.first..tb_cd_guia_ok_w.last
		insert into w_pls_lote_fat_proc(	nr_sequencia,				cd_guia_ok,				dt_atendimento_ref,		dt_emissao_conta,
							dt_inicio_faturamento,			ie_prestador_a400,			ie_tipo_guia,			nr_seq_congenere,
							nr_seq_conta,				nr_seq_conta_proc,			nr_seq_evento_fat,		nr_seq_lote_fat,
							nr_seq_pos_proc,			nr_seq_pos_proc_fat,			nr_seq_segurado,		ie_tipo_guia_princ,
							nr_seq_tipo_atendimento,		nr_seq_tipo_conta,			ie_origem_conta,		ie_tipo_segurado,
							ie_internado,				ie_tipo_intercambio,			ie_tipo_conta,			ie_pcmso,
							nr_seq_plano,				nr_seq_classificacao_sca,		ie_tipo_despesa_proc,		cd_procedimento,
							cd_area_procedimento,			cd_especialidade,			cd_grupo_proc,			ie_preco,
							nr_seq_grupo_rec,			dt_procedimento_ref,			cd_prestador,			nr_seq_tipo_prestador,
							ie_tipo_pessoa_prest,			ie_tipo_relacao,			nr_seq_classif_prest,		ie_ato_cooperado,
							nr_seq_prestador_exec,			nr_seq_prestador_pgto,			ie_apresentacao_prot,		ie_tipo_pessoa_prest_atend,
							ie_tipo_pessoa_prest_ptu,		ie_tipo_pessoa_prest_solic,		ie_origem_analise_pos,		ie_tipo_cobranca,
							vl_item,				vl_item_ndc,				nr_seq_regra_inter,		dt_alta,
							nr_seq_pos_proc_tx,			nm_usuario,				nm_usuario_nrec,		dt_atualizacao,
							dt_atualizacao_nrec,			ie_tipo_protocolo,			ie_origem_protocolo,		ie_ato_cooperado_pag,
							ie_tipo_pessoa_prest_pag,		cd_usuario_plano,			nr_seq_pagador,			nr_seq_contrato,
							nr_seq_intercambio,			nr_seq_ops_congenere,			ie_fat_data_alt_pre,		nr_seq_protocolo,
							nr_seq_congenere_prot,			nr_seq_conta_princ,			nr_seq_pos_proc_tx_fat,		nr_agrupamento,
							nr_seq_regra_fat,			cd_guia_referencia,			ie_origem_proced)
		values (				nextval('w_pls_lote_fat_proc_seq'),	tb_cd_guia_ok_w(i),			tb_dt_atendimento_ref_w(i),	tb_dt_emissao_conta_w(i),
							tb_dt_inicio_faturamento_w(i),		tb_ie_prestador_a400_w(i),		tb_ie_tipo_guia_w(i),		tb_nr_seq_congenere_w(i),
							tb_nr_seq_conta_w(i),			tb_nr_seq_conta_proc_w(i),		tb_nr_seq_evento_fat_w(i),	tb_nr_seq_lote_fat_w(i),
							tb_nr_seq_pos_proc_w(i),		tb_nr_seq_pos_proc_fat_w(i),		tb_nr_seq_segurado_w(i),	tb_ie_tipo_guia_princ_w(i),
							tb_nr_seq_tipo_atend_w(i),		tb_nr_seq_tipo_conta_w(i),		tb_ie_origem_conta_w(i),	tb_ie_tipo_segurado_w(i),
							tb_ie_internado_w(i),			tb_ie_tipo_intercambio_w(i),		tb_ie_tipo_conta_w(i),		tb_ie_pcmso_w(i),
							tb_nr_seq_plano_w(i),			tb_nr_seq_class_sca_w(i),		tb_ie_tipo_despesa_proc_w(i),	tb_cd_procedimento_w(i),
							tb_cd_area_procedimento_w(i),		tb_cd_especialidade_w(i),		tb_cd_grupo_proc_w(i),		tb_ie_preco_w(i),
							tb_nr_seq_grupo_rec_w(i),		tb_dt_procedimento_ref_w(i),		tb_cd_prestador_w(i),		tb_nr_seq_tipo_prestador_w(i),
							tb_ie_tipo_pessoa_prest_w(i),		tb_ie_tipo_relacao_w(i),		tb_nr_seq_classif_prest_w(i),	tb_ie_ato_cooperado_w(i),
							tb_nr_seq_prestador_exec_w(i),		tb_nr_seq_prestador_pgto_w(i),		tb_ie_apresentacao_prot_w(i),	tb_ie_tipo_pess_prest_atend_w(i),
							tb_ie_tipo_pess_prest_ptu_w(i),		tb_ie_tipo_pess_prest_solic_w(i),	tb_ie_origem_analise_pos_w(i),	tb_ie_tipo_cobranca_w(i),
							tb_vl_item_w(i),			tb_vl_item_ndc_w(i),			tb_nr_seq_regra_inter_w(i),	tb_dt_alta_w(i),
							tb_nr_seq_pos_proc_tx_w(i),		nm_usuario_p,				nm_usuario_p,			clock_timestamp(),
							clock_timestamp(),				tb_ie_tipo_protocolo_w(i),		tb_ie_origem_protocolo_w(i),	tb_ie_ato_cooperado_pag_w(i),
							tb_ie_tipo_pessoa_prest_pag_w(i),	tb_cd_usuario_plano_w(i),		tb_nr_seq_pagador_w(i),		tb_nr_seq_contrato_w(i),
							tb_nr_seq_intercambio_w(i),		tb_nr_seq_ops_congenere_w(i),		tb_ie_fat_data_alt_pre_w(i),	tb_nr_seq_protocolo_w(i),
							tb_nr_seq_congenere_prot_w(i),		tb_nr_seq_conta_princ_w(i),		tb_nr_seq_pos_proc_tx_fat_w(i),	tb_nr_agrupamento_w(i),
							tb_nr_seq_regra_fat_w(i),		tb_cd_guia_referencia_w(i),		tb_ie_origem_proced_w(i));
	
	tb_cd_guia_ok_w.delete;			tb_dt_atendimento_ref_w.delete;		tb_dt_emissao_conta_w.delete;		tb_dt_inicio_faturamento_w.delete;
	tb_ie_prestador_a400_w.delete;		tb_ie_tipo_guia_w.delete;		tb_nr_seq_congenere_w.delete;		tb_nr_seq_conta_w.delete;
	tb_nr_seq_conta_proc_w.delete;		tb_nr_seq_evento_fat_w.delete;		tb_nr_seq_lote_fat_w.delete;		tb_nr_seq_pos_proc_w.delete;
	tb_nr_seq_pos_proc_fat_w.delete;	tb_nr_seq_segurado_w.delete;		tb_ie_tipo_guia_princ_w.delete;		tb_nr_seq_tipo_atend_w.delete;
	tb_nr_seq_tipo_conta_w.delete;		tb_ie_origem_conta_w.delete;		tb_ie_tipo_segurado_w.delete;		tb_ie_internado_w.delete;
	tb_ie_tipo_intercambio_w.delete;	tb_ie_tipo_conta_w.delete;		tb_ie_pcmso_w.delete;			tb_nr_seq_plano_w.delete;
	tb_nr_seq_class_sca_w.delete;		tb_ie_tipo_despesa_proc_w.delete;	tb_cd_procedimento_w.delete;		tb_cd_area_procedimento_w.delete;
	tb_cd_especialidade_w.delete;		tb_cd_grupo_proc_w.delete;		tb_ie_preco_w.delete;			tb_nr_seq_grupo_rec_w.delete;
	tb_dt_procedimento_ref_w.delete;	tb_cd_prestador_w.delete;		tb_nr_seq_tipo_prestador_w.delete;	tb_ie_tipo_pessoa_prest_w.delete;
	tb_ie_tipo_relacao_w.delete;		tb_nr_seq_classif_prest_w.delete;	tb_ie_ato_cooperado_w.delete;		tb_nr_seq_prestador_exec_w.delete;
	tb_nr_seq_prestador_pgto_w.delete;	tb_ie_apresentacao_prot_w.delete;	tb_ie_tipo_pess_prest_atend_w.delete;	tb_ie_tipo_pess_prest_ptu_w.delete;
	tb_ie_tipo_pess_prest_solic_w.delete;	tb_ie_origem_analise_pos_w.delete;	tb_ie_tipo_cobranca_w.delete;		tb_vl_item_w.delete;
	tb_vl_item_ndc_w.delete;		tb_nr_seq_regra_inter_w.delete;		tb_dt_alta_w.delete;			tb_nr_seq_pos_proc_tx_w.delete;
	tb_ie_tipo_protocolo_w.delete;		tb_ie_origem_protocolo_w.delete;	tb_ie_ato_cooperado_pag_w.delete;	tb_ie_tipo_pessoa_prest_pag_w.delete;
	tb_cd_usuario_plano_w.delete;		tb_nr_seq_pagador_w.delete;		tb_nr_seq_contrato_w.delete;		tb_nr_seq_intercambio_w.delete;
	tb_nr_seq_ops_congenere_w.delete;	tb_ie_fat_data_alt_pre_w.delete;	tb_nr_seq_protocolo_w.delete;		tb_nr_seq_congenere_prot_w.delete;
	tb_nr_seq_conta_princ_w.delete;		tb_nr_seq_pos_proc_tx_fat_w.delete;	tb_nr_agrupamento_w.delete;		tb_nr_seq_regra_fat_w.delete;
	tb_cd_guia_referencia_w.delete;		tb_ie_origem_proced_w.delete;

end loop; -- fim laco procedimentos
if	(current_setting('pls_faturamento_pck.c03')::CURSOR(%isopen) then
	close current_setting('pls_faturamento_pck.c03')::CURSOR(;
end if;


-- Carrega as taxas originarias de materiais
open c02(nr_seq_lote_p,ie_processo_p);
loop
fetch c02 bulk collect into	tb_cd_guia_ok_w,			tb_dt_atendimento_ref_w,		tb_dt_emissao_conta_w,
				tb_dt_inicio_faturamento_w,		tb_ie_prestador_a400_w,			tb_ie_tipo_guia_w,
				tb_nr_seq_congenere_w,			tb_nr_seq_conta_w,			tb_nr_seq_conta_mat_w,
				tb_nr_seq_evento_fat_w,			tb_nr_seq_lote_fat_w,			tb_nr_seq_pos_mat_w,
				tb_nr_seq_pos_mat_fat_w,		tb_nr_seq_segurado_w,			tb_ie_tipo_guia_princ_w,
				tb_nr_seq_tipo_atend_w,			tb_nr_seq_tipo_conta_w,			tb_ie_origem_conta_w,
				tb_ie_tipo_segurado_w,			tb_ie_internado_w,			tb_ie_tipo_intercambio_w,
				tb_ie_tipo_conta_w,			tb_ie_pcmso_w,				tb_nr_seq_plano_w,
				tb_nr_seq_class_sca_w,			tb_ie_tipo_despesa_w,			tb_ie_preco_w,
				tb_nr_seq_grupo_rec_w,			tb_dt_material_ref_w,			tb_cd_prestador_w,
				tb_nr_seq_tipo_prestador_w,		tb_ie_tipo_pessoa_prest_w,		tb_ie_tipo_relacao_w,
				tb_nr_seq_classif_prest_w,		tb_ie_ato_cooperado_w,			tb_nr_seq_prestador_pgto_w,
				tb_ie_apresentacao_prot_w,		tb_ie_tipo_pess_prest_atend_w,		tb_ie_tipo_pess_prest_ptu_w,
				tb_ie_tipo_pess_prest_solic_w,		tb_ie_origem_analise_pos_w,		tb_ie_tipo_cobranca_w,
				tb_vl_item_w,				tb_vl_item_ndc_w,			tb_nr_seq_regra_inter_w,
				tb_dt_alta_w,				tb_nr_seq_pos_mat_tx_w,			tb_ie_tipo_protocolo_w,
				tb_ie_origem_protocolo_w,		tb_ie_ato_cooperado_pag_w,		tb_ie_tipo_pessoa_prest_pag_w,
				tb_cd_usuario_plano_w,			tb_nr_seq_pagador_w,			tb_nr_seq_contrato_w,
				tb_nr_seq_intercambio_w,		tb_nr_seq_ops_congenere_w,		tb_ie_fat_data_alt_pre_w,
				tb_nr_seq_protocolo_w,			tb_nr_seq_congenere_prot_w,		tb_nr_seq_conta_princ_w,
				tb_nr_seq_pos_mat_tx_fat_w,		tb_nr_agrupamento_w,			tb_nr_seq_regra_fat_w,
				tb_cd_guia_referencia_w
limit pls_util_pck.qt_registro_transacao_w;
exit when tb_cd_guia_ok_w.count = 0;

	forall i in tb_cd_guia_ok_w.first..tb_cd_guia_ok_w.last
		insert into w_pls_lote_fat_mat(	nr_sequencia,				cd_guia_ok,				dt_atendimento_ref,			dt_emissao_conta,
							dt_inicio_faturamento,			ie_prestador_a400,			ie_tipo_guia,				nr_seq_congenere,
							nr_seq_conta,				nr_seq_conta_mat,			nr_seq_evento_fat,			nr_seq_lote_fat,
							nr_seq_pos_mat,				nr_seq_pos_mat_fat,			nr_seq_segurado,			ie_tipo_guia_princ,
							nr_seq_tipo_atendimento,		nr_seq_tipo_conta,			ie_origem_conta,			ie_tipo_segurado,
							ie_internado,				ie_tipo_intercambio,			ie_tipo_conta,				ie_pcmso,
							nr_seq_plano,				nr_seq_classificacao_sca,		ie_tipo_despesa,			ie_preco,
							nr_seq_grupo_rec,			dt_material_ref,			cd_prestador,				nr_seq_tipo_prestador,
							ie_tipo_pessoa_prest,			ie_tipo_relacao,			nr_seq_classif_prest,			ie_ato_cooperado,
							nr_seq_prestador_pgto,			ie_apresentacao_prot,			ie_tipo_pessoa_prest_atend,		ie_tipo_pessoa_prest_ptu,
							ie_tipo_pessoa_prest_solic,		ie_origem_analise_pos,			ie_tipo_cobranca,			vl_item,
							vl_item_ndc,				nr_seq_regra_inter,			dt_alta,				nr_seq_pos_mat_tx,
							nm_usuario,				nm_usuario_nrec,			dt_atualizacao,				dt_atualizacao_nrec,
							ie_tipo_protocolo,			ie_origem_protocolo,			ie_ato_cooperado_pag,			ie_tipo_pessoa_prest_pag,
							cd_usuario_plano,			nr_seq_pagador,				nr_seq_contrato,			nr_seq_intercambio,
							nr_seq_ops_congenere,			ie_fat_data_alt_pre,			nr_seq_protocolo,			nr_seq_congenere_prot,
							nr_seq_conta_princ,			nr_seq_pos_mat_tx_fat,			nr_agrupamento,				nr_seq_regra_fat,
							cd_guia_referencia)
		values (				nextval('w_pls_lote_fat_mat_seq'),		tb_cd_guia_ok_w(i),			tb_dt_atendimento_ref_w(i),		tb_dt_emissao_conta_w(i),
							tb_dt_inicio_faturamento_w(i),		tb_ie_prestador_a400_w(i),		tb_ie_tipo_guia_w(i),			tb_nr_seq_congenere_w(i),
							tb_nr_seq_conta_w(i),			tb_nr_seq_conta_mat_w(i),		tb_nr_seq_evento_fat_w(i),		tb_nr_seq_lote_fat_w(i),
							tb_nr_seq_pos_mat_w(i),			tb_nr_seq_pos_mat_fat_w(i),		tb_nr_seq_segurado_w(i),		tb_ie_tipo_guia_princ_w(i),
							tb_nr_seq_tipo_atend_w(i),		tb_nr_seq_tipo_conta_w(i),		tb_ie_origem_conta_w(i),		tb_ie_tipo_segurado_w(i),
							tb_ie_internado_w(i),			tb_ie_tipo_intercambio_w(i),		tb_ie_tipo_conta_w(i),			tb_ie_pcmso_w(i),
							tb_nr_seq_plano_w(i),			tb_nr_seq_class_sca_w(i),		tb_ie_tipo_despesa_w(i),		tb_ie_preco_w(i),
							tb_nr_seq_grupo_rec_w(i),		tb_dt_material_ref_w(i),		tb_cd_prestador_w(i),			tb_nr_seq_tipo_prestador_w(i),
							tb_ie_tipo_pessoa_prest_w(i),		tb_ie_tipo_relacao_w(i),		tb_nr_seq_classif_prest_w(i),		tb_ie_ato_cooperado_w(i),
							tb_nr_seq_prestador_pgto_w(i),		tb_ie_apresentacao_prot_w(i),		tb_ie_tipo_pess_prest_atend_w(i),	tb_ie_tipo_pess_prest_ptu_w(i),	
							tb_ie_tipo_pess_prest_solic_w(i),	tb_ie_origem_analise_pos_w(i),		tb_ie_tipo_cobranca_w(i),		tb_vl_item_w(i),
							tb_vl_item_ndc_w(i),			tb_nr_seq_regra_inter_w(i),		tb_dt_alta_w(i),			tb_nr_seq_pos_mat_tx_w(i),
							nm_usuario_p,				nm_usuario_p,				clock_timestamp(),				clock_timestamp(),
							tb_ie_tipo_protocolo_w(i),		tb_ie_origem_protocolo_w(i),		tb_ie_ato_cooperado_pag_w(i),		tb_ie_tipo_pessoa_prest_pag_w(i),
							tb_cd_usuario_plano_w(i),		tb_nr_seq_pagador_w(i),			tb_nr_seq_contrato_w(i),		tb_nr_seq_intercambio_w(i),
							tb_nr_seq_ops_congenere_w(i),		tb_ie_fat_data_alt_pre_w(i),		tb_nr_seq_protocolo_w(i),		tb_nr_seq_congenere_prot_w(i),
							tb_nr_seq_conta_princ_w(i),		tb_nr_seq_pos_mat_tx_fat_w(i),		tb_nr_agrupamento_w(i),			tb_nr_seq_regra_fat_w(i),
							tb_cd_guia_referencia_w(i));
							
	tb_cd_guia_ok_w.delete;			tb_dt_atendimento_ref_w.delete;		tb_dt_emissao_conta_w.delete;		tb_dt_inicio_faturamento_w.delete;
	tb_ie_prestador_a400_w.delete;		tb_ie_tipo_guia_w.delete;		tb_nr_seq_congenere_w.delete;		tb_nr_seq_conta_w.delete;
	tb_nr_seq_conta_mat_w.delete;		tb_nr_seq_evento_fat_w.delete;		tb_nr_seq_lote_fat_w.delete;		tb_nr_seq_pos_mat_w.delete;
	tb_nr_seq_pos_mat_fat_w.delete;		tb_nr_seq_segurado_w.delete;		tb_ie_tipo_guia_princ_w.delete;		tb_nr_seq_tipo_atend_w.delete;
	tb_nr_seq_tipo_conta_w.delete;		tb_ie_origem_conta_w.delete;		tb_ie_tipo_segurado_w.delete;		tb_ie_internado_w.delete;
	tb_ie_tipo_intercambio_w.delete;	tb_ie_tipo_conta_w.delete;		tb_ie_pcmso_w.delete;			tb_nr_seq_plano_w.delete;
	tb_nr_seq_class_sca_w.delete;		tb_ie_tipo_despesa_w.delete;		tb_ie_preco_w.delete;			tb_nr_seq_grupo_rec_w.delete;
	tb_dt_procedimento_ref_w.delete;	tb_cd_prestador_w.delete;		tb_nr_seq_tipo_prestador_w.delete;	tb_ie_tipo_pessoa_prest_w.delete;
	tb_ie_tipo_relacao_w.delete;		tb_nr_seq_classif_prest_w.delete;	tb_ie_ato_cooperado_w.delete;		tb_nr_seq_prestador_exec_w.delete;
	tb_nr_seq_prestador_pgto_w.delete;	tb_ie_apresentacao_prot_w.delete;	tb_ie_tipo_pess_prest_atend_w.delete;	tb_ie_tipo_pess_prest_ptu_w.delete;
	tb_ie_tipo_pess_prest_solic_w.delete;	tb_ie_origem_analise_pos_w.delete;	tb_ie_tipo_cobranca_w.delete;		tb_vl_item_w.delete;
	tb_vl_item_ndc_w.delete;		tb_nr_seq_regra_inter_w.delete;		tb_dt_alta_w.delete;			tb_nr_seq_pos_mat_tx_w.delete;
	tb_ie_tipo_protocolo_w.delete;		tb_ie_origem_protocolo_w.delete;	tb_ie_ato_cooperado_pag_w.delete;	tb_ie_tipo_pessoa_prest_pag_w.delete;
	tb_cd_usuario_plano_w.delete;		tb_nr_seq_pagador_w.delete;		tb_nr_seq_contrato_w.delete;		tb_nr_seq_intercambio_w.delete;
	tb_nr_seq_ops_congenere_w.delete;	tb_ie_fat_data_alt_pre_w.delete;	tb_nr_seq_protocolo_w.delete;		tb_nr_seq_congenere_prot_w.delete;
	tb_nr_seq_conta_princ_w.delete;		tb_nr_seq_pos_mat_tx_fat_w.delete;	tb_nr_agrupamento_w.delete;		tb_nr_seq_regra_fat_w.delete;
	tb_cd_guia_referencia_w.delete;

end loop; -- fim laco procedimentos
if (c02%isopen) then
	close c02;
end if;

-- Carrega as taxas originarias de materiais / Nao teve pagamento medico e nao tem divisao de pagamento
open current_setting('pls_faturamento_pck.c04')::CURSOR((nr_seq_lote_p,ie_processo_p);
loop
fetch current_setting('pls_faturamento_pck.c04')::CURSOR( bulk collect into	tb_cd_guia_ok_w,			tb_dt_atendimento_ref_w,		tb_dt_emissao_conta_w,
				tb_dt_inicio_faturamento_w,		tb_ie_prestador_a400_w,			tb_ie_tipo_guia_w,
				tb_nr_seq_congenere_w,			tb_nr_seq_conta_w,			tb_nr_seq_conta_mat_w,
				tb_nr_seq_evento_fat_w,			tb_nr_seq_lote_fat_w,			tb_nr_seq_pos_mat_w,
				tb_nr_seq_pos_mat_fat_w,		tb_nr_seq_segurado_w,			tb_ie_tipo_guia_princ_w,
				tb_nr_seq_tipo_atend_w,			tb_nr_seq_tipo_conta_w,			tb_ie_origem_conta_w,
				tb_ie_tipo_segurado_w,			tb_ie_internado_w,			tb_ie_tipo_intercambio_w,
				tb_ie_tipo_conta_w,			tb_ie_pcmso_w,				tb_nr_seq_plano_w,
				tb_nr_seq_class_sca_w,			tb_ie_tipo_despesa_w,			tb_ie_preco_w,
				tb_nr_seq_grupo_rec_w,			tb_dt_material_ref_w,			tb_cd_prestador_w,
				tb_nr_seq_tipo_prestador_w,		tb_ie_tipo_pessoa_prest_w,		tb_ie_tipo_relacao_w,
				tb_nr_seq_classif_prest_w,		tb_ie_ato_cooperado_w,			tb_nr_seq_prestador_pgto_w,
				tb_ie_apresentacao_prot_w,		tb_ie_tipo_pess_prest_atend_w,		tb_ie_tipo_pess_prest_ptu_w,
				tb_ie_tipo_pess_prest_solic_w,		tb_ie_origem_analise_pos_w,		tb_ie_tipo_cobranca_w,
				tb_vl_item_w,				tb_vl_item_ndc_w,			tb_nr_seq_regra_inter_w,
				tb_dt_alta_w,				tb_nr_seq_pos_mat_tx_w,			tb_ie_tipo_protocolo_w,
				tb_ie_origem_protocolo_w,		tb_ie_ato_cooperado_pag_w,		tb_ie_tipo_pessoa_prest_pag_w,
				tb_cd_usuario_plano_w,			tb_nr_seq_pagador_w,			tb_nr_seq_contrato_w,
				tb_nr_seq_intercambio_w,		tb_nr_seq_ops_congenere_w,		tb_ie_fat_data_alt_pre_w,
				tb_nr_seq_protocolo_w,			tb_nr_seq_congenere_prot_w,		tb_nr_seq_conta_princ_w,
				tb_nr_seq_pos_mat_tx_fat_w,		tb_nr_agrupamento_w,			tb_nr_seq_regra_fat_w,
				tb_cd_guia_referencia_w
limit pls_util_pck.qt_registro_transacao_w;
exit when tb_cd_guia_ok_w.count = 0;

	forall i in tb_cd_guia_ok_w.first..tb_cd_guia_ok_w.last
		insert into w_pls_lote_fat_mat(	nr_sequencia,				cd_guia_ok,				dt_atendimento_ref,			dt_emissao_conta,
							dt_inicio_faturamento,			ie_prestador_a400,			ie_tipo_guia,				nr_seq_congenere,
							nr_seq_conta,				nr_seq_conta_mat,			nr_seq_evento_fat,			nr_seq_lote_fat,
							nr_seq_pos_mat,				nr_seq_pos_mat_fat,			nr_seq_segurado,			ie_tipo_guia_princ,
							nr_seq_tipo_atendimento,		nr_seq_tipo_conta,			ie_origem_conta,			ie_tipo_segurado,
							ie_internado,				ie_tipo_intercambio,			ie_tipo_conta,				ie_pcmso,
							nr_seq_plano,				nr_seq_classificacao_sca,		ie_tipo_despesa,			ie_preco,
							nr_seq_grupo_rec,			dt_material_ref,			cd_prestador,				nr_seq_tipo_prestador,
							ie_tipo_pessoa_prest,			ie_tipo_relacao,			nr_seq_classif_prest,			ie_ato_cooperado,
							nr_seq_prestador_pgto,			ie_apresentacao_prot,			ie_tipo_pessoa_prest_atend,		ie_tipo_pessoa_prest_ptu,
							ie_tipo_pessoa_prest_solic,		ie_origem_analise_pos,			ie_tipo_cobranca,			vl_item,
							vl_item_ndc,				nr_seq_regra_inter,			dt_alta,				nr_seq_pos_mat_tx,
							nm_usuario,				nm_usuario_nrec,			dt_atualizacao,				dt_atualizacao_nrec,
							ie_tipo_protocolo,			ie_origem_protocolo,			ie_ato_cooperado_pag,			ie_tipo_pessoa_prest_pag,
							cd_usuario_plano,			nr_seq_pagador,				nr_seq_contrato,			nr_seq_intercambio,
							nr_seq_ops_congenere,			ie_fat_data_alt_pre,			nr_seq_protocolo,			nr_seq_congenere_prot,
							nr_seq_conta_princ,			nr_seq_pos_mat_tx_fat,			nr_agrupamento,				nr_seq_regra_fat,
							cd_guia_referencia)
		values (				nextval('w_pls_lote_fat_mat_seq'),		tb_cd_guia_ok_w(i),			tb_dt_atendimento_ref_w(i),		tb_dt_emissao_conta_w(i),
							tb_dt_inicio_faturamento_w(i),		tb_ie_prestador_a400_w(i),		tb_ie_tipo_guia_w(i),			tb_nr_seq_congenere_w(i),
							tb_nr_seq_conta_w(i),			tb_nr_seq_conta_mat_w(i),		tb_nr_seq_evento_fat_w(i),		tb_nr_seq_lote_fat_w(i),
							tb_nr_seq_pos_mat_w(i),			tb_nr_seq_pos_mat_fat_w(i),		tb_nr_seq_segurado_w(i),		tb_ie_tipo_guia_princ_w(i),
							tb_nr_seq_tipo_atend_w(i),		tb_nr_seq_tipo_conta_w(i),		tb_ie_origem_conta_w(i),		tb_ie_tipo_segurado_w(i),
							tb_ie_internado_w(i),			tb_ie_tipo_intercambio_w(i),		tb_ie_tipo_conta_w(i),			tb_ie_pcmso_w(i),
							tb_nr_seq_plano_w(i),			tb_nr_seq_class_sca_w(i),		tb_ie_tipo_despesa_w(i),		tb_ie_preco_w(i),
							tb_nr_seq_grupo_rec_w(i),		tb_dt_material_ref_w(i),		tb_cd_prestador_w(i),			tb_nr_seq_tipo_prestador_w(i),
							tb_ie_tipo_pessoa_prest_w(i),		tb_ie_tipo_relacao_w(i),		tb_nr_seq_classif_prest_w(i),		tb_ie_ato_cooperado_w(i),
							tb_nr_seq_prestador_pgto_w(i),		tb_ie_apresentacao_prot_w(i),		tb_ie_tipo_pess_prest_atend_w(i),	tb_ie_tipo_pess_prest_ptu_w(i),	
							tb_ie_tipo_pess_prest_solic_w(i),	tb_ie_origem_analise_pos_w(i),		tb_ie_tipo_cobranca_w(i),		tb_vl_item_w(i),
							tb_vl_item_ndc_w(i),			tb_nr_seq_regra_inter_w(i),		tb_dt_alta_w(i),			tb_nr_seq_pos_mat_tx_w(i),
							nm_usuario_p,				nm_usuario_p,				clock_timestamp(),				clock_timestamp(),
							tb_ie_tipo_protocolo_w(i),		tb_ie_origem_protocolo_w(i),		tb_ie_ato_cooperado_pag_w(i),		tb_ie_tipo_pessoa_prest_pag_w(i),
							tb_cd_usuario_plano_w(i),		tb_nr_seq_pagador_w(i),			tb_nr_seq_contrato_w(i),		tb_nr_seq_intercambio_w(i),
							tb_nr_seq_ops_congenere_w(i),		tb_ie_fat_data_alt_pre_w(i),		tb_nr_seq_protocolo_w(i),		tb_nr_seq_congenere_prot_w(i),
							tb_nr_seq_conta_princ_w(i),		tb_nr_seq_pos_mat_tx_fat_w(i),		tb_nr_agrupamento_w(i),			tb_nr_seq_regra_fat_w(i),
							tb_cd_guia_referencia_w(i));
							
	tb_cd_guia_ok_w.delete;			tb_dt_atendimento_ref_w.delete;		tb_dt_emissao_conta_w.delete;		tb_dt_inicio_faturamento_w.delete;
	tb_ie_prestador_a400_w.delete;		tb_ie_tipo_guia_w.delete;		tb_nr_seq_congenere_w.delete;		tb_nr_seq_conta_w.delete;
	tb_nr_seq_conta_mat_w.delete;		tb_nr_seq_evento_fat_w.delete;		tb_nr_seq_lote_fat_w.delete;		tb_nr_seq_pos_mat_w.delete;
	tb_nr_seq_pos_mat_fat_w.delete;		tb_nr_seq_segurado_w.delete;		tb_ie_tipo_guia_princ_w.delete;		tb_nr_seq_tipo_atend_w.delete;
	tb_nr_seq_tipo_conta_w.delete;		tb_ie_origem_conta_w.delete;		tb_ie_tipo_segurado_w.delete;		tb_ie_internado_w.delete;
	tb_ie_tipo_intercambio_w.delete;	tb_ie_tipo_conta_w.delete;		tb_ie_pcmso_w.delete;			tb_nr_seq_plano_w.delete;
	tb_nr_seq_class_sca_w.delete;		tb_ie_tipo_despesa_w.delete;		tb_ie_preco_w.delete;			tb_nr_seq_grupo_rec_w.delete;
	tb_dt_procedimento_ref_w.delete;	tb_cd_prestador_w.delete;		tb_nr_seq_tipo_prestador_w.delete;	tb_ie_tipo_pessoa_prest_w.delete;
	tb_ie_tipo_relacao_w.delete;		tb_nr_seq_classif_prest_w.delete;	tb_ie_ato_cooperado_w.delete;		tb_nr_seq_prestador_exec_w.delete;
	tb_nr_seq_prestador_pgto_w.delete;	tb_ie_apresentacao_prot_w.delete;	tb_ie_tipo_pess_prest_atend_w.delete;	tb_ie_tipo_pess_prest_ptu_w.delete;
	tb_ie_tipo_pess_prest_solic_w.delete;	tb_ie_origem_analise_pos_w.delete;	tb_ie_tipo_cobranca_w.delete;		tb_vl_item_w.delete;
	tb_vl_item_ndc_w.delete;		tb_nr_seq_regra_inter_w.delete;		tb_dt_alta_w.delete;			tb_nr_seq_pos_mat_tx_w.delete;
	tb_ie_tipo_protocolo_w.delete;		tb_ie_origem_protocolo_w.delete;	tb_ie_ato_cooperado_pag_w.delete;	tb_ie_tipo_pessoa_prest_pag_w.delete;
	tb_cd_usuario_plano_w.delete;		tb_nr_seq_pagador_w.delete;		tb_nr_seq_contrato_w.delete;		tb_nr_seq_intercambio_w.delete;
	tb_nr_seq_ops_congenere_w.delete;	tb_ie_fat_data_alt_pre_w.delete;	tb_nr_seq_protocolo_w.delete;		tb_nr_seq_congenere_prot_w.delete;
	tb_nr_seq_conta_princ_w.delete;		tb_nr_seq_pos_mat_tx_fat_w.delete;	tb_nr_agrupamento_w.delete;		tb_nr_seq_regra_fat_w.delete;
	tb_cd_guia_referencia_w.delete;

end loop; -- fim laco procedimentos
if	(current_setting('pls_faturamento_pck.c04')::CURSOR(%isopen) then
	close current_setting('pls_faturamento_pck.c04')::CURSOR(;
end if;

commit;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_faturamento_pck.insere_taxa_pls_lote_fat ( nr_seq_lote_p pls_lote_faturamento.nr_sequencia%type, cd_estabelecimento_p estabelecimento.cd_estabelecimento%type, nm_usuario_p usuario.nm_usuario%type, ie_processo_p text ) FROM PUBLIC;
