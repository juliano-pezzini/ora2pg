-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION med_guidance_pkg.validate_temp_med_rules ( nr_seq_med_guid_p bigint, nr_seq_temp_action_p bigint ) RETURNS boolean AS $body$
DECLARE


    si_return_w boolean := true;

    cursor_assessment CURSOR FOR
        SELECT  A.NR_SEQ_ITEM,
                A.DS_RESULTADO,
                A.QT_RESULTADO,
                B.SI_CONDITION,
                B.DS_VALUE
        FROM    MED_GUIDANCE_AVAL_RESULT A,
                MED_GUID_TEMP_CONDITION B
        WHERE   B.NR_SEQ_ITEM = A.NR_SEQ_ITEM
        AND     B.NR_SEQ_GUIDE_ACTION = nr_seq_temp_action_p
        AND     A.NR_SEQ_MED_GUID = nr_seq_med_guid_p;

    
BEGIN
    FOR r_cursor_assessment IN cursor_assessment LOOP
        IF (NOT med_guidance_pkg.compare_rule_domain(
                coalesce(r_cursor_assessment.QT_RESULTADO,R_CURSOR_ASSESSMENT.DS_RESULTADO),
                r_cursor_assessment.SI_CONDITION,
                r_cursor_assessment.DS_VALUE)
        )   THEN
            si_return_w := FALSE;
            EXIT;
        END IF;
    END LOOP;

    RETURN  SI_RETURN_W;

    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION med_guidance_pkg.validate_temp_med_rules ( nr_seq_med_guid_p bigint, nr_seq_temp_action_p bigint ) FROM PUBLIC;
