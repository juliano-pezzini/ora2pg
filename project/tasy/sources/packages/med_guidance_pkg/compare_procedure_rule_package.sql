-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION med_guidance_pkg.compare_procedure_rule (nr_seq_med_guid_fee_p text, cd_pessoa_fisica_p PESSOA_FISICA.CD_PESSOA_FISICA%type) RETURNS boolean AS $body$
DECLARE
	
		
    cursor_rule CURSOR FOR
    SELECT	cd_procedimento,
		si_check_procedure
    FROM	MED_GUID_FEE_PROCEDURE
    WHERE	nr_seq_med_guid_fee = nr_seq_med_guid_fee_p
    AND		clock_timestamp() BETWEEN dt_start AND dt_end;

    ie_retorno_w boolean := false;

    
BEGIN
		
	FOR r_cursor_rule IN cursor_rule LOOP
			
		ie_retorno_w := false;
			
		IF NOT(MED_GUIDANCE_PKG.GET_PROCEDURES_BY_STATUS(r_cursor_rule.cd_procedimento, cd_pessoa_fisica_p, r_cursor_rule.si_check_procedure)) THEN
			EXIT;
		END IF;
				
		ie_retorno_w := true;
			
	END LOOP;
	
     RETURN ie_retorno_w;
		
    END;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION med_guidance_pkg.compare_procedure_rule (nr_seq_med_guid_fee_p text, cd_pessoa_fisica_p PESSOA_FISICA.CD_PESSOA_FISICA%type) FROM PUBLIC;
