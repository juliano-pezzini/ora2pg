-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION med_guidance_pkg.compare_depart_med_assist (cd_pessoa_fisica_p PESSOA_FISICA.CD_PESSOA_FISICA%type, cd_departamento_p text) RETURNS boolean AS $body$
DECLARE


    qt_reg_w varchar(255) := '0';

BEGIN	
		
	SELECT COUNT(*) qt_reg
	INTO STRICT qt_reg_w
	FROM depto_medico d,
	     medico_especialidade c,
	     medico a,
	     depto_medico_espec b
	WHERE c.cd_pessoa_fisica = a.cd_pessoa_fisica
	AND c.cd_especialidade = b.cd_especialidade
	AND b.nr_seq_depto = d.nr_sequencia
	AND a.cd_pessoa_fisica IN (
		SELECT cd_medico_atendimento
		FROM atendimento_paciente a
		WHERE cd_pessoa_fisica = cd_pessoa_fisica_p)
	AND d.nr_sequencia = cd_departamento_p;
		
		
     RETURN(qt_reg_w > 0);
				
    END;
	

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION med_guidance_pkg.compare_depart_med_assist (cd_pessoa_fisica_p PESSOA_FISICA.CD_PESSOA_FISICA%type, cd_departamento_p text) FROM PUBLIC;
