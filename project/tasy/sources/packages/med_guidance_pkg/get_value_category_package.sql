-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION med_guidance_pkg.get_value_category (cd_pessoa_fisica_p PESSOA_FISICA.CD_PESSOA_FISICA%type, cd_medical_practice_code_p text) RETURNS bigint AS $body$
DECLARE


    qt_count_w bigint;


BEGIN
        
        SELECT  COUNT(*) QT_COUNT
        INTO STRICT    qt_count_w
        FROM    MEDICAL_GUIDANCE_ORDER a,
                PROC_INTERNO b,
                PROCEDIMENTO c 
        WHERE   a.CD_PESSOA_FISICA = cd_pessoa_fisica_p
        AND     c.CD_PROCEDIMENTO_LOC = cd_medical_practice_code_p
        AND     a.NR_SEQ_PROC_INTERNO = b.NR_SEQUENCIA
        AND     b.IE_ORIGEM_PROCED = c.IE_ORIGEM_PROCED 
        AND     b.CD_PROCEDIMENTO = c.CD_PROCEDIMENTO;

        IF (qt_count_w = 0) THEN
            RETURN 1;
        ELSE
            RETURN 0;
        END IF;
    END;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION med_guidance_pkg.get_value_category (cd_pessoa_fisica_p PESSOA_FISICA.CD_PESSOA_FISICA%type, cd_medical_practice_code_p text) FROM PUBLIC;
