-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pck_flowsheet.abreviar (nome_p text) RETURNS varchar AS $body$
DECLARE


    nome_w varchar(255);
    total_words_w bigint;
    count_w bigint;
    result_w varchar(255) := '';


BEGIN
     
    nome_w := trim(both replace(nome_p, '-', ' '));
    total_words_w := 1;
    count_w := 1;
    result_w := '';

    if (nome_w IS NOT NULL AND nome_w::text <> '') then
    
      for i in 1 .. length(nome_w) loop
      	if substr(nome_w, i, 1) = ' ' then
        	total_words_w := total_words_w + 1;
        end if;
      end loop;

      result_w := regexp_substr(nome_w, '\w{1,4}', 1, count_w);
      if total_words_w = 1 then
      	return(result_w);
      end if;

      count_w := count_w + 1;
      loop
      	result_w := result_w || regexp_substr(nome_w, '\s\S{1,4}', 1, count_w - 1);
      	exit when count_w = total_words_w;
        count_w := count_w + 1;
      end loop;

    end if;

		return(result_w);

  END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pck_flowsheet.abreviar (nome_p text) FROM PUBLIC;
