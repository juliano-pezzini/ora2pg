-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pfcs_pck_v2.pfcs_insert_details ( nr_seq_indicator_p bigint, nr_seq_operational_level_p bigint, nm_usuario_p text, nr_panel_detail_seq_p bigint, nr_encounter_p text, id_patient_p text, nm_patient_p text, dt_birthdate_p timestamp, ds_primary_diagnosis_p text, ds_gender_p text, ds_dnr_status_p text, qt_time_telemetry_p bigint default null, ds_classification_p text DEFAULT NULL, dt_entrance_p timestamp DEFAULT NULL, ds_service_line_p text DEFAULT NULL, cd_department_p text default null, ds_department_p text DEFAULT NULL, ds_bed_location_p text DEFAULT NULL, qt_red_alarms_p bigint default null, qt_yellow_alarms_p bigint default null, cd_equipamento_p text default null, ds_device_p text default null, ds_battery_status_p text default null, ie_discharge_status_p text default null, ds_age_range_p text default null, ie_frequent_flyer_p text default null, ds_recurring_patient_p text default null, ds_alarms_trends_p text default null, nr_edi_score_p bigint default null, nr_laceplus_p bigint default null, ds_care_status_p text default null, ds_checklist_p text default null, ds_readmission_risk_p text default null, ds_readm_risk_contrb_p text default null, ds_rec_pat_adm_data_p text default null, ds_rec_pat_comorbd_p text default null, ds_rec_pat_reasons_p text default null, ds_edi_vitals_warn_p text default null, ds_edi_contrb_p text default null, dt_monitor_entrance_p timestamp default null, nr_seq_encounter_p bigint default null, ds_special_request_p text default null, ds_bed_status_p text default null, cd_bed_status_p text default null) AS $body$
BEGIN
		insert into pfcs_panel_detail(
			nr_sequencia,
			nm_usuario,
			dt_atualizacao,
			nm_usuario_nrec,
			dt_atualizacao_nrec,
			ie_situation,
			nr_seq_indicator,
			nr_seq_operational_level
		)
		values (
			nr_panel_detail_seq_p,
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			clock_timestamp(),
			'T',
			nr_seq_indicator_p,
			nr_seq_operational_level_p
		);

		insert into pfcs_detail_patient(
			nr_sequencia,
			nm_usuario,
			dt_atualizacao,
			nm_usuario_nrec,
			dt_atualizacao_nrec,
			nr_seq_detail,
			nr_encounter_varchar,
			id_patient,
			nm_patient,
			dt_birthdate,
			ds_primary_diagnosis,
			ds_gender,
			ds_dnr_status,
			qt_time_telemetry,
			ds_classification,
			dt_entrance,
			qt_red_alarms,
			qt_yellow_alarms,
			ds_service_line,
			ie_discharge_order_status,
			ds_age_range,
			ie_freq_flyer,
			ds_recurring_patient,
			ds_alarm_trend,
			qt_edi_score,
			nr_laceplus,
			ds_care_status,
			ds_checklist,
			ds_readmission_risk,
			ds_readm_risk_contrb,
			ds_rec_pat_adm_data,
			ds_rec_pat_comorbd,
			ds_rec_pat_reasons,
			ds_edi_vitals_warn,
			ds_edi_contrb,
			dt_monitor_entrance,
			nr_seq_encounter
		)
		values (
			nextval('pfcs_detail_patient_seq'),
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			clock_timestamp(),
			nr_panel_detail_seq_p,
			nr_encounter_p,
			id_patient_p,
			nm_patient_p,
			dt_birthdate_p,
			ds_primary_diagnosis_p,
			ds_gender_p,
			ds_dnr_status_p,
			qt_time_telemetry_p,
			ds_classification_p,
			dt_entrance_p,
			qt_red_alarms_p,
			qt_yellow_alarms_p,
			ds_service_line_p,
			ie_discharge_status_p,
			ds_age_range_p,
			ie_frequent_flyer_p,
			ds_recurring_patient_p,
			ds_alarms_trends_p,
			nr_edi_score_p,
			nr_laceplus_p,
			ds_care_status_p,
			ds_checklist_p,
			ds_readmission_risk_p,
			ds_readm_risk_contrb_p,
			ds_rec_pat_adm_data_p,
			ds_rec_pat_comorbd_p,
			ds_rec_pat_reasons_p,
			ds_edi_vitals_warn_p,
			ds_edi_contrb_p,
			dt_monitor_entrance_p,
			nr_seq_encounter_p
		);
		insert into pfcs_detail_bed(
			nr_sequencia,
			nm_usuario,
			dt_atualizacao,
			nm_usuario_nrec,
			dt_atualizacao_nrec,
			nr_seq_detail,
			cd_department,
			ds_department,
			ds_location
		)
		values (
			nextval('pfcs_detail_bed_seq'),
			nm_usuario_p,
			clock_timestamp(),
			nm_usuario_p,
			clock_timestamp(),
			nr_panel_detail_seq_p,
			cd_department_p,
			ds_department_p,
			ds_bed_location_p
		);


		if (ds_device_p IS NOT NULL AND ds_device_p::text <> '')
		then
			insert into pfcs_detail_device(
				nr_sequencia,
				dt_atualizacao,
				nm_usuario,
				dt_atualizacao_nrec,
				nm_usuario_nrec,
				cd_equipamento_varchar,
				ds_device,
				ie_battery_status,
				nr_seq_detail)
			values (
				nextval('pfcs_detail_device_seq'),
				clock_timestamp(),
				nm_usuario_p,
				clock_timestamp(),
				nm_usuario_p,
				cd_equipamento_p,
				ds_device_p,
				ds_battery_status_p,
				nr_panel_detail_seq_p);
		end if;
		commit;
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pfcs_pck_v2.pfcs_insert_details ( nr_seq_indicator_p bigint, nr_seq_operational_level_p bigint, nm_usuario_p text, nr_panel_detail_seq_p bigint, nr_encounter_p text, id_patient_p text, nm_patient_p text, dt_birthdate_p timestamp, ds_primary_diagnosis_p text, ds_gender_p text, ds_dnr_status_p text, qt_time_telemetry_p bigint default null, ds_classification_p text DEFAULT NULL, dt_entrance_p timestamp DEFAULT NULL, ds_service_line_p text DEFAULT NULL, cd_department_p text default null, ds_department_p text DEFAULT NULL, ds_bed_location_p text DEFAULT NULL, qt_red_alarms_p bigint default null, qt_yellow_alarms_p bigint default null, cd_equipamento_p text default null, ds_device_p text default null, ds_battery_status_p text default null, ie_discharge_status_p text default null, ds_age_range_p text default null, ie_frequent_flyer_p text default null, ds_recurring_patient_p text default null, ds_alarms_trends_p text default null, nr_edi_score_p bigint default null, nr_laceplus_p bigint default null, ds_care_status_p text default null, ds_checklist_p text default null, ds_readmission_risk_p text default null, ds_readm_risk_contrb_p text default null, ds_rec_pat_adm_data_p text default null, ds_rec_pat_comorbd_p text default null, ds_rec_pat_reasons_p text default null, ds_edi_vitals_warn_p text default null, ds_edi_contrb_p text default null, dt_monitor_entrance_p timestamp default null, nr_seq_encounter_p bigint default null, ds_special_request_p text default null, ds_bed_status_p text default null, cd_bed_status_p text default null) FROM PUBLIC;
