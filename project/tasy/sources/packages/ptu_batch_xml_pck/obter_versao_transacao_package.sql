-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION ptu_batch_xml_pck.obter_versao_transacao (cd_estabelecimento_p estabelecimento.cd_estabelecimento%type, nr_seq_congenere_p pls_congenere.nr_sequencia%type, cd_cooperativa_p pls_congenere.cd_cooperativa%type, dt_referencia_p timestamp, ie_tipo_ptu_p text ) RETURNS varchar AS $body$
DECLARE


ds_retorno_w		varchar(255);
cd_versao_ptu_xml_w	ptu_regra_interface.cd_versao_ptu_xml%type;


BEGIN
cd_versao_ptu_xml_w := ptu_batch_xml_pck.obter_versao_dominio( cd_estabelecimento_p, nr_seq_congenere_p, cd_cooperativa_p, dt_referencia_p, ie_tipo_ptu_p);

if (cd_versao_ptu_xml_w = '1.0') then
	if (ie_tipo_ptu_p = 'A100') then
		ds_retorno_w := '18';
	elsif (ie_tipo_ptu_p = 'A200') then
		ds_retorno_w := '18';
	elsif (ie_tipo_ptu_p = 'A300') then
		ds_retorno_w := '15';
	elsif (ie_tipo_ptu_p = 'A410') then
		ds_retorno_w := '01';
	elsif (ie_tipo_ptu_p = 'A500') then
		ds_retorno_w := '31';
	elsif (ie_tipo_ptu_p = 'A1200') then
		ds_retorno_w := '05';
	elsif (ie_tipo_ptu_p = 'A1300') then
		ds_retorno_w := '18';
	end if;
end if;

return ds_retorno_w;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION ptu_batch_xml_pck.obter_versao_transacao (cd_estabelecimento_p estabelecimento.cd_estabelecimento%type, nr_seq_congenere_p pls_congenere.nr_sequencia%type, cd_cooperativa_p pls_congenere.cd_cooperativa%type, dt_referencia_p timestamp, ie_tipo_ptu_p text ) FROM PUBLIC;
