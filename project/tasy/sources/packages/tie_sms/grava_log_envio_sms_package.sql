-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE tie_sms.grava_log_envio_sms (DS_DESTINATARIO_P LOG_ENVIO_SMS.NR_TELEFONE%TYPE, DS_MENSAGEM_P LOG_ENVIO_SMS.DS_MENSAGEM%TYPE, NM_USUARIO_P LOG_ENVIO_SMS.NM_USUARIO%TYPE, NR_SEQ_SMS_TIE_P LOG_SMS_TIE.NR_SEQUENCIA%TYPE, DS_REMETENTE_P LOG_SMS_TIE.NR_TEL_REMETENTE%TYPE, DS_EVENTO_TIE_P LOG_SMS_TIE.DS_EVENTO_TIE%TYPE, ID_SMS_P LOG_SMS_TIE.ID_SMS%TYPE) AS $body$
BEGIN
	
	insert into log_envio_sms(
		nr_sequencia,
		dt_atualizacao,
		nm_usuario,
		dt_atualizacao_nrec,
		nm_usuario_nrec,
		dt_envio,
		nr_telefone,
		ds_mensagem
		) values (
		nextval('log_envio_sms_seq'),
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		ds_destinatario_p,
		ds_mensagem_p);
	commit;
	CALL tie_sms.gravar_log_sms_tie(nr_seq_sms_tie_p, nm_usuario_p, ds_remetente_p, ds_destinatario_p, ds_evento_tie_p, ds_mensagem_p, id_sms_p, null, null);
END;

$body$
LANGUAGE PLPGSQL
;
-- REVOKE ALL ON PROCEDURE tie_sms.grava_log_envio_sms (DS_DESTINATARIO_P LOG_ENVIO_SMS.NR_TELEFONE%TYPE, DS_MENSAGEM_P LOG_ENVIO_SMS.DS_MENSAGEM%TYPE, NM_USUARIO_P LOG_ENVIO_SMS.NM_USUARIO%TYPE, NR_SEQ_SMS_TIE_P LOG_SMS_TIE.NR_SEQUENCIA%TYPE, DS_REMETENTE_P LOG_SMS_TIE.NR_TEL_REMETENTE%TYPE, DS_EVENTO_TIE_P LOG_SMS_TIE.DS_EVENTO_TIE%TYPE, ID_SMS_P LOG_SMS_TIE.ID_SMS%TYPE) FROM PUBLIC;
