-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE tie_sms.gravar_log_sms_tie (nr_seq_sms_tie_p log_sms_tie.nr_sequencia%type, nm_usuario_p log_sms_tie.nm_usuario%type, ds_remetente_p log_sms_tie.nr_tel_remetente%type, ds_destinatario_p log_sms_tie.nr_tel_destinatario%type, ds_evento_tie_p log_sms_tie.ds_evento_tie%type, ds_mensagem_p log_sms_tie.ds_mensagem%type, id_sms_p log_sms_tie.id_sms%type, dt_retorno_p log_sms_tie.dt_retorno%type, ds_erro_p log_sms_tie.ds_erro%type) AS $body$
DECLARE


nr_seq_sms_tie_w log_sms_tie.nm_usuario%type := nr_seq_sms_tie_p;


BEGIN

	if (coalesce(nr_seq_sms_tie_p::text, '') = '') then		
		select nextval('log_envio_sms_seq')
		into STRICT nr_seq_sms_tie_w
		;
	end if;
	
	insert into log_sms_tie(
		nr_sequencia,
		dt_atualizacao,
		nm_usuario,
		dt_atualizacao_nrec,
		nm_usuario_nrec,
		dt_envio,
		dt_retorno,
		ds_erro,
		nr_tel_remetente,
		nr_tel_destinatario,
		ds_evento_tie,
		id_sms,
		ds_mensagem
		) values (
		nr_seq_sms_tie_w,
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		nm_usuario_p,
		clock_timestamp(),
		dt_retorno_p,
		ds_erro_p,
		ds_remetente_p,
		ds_destinatario_p,
		ds_evento_tie_p,
		id_sms_p,
		ds_mensagem_p);
	commit;
END;

$body$
LANGUAGE PLPGSQL
;
-- REVOKE ALL ON PROCEDURE tie_sms.gravar_log_sms_tie (nr_seq_sms_tie_p log_sms_tie.nr_sequencia%type, nm_usuario_p log_sms_tie.nm_usuario%type, ds_remetente_p log_sms_tie.nr_tel_remetente%type, ds_destinatario_p log_sms_tie.nr_tel_destinatario%type, ds_evento_tie_p log_sms_tie.ds_evento_tie%type, ds_mensagem_p log_sms_tie.ds_mensagem%type, id_sms_p log_sms_tie.id_sms%type, dt_retorno_p log_sms_tie.dt_retorno%type, ds_erro_p log_sms_tie.ds_erro%type) FROM PUBLIC;
