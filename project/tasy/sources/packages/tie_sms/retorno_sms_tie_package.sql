-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE tie_sms.retorno_sms_tie (nm_usuario_p log_envio_sms.nm_usuario%type, nm_usuario_auth_p text, ds_senha_auth_p text, ds_url_base_sms_p text, cd_empresa_p bigint) AS $body$
DECLARE

json_data_w    text;
json_message_w philips_json;
ds_event_tie_w log_sms_tie.ds_evento_tie%type := null;


BEGIN

	if (cd_empresa_p = 15) then
		ds_event_tie_w := 'api.inbound.sms.infobip';
	end if;
	
	if (ds_event_tie_w IS NOT NULL AND ds_event_tie_w::text <> '') then
				
		json_message_w := philips_json();
			
		json_message_w.put('ds_url_base_sms', ds_url_base_sms_p);
		json_message_w.put('nm_usuario_auth', nm_usuario_auth_p);
		json_message_w.put('ds_senha_auth', ds_senha_auth_p);
		
		dbms_lob.createtemporary(json_data_w, true);
		json_message_w.(json_data_w);
		json_data_w := bifrost.send_integration_content(ds_event_tie_w, json_data_w, nm_usuario_p);
			
	end if;
END;

$body$
LANGUAGE PLPGSQL
;
-- REVOKE ALL ON PROCEDURE tie_sms.retorno_sms_tie (nm_usuario_p log_envio_sms.nm_usuario%type, nm_usuario_auth_p text, ds_senha_auth_p text, ds_url_base_sms_p text, cd_empresa_p bigint) FROM PUBLIC;
