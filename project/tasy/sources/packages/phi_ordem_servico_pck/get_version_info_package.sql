-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';


/* ################ End get_nm_usuario_encer          ####################### */

/* ################ Start get_version_info            ####################### */

CREATE OR REPLACE FUNCTION phi_ordem_servico_pck.get_version_info (ds_version_p text) RETURNS SETOF T_VERSION_ROW_DATA AS $body$
DECLARE


	t_version_row_w		t_version_row;

	ds_version_w		varchar(255);
	ds_build_w		varchar(255);
	ds_hotfix_w		varchar(255);

	
BEGIN

		if (length(ds_version_p) - length(replace(ds_version_p, '-', '')) > 1) then
		begin
			t_version_row_w.ds_version	:= substr(ds_version_p, 1, instr(ds_version_p, '.', 1, 3) -1);
			t_version_row_w.ds_build	:= substr(ds_version_p, instr(ds_version_p, '.', 1, 3) +1, (instr(ds_version_p, '-', -1, 3) -1) - (instr(ds_version_p, '.', 1, 3)));
			t_version_row_w.ds_hotfix	:= substr(ds_version_p, instr(ds_version_p, '-', -1, 3), length(ds_version_p));
		end;
		elsif (length(ds_version_p) - length(replace(ds_version_p, '.', '')) > 2) then
		begin
			t_version_row_w.ds_version	:= substr(ds_version_p, 1, instr(ds_version_p, '.', -1)-1);
			t_version_row_w.ds_build	:= substr(ds_version_p, instr(ds_version_p, '.', -1) + 1, length(ds_version_p));
			t_version_row_w.ds_hotfix	:= null;
		end;
		else
		begin
			t_version_row_w.ds_version	:= ds_version_p;
			t_version_row_w.ds_build	:= null;
			t_version_row_w.ds_hotfix	:= null;
		end;
		end if;

		RETURN NEXT t_version_row_w;

	return;
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION phi_ordem_servico_pck.get_version_info (ds_version_p text) FROM PUBLIC;
