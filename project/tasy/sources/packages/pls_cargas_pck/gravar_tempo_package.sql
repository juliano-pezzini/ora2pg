-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';


-- Gravar tempo



CREATE OR REPLACE PROCEDURE pls_cargas_pck.gravar_tempo ( ie_opcao_p text ) AS $body$
BEGIN
-- Gravar inicio integracao

if (ie_opcao_p = 'II') then
	update	pls_cg_lote
	set	dt_integracao	= clock_timestamp()
	where	nr_sequencia	= nr_seq_cg_lote_w;

-- Gravar fim integracao

elsif (ie_opcao_p = 'IF') then
	update	pls_cg_lote
	set	dt_integracao_fim	= clock_timestamp()
	where	nr_sequencia		= nr_seq_cg_lote_w;

-- Gravar inicio producao

elsif (ie_opcao_p = 'PI') then
	update	pls_cg_lote
	set	dt_geracao_prod	= clock_timestamp()
	where	nr_sequencia	= nr_seq_cg_lote_w;

-- Gravar fim producao

elsif (ie_opcao_p = 'PF') then
	update	pls_cg_lote
	set	dt_geracao_prod_fim	= clock_timestamp()
	where	nr_sequencia		= nr_seq_cg_lote_w;
	
-- Desfazer cargas

elsif (ie_opcao_p = 'DC') then
	update	pls_cg_lote
	set	dt_integracao		 = NULL,
		dt_integracao_fim	 = NULL
	where	nr_sequencia		= nr_seq_cg_lote_w;
	
-- Desfazer producao

elsif (ie_opcao_p = 'DP') then
	update	pls_cg_lote
	set	dt_geracao_prod		 = NULL,
		dt_geracao_prod_fim	 = NULL
	where	nr_sequencia		= nr_seq_cg_lote_w;
	
end if;

commit;
	
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_cargas_pck.gravar_tempo ( ie_opcao_p text ) FROM PUBLIC;
