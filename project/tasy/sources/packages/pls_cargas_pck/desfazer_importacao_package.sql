-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';


-- Desfazer a carga dos dados



CREATE OR REPLACE PROCEDURE pls_cargas_pck.desfazer_importacao () AS $body$
DECLARE


ds_delete_w			text;

C01 CURSOR( ie_tipo_carga_pc		pls_cg_regra.ie_tipo_carga%type ) FOR
	SELECT	upper(nm_tabela) nm_tabela,
		to_char(nr_sequencia) ie_tipo_registro
	from	pls_cg_tab_tasy
	where	ie_tipo_carga = ie_tipo_carga_pc
	order by ie_tipo_registro desc;

BEGIN

for r_C01_w in C01( ie_tipo_carga_w ) loop
	-- Obter dados para desfazer importacao

	ds_delete_w := pls_cargas_pck.obter_estrutura_acao(r_C01_w.nm_tabela ,'D');

	-- Deletar os dados de carga

	EXECUTE to_char( ds_delete_w );
end loop;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_cargas_pck.desfazer_importacao () FROM PUBLIC;
