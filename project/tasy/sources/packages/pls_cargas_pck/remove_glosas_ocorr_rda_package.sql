-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_cargas_pck.remove_glosas_ocorr_rda ( nr_seq_conta_p pls_conta.nr_sequencia%type) AS $body$
BEGIN

	delete from pls_analise_fluxo_ocor
	where 	nr_seq_ocor_benef in ( SELECT nr_sequencia 
									from pls_ocorrencia_benef 
									where nr_seq_conta = nr_seq_conta_p);
									
	delete from pls_analise_glo_ocor_grupo
	where 	nr_seq_ocor_benef in ( SELECT nr_sequencia 
									from pls_ocorrencia_benef 
									where nr_seq_conta = nr_seq_conta_p);
									
	delete from pls_ocorrencia_benef where nr_seq_conta = nr_seq_conta_p;
	
	delete from pls_analise_fluxo_ocor
	where 	nr_seq_conta_glosa in ( SELECT 	nr_sequencia 
									from	pls_conta_glosa
									where 	nr_seq_conta = nr_seq_conta_p);
									
	delete from pls_analise_glo_ocor_grupo
	where 	nr_seq_conta_glosa in ( SELECT 	nr_sequencia 
									from 	pls_conta_glosa
									where 	nr_seq_conta = nr_seq_conta_p);
									
	delete from pls_conta_glosa where nr_seq_conta = nr_seq_conta_p;
	

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_cargas_pck.remove_glosas_ocorr_rda ( nr_seq_conta_p pls_conta.nr_sequencia%type) FROM PUBLIC;
