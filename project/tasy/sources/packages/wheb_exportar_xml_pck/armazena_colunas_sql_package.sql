-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE wheb_exportar_xml_pck.armazena_colunas_sql (cursor_p integer, ar_resultado_p INOUT myArray) AS $body$
DECLARE

	col_cnt     integer;	--Numero de colunas
	dtab        dbms_sql.desc_tab;	--Descricao da Tabela
	/*Tipos das Colunas*/


	l_date      timestamp;
	l_vc2	varchar(32767);
	--l_long	long;

	
BEGIN

		dbms_sql.describe_columns(cursor_p,col_cnt,dtab);
		/*Registra as colunas*/


		for i in 1 .. col_cnt loop
			if ( dtab[i].col_type =  12 ) then
				dbms_sql.define_column(cursor_p,i,l_date);
			elsif (  dtab[i].col_type = 8) then
				--dbms_sql.define_column(cursor_p,i,l_long,32764);

				dbms_sql.define_column_long(cursor_p,i);
			else
				dbms_sql.define_column(cursor_p,i,l_vc2,dtab[i].col_max_len);
			end if;
		/*Armazena a coluna para recuperar valor apos execucao do SQL*/


		ar_resultado_p[i].nm := dtab[i].col_name;
		end loop;
	end;


	/*Executa um SQL Dinamicamente e retorna um Array com o nome das colunas e o numero do Cursor
	  Utilizar a funcao armazena_sql para percorrer os registros
	*/

	--procedure wheb_exportar_xml_pck.executa_sql(ds_comando_p in VARCHAR2,ar_result_query_sup_p in myArray,ar_resultado_p out myArray, cursor_p out INTEGER) as


$body$
LANGUAGE PLPGSQL
;
-- REVOKE ALL ON PROCEDURE wheb_exportar_xml_pck.armazena_colunas_sql (cursor_p integer, ar_resultado_p INOUT myArray) FROM PUBLIC;
