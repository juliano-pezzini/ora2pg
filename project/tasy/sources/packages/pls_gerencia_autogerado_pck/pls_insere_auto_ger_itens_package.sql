-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';


--Insere na tabela de itens autogerado os registros armazenados nas tabelas.



CREATE OR REPLACE PROCEDURE pls_gerencia_autogerado_pck.pls_insere_auto_ger_itens ( tb_seq_lote_p dbms_sql.number_table, tb_cd_prestador_exec_p dbms_sql.varchar2_table, tb_calculo_auto_ger_p dbms_sql.number_table, tb_calculo_total_p dbms_sql.number_table, nm_usuario_p text) AS $body$
BEGIN

if (tb_seq_lote_p.count > 0) then

	forall  i in tb_seq_lote_p.first..tb_seq_lote_p.last
		insert into pls_auto_ger_itens(nr_sequencia,  dt_atualizacao, dt_atualizacao_nrec, nm_usuario,              
						nm_usuario_nrec, nr_seq_lote, cd_prestador,        
						vl_calculo_auto_ger, vl_calculo_total )
				values (nextval('pls_auto_ger_itens_seq'), clock_timestamp(), clock_timestamp(), nm_usuario_p,
						nm_usuario_p, tb_seq_lote_p(i), tb_cd_prestador_exec_p(i),
						tb_calculo_auto_ger_p(i), tb_calculo_total_p(i) );
end if;
commit;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_gerencia_autogerado_pck.pls_insere_auto_ger_itens ( tb_seq_lote_p dbms_sql.number_table, tb_cd_prestador_exec_p dbms_sql.varchar2_table, tb_calculo_auto_ger_p dbms_sql.number_table, tb_calculo_total_p dbms_sql.number_table, nm_usuario_p text) FROM PUBLIC;
