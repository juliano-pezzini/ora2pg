-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE wheb_exportar_hl7_long_pck.armazena_parametros (ds_parametros_p text) AS $body$
DECLARE

	ds_param_atual_w 	varchar(255);
	ds_parametros_w 	varchar(2000);
	nr_pos_separador_w	bigint;
	qt_parametros_w		bigint;
	qt_sep_bv_w		bigint;
	
BEGIN
		qt_sep_bv_w	   := length(current_setting('wheb_exportar_hl7_long_pck.ds_sep_bv_w')::varchar(100));
		ds_parametros_w    := ds_parametros_p;
		nr_pos_separador_w := position(current_setting('wheb_exportar_hl7_long_pck.ds_sep_bv_w')::varchar(100) in ds_parametros_w);
		qt_parametros_w	   := current_setting('wheb_exportar_hl7_long_pck.ar_parametros_w')::myArray.count;
		while(nr_pos_separador_w > 0 ) loop
			begin
			qt_parametros_w := qt_parametros_w + 1;
			ds_param_atual_w  := substr(ds_parametros_w,1,nr_pos_separador_w-1);
			ds_parametros_w   := substr(ds_parametros_w,nr_pos_separador_w+qt_sep_bv_w,length(ds_parametros_w));
			nr_pos_separador_w := position('=' in ds_param_atual_w);
			current_setting('wheb_exportar_hl7_long_pck.ar_parametros_w')::myArray[qt_parametros_w].nm := upper(substr(ds_param_atual_w,1,nr_pos_separador_w-1));
			current_setting('wheb_exportar_hl7_long_pck.ar_parametros_w')::myArray[qt_parametros_w].vl := substr(ds_param_atual_w,nr_pos_separador_w+1,length(ds_param_atual_w));
			nr_pos_separador_w := position(current_setting('wheb_exportar_hl7_long_pck.ds_sep_bv_w')::varchar(100) in ds_parametros_w);
			if (qt_parametros_w > 200) then
				nr_pos_separador_w := 0;
			end if;
			end;
		end loop;
	end;

	/*Armazena o parametros do projeto passados inicialmente*/

$body$
LANGUAGE PLPGSQL
;
-- REVOKE ALL ON PROCEDURE wheb_exportar_hl7_long_pck.armazena_parametros (ds_parametros_p text) FROM PUBLIC;
