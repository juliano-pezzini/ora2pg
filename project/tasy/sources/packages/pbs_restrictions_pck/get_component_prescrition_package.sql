-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

  --------------------------------------------
CREATE OR REPLACE PROCEDURE pbs_restrictions_pck.get_component_prescrition (nam_component_p text, nam_com_subtype_p text, cd_res_xml_id_p text, nr_pbs_version_p bigint, desc_com_ttmt_p INOUT text, desc_com_text_p INOUT text ) AS $body$
DECLARE

     desc_indi_text_w text;
     header_cc_w varchar(300);
     desc_clinical_text_w text;
     desc_prescriberins_text_w text;
     desc_ttmtphase_text_w text;
     desc_admadv_text_w text;
     desc_caution_text_w text;
     desc_ttmtcrit_text_w text;


BEGIN
     if (nam_component_p='indication') then 
       desc_indi_text_w := pbs_restrictions_pck.form_indication_texts(nam_component_p, nam_com_subtype_p, cd_res_xml_id_p, nr_pbs_version_p, desc_indi_text_w);
         desc_com_text_p :=     desc_indi_text_w||'<BR><BR>';
    end if;
     if (nam_component_p='criteria') then
         header_cc_w:= '<B>' || nam_com_subtype_p||' ' || nam_component_p ||' :' || '</B>'||'<BR>';
         desc_clinical_text_w := pbs_restrictions_pck.form_indication_texts(nam_component_p, nam_com_subtype_p, cd_res_xml_id_p, nr_pbs_version_p, desc_clinical_text_w);
         desc_com_text_p :=  header_cc_w||'<BR>'|| desc_clinical_text_w;
         if (nam_com_subtype_p='Treatment') then
           desc_ttmtcrit_text_w:=desc_com_text_p;
           desc_com_ttmt_p:=desc_ttmtcrit_text_w;
         end if;

    end if;
     if (nam_component_p='prescriber-instruction') then
      desc_prescriberins_text_w := pbs_restrictions_pck.form_indication_texts(nam_component_p, nam_com_subtype_p, cd_res_xml_id_p, nr_pbs_version_p, desc_prescriberins_text_w);
       desc_com_text_p :=    '<B><u>Prescriber-Instruction Note</B></u><BR><BR>'|| desc_prescriberins_text_w|| '<BR>';
     end if;
      if (nam_component_p='caution') then
      desc_caution_text_w := pbs_restrictions_pck.form_indication_texts(nam_component_p, nam_com_subtype_p, cd_res_xml_id_p, nr_pbs_version_p, desc_caution_text_w);
       desc_com_text_p :=     '<B><u>Caution</B></u><BR><BR>' ||desc_caution_text_w|| '<BR>';
     end if;
    if (nam_component_p='treatment-phase') then
       desc_ttmtphase_text_w := pbs_restrictions_pck.form_indication_texts(nam_component_p, nam_com_subtype_p, cd_res_xml_id_p, nr_pbs_version_p, desc_ttmtphase_text_w);
      desc_com_text_p :=    'Treatment Phase:'|| desc_ttmtphase_text_w|| '<BR>';
    end if;
     if (nam_component_p='administrative-advice') then
          desc_admadv_text_w := pbs_restrictions_pck.form_indication_texts(nam_component_p, nam_com_subtype_p, cd_res_xml_id_p, nr_pbs_version_p, desc_admadv_text_w);
           desc_com_text_p :=  '<B><u>Administrative-Advice Note</B></u><BR><BR>'||desc_admadv_text_w|| '<BR>';
    end if;
     END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pbs_restrictions_pck.get_component_prescrition (nam_component_p text, nam_com_subtype_p text, cd_res_xml_id_p text, nr_pbs_version_p bigint, desc_com_ttmt_p INOUT text, desc_com_text_p INOUT text ) FROM PUBLIC;
