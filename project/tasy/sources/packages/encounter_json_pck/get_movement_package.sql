-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION encounter_json_pck.get_movement ( nr_seq_atepacu_p bigint) RETURNS PHILIPS_JSON AS $body$
DECLARE

	
	json_mov_w		philips_json;
	C01 CURSOR FOR
		SELECT	*
		from	bft_encounter_movement_v
		where	movement_id	= nr_seq_atepacu_p;
	
	
BEGIN
	json_mov_w	:= philips_json();
	for r_c01 in c01 loop
		begin
		json_mov_w := encounter_json_pck.add_json_value(json_mov_w, 'pointOfCare', r_c01.point_of_care);
		json_mov_w := encounter_json_pck.add_json_value(json_mov_w, 'externalDepartmentId', r_c01.external_department_id);
		json_mov_w := encounter_json_pck.add_json_value(json_mov_w, 'departmentName', r_c01.department_name);
		json_mov_w := encounter_json_pck.add_json_value(json_mov_w, 'departmentId', r_c01.department_id);
		json_mov_w := encounter_json_pck.add_json_value(json_mov_w, 'roomId', r_c01.room_id);
		json_mov_w := encounter_json_pck.add_json_value(json_mov_w, 'bedId', r_c01.bed_id);
		json_mov_w := encounter_json_pck.add_json_value(json_mov_w, 'movementId', r_c01.movement_id);
		json_mov_w := encounter_json_pck.add_json_value(json_mov_w, 'departmentAdmitDate', r_c01.department_admit_date);
		json_mov_w := encounter_json_pck.add_json_value(json_mov_w, 'departmentExitDate', r_c01.department_exit_date);
		json_mov_w := encounter_json_pck.add_json_value(json_mov_w, 'monitoredBed', r_c01.monitored_bed);
		end;
	end loop;
	
	return json_mov_w;
	
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION encounter_json_pck.get_movement ( nr_seq_atepacu_p bigint) FROM PUBLIC;
