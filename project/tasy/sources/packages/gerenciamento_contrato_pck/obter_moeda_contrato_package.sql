-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

	
	-->>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>++++++ FUNcoES AUXILIARES ++++++<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<--
		
	-->>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>> Obter a moeda do contrato <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<--
	/*
	Objetivo: Retornar a moeda do contrato (tabela: contrato.cd_moeda_estrangeira).
	Parametros: 
	nr_seq_contrato_p = Numero de sequencia do contrato.
	*/
CREATE OR REPLACE FUNCTION gerenciamento_contrato_pck.obter_moeda_contrato (nr_seq_contrato_p bigint) RETURNS bigint AS $body$
DECLARE

		
		cd_moeda_contrato_w contrato.cd_moeda_estrangeira%type;
		cd_estabelecimento_w contrato.cd_estabelecimento%type;
		
		
BEGIN
			if ((nr_seq_contrato_p IS NOT NULL AND nr_seq_contrato_p::text <> '') and nr_seq_contrato_p > 0) then
				select coalesce(cd_moeda_estrangeira, obter_moeda_padrao_empresa(cd_estabelecimento, 'E'))
				  into STRICT cd_moeda_contrato_w
				  from contrato
				 where nr_sequencia = nr_seq_contrato_p;
			else
				cd_moeda_contrato_w := 0;
			end if;
		
		return cd_moeda_contrato_w;
		
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION gerenciamento_contrato_pck.obter_moeda_contrato (nr_seq_contrato_p bigint) FROM PUBLIC;
