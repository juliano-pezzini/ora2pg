-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE convert_schematic_to_bo_pck.copy_filter_dimensions ( nr_seq_dic_objeto_p bigint, ds_opcoes_p text) AS $body$
DECLARE

	 
	ds_opcoes_w		dic_objeto_filtro.ds_opcoes%type;	
	ds_opcoes_new_w		dic_objeto_filtro.ds_opcoes%type;
	nr_seq_dic_new_w	dic_objeto_filtro.nr_sequencia%type;
	ds_obj_w		varchar(255);
	i			integer;
	
BEGIN
	 
	ds_opcoes_new_w	:= null;
	ds_opcoes_w	:= ds_opcoes_p;	
	i		:= 1;
	ds_obj_w	:= '0';	
 
	while 	(ds_obj_w IS NOT NULL AND ds_obj_w::text <> '') loop 
	 
		nr_seq_dic_new_w	:= null;
	 
		select	OBTER_VALOR_CAMPO_SEPARADOR(ds_opcoes_w,i,',') 
		into STRICT	ds_obj_w 
		;
 
		if (somente_numero(ds_obj_w) > 0) then		 
			nr_seq_dic_new_w := convert_schematic_to_bo_pck.copy_dic_objeto( null, null, somente_numero(ds_obj_w), null, current_setting('convert_schematic_to_bo_pck.nr_seq_bo_w')::business_object.nr_sequencia%type, current_setting('convert_schematic_to_bo_pck.nm_usuario_w')::usuario.nm_usuario%type, nr_seq_dic_new_w);		
			if (coalesce(ds_opcoes_new_w::text, '') = '') then 
				ds_opcoes_new_w	:= to_char(nr_seq_dic_new_w);
			else 
				ds_opcoes_new_w := ds_opcoes_new_w||','||to_char(nr_seq_dic_new_w);
			end if;
		end if;
		 
		i		:= i + 1;
		ds_opcoes_w	:= replace(ds_opcoes_w,ds_obj_w,'');
					 
	end loop;
	 
	if (trim(both replace(ds_opcoes_new_w,',','')) is not null) then 
		update	dic_objeto_filtro 
		set	ds_opcoes 	= ds_opcoes_new_w 
		where	nr_sequencia	= nr_seq_dic_objeto_p;
	end if;
	 
	end;
	--FIM COPIA OS ITENS DO CORSIS_FV, FILTROS MULTISELECAO 
	 
	--EVENTOS DE MENU ITENS E BOTÃ•ES DO WDLG 
$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE convert_schematic_to_bo_pck.copy_filter_dimensions ( nr_seq_dic_objeto_p bigint, ds_opcoes_p text) FROM PUBLIC;
