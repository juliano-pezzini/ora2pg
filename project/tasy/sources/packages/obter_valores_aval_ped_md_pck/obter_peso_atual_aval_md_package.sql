-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION obter_valores_aval_ped_md_pck.obter_peso_atual_aval_md (ie_origem_peso_p text, qt_altura_joelho_p bigint, ie_sexo_p text, qt_idade_p bigint, qt_prega_cut_subesc_p bigint, qt_circ_panturrilha_p bigint, qt_circ_braco_p bigint, qt_circ_abdomen_p bigint, ie_raca_negra_p text ) RETURNS bigint AS $body$
DECLARE

		qt_peso_atual_w bigint;
	
BEGIN
		if (ie_origem_peso_p = 'F') and (qt_altura_joelho_p IS NOT NULL AND qt_altura_joelho_p::text <> '') then
			if (ie_sexo_p	= 	'M') then
				qt_peso_atual_w	:= 	(60.65 + (qt_altura_joelho_p * 2.04));
			else
				qt_peso_atual_w	:= 	(84.88 + (qt_altura_joelho_p * 1.83) - (qt_idade_p * 0.24));
			end if;
		
		elsif (ie_origem_peso_p = 'C') and (qt_prega_cut_subesc_p IS NOT NULL AND qt_prega_cut_subesc_p::text <> '') and (qt_circ_panturrilha_p IS NOT NULL AND qt_circ_panturrilha_p::text <> '') and (qt_circ_braco_p IS NOT NULL AND qt_circ_braco_p::text <> '') and (qt_altura_joelho_p IS NOT NULL AND qt_altura_joelho_p::text <> '') then
			begin
			if (ie_sexo_p	= 	'M') then
				qt_peso_atual_w	:= ((0.98 * qt_circ_panturrilha_p) + (1.16 * qt_altura_joelho_p) + (1.73 * qt_circ_braco_p) + (0.37 * qt_prega_cut_subesc_p) - 81.69);
			else
				qt_peso_atual_w	:= ((1.27 * qt_circ_panturrilha_p) + (0.87 * qt_altura_joelho_p) + (0.98 * qt_circ_braco_p) + (0.4 * qt_prega_cut_subesc_p) - 62.35);

			end if;
			end;
		
		elsif (ie_origem_peso_p = 'R') and (qt_circ_abdomen_p IS NOT NULL AND qt_circ_abdomen_p::text <> '') and (qt_circ_panturrilha_p IS NOT NULL AND qt_circ_panturrilha_p::text <> '') and (qt_circ_braco_p IS NOT NULL AND qt_circ_braco_p::text <> '') then
			begin
			if (ie_sexo_p	= 	'M') then
				qt_peso_atual_w	:= ((0.5759 * qt_circ_braco_p) + (0.5263 * qt_circ_abdomen_p) + (1.2452 * qt_circ_panturrilha_p) - (4.8689 * 1) - 32.9241);
			else
				qt_peso_atual_w	:= ((0.5759 * qt_circ_braco_p) + (0.5263 * qt_circ_abdomen_p) + (1.2452 * qt_circ_panturrilha_p) - (4.8689 * 2) - 32.9241);
			end if;
			end;

		elsif (ie_origem_peso_p = 'J')and (qt_circ_braco_p IS NOT NULL AND qt_circ_braco_p::text <> '') and (qt_altura_joelho_p IS NOT NULL AND qt_altura_joelho_p::text <> '') then
			begin
			if (ie_sexo_p	= 	'M') then
					if (ie_raca_negra_p	=	'N') then
						if (qt_idade_p between 19 and 59) then
							qt_peso_atual_w :=  ((qt_altura_joelho_p * 1.19) + (qt_circ_braco_p * 3.14) - (83.72));
						elsif (qt_idade_p between 60 and 80) then 
							qt_peso_atual_w :=  ((qt_altura_joelho_p * 1.10) + (qt_circ_braco_p * 3.07) - (75.81));
						end if;
					else
						if (qt_idade_p between 19 and 59) then
							qt_peso_atual_w :=  ((qt_altura_joelho_p * 1.09) + (qt_circ_braco_p * 3.14) - (83.72));
						elsif (qt_idade_p between 60 and 80) then
							qt_peso_atual_w :=  ((qt_altura_joelho_p * 0.44) + (qt_circ_braco_p * 2.86) - (39.21));
						end if;
					end if;
			elsif (ie_sexo_p	= 	'F') then
				if (ie_raca_negra_p	=	'N') then
					if (qt_idade_p between 19 and 59) then
						qt_peso_atual_w :=  ((qt_altura_joelho_p * 1.01) + (qt_circ_braco_p * 2.81) - (66.04));
					elsif (qt_idade_p between 60 and 80) then 
						qt_peso_atual_w :=  ((qt_altura_joelho_p * 1.09) + (qt_circ_braco_p * 2.68) - (65.51));
					end if;
				else
					if (qt_idade_p between 19 and 59) then
						qt_peso_atual_w :=  ((qt_altura_joelho_p * 1.24) + (qt_circ_braco_p * 2.97) - (82.48));
					elsif (qt_idade_p between 60 and 80) then
						qt_peso_atual_w :=  ((qt_altura_joelho_p * 1.50) + (qt_circ_braco_p * 2.58) - (84.22));
					end if;	
				end if;
			end if;
			end;
		end if;

		return qt_peso_atual_w;
	end;



$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_valores_aval_ped_md_pck.obter_peso_atual_aval_md (ie_origem_peso_p text, qt_altura_joelho_p bigint, ie_sexo_p text, qt_idade_p bigint, qt_prega_cut_subesc_p bigint, qt_circ_panturrilha_p bigint, qt_circ_braco_p bigint, qt_circ_abdomen_p bigint, ie_raca_negra_p text ) FROM PUBLIC;
