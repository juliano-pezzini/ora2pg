-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION obter_valores_aval_ped_md_pck.obter_necessidade_energ_md (ie_tcth_p text, ie_sexo_p text, idade_ano_p bigint, qt_peso_atual_p bigint, qt_meses_p bigint, qt_necessidade_energetica_p bigint ) RETURNS bigint AS $body$
DECLARE

	   qt_necessidade_energetica_w bigint;
	
BEGIN
		if (ie_tcth_p = 'PR') then			
			if (ie_sexo_p = 'M') then
				if (idade_ano_p >= 0) and (idade_ano_p < 3) then
					qt_necessidade_energetica_w := ((0.249 * qt_peso_atual_p) - 0.127) * 238.85;
				elsif (idade_ano_p >= 3) and (idade_ano_p < 10) then	
					qt_necessidade_energetica_w := ((0.095 * qt_peso_atual_p) + 2.110) * 238.85;
				elsif (idade_ano_p >= 10) and (idade_ano_p <= 18) then			
					qt_necessidade_energetica_w := ((0.074 * qt_peso_atual_p) + 2.754) * 238.85;
				end if;	
			elsif (idade_ano_p >= 0) and (idade_ano_p < 3) then
				qt_necessidade_energetica_w := ((0.244 * qt_peso_atual_p) - 0.130) * 238.85;
			elsif (idade_ano_p >= 3) and (idade_ano_p <= 10) then	
				qt_necessidade_energetica_w := ((0.085 * qt_peso_atual_p) + 2.033) * 238.85;
			elsif (idade_ano_p >= 10) and (idade_ano_p < 18) then	
				qt_necessidade_energetica_w := ((0.056 * qt_peso_atual_p) + 2.898) * 238.85;
			end if;
		elsif (ie_tcth_p = 'PO') then
			if (qt_meses_p > 3) and (qt_meses_p <= 35) then
				qt_necessidade_energetica_w := (89 * qt_peso_atual_p) - 100 + 22;
			elsif (qt_meses_p <= 3) then
				qt_necessidade_energetica_w := (89 * qt_peso_atual_p) - 100 + 175;
				
			elsif (qt_meses_p >= 4) and (qt_meses_p <= 6) then
				qt_necessidade_energetica_w := (89 * qt_peso_atual_p) - 100 + 56;	

			elsif (qt_meses_p >= 7) and (qt_meses_p <= 12) then
				qt_necessidade_energetica_w := (89 * qt_peso_atual_p) - 100 + 22;	
			
			elsif (qt_meses_p >= 13) and (qt_meses_p <= 35) then
				qt_necessidade_energetica_w := (89 * qt_peso_atual_p) - 100 + 20;		
			
			else
				qt_necessidade_energetica_w := qt_necessidade_energetica_p;
			end if;
			
		elsif (qt_meses_p <= 35) then
			qt_necessidade_energetica_w := (89 * qt_peso_atual_p) - 100 + 22;
		else
			qt_necessidade_energetica_w := qt_necessidade_energetica_p;
		end if;

		return qt_necessidade_energetica_w;
	end;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION obter_valores_aval_ped_md_pck.obter_necessidade_energ_md (ie_tcth_p text, ie_sexo_p text, idade_ano_p bigint, qt_peso_atual_p bigint, qt_meses_p bigint, qt_necessidade_energetica_p bigint ) FROM PUBLIC;
