-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pls_util_pck.obter_data_com_hora ( dt_item_p timestamp, ie_tipo_data_p text) RETURNS timestamp AS $body$
DECLARE


dt_item_ins_w	timestamp;
ie_tem_hora_w	varchar(1);


BEGIN
-- verifica se tem hora na data
ie_tem_hora_w := obter_se_data_tem_hora(dt_item_p);

-- se tem hora na data sempre será inserido a data e hora
if (ie_tem_hora_w = 'S') then
	dt_item_ins_w := dt_item_p;
else
	-- se não tem hora significa que no momento de realizar a busca será considerado o dia inteiro
	-- isso significa que será armazenado, por exemplo, 12/12/2014 00:00:00 e 12/12/2014 23:59:59
	if (ie_tipo_data_p = 'INICIO_DIA') then
		dt_item_ins_w := trunc(dt_item_p, 'DD');
	else
		dt_item_ins_w := fim_dia(dt_item_p);
	end if;

end if;

return dt_item_ins_w;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pls_util_pck.obter_data_com_hora ( dt_item_p timestamp, ie_tipo_data_p text) FROM PUBLIC;
