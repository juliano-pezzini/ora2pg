-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION ageint_sugerir_html5_pck.obter_maior_tempo_entre_itens (cd_agenda_seg_p bigint, cd_estab_seg_p bigint, nr_seq_proc_seg_p bigint, nr_seq_grupo_seg_p bigint, cd_setor_seg_p bigint, hr_agenda_seg_pp timestamp, cd_agenda_pri_p bigint, cd_estab_pri_p bigint, nr_seq_proc_pri_p bigint, nr_seq_grupo_pri_p bigint, cd_setor_pri_p bigint, dt_referencia_p timestamp) RETURNS bigint AS $body$
DECLARE

	
	qt_min_salas_w	bigint;
	qt_min_estab_w	bigint;
	qt_min_exame_w	bigint;
	qt_min_grupo_w	bigint;
	qt_min_setor_w	bigint;
	qt_minuto_w	bigint := 0;
	
	
BEGIN
  qt_min_salas_w := ageint_sugerir_html5_pck.obter_tempo_salas(cd_agenda_pri_p,cd_agenda_seg_p,cd_estab_pri_p,cd_estab_seg_p);
  qt_min_estab_w := ageint_sugerir_html5_pck.obter_tempo_estab(cd_estab_pri_p, cd_estab_seg_p);
  qt_min_exame_w := ageint_sugerir_html5_pck.obter_max_tempo_exame(nr_seq_proc_pri_p,nr_seq_proc_seg_p,cd_estab_pri_p,cd_estab_seg_p, hr_agenda_seg_pp, dt_referencia_p, cd_estab_pri_p);
  qt_min_grupo_w := ageint_sugerir_html5_pck.obter_max_tempo_grupo(nr_seq_grupo_pri_p, nr_seq_grupo_seg_p);
  qt_min_setor_w := ageint_sugerir_html5_pck.obter_max_tempo_setor(cd_setor_pri_p, cd_setor_seg_p);
  qt_minuto_w := greatest(qt_min_salas_w,qt_min_exame_w,qt_min_grupo_w,qt_min_estab_w,qt_min_setor_w);
	
	return qt_minuto_w;
	
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION ageint_sugerir_html5_pck.obter_maior_tempo_entre_itens (cd_agenda_seg_p bigint, cd_estab_seg_p bigint, nr_seq_proc_seg_p bigint, nr_seq_grupo_seg_p bigint, cd_setor_seg_p bigint, hr_agenda_seg_pp timestamp, cd_agenda_pri_p bigint, cd_estab_pri_p bigint, nr_seq_proc_pri_p bigint, nr_seq_grupo_pri_p bigint, cd_setor_pri_p bigint, dt_referencia_p timestamp) FROM PUBLIC;
