-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE ageint_sugerir_html5_pck.liberar_horario (nr_seq_marc_usu_p bigint, nr_seq_item_p bigint, nr_Seq_ageint_p bigint, hr_agenda_p timestamp, cd_agenda_p bigint, nm_usuario_p text, ie_encaixe_p text) AS $body$
BEGIN

    delete  FROM ageint_marcacao_usuario
    where (nr_sequencia            = nr_seq_marc_usu_p)
    or (nr_seq_ageint_item     = nr_seq_item_p
    and     ie_horario_auxiliar      = 'S');

    if (ie_encaixe_p   = 'S') then
      delete  FROM ageint_encaixe_usuario
      where   cd_agenda               = cd_agenda_p
      and     dt_encaixe              = hr_agenda_p
      and     nm_usuario              = nm_usuario_p
      and     nr_seq_ageint           = nr_Seq_ageint_p
      and     nr_seq_ageint_item      = nr_seq_item_p;

      delete  FROM ageint_horarios_usuario
      where   cd_agenda               = cd_agenda_p
      and     hr_agenda               = hr_Agenda_p
      and     nm_usuario              = nm_usuario_p
      and     coalesce(ie_encaixe,'N')     = 'S';
    end if;

    commit;

  END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ageint_sugerir_html5_pck.liberar_horario (nr_seq_marc_usu_p bigint, nr_seq_item_p bigint, nr_Seq_ageint_p bigint, hr_agenda_p timestamp, cd_agenda_p bigint, nm_usuario_p text, ie_encaixe_p text) FROM PUBLIC;
