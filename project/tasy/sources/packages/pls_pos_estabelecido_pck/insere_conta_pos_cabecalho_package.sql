-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';



--Insere os registros referentes a pls_conta_pos_cabecalho



CREATE OR REPLACE PROCEDURE pls_pos_estabelecido_pck.insere_conta_pos_cabecalho ( rec_dados_pos_cab_p INOUT table_conta_cabecalho, nm_usuario_p usuario.nm_usuario%type) AS $body$
BEGIN
	if (rec_dados_pos_cab_p.nr_sequencia.count > 0) then
	
		forall i in rec_dados_pos_cab_p.nr_sequencia.first..rec_dados_pos_cab_p.nr_sequencia.last
			insert into pls_conta_pos_cabecalho( nr_sequencia, nm_usuario, dt_atualizacao,
				nm_usuario_nrec, dt_atualizacao_nrec, nr_seq_conta,
				nr_seq_segurado, cd_guia, cd_guia_prestador,
				cd_guia_referencia, nr_seq_tipo_atendimento, dt_alta,
				nr_seq_saida_spsadt, dt_entrada, ie_tipo_consulta,
				cd_excecao, nr_seq_congenere, dt_atendimento,
				cd_medico_solicitante, cd_medico_executor, ie_carater_internacao,
				ie_indicacao_acidente, nr_seq_tipo_acomodacao, nr_seq_clinica,
				ie_regime_internacao, cd_cooperativa, ie_recem_nascido,
				dt_recebimento_prot, nr_seq_saida_consulta, nr_seq_saida_int,
				ie_tipo_guia, dt_mes_competencia, nr_protocolo_prestador,
				dt_protocolo, cd_senha,	nr_seq_prestador,
				nr_seq_prestador_exec, ie_tipo_segurado, ie_origem_conta,
				nr_seq_fatura, nr_seq_nota_cobranca, cd_senha_externa,
				cd_usuario_plano_imp, nr_seq_grau_partic, ie_tipo_doenca,
				ie_tipo_acomodacao_ptu,	ie_tipo_protocolo, cd_estabelecimento,
				nr_seq_discussao, nr_seq_conta_rec, nr_seq_protocolo,
				nr_seq_prestador_atend, ie_tipo_prestador_exec, ie_tipo_prestador_atend,
				ie_preco)
			values (
				rec_dados_pos_cab_p.nr_sequencia(i), nm_usuario_p, clock_timestamp(),
				nm_usuario_p, clock_timestamp(), rec_dados_pos_cab_p.nr_seq_conta(i),
				rec_dados_pos_cab_p.nr_seq_segurado(i), rec_dados_pos_cab_p.cd_guia(i), rec_dados_pos_cab_p.cd_guia_prestador(i),
				rec_dados_pos_cab_p.cd_guia_referencia(i), rec_dados_pos_cab_p.nr_seq_tipo_atendimento(i), rec_dados_pos_cab_p.dt_alta(i),
				rec_dados_pos_cab_p.nr_seq_saida_spsadt(i), rec_dados_pos_cab_p.dt_entrada(i), rec_dados_pos_cab_p.ie_tipo_consulta(i),
				rec_dados_pos_cab_p.cd_excecao(i), rec_dados_pos_cab_p.nr_seq_congenere(i), rec_dados_pos_cab_p.dt_atendimento(i),
				rec_dados_pos_cab_p.cd_medico_solicitante(i), rec_dados_pos_cab_p.cd_medico_executor(i), rec_dados_pos_cab_p.ie_carater_internacao(i),
				rec_dados_pos_cab_p.ie_indicacao_acidente(i), rec_dados_pos_cab_p.nr_seq_tipo_acomodacao(i), rec_dados_pos_cab_p.nr_seq_clinica(i),
				rec_dados_pos_cab_p.ie_regime_internacao(i), rec_dados_pos_cab_p.cd_cooperativa(i), rec_dados_pos_cab_p.ie_recem_nascido(i),
				rec_dados_pos_cab_p.dt_recebimento_prot(i), rec_dados_pos_cab_p.nr_seq_saida_consulta(i), rec_dados_pos_cab_p.nr_seq_saida_int(i),
				rec_dados_pos_cab_p.ie_tipo_guia(i), rec_dados_pos_cab_p.dt_mes_competencia(i),	 rec_dados_pos_cab_p.nr_protocolo_prestador(i),
				rec_dados_pos_cab_p.dt_protocolo(i), rec_dados_pos_cab_p.cd_senha(i), rec_dados_pos_cab_p.nr_seq_prestador(i),
				rec_dados_pos_cab_p.nr_seq_prestador_exec(i), rec_dados_pos_cab_p.ie_tipo_segurado(i), rec_dados_pos_cab_p.ie_origem_conta(i),
				rec_dados_pos_cab_p.nr_seq_fatura(i), rec_dados_pos_cab_p.nr_seq_nota_cobranca(i), rec_dados_pos_cab_p.cd_senha_externa(i),
				rec_dados_pos_cab_p.cd_usuario_plano_imp(i), rec_dados_pos_cab_p.nr_seq_grau_partic(i), rec_dados_pos_cab_p.ie_tipo_doenca(i),
				rec_dados_pos_cab_p.ie_tipo_acomodacao_ptu(i), rec_dados_pos_cab_p.ie_tipo_protocolo(i), rec_dados_pos_cab_p.cd_estabelecimento(i),
				rec_dados_pos_cab_p.nr_seq_discussao(i), rec_dados_pos_cab_p.nr_seq_conta_rec(i), rec_dados_pos_cab_p.nr_seq_protocolo(i),
				rec_dados_pos_cab_p.nr_seq_prestador_atend(i), rec_dados_pos_cab_p.ie_tipo_prestador_exec(i), rec_dados_pos_cab_p.ie_tipo_prestador_atend(i),
				rec_dados_pos_cab_p.ie_preco(i)
				);
	end if;
	
	rec_dados_pos_cab_p.nr_sequencia.delete;
	rec_dados_pos_cab_p.nr_seq_conta.delete;
	rec_dados_pos_cab_p.nr_seq_segurado.delete;
	rec_dados_pos_cab_p.cd_guia.delete;
	rec_dados_pos_cab_p.cd_guia_prestador.delete;
	rec_dados_pos_cab_p.cd_guia_referencia.delete;
	rec_dados_pos_cab_p.nr_seq_tipo_atendimento.delete;
	rec_dados_pos_cab_p.dt_alta.delete;
	rec_dados_pos_cab_p.nr_seq_saida_spsadt.delete;
	rec_dados_pos_cab_p.dt_entrada.delete;
	rec_dados_pos_cab_p.ie_tipo_consulta.delete;
	rec_dados_pos_cab_p.cd_excecao.delete;
	rec_dados_pos_cab_p.nr_seq_congenere.delete;
	rec_dados_pos_cab_p.dt_atendimento.delete;
	rec_dados_pos_cab_p.cd_medico_solicitante.delete;
	rec_dados_pos_cab_p.cd_medico_executor.delete;
	rec_dados_pos_cab_p.ie_carater_internacao.delete;
	rec_dados_pos_cab_p.ie_indicacao_acidente.delete;
	rec_dados_pos_cab_p.nr_seq_tipo_acomodacao.delete;
	rec_dados_pos_cab_p.nr_seq_clinica.delete;
	rec_dados_pos_cab_p.ie_regime_internacao.delete;
	rec_dados_pos_cab_p.cd_cooperativa.delete;
	rec_dados_pos_cab_p.ie_recem_nascido.delete;
	rec_dados_pos_cab_p.dt_recebimento_prot.delete;
	rec_dados_pos_cab_p.nr_seq_saida_consulta.delete;
	rec_dados_pos_cab_p.nr_seq_saida_int.delete;
	rec_dados_pos_cab_p.ie_tipo_guia.delete;
	rec_dados_pos_cab_p.dt_mes_competencia.delete;
	rec_dados_pos_cab_p.nr_protocolo_prestador.delete;
	rec_dados_pos_cab_p.dt_protocolo.delete;
	rec_dados_pos_cab_p.cd_senha.delete;
	rec_dados_pos_cab_p.nr_seq_prestador.delete;
	rec_dados_pos_cab_p.nr_seq_prestador_exec.delete;
	rec_dados_pos_cab_p.ie_tipo_segurado.delete;
	rec_dados_pos_cab_p.ie_origem_conta.delete;
	rec_dados_pos_cab_p.nr_seq_fatura.delete;
	rec_dados_pos_cab_p.nr_seq_nota_cobranca.delete;
	rec_dados_pos_cab_p.cd_senha_externa.delete;
	rec_dados_pos_cab_p.cd_usuario_plano_imp.delete;
	rec_dados_pos_cab_p.nr_seq_grau_partic.delete;
	rec_dados_pos_cab_p.ie_tipo_doenca.delete;
	rec_dados_pos_cab_p.ie_tipo_acomodacao_ptu.delete;
	rec_dados_pos_cab_p.ie_tipo_protocolo.delete;
	rec_dados_pos_cab_p.cd_estabelecimento.delete;
	rec_dados_pos_cab_p.nr_seq_discussao.delete;
	rec_dados_pos_cab_p.nr_seq_conta_rec.delete;
	rec_dados_pos_cab_p.nr_seq_protocolo.delete;
	rec_dados_pos_cab_p.nr_seq_prestador_atend.delete;
	rec_dados_pos_cab_p.ie_tipo_prestador_exec.delete;
	rec_dados_pos_cab_p.ie_tipo_prestador_atend.delete;
	rec_dados_pos_cab_p.ie_preco.delete;
	
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_pos_estabelecido_pck.insere_conta_pos_cabecalho ( rec_dados_pos_cab_p INOUT table_conta_cabecalho, nm_usuario_p usuario.nm_usuario%type) FROM PUBLIC;
