-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE audc_auditoria_concorrente_pck.audc_gerar_auditoria ( nr_seq_lote_atend_imp_p audc_lote_atendimento_imp.nr_sequencia%type, nm_usuario_p usuario.nm_usuario%type) AS $body$
BEGIN

--Carrega a lista de atendimentos para a tabela de auditoria

CALL audc_auditoria_concorrente_pck.audc_carregar_atendimentos(nr_seq_lote_atend_imp_p, nm_usuario_p);


--Gerar grupo de analise

CALL audc_auditoria_concorrente_pck.audc_gerar_grupo_auditor(nr_seq_lote_atend_imp_p, nm_usuario_p);


--Rotina utilizada para gerar notificacao para auditor e prestador, nao executa commit diretamente

CALL audc_auditoria_concorrente_pck.audc_gerar_notificacao(nr_seq_lote_atend_imp_p, nm_usuario_p);

commit;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE audc_auditoria_concorrente_pck.audc_gerar_auditoria ( nr_seq_lote_atend_imp_p audc_lote_atendimento_imp.nr_sequencia%type, nm_usuario_p usuario.nm_usuario%type) FROM PUBLIC;
