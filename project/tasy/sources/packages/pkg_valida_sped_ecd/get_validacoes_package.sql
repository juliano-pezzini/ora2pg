-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pkg_valida_sped_ecd.get_validacoes ( nm_usuario_p usuario.nm_usuario%type , cd_empresa_p empresa.cd_empresa%type , cd_estabelecimento_p estabelecimento.cd_estabelecimento%type , nr_seq_sped_controle_p ctb_sped_controle.nr_sequencia%type , ie_val_ap_bp_p text default 'S' /* Validar o valor de ativo e passivo do balanco patrimonial */
, ie_val_detalhe_bp_p text default 'S' /* Validar o valor de ativo e passivo das contas analiticas do balanco patrimonial */
, ie_val_qt_nivel_bp_p text default 'S' /* Validar os niveis da estrutura do balanco patrimonial */
, ie_val_tp_lin_sped_dre_p text default 'S' /* Validar se o cadastro da DRE esta com o Tipo linha SPED informado */
, ie_val_rub_sup_p text default 'S' /* Validar informacao de rubrica superior */
, ie_val_cad_cont_p text default 'S' /* Validar cadastro do contador */
, ie_val_inst_resp_p text default 'S' /* Validar informacao de instituicao responsavel */
) RETURNS SETOF T_VALIDACAO AS $body$
DECLARE

        validacao_w r_validacao;
        nr_ordem_w integer;

BEGIN
        validacao_w.nr_ordem := 0;
        if (ie_val_ap_bp_p = 'S') then
            validacao_w.nr_ordem   := validacao_w.nr_ordem + 1;
            validacao_w.cd_erro    := lpad(current_setting('pkg_valida_sped_ecd.cod_ie_val_ap_bp_w')::smallint,10,'0');
            validacao_w.ds_erro    := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.err_ie_val_ap_bp_w')::varchar(4000));
            validacao_w.ds_causa   := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.cau_ie_val_ap_bp_w')::varchar(4000));
            validacao_w.ds_solucao := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.sol_ie_val_ap_bp_w')::varchar(4000));
            RETURN NEXT validacao_w;
        end if;

        if (ie_val_detalhe_bp_p = 'S') then
            validacao_w.nr_ordem   := validacao_w.nr_ordem + 1;
            validacao_w.cd_erro    := lpad(current_setting('pkg_valida_sped_ecd.cod_ie_val_detalhe_bp_w')::smallint,10,'0');
            validacao_w.ds_erro    := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.err_ie_val_detalhe_bp_w')::varchar(4000));
            validacao_w.ds_causa   := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.cau_ie_val_detalhe_bp_w')::varchar(4000));
            validacao_w.ds_solucao := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.sol_ie_val_detalhe_bp_w')::varchar(4000));
            RETURN NEXT validacao_w;
        end if;

        if (ie_val_qt_nivel_bp_p = 'S') then
            validacao_w.nr_ordem   := validacao_w.nr_ordem + 1;
            validacao_w.cd_erro    := lpad(current_setting('pkg_valida_sped_ecd.cod_ie_val_qt_nivel_bp_w')::smallint,10,'0');
            validacao_w.ds_erro    := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.err_ie_val_qt_nivel_bp_w')::varchar(4000));
            validacao_w.ds_causa   := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.cau_ie_val_qt_nivel_bp_w')::varchar(4000));
            validacao_w.ds_solucao := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.sol_ie_val_qt_nivel_bp_w')::varchar(4000));
            RETURN NEXT validacao_w;
        end if;

        if (ie_val_tp_lin_sped_dre_p = 'S') then
            validacao_w.nr_ordem   := validacao_w.nr_ordem + 1;
            validacao_w.cd_erro    := lpad(current_setting('pkg_valida_sped_ecd.cod_ie_val_tp_lin_sped_dre_w')::smallint,10,'0');
            validacao_w.ds_erro    := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.err_ie_val_tp_lin_sped_dre_w')::varchar(4000));
            validacao_w.ds_causa   := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.cau_ie_val_tp_lin_sped_dre_w')::varchar(4000));
            validacao_w.ds_solucao := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.sol_ie_val_tp_lin_sped_dre_w')::varchar(4000));
            RETURN NEXT validacao_w;
        end if;

        if (ie_val_rub_sup_p = 'S') then
            validacao_w.nr_ordem   := validacao_w.nr_ordem + 1;
            validacao_w.cd_erro    := lpad(current_setting('pkg_valida_sped_ecd.cod_ie_val_rub_sup_w')::smallint,10,'0');
            validacao_w.ds_erro    := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.err_ie_val_rub_sup_w')::varchar(4000));
            validacao_w.ds_causa   := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.cau_ie_val_rub_sup_w')::varchar(4000));
            validacao_w.ds_solucao := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.sol_ie_val_rub_sup_w')::varchar(4000));
            RETURN NEXT validacao_w;
        end if;

        if (ie_val_cad_cont_p = 'S') then
            validacao_w.nr_ordem   := validacao_w.nr_ordem + 1;
            validacao_w.cd_erro    := lpad(current_setting('pkg_valida_sped_ecd.cod_ie_val_cad_cont_w')::smallint,10,'0');
            validacao_w.ds_erro    := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.err_ie_val_cad_cont_w')::varchar(4000));
            validacao_w.ds_causa   := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.cau_ie_val_cad_cont_w')::varchar(4000));
            validacao_w.ds_solucao := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.sol_ie_val_cad_cont_w')::varchar(4000));
            RETURN NEXT validacao_w;
        end if;

        if (ie_val_inst_resp_p = 'S') then
            validacao_w.nr_ordem   := validacao_w.nr_ordem + 1;
            validacao_w.cd_erro    := lpad(current_setting('pkg_valida_sped_ecd.cod_ie_val_inst_resp_w')::smallint,10,'0');
            validacao_w.ds_erro    := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.err_ie_val_inst_resp_w')::varchar(4000));
            validacao_w.ds_causa   := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.cau_ie_val_inst_resp_w')::varchar(4000));
            validacao_w.ds_solucao := coalesce(wheb_mensagem_pck.get_texto(000000),current_setting('pkg_valida_sped_ecd.sol_ie_val_inst_resp_w')::varchar(4000));
            RETURN NEXT validacao_w;
        end if;

        return;
    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pkg_valida_sped_ecd.get_validacoes ( nm_usuario_p usuario.nm_usuario%type , cd_empresa_p empresa.cd_empresa%type , cd_estabelecimento_p estabelecimento.cd_estabelecimento%type , nr_seq_sped_controle_p ctb_sped_controle.nr_sequencia%type , ie_val_ap_bp_p text default 'S'  , ie_val_detalhe_bp_p text default 'S'  , ie_val_qt_nivel_bp_p text default 'S'  , ie_val_tp_lin_sped_dre_p text default 'S'  , ie_val_rub_sup_p text default 'S'  , ie_val_cad_cont_p text default 'S'  , ie_val_inst_resp_p text default 'S'  ) FROM PUBLIC;
