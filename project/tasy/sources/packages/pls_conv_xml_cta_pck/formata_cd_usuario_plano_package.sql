-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pls_conv_xml_cta_pck.formata_cd_usuario_plano ( cd_usuario_plano_p pls_conta_imp.cd_usuario_plano%type, cd_estabelecimento_p estabelecimento.cd_estabelecimento%type) RETURNS varchar AS $body$
DECLARE


cd_usuario_plano_conv_w	pls_conta_imp.cd_usuario_plano_conv%type;


BEGIN
-- carrega os par_metros para vari_veis globais da package

CALL CALL CALL CALL CALL CALL pls_conv_xml_cta_pck.carrega_parametros(cd_estabelecimento_p, 'C');

-- formata o c_digo da carteirinha retirando caracteres especiais

cd_usuario_plano_conv_w := elimina_caracteres_especiais(cd_usuario_plano_p);

-- existe uma d_vida por parte dos usu_rios se deve ou n_o digitar o zero inicial do c_digo da carteirinha

-- por isso foi criado esse par_metro, se o c_digo tiver 16 posicoes acrescenta o zero no in_cio

-- isso _ valido e faz sentido existir somente no mundo das Unimeds

if (current_setting('pls_conv_xml_cta_pck.ie_valida_zero_param_w')::funcao_parametro.vl_parametro%type = 'S') then
	if (length(cd_usuario_plano_conv_w) = 16) then
		cd_usuario_plano_conv_w := '0' || cd_usuario_plano_conv_w;
	end if;
end if;

-- se existir letras converte para mai_scula

cd_usuario_plano_conv_w := upper(cd_usuario_plano_conv_w);

return cd_usuario_plano_conv_w;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pls_conv_xml_cta_pck.formata_cd_usuario_plano ( cd_usuario_plano_p pls_conta_imp.cd_usuario_plano%type, cd_estabelecimento_p estabelecimento.cd_estabelecimento%type) FROM PUBLIC;
