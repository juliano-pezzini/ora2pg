-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_conv_xml_cta_pck.atualiza_conv_conta ( tb_nr_seq_conta_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_usuario_plano_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_guia_operadora_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_guia_principal_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_cooperativa_cart_conv_p INOUT pls_util_cta_pck.t_varchar2_table_10, tb_cd_coop_cart_number_conv_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_congen_cart_conv_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_segurado_conv_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_congenere_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_prest_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_prest_exec_upper_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_prest_exec_number_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_cgc_prest_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_cpf_prest_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_nr_seq_prest_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_prest_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_prest_solic_upper_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_prest_solic_num_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_cgc_prest_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_cpf_prest_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_nr_seq_prest_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_regra_prof_exec_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_prof_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_nr_cons_prof_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_nr_seq_cons_prof_exe_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_uf_cons_prof_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_10, tb_nr_cbo_prof_exec_conv_p INOUT pls_util_cta_pck.t_number_table, tb_ie_carater_atend_conv_p INOUT pls_util_cta_pck.t_varchar2_table_10, tb_regra_prof_solic_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_prof_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_nr_cbo_prof_solic_conv_p INOUT pls_util_cta_pck.t_number_table, tb_nr_cons_prof_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_nr_seq_cons_prof_sol_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_uf_cons_prof_sol_conv_p INOUT pls_util_cta_pck.t_varchar2_table_10, tb_nr_seq_moti_ence_conv_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_guia_conv_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_tipo_atend_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_guia_ok_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_dt_atendimento_conv_p INOUT pls_util_cta_pck.t_date_table, tb_ie_tipo_atend_odonto_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_ie_tipo_internacao_conv_p INOUT pls_util_cta_pck.t_number_table, tb_ie_tipo_internado_conv_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_ie_vinc_internacao_conv_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_cd_convenio_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_categoria_conv_p INOUT pls_util_cta_pck.t_number_table, tb_ie_sexo_conv_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_qt_idade_conta_meses_conv_p INOUT pls_util_cta_pck.t_number_table, tb_qt_idade_conta_anos_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_prof_coop_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_cd_prof_coop_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_sg_estado_operadora_conv_p INOUT pls_util_cta_pck.t_varchar2_table_2, tb_ie_tipo_inter_oper_conv_p INOUT pls_util_cta_pck.t_varchar2_table_10, tb_tipo_faturamento_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_cd_cnes_p INOUT pls_util_cta_pck.t_varchar2_table_20, cd_estabelecimento_p estabelecimento.cd_estabelecimento%type, nm_usuario_p usuario.nm_usuario%type) AS $body$
BEGIN
-- se tiver algo para atualizar

if (tb_nr_seq_conta_conv_p.count > 0) then
	-- atualiza todos os dados convertidos

	forall i in tb_nr_seq_conta_conv_p.first..tb_nr_seq_conta_conv_p.last
		update 	pls_conta_imp set
			cd_usuario_plano_conv = tb_cd_usuario_plano_conv_p(i),
			cd_guia_operadora_conv = tb_cd_guia_operadora_conv_p(i),
			cd_guia_principal_conv = tb_cd_guia_principal_conv_p(i),
			cd_cooperativa_cart_conv = tb_cd_cooperativa_cart_conv_p(i),
			cd_coop_cart_number_conv = tb_cd_coop_cart_number_conv_p(i),
			nr_seq_congenere_cart_conv = tb_nr_seq_congen_cart_conv_p(i),
			nr_seq_segurado_conv = tb_nr_seq_segurado_conv_p(i),
			nr_seq_congenere_conv = tb_nr_seq_congenere_conv_p(i),
			cd_prest_exec_conv = tb_cd_prest_exec_conv_p(i),	
			cd_prest_exec_upper_conv = tb_cd_prest_exec_upper_conv_p(i),	
			cd_prest_exec_number_conv = tb_cd_prest_exec_number_conv_p(i),	
			cd_cgc_prest_exec_conv = tb_cd_cgc_prest_exec_conv_p(i),	
			cd_cpf_prest_exec_conv = tb_cd_cpf_prest_exec_conv_p(i),
			nr_seq_prest_exec_conv = tb_nr_seq_prest_exec_conv_p(i),
			cd_prest_solic_conv = tb_cd_prest_solic_conv_p(i),	
			cd_prest_solic_upper_conv = tb_cd_prest_solic_upper_conv_p(i),	
			cd_prest_solic_number_conv = tb_cd_prest_solic_num_conv_p(i),	
			cd_cgc_prest_solic_conv = tb_cd_cgc_prest_solic_conv_p(i),	
			cd_cpf_prest_solic_conv = tb_cd_cpf_prest_solic_conv_p(i),
			nr_seq_prest_solic_conv	= tb_nr_seq_prest_solic_conv_p(i),
			nr_seq_regra_prof_exec_conv = tb_regra_prof_exec_conv_p(i),	
			cd_profissional_exec_conv = tb_cd_prof_exec_conv_p(i),	
			nr_cons_prof_exec_conv = tb_nr_cons_prof_exec_conv_p(i),
			nr_seq_cons_prof_exec_conv = tb_nr_seq_cons_prof_exe_conv_p(i),
			cd_uf_cons_prof_exec_conv = tb_cd_uf_cons_prof_exec_conv_p(i),
			nr_seq_cbo_prof_exec_conv = tb_nr_cbo_prof_exec_conv_p(i),
			ie_carater_atendimento_conv = tb_ie_carater_atend_conv_p(i),
			nr_seq_regra_prof_solic_conv = tb_regra_prof_solic_conv_p(i),
			cd_profissional_solic_conv = tb_cd_prof_solic_conv_p(i),
			nr_cons_prof_solic_conv = tb_nr_cons_prof_solic_conv_p(i),
			cd_uf_cons_prof_solic_conv = tb_cd_uf_cons_prof_sol_conv_p(i),
			nr_seq_cons_prof_solic_conv = tb_nr_seq_cons_prof_sol_conv_p(i),
			nr_seq_cbo_prof_solic_conv = tb_nr_cbo_prof_solic_conv_p(i),	
			nr_seq_motivo_encerramento = tb_nr_seq_moti_ence_conv_p(i),
			nr_seq_guia_conv = tb_nr_seq_guia_conv_p(i),
			nr_seq_tipo_atend_conv = tb_nr_seq_tipo_atend_conv_p(i),
			cd_guia_ok_conv = tb_cd_guia_ok_conv_p(i),
			dt_atendimento_conv = coalesce(tb_dt_atendimento_conv_p(i),clock_timestamp()),
			ie_tipo_atend_odonto_conv = tb_ie_tipo_atend_odonto_conv_p(i),
			ie_tipo_internacao_conv	= tb_ie_tipo_internacao_conv_p(i),
			ie_tipo_internado_conv = tb_ie_tipo_internado_conv_p(i),
			ie_vinc_internacao_conv = tb_ie_vinc_internacao_conv_p(i),	
			cd_convenio_conv = tb_cd_convenio_conv_p(i),
			cd_categoria_conv = tb_cd_categoria_conv_p(i),
			ie_sexo_conv = tb_ie_sexo_conv_p(i),
			qt_idade_conta_meses_conv = tb_qt_idade_conta_meses_conv_p(i),
			qt_idade_conta_anos_conv = tb_qt_idade_conta_anos_conv_p(i),
			cd_profissional_coop_exec_conv = tb_cd_prof_coop_exec_conv_p(i),
			cd_prof_coop_solic_conv = tb_cd_prof_coop_solic_conv_p(i),	
			sg_estado_operadora_conv = tb_sg_estado_operadora_conv_p(i),
			ie_tipo_inter_oper_conv = tb_ie_tipo_inter_oper_conv_p(i),
			cd_estabelecimento = cd_estabelecimento_p,
			dt_atualizacao = clock_timestamp(),
			nm_usuario = nm_usuario_p,
			ie_tipo_faturamento = tb_tipo_faturamento_p(i),
			cd_cns	= tb_cd_cnes_p(i)
		where	nr_sequencia = tb_nr_seq_conta_conv_p(i);
	commit;
end if;

-- reinicializa as vari_veis

tb_cd_usuario_plano_conv_p.delete;
tb_cd_guia_operadora_conv_p.delete;
tb_cd_guia_principal_conv_p.delete;
tb_cd_cooperativa_cart_conv_p.delete;
tb_cd_coop_cart_number_conv_p.delete;
tb_nr_seq_congen_cart_conv_p.delete;
tb_nr_seq_segurado_conv_p.delete;
tb_nr_seq_congenere_conv_p.delete;
tb_cd_prest_exec_conv_p.delete;	
tb_cd_prest_exec_upper_conv_p.delete;
tb_cd_prest_exec_number_conv_p.delete;
tb_cd_cgc_prest_exec_conv_p.delete;
tb_cd_cpf_prest_exec_conv_p.delete;
tb_nr_seq_prest_exec_conv_p.delete;
tb_cd_prest_solic_conv_p.delete;	
tb_cd_prest_solic_upper_conv_p.delete;
tb_cd_prest_solic_num_conv_p.delete;
tb_cd_cgc_prest_solic_conv_p.delete;
tb_cd_cpf_prest_solic_conv_p.delete;
tb_nr_seq_prest_solic_conv_p.delete;
tb_regra_prof_exec_conv_p.delete;	
tb_cd_prof_exec_conv_p.delete;	
tb_nr_cons_prof_exec_conv_p.delete;
tb_nr_seq_cons_prof_exe_conv_p.delete;
tb_cd_uf_cons_prof_exec_conv_p.delete;
tb_nr_cbo_prof_exec_conv_p.delete;
tb_ie_carater_atend_conv_p.delete;
tb_regra_prof_solic_conv_p.delete;
tb_cd_prof_solic_conv_p.delete;
tb_nr_cbo_prof_solic_conv_p.delete;
tb_nr_cons_prof_solic_conv_p.delete;
tb_nr_seq_cons_prof_sol_conv_p.delete;
tb_cd_uf_cons_prof_sol_conv_p.delete;
tb_nr_seq_moti_ence_conv_p.delete;
tb_nr_seq_guia_conv_p.delete;
tb_nr_seq_tipo_atend_conv_p.delete;
tb_cd_guia_ok_conv_p.delete;
tb_dt_atendimento_conv_p.delete;
tb_ie_tipo_atend_odonto_conv_p.delete;
tb_ie_tipo_internacao_conv_p.delete;
tb_ie_tipo_internado_conv_p.delete;
tb_ie_vinc_internacao_conv_p.delete;
tb_cd_convenio_conv_p.delete;
tb_cd_categoria_conv_p.delete;
tb_ie_sexo_conv_p.delete;
tb_qt_idade_conta_meses_conv_p.delete;
tb_qt_idade_conta_anos_conv_p.delete;
tb_cd_prof_coop_exec_conv_p.delete;
tb_cd_prof_coop_solic_conv_p.delete;
tb_sg_estado_operadora_conv_p.delete;
tb_ie_tipo_inter_oper_conv_p.delete;
tb_tipo_faturamento_p.delete;	
tb_cd_cnes_p.delete;		

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_conv_xml_cta_pck.atualiza_conv_conta ( tb_nr_seq_conta_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_usuario_plano_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_guia_operadora_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_guia_principal_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_cooperativa_cart_conv_p INOUT pls_util_cta_pck.t_varchar2_table_10, tb_cd_coop_cart_number_conv_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_congen_cart_conv_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_segurado_conv_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_congenere_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_prest_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_prest_exec_upper_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_prest_exec_number_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_cgc_prest_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_cpf_prest_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_nr_seq_prest_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_prest_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_prest_solic_upper_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_prest_solic_num_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_cgc_prest_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_cd_cpf_prest_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_nr_seq_prest_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_regra_prof_exec_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_prof_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_nr_cons_prof_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_nr_seq_cons_prof_exe_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_uf_cons_prof_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_10, tb_nr_cbo_prof_exec_conv_p INOUT pls_util_cta_pck.t_number_table, tb_ie_carater_atend_conv_p INOUT pls_util_cta_pck.t_varchar2_table_10, tb_regra_prof_solic_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_prof_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_nr_cbo_prof_solic_conv_p INOUT pls_util_cta_pck.t_number_table, tb_nr_cons_prof_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_nr_seq_cons_prof_sol_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_uf_cons_prof_sol_conv_p INOUT pls_util_cta_pck.t_varchar2_table_10, tb_nr_seq_moti_ence_conv_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_guia_conv_p INOUT pls_util_cta_pck.t_number_table, tb_nr_seq_tipo_atend_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_guia_ok_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_dt_atendimento_conv_p INOUT pls_util_cta_pck.t_date_table, tb_ie_tipo_atend_odonto_conv_p INOUT pls_util_cta_pck.t_varchar2_table_20, tb_ie_tipo_internacao_conv_p INOUT pls_util_cta_pck.t_number_table, tb_ie_tipo_internado_conv_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_ie_vinc_internacao_conv_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_cd_convenio_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_categoria_conv_p INOUT pls_util_cta_pck.t_number_table, tb_ie_sexo_conv_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_qt_idade_conta_meses_conv_p INOUT pls_util_cta_pck.t_number_table, tb_qt_idade_conta_anos_conv_p INOUT pls_util_cta_pck.t_number_table, tb_cd_prof_coop_exec_conv_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_cd_prof_coop_solic_conv_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_sg_estado_operadora_conv_p INOUT pls_util_cta_pck.t_varchar2_table_2, tb_ie_tipo_inter_oper_conv_p INOUT pls_util_cta_pck.t_varchar2_table_10, tb_tipo_faturamento_p INOUT pls_util_cta_pck.t_varchar2_table_1, tb_cd_cnes_p INOUT pls_util_cta_pck.t_varchar2_table_20, cd_estabelecimento_p estabelecimento.cd_estabelecimento%type, nm_usuario_p usuario.nm_usuario%type) FROM PUBLIC;
