-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION wheb_inconsistencia.analisar_ajuste_manual (integridade_referencial_p INTEGRIDADE_REFERENCIAL) RETURNS varchar AS $body$
DECLARE

    tasy_config_inconsistencia_w TASY_CONFIG_INCONSISTENCIA%rowtype;

BEGIN
    tasy_config_inconsistencia_w := wheb_inconsistencia.get_config_auto(integridade_referencial_p);

    -- DUPLICATES
    IF WHEB_DB.HAS_DUPLICATES(integridade_referencial_p) THEN
      RETURN current_setting('wheb_inconsistencia.an_manual_duplicates')::varchar(255);
    ELSE
      -- ACOMPANHAMENTO DO DBA
      IF wheb_inconsistencia.is_acompanhamento_dba(tasy_config_inconsistencia_w) THEN
        RETURN current_setting('wheb_inconsistencia.an_manual_acompanhamento_dba')::varchar(255);
      ELSE
        -- AJUSTA AUTOMATICAMENTE
        IF wheb_inconsistencia.is_ajusta_automaticamente(tasy_config_inconsistencia_w) THEN
          RETURN current_setting('wheb_inconsistencia.an_auto_recriar_integridade')::varchar(255);
        END IF;
      END IF;
    END IF;

    RETURN current_setting('wheb_inconsistencia.an_manual')::varchar(255);
  END;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION wheb_inconsistencia.analisar_ajuste_manual (integridade_referencial_p INTEGRIDADE_REFERENCIAL) FROM PUBLIC;
