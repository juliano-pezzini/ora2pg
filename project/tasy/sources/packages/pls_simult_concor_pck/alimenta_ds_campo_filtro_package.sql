-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_simult_concor_pck.alimenta_ds_campo_filtro ( dados_regra_ocor_p pls_tipos_ocor_pck.dados_regra, ie_tipo_importacao_p text) AS $body$
BEGIN

--ie_tipo_importacao_p = A - Antiga ou N - Nova. Para importacao nova, os campos na view tem mesma nomenclatura utilizada pelos campos "quentes" das tabelas
if (ie_tipo_importacao_p = 'A') then
	-- dependendo do evento, muda o campo de onde o dado vem
	if (dados_regra_ocor_p.ie_evento = 'IMP') then
		PERFORM set_config('pls_simult_concor_pck.ds_campo_dt_proc_g', 'dt_procedimento_imp', false);
		PERFORM set_config('pls_simult_concor_pck.ds_campo_dt_mat_g', 'dt_atendimento_imp', false);
		PERFORM set_config('pls_simult_concor_pck.ds_campo_guia_g', 'cd_guia_imp', false);
		PERFORM set_config('pls_simult_concor_pck.ds_campo_proced_g', 'cd_procedimento_imp', false);
	else
		PERFORM set_config('pls_simult_concor_pck.ds_campo_dt_proc_g', 'dt_procedimento', false);
		PERFORM set_config('pls_simult_concor_pck.ds_campo_dt_mat_g', 'dt_atendimento', false);
		PERFORM set_config('pls_simult_concor_pck.ds_campo_guia_g', 'cd_guia_referencia', false);
		PERFORM set_config('pls_simult_concor_pck.ds_campo_proced_g', 'cd_procedimento', false);
	end if;
else

	PERFORM set_config('pls_simult_concor_pck.ds_campo_dt_proc_g', 'dt_procedimento', false);
	PERFORM set_config('pls_simult_concor_pck.ds_campo_dt_mat_g', 'dt_atendimento', false);
	PERFORM set_config('pls_simult_concor_pck.ds_campo_guia_g', 'cd_guia_referencia', false);
	PERFORM set_config('pls_simult_concor_pck.ds_campo_proced_g', 'cd_procedimento', false);

end if;
	
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_simult_concor_pck.alimenta_ds_campo_filtro ( dados_regra_ocor_p pls_tipos_ocor_pck.dados_regra, ie_tipo_importacao_p text) FROM PUBLIC;
