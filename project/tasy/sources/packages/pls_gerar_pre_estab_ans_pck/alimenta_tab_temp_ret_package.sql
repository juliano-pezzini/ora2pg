-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';


-- Rotina responsável por alimentar a tabela temporária com as partes do arquivo XML
CREATE OR REPLACE PROCEDURE pls_gerar_pre_estab_ans_pck.alimenta_tab_temp_ret ( ds_xml_p text, ie_opcao_p text, nr_seq_xml_ret_p INOUT w_pls_monitor_ans_ret.nr_sequencia%type) AS $body$
BEGIN
-- Caso esteja inserindo ou atualizando
if (ie_opcao_p = 'I') then

	insert	into	w_pls_monitor_ans_ret(	ds_xml, nr_sequencia)
	values (	ds_xml_p, nextval('w_pls_monitor_ans_ret_seq'))
	returning	nr_sequencia into nr_seq_xml_ret_p;

elsif (ie_opcao_p = 'U') then

	update	w_pls_monitor_ans_ret
	set	ds_xml = ds_xml || ds_xml_p
	where	nr_sequencia = nr_seq_xml_ret_p;

end if;

commit;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_gerar_pre_estab_ans_pck.alimenta_tab_temp_ret ( ds_xml_p text, ie_opcao_p text, nr_seq_xml_ret_p INOUT w_pls_monitor_ans_ret.nr_sequencia%type) FROM PUBLIC;
