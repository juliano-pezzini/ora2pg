-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pfcs_pck_discharge_manager.calc_big_numbers ( cd_establishment_p bigint, nm_user_p text) AS $body$
DECLARE

        pfcs_panel_seq_w pfcs_panel.nr_sequencia%type;

BEGIN
        -- Antecipated Discharges Today
         := pfcs_pck.pfcs_generate_results(
            vl_indicator_p => pfcs_pck_discharge_manager.get_anticipated_discharges(cd_establishment_p, null, null, trunc(clock_timestamp()), null, PFCS_PCK_CONSTANTS.IE_YES_BR), nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_ANTECIPATED_TODAY, nr_seq_operational_level_p => cd_establishment_p, nm_usuario_p => nm_user_p, nr_seq_panel_p => pfcs_panel_seq_w);
        CALL pfcs_pck.pfcs_activate_records(
            nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_ANTECIPATED_TODAY,
            nr_seq_operational_level_p => cd_establishment_p,
            nm_usuario_p => nm_user_p);

         -- Antecipated Discharges Tomorrow
         := pfcs_pck.pfcs_generate_results(
            vl_indicator_p => pfcs_pck_discharge_manager.get_anticipated_discharges(cd_establishment_p, null, null, trunc(clock_timestamp() + interval '1 days'), null, PFCS_PCK_CONSTANTS.IE_YES_BR), nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_ANTECIPATED_TOMORROW, nr_seq_operational_level_p => cd_establishment_p, nm_usuario_p => nm_user_p, nr_seq_panel_p => pfcs_panel_seq_w);
        CALL pfcs_pck.pfcs_activate_records(
            nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_ANTECIPATED_TOMORROW,
            nr_seq_operational_level_p => cd_establishment_p,
            nm_usuario_p => nm_user_p);

        -- Discharge Orders
         := pfcs_pck.pfcs_generate_results(
            vl_indicator_p => pfcs_pck_discharge_manager.get_discharge_orders(cd_establishment_p, null, null, null, null, null), nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_DISCHARGE_ORDERS, nr_seq_operational_level_p => cd_establishment_p, nm_usuario_p => nm_user_p, nr_seq_panel_p => pfcs_panel_seq_w);
        CALL pfcs_pck.pfcs_activate_records(
            nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_DISCHARGE_ORDERS,
            nr_seq_operational_level_p => cd_establishment_p,
            nm_usuario_p => nm_user_p);

        -- Discharge Orders Delays
         := pfcs_pck.pfcs_generate_results(
            vl_indicator_p => pfcs_pck_census.get_discharge_orders(cd_establishment_p, null, null, null, null, PFCS_PCK_CONSTANTS.IE_YES), nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_DISCHARGE_DELAYS, nr_seq_operational_level_p => cd_establishment_p, nm_usuario_p => nm_user_p, nr_seq_panel_p => pfcs_panel_seq_w);
        CALL pfcs_pck.pfcs_activate_records(
            nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_DISCHARGE_DELAYS,
            nr_seq_operational_level_p => cd_establishment_p,
            nm_usuario_p => nm_user_p);

       -- Care Status Delays
         := pfcs_pck.pfcs_generate_results(
            vl_indicator_p => pfcs_pck_census.get_care_status(cd_establishment_p, null, null, null, PFCS_PCK_CONSTANTS.IE_YES), nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_CARE_STATUS_DELAYS, nr_seq_operational_level_p => cd_establishment_p, nm_usuario_p => nm_user_p, nr_seq_panel_p => pfcs_panel_seq_w);
        CALL pfcs_pck.pfcs_activate_records(
            nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_CARE_STATUS_DELAYS,
            nr_seq_operational_level_p => cd_establishment_p,
            nm_usuario_p => nm_user_p);

        -- Avg LOS
         := pfcs_pck.pfcs_generate_results(
            vl_indicator_p => null, vl_indicator_dec_p => pfcs_pck_los.get_avg_los(cd_establishment_p), nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_AVG_LOS, nr_seq_operational_level_p => cd_establishment_p, nm_usuario_p => nm_user_p, nr_seq_panel_p => pfcs_panel_seq_w);
        CALL pfcs_pck.pfcs_activate_records(
            nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_AVG_LOS,
            nr_seq_operational_level_p => cd_establishment_p,
            nm_usuario_p => nm_user_p);

        -- Avg LOS Index
         := pfcs_pck.pfcs_generate_results(
            vl_indicator_p => null, vl_indicator_dec_p => pfcs_pck_los.get_avg_los_index(cd_establishment_p), nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_AVG_LOS_INDEX, nr_seq_operational_level_p => cd_establishment_p, nm_usuario_p => nm_user_p, nr_seq_panel_p => pfcs_panel_seq_w);
        CALL pfcs_pck.pfcs_activate_records(
            nr_seq_indicator_p => PFCS_PCK_INDICATORS.NR_AVG_LOS_INDEX,
            nr_seq_operational_level_p => cd_establishment_p,
            nm_usuario_p => nm_user_p);
    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pfcs_pck_discharge_manager.calc_big_numbers ( cd_establishment_p bigint, nm_user_p text) FROM PUBLIC;
