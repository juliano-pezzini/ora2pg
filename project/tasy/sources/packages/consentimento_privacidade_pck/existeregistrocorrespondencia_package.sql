-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION consentimento_privacidade_pck.existeregistrocorrespondencia ( cd_pessoa_fisica_p pessoa_fisica_privacidade.cd_pessoa_fisica%type, ie_tipo_corresp_p pessoa_fisica_corresp.ie_tipo_corresp%type) RETURNS boolean AS $body$
DECLARE

        tem_registro_tipo_q_w   varchar(1);
        retorno_w       		boolean;

BEGIN
            retorno_w := FALSE;

            select  CASE WHEN coalesce(max(nr_sequencia)::text, '') = '' THEN  'N'  ELSE 'S' END  AS tem_registro_tipo_q
            into STRICT    tem_registro_tipo_q_w
            from    pessoa_fisica_corresp
            where   cd_pessoa_fisica = cd_pessoa_fisica_p
            and 	ie_tipo_corresp = ie_tipo_corresp_p
            and 	ie_tipo_doc = 'Q';

            if (tem_registro_tipo_q_w = 'S') then
                retorno_w := TRUE;
            end if;

            return retorno_w;
        END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION consentimento_privacidade_pck.existeregistrocorrespondencia ( cd_pessoa_fisica_p pessoa_fisica_privacidade.cd_pessoa_fisica%type, ie_tipo_corresp_p pessoa_fisica_corresp.ie_tipo_corresp%type) FROM PUBLIC;
