-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';


	/*---------------------------------------------------------------------------------------------------------------------------------------------
	|			CARREGAR_DADOS_AGENDA				|
	*/
	/* Carrega os dados do agendamento para o tipo de dado atraves da sequencia do mesmo */

CREATE OR REPLACE PROCEDURE mprev_agenda_pck.carregar_dados_agenda (nr_seq_agendamento_p bigint, dados_agendamento_p INOUT dados_agendamento) AS $body$
DECLARE


	dados_agendamento_w	dados_agendamento	:= null;

	c01 CURSOR(nr_seq_agendamento_pc	bigint) FOR
		SELECT	a.*
		from	mprev_agendamento a
		where	a.nr_sequencia = nr_seq_agendamento_pc;
	
BEGIN

	for	r_C01_w in C01(nr_seq_agendamento_p) loop
		dados_agendamento_w.nr_sequencia 		:= r_C01_w.nr_sequencia;
		dados_agendamento_w.nr_seq_participante		:= r_C01_w.nr_seq_participante;
		dados_agendamento_w.cd_agenda 			:= r_C01_w.cd_agenda;
		dados_agendamento_w.nr_seq_turma 		:= r_C01_w.nr_seq_turma;
		dados_agendamento_w.nr_seq_horario_turma	:= r_C01_w.nr_seq_horario_turma;
		dados_agendamento_w.ds_utilizacao 		:= r_C01_w.ds_utilizacao;
		dados_agendamento_w.cd_agenda_profissional	:= r_C01_w.cd_agenda_profissional;
		dados_agendamento_w.cd_agenda_local		:= r_C01_w.cd_agenda_local;
		dados_agendamento_w.dt_agendamento		:= r_C01_w.dt_agenda;
		dados_agendamento_w.dt_final_agendamento	:= r_C01_w.dt_agenda + r_C01_w.nr_minuto_duracao/1440;
		dados_agendamento_w.nr_minutos 			:= r_C01_w.nr_minuto_duracao;
		dados_agendamento_w.ds_observacao 		:= r_C01_w.ds_observacao;
		dados_agendamento_w.nr_seq_partic_ciclo_item	:= r_c01_w.nr_seq_partic_ciclo_item;
		dados_agendamento_w.nr_seq_agendamento_ref	:= r_c01_w.nr_seq_agendamento_ref;
		dados_agendamento_w.nr_seq_captacao		:= r_c01_w.nr_seq_captacao;
		dados_agendamento_w.ie_previsto			:= r_c01_w.ie_previsto;
		dados_agendamento_w.ie_forma_atendimento	:= r_c01_w.ie_forma_atendimento;
		dados_agendamento_w.nr_seq_ativ_extra		:= r_c01_w.nr_seq_ativ_extra;
		dados_agendamento_w.ie_tipo_agendamento		:= r_c01_w.ie_tipo_agendamento;
		dados_agendamento_w.ie_tipo_atendimento		:= r_c01_w.ie_tipo_atendimento;
		dados_agendamento_w.nr_seq_grupo_tema		:= r_c01_w.nr_seq_grupo_tema;
		dados_agendamento_w.nr_seq_local_atend		:= r_c01_w.nr_seq_local_atend;
		dados_agendamento_w.nr_seq_forma_atend		:= r_c01_w.nr_seq_forma_atend;
		dados_agendamento_w.nr_seq_status_pac		:= r_c01_w.nr_seq_status_pac;
	end loop;
	dados_agendamento_p	:= dados_agendamento_w;
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE mprev_agenda_pck.carregar_dados_agenda (nr_seq_agendamento_p bigint, dados_agendamento_p INOUT dados_agendamento) FROM PUBLIC;
