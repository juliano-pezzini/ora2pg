-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION hdm_indic_pck.get_bill_type (nr_seq_bill_p bigint, si_tab_type_p text, si_character_hospit_p text) RETURNS bigint AS $body$
DECLARE

	qt_proc_first_aid_bill_w		varchar(10);
	si_bill_type_w			varchar(1);
	nr_seq_bill_type_w		bigint;
	c_bill_type CURSOR FOR
		SELECT	nr_sequencia
		from	hdm_indic_dm_bill_type
		where	si_type = si_bill_type_w;
	
BEGIN
		if (si_tab_type_p = '5') then
			si_bill_type_w := 'I';
		elsif (si_tab_type_p = '4' and si_character_hospit_p = 'U') then
			si_bill_type_w := 'U';
		elsif (si_tab_type_p = '3') then
			select	count(1)
			into STRICT	qt_proc_first_aid_bill_w
			from	pls_conta_proc
			where	ie_origem_proced in (5,8)
			and	cd_procedimento = 10101039
			and	nr_seq_conta = nr_seq_bill_p;
			
			if (qt_proc_first_aid_bill_w > 0)  then
				si_bill_type_w := 'U';
			end if;
		end if;
		
		for	r_c_bill_type in c_bill_type loop
			nr_seq_bill_type_w := r_c_bill_type.nr_sequencia;
		end loop;
	
		return coalesce(nr_seq_bill_type_w,0);
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION hdm_indic_pck.get_bill_type (nr_seq_bill_p bigint, si_tab_type_p text, si_character_hospit_p text) FROM PUBLIC;
