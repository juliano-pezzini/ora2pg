-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pfcs_telemetry_config_pck.get_average_waiting_time ( cd_establishment_p bigint, cd_department_p text) RETURNS bigint AS $body$
DECLARE

		qt_waiting_time_w			bigint := 0;
		qt_total_records_w			bigint := 0;
	
BEGIN
		for c01_w in current_setting('pfcs_telemetry_config_pck.cursor_average_waiting_time')::CURSOR(cd_establishment_p(cd_establishment_p, cd_department_p)  loop
			qt_total_records_w := qt_total_records_w + 1;
			qt_waiting_time_w := qt_waiting_time_w + c01_w.qt_waiting_time;
		end loop;

		return round(dividir_sem_round(qt_waiting_time_w, qt_total_records_w));
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pfcs_telemetry_config_pck.get_average_waiting_time ( cd_establishment_p bigint, cd_department_p text) FROM PUBLIC;
