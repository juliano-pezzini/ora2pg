-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pfcs_telemetry_config_pck.get_discharge_orders (cd_establishment_p bigint, nr_seq_encounter_p bigint) RETURNS varchar AS $body$
DECLARE

		ie_discharge_written_w				varchar(1) := 'N';
	
BEGIN
		select  coalesce(max('S'), 'N')
		  into STRICT	ie_discharge_written_w
		  FROM pfcs_detail_device pdd, pfcs_detail_bed pdb, pfcs_panel_detail ppd
LEFT OUTER JOIN pfcs_detail_patient pdp ON (ppd.nr_sequencia = pdp.nr_seq_detail)
WHERE ppd.nr_seq_indicator = 50  and ppd.nr_sequencia = pdb.nr_seq_detail and ppd.nr_sequencia = pdd.nr_seq_detail and pdp.nr_seq_encounter = nr_seq_encounter_p and ppd.nr_seq_operational_level =  cd_establishment_p and ppd.ie_situation = pfcs_pck_constants.IE_ACTIVE;

		return ie_discharge_written_w;
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pfcs_telemetry_config_pck.get_discharge_orders (cd_establishment_p bigint, nr_seq_encounter_p bigint) FROM PUBLIC;
