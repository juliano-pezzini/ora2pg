-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION sla_dashboard_pck.obter_regra_alldef ( nr_seq_regra_p man_sla_regra.nr_sequencia%type, ie_classificacao_p man_sla_regra.ie_classificacao%type, ie_prioridade_p man_sla_regra.ie_prioridade%type ) RETURNS bigint AS $body$
DECLARE


nr_seq_regra_sla_w	man_sla_regra.nr_sequencia%type;


BEGIN

select	max(b.nr_sequencia)
into STRICT	nr_seq_regra_sla_w
FROM man_sla_regra b, man_sla a
LEFT OUTER JOIN man_sla_loc c ON (a.nr_sequencia = c.nr_seq_sla)
WHERE a.nr_sequencia					= b.nr_seq_sla  and a.dt_vigencia					<= clock_timestamp() and coalesce(a.nr_sequencia, coalesce(nr_seq_regra_p,0))	= coalesce(nr_seq_regra_p,0) and b.ie_classificacao					= ie_classificacao_p and coalesce(ie_prioridade,ie_prioridade_p)			= ie_prioridade_p order by	coalesce(ie_prioridade,' '),
	b.nr_seq_sla;

return nr_seq_regra_sla_w;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION sla_dashboard_pck.obter_regra_alldef ( nr_seq_regra_p man_sla_regra.nr_sequencia%type, ie_classificacao_p man_sla_regra.ie_classificacao%type, ie_prioridade_p man_sla_regra.ie_prioridade%type ) FROM PUBLIC;
