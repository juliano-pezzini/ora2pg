-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE ptu_moviment_benef_a1300_pck.gravar_log_inco ( nr_seq_lote_p bigint) AS $body$
BEGIN
	
	forall i in current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.nr_seq_mov_empresa.first .. current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.nr_seq_mov_empresa.last
		insert into ptu_mov_benef_log_inco(	nr_sequencia,dt_atualizacao,nm_usuario,dt_atualizacao_nrec,nm_usuario_nrec,
				nr_seq_mov_empresa,nr_seq_contrato,nr_seq_mov_segurado,
				cd_pessoa_fisica,nr_seq_segurado,ds_inconsistencia,
				nr_seq_lote)
		values (	nextval('ptu_mov_benef_log_inco_seq'),clock_timestamp(),get_nm_usuario,clock_timestamp(),get_nm_usuario,
				current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.nr_seq_mov_empresa(i),current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.nr_seq_contrato(i),current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.nr_seq_mov_segurado(i),
				current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.cd_pessoa_fisica(i),current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.nr_seq_segurado(i),current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.ds_inconsistencia(i),
				nr_seq_lote_p);
	
	current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.nr_seq_mov_empresa.delete;
	current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.nr_seq_contrato.delete;
	current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.nr_seq_mov_segurado.delete;
	current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.cd_pessoa_fisica.delete;
	current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.nr_seq_segurado.delete;
	current_setting('ptu_moviment_benef_a1300_pck.log_inconsistencias_w')::log_inconsistencias_record.ds_inconsistencia.delete;
	
	end;
	

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ptu_moviment_benef_a1300_pck.gravar_log_inco ( nr_seq_lote_p bigint) FROM PUBLIC;
