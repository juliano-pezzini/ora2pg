-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION ptu_moviment_benef_a1300_pck.obter_ptu_mov_benef_empresa ( nr_seq_contrato_p pls_contrato.nr_sequencia%type) RETURNS bigint AS $body$
DECLARE

	
	nr_seq_ptu_mov_benef_emp_w	ptu_mov_benef_empresa.nr_sequencia%type;
	cd_cgc_estipulante_w		pls_contrato.cd_cgc_estipulante%type;
	cd_pf_estipulante_w		pls_contrato.cd_pf_estipulante%type;
	
	
BEGIN
	
	nr_seq_ptu_mov_benef_emp_w	:= null;
	
	if (nr_seq_contrato_p IS NOT NULL AND nr_seq_contrato_p::text <> '') then
		select	cd_cgc_estipulante,
			cd_pf_estipulante
		into STRICT	cd_cgc_estipulante_w,
			cd_pf_estipulante_w
		from	pls_contrato
		where	nr_sequencia = nr_seq_contrato_p;
		
		if (cd_cgc_estipulante_w IS NOT NULL AND cd_cgc_estipulante_w::text <> '') then
			select	max(nr_sequencia)
			into STRICT	nr_seq_ptu_mov_benef_emp_w
			from	ptu_mov_benef_empresa
			where	cd_cgc_cpf = cd_cgc_estipulante_w;
		elsif (cd_pf_estipulante_w IS NOT NULL AND cd_pf_estipulante_w::text <> '') then
			select	max(nr_sequencia)
			into STRICT	nr_seq_ptu_mov_benef_emp_w
			from	ptu_mov_benef_empresa
			where	cd_cgc_cpf = cd_pf_estipulante_w;
		end if;
	end if;

	return	nr_seq_ptu_mov_benef_emp_w;
	
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION ptu_moviment_benef_a1300_pck.obter_ptu_mov_benef_empresa ( nr_seq_contrato_p pls_contrato.nr_sequencia%type) FROM PUBLIC;
