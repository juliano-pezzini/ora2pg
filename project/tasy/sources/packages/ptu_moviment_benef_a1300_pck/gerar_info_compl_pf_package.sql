-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';


CREATE TYPE compl_pessoa_fisica_record AS (	nr_seq_mov_benef_pf	dbms_sql.number_table,
							cd_pessoa_fisica	dbms_sql.varchar2_table,
							tp_endereco		dbms_sql.varchar2_table,
							ds_endereco		dbms_sql.varchar2_table,
							nr_endereco		dbms_sql.varchar2_table,
							ds_compl_endereco	dbms_sql.varchar2_table,
							ds_bairro		dbms_sql.varchar2_table,
							ds_cidade		dbms_sql.varchar2_table,
							cd_municipio_ibge	dbms_sql.varchar2_table,
							nr_cep			dbms_sql.varchar2_table,
							sg_uf			dbms_sql.varchar2_table,
							nr_ddd			dbms_sql.varchar2_table,
							nr_ramal		dbms_sql.varchar2_table,
							ds_email		dbms_sql.varchar2_table,
							nr_telefone		dbms_sql.varchar2_table,
							nr_ddd_2		dbms_sql.varchar2_table,
							nr_ramal_2		dbms_sql.varchar2_table,
							ds_email_2		dbms_sql.varchar2_table,
							nr_telefone_2		dbms_sql.varchar2_table,
							nr_ddd_3		dbms_sql.varchar2_table,
							nr_ramal_3		dbms_sql.varchar2_table,
							ds_email_3		dbms_sql.varchar2_table,
							nr_telefone_3		dbms_sql.varchar2_table,
							tp_logradouro		dbms_sql.varchar2_table,
							ie_tipo_email		dbms_sql.varchar2_table,
							ie_tipo_telefone	dbms_sql.varchar2_table);


CREATE OR REPLACE PROCEDURE ptu_moviment_benef_a1300_pck.gerar_info_compl_pf ( pessoa_fisica_w pessoa_fisica_w_record, nr_seq_mov_empresa_p bigint, nr_seq_contrato_p bigint) AS $body$
DECLARE

	
	compl_pessoa_fisica_w		compl_pessoa_fisica_record;
	qt_endereco_residencial_w	bigint;
	ie_tipo_endereco_w		bigint;
	cd_tipo_logradouro_w		compl_pessoa_fisica.cd_tipo_logradouro%type;
	qt_registros_w			smallint := 0;
	ptu_intercambio_seq_w		ptu_intercambio_empresa.nr_sequencia%type := 0;
	ptu_mov_benef_empresa_seq_w	ptu_mov_benef_empresa.nr_sequencia%type := 0;
	
	
BEGIN	
	
	if (pessoa_fisica_w.nm_pessoa_fisica.count > 0) then
		for i in pessoa_fisica_w.nm_pessoa_fisica.first ..pessoa_fisica_w.nm_pessoa_fisica.count loop
			
			select	count(1)
			into STRICT	qt_registros_w
			from	compl_pessoa_fisica
			where	cd_pessoa_fisica	= pessoa_fisica_w.cd_pessoa_fisica(i)
			and	ie_tipo_complemento	= 1
			and	(cd_municipio_ibge IS NOT NULL AND cd_municipio_ibge::text <> '');
			
			ptu_mov_benef_empresa_seq_w	:= ptu_moviment_benef_a1300_pck.obter_ptu_mov_benef_empresa(nr_seq_contrato_p);
			
			if (qt_registros_w > 0) then
				select	count(1)
				into STRICT	qt_endereco_residencial_w
				from	compl_pessoa_fisica
				where	cd_pessoa_fisica	= pessoa_fisica_w.cd_pessoa_fisica(i)
				and	ie_tipo_complemento	= 1
				and	(ds_endereco IS NOT NULL AND ds_endereco::text <> '')  LIMIT 1;
				
				if (qt_endereco_residencial_w > 0) then
					ie_tipo_endereco_w	:= 1;
				else
					ie_tipo_endereco_w	:= 2;
				end if;
				
				compl_pessoa_fisica_w.nr_seq_mov_benef_pf(i)	:= pessoa_fisica_w.nr_seq_mov_benef_pf(i);
				compl_pessoa_fisica_w.tp_endereco(i)		:= to_char(ie_tipo_endereco_w);
				compl_pessoa_fisica_w.cd_pessoa_fisica(i)	:= pessoa_fisica_w.cd_pessoa_fisica(i);
				
				begin
				select	substr(ds_endereco,1,40),
					coalesce(to_char(coalesce(nr_endereco, ds_compl_end)),'S/N'),
					ds_complemento,
					substr(ds_bairro,1,30),
					cd_municipio_ibge,
					sg_estado,
					substr(somente_numero_char(cd_cep),1,8),
					cd_tipo_logradouro,
					substr(somente_numero_char(nr_ddd_telefone),1,4),
					substr(somente_numero_char(nr_telefone),1,8),
					substr(somente_numero_char(nr_ramal),1,4),
					ds_email,
					CASE WHEN coalesce(nr_telefone::text, '') = '' THEN  '0'  ELSE CASE WHEN ie_tipo_complemento=1 THEN  '1'  ELSE '2' END  END ,
					CASE WHEN coalesce(ds_email::text, '') = '' THEN  '0'  ELSE CASE WHEN ie_tipo_complemento=1 THEN  '1'  ELSE '2' END  END
				into STRICT	compl_pessoa_fisica_w.ds_endereco(i),
					compl_pessoa_fisica_w.nr_endereco(i),
					compl_pessoa_fisica_w.ds_compl_endereco(i),
					compl_pessoa_fisica_w.ds_bairro(i),
					compl_pessoa_fisica_w.cd_municipio_ibge(i),
					compl_pessoa_fisica_w.sg_uf(i),
					compl_pessoa_fisica_w.nr_cep(i),
					cd_tipo_logradouro_w,
					compl_pessoa_fisica_w.nr_ddd(i),
					compl_pessoa_fisica_w.nr_telefone(i),
					compl_pessoa_fisica_w.nr_ramal(i),
					compl_pessoa_fisica_w.ds_email(i),
					compl_pessoa_fisica_w.ie_tipo_telefone(i),
					compl_pessoa_fisica_w.ie_tipo_email(i)
				from	compl_pessoa_fisica
				where	cd_pessoa_fisica	= pessoa_fisica_w.cd_pessoa_fisica(i)
				and	ie_tipo_complemento	= ie_tipo_endereco_w  LIMIT 1;
				exception
				when others then
					compl_pessoa_fisica_w.ds_endereco(i)		:= '';
					compl_pessoa_fisica_w.nr_endereco(i)		:= '';
					compl_pessoa_fisica_w.ds_compl_endereco(i)	:= '';
					compl_pessoa_fisica_w.ds_bairro(i)		:= '';
					compl_pessoa_fisica_w.cd_municipio_ibge(i)	:= '';
					compl_pessoa_fisica_w.sg_uf(i)			:= '';
					compl_pessoa_fisica_w.nr_cep(i)			:= '';
					cd_tipo_logradouro_w				:= '';
					compl_pessoa_fisica_w.nr_ddd(i)			:= '';
					compl_pessoa_fisica_w.nr_telefone(i)		:= '';
					compl_pessoa_fisica_w.nr_ramal(i)		:= '';
					compl_pessoa_fisica_w.ds_email(i)		:= '';
					compl_pessoa_fisica_w.nr_ddd_2(i)		:= '';
					compl_pessoa_fisica_w.nr_telefone_2(i)		:= '';
					compl_pessoa_fisica_w.nr_ramal_2(i)		:= '';
					compl_pessoa_fisica_w.ds_email_2(i)		:= '';
					compl_pessoa_fisica_w.nr_ddd_3(i)		:= '';
					compl_pessoa_fisica_w.nr_telefone_3(i)		:= '';
					compl_pessoa_fisica_w.nr_ramal_3(i)		:= '';
					compl_pessoa_fisica_w.ds_email_3(i)		:= '';
					compl_pessoa_fisica_w.ie_tipo_telefone(i)	:= '';
					compl_pessoa_fisica_w.ie_tipo_email(i)		:= '';
				end;
				
				if (current_setting('ptu_moviment_benef_a1300_pck.nr_versao_transacao_w')::varchar(2) in ('09','10','11')) then
					begin
						select  substr(somente_numero_char(nr_ddd_telefone),1,4),
							substr(somente_numero_char(nr_telefone),1,8),
							substr(somente_numero_char(nr_ramal),1,4),
							substr(ds_email,1,50)
						into STRICT	compl_pessoa_fisica_w.nr_ddd_2(i),
							compl_pessoa_fisica_w.nr_telefone_2(i),
							compl_pessoa_fisica_w.nr_ramal_2(i),
							compl_pessoa_fisica_w.ds_email_2(i)
						from	compl_pessoa_fisica a
						where	cd_pessoa_fisica	= pessoa_fisica_w.cd_pessoa_fisica(i)
						and	a.ie_tipo_complemento	= 2;
					exception
					when others then
						compl_pessoa_fisica_w.nr_ddd_2(i)		:= '';
						compl_pessoa_fisica_w.nr_telefone_2(i)		:= '';
						compl_pessoa_fisica_w.nr_ramal_2(i)		:= '';
						compl_pessoa_fisica_w.ds_email_2(i)		:= '';
					end;
					
					compl_pessoa_fisica_w.nr_ddd_3(i)		:= '';
					compl_pessoa_fisica_w.nr_telefone_3(i)		:= '';
					compl_pessoa_fisica_w.nr_ramal_3(i)		:= '';
					compl_pessoa_fisica_w.ds_email_3(i)		:= '';
				else
					compl_pessoa_fisica_w.nr_ddd_2(i)		:= '';
					compl_pessoa_fisica_w.nr_telefone_2(i)		:= '';
					compl_pessoa_fisica_w.nr_ramal_2(i)		:= '';
					compl_pessoa_fisica_w.ds_email_2(i)		:= '';
					compl_pessoa_fisica_w.nr_ddd_3(i)		:= '';
					compl_pessoa_fisica_w.nr_telefone_3(i)		:= '';
					compl_pessoa_fisica_w.nr_ramal_3(i)		:= '';
					compl_pessoa_fisica_w.ds_email_3(i)		:= '';
				end if;
				
				if (cd_tipo_logradouro_w IS NOT NULL AND cd_tipo_logradouro_w::text <> '') then
					select	max(cd_ptu)
					into STRICT	compl_pessoa_fisica_w.tp_logradouro(i)
					from	ptu_tipo_logradouro
					where	cd_tipo_logradouro	= cd_tipo_logradouro_w;
				else
					compl_pessoa_fisica_w.tp_logradouro(i)	:= '34';
				end if;
				
				if (current_setting('ptu_moviment_benef_a1300_pck.cd_versao_ptu_w')::ptu_regra_interface.cd_versao_ptu%type = '7.0') then
					if (ie_tipo_endereco_w = 2) then -- 2 = Comercial
						select	cd_municipio_ibge
						into STRICT	compl_pessoa_fisica_w.cd_municipio_ibge(i)
						from	compl_pessoa_fisica
						where	cd_pessoa_fisica	= pessoa_fisica_w.cd_pessoa_fisica(i)
						and	ie_tipo_complemento	= 1;
					end if;
				end if;
				
				if ((compl_pessoa_fisica_w.cd_municipio_ibge(i) IS NOT NULL AND (compl_pessoa_fisica_w.cd_municipio_ibge(i))::text <> '')) then
					begin
					select	substr(ds_municipio,1,30)
					into STRICT	compl_pessoa_fisica_w.ds_cidade(i)
					from	sus_municipio
					where	cd_municipio_ibge	= compl_pessoa_fisica_w.cd_municipio_ibge(i);
					exception
					when others then
						compl_pessoa_fisica_w.ds_cidade(i)	:= '';
					end;
				else
					compl_pessoa_fisica_w.ds_cidade(i)	:= '';
				end if;
			elsif (qt_registros_w = 0) and (current_setting('ptu_moviment_benef_a1300_pck.ie_utilizar_ender_empresa_w')::varchar(30) = 'S') and (coalesce(ptu_mov_benef_empresa_seq_w,0) <> 0) and (nr_seq_contrato_p IS NOT NULL AND nr_seq_contrato_p::text <> '') then
				
				compl_pessoa_fisica_w.nr_seq_mov_benef_pf(i)	:= pessoa_fisica_w.nr_seq_mov_benef_pf(i);
				compl_pessoa_fisica_w.tp_endereco(i)		:= '2';
				compl_pessoa_fisica_w.cd_pessoa_fisica(i)	:= pessoa_fisica_w.cd_pessoa_fisica(i);
				
				begin
				select	substr(ds_razao_social,1,40),
					'',
					substr(somente_numero_char(cd_cep),1,8),
					substr(cd_municipio_ibge,1,7),
					substr(sg_uf,1,2),
					substr(ds_bairro,1,30),
					substr(somente_numero_char(nr_ddd),1,4),
					somente_numero(substr(nr_telefone,1,8)),
					ds_complemento,
					'',
					'',
					CASE WHEN coalesce(nr_telefone::text, '') = '' THEN  null  ELSE '2' END ,
					''
				into STRICT	compl_pessoa_fisica_w.ds_endereco(i),
					compl_pessoa_fisica_w.nr_endereco(i),
					compl_pessoa_fisica_w.nr_cep(i),
					compl_pessoa_fisica_w.cd_municipio_ibge(i),
					compl_pessoa_fisica_w.sg_uf(i),
					compl_pessoa_fisica_w.ds_bairro(i),
					compl_pessoa_fisica_w.nr_ddd(i),
					compl_pessoa_fisica_w.nr_telefone(i),
					compl_pessoa_fisica_w.ds_compl_endereco(i),
					compl_pessoa_fisica_w.ds_email(i),
					compl_pessoa_fisica_w.nr_ramal(i),
					compl_pessoa_fisica_w.ie_tipo_telefone(i),
					compl_pessoa_fisica_w.ie_tipo_email(i)
				from	ptu_mov_benef_empresa
				where	nr_sequencia	= ptu_mov_benef_empresa_seq_w  LIMIT 1;
				exception
				when others then
					compl_pessoa_fisica_w.ds_endereco(i)		:= '';
					compl_pessoa_fisica_w.nr_endereco(i)		:= '';
					compl_pessoa_fisica_w.nr_cep(i)			:= '';
					compl_pessoa_fisica_w.cd_municipio_ibge(i)	:= '';
					compl_pessoa_fisica_w.sg_uf(i)			:= '';
					compl_pessoa_fisica_w.ds_bairro(i)		:= '';
					compl_pessoa_fisica_w.nr_ddd(i)			:= '';
					compl_pessoa_fisica_w.nr_telefone(i)		:= '';
					compl_pessoa_fisica_w.ds_compl_endereco(i)	:= '';
					compl_pessoa_fisica_w.ds_email(i)		:= '';
					compl_pessoa_fisica_w.nr_ramal(i)		:= '';
					compl_pessoa_fisica_w.nr_ddd_2(i)		:= '';
					compl_pessoa_fisica_w.nr_telefone_2(i)		:= '';
					compl_pessoa_fisica_w.nr_ramal_2(i)		:= '';
					compl_pessoa_fisica_w.ds_email_2(i)		:= '';
					compl_pessoa_fisica_w.nr_ddd_3(i)		:= '';
					compl_pessoa_fisica_w.nr_telefone_3(i)		:= '';
					compl_pessoa_fisica_w.nr_ramal_3(i)		:= '';
					compl_pessoa_fisica_w.ds_email_3(i)		:= '';
					compl_pessoa_fisica_w.ie_tipo_telefone(i)	:= '';
					compl_pessoa_fisica_w.ie_tipo_email(i)		:= '';
				end;
				compl_pessoa_fisica_w.nr_ddd_2(i)		:= '';
				compl_pessoa_fisica_w.nr_telefone_2(i)		:= '';
				compl_pessoa_fisica_w.nr_ramal_2(i)		:= '';
				compl_pessoa_fisica_w.ds_email_2(i)		:= '';
				compl_pessoa_fisica_w.nr_ddd_3(i)		:= '';
				compl_pessoa_fisica_w.nr_telefone_3(i)		:= '';
				compl_pessoa_fisica_w.nr_ramal_3(i)		:= '';
				compl_pessoa_fisica_w.ds_email_3(i)		:= '';
				compl_pessoa_fisica_w.tp_logradouro(i)		:= '34';
				
				if ((compl_pessoa_fisica_w.cd_municipio_ibge(i) IS NOT NULL AND (compl_pessoa_fisica_w.cd_municipio_ibge(i))::text <> '')) then
					begin
					select	substr(ds_municipio,1,30)
					into STRICT	compl_pessoa_fisica_w.ds_cidade(i)
					from	sus_municipio
					where	cd_municipio_ibge	= compl_pessoa_fisica_w.cd_municipio_ibge(i);
					exception
					when others then
						compl_pessoa_fisica_w.ds_cidade(i)	:= '';
					end;
				else
					compl_pessoa_fisica_w.ds_cidade(i)	:= '';
				end if;
			else
				compl_pessoa_fisica_w.ds_endereco(i)		:= '';
				compl_pessoa_fisica_w.nr_endereco(i)		:= '';
				compl_pessoa_fisica_w.nr_cep(i)			:= '';
				compl_pessoa_fisica_w.cd_municipio_ibge(i)	:= '';
				compl_pessoa_fisica_w.sg_uf(i)			:= '';
				compl_pessoa_fisica_w.ds_bairro(i)		:= '';
				compl_pessoa_fisica_w.nr_ddd(i)			:= '';
				compl_pessoa_fisica_w.nr_telefone(i)		:= '';
				compl_pessoa_fisica_w.ds_compl_endereco(i)	:= '';
				compl_pessoa_fisica_w.ds_email(i)		:= '';
				compl_pessoa_fisica_w.nr_ramal(i)		:= '';
				compl_pessoa_fisica_w.ds_cidade(i)		:= '';
				compl_pessoa_fisica_w.tp_logradouro(i)		:= '';
				compl_pessoa_fisica_w.nr_seq_mov_benef_pf(i)	:= pessoa_fisica_w.nr_seq_mov_benef_pf(i);
				compl_pessoa_fisica_w.tp_endereco(i)		:= '';
				compl_pessoa_fisica_w.cd_pessoa_fisica(i)	:= pessoa_fisica_w.cd_pessoa_fisica(i);
				compl_pessoa_fisica_w.nr_ddd_2(i)		:= '';
				compl_pessoa_fisica_w.nr_telefone_2(i)		:= '';
				compl_pessoa_fisica_w.nr_ramal_2(i)		:= '';
				compl_pessoa_fisica_w.ds_email_2(i)		:= '';
				compl_pessoa_fisica_w.nr_ddd_3(i)		:= '';
				compl_pessoa_fisica_w.nr_telefone_3(i)		:= '';
				compl_pessoa_fisica_w.nr_ramal_3(i)		:= '';
				compl_pessoa_fisica_w.ds_email_3(i)		:= '';
				compl_pessoa_fisica_w.ie_tipo_telefone(i)	:= '';
				compl_pessoa_fisica_w.ie_tipo_email(i)		:= '';
			end if;
		end loop;
		
		for i in compl_pessoa_fisica_w.nr_seq_mov_benef_pf.first .. compl_pessoa_fisica_w.nr_seq_mov_benef_pf.count loop
			begin
			
			compl_pessoa_fisica_w.ds_endereco(i)		:= ptu_somente_caracter_permitido(compl_pessoa_fisica_w.ds_endereco(i),'ANS');
			compl_pessoa_fisica_w.nr_endereco(i)		:= ptu_somente_caracter_permitido(compl_pessoa_fisica_w.nr_endereco(i),'ANS');
			compl_pessoa_fisica_w.ds_compl_endereco(i)	:= ptu_somente_caracter_permitido(compl_pessoa_fisica_w.ds_compl_endereco(i),'ANS');
			compl_pessoa_fisica_w.ds_bairro(i)		:= ptu_somente_caracter_permitido(compl_pessoa_fisica_w.ds_bairro(i),'ANS');
			compl_pessoa_fisica_w.ds_email(i)		:= ptu_somente_caracter_permitido(compl_pessoa_fisica_w.ds_email(i),'ANS');
			compl_pessoa_fisica_w.ds_cidade(i)		:= ptu_somente_caracter_permitido(compl_pessoa_fisica_w.ds_cidade(i),'ANS');
			compl_pessoa_fisica_w.ds_email_2(i)		:= ptu_somente_caracter_permitido(compl_pessoa_fisica_w.ds_email_2(i),'ANS');
			compl_pessoa_fisica_w.ds_email_3(i)		:= ptu_somente_caracter_permitido(compl_pessoa_fisica_w.ds_email_3(i),'ANS');
			
			if (coalesce(compl_pessoa_fisica_w.ds_endereco(i)::text, '') = '') then
				CALL ptu_moviment_benef_a1300_pck.gravar_log_inco_vetor(	nr_seq_mov_empresa_p,nr_seq_contrato_p,null,compl_pessoa_fisica_w.cd_pessoa_fisica(i),null,
							wheb_mensagem_pck.get_texto(1107810)/*Falta a informacao do endereco da pessoa fisica*/
);
			end if;
			
			if (coalesce(compl_pessoa_fisica_w.ds_cidade(i)::text, '') = '') then
				CALL ptu_moviment_benef_a1300_pck.gravar_log_inco_vetor(	nr_seq_mov_empresa_p,nr_seq_contrato_p,null,compl_pessoa_fisica_w.cd_pessoa_fisica(i),null,
							wheb_mensagem_pck.get_texto(1107811)/*Falta a informacao da cidade da pessoa fisica*/
);
			end if;
			
			if (coalesce(compl_pessoa_fisica_w.nr_cep(i)::text, '') = '') then
				CALL ptu_moviment_benef_a1300_pck.gravar_log_inco_vetor(	nr_seq_mov_empresa_p,nr_seq_contrato_p,null,compl_pessoa_fisica_w.cd_pessoa_fisica(i),null,
							wheb_mensagem_pck.get_texto(1107812)/*Falta a informacao do cep da pessoa fisica*/
);
			end if;
			
			if (coalesce(compl_pessoa_fisica_w.tp_logradouro(i)::text, '') = '') then
				CALL ptu_moviment_benef_a1300_pck.gravar_log_inco_vetor(	nr_seq_mov_empresa_p,nr_seq_contrato_p,null,compl_pessoa_fisica_w.cd_pessoa_fisica(i),null,
							wheb_mensagem_pck.get_texto(1107813)/*Falta a informacao do tipo de logradouro da pessoa fisica*/
);
			end if;
			end;
		end loop;
		
		forall i in compl_pessoa_fisica_w.nr_seq_mov_benef_pf.first .. compl_pessoa_fisica_w.nr_seq_mov_benef_pf.last
			insert into ptu_mov_benef_pf_compl(	nr_sequencia,dt_atualizacao,nm_usuario,dt_atualizacao_nrec,nm_usuario_nrec,
					nr_seq_mov_pessoa,ie_tipo_endereco,ds_endereco,
					nr_endereco,ds_complemento,ds_bairro,
					nm_municipio,cd_municipio_ibge,cd_cep,
					sg_uf,nr_ddd,nr_ramal,
					ds_email,nr_fone,cd_tipo_logradouro,
					nr_ddd_2,nr_fone_2,nr_ramal_2,
					ds_email_2,nr_ddd_3,nr_fone_3,
					nr_ramal_3,ds_email_3,ie_tipo_email,
					ie_tipo_telefone)
			values (	nextval('ptu_mov_benef_pf_compl_seq'),clock_timestamp(),get_nm_usuario,clock_timestamp(),get_nm_usuario,
					compl_pessoa_fisica_w.nr_seq_mov_benef_pf(i),compl_pessoa_fisica_w.tp_endereco(i),compl_pessoa_fisica_w.ds_endereco(i),
					compl_pessoa_fisica_w.nr_endereco(i),compl_pessoa_fisica_w.ds_compl_endereco(i),compl_pessoa_fisica_w.ds_bairro(i),
					compl_pessoa_fisica_w.ds_cidade(i),compl_pessoa_fisica_w.cd_municipio_ibge(i),compl_pessoa_fisica_w.nr_cep(i),
					compl_pessoa_fisica_w.sg_uf(i),compl_pessoa_fisica_w.nr_ddd(i),compl_pessoa_fisica_w.nr_ramal(i),
					compl_pessoa_fisica_w.ds_email(i),compl_pessoa_fisica_w.nr_telefone(i),compl_pessoa_fisica_w.tp_logradouro(i),
					compl_pessoa_fisica_w.nr_ddd_2(i),compl_pessoa_fisica_w.nr_telefone_2(i),compl_pessoa_fisica_w.nr_ramal_2(i),
					compl_pessoa_fisica_w.ds_email_2(i),compl_pessoa_fisica_w.nr_ddd_3(i),compl_pessoa_fisica_w.nr_telefone_3(i),
					compl_pessoa_fisica_w.nr_ramal_3(i),compl_pessoa_fisica_w.ds_email_3(i),compl_pessoa_fisica_w.ie_tipo_email(i),
					compl_pessoa_fisica_w.ie_tipo_telefone(i));
	end if;
	
	PERFORM set_config('ptu_moviment_benef_a1300_pck.qt_total_r305_w', current_setting('ptu_moviment_benef_a1300_pck.qt_total_r305_w')::ptu_mov_benef_trailer.qt_total_r305%type + compl_pessoa_fisica_w.nr_seq_mov_benef_pf.count, false);
	
	if (current_setting('ptu_moviment_benef_a1300_pck.nr_versao_transacao_w')::varchar(2) in ('09','10','11')) then
		PERFORM set_config('ptu_moviment_benef_a1300_pck.qt_total_r311_w', current_setting('ptu_moviment_benef_a1300_pck.qt_total_r311_w')::ptu_mov_benef_trailer.qt_total_r311%type + compl_pessoa_fisica_w.nr_seq_mov_benef_pf.count, false);
	end if;
	
	compl_pessoa_fisica_w.nr_seq_mov_benef_pf.delete;
	compl_pessoa_fisica_w.tp_endereco.delete;
	compl_pessoa_fisica_w.ds_endereco.delete;
	compl_pessoa_fisica_w.nr_endereco.delete;
	compl_pessoa_fisica_w.ds_compl_endereco.delete;
	compl_pessoa_fisica_w.ds_bairro.delete;
	compl_pessoa_fisica_w.ds_cidade.delete;
	compl_pessoa_fisica_w.cd_municipio_ibge.delete;
	compl_pessoa_fisica_w.nr_cep.delete;
	compl_pessoa_fisica_w.sg_uf.delete;
	compl_pessoa_fisica_w.nr_ddd.delete;
	compl_pessoa_fisica_w.nr_ramal.delete;
	compl_pessoa_fisica_w.ds_email.delete;
	compl_pessoa_fisica_w.nr_telefone.delete;
	compl_pessoa_fisica_w.tp_logradouro.delete;
	compl_pessoa_fisica_w.nr_ddd_2.delete;
	compl_pessoa_fisica_w.nr_telefone_2.delete;
	compl_pessoa_fisica_w.nr_ramal_2.delete;
	compl_pessoa_fisica_w.ds_email_2.delete;
	compl_pessoa_fisica_w.nr_ddd_3.delete;
	compl_pessoa_fisica_w.nr_telefone_3.delete;
	compl_pessoa_fisica_w.nr_ramal_3.delete;
	compl_pessoa_fisica_w.ds_email_3.delete;
	compl_pessoa_fisica_w.ie_tipo_email.delete;
	compl_pessoa_fisica_w.ie_tipo_telefone.delete;
	
	end;
	

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ptu_moviment_benef_a1300_pck.gerar_info_compl_pf ( pessoa_fisica_w pessoa_fisica_w_record, nr_seq_mov_empresa_p bigint, nr_seq_contrato_p bigint) FROM PUBLIC;
