-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE sap_fin_customer_pck.schedule_query_title () AS $body$
DECLARE

  reg_integracao_w   gerar_int_padrao.reg_integracao;
  nr_seq_documento_w intpd_fila_transmissao.nr_seq_documento%type;
  c01 CURSOR FOR
    SELECT nr_titulo
      from titulo_receber a
     where a.vl_saldo_titulo > 0
       and coalesce(a.dt_liquidacao::text, '') = '';

  c01_w c01%rowtype;

BEGIN
  for c01_w in c01 loop
    begin
      nr_seq_documento_w := to_char(c01_w.nr_titulo);
      reg_integracao_w := gerar_int_padrao.gravar_integracao('501', nr_seq_documento_w, coalesce(obter_usuario_ativo, 'Tasy'), reg_integracao_w);
      commit;
    end;
  end loop;
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE sap_fin_customer_pck.schedule_query_title () FROM PUBLIC;
