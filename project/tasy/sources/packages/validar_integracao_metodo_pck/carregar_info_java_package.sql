-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION validar_integracao_metodo_pck.carregar_info_java (classe_p text) RETURNS varchar AS $body$
DECLARE

    retorno varchar(5000) := '';
    dt_criacao_w timestamp;
    dt_carga_w timestamp;
    qt_registro_w integer;
    status_w varchar(10);

C01 CURSOR FOR
    SELECT 	cast(created as timestamp) dt_criacao ,
        cast(last_ddl_time as timestamp) dt_carga,
        status
    from	user_OBJECTS
    where	upper(OBJECT_TYPE) = upper('JAVA CLASS')
    and 	upper(OBJECT_NAME) LIKE upper('%'||classe_p);

BEGIN
	open C01;
	loop
	fetch C01 into
            dt_criacao_w,
            dt_carga_w,
            status_w;
  EXIT WHEN NOT FOUND; /* apply on C01 */
            begin
              retorno := validar_integracao_metodo_pck.tratar_mensagem(retorno, 'Classe: ' || classe_p || chr(10)|| ' - Data de criacao: ' || dt_criacao_w || chr(10) || ' - Data ultima carga: ' || dt_carga_w || chr(10) || ' - Valido: ' || status_w);
            end;
  end loop;
  close C01;

  SELECT 	count(0)
    into STRICT qt_registro_w
    from	user_OBJECTS
    where	upper(OBJECT_TYPE) = upper('JAVA CLASS')
    and 	upper(OBJECT_NAME) LIKE upper('%'||classe_p);
  
  if qt_registro_w = 0 then
    retorno := validar_integracao_metodo_pck.tratar_mensagem(retorno, 'Classe "' || classe_p || '" nao encontrada!');
  end if;
  return retorno;

  end;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION validar_integracao_metodo_pck.carregar_info_java (classe_p text) FROM PUBLIC;
