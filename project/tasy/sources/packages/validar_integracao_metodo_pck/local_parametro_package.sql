-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION validar_integracao_metodo_pck.local_parametro (cd_funcao_p integer, parametro_p integer, cd_perfil_p text, nm_usuario_p text, cd_estabelecimento_p text) RETURNS varchar AS $body$
DECLARE

    retorno varchar(5000) := '';
    qt_registro_w integer;

BEGIN
   
    select count(0) 
      into STRICT qt_registro_w
     from FUNCAO_PARAM_USUARIO
    where nm_usuario_param = nm_usuario_p
      and cd_funcao = cd_funcao_p
      and nr_sequencia = parametro_p;

      
    if (qt_registro_w <> 0)then
      retorno := 'U';
    else
      select count(0)
        into STRICT qt_registro_w
        from FUNCAO_PARAM_PERFIL
       where cd_funcao = cd_funcao_p
         and nr_sequencia = parametro_p
         and cd_perfil = cd_perfil_p
         and cd_estabelecimento = cd_estabelecimento_p;

         if (qt_registro_w <> 0) then
           retorno := 'PE';
         else
           select count(0)
             into STRICT qt_registro_w
             from FUNCAO_PARAM_PERFIL
            where cd_funcao = cd_funcao_p
              and nr_sequencia = parametro_p
              and cd_perfil = cd_perfil_p;

              if (qt_registro_w <> 0) then
                retorno := 'P';
              else
                select count(0)
                  into STRICT qt_registro_w
                  from FUNCAO_PARAM_ESTAB
                 where nr_seq_param = parametro_p
                   and cd_funcao = cd_funcao_p
                   and cd_estabelecimento = cd_estabelecimento_p;
                if qt_registro_w <> 0 then
                  retorno := 'E';
                else
                  retorno := 'C';
                end if;
              end if;
         end if;
    end if;
    return retorno;
  end;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION validar_integracao_metodo_pck.local_parametro (cd_funcao_p integer, parametro_p integer, cd_perfil_p text, nm_usuario_p text, cd_estabelecimento_p text) FROM PUBLIC;
