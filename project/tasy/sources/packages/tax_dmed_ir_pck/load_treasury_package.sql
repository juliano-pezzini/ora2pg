-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE tax_dmed_ir_pck.load_treasury () AS $body$
DECLARE

      procedure_name_w varchar(20) := 'TaxDmed2';
      document_vector         response_reference;
      table_expression        varchar(255) := ', caixa_receb y, caixa_saldo_diario o, caixa t, pessoa_fisica p2 ';
      connections_expression  varchar(510) := ' and o.nr_sequencia = y.nr_seq_saldo_caixa and o.nr_seq_caixa = t.nr_sequencia'           ||
                                                ' and l.nr_seq_caixa_rec = y.nr_sequencia and a.cd_pessoa_fisica = p.cd_pessoa_fisica'     ||
                                                ' and y.cd_pessoa_fisica = p2.cd_pessoa_fisica and p2.nr_cpf is not null'                  ||
                                                ' and y.cd_pessoa_fisica is not null and y.dt_cancelamento is null and l.vl_recebido > 0';

BEGIN
      document_vector := tax_dmed_ir_pck.run_dynamic_sql(document_vector, table_expression_p => table_expression, connections_expression_p => connections_expression, procedure_name_p => procedure_name_w);
      CALL tax_dmed_ir_pck.add_monthly_data(document_vector, 'S', 'TaxDmed2');
  END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE tax_dmed_ir_pck.load_treasury () FROM PUBLIC;
