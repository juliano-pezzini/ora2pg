-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE tax_dmed_ir_pck.converte_sql_log (sql_p INOUT text, expression_p text, additional_index_p bigint default 0) AS $body$
DECLARE

    sql_w                        varchar(4000);
    return_position_expression_w bigint;
    log_vector_w                 log_expressions_type;
    index_w                      bigint;

BEGIN
    sql_w := sql_p;
    index_w := position(expression_p in sql_w);

    while index_w <> 0 loop
      log_vector_w := current_setting('tax_dmed_ir_pck.log_expressions')::log_expressions_reference(tax_dmed_ir_pck.validation_log_expression(substr(sql_w, index_w), expression_p, additional_index_p));
      sql_w := replace(sql_w, log_vector_w.code_expression, log_vector_w.converted_expression);
      index_w := position(expression_p in sql_w);
    end loop;

    sql_w := replace(sql_w, 'tax_dmed_ir_pck.get_initial_date()', tax_dmed_ir_pck.date_to_str(tax_dmed_ir_pck.get_initial_date()));
    sql_w := replace(sql_w, 'tax_dmed_ir_pck.get_final_date()', tax_dmed_ir_pck.date_to_str(tax_dmed_ir_pck.get_final_date()));
    sql_p := sql_w;
  end;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE tax_dmed_ir_pck.converte_sql_log (sql_p INOUT text, expression_p text, additional_index_p bigint default 0) FROM PUBLIC;
