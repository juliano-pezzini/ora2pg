-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE tax_dmed_ir_pck.generate_data_parallel (batch_monthly_sequence_p tax_dmed_lote_mensal.nr_sequencia%type) AS $body$
DECLARE

      parameter_parallel_w  dbms_sql.varchar2_table;
      sequence_queue_w      fis_fila_arquivo.nr_sequencia%type;
      batch_description_w   tax_dmed_lote_mensal.ds_lote%type;

BEGIN
      select  ds_lote
      into STRICT    batch_description_w
      from    tax_dmed_lote_mensal
      where   nr_sequencia = batch_monthly_sequence_p;

      parameter_parallel_w(1) := ':job';
      parameter_parallel_w(2) := batch_monthly_sequence_p;

      sequence_queue_w := tax_parallel_procedure_pck.add_record_to_queue(wheb_usuario_pck.get_nm_usuario, batch_monthly_sequence_p, batch_description_w, 4, 1, sequence_queue_w);
      parameter_parallel_w(3) := sequence_queue_w;
      CALL tax_parallel_procedure_pck.run_in_parallel('provider_data_parallel', parameter_parallel_w, 'tax_dmed_ir_pck');

      sequence_queue_w := tax_parallel_procedure_pck.add_record_to_queue(wheb_usuario_pck.get_nm_usuario, batch_monthly_sequence_p, batch_description_w, 5, 1, sequence_queue_w);
      parameter_parallel_w(3) := sequence_queue_w;
      CALL tax_parallel_procedure_pck.run_in_parallel('operator_data_parallel', parameter_parallel_w, 'tax_dmed_ir_pck');

      parameter_parallel_w(3) := utl_lms.format_message(q'['%s']', wheb_usuario_pck.get_nm_usuario);
      parameter_parallel_w(4) := wheb_usuario_pck.get_cd_perfil;
      parameter_parallel_w(5) := wheb_usuario_pck.get_nr_seq_idioma;
      CALL tax_parallel_procedure_pck.run_in_parallel('process_monitor_parallel', parameter_parallel_w, 'tax_dmed_ir_pck');
  END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE tax_dmed_ir_pck.generate_data_parallel (batch_monthly_sequence_p tax_dmed_lote_mensal.nr_sequencia%type) FROM PUBLIC;
