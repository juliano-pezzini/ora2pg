-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE gerar_esocial_dados_pck.gerar_esocial_dados_compl ( nr_seq_lote_p bigint, nr_seq_prestador_p bigint, ie_tipo_operacao_p text, cd_estabelecimento_p bigint, nm_usuario_p text) AS $body$
BEGIN

	if (coalesce(current_setting('gerar_esocial_dados_pck.nr_seq_regra_w')::esocial_regra.nr_sequencia%type,0) <> 0) then
		insert into esocial_dados_compl(
				nr_sequencia,
				dt_atualizacao,
				nm_usuario,
				dt_atualizacao_nrec,
				nm_usuario_nrec,
				nr_seq_esocial_lote,
				cd_empresa,
				ie_tipo_operacao,
				ie_tipo_colaborador,
				cd_cadastro_colab,
				ie_tipo_logradouro,
				ds_endereco,
				nr_endereco,
				ds_complemento,
				cd_pais,
				sg_estado,
				ds_municipio,
				ds_bairro,
				cd_cep,
				nr_ddi_telefone,
				nr_ddd_telefone,
				nr_telefone,
				cd_pais_nasc,
				sg_estado_nasc,
				cd_cidade_nasc,
				nr_identidade,
				sg_emissora_ci,
				dt_emissao_ci,
				nr_titulo_eleitor,
				nr_cnh,
				nr_seq_conselho,
				ds_codigo_prof,
				nm_pessoa_fisica,
				nr_cartao_nac_sus,
				nr_seq_prestador)
			values (nextval('esocial_dados_compl_seq'),
				clock_timestamp(),
				nm_usuario_p,
				clock_timestamp(),
				nm_usuario_p,
				nr_seq_lote_p,
				current_setting('gerar_esocial_dados_pck.cd_empresa_w')::esocial_lote.cd_empresa%type,
				ie_tipo_operacao_p,
				2, -- Terceiro
				current_setting('gerar_esocial_dados_pck.cd_externo_esocial_w')::pls_prestador.cd_externo_esocial%type,
				current_setting('gerar_esocial_dados_pck.ie_tipo_logradouro_w')::sus_tipo_logradouro.ds_tipo_logradouro%type,
				current_setting('gerar_esocial_dados_pck.ds_endereco_w')::compl_pessoa_fisica.ds_endereco%type,
				current_setting('gerar_esocial_dados_pck.nr_endereco_w')::compl_pessoa_fisica.nr_endereco%type,
				current_setting('gerar_esocial_dados_pck.ds_complemento_w')::compl_pessoa_fisica.ds_complemento%type,
				current_setting('gerar_esocial_dados_pck.cd_pais_w')::pais.cd_pais_siscoserv%type,
				substr(current_setting('gerar_esocial_dados_pck.sg_estado_w')::compl_pessoa_fisica.sg_estado%type,1,2),
				current_setting('gerar_esocial_dados_pck.ds_municipio_w')::varchar(7),
				current_setting('gerar_esocial_dados_pck.ds_bairro_w')::compl_pessoa_fisica.ds_bairro%type,
				current_setting('gerar_esocial_dados_pck.cd_cep_w')::compl_pessoa_fisica.cd_cep%type,
				current_setting('gerar_esocial_dados_pck.nr_ddi_telefone_w')::compl_pessoa_fisica.nr_ddi_telefone%type,
				current_setting('gerar_esocial_dados_pck.nr_ddd_telefone_w')::compl_pessoa_fisica.nr_ddd_telefone%type,
				current_setting('gerar_esocial_dados_pck.nr_telefone_w')::compl_pessoa_fisica.nr_telefone%type,
				current_setting('gerar_esocial_dados_pck.cd_pais_nasc_w')::nacionalidade.cd_bacen%type,
				current_setting('gerar_esocial_dados_pck.sg_estado_nasc_w')::compl_pessoa_fisica.sg_estado%type,
				current_setting('gerar_esocial_dados_pck.cd_cidade_nasc_w')::cep_logradouro.nm_localidade%type,
				current_setting('gerar_esocial_dados_pck.nr_identidade_w')::pessoa_fisica.nr_identidade%type,
				current_setting('gerar_esocial_dados_pck.sg_emissora_ci_w')::pessoa_fisica.sg_emissora_ci%type,
				current_setting('gerar_esocial_dados_pck.dt_emissao_ci_w')::pessoa_fisica.dt_emissao_ci%type,
				current_setting('gerar_esocial_dados_pck.nr_titulo_eleitor_w')::pessoa_fisica.nr_titulo_eleitor%type,
				current_setting('gerar_esocial_dados_pck.nr_cnh_w')::pessoa_fisica.nr_cnh%type,
				current_setting('gerar_esocial_dados_pck.nr_seq_conselho_w')::pessoa_fisica.nr_seq_conselho%type,
				current_setting('gerar_esocial_dados_pck.ds_codigo_prof_w')::pessoa_fisica.ds_codigo_prof%type,
				current_setting('gerar_esocial_dados_pck.nm_pessoa_fisica_w')::pessoa_fisica.nm_pessoa_fisica%type,
				current_setting('gerar_esocial_dados_pck.nr_cartao_nac_sus_w')::pessoa_fisica.nr_cartao_nac_sus%type,
				nr_seq_prestador_p);
	end if;

	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_esocial_dados_pck.gerar_esocial_dados_compl ( nr_seq_lote_p bigint, nr_seq_prestador_p bigint, ie_tipo_operacao_p text, cd_estabelecimento_p bigint, nm_usuario_p text) FROM PUBLIC;
