-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE gerar_esocial_dados_pck.carregar_esocial_dados_pessoa ( cd_pessoa_fisica_p text) AS $body$
BEGIN

	select	max(a.nr_cpf),
		max(a.ie_estado_civil),
		max(a.nr_pis_pasep),
		max(a.dt_nascimento),
		max(a.nm_pessoa_fisica),
		max(obter_compl_pf(a.cd_pessoa_fisica,1,'TLS')), -- sus_obter_desc_tipolog
		max(obter_compl_pf(a.cd_pessoa_fisica,1,'EN')),
		max(obter_compl_pf(a.cd_pessoa_fisica,1,'NR')),
		max(obter_compl_pf(a.cd_pessoa_fisica,1,'CO')),
		max(obter_compl_pf(a.cd_pessoa_fisica,1,'PAISSISCOSERV')),
		max(obter_compl_pf(a.cd_pessoa_fisica,1,'UF')),
		max(obter_compl_pf(a.cd_pessoa_fisica,1,'CDMDV')),
		max(obter_compl_pf(a.cd_pessoa_fisica,1,'B')),
		max(obter_compl_pf(a.cd_pessoa_fisica,1,'CEP')),
		max(obter_compl_pf(a.cd_pessoa_fisica,1,'DIT')),
		max(obter_compl_pf(a.cd_pessoa_fisica,1,'DDT')),
		max(obter_compl_pf(a.cd_pessoa_fisica,1,'T')),
		max(	select	x.cd_bacen
			from	nacionalidade x
			where	x.cd_nacionalidade	= a.cd_nacionalidade), -- obter_nome_pais_bacen
		max(obter_uf_localidade(a.nr_cep_cidade_nasc)) sg_estado_nasc,
		max(obter_desc_cep_loc(a.nr_cep_cidade_nasc)) cd_cidade_nasc,
		max(a.nr_identidade),
		max(a.sg_emissora_ci),
		max(a.dt_emissao_ci),
		max(a.nr_titulo_eleitor),
		max(a.nr_cnh),
		max(a.nr_seq_conselho),
		max(a.ds_codigo_prof),
		max(a.nr_cartao_nac_sus)
	into STRICT	current_setting('gerar_esocial_dados_pck.nr_cpf_w')::pessoa_fisica.nr_cpf%type,
		current_setting('gerar_esocial_dados_pck.ie_estado_civil_w')::pessoa_fisica.ie_estado_civil%type,
		current_setting('gerar_esocial_dados_pck.nr_pis_pasep_w')::pessoa_fisica.nr_pis_pasep%type,
		current_setting('gerar_esocial_dados_pck.dt_nascimento_w')::pessoa_fisica.dt_nascimento%type,
		current_setting('gerar_esocial_dados_pck.nm_pessoa_fisica_w')::pessoa_fisica.nm_pessoa_fisica%type,
		current_setting('gerar_esocial_dados_pck.ie_tipo_logradouro_w')::sus_tipo_logradouro.ds_tipo_logradouro%type,
		current_setting('gerar_esocial_dados_pck.ds_endereco_w')::compl_pessoa_fisica.ds_endereco%type,
		current_setting('gerar_esocial_dados_pck.nr_endereco_w')::compl_pessoa_fisica.nr_endereco%type,
		current_setting('gerar_esocial_dados_pck.ds_complemento_w')::compl_pessoa_fisica.ds_complemento%type,
		current_setting('gerar_esocial_dados_pck.cd_pais_w')::pais.cd_pais_siscoserv%type,
		current_setting('gerar_esocial_dados_pck.sg_estado_w')::compl_pessoa_fisica.sg_estado%type,
		current_setting('gerar_esocial_dados_pck.ds_municipio_w')::varchar(7),
		current_setting('gerar_esocial_dados_pck.ds_bairro_w')::compl_pessoa_fisica.ds_bairro%type,
		current_setting('gerar_esocial_dados_pck.cd_cep_w')::compl_pessoa_fisica.cd_cep%type,
		current_setting('gerar_esocial_dados_pck.nr_ddi_telefone_w')::compl_pessoa_fisica.nr_ddi_telefone%type,
		current_setting('gerar_esocial_dados_pck.nr_ddd_telefone_w')::compl_pessoa_fisica.nr_ddd_telefone%type,
		current_setting('gerar_esocial_dados_pck.nr_telefone_w')::compl_pessoa_fisica.nr_telefone%type,
		current_setting('gerar_esocial_dados_pck.cd_pais_nasc_w')::nacionalidade.cd_bacen%type,
		current_setting('gerar_esocial_dados_pck.sg_estado_nasc_w')::compl_pessoa_fisica.sg_estado%type,
		current_setting('gerar_esocial_dados_pck.cd_cidade_nasc_w')::cep_logradouro.nm_localidade%type,
		current_setting('gerar_esocial_dados_pck.nr_identidade_w')::pessoa_fisica.nr_identidade%type,
		current_setting('gerar_esocial_dados_pck.sg_emissora_ci_w')::pessoa_fisica.sg_emissora_ci%type,
		current_setting('gerar_esocial_dados_pck.dt_emissao_ci_w')::pessoa_fisica.dt_emissao_ci%type,
		current_setting('gerar_esocial_dados_pck.nr_titulo_eleitor_w')::pessoa_fisica.nr_titulo_eleitor%type,
		current_setting('gerar_esocial_dados_pck.nr_cnh_w')::pessoa_fisica.nr_cnh%type,
		current_setting('gerar_esocial_dados_pck.nr_seq_conselho_w')::pessoa_fisica.nr_seq_conselho%type,
		current_setting('gerar_esocial_dados_pck.ds_codigo_prof_w')::pessoa_fisica.ds_codigo_prof%type,
		current_setting('gerar_esocial_dados_pck.nr_cartao_nac_sus_w')::pessoa_fisica.nr_cartao_nac_sus%type
	from	pessoa_fisica a
	where	a.cd_pessoa_fisica	= cd_pessoa_fisica_p;

	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE gerar_esocial_dados_pck.carregar_esocial_dados_pessoa ( cd_pessoa_fisica_p text) FROM PUBLIC;
