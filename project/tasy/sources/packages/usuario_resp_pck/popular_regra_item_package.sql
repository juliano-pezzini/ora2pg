-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE usuario_resp_pck.popular_regra_item () AS $body$
DECLARE


  r RECORD;

BEGIN
PERFORM set_config('usuario_resp_pck.i', 0, false);

if (current_setting('usuario_resp_pck.regra_prev_item_w')::regra_prev_item_v.count = 0) then

	For r in (SELECT NR_SEQUENCIA,
			CD_PROCEDIMENTO,  
			CD_MATERIAL,
			IE_ORIGEM_PROCED,  
			CD_GRUPO_MATERIAL,    
			CD_SUBGRUPO_MATERIAL,  
			CD_CLASSE_MATERIAL,  
			CD_AREA_PROCEDIMENTO,
			CD_ESPECIALIDADE,  
			CD_GRUPO_PROC,
			NR_SEQ_PREV_ANALISE_USU
		from	regra_prev_analise_item
		where	1 = 1 
		and	ie_situacao  = 'A') loop

	
	current_setting('usuario_resp_pck.regra_prev_item_w')::regra_prev_item_v(current_setting('usuario_resp_pck.i')::integer).nr_seq_prev_analise_usu	:= r.NR_SEQ_PREV_ANALISE_USU;
	current_setting('usuario_resp_pck.regra_prev_item_w')::regra_prev_item_v(current_setting('usuario_resp_pck.i')::integer).nr_sequencia		:= r.nr_sequencia;
	current_setting('usuario_resp_pck.regra_prev_item_w')::regra_prev_item_v(current_setting('usuario_resp_pck.i')::integer).cd_procedimento		:= r.cd_procedimento;
	current_setting('usuario_resp_pck.regra_prev_item_w')::regra_prev_item_v(current_setting('usuario_resp_pck.i')::integer).cd_material		:= r.cd_material;
	current_setting('usuario_resp_pck.regra_prev_item_w')::regra_prev_item_v(current_setting('usuario_resp_pck.i')::integer).ie_origem_proced		:= r.ie_origem_proced;
	current_setting('usuario_resp_pck.regra_prev_item_w')::regra_prev_item_v(current_setting('usuario_resp_pck.i')::integer).cd_grupo_material		:= r.cd_grupo_material;
	current_setting('usuario_resp_pck.regra_prev_item_w')::regra_prev_item_v(current_setting('usuario_resp_pck.i')::integer).cd_subgrupo_material	:= r.cd_subgrupo_material;	
	current_setting('usuario_resp_pck.regra_prev_item_w')::regra_prev_item_v(current_setting('usuario_resp_pck.i')::integer).cd_classe_material		:= r.cd_classe_material;
	current_setting('usuario_resp_pck.regra_prev_item_w')::regra_prev_item_v(current_setting('usuario_resp_pck.i')::integer).cd_area_procedimento	:= r.cd_area_procedimento;
	current_setting('usuario_resp_pck.regra_prev_item_w')::regra_prev_item_v(current_setting('usuario_resp_pck.i')::integer).cd_especialidade		:= r.cd_especialidade;
	current_setting('usuario_resp_pck.regra_prev_item_w')::regra_prev_item_v(current_setting('usuario_resp_pck.i')::integer).cd_grupo_proc		:= r.cd_grupo_proc;
	
	
	PERFORM set_config('usuario_resp_pck.i', current_setting('usuario_resp_pck.i')::integer + 1, false);

	end loop;

end if;

		
end;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE usuario_resp_pck.popular_regra_item () FROM PUBLIC;
