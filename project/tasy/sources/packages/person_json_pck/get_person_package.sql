-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION person_json_pck.get_person ( cd_pessoa_fisica_p text) RETURNS PHILIPS_JSON AS $body$
DECLARE

	json_patient_w		philips_json;
	
	C01 CURSOR FOR
		SELECT 	*
		from 	bft_patient_v
		where	cd_pessoa_fisica = cd_pessoa_fisica_p;
	
	
BEGIN
	
	json_patient_w	:= philips_json();
	
	for r_c01 in c01 loop
		begin
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'patientId', r_c01.PATIENT_ID);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'medicalRecordId', r_c01.MEDICAL_RECORD_ID);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'externalMedicalRecordId', r_c01.EXTERNAL_MEDICAL_RECORD_ID);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'patientName', r_c01.PATIENT_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'patientGivenName', r_c01.PATIENT_GIVEN_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'patientLastName', r_c01.PATIENT_LAST_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'patientMiddleName', r_c01.PATIENT_MIDDLE_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'motherName', r_c01.MOTHER_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'motherGivenName', r_c01.MOTHER_GIVEN_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'motherMiddleName', r_c01.MOTHER_MIDDLE_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'motherLastName', r_c01.MOTHER_LAST_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'motherCivilId', r_c01.MOTHER_CIVIL_ID);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'resposibleName', r_c01.RESPONSIBLE_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'responsibleCivilId', r_c01.responsible_civil_id);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'patientTitle', r_c01.PATIENT_TITLE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'sexId', r_c01.SEX_ID);
    json_patient_w := person_json_pck.add_json_value(json_patient_w, 'hl7DateOfBirth', to_char(r_c01.DATE_OF_BIRTH,'yyyymmdd'));
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'dateOfBirth', r_c01.DATE_OF_BIRTH);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'charDateOfBirth', r_c01.CHAR_DATE_OF_BIRTH);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'skinColorCode', r_c01.SKIN_COLOR_CODE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'hl7RaceCode', r_c01.HL7_RACE_CODE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'maritalStatus', r_c01.MARITAL_STATUS);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'religionCode', r_c01.RELIGION_CODE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'externalReligionCode', r_c01.EXTERNAL_RELIGION_CODE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'medicalRecord', r_c01.MEDICAL_RECORD);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'patientNationalId', r_c01.PATIENT_NATIONAL_ID);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'taxpayerId', r_c01.TAXPAYER_ID);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'brazilNumberId', r_c01.BRAZIL_NUMBER_ID);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'deathDate', r_c01.DEATH_DATE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'patientAddress', r_c01.PATIENT_ADDRESS);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'countryAcronym', r_c01.COUNTRY_ACRONYM);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'countryDesc', r_c01.COUNTRY_DESC);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'countryCode', r_c01.COUNTRY_CODE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'stateCode', r_c01.STATE_CODE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'stateDescription', r_c01.STATE_DESCRIPTION);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'cityName', r_c01.CITY_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'nationalityCode', r_c01.NATIONALITY_CODE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'neighborhoodName', r_c01.NEIGHBORHOOD_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'adressNumber', r_c01.ADRESS_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'additionalInformationAddress', r_c01.ADDITIONAL_INFORMATION_ADDRESS);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'postalCode', r_c01.POSTAL_CODE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'ddiHomePhoneNumber', r_c01.DDI_HOME_PHONE_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'dddHomePhoneNumber', r_c01.DDD_HOME_PHONE_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'homePhoneNumber', r_c01.HOME_PHONE_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'ddiAddHomePhoneNumber', r_c01.DDI_ADD_HOME_PHONE_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'dddAddHomePhoneNumber', r_c01.DDD_ADD_HOME_PHONE_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'addHomePhoneNumber', r_c01.ADD_HOME_PHONE_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'mobilePhoneNumber', r_c01.MOBILE_PHONE_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'dddMobilePhoneNumber', r_c01.DDD_MOBILE_PHONE_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'ddiMobilePhoneNumber', r_c01.DDI_MOBILE_PHONE_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'businessPhoneNumber', r_c01.business_phone_number);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'patientEmail', r_c01.PATIENT_EMAIL);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'cdPessoaFisica', r_c01.CD_PESSOA_FISICA);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'providerNumber', r_c01.PROVIDER_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'heightCM', r_c01.HEIGHT_CM);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'weightKG', r_c01.WEIGHT_KG);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'medicareNumber', r_c01.patient_national_id);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'medicarePosition', r_c01.MEDICARE_POSITION);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'medicareExpirationDate', get_med_expire_date(r_c01.patient_national_id, r_c01.PATIENT_ID));
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'dveNumber', r_c01.DVE_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'dveType', r_c01.DVE_TYPE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'memberShipNumber', r_c01.MEMBER_SHIP_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'healthFundId', r_c01.HEALTH_FUND_ID);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'healthFundMember', r_c01.HEALTH_FUND_MEMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'streetCode', r_c01.STREET_CODE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'postCode', r_c01.POST_CODE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'streetType', r_c01.STREET_TYPE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'streetNumber', r_c01.STREET_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'streetName', r_c01.STREET_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'suburbName', r_c01.SUBURB_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'dcClientId', r_c01.DC_CLIENT_ID);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'patientIhi', r_c01.PATIENT_IHI);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'providerHpii', r_c01.PROVIDER_HPII);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'ethicityCode', r_c01.ETHICITY_CODE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'ethicityDesc', r_c01.ETHICITY_DESC);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'corporateName', r_c01.CORPORATE_NAME);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'corporateAddress', r_c01.CORPORATE_ADDRESS);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'corporatePostCode', r_c01.CORPORATE_POST_CODE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'corporateCity', r_c01.CORPORATE_CITY);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'employeeCode', r_c01.EMPLOYEE_CODE);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'driversLicenseNumber', r_c01.DRIVERS_LICENSE_NUMBER);
		json_patient_w := person_json_pck.add_json_value(json_patient_w, 'externalAccountNumber', r_c01.EXTERNAL_ACCOUNT_NUMBER);
		end;
	end loop;
	
	
	return json_patient_w;
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION person_json_pck.get_person ( cd_pessoa_fisica_p text) FROM PUBLIC;
