-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE ger_npt_harris_benedi_md_pck.calcula_vol_prot_npt_md (qt_volume_p bigint, calc_conforme_protocolo_p text, qt_elemento_p bigint, qt_vol_diaria_p bigint, qt_conversao_ml_p bigint, qt_peso_p bigint, ie_tipo_elemento_p text, qt_formula_carb_p bigint, qt_formula_lipideo_p bigint, qt_volume_protocolo_p INOUT bigint, qt_diaria_p INOUT bigint, qt_elem_kg_dia_p INOUT bigint, qt_kcal_p INOUT bigint ) AS $body$
BEGIN
		qt_volume_protocolo_p := qt_volume_p;

		if (calc_conforme_protocolo_p = 'S') then
			qt_diaria_p := coalesce(qt_elemento_p,0);
		else
			qt_diaria_p	:= dividir_md(qt_vol_diaria_p,qt_conversao_ml_p);
		end if;
		
		qt_elem_kg_dia_p	:= dividir_md(qt_diaria_p, qt_peso_p);
		
    if (ie_tipo_elemento_p = 'C') then
      qt_kcal_p := coalesce(qt_diaria_p,qt_volume_protocolo_p) * qt_formula_carb_p;
    elsif (ie_tipo_elemento_p = 'P') then
      qt_kcal_p := coalesce(qt_diaria_p,qt_volume_protocolo_p) * 4;
    elsif (ie_tipo_elemento_p = 'L') then
      qt_kcal_p := coalesce(qt_diaria_p,qt_volume_protocolo_p) * qt_formula_lipideo_p;
    end if;
	end;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ger_npt_harris_benedi_md_pck.calcula_vol_prot_npt_md (qt_volume_p bigint, calc_conforme_protocolo_p text, qt_elemento_p bigint, qt_vol_diaria_p bigint, qt_conversao_ml_p bigint, qt_peso_p bigint, ie_tipo_elemento_p text, qt_formula_carb_p bigint, qt_formula_lipideo_p bigint, qt_volume_protocolo_p INOUT bigint, qt_diaria_p INOUT bigint, qt_elem_kg_dia_p INOUT bigint, qt_kcal_p INOUT bigint ) FROM PUBLIC;
