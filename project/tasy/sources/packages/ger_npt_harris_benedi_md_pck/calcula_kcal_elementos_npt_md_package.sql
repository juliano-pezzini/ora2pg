-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE ger_npt_harris_benedi_md_pck.calcula_kcal_elementos_npt_md (qt_limite_litro_p bigint, qt_peso_p bigint, ie_tipo_elemento_p text, qt_formula_carb_p bigint, qt_formula_lipideo_p bigint, qt_conversao_ml_p bigint, cd_unidade_medida_elem_p text, cd_unidade_medida_prod_p text, ie_somar_volume_p text, qt_diaria_p INOUT bigint, qt_elem_kg_dia_p INOUT bigint, qt_kcal_p INOUT bigint, qt_dose_diaria_p INOUT bigint, qt_vol_diaria_p INOUT bigint, pr_conc_glic_solucao_p INOUT bigint, qt_kcal_carboidrato_p INOUT bigint, qt_vel_inf_glicose_p INOUT bigint, pr_conc_proteina_solucao_p INOUT bigint, qt_kcal_proteina_p INOUT bigint, pr_conc_lipidio_solucao_p INOUT bigint, qt_kcal_lipidio_p INOUT bigint, qt_volume_total_p INOUT bigint ) AS $body$
BEGIN
		if (qt_limite_litro_p IS NOT NULL AND qt_limite_litro_p::text <> '') then
			qt_diaria_p        := qt_limite_litro_p;
			qt_elem_kg_dia_p   := dividir_sem_round_md(qt_diaria_p,qt_peso_p);
			qt_kcal_p 	  	   := 0;
			
			if (ie_tipo_elemento_p = 'C') then
				pr_conc_glic_solucao_p := qt_diaria_p;
				qt_kcal_p              := qt_diaria_p * qt_formula_carb_p;
				qt_kcal_carboidrato_p  := qt_kcal_p;
				qt_vel_inf_glicose_p   := dividir_sem_round_md(qt_elem_kg_dia_p,1.44);
			
			elsif (ie_tipo_elemento_p = 'P') then
        pr_conc_proteina_solucao_p := qt_diaria_p;
				qt_kcal_p                  := qt_diaria_p * 4;
				qt_kcal_proteina_p         := qt_kcal_p;
			
			elsif (ie_tipo_elemento_p = 'L') then
				pr_conc_lipidio_solucao_p := qt_diaria_p;
				qt_kcal_p                 := qt_diaria_p * qt_formula_lipideo_p;
				qt_kcal_lipidio_p         := qt_kcal_p;	
			end if;
			
			if (cd_unidade_medida_elem_p = cd_unidade_medida_prod_p) then
				qt_dose_diaria_p 	:= qt_diaria_p;
				qt_vol_diaria_p   := qt_diaria_p;
			else
				qt_dose_diaria_p 	:= qt_diaria_p * qt_conversao_ml_p;
				qt_vol_diaria_p	  := qt_diaria_p * qt_conversao_ml_p;
			end if;
		end if;
		
		if (ie_somar_volume_p = 'S') then
      qt_volume_total_p := qt_volume_total_p + qt_dose_diaria_p;
		end if;
		--FIM MD 10
	end;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE ger_npt_harris_benedi_md_pck.calcula_kcal_elementos_npt_md (qt_limite_litro_p bigint, qt_peso_p bigint, ie_tipo_elemento_p text, qt_formula_carb_p bigint, qt_formula_lipideo_p bigint, qt_conversao_ml_p bigint, cd_unidade_medida_elem_p text, cd_unidade_medida_prod_p text, ie_somar_volume_p text, qt_diaria_p INOUT bigint, qt_elem_kg_dia_p INOUT bigint, qt_kcal_p INOUT bigint, qt_dose_diaria_p INOUT bigint, qt_vol_diaria_p INOUT bigint, pr_conc_glic_solucao_p INOUT bigint, qt_kcal_carboidrato_p INOUT bigint, qt_vel_inf_glicose_p INOUT bigint, pr_conc_proteina_solucao_p INOUT bigint, qt_kcal_proteina_p INOUT bigint, pr_conc_lipidio_solucao_p INOUT bigint, qt_kcal_lipidio_p INOUT bigint, qt_volume_total_p INOUT bigint ) FROM PUBLIC;
