-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE param_recalculo_conta_pck.set_parametro (cd_funcao_p bigint, nr_sequencia_p bigint, cd_perfil_p bigint, nm_usuario_p text, cd_estabelecimento_p bigint, vl_default_p text) AS $body$
BEGIN
		PERFORM set_config('param_recalculo_conta_pck.ie_achou_w', 'N', false);
		for current_setting('param_recalculo_conta_pck.j')::integer in 1..parametros_w.count loop
			if (current_setting('param_recalculo_conta_pck.parametros_w')::Vetor(current_setting('param_recalculo_conta_pck.j')::integer).cd_funcao = cd_funcao_p) and (current_setting('param_recalculo_conta_pck.parametros_w')::Vetor(current_setting('param_recalculo_conta_pck.j')::integer).nr_sequencia = nr_sequencia_p) and (current_setting('param_recalculo_conta_pck.parametros_w')::Vetor(current_setting('param_recalculo_conta_pck.j')::integer).cd_perfil = cd_perfil_p) and (current_setting('param_recalculo_conta_pck.parametros_w')::Vetor(current_setting('param_recalculo_conta_pck.j')::integer).nm_usuario = nm_usuario_p) and (current_setting('param_recalculo_conta_pck.parametros_w')::Vetor(current_setting('param_recalculo_conta_pck.j')::integer).cd_estabelecimento = cd_estabelecimento_p) then
				PERFORM set_config('param_recalculo_conta_pck.ie_achou_w', 'S', false);
				current_setting('param_recalculo_conta_pck.parametros_w')::Vetor(current_setting('param_recalculo_conta_pck.j')::integer).vl_parametro 	   := coalesce(Obter_valor_param_usuario(cd_funcao_p, nr_sequencia_p, cd_perfil_p, nm_usuario_p, cd_estabelecimento_p),vl_default_p);
			end if;
		end loop;

		if (current_setting('param_recalculo_conta_pck.ie_achou_w')::varchar(1) = 'N') then

			PERFORM set_config('param_recalculo_conta_pck.i', coalesce(current_setting('param_recalculo_conta_pck.parametros_w')::Vetor.Count,0) + 1, false);
			current_setting('param_recalculo_conta_pck.parametros_w')::Vetor(current_setting('param_recalculo_conta_pck.i')::integer).cd_funcao  	   := cd_funcao_p;
			current_setting('param_recalculo_conta_pck.parametros_w')::Vetor(current_setting('param_recalculo_conta_pck.i')::integer).nr_sequencia  	   := nr_sequencia_p;
			current_setting('param_recalculo_conta_pck.parametros_w')::Vetor(current_setting('param_recalculo_conta_pck.i')::integer).cd_perfil  	   := cd_perfil_p;
			current_setting('param_recalculo_conta_pck.parametros_w')::Vetor(current_setting('param_recalculo_conta_pck.i')::integer).nm_usuario 	   := nm_usuario_p;
			current_setting('param_recalculo_conta_pck.parametros_w')::Vetor(current_setting('param_recalculo_conta_pck.i')::integer).cd_estabelecimento := cd_estabelecimento_p;
			current_setting('param_recalculo_conta_pck.parametros_w')::Vetor(current_setting('param_recalculo_conta_pck.i')::integer).vl_parametro 	   := coalesce(Obter_valor_param_usuario(cd_funcao_p, nr_sequencia_p, cd_perfil_p, nm_usuario_p, cd_estabelecimento_p),vl_default_p);
		end if;

	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE param_recalculo_conta_pck.set_parametro (cd_funcao_p bigint, nr_sequencia_p bigint, cd_perfil_p bigint, nm_usuario_p text, cd_estabelecimento_p bigint, vl_default_p text) FROM PUBLIC;
