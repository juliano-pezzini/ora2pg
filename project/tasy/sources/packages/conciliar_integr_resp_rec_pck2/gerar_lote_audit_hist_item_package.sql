-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE conciliar_integr_resp_rec_pck2.gerar_lote_audit_hist_item ( nr_seq_res_recurso_guia_p imp_resp_recurso_guia.nr_sequencia%type, nr_seq_lote_hist_p lote_audit_hist.nr_sequencia%type, nr_seq_lote_guia_p lote_audit_hist_guia.nr_sequencia%type ) AS $body$
DECLARE


current_setting('conciliar_integr_resp_rec_pck2.i')::integer                   integer := 0;


BEGIN
FOR current_setting('conciliar_integr_resp_rec_pck2.i')::integer IN 0..campos_itens_w.count - 1 LOOP

    if (current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).ie_status = 'C') then
     
        insert	into lote_audit_hist_item(
                                nr_sequencia,
                                nm_usuario,
                                nm_usuario_nrec,
                                dt_atualizacao,
                                dt_atualizacao_nrec,
                                dt_historico,
                                dt_integracao,
                                nr_seq_lote,
                                nr_seq_guia,		
                                cd_motivo_glosa_tiss,
                                cd_motivo_glosa,
                                nr_seq_matpaci,
                                nr_seq_propaci,
                                nr_seq_partic,
                                cd_setor_responsavel,
                                cd_setor_atendimento,
                                ds_justificativa_oper,
                                ds_observacao,
                                qt_item,
                                vl_acatado,
                                vl_glosa,
                                vl_glosa_informada,
                                ie_acao_glosa,
                                nm_usuario_resp)
                                values (
                                nextval('lote_audit_hist_item_seq'),
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).nm_usuario,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).nm_usuario_nrec,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).dt_atualizacao,	
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).dt_atualizacao_nrec,
                                clock_timestamp(),
                                clock_timestamp(),
                                nr_seq_lote_hist_p,
                                nr_seq_lote_guia_p,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).cd_motivo_glosa_tiss,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).cd_glosa,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).nr_seq_matpaci,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).nr_seq_propaci,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).nr_seq_propaci_partic,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).cd_setor_responsavel,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).cd_setor_exec,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).ds_justificativa_operadora,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).ds_justificativa_prestador,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).qt_glosada,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).vl_acatado,	
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).vl_glosa_aceita,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).vl_informado,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).ie_acao_glosa,
                                current_setting('conciliar_integr_resp_rec_pck2.campos_itens_w')::campos_itens_v(current_setting('conciliar_integr_resp_rec_pck2.i')::integer).nm_usuario_responsavel
                                );        	
    end if;
END LOOP;
commit;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE conciliar_integr_resp_rec_pck2.gerar_lote_audit_hist_item ( nr_seq_res_recurso_guia_p imp_resp_recurso_guia.nr_sequencia%type, nr_seq_lote_hist_p lote_audit_hist.nr_sequencia%type, nr_seq_lote_guia_p lote_audit_hist_guia.nr_sequencia%type ) FROM PUBLIC;
