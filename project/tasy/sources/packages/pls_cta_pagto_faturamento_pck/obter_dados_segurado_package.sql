-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pls_cta_pagto_faturamento_pck.obter_dados_segurado ( nr_seq_segurado_p pls_segurado.nr_sequencia%type) RETURNS TABLE_DADOS_SEGURADO AS $body$
DECLARE

dados_seg_w	table_dados_segurado;
							

BEGIN
	select	max(nr_seq_plano),
		max(nr_seq_contrato),
		max(nr_seq_intercambio),
		max(dt_contratacao),
		obter_idade_pf(cd_pessoa_fisica,clock_timestamp(),'A'),
		CASE WHEN coalesce(nr_seq_titular::text, '') = '' THEN 'T'  ELSE 'D' END
	into STRICT	dados_seg_w.nr_seq_plano,
		dados_seg_w.nr_seq_contrato,
		dados_seg_w.nr_seq_intercambio,
		dados_seg_w.dt_contratacao,
		dados_seg_w.qt_idade,
		dados_seg_w.ie_titularidade
	from	pls_segurado
	where	nr_sequencia	= nr_seq_segurado_p;
	
return dados_seg_w;
	
END;

$body$
LANGUAGE PLPGSQL
 STABLE;
-- REVOKE ALL ON FUNCTION pls_cta_pagto_faturamento_pck.obter_dados_segurado ( nr_seq_segurado_p pls_segurado.nr_sequencia%type) FROM PUBLIC;
