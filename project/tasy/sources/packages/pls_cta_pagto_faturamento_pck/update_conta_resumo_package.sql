-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_cta_pagto_faturamento_pck.update_conta_resumo ( tb_dados_p table_dados_pagto_fat) AS $body$
BEGIN

if (tb_dados_p.nr_seq_conta.count > 0) then
	
	forall i in tb_dados_p.nr_seq_conta.first..tb_dados_p.nr_seq_conta.last
		update	pls_conta_medica_resumo
		set	vl_liberado		= tb_dados_p.vl_liberado(i),
			vl_lib_original		= tb_dados_p.vl_lib_original(i),
			ds_tipo_item		= tb_dados_p.ds_tipo_item(i),
			nr_seq_prestador_pgto	= tb_dados_p.nr_seq_prestador_pagto(i),
			nm_prestador_pgto	= tb_dados_p.nm_prestador_pgto(i),
			vl_co_pag		= tb_dados_p.vl_co_pag(i),
			vl_hm			= tb_dados_p.vl_hm(i),
			vl_materiais_pag	= tb_dados_p.vl_material_pag(i),
			qt_item			= CASE WHEN tb_dados_p.qt_item(i) = NULL THEN  qt_item  ELSE tb_dados_p.qt_item(i) END
		where	nr_seq_conta		= tb_dados_p.nr_seq_conta(i)
		and	nr_seq_item		= tb_dados_p.nr_seq_item(i)
		and	coalesce(nr_seq_exame_coleta::text, '') = ''
		and	ie_situacao = 'A';
	commit;
end if;

END;

$body$
LANGUAGE PLPGSQL
;
-- REVOKE ALL ON PROCEDURE pls_cta_pagto_faturamento_pck.update_conta_resumo ( tb_dados_p table_dados_pagto_fat) FROM PUBLIC;
