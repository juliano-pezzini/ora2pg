-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pkg_icones_graf_cirurgia.get_icones ( nr_seq_modelo_p bigint, nr_cirurgia_p bigint, nr_seq_pepo_p bigint ) RETURNS SETOF TABLE_ICONE_TYPE AS $body$
DECLARE


     C_ICONES CURSOR FOR

     SELECT distinct 1 NR_SEQUENCE,
                SUBSTR(OBTER_DESC_EXPRESSAO(330479), 1, 50) DS_LEGEND,
                'icons/status-and-feedback/intravenous-clock-yellow.svg' DS_PATH,
                a.nr_sequencia ID_GROUP,
                SUBSTR(a.DS_TITULO, 1, 50) DS_GROUP
      FROM pepo_modelo_secao a
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (a.nr_sequencia = b.nr_seq_modelo_secao AND a.nr_seq_modelo = b.nr_seq_modelo)
, wheb_usuario_pck
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (wheb_usuario_pck.get_nm_usuario = b.nm_usuario)
WHERE a.nr_seq_modelo = nr_seq_modelo_p and a.cd_secao = 'DV'      and coalesce(coalesce(b.ie_modo_visualizacao, a.ie_modo_visualizacao), 'VI') <> 'IV'
     
union all

    SELECT distinct 2 NR_SEQUENCE,
                    SUBSTR(OBTER_DESC_EXPRESSAO(490155), 1, 50) DS_LEGEND,
                    'icons/status-and-feedback/intravenous-arrow-up.svg' DS_PATH,
                    a.nr_sequencia ID_GROUP,
                    SUBSTR(a.DS_TITULO, 1, 50) DS_GROUP
      FROM pepo_modelo_secao a
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (a.nr_sequencia = b.nr_seq_modelo_secao AND a.nr_seq_modelo = b.nr_seq_modelo)
, wheb_usuario_pck
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (wheb_usuario_pck.get_nm_usuario = b.nm_usuario)
WHERE a.nr_seq_modelo = nr_seq_modelo_p and a.cd_secao = 'DV'      and coalesce(coalesce(b.ie_modo_visualizacao, a.ie_modo_visualizacao), 'VI') <> 'IV'
     
union all

    select distinct 3 NR_SEQUENCE,
                    SUBSTR(OBTER_DESC_EXPRESSAO(607205), 1, 50) DS_LEGEND,
                    'icons/status-and-feedback/intravenous-cancel.svg' DS_PATH,
                    a.nr_sequencia ID_GROUP,
                    SUBSTR(a.DS_TITULO, 1, 50) DS_GROUP
      FROM pepo_modelo_secao a
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (a.nr_sequencia = b.nr_seq_modelo_secao AND a.nr_seq_modelo = b.nr_seq_modelo)
, wheb_usuario_pck
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (wheb_usuario_pck.get_nm_usuario = b.nm_usuario)
WHERE a.nr_seq_modelo = nr_seq_modelo_p and a.cd_secao = 'DV'      and coalesce(coalesce(b.ie_modo_visualizacao, a.ie_modo_visualizacao), 'VI') <> 'IV'
     
union all

    select distinct 4 NR_SEQUENCE,
                    SUBSTR(OBTER_DESC_EXPRESSAO(330951), 1, 50) DS_LEGEND,
                    'icons/status-and-feedback/intravenous-minor-warning.svg' DS_PATH,
                    a.nr_sequencia ID_GROUP,
                    SUBSTR(a.DS_TITULO, 1, 50) DS_GROUP
      FROM pepo_modelo_secao a
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (a.nr_sequencia = b.nr_seq_modelo_secao AND a.nr_seq_modelo = b.nr_seq_modelo)
, wheb_usuario_pck
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (wheb_usuario_pck.get_nm_usuario = b.nm_usuario)
WHERE a.nr_seq_modelo = nr_seq_modelo_p and a.cd_secao = 'DV'      and coalesce(coalesce(b.ie_modo_visualizacao, a.ie_modo_visualizacao), 'VI') <> 'IV'
     
union all

    select distinct 5 NR_SEQUENCE,
                    SUBSTR(OBTER_DESC_EXPRESSAO(331555), 1, 50) DS_LEGEND,
                    'icons/status-and-feedback/intravenous-circle.svg' DS_PATH,
                    a.nr_sequencia ID_GROUP,
                    SUBSTR(a.DS_TITULO, 1, 50) DS_GROUP
      FROM pepo_modelo_secao a
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (a.nr_sequencia = b.nr_seq_modelo_secao AND a.nr_seq_modelo = b.nr_seq_modelo)
, wheb_usuario_pck
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (wheb_usuario_pck.get_nm_usuario = b.nm_usuario)
WHERE a.nr_seq_modelo = nr_seq_modelo_p and a.cd_secao = 'DV'      and coalesce(coalesce(b.ie_modo_visualizacao, a.ie_modo_visualizacao), 'VI') <> 'IV'
     
union all

    select distinct 6 NR_SEQUENCE,
                    SUBSTR(OBTER_DESC_EXPRESSAO(289110), 1, 50) DS_LEGEND,
                    'icons/status-and-feedback/intravenous-partial.svg' DS_PATH,
                    a.nr_sequencia ID_GROUP,
                    SUBSTR(a.DS_TITULO, 1, 50) DS_GROUP
      FROM pepo_modelo_secao a
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (a.nr_sequencia = b.nr_seq_modelo_secao AND a.nr_seq_modelo = b.nr_seq_modelo)
, wheb_usuario_pck
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (wheb_usuario_pck.get_nm_usuario = b.nm_usuario)
WHERE a.nr_seq_modelo = nr_seq_modelo_p and a.cd_secao = 'DV'      and coalesce(coalesce(b.ie_modo_visualizacao, a.ie_modo_visualizacao), 'VI') <> 'IV'
	 
union all

	select distinct 11 NR_SEQUENCE,
                    SUBSTR(OBTER_DESC_EXPRESSAO(309544), 1, 50) DS_LEGEND,
                    'icons/status-and-feedback/bandage-clock.svg' DS_PATH,
                    a.nr_sequencia ID_GROUP,
                    SUBSTR(a.DS_TITULO, 1, 50) DS_GROUP
      FROM pepo_modelo_secao a
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (a.nr_sequencia = b.nr_seq_modelo_secao AND a.nr_seq_modelo = b.nr_seq_modelo)
, wheb_usuario_pck
LEFT OUTER JOIN w_flowsheet_config_grupo b ON (wheb_usuario_pck.get_nm_usuario = b.nm_usuario)
WHERE a.nr_seq_modelo = nr_seq_modelo_p and a.cd_secao = 'DV'      and coalesce(coalesce(b.ie_modo_visualizacao, a.ie_modo_visualizacao), 'VI') <> 'IV'
      
union all

    SELECT 7 NR_SEQUENCE,
           SUBSTR(OBTER_DESC_EXPRESSAO(971365), 1, 50),
           'icons/status-and-feedback/pump-check.svg' DS_PATH,
           NULL ID_GROUP,
           SUBSTR(OBTER_DESC_EXPRESSAO(726929), 1, 50)
      
     
union all

    SELECT 8,
           SUBSTR(OBTER_DESC_EXPRESSAO(971363), 1, 50),
           'icons/status-and-feedback/pump-warning-minor.svg',
           null,
           SUBSTR(OBTER_DESC_EXPRESSAO(726929), 1, 50)
      
     
union all

    SELECT 9,
           SUBSTR(OBTER_DESC_EXPRESSAO(971367), 1, 50),
           'icons/status-and-feedback/pump-cancel.svg',
           null,
           SUBSTR(OBTER_DESC_EXPRESSAO(726929), 1, 50)
      
     
union all

    SELECT 10,
           SUBSTR(OBTER_DESC_EXPRESSAO(971534), 1, 50),
           'icons/status-and-feedback/pump-interrogation.svg',
           null,
           SUBSTR(OBTER_DESC_EXPRESSAO(726929), 1, 50)
;

     TYPE T_ICONES IS TABLE OF C_ICONES%ROWTYPE;
     R_ICONES T_ICONES;

    
BEGIN
      OPEN C_ICONES;
      LOOP
        FETCH C_ICONES BULK COLLECT INTO R_ICONES LIMIT 1000;

          BEGIN
            FOR i IN R_ICONES.FIRST..R_ICONES.LAST LOOP
              RETURN NEXT R_ICONES(i);
            END LOOP;
          EXCEPTION WHEN OTHERS THEN
            NULL;
          END;

        EXIT WHEN NOT FOUND; /* apply on C_ICONES */

      END LOOP;
      CLOSE C_ICONES;
      RETURN;
    END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pkg_icones_graf_cirurgia.get_icones ( nr_seq_modelo_p bigint, nr_cirurgia_p bigint, nr_seq_pepo_p bigint ) FROM PUBLIC;
