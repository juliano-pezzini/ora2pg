-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION wheb_seguranca.gerar_chave () RETURNS bytea AS $body$
DECLARE

	numero_w 	bigint;
	ds_semente_w 	varchar(16);
	
BEGIN
		SELECT (TO_CHAR(clock_timestamp(),'HH24'))::numeric  + (TO_CHAR(clock_timestamp(),'MI'))::numeric
		INTO STRICT numero_w
		;
		DBMS_RANDOM.INITIALIZE(numero_w);
		select  substr(to_char(sum(b.value)) || to_char(clock_timestamp(),'SSSSS'),1,16)
		into STRICT	ds_semente_w
		from  	v$statname a,
			V$SESSTAT b
		where  	a.statistic#=b.statistic#
		and 	a.name in ('db block gets','consistent gets');

		while(length(ds_semente_w) < 16) loop
			begin
				ds_semente_w := ds_semente_w || '1';
			end;
		end loop;
		return encode(ds_semente_w::bytea, 'hex')::bytea;
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION wheb_seguranca.gerar_chave () FROM PUBLIC;
