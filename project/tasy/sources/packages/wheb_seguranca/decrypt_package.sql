-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION wheb_seguranca.decrypt (texto_cript_p bytea) RETURNS varchar AS $body$
DECLARE

	l_decrypted_w  	varchar(32767);
	g_key_w        	bytea;
	ds_chave_w	bytea;
	texto_cript_w	bytea;
	
BEGIN
		if (texto_cript_p IS NOT NULL AND texto_cript_p::text <> '') then
			ds_chave_w 	:= substr(texto_cript_p,1,14) || substr(texto_cript_p,length(texto_cript_p)-13,14);
			texto_cript_w	:= substr(texto_cript_p,15,length(texto_cript_p)-28);
			g_key_w	:= encode(ds_chave_w::bytea, 'hex')::bytea;
			DBMS_OBFUSCATION_toolkit.desdecrypt(input          	=> texto_cript_w,
							        key		=> g_key_w,
	                                  	           	 decrypted_data	=> l_decrypted_w);
			RETURN RTrim(UTL_RAW.cast_to_varchar2(l_decrypted_w), current_setting('wheb_seguranca.g_pad_chr')::varchar(1));
		else
			RETURN null;
		end if;
	END;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION wheb_seguranca.decrypt (texto_cript_p bytea) FROM PUBLIC;
