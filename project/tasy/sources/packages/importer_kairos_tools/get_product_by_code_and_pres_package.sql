-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION importer_kairos_tools.get_product_by_code_and_pres ( cd_internal_p MATERIAL_GLOBAL.CD_INTERNO%type, cd_unit_p UNIDADE_MEDIDA_MATGLOBAL.CD_UNIDADE%type ) RETURNS varchar AS $body$
DECLARE

cd_material_glo_w	MATERIAL_GLOBAL.CD_INTERNO%type;

BEGIN
	SELECT 	MAX(a.CD_MATERIAL_GLO)
	INTO STRICT 	cd_material_glo_w
	FROM	MATERIAL_GLOBAL a
	WHERE	CD_INTERNO = cd_internal_p
	AND (CD_UNIDADE = cd_unit_p OR coalesce(CD_UNIDADE::text, '') = '');

	return cd_material_glo_w;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION importer_kairos_tools.get_product_by_code_and_pres ( cd_internal_p MATERIAL_GLOBAL.CD_INTERNO%type, cd_unit_p UNIDADE_MEDIDA_MATGLOBAL.CD_UNIDADE%type ) FROM PUBLIC;
