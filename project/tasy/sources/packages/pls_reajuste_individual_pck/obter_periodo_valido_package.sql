-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pls_reajuste_individual_pck.obter_periodo_valido () RETURNS varchar AS $body$
DECLARE

					
ie_retorno_w			varchar(1) := 'N';
dt_base_w			timestamp;


BEGIN

if (nr_seq_grupo_reajuste_p IS NOT NULL AND nr_seq_grupo_reajuste_p::text <> '') then
	if (current_setting('pls_reajuste_individual_pck.pls_reajuste_w')::pls_reajuste%rowtype.dt_reajuste > trunc(dt_contratacao_p, 'mm')) then
		ie_retorno_w	:= 'S';
	end if;
else
	if (ie_reajuste_p = 'C') then
		dt_base_w	:= add_months(dt_contrato_p, qt_intervalo_p);
	else
		dt_base_w	:= add_months(dt_contratacao_p, qt_intervalo_p);
	end if;
	
	if (current_setting('pls_reajuste_individual_pck.pls_reajuste_w')::pls_reajuste%rowtype.dt_reajuste >= trunc(dt_base_w, 'mm')) then
		ie_retorno_w	:= 'S';
	end if;
end if;

return	ie_retorno_w;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pls_reajuste_individual_pck.obter_periodo_valido () FROM PUBLIC;
