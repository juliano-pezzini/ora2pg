-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE holding_pck.set_grupo_emp_estrut ( cd_empresa_p bigint) AS $body$
DECLARE

  c_emp CURSOR FOR
  SELECT  a.cd_empresa,
    b.cd_estabelecimento
  from  grupo_emp_estrutura a,
    estabelecimento b
  where  a.nr_seq_grupo  =  holding_pck.get_grupo_emp_estrut_vigente(cd_empresa_p)
  and  a.cd_empresa  =  b.cd_empresa;

  i bigint;

BEGIN
  current_setting('holding_pck.grupo_emp_usu_val')::grupo_empresa_usu_t.delete;
  i := 1;
  for r_emp  in  c_emp loop
    current_setting('holding_pck.grupo_emp_usu_val')::grupo_empresa_usu_t[i].cd_empresa    :=  r_emp.cd_empresa;
    current_setting('holding_pck.grupo_emp_usu_val')::grupo_empresa_usu_t[i].cd_estabelecimento  :=  r_emp.cd_estabelecimento;
    i  :=  i + 1;
  end loop;
END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE holding_pck.set_grupo_emp_estrut ( cd_empresa_p bigint) FROM PUBLIC;
