-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION holding_pck.get_emp_controladora_grupo ( cd_grupo_emp_p grupo_empresa.nr_sequencia%type, cd_empresa_p empresa.cd_empresa%type default null) RETURNS bigint AS $body$
DECLARE


cd_emp_controladora_w  empresa.cd_empresa%type;
cd_grupo_emp_w          grupo_empresa.nr_sequencia%type;


BEGIN

  cd_grupo_emp_w := cd_grupo_emp_p;

  if (coalesce(cd_empresa_p,0) <> 0) then
    cd_grupo_emp_w := holding_pck.get_grupo_emp_estrut_vigente(cd_empresa_p);
  end if;

  begin
    select  max(a.cd_empresa)
    into STRICT    cd_emp_controladora_w
    from    grupo_emp_estrutura a
    where   a.nr_seq_grupo = cd_grupo_emp_w
    and     a.ie_tipo_estrutura = 1;
  exception
    when others then
      cd_emp_controladora_w := 0;
  end;

  return coalesce(cd_emp_controladora_w,0);

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION holding_pck.get_emp_controladora_grupo ( cd_grupo_emp_p grupo_empresa.nr_sequencia%type, cd_empresa_p empresa.cd_empresa%type default null) FROM PUBLIC;
