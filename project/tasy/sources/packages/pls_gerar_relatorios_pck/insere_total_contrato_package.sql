-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_gerar_relatorios_pck.insere_total_contrato () AS $body$
BEGIN
	tb_gerar_relatorio_2995_w.ds_estipulante	:= null;
	tb_gerar_relatorio_2995_w.nr_contrato		:= null;
	tb_gerar_relatorio_2995_w.ds_mes_competencia	:= 'Subtotal';
	tb_gerar_relatorio_2995_w.qt_usuarios		:= (coalesce(qt_usuarios_contr_w,0)/coalesce(qt_meses_contr_w,1));
	tb_gerar_relatorio_2995_w.vl_total_custo	:= vl_total_custo_contr_w;
	tb_gerar_relatorio_2995_w.vl_custo_adm		:= vl_custo_adm_contr_w;
	tb_gerar_relatorio_2995_w.vl_custo_assist	:= vl_custo_assist_contr_w;
	tb_gerar_relatorio_2995_w.vl_coparticipacao	:= vl_coparticipacao_contr_w;
	tb_gerar_relatorio_2995_w.vl_total_receitas	:= vl_total_receitas_contr_w;
	tb_gerar_relatorio_2995_w.vl_total_despesas	:= vl_total_despesas_contr_w;
	tb_gerar_relatorio_2995_w.pr_resultado		:= pls_obter_perc_result(vl_total_receitas_contr_w, vl_total_receitas_contr_w - vl_total_despesas_contr_w);
	tb_gerar_relatorio_2995_w.vl_media_receitas	:= vl_media_receitas_contr_w;
	tb_gerar_relatorio_2995_w.vl_media_custos	:= vl_media_custos_contr_w;
	tb_gerar_relatorio_2995_w.pr_sinistralidade	:= dividir_sem_round(vl_total_despesas_contr_w, vl_total_receitas_contr_w) * 100;
	 
	vl_total_custo_w 		:= vl_total_custo_w + vl_total_custo_contr_w;
	vl_total_custo_adm_w 		:= vl_total_custo_adm_w + vl_custo_adm_contr_w;
	vl_total_custo_assist_w		:= vl_total_custo_assist_w + vl_custo_assist_contr_w;
	vl_total_coparticipacao_w	:= vl_total_coparticipacao_w + vl_coparticipacao_contr_w;
	vl_total_receitas_w		:= vl_total_receitas_w + vl_total_receitas_contr_w;
	vl_total_despesas_w		:= vl_total_despesas_w + vl_total_despesas_contr_w;
	vl_total_media_receitas_w	:= vl_total_media_receitas_w + vl_media_receitas_contr_w;
	vl_total_media_custos_w		:= vl_total_media_custos_w + vl_media_custos_contr_w;
	qt_total_usuarios_w		:= qt_total_usuarios_w + qt_usuarios_contr_w;
	qt_total_meses_contr_w		:= qt_total_meses_contr_w + qt_meses_contr_w;
	END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_gerar_relatorios_pck.insere_total_contrato () FROM PUBLIC;
