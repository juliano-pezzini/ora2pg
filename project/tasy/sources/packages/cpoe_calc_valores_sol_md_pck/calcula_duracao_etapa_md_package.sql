-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE cpoe_calc_valores_sol_md_pck.calcula_duracao_etapa_md (qt_duracao_diferenciada_p INOUT text, ie_div_padrao_p text, qt_dosagem_p bigint, ie_div_horario_p text, qt_duracao_etapa_p INOUT bigint, ds_horarios_valor_p INOUT text, ds_horarios_p INOUT text, qt_volume_etapa_p INOUT bigint ) AS $body$
DECLARE


    posicao_w    integer     := 0;
    ds_duracao_w varchar(5) := null;

BEGIN
    posicao_w	:= position(ie_div_padrao_p in qt_duracao_diferenciada_p);

    ds_duracao_w	:= coalesce(substr(qt_duracao_diferenciada_p,1,posicao_w-1),qt_dosagem_p);
    if (coalesce(trim(both ds_duracao_w),'__:__') = '__:__') then
      qt_duracao_etapa_p	:= 0;
    else
      qt_duracao_etapa_p	:= dividir_sem_round_md(obter_minutos_hora_md(lpad(substr(ds_duracao_w,1,2),2,'0')||':'||rpad(substr(ds_duracao_w,4),2,'0')),60);
    end if;

    qt_duracao_diferenciada_p	:= substr(qt_duracao_diferenciada_p, posicao_w+1);

    posicao_w            := position(ie_div_horario_p in ds_horarios_p);			
    ds_horarios_valor_p  := substr(ds_horarios_p,1,posicao_w-1);			
    ds_horarios_p        := substr(ds_horarios_p, posicao_w+1);

    qt_volume_etapa_p	:= 0;
  end;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE cpoe_calc_valores_sol_md_pck.calcula_duracao_etapa_md (qt_duracao_diferenciada_p INOUT text, ie_div_padrao_p text, qt_dosagem_p bigint, ie_div_horario_p text, qt_duracao_etapa_p INOUT bigint, ds_horarios_valor_p INOUT text, ds_horarios_p INOUT text, qt_volume_etapa_p INOUT bigint ) FROM PUBLIC;
