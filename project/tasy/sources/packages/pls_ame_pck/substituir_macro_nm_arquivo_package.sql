-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pls_ame_pck.substituir_macro_nm_arquivo ( nm_arquivo_p pls_ame_regra_ger_arq.nm_arquivo%type, dt_mensalidade_p timestamp, dt_copartic_p timestamp, nr_seq_lote_p pls_ame_lote_remessa.nr_sequencia%type, dt_lote_p pls_ame_lote_remessa.dt_lote%type) RETURNS varchar AS $body$
DECLARE


nm_arquivo_w		pls_ame_regra_ger_arq.nm_arquivo%type;

BEGIN

nm_arquivo_w		:= nm_arquivo_p;
nm_arquivo_w		:= replace(nm_arquivo_w,'#@NR_MES_ATUAL#@',to_char(clock_timestamp(),'MM'));
nm_arquivo_w		:= replace(nm_arquivo_w,'#@NR_MES_MENS#@',to_char(dt_mensalidade_p,'MM'));
nm_arquivo_w		:= replace(nm_arquivo_w,'#@NR_MES_COPARTIC#@',to_char(dt_copartic_p,'MM'));
nm_arquivo_w		:= replace(nm_arquivo_w,'#@NR_ANO_ATUAL#@',to_char(clock_timestamp(),'YY'));
nm_arquivo_w		:= replace(nm_arquivo_w,'#@NR_ANO_MENS#@',to_char(dt_mensalidade_p,'YY'));
nm_arquivo_w		:= replace(nm_arquivo_w,'#@NR_ANO_COPARTIC#@',to_char(dt_copartic_p,'YY'));
nm_arquivo_w		:= replace(nm_arquivo_w,'#@DT_ATUAL#@',to_char(clock_timestamp(),'YYYYMMDD_HH24MISS'));
nm_arquivo_w		:= replace(nm_arquivo_w,'#@NR_LOTE#@',nr_seq_lote_p);
nm_arquivo_w		:= replace(nm_arquivo_w,'#@NR_ANO_ATUAL_YYYY#@',to_char(clock_timestamp(),'YYYY'));
nm_arquivo_w		:= replace(nm_arquivo_w,'#@NR_ANO_LOTE#@',to_char(dt_lote_p,'YYYY'));

return nm_arquivo_w;
end;


$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
 STABLE;
-- REVOKE ALL ON FUNCTION pls_ame_pck.substituir_macro_nm_arquivo ( nm_arquivo_p pls_ame_regra_ger_arq.nm_arquivo%type, dt_mensalidade_p timestamp, dt_copartic_p timestamp, nr_seq_lote_p pls_ame_lote_remessa.nr_sequencia%type, dt_lote_p pls_ame_lote_remessa.dt_lote%type) FROM PUBLIC;
