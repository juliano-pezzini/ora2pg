-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE PROCEDURE pls_ame_pck.importar_arquivo_retorno ( nm_procedure_p pls_ame_regra_retorno.nm_objeto_importacao%type, ds_linha_arquivo_p text, nr_seq_lote_retorno_p pls_ame_lote_retorno.nr_sequencia%type) AS $body$
DECLARE

ds_comando_w	varchar(4000);
current_setting('pls_ame_pck.nm_usuario_w')::usuario.nm_usuario%type	usuario.nm_usuario%type	:= pls_ame_pck.get_nm_usuario();
ds_erro_w	pls_ame_retorno_log_erro.ds_erro%type;


BEGIN
ds_comando_w	:= 'begin ' || nm_procedure_p || '(' || '''' || ds_linha_arquivo_p || ''',' || nr_seq_lote_retorno_p || ',''' || current_setting('pls_ame_pck.nm_usuario_w')::usuario.nm_usuario%type || '''); end;';

begin
EXECUTE ds_comando_w;
exception
when others then
	ds_erro_w	:= substr('Erro: ' || sqlerrm || pls_util_pck.enter_w ||  'Error Back Trace: ' || dbms_utility.format_error_backtrace,1,400);
	CALL pls_ame_pck.gravar_log_erro_imp(nr_seq_lote_retorno_p,ds_erro_w);
end;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE pls_ame_pck.importar_arquivo_retorno ( nm_procedure_p pls_ame_regra_retorno.nm_objeto_importacao%type, ds_linha_arquivo_p text, nr_seq_lote_retorno_p pls_ame_lote_retorno.nr_sequencia%type) FROM PUBLIC;
