-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';




CREATE OR REPLACE FUNCTION pls_ame_pck.retorna_nome_arquivo_ajustado ( nm_arquivo_p text, nr_arquivo_p bigint, ie_nm_arquivo_div_p text) RETURNS varchar AS $body$
DECLARE


posicao_ponto_w			bigint	:= 0;
posicao_ultimo_ponto_w		bigint;
nm_ate_antes_ponto_w		varchar(4000);
nm_posicao_ponto_em_diante_w	varchar(4000);

BEGIN

select	position('.' in nm_arquivo_p)
into STRICT	posicao_ultimo_ponto_w
;

while posicao_ponto_w <> posicao_ultimo_ponto_w loop
	begin

	posicao_ponto_w	:= posicao_ultimo_ponto_w;

	select	coalesce(position('.' in substr(nm_arquivo_p ,posicao_ultimo_ponto_w + 1,length(nm_arquivo_p))) + posicao_ultimo_ponto_w, posicao_ultimo_ponto_w)
	into STRICT	posicao_ultimo_ponto_w
	;

	end;
end loop;

nm_ate_antes_ponto_w		:= substr(nm_arquivo_p, 0, posicao_ultimo_ponto_w - 1);
nm_posicao_ponto_em_diante_w	:= substr(nm_arquivo_p, posicao_ultimo_ponto_w, length(nm_arquivo_p));

if (ie_nm_arquivo_div_p = 'UN') then
	return  nm_ate_antes_ponto_w || '_' || to_char(nr_arquivo_p) || nm_posicao_ponto_em_diante_w;
elsif (ie_nm_arquivo_div_p = 'UL') then
	if (nr_arquivo_p = 1) then
		return nm_ate_antes_ponto_w || '_' || 'A' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 2) then
		return nm_ate_antes_ponto_w || '_' || 'B' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 3) then
		return nm_ate_antes_ponto_w || '_' || 'C' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 4) then
		return nm_ate_antes_ponto_w || '_' || 'D' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 5) then
		return nm_ate_antes_ponto_w || '_' || 'E' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 6) then
		return nm_ate_antes_ponto_w || '_' || 'F' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 7) then
		return nm_ate_antes_ponto_w || '_' || 'G' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 8) then
		return nm_ate_antes_ponto_w || '_' || 'H' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 9) then
		return nm_ate_antes_ponto_w || '_' || 'I' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 10) then
		return nm_ate_antes_ponto_w || '_' || 'J' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 11) then
		return nm_ate_antes_ponto_w || '_' || 'K' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 12) then
		return nm_ate_antes_ponto_w || '_' || 'L' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 13) then
		return nm_ate_antes_ponto_w || '_' || 'M' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 14) then
		return nm_ate_antes_ponto_w || '_' || 'N' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 15) then
		return nm_ate_antes_ponto_w || '_' || 'O' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 16) then
		return nm_ate_antes_ponto_w || '_' || 'P' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 17) then
		return nm_ate_antes_ponto_w || '_' || 'Q' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 18) then
		return nm_ate_antes_ponto_w || '_' || 'R' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 19) then
		return nm_ate_antes_ponto_w || '_' || 'S' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 20) then
		return nm_ate_antes_ponto_w || '_' || 'T' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 21) then
		return nm_ate_antes_ponto_w || '_' || 'U' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 22) then
		return nm_ate_antes_ponto_w || '_' || 'V' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 23) then
		return nm_ate_antes_ponto_w || '_' || 'W' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 24) then
		return nm_ate_antes_ponto_w || '_' || 'X' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 25) then
		return nm_ate_antes_ponto_w || '_' || 'Y' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p = 26) then
		return nm_ate_antes_ponto_w || '_' || 'Z' || nm_posicao_ponto_em_diante_w;
	elsif (nr_arquivo_p > 26) then
		return nm_ate_antes_ponto_w || '_' || 'Z' || to_char(nr_arquivo_p - 26) || nm_posicao_ponto_em_diante_w;
	end if;
end if;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON FUNCTION pls_ame_pck.retorna_nome_arquivo_ajustado ( nm_arquivo_p text, nr_arquivo_p bigint, ie_nm_arquivo_div_p text) FROM PUBLIC;
