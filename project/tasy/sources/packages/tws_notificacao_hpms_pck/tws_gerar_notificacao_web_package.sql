-- Generated by Ora2Pg, the Oracle database Schema converter, version 23.1
-- Copyright 2000-2022 Gilles DAROLD. All rights reserved.
-- DATASOURCE: dbi:Oracle:host=srv-dbora-03.whebdc.com.br;service_name=DEV_1815;port=1521

SET client_encoding TO 'UTF8';

/* +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
Finalidade: Deve ser utilizado para gravar as notificacoes pelos processos.
++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ */
CREATE OR REPLACE PROCEDURE tws_notificacao_hpms_pck.tws_gerar_notificacao_web ( ie_tipo_processo_p pls_notificacao_tws.ie_tipo_processo%type, ie_aplicacao_p pls_notificacao_tws.ie_aplicacao%type, ds_titulo_p pls_notificacao_tws.ds_titulo%type, ds_texto_p pls_notificacao_tws.ds_texto%type, nr_seq_conta_p pls_conta.nr_sequencia%type, nr_seq_prestador_p pls_prestador.nr_sequencia%type, nr_seq_segurado_p pls_segurado.nr_sequencia%type, nr_seq_wsuite_usuario_p wsuite_usuario.nr_sequencia%type, nm_usuario_p usuario.nm_usuario%type) AS $body$
BEGIN

if (ie_tipo_processo_p IS NOT NULL AND ie_tipo_processo_p::text <> '') then
	insert into pls_notificacao_tws(	
		nr_sequencia, dt_atualizacao, nm_usuario,
		dt_atualizacao_nrec, nm_usuario_nrec, ie_tipo_processo, 
		nr_seq_prestador, ie_status, dt_notificacao, 
		nr_seq_conta, ds_titulo, ds_texto,
		nr_seq_segurado, ie_aplicacao, nr_seq_wsuite_usuario)
	values (	nextval('pls_notificacao_tws_seq'), clock_timestamp(), nm_usuario_p,
		clock_timestamp(), nm_usuario_p, ie_tipo_processo_p,
		nr_seq_prestador_p, 'P', clock_timestamp(),
		nr_seq_conta_p, ds_titulo_p, ds_texto_p,
		nr_seq_segurado_p, ie_aplicacao_p, nr_seq_wsuite_usuario_p);
end if;

END;

$body$
LANGUAGE PLPGSQL
SECURITY DEFINER
;
-- REVOKE ALL ON PROCEDURE tws_notificacao_hpms_pck.tws_gerar_notificacao_web ( ie_tipo_processo_p pls_notificacao_tws.ie_tipo_processo%type, ie_aplicacao_p pls_notificacao_tws.ie_aplicacao%type, ds_titulo_p pls_notificacao_tws.ds_titulo%type, ds_texto_p pls_notificacao_tws.ds_texto%type, nr_seq_conta_p pls_conta.nr_sequencia%type, nr_seq_prestador_p pls_prestador.nr_sequencia%type, nr_seq_segurado_p pls_segurado.nr_sequencia%type, nr_seq_wsuite_usuario_p wsuite_usuario.nr_sequencia%type, nm_usuario_p usuario.nm_usuario%type) FROM PUBLIC;
